[2024-09-19 09:46:34,049][root][INFO] - 

[2024-09-19 09:46:34,049][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 09:46:34,049][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs
[2024-09-19 09:46:34,049][root][INFO] - 

[2024-09-19 09:46:34,049][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 128, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 5e-05, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 8, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 09:46:39,379][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 09:46:41,285][root][INFO] - 

[2024-09-19 09:46:41,286][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-19 09:46:41,286][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 09:46:41,294][root][INFO] - vocab size              : 51200
[2024-09-19 09:46:41,294][root][INFO] - device                  : gpu
[2024-09-19 09:46:41,294][root][INFO] - random seed             : 42
[2024-09-19 09:46:41,294][root][INFO] - train data size         : 544
[2024-09-19 09:46:41,295][root][INFO] - max epochs              : 15
[2024-09-19 09:46:41,295][root][INFO] - total steps             : 1033
[2024-09-19 09:46:41,295][root][INFO] - warmup steps            : 103
[2024-09-19 09:46:41,295][root][INFO] - batch size              : 64
[2024-09-19 09:46:41,295][root][INFO] - accumulation steps      : 8
[2024-09-19 09:46:41,295][root][INFO] - optimizer               : adamwscale
[2024-09-19 09:46:41,295][root][INFO] - lr_scheduler            : cosine
[2024-09-19 09:46:41,295][root][INFO] - learning rate           : 5e-05
[2024-09-19 09:46:41,295][root][INFO] - max length              : 128

[2024-09-19 09:46:41,295][root][INFO] - 

[2024-09-19 09:46:41,295][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs
[2024-09-19 09:46:41,296][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs/ckpt
[2024-09-19 09:46:41,296][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs/tb
[2024-09-19 09:46:41,296][root][INFO] - * tb interval           : 15

[2024-09-19 09:46:41,296][root][INFO] - 

[2024-09-19 09:46:41,296][root][INFO] - Start the Training !
[2024-09-19 09:46:41,298][root][INFO] - 
[1/ 15 Epoch]
[2024-09-19 09:46:51,398][root][INFO] - Step: 15/1033  |  Loss: 4.6560  |  Score: 8.47 [%]  |  Seq Length: 128.0
[2024-09-19 09:46:59,829][root][INFO] - Step: 30/1033  |  Loss: 3.0399  |  Score: -1.96 [%]  |  Seq Length: 128.0
[2024-09-19 09:47:07,851][root][INFO] - Step: 45/1033  |  Loss: 2.4013  |  Score: 12.23 [%]  |  Seq Length: 128.0
[2024-09-19 09:47:16,168][root][INFO] - Step: 60/1033  |  Loss: 2.4516  |  Score: 12.63 [%]  |  Seq Length: 128.0
[2024-09-19 09:47:21,454][root][INFO] - Step: 68/1033  |  Loss: 2.3626  |  Score: 15.85 [%]  |  Seq Length: 128.0
[2024-09-19 09:47:25,439][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 09:47:25,439][root][INFO] - Score: 14.09 [%]  |  Evaluation Time: 3.98 [s]
[2024-09-19 09:47:28,879][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 09:47:28,879][root][INFO] - Score: 17.64 [%]  |  Evaluation Time: 3.44 [s]
[2024-09-19 09:47:28,881][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 09:47:28,882][root][INFO] - 
[2/ 15 Epoch]
[2024-09-19 09:47:32,581][root][INFO] - Step: 75/1033  |  Loss: 2.0800  |  Score: 27.72 [%]  |  Seq Length: 128.0
[2024-09-19 09:47:40,758][root][INFO] - Step: 90/1033  |  Loss: 2.1077  |  Score: 29.43 [%]  |  Seq Length: 128.0
[2024-09-19 09:47:48,410][root][INFO] - Step: 105/1033  |  Loss: 2.0913  |  Score: 34.62 [%]  |  Seq Length: 128.0
[2024-09-19 09:47:56,113][root][INFO] - Step: 120/1033  |  Loss: 1.8503  |  Score: 35.96 [%]  |  Seq Length: 128.0
[2024-09-19 09:48:03,977][root][INFO] - Step: 135/1033  |  Loss: 1.6520  |  Score: 42.29 [%]  |  Seq Length: 128.0
[2024-09-19 09:48:05,469][root][INFO] - Step: 137/1033  |  Loss: 1.6903  |  Score: 55.04 [%]  |  Seq Length: 128.0
[2024-09-19 09:48:08,990][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 09:48:08,990][root][INFO] - Score: 51.82 [%]  |  Evaluation Time: 3.52 [s]
[2024-09-19 09:48:12,449][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 09:48:12,449][root][INFO] - Score: 48.49 [%]  |  Evaluation Time: 3.46 [s]
[2024-09-19 09:48:12,451][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 09:48:12,452][root][INFO] - 
[3/ 15 Epoch]
[2024-09-19 09:48:19,115][root][INFO] - Step: 150/1033  |  Loss: 1.5004  |  Score: 49.34 [%]  |  Seq Length: 128.0
[2024-09-19 09:48:27,129][root][INFO] - Step: 165/1033  |  Loss: 1.4546  |  Score: 57.17 [%]  |  Seq Length: 128.0
[2024-09-19 09:48:34,967][root][INFO] - Step: 180/1033  |  Loss: 1.5548  |  Score: 51.38 [%]  |  Seq Length: 128.0
[2024-09-19 09:48:42,755][root][INFO] - Step: 195/1033  |  Loss: 1.3891  |  Score: 56.09 [%]  |  Seq Length: 128.0
[2024-09-19 09:48:48,876][root][INFO] - Step: 206/1033  |  Loss: 1.3708  |  Score: 55.42 [%]  |  Seq Length: 128.0
[2024-09-19 09:48:52,384][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 09:48:52,384][root][INFO] - Score: 63.88 [%]  |  Evaluation Time: 3.50 [s]
[2024-09-19 09:48:55,733][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 09:48:55,733][root][INFO] - Score: 60.80 [%]  |  Evaluation Time: 3.35 [s]
[2024-09-19 09:48:55,734][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-19 09:48:55,735][root][INFO] - 
[4/ 15 Epoch]
[2024-09-19 09:48:57,737][root][INFO] - Step: 210/1033  |  Loss: 1.2910  |  Score: 65.68 [%]  |  Seq Length: 128.0
[2024-09-19 09:49:05,357][root][INFO] - Step: 225/1033  |  Loss: 1.2889  |  Score: 59.47 [%]  |  Seq Length: 128.0
[2024-09-19 09:49:13,037][root][INFO] - Step: 240/1033  |  Loss: 1.2855  |  Score: 58.14 [%]  |  Seq Length: 128.0
[2024-09-19 09:49:20,875][root][INFO] - Step: 255/1033  |  Loss: 1.2998  |  Score: 55.84 [%]  |  Seq Length: 128.0
[2024-09-19 09:49:28,663][root][INFO] - Step: 270/1033  |  Loss: 1.1752  |  Score: 61.08 [%]  |  Seq Length: 128.0
[2024-09-19 09:49:31,549][root][INFO] - Step: 275/1033  |  Loss: 1.1725  |  Score: 67.96 [%]  |  Seq Length: 128.0
[2024-09-19 09:49:35,059][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 09:49:35,059][root][INFO] - Score: 68.28 [%]  |  Evaluation Time: 3.51 [s]
[2024-09-19 09:49:38,369][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 09:49:38,369][root][INFO] - Score: 59.88 [%]  |  Evaluation Time: 3.31 [s]
[2024-09-19 09:49:38,370][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-19 09:49:38,371][root][INFO] - 
[5/ 15 Epoch]
[2024-09-19 09:49:43,427][root][INFO] - Step: 285/1033  |  Loss: 1.0572  |  Score: 65.80 [%]  |  Seq Length: 128.0
[2024-09-19 09:49:49,423][root][INFO] - 

[2024-09-19 09:49:49,424][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 09:49:49,424][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs
[2024-09-19 09:49:49,424][root][INFO] - 

[2024-09-19 09:49:49,424][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 128, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 5e-05, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 8, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 09:49:51,182][root][INFO] - Step: 300/1033  |  Loss: 1.1061  |  Score: 63.06 [%]  |  Seq Length: 128.0
[2024-09-19 09:49:54,112][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-19 09:49:54,113][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-19 09:49:54,113][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-19 09:49:54,114][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-19 09:49:54,114][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-19 09:49:54,114][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-19 09:49:54,115][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-19 09:49:54,115][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-19 09:49:54,116][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-19 09:49:54,116][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-19 09:49:54,116][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-19 09:49:54,117][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-19 09:49:54,117][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-19 09:49:54,117][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-19 09:49:54,118][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-19 09:49:54,118][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-19 09:49:54,118][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-19 09:49:54,119][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-19 09:49:54,119][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-19 09:49:54,119][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-19 09:49:54,120][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-19 09:49:54,120][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-19 09:49:54,121][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-19 09:49:54,121][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-19 09:49:54,123][root][INFO] - Trainable params: 884736 || all params: 126049536 || trainable: 0.70 %
[2024-09-19 09:49:54,295][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 09:49:56,273][root][INFO] - 

[2024-09-19 09:49:56,273][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-19 09:49:56,273][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 09:49:56,281][root][INFO] - vocab size              : 51200
[2024-09-19 09:49:56,282][root][INFO] - device                  : gpu
[2024-09-19 09:49:56,282][root][INFO] - random seed             : 42
[2024-09-19 09:49:56,282][root][INFO] - train data size         : 544
[2024-09-19 09:49:56,282][root][INFO] - max epochs              : 15
[2024-09-19 09:49:56,282][root][INFO] - total steps             : 1033
[2024-09-19 09:49:56,282][root][INFO] - warmup steps            : 103
[2024-09-19 09:49:56,282][root][INFO] - batch size              : 64
[2024-09-19 09:49:56,282][root][INFO] - accumulation steps      : 8
[2024-09-19 09:49:56,282][root][INFO] - optimizer               : adamwscale
[2024-09-19 09:49:56,282][root][INFO] - lr_scheduler            : cosine
[2024-09-19 09:49:56,282][root][INFO] - learning rate           : 5e-05
[2024-09-19 09:49:56,283][root][INFO] - max length              : 128

[2024-09-19 09:49:56,283][root][INFO] - LoRA Configuration
[2024-09-19 09:49:56,283][root][INFO] - ㄴ r                    : 16
[2024-09-19 09:49:56,283][root][INFO] - ㄴ alpha                : 64
[2024-09-19 09:49:56,283][root][INFO] - ㄴ dropout              : 0.03

[2024-09-19 09:49:56,283][root][INFO] - 

[2024-09-19 09:49:56,283][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs
[2024-09-19 09:49:56,283][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs/ckpt
[2024-09-19 09:49:56,283][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs/tb
[2024-09-19 09:49:56,283][root][INFO] - * tb interval           : 15

[2024-09-19 09:49:56,283][root][INFO] - 

[2024-09-19 09:49:56,283][root][INFO] - Start the Training !
[2024-09-19 09:49:56,286][root][INFO] - 
[1/ 15 Epoch]
[2024-09-19 09:49:59,162][root][INFO] - Step: 315/1033  |  Loss: 1.1288  |  Score: 65.54 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:06,257][root][INFO] - Step: 15/1033  |  Loss: 7.0161  |  Score: -0.18 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:07,039][root][INFO] - Step: 330/1033  |  Loss: 1.1131  |  Score: 62.71 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:14,406][root][INFO] - Step: 344/1033  |  Loss: 1.1131  |  Score: 61.94 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:14,771][root][INFO] - Step: 30/1033  |  Loss: 6.7364  |  Score: -1.98 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:17,978][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 09:50:17,979][root][INFO] - Score: 67.36 [%]  |  Evaluation Time: 3.57 [s]
[2024-09-19 09:50:21,395][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 09:50:21,396][root][INFO] - Score: 62.61 [%]  |  Evaluation Time: 3.42 [s]
[2024-09-19 09:50:21,397][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-19 09:50:21,398][root][INFO] - 
[6/ 15 Epoch]
[2024-09-19 09:50:21,998][root][INFO] - Step: 345/1033  |  Loss: 0.8747  |  Score: 64.10 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:23,255][root][INFO] - Step: 45/1033  |  Loss: 6.5852  |  Score: 1.52 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:29,686][root][INFO] - Step: 360/1033  |  Loss: 1.0000  |  Score: 67.20 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:31,698][root][INFO] - Step: 60/1033  |  Loss: 6.2561  |  Score: 5.65 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:36,644][root][INFO] - Step: 68/1033  |  Loss: 5.7377  |  Score: 4.60 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:36,866][root][INFO] - Step: 375/1033  |  Loss: 1.0029  |  Score: 66.69 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:40,702][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 09:50:40,702][root][INFO] - Score: 6.34 [%]  |  Evaluation Time: 4.05 [s]
[2024-09-19 09:50:44,570][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 09:50:44,570][root][INFO] - Score: -0.99 [%]  |  Evaluation Time: 3.87 [s]
[2024-09-19 09:50:44,571][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 09:50:44,572][root][INFO] - 
[2/ 15 Epoch]
[2024-09-19 09:50:44,961][root][INFO] - Step: 390/1033  |  Loss: 1.0118  |  Score: 67.26 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:48,123][root][INFO] - Step: 75/1033  |  Loss: 6.3265  |  Score: 5.78 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:52,889][root][INFO] - Step: 405/1033  |  Loss: 1.0083  |  Score: 62.71 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:56,616][root][INFO] - Step: 90/1033  |  Loss: 6.1769  |  Score: 8.01 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:57,352][root][INFO] - Step: 413/1033  |  Loss: 0.9930  |  Score: 67.94 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:01,018][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-19 09:51:01,019][root][INFO] - Score: 70.65 [%]  |  Evaluation Time: 3.66 [s]
[2024-09-19 09:51:04,584][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-19 09:51:04,585][root][INFO] - Score: 59.15 [%]  |  Evaluation Time: 3.56 [s]
[2024-09-19 09:51:04,589][root][INFO] - 
[7/ 15 Epoch]
[2024-09-19 09:51:05,165][root][INFO] - Step: 105/1033  |  Loss: 6.0004  |  Score: -4.61 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:08,455][root][INFO] - Step: 420/1033  |  Loss: 0.9982  |  Score: 66.26 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:13,483][root][INFO] - Step: 120/1033  |  Loss: 5.7832  |  Score: 0.65 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:16,541][root][INFO] - Step: 435/1033  |  Loss: 1.0002  |  Score: 69.57 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:19,862][root][INFO] - 

[2024-09-19 09:51:19,862][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 09:51:19,862][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs
[2024-09-19 09:51:19,862][root][INFO] - 

[2024-09-19 09:51:19,862][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 128, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 5e-05, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 8, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 09:51:21,799][root][INFO] - Step: 135/1033  |  Loss: 5.7606  |  Score: -1.93 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:23,409][root][INFO] - Step: 137/1033  |  Loss: 5.6417  |  Score: 12.45 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:24,054][root][INFO] - Step: 450/1033  |  Loss: 0.9364  |  Score: 68.75 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:24,980][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-19 09:51:24,981][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-19 09:51:24,982][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-19 09:51:24,983][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-19 09:51:24,984][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-19 09:51:24,985][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-19 09:51:24,986][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-19 09:51:24,987][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-19 09:51:24,988][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-19 09:51:24,989][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-19 09:51:24,990][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-19 09:51:24,991][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-19 09:51:24,992][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-19 09:51:24,993][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-19 09:51:24,994][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-19 09:51:24,995][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-19 09:51:24,997][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-19 09:51:24,997][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-19 09:51:24,998][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-19 09:51:24,999][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-19 09:51:25,000][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-19 09:51:25,001][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-19 09:51:25,002][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-19 09:51:25,003][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-19 09:51:25,005][root][INFO] - Trainable params: 884736 || all params: 126049536 || trainable: 0.70 %
[2024-09-19 09:51:25,008][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-19 09:51:25,014][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-19 09:51:25,016][root][INFO] - Trainable params: 1298304 || all params: 126463104 || trainable: 1.03 %
[2024-09-19 09:51:25,173][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 09:51:27,573][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 09:51:27,573][root][INFO] - Score: 5.14 [%]  |  Evaluation Time: 4.16 [s]
[2024-09-19 09:51:28,637][root][INFO] - 

[2024-09-19 09:51:28,638][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-19 09:51:28,638][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 09:51:28,646][root][INFO] - vocab size              : 51200
[2024-09-19 09:51:28,646][root][INFO] - device                  : gpu
[2024-09-19 09:51:28,646][root][INFO] - random seed             : 42
[2024-09-19 09:51:28,646][root][INFO] - train data size         : 544
[2024-09-19 09:51:28,646][root][INFO] - max epochs              : 15
[2024-09-19 09:51:28,646][root][INFO] - total steps             : 1033
[2024-09-19 09:51:28,646][root][INFO] - warmup steps            : 103
[2024-09-19 09:51:28,646][root][INFO] - batch size              : 64
[2024-09-19 09:51:28,646][root][INFO] - accumulation steps      : 8
[2024-09-19 09:51:28,647][root][INFO] - optimizer               : adamwscale
[2024-09-19 09:51:28,647][root][INFO] - lr_scheduler            : cosine
[2024-09-19 09:51:28,647][root][INFO] - learning rate           : 5e-05
[2024-09-19 09:51:28,647][root][INFO] - max length              : 128

[2024-09-19 09:51:28,647][root][INFO] - LoRA Configuration
[2024-09-19 09:51:28,647][root][INFO] - ㄴ r                    : 16
[2024-09-19 09:51:28,647][root][INFO] - ㄴ alpha                : 64
[2024-09-19 09:51:28,647][root][INFO] - ㄴ dropout              : 0.03

[2024-09-19 09:51:28,647][root][INFO] - KOMBO Configuration
[2024-09-19 09:51:28,647][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-19 09:51:28,647][root][INFO] - ㄴ reducer              : linear
[2024-09-19 09:51:28,648][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-19 09:51:28,648][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-19 09:51:28,648][root][INFO] - ㄴ do_combination       : False
[2024-09-19 09:51:28,648][root][INFO] - 

[2024-09-19 09:51:28,648][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs
[2024-09-19 09:51:28,648][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs/ckpt
[2024-09-19 09:51:28,648][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs/tb
[2024-09-19 09:51:28,648][root][INFO] - * tb interval           : 15

[2024-09-19 09:51:28,648][root][INFO] - 

[2024-09-19 09:51:28,648][root][INFO] - Start the Training !
[2024-09-19 09:51:28,651][root][INFO] - 
[1/ 15 Epoch]
[2024-09-19 09:51:31,573][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 09:51:31,573][root][INFO] - Score: 0.59 [%]  |  Evaluation Time: 4.00 [s]
[2024-09-19 09:51:31,574][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 09:51:31,576][root][INFO] - 
[3/ 15 Epoch]
[2024-09-19 09:51:32,043][root][INFO] - Step: 465/1033  |  Loss: 0.9302  |  Score: 68.39 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:38,497][root][INFO] - Step: 150/1033  |  Loss: 5.6828  |  Score: -3.87 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:39,972][root][INFO] - Step: 480/1033  |  Loss: 0.9655  |  Score: 64.68 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:41,204][root][INFO] - Step: 482/1033  |  Loss: 0.9291  |  Score: 71.78 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:44,697][root][INFO] - Step: 15/1033  |  Loss: 6.6237  |  Score: 2.99 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:44,877][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-19 09:51:44,877][root][INFO] - Score: 68.22 [%]  |  Evaluation Time: 3.67 [s]
[2024-09-19 09:51:47,092][root][INFO] - Step: 165/1033  |  Loss: 5.6870  |  Score: -1.70 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:48,406][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-19 09:51:48,406][root][INFO] - Score: 64.30 [%]  |  Evaluation Time: 3.53 [s]
[2024-09-19 09:51:48,407][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-19 09:51:48,408][root][INFO] - 
[8/ 15 Epoch]
[2024-09-19 09:51:55,506][root][INFO] - Step: 495/1033  |  Loss: 0.9473  |  Score: 70.29 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:55,552][root][INFO] - Step: 180/1033  |  Loss: 5.0945  |  Score: 3.16 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:58,150][root][INFO] - Step: 30/1033  |  Loss: 6.9392  |  Score: -0.84 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:03,479][root][INFO] - Step: 510/1033  |  Loss: 0.8937  |  Score: 71.52 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:03,911][root][INFO] - Step: 195/1033  |  Loss: 5.2837  |  Score: -3.13 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:10,393][root][INFO] - Step: 206/1033  |  Loss: 4.7846  |  Score: -2.58 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:11,462][root][INFO] - Step: 45/1033  |  Loss: 6.7202  |  Score: 1.52 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:11,598][root][INFO] - Step: 525/1033  |  Loss: 0.9718  |  Score: 66.62 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:14,594][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 09:52:14,594][root][INFO] - Score: 4.52 [%]  |  Evaluation Time: 4.20 [s]
[2024-09-19 09:52:18,607][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 09:52:18,607][root][INFO] - Score: -6.01 [%]  |  Evaluation Time: 4.01 [s]
[2024-09-19 09:52:18,609][root][INFO] - 
[4/ 15 Epoch]
[2024-09-19 09:52:19,687][root][INFO] - Step: 540/1033  |  Loss: 0.8425  |  Score: 69.81 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:20,743][root][INFO] - Step: 210/1033  |  Loss: 4.4162  |  Score: 5.91 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:24,606][root][INFO] - Step: 60/1033  |  Loss: 6.0123  |  Score: -1.28 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:25,626][root][INFO] - Step: 551/1033  |  Loss: 0.8372  |  Score: 70.30 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:29,048][root][INFO] - Step: 225/1033  |  Loss: 5.0689  |  Score: 5.30 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:29,329][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-19 09:52:29,329][root][INFO] - Score: 70.90 [%]  |  Evaluation Time: 3.70 [s]
[2024-09-19 09:52:32,383][root][INFO] - Step: 68/1033  |  Loss: 6.1948  |  Score: -4.42 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:32,943][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-19 09:52:32,943][root][INFO] - Score: 64.25 [%]  |  Evaluation Time: 3.61 [s]
[2024-09-19 09:52:32,944][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-19 09:52:32,945][root][INFO] - 
[9/ 15 Epoch]
[2024-09-19 09:52:35,368][root][INFO] - Step: 555/1033  |  Loss: 0.8398  |  Score: 75.97 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:37,509][root][INFO] - Step: 240/1033  |  Loss: 4.7683  |  Score: 2.18 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:39,679][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 09:52:39,679][root][INFO] - Score: 5.53 [%]  |  Evaluation Time: 7.29 [s]
[2024-09-19 09:52:43,660][root][INFO] - Step: 570/1033  |  Loss: 0.7999  |  Score: 74.14 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:45,114][root][INFO] - Step: 255/1033  |  Loss: 4.4975  |  Score: -0.86 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:46,586][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 09:52:46,586][root][INFO] - Score: -1.56 [%]  |  Evaluation Time: 6.90 [s]
[2024-09-19 09:52:46,587][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 09:52:46,588][root][INFO] - 
[2/ 15 Epoch]
[2024-09-19 09:52:51,941][root][INFO] - Step: 585/1033  |  Loss: 0.8595  |  Score: 69.20 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:52,258][root][INFO] - Step: 75/1033  |  Loss: 6.0948  |  Score: -1.04 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:53,549][root][INFO] - Step: 270/1033  |  Loss: 4.6937  |  Score: -0.17 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:56,844][root][INFO] - Step: 275/1033  |  Loss: 4.6641  |  Score: 0.17 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:00,019][root][INFO] - Step: 600/1033  |  Loss: 0.8158  |  Score: 72.72 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:00,873][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 09:53:00,873][root][INFO] - Score: 5.84 [%]  |  Evaluation Time: 4.02 [s]
[2024-09-19 09:53:02,430][root][INFO] - Step: 90/1033  |  Loss: 6.1270  |  Score: 1.97 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:04,919][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 09:53:04,919][root][INFO] - Score: -2.00 [%]  |  Evaluation Time: 4.04 [s]
[2024-09-19 09:53:04,923][root][INFO] - 
[5/ 15 Epoch]
[2024-09-19 09:53:08,241][root][INFO] - Step: 615/1033  |  Loss: 0.7927  |  Score: 71.38 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:10,549][root][INFO] - Step: 285/1033  |  Loss: 4.4889  |  Score: -0.23 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:10,858][root][INFO] - Step: 619/1033  |  Loss: 0.9441  |  Score: 72.69 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:12,622][root][INFO] - Step: 105/1033  |  Loss: 5.7940  |  Score: 6.53 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:14,544][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-19 09:53:14,545][root][INFO] - Score: 68.74 [%]  |  Evaluation Time: 3.68 [s]
[2024-09-19 09:53:18,088][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-19 09:53:18,088][root][INFO] - Score: 66.56 [%]  |  Evaluation Time: 3.54 [s]
[2024-09-19 09:53:18,090][root][INFO] - 
Save new Best Score (Epoch: 9)
[2024-09-19 09:53:18,091][root][INFO] - 
[10/ 15 Epoch]
[2024-09-19 09:53:19,083][root][INFO] - Step: 300/1033  |  Loss: 4.3360  |  Score: 3.93 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:23,034][root][INFO] - Step: 120/1033  |  Loss: 6.1205  |  Score: -3.43 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:23,875][root][INFO] - Step: 630/1033  |  Loss: 0.8398  |  Score: 71.76 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:27,695][root][INFO] - Step: 315/1033  |  Loss: 4.1249  |  Score: 5.07 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:32,229][root][INFO] - Step: 645/1033  |  Loss: 0.7594  |  Score: 71.62 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:33,287][root][INFO] - Step: 135/1033  |  Loss: 5.3378  |  Score: 7.77 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:35,208][root][INFO] - Step: 137/1033  |  Loss: 5.8812  |  Score: -3.16 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:36,126][root][INFO] - Step: 330/1033  |  Loss: 4.0800  |  Score: -3.31 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:40,122][root][INFO] - Step: 660/1033  |  Loss: 0.7853  |  Score: 71.69 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:40,904][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 09:53:40,905][root][INFO] - Score: 7.10 [%]  |  Evaluation Time: 5.69 [s]
[2024-09-19 09:53:44,438][root][INFO] - Step: 344/1033  |  Loss: 4.1850  |  Score: 1.52 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:46,256][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 09:53:46,256][root][INFO] - Score: -1.47 [%]  |  Evaluation Time: 5.35 [s]
[2024-09-19 09:53:46,258][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 09:53:46,259][root][INFO] - 
[3/ 15 Epoch]
[2024-09-19 09:53:48,159][root][INFO] - Step: 675/1033  |  Loss: 0.7804  |  Score: 75.74 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:48,485][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 09:53:48,485][root][INFO] - Score: 1.61 [%]  |  Evaluation Time: 4.04 [s]
[2024-09-19 09:53:52,351][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 09:53:52,351][root][INFO] - Score: -2.31 [%]  |  Evaluation Time: 3.86 [s]
[2024-09-19 09:53:52,353][root][INFO] - 
[6/ 15 Epoch]
[2024-09-19 09:53:52,957][root][INFO] - Step: 345/1033  |  Loss: 3.8294  |  Score: 14.90 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:54,590][root][INFO] - Step: 150/1033  |  Loss: 4.8769  |  Score: 7.55 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:55,521][root][INFO] - Step: 688/1033  |  Loss: 0.8244  |  Score: 71.28 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:59,180][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-19 09:53:59,180][root][INFO] - Score: 70.70 [%]  |  Evaluation Time: 3.66 [s]
[2024-09-19 09:54:01,281][root][INFO] - Step: 360/1033  |  Loss: 4.0348  |  Score: 6.65 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:02,661][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-19 09:54:02,662][root][INFO] - Score: 63.26 [%]  |  Evaluation Time: 3.48 [s]
[2024-09-19 09:54:02,664][root][INFO] - 
[11/ 15 Epoch]
[2024-09-19 09:54:03,624][root][INFO] - Step: 690/1033  |  Loss: 0.9458  |  Score: 66.05 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:04,780][root][INFO] - Step: 165/1033  |  Loss: 5.3852  |  Score: -3.35 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:09,650][root][INFO] - Step: 375/1033  |  Loss: 3.7172  |  Score: 4.59 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:11,381][root][INFO] - Step: 705/1033  |  Loss: 0.7698  |  Score: 74.92 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:14,577][root][INFO] - Step: 180/1033  |  Loss: 4.8926  |  Score: 3.01 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:17,981][root][INFO] - Step: 390/1033  |  Loss: 3.6551  |  Score: 1.28 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:19,253][root][INFO] - Step: 720/1033  |  Loss: 0.7689  |  Score: 73.02 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:24,706][root][INFO] - Step: 195/1033  |  Loss: 4.8143  |  Score: 4.30 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:26,447][root][INFO] - Step: 405/1033  |  Loss: 3.7659  |  Score: -6.32 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:27,292][root][INFO] - Step: 735/1033  |  Loss: 0.8024  |  Score: 71.99 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:31,228][root][INFO] - Step: 413/1033  |  Loss: 3.5965  |  Score: 0.82 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:32,742][root][INFO] - Step: 206/1033  |  Loss: 4.8324  |  Score: 0.36 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:35,321][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-19 09:54:35,321][root][INFO] - Score: 5.60 [%]  |  Evaluation Time: 4.09 [s]
[2024-09-19 09:54:35,392][root][INFO] - Step: 750/1033  |  Loss: 0.7641  |  Score: 72.16 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:38,434][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 09:54:38,434][root][INFO] - Score: 6.36 [%]  |  Evaluation Time: 5.69 [s]
[2024-09-19 09:54:39,347][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-19 09:54:39,347][root][INFO] - Score: -3.64 [%]  |  Evaluation Time: 4.02 [s]
[2024-09-19 09:54:39,349][root][INFO] - 
[7/ 15 Epoch]
[2024-09-19 09:54:39,636][root][INFO] - Step: 757/1033  |  Loss: 0.7596  |  Score: 72.99 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:43,427][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-19 09:54:43,427][root][INFO] - Score: 71.95 [%]  |  Evaluation Time: 3.79 [s]
[2024-09-19 09:54:43,499][root][INFO] - Step: 420/1033  |  Loss: 3.5008  |  Score: 12.96 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:43,797][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 09:54:43,798][root][INFO] - Score: -1.20 [%]  |  Evaluation Time: 5.36 [s]
[2024-09-19 09:54:43,800][root][INFO] - 
[4/ 15 Epoch]
[2024-09-19 09:54:46,390][root][INFO] - Step: 210/1033  |  Loss: 4.9819  |  Score: 1.33 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:46,907][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-19 09:54:46,908][root][INFO] - Score: 66.66 [%]  |  Evaluation Time: 3.48 [s]
[2024-09-19 09:54:46,910][root][INFO] - 
Save new Best Score (Epoch: 11)
[2024-09-19 09:54:46,912][root][INFO] - 
[12/ 15 Epoch]
[2024-09-19 09:54:51,150][root][INFO] - Step: 765/1033  |  Loss: 0.7101  |  Score: 74.20 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:51,944][root][INFO] - Step: 435/1033  |  Loss: 3.6294  |  Score: 1.70 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:56,792][root][INFO] - Step: 225/1033  |  Loss: 4.3579  |  Score: 5.25 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:58,987][root][INFO] - Step: 780/1033  |  Loss: 0.7841  |  Score: 72.78 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:00,301][root][INFO] - Step: 450/1033  |  Loss: 3.4627  |  Score: 5.00 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:06,531][root][INFO] - Step: 795/1033  |  Loss: 0.8076  |  Score: 74.83 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:07,049][root][INFO] - Step: 240/1033  |  Loss: 4.3791  |  Score: -2.20 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:08,546][root][INFO] - Step: 465/1033  |  Loss: 3.3870  |  Score: -0.34 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:14,461][root][INFO] - Step: 810/1033  |  Loss: 0.7421  |  Score: 72.66 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:16,954][root][INFO] - Step: 255/1033  |  Loss: 3.9663  |  Score: 5.59 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:17,106][root][INFO] - Step: 480/1033  |  Loss: 3.3944  |  Score: 5.86 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:18,418][root][INFO] - Step: 482/1033  |  Loss: 3.1073  |  Score: -1.27 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:22,410][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-19 09:55:22,411][root][INFO] - Score: 6.28 [%]  |  Evaluation Time: 3.99 [s]
[2024-09-19 09:55:22,525][root][INFO] - Step: 825/1033  |  Loss: 0.7451  |  Score: 72.16 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:23,394][root][INFO] - Step: 826/1033  |  Loss: 0.6361  |  Score: 81.29 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:26,301][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-19 09:55:26,301][root][INFO] - Score: -3.50 [%]  |  Evaluation Time: 3.89 [s]
[2024-09-19 09:55:26,304][root][INFO] - 
[8/ 15 Epoch]
[2024-09-19 09:55:26,996][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-19 09:55:26,997][root][INFO] - Score: 68.37 [%]  |  Evaluation Time: 3.60 [s]
[2024-09-19 09:55:27,208][root][INFO] - Step: 270/1033  |  Loss: 3.6468  |  Score: 0.47 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:30,381][root][INFO] - Step: 275/1033  |  Loss: 4.1394  |  Score: 1.60 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:30,452][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-19 09:55:30,452][root][INFO] - Score: 65.03 [%]  |  Evaluation Time: 3.45 [s]
[2024-09-19 09:55:30,454][root][INFO] - 
[13/ 15 Epoch]
[2024-09-19 09:55:33,923][root][INFO] - Step: 495/1033  |  Loss: 3.2067  |  Score: 6.15 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:36,249][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 09:55:36,249][root][INFO] - Score: 2.10 [%]  |  Evaluation Time: 5.86 [s]
[2024-09-19 09:55:37,841][root][INFO] - Step: 840/1033  |  Loss: 0.6958  |  Score: 74.92 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:41,645][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 09:55:41,645][root][INFO] - Score: -2.84 [%]  |  Evaluation Time: 5.39 [s]
[2024-09-19 09:55:41,648][root][INFO] - 
[5/ 15 Epoch]
[2024-09-19 09:55:42,316][root][INFO] - Step: 510/1033  |  Loss: 3.1974  |  Score: -1.52 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:45,847][root][INFO] - Step: 855/1033  |  Loss: 0.7671  |  Score: 73.46 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:47,409][root][INFO] - Step: 285/1033  |  Loss: 3.9947  |  Score: -4.63 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:50,783][root][INFO] - Step: 525/1033  |  Loss: 3.1282  |  Score: 1.99 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:54,218][root][INFO] - Step: 870/1033  |  Loss: 0.7184  |  Score: 75.47 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:56,274][root][INFO] - Step: 300/1033  |  Loss: 3.6947  |  Score: -4.02 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:58,142][root][INFO] - Step: 540/1033  |  Loss: 3.2208  |  Score: 4.93 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:02,371][root][INFO] - Step: 885/1033  |  Loss: 0.7425  |  Score: 75.50 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:04,271][root][INFO] - Step: 551/1033  |  Loss: 3.2982  |  Score: 1.81 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:06,355][root][INFO] - Step: 315/1033  |  Loss: 3.5586  |  Score: 0.90 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:08,097][root][INFO] - Step: 895/1033  |  Loss: 0.7426  |  Score: 74.72 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:08,440][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-19 09:56:08,440][root][INFO] - Score: 3.33 [%]  |  Evaluation Time: 4.17 [s]
[2024-09-19 09:56:11,791][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-19 09:56:11,792][root][INFO] - Score: 70.17 [%]  |  Evaluation Time: 3.69 [s]
[2024-09-19 09:56:12,345][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-19 09:56:12,345][root][INFO] - Score: -1.94 [%]  |  Evaluation Time: 3.90 [s]
[2024-09-19 09:56:12,348][root][INFO] - 
[9/ 15 Epoch]
[2024-09-19 09:56:14,988][root][INFO] - Step: 555/1033  |  Loss: 2.9444  |  Score: 0.08 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:15,660][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-19 09:56:15,660][root][INFO] - Score: 61.70 [%]  |  Evaluation Time: 3.87 [s]
[2024-09-19 09:56:15,662][root][INFO] - 
[14/ 15 Epoch]
[2024-09-19 09:56:16,315][root][INFO] - Step: 330/1033  |  Loss: 2.9103  |  Score: 6.28 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:18,450][root][INFO] - Step: 900/1033  |  Loss: 0.7192  |  Score: 74.01 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:22,922][root][INFO] - Step: 570/1033  |  Loss: 3.2350  |  Score: -3.82 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:26,234][root][INFO] - Step: 915/1033  |  Loss: 0.7457  |  Score: 72.22 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:26,298][root][INFO] - Step: 344/1033  |  Loss: 3.0437  |  Score: 6.92 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:31,335][root][INFO] - Step: 585/1033  |  Loss: 3.0030  |  Score: 3.44 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:31,929][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 09:56:31,929][root][INFO] - Score: 0.87 [%]  |  Evaluation Time: 5.63 [s]
[2024-09-19 09:56:34,454][root][INFO] - Step: 930/1033  |  Loss: 0.6895  |  Score: 74.83 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:37,216][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 09:56:37,216][root][INFO] - Score: -3.26 [%]  |  Evaluation Time: 5.28 [s]
[2024-09-19 09:56:37,218][root][INFO] - 
[6/ 15 Epoch]
[2024-09-19 09:56:37,896][root][INFO] - Step: 345/1033  |  Loss: 4.0986  |  Score: 1.73 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:39,547][root][INFO] - Step: 600/1033  |  Loss: 3.0244  |  Score: 4.13 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:42,536][root][INFO] - Step: 945/1033  |  Loss: 0.6923  |  Score: 76.28 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:47,360][root][INFO] - Step: 360/1033  |  Loss: 3.0812  |  Score: -0.90 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:48,062][root][INFO] - Step: 615/1033  |  Loss: 3.0629  |  Score: 1.84 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:50,474][root][INFO] - Step: 960/1033  |  Loss: 0.6961  |  Score: 75.43 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:50,918][root][INFO] - Step: 619/1033  |  Loss: 2.8702  |  Score: 1.69 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:52,776][root][INFO] - Step: 964/1033  |  Loss: 0.6864  |  Score: 77.40 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:54,980][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-19 09:56:54,980][root][INFO] - Score: 4.90 [%]  |  Evaluation Time: 4.06 [s]
[2024-09-19 09:56:56,407][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-19 09:56:56,407][root][INFO] - Score: 69.98 [%]  |  Evaluation Time: 3.63 [s]
[2024-09-19 09:56:57,656][root][INFO] - Step: 375/1033  |  Loss: 2.8478  |  Score: 6.67 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:58,917][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-19 09:56:58,918][root][INFO] - Score: -3.42 [%]  |  Evaluation Time: 3.94 [s]
[2024-09-19 09:56:58,920][root][INFO] - 
[10/ 15 Epoch]
[2024-09-19 09:56:59,951][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-19 09:56:59,952][root][INFO] - Score: 63.63 [%]  |  Evaluation Time: 3.54 [s]
[2024-09-19 09:56:59,957][root][INFO] - 
[15/ 15 Epoch]
[2024-09-19 09:57:04,847][root][INFO] - Step: 630/1033  |  Loss: 2.9836  |  Score: -1.45 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:06,040][root][INFO] - Step: 975/1033  |  Loss: 0.6025  |  Score: 80.59 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:07,647][root][INFO] - Step: 390/1033  |  Loss: 2.7917  |  Score: 3.28 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:13,235][root][INFO] - Step: 990/1033  |  Loss: 0.7344  |  Score: 77.41 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:13,282][root][INFO] - Step: 645/1033  |  Loss: 3.0641  |  Score: -0.05 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:17,731][root][INFO] - Step: 405/1033  |  Loss: 2.8825  |  Score: 1.20 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:21,261][root][INFO] - Step: 1005/1033  |  Loss: 0.6655  |  Score: 76.26 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:21,621][root][INFO] - Step: 660/1033  |  Loss: 2.9266  |  Score: 6.63 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:23,390][root][INFO] - Step: 413/1033  |  Loss: 3.0610  |  Score: 4.85 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:29,032][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-19 09:57:29,032][root][INFO] - Score: 5.93 [%]  |  Evaluation Time: 5.64 [s]
[2024-09-19 09:57:29,312][root][INFO] - Step: 1020/1033  |  Loss: 0.7397  |  Score: 74.03 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:30,104][root][INFO] - Step: 675/1033  |  Loss: 2.8487  |  Score: 7.10 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:34,434][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-19 09:57:34,435][root][INFO] - Score: -5.95 [%]  |  Evaluation Time: 5.40 [s]
[2024-09-19 09:57:34,436][root][INFO] - 
[7/ 15 Epoch]
[2024-09-19 09:57:36,331][root][INFO] - Step: 1033/1033  |  Loss: 0.6881  |  Score: 73.72 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:37,754][root][INFO] - Step: 688/1033  |  Loss: 2.8152  |  Score: 7.58 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:39,266][root][INFO] - Step: 420/1033  |  Loss: 2.6592  |  Score: 2.62 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:39,993][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-19 09:57:39,993][root][INFO] - Score: 71.86 [%]  |  Evaluation Time: 3.66 [s]
[2024-09-19 09:57:41,764][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-19 09:57:41,764][root][INFO] - Score: 7.48 [%]  |  Evaluation Time: 4.01 [s]
[2024-09-19 09:57:43,542][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-19 09:57:43,543][root][INFO] - Score: 64.86 [%]  |  Evaluation Time: 3.55 [s]
[2024-09-19 09:57:43,544][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 09:57:43,544][root][INFO] - - Epoch: 11
[2024-09-19 09:57:43,545][root][INFO] - - DEV score: 71.95 [%]
[2024-09-19 09:57:43,545][root][INFO] - - TEST score: 66.66 [%]
[2024-09-19 09:57:43,546][root][INFO] - Fine-tuning is done!
[2024-09-19 09:57:45,766][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-19 09:57:45,767][root][INFO] - Score: -3.35 [%]  |  Evaluation Time: 4.00 [s]
[2024-09-19 09:57:45,769][root][INFO] - 
[11/ 15 Epoch]
[2024-09-19 09:57:46,510][root][INFO] - Step: 690/1033  |  Loss: 2.9369  |  Score: 1.96 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:49,339][root][INFO] - Step: 435/1033  |  Loss: 2.8087  |  Score: 5.30 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:54,062][root][INFO] - Step: 705/1033  |  Loss: 2.9657  |  Score: 2.51 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:59,362][root][INFO] - Step: 450/1033  |  Loss: 2.8269  |  Score: 1.86 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:02,497][root][INFO] - Step: 720/1033  |  Loss: 2.8984  |  Score: 3.78 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:09,233][root][INFO] - Step: 465/1033  |  Loss: 2.7663  |  Score: 2.26 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:10,602][root][INFO] - Step: 735/1033  |  Loss: 2.7246  |  Score: 1.40 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:18,206][root][INFO] - Step: 750/1033  |  Loss: 2.8062  |  Score: 3.80 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:19,068][root][INFO] - Step: 480/1033  |  Loss: 2.7933  |  Score: 5.39 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:20,482][root][INFO] - Step: 482/1033  |  Loss: 2.6748  |  Score: 10.01 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:22,383][root][INFO] - Step: 757/1033  |  Loss: 2.7449  |  Score: -0.32 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:26,015][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-19 09:58:26,015][root][INFO] - Score: 5.71 [%]  |  Evaluation Time: 5.53 [s]
[2024-09-19 09:58:26,367][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-19 09:58:26,368][root][INFO] - Score: 4.63 [%]  |  Evaluation Time: 3.98 [s]
[2024-09-19 09:58:30,174][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-19 09:58:30,175][root][INFO] - Score: -5.10 [%]  |  Evaluation Time: 3.80 [s]
[2024-09-19 09:58:30,177][root][INFO] - 
[12/ 15 Epoch]
[2024-09-19 09:58:31,274][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-19 09:58:31,275][root][INFO] - Score: -1.76 [%]  |  Evaluation Time: 5.26 [s]
[2024-09-19 09:58:31,277][root][INFO] - 
[8/ 15 Epoch]
[2024-09-19 09:58:34,505][root][INFO] - Step: 765/1033  |  Loss: 2.7285  |  Score: 11.60 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:39,951][root][INFO] - Step: 495/1033  |  Loss: 2.7532  |  Score: -0.31 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:42,794][root][INFO] - Step: 780/1033  |  Loss: 2.6711  |  Score: 4.26 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:49,923][root][INFO] - Step: 510/1033  |  Loss: 2.6058  |  Score: 7.33 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:50,802][root][INFO] - Step: 795/1033  |  Loss: 2.8625  |  Score: 1.56 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:58,999][root][INFO] - Step: 810/1033  |  Loss: 2.8589  |  Score: 1.83 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:59,851][root][INFO] - Step: 525/1033  |  Loss: 2.7174  |  Score: 4.97 [%]  |  Seq Length: 128.0
[2024-09-19 09:59:06,431][root][INFO] - Step: 825/1033  |  Loss: 2.8063  |  Score: 3.70 [%]  |  Seq Length: 128.0
[2024-09-19 09:59:07,300][root][INFO] - Step: 826/1033  |  Loss: 2.7263  |  Score: 3.88 [%]  |  Seq Length: 128.0
[2024-09-19 09:59:10,135][root][INFO] - Step: 540/1033  |  Loss: 2.8168  |  Score: 0.86 [%]  |  Seq Length: 128.0
[2024-09-19 09:59:11,288][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-19 09:59:11,288][root][INFO] - Score: 7.68 [%]  |  Evaluation Time: 3.98 [s]
[2024-09-19 09:59:15,145][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-19 09:59:15,145][root][INFO] - Score: -2.41 [%]  |  Evaluation Time: 3.85 [s]
[2024-09-19 09:59:15,147][root][INFO] - 
[13/ 15 Epoch]
[2024-09-19 09:59:17,623][root][INFO] - Step: 551/1033  |  Loss: 2.8515  |  Score: 3.94 [%]  |  Seq Length: 128.0
[2024-09-19 09:59:21,881][root][INFO] - Step: 840/1033  |  Loss: 2.9026  |  Score: -1.09 [%]  |  Seq Length: 128.0
[2024-09-19 09:59:23,117][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-19 09:59:23,117][root][INFO] - Score: 2.49 [%]  |  Evaluation Time: 5.49 [s]
[2024-09-19 09:59:28,358][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-19 09:59:28,358][root][INFO] - Score: -4.99 [%]  |  Evaluation Time: 5.24 [s]
[2024-09-19 09:59:28,360][root][INFO] - 
[9/ 15 Epoch]
[2024-09-19 09:59:29,367][root][INFO] - Step: 855/1033  |  Loss: 2.6870  |  Score: 6.75 [%]  |  Seq Length: 128.0
[2024-09-19 09:59:31,280][root][INFO] - Step: 555/1033  |  Loss: 2.9109  |  Score: 3.27 [%]  |  Seq Length: 128.0
[2024-09-19 09:59:37,482][root][INFO] - Step: 870/1033  |  Loss: 2.7040  |  Score: 4.59 [%]  |  Seq Length: 128.0
[2024-09-19 09:59:41,101][root][INFO] - Step: 570/1033  |  Loss: 2.8248  |  Score: -1.36 [%]  |  Seq Length: 128.0
[2024-09-19 09:59:45,890][root][INFO] - Step: 885/1033  |  Loss: 2.6090  |  Score: 5.51 [%]  |  Seq Length: 128.0
[2024-09-19 09:59:51,243][root][INFO] - Step: 585/1033  |  Loss: 2.5388  |  Score: 9.20 [%]  |  Seq Length: 128.0
[2024-09-19 09:59:51,456][root][INFO] - Step: 895/1033  |  Loss: 2.8643  |  Score: 2.06 [%]  |  Seq Length: 128.0
[2024-09-19 09:59:55,548][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-19 09:59:55,548][root][INFO] - Score: 6.92 [%]  |  Evaluation Time: 4.09 [s]
[2024-09-19 09:59:59,475][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-19 09:59:59,476][root][INFO] - Score: -0.97 [%]  |  Evaluation Time: 3.92 [s]
[2024-09-19 09:59:59,477][root][INFO] - 
Save new Best Score (Epoch: 13)
[2024-09-19 09:59:59,479][root][INFO] - 
[14/ 15 Epoch]
[2024-09-19 10:00:01,342][root][INFO] - Step: 600/1033  |  Loss: 2.7516  |  Score: 4.42 [%]  |  Seq Length: 128.0
[2024-09-19 10:00:02,343][root][INFO] - Step: 900/1033  |  Loss: 2.6980  |  Score: -6.64 [%]  |  Seq Length: 128.0
[2024-09-19 10:00:09,898][root][INFO] - Step: 915/1033  |  Loss: 2.6152  |  Score: 9.53 [%]  |  Seq Length: 128.0
[2024-09-19 10:00:10,992][root][INFO] - Step: 615/1033  |  Loss: 2.5421  |  Score: 9.60 [%]  |  Seq Length: 128.0
[2024-09-19 10:00:14,327][root][INFO] - Step: 619/1033  |  Loss: 2.3272  |  Score: 12.49 [%]  |  Seq Length: 128.0
[2024-09-19 10:00:18,401][root][INFO] - Step: 930/1033  |  Loss: 2.7094  |  Score: 8.98 [%]  |  Seq Length: 128.0
[2024-09-19 10:00:19,805][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-19 10:00:19,805][root][INFO] - Score: 0.91 [%]  |  Evaluation Time: 5.47 [s]
[2024-09-19 10:00:24,998][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-19 10:00:24,998][root][INFO] - Score: -4.40 [%]  |  Evaluation Time: 5.19 [s]
[2024-09-19 10:00:25,000][root][INFO] - 
[10/ 15 Epoch]
[2024-09-19 10:00:26,830][root][INFO] - Step: 945/1033  |  Loss: 2.8150  |  Score: 3.56 [%]  |  Seq Length: 128.0
[2024-09-19 10:00:32,069][root][INFO] - Step: 630/1033  |  Loss: 2.6507  |  Score: 6.12 [%]  |  Seq Length: 128.0
[2024-09-19 10:00:35,147][root][INFO] - Step: 960/1033  |  Loss: 2.7436  |  Score: 2.07 [%]  |  Seq Length: 128.0
[2024-09-19 10:00:37,586][root][INFO] - Step: 964/1033  |  Loss: 2.7660  |  Score: 4.72 [%]  |  Seq Length: 128.0
[2024-09-19 10:00:41,656][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-19 10:00:41,656][root][INFO] - Score: 8.10 [%]  |  Evaluation Time: 4.07 [s]
[2024-09-19 10:00:42,135][root][INFO] - Step: 645/1033  |  Loss: 2.6027  |  Score: 7.02 [%]  |  Seq Length: 128.0
[2024-09-19 10:00:45,441][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-19 10:00:45,442][root][INFO] - Score: -1.38 [%]  |  Evaluation Time: 3.78 [s]
[2024-09-19 10:00:45,442][root][INFO] - 
Save new Best Score (Epoch: 14)
[2024-09-19 10:00:45,443][root][INFO] - 
[15/ 15 Epoch]
[2024-09-19 10:00:51,585][root][INFO] - Step: 975/1033  |  Loss: 2.9009  |  Score: 3.27 [%]  |  Seq Length: 128.0
[2024-09-19 10:00:51,945][root][INFO] - Step: 660/1033  |  Loss: 2.5760  |  Score: 7.13 [%]  |  Seq Length: 128.0
[2024-09-19 10:00:59,685][root][INFO] - Step: 990/1033  |  Loss: 2.7218  |  Score: 7.79 [%]  |  Seq Length: 128.0
[2024-09-19 10:01:02,089][root][INFO] - Step: 675/1033  |  Loss: 2.5976  |  Score: 8.07 [%]  |  Seq Length: 128.0
[2024-09-19 10:01:07,672][root][INFO] - Step: 1005/1033  |  Loss: 2.8011  |  Score: 2.49 [%]  |  Seq Length: 128.0
[2024-09-19 10:01:11,202][root][INFO] - Step: 688/1033  |  Loss: 2.6665  |  Score: 5.98 [%]  |  Seq Length: 128.0
[2024-09-19 10:01:15,839][root][INFO] - Step: 1020/1033  |  Loss: 2.7291  |  Score: 2.35 [%]  |  Seq Length: 128.0
[2024-09-19 10:01:16,733][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-19 10:01:16,733][root][INFO] - Score: 8.98 [%]  |  Evaluation Time: 5.53 [s]
[2024-09-19 10:01:22,029][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-19 10:01:22,030][root][INFO] - Score: -1.50 [%]  |  Evaluation Time: 5.29 [s]
[2024-09-19 10:01:22,031][root][INFO] - 
Save new Best Score (Epoch: 10)
[2024-09-19 10:01:22,032][root][INFO] - 
[11/ 15 Epoch]
[2024-09-19 10:01:23,068][root][INFO] - Step: 1033/1033  |  Loss: 2.6075  |  Score: 5.40 [%]  |  Seq Length: 128.0
[2024-09-19 10:01:23,069][root][INFO] - Step: 690/1033  |  Loss: 2.5632  |  Score: 7.31 [%]  |  Seq Length: 128.0
[2024-09-19 10:01:26,985][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-19 10:01:26,985][root][INFO] - Score: 5.67 [%]  |  Evaluation Time: 3.91 [s]
[2024-09-19 10:01:30,756][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-19 10:01:30,757][root][INFO] - Score: -3.58 [%]  |  Evaluation Time: 3.77 [s]
[2024-09-19 10:01:30,758][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 10:01:30,758][root][INFO] - - Epoch: 14
[2024-09-19 10:01:30,758][root][INFO] - - DEV score: 8.10 [%]
[2024-09-19 10:01:30,758][root][INFO] - - TEST score: -1.38 [%]
[2024-09-19 10:01:30,759][root][INFO] - Fine-tuning is done!
[2024-09-19 10:01:33,120][root][INFO] - Step: 705/1033  |  Loss: 2.5511  |  Score: 9.51 [%]  |  Seq Length: 128.0
[2024-09-19 10:01:42,706][root][INFO] - Step: 720/1033  |  Loss: 2.5823  |  Score: 9.47 [%]  |  Seq Length: 128.0
[2024-09-19 10:01:52,406][root][INFO] - Step: 735/1033  |  Loss: 2.7269  |  Score: 7.95 [%]  |  Seq Length: 128.0
[2024-09-19 10:02:02,057][root][INFO] - Step: 750/1033  |  Loss: 2.5804  |  Score: 8.58 [%]  |  Seq Length: 128.0
[2024-09-19 10:02:07,026][root][INFO] - Step: 757/1033  |  Loss: 2.3835  |  Score: 8.92 [%]  |  Seq Length: 128.0
[2024-09-19 10:02:12,377][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-19 10:02:12,377][root][INFO] - Score: 8.21 [%]  |  Evaluation Time: 5.35 [s]
[2024-09-19 10:02:17,520][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-19 10:02:17,520][root][INFO] - Score: 2.13 [%]  |  Evaluation Time: 5.14 [s]
[2024-09-19 10:02:17,521][root][INFO] - 
Save new Best Score (Epoch: 11)
[2024-09-19 10:02:17,522][root][INFO] - 
[12/ 15 Epoch]
[2024-09-19 10:02:22,551][root][INFO] - Step: 765/1033  |  Loss: 2.7436  |  Score: 0.38 [%]  |  Seq Length: 128.0
[2024-09-19 10:02:32,426][root][INFO] - Step: 780/1033  |  Loss: 2.4733  |  Score: 8.74 [%]  |  Seq Length: 128.0
[2024-09-19 10:02:42,213][root][INFO] - Step: 795/1033  |  Loss: 2.5869  |  Score: 9.44 [%]  |  Seq Length: 128.0
[2024-09-19 10:02:51,988][root][INFO] - Step: 810/1033  |  Loss: 2.6459  |  Score: 3.10 [%]  |  Seq Length: 128.0
[2024-09-19 10:03:01,777][root][INFO] - Step: 825/1033  |  Loss: 2.4534  |  Score: 11.43 [%]  |  Seq Length: 128.0
[2024-09-19 10:03:02,790][root][INFO] - Step: 826/1033  |  Loss: 2.4785  |  Score: 9.43 [%]  |  Seq Length: 128.0
[2024-09-19 10:03:08,232][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-19 10:03:08,233][root][INFO] - Score: 4.60 [%]  |  Evaluation Time: 5.44 [s]
[2024-09-19 10:03:13,408][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-19 10:03:13,408][root][INFO] - Score: 0.94 [%]  |  Evaluation Time: 5.17 [s]
[2024-09-19 10:03:13,410][root][INFO] - 
[13/ 15 Epoch]
[2024-09-19 10:03:22,665][root][INFO] - Step: 840/1033  |  Loss: 2.6163  |  Score: 8.69 [%]  |  Seq Length: 128.0
[2024-09-19 10:03:32,563][root][INFO] - Step: 855/1033  |  Loss: 2.5700  |  Score: 9.40 [%]  |  Seq Length: 128.0
[2024-09-19 10:03:42,509][root][INFO] - Step: 870/1033  |  Loss: 2.4217  |  Score: 8.17 [%]  |  Seq Length: 128.0
[2024-09-19 10:03:52,370][root][INFO] - Step: 885/1033  |  Loss: 2.5803  |  Score: 8.06 [%]  |  Seq Length: 128.0
[2024-09-19 10:03:59,353][root][INFO] - Step: 895/1033  |  Loss: 2.5452  |  Score: 7.52 [%]  |  Seq Length: 128.0
[2024-09-19 10:04:04,756][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-19 10:04:04,756][root][INFO] - Score: 9.86 [%]  |  Evaluation Time: 5.40 [s]
[2024-09-19 10:04:09,861][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-19 10:04:09,861][root][INFO] - Score: 0.69 [%]  |  Evaluation Time: 5.10 [s]
[2024-09-19 10:04:09,862][root][INFO] - 
Save new Best Score (Epoch: 13)
[2024-09-19 10:04:09,863][root][INFO] - 
[14/ 15 Epoch]
[2024-09-19 10:04:13,161][root][INFO] - Step: 900/1033  |  Loss: 2.5669  |  Score: 9.49 [%]  |  Seq Length: 128.0
[2024-09-19 10:04:23,000][root][INFO] - Step: 915/1033  |  Loss: 2.4554  |  Score: 7.69 [%]  |  Seq Length: 128.0
[2024-09-19 10:04:32,935][root][INFO] - Step: 930/1033  |  Loss: 2.5846  |  Score: 11.55 [%]  |  Seq Length: 128.0
[2024-09-19 10:04:43,068][root][INFO] - Step: 945/1033  |  Loss: 2.4898  |  Score: 10.09 [%]  |  Seq Length: 128.0
[2024-09-19 10:04:53,218][root][INFO] - Step: 960/1033  |  Loss: 2.6222  |  Score: 6.26 [%]  |  Seq Length: 128.0
[2024-09-19 10:04:56,085][root][INFO] - Step: 964/1033  |  Loss: 2.4740  |  Score: 5.38 [%]  |  Seq Length: 128.0
[2024-09-19 10:05:01,593][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-19 10:05:01,593][root][INFO] - Score: 8.46 [%]  |  Evaluation Time: 5.50 [s]
[2024-09-19 10:05:06,798][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-19 10:05:06,798][root][INFO] - Score: 2.15 [%]  |  Evaluation Time: 5.20 [s]
[2024-09-19 10:05:06,799][root][INFO] - 
Save new Best Score (Epoch: 14)
[2024-09-19 10:05:06,801][root][INFO] - 
[15/ 15 Epoch]
[2024-09-19 10:05:13,933][root][INFO] - Step: 975/1033  |  Loss: 2.6149  |  Score: 5.04 [%]  |  Seq Length: 128.0
[2024-09-19 10:05:23,958][root][INFO] - Step: 990/1033  |  Loss: 2.7164  |  Score: 0.86 [%]  |  Seq Length: 128.0
[2024-09-19 10:05:33,338][root][INFO] - Step: 1005/1033  |  Loss: 2.6377  |  Score: 6.61 [%]  |  Seq Length: 128.0
[2024-09-19 10:05:43,181][root][INFO] - Step: 1020/1033  |  Loss: 2.4797  |  Score: 11.42 [%]  |  Seq Length: 128.0
[2024-09-19 10:05:52,037][root][INFO] - Step: 1033/1033  |  Loss: 2.3558  |  Score: 16.70 [%]  |  Seq Length: 128.0
[2024-09-19 10:05:57,497][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-19 10:05:57,498][root][INFO] - Score: 5.67 [%]  |  Evaluation Time: 5.46 [s]
[2024-09-19 10:06:02,602][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-19 10:06:02,602][root][INFO] - Score: 1.91 [%]  |  Evaluation Time: 5.10 [s]
[2024-09-19 10:06:02,603][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 10:06:02,603][root][INFO] - - Epoch: 14
[2024-09-19 10:06:02,603][root][INFO] - - DEV score: 8.46 [%]
[2024-09-19 10:06:02,603][root][INFO] - - TEST score: 2.15 [%]
[2024-09-19 10:06:02,604][root][INFO] - Fine-tuning is done!
[2024-09-19 10:36:10,076][root][INFO] - 

[2024-09-19 10:36:10,076][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 10:36:10,076][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs
[2024-09-19 10:36:10,077][root][INFO] - 

[2024-09-19 10:36:10,077][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 128, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 5e-05, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 4, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 10:36:20,051][root][INFO] - 

[2024-09-19 10:36:20,051][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 10:36:20,051][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs
[2024-09-19 10:36:20,051][root][INFO] - 

[2024-09-19 10:36:20,051][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 128, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 5e-05, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 4, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 10:36:35,216][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 10:36:37,163][root][INFO] - 

[2024-09-19 10:36:37,163][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-19 10:36:37,163][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 10:36:37,171][root][INFO] - vocab size              : 51200
[2024-09-19 10:36:37,171][root][INFO] - device                  : gpu
[2024-09-19 10:36:37,171][root][INFO] - random seed             : 42
[2024-09-19 10:36:37,171][root][INFO] - train data size         : 28864
[2024-09-19 10:36:37,171][root][INFO] - max epochs              : 5
[2024-09-19 10:36:37,171][root][INFO] - total steps             : 9020
[2024-09-19 10:36:37,172][root][INFO] - warmup steps            : 902
[2024-09-19 10:36:37,172][root][INFO] - batch size              : 64
[2024-09-19 10:36:37,172][root][INFO] - accumulation steps      : 4
[2024-09-19 10:36:37,172][root][INFO] - optimizer               : adamwscale
[2024-09-19 10:36:37,172][root][INFO] - lr_scheduler            : cosine
[2024-09-19 10:36:37,172][root][INFO] - learning rate           : 5e-05
[2024-09-19 10:36:37,172][root][INFO] - max length              : 128

[2024-09-19 10:36:37,172][root][INFO] - 

[2024-09-19 10:36:37,172][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs
[2024-09-19 10:36:37,172][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs/ckpt
[2024-09-19 10:36:37,172][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs/tb
[2024-09-19 10:36:37,173][root][INFO] - * tb interval           : 100

[2024-09-19 10:36:37,173][root][INFO] - 

[2024-09-19 10:36:37,173][root][INFO] - Start the Training !
[2024-09-19 10:36:37,175][root][INFO] - 
[1/ 5 Epoch]
[2024-09-19 10:36:37,946][root][INFO] - 

[2024-09-19 10:36:37,946][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 10:36:37,946][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs
[2024-09-19 10:36:37,946][root][INFO] - 

[2024-09-19 10:36:37,946][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 128, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 5e-05, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 4, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 10:36:45,184][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-19 10:36:45,185][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-19 10:36:45,185][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-19 10:36:45,186][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-19 10:36:45,186][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-19 10:36:45,186][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-19 10:36:45,187][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-19 10:36:45,187][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-19 10:36:45,188][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-19 10:36:45,188][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-19 10:36:45,188][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-19 10:36:45,189][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-19 10:36:45,189][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-19 10:36:45,190][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-19 10:36:45,190][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-19 10:36:45,190][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-19 10:36:45,191][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-19 10:36:45,191][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-19 10:36:45,192][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-19 10:36:45,192][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-19 10:36:45,193][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-19 10:36:45,193][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-19 10:36:45,193][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-19 10:36:45,194][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-19 10:36:45,196][root][INFO] - Trainable params: 884736 || all params: 126050304 || trainable: 0.70 %
[2024-09-19 10:36:45,372][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 10:36:47,272][root][INFO] - 

[2024-09-19 10:36:47,273][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-19 10:36:47,273][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 10:36:47,281][root][INFO] - vocab size              : 51200
[2024-09-19 10:36:47,281][root][INFO] - device                  : gpu
[2024-09-19 10:36:47,281][root][INFO] - random seed             : 42
[2024-09-19 10:36:47,281][root][INFO] - train data size         : 28864
[2024-09-19 10:36:47,281][root][INFO] - max epochs              : 5
[2024-09-19 10:36:47,281][root][INFO] - total steps             : 9020
[2024-09-19 10:36:47,281][root][INFO] - warmup steps            : 902
[2024-09-19 10:36:47,281][root][INFO] - batch size              : 64
[2024-09-19 10:36:47,282][root][INFO] - accumulation steps      : 4
[2024-09-19 10:36:47,282][root][INFO] - optimizer               : adamwscale
[2024-09-19 10:36:47,282][root][INFO] - lr_scheduler            : cosine
[2024-09-19 10:36:47,282][root][INFO] - learning rate           : 5e-05
[2024-09-19 10:36:47,282][root][INFO] - max length              : 128

[2024-09-19 10:36:47,282][root][INFO] - LoRA Configuration
[2024-09-19 10:36:47,282][root][INFO] - ㄴ r                    : 16
[2024-09-19 10:36:47,282][root][INFO] - ㄴ alpha                : 64
[2024-09-19 10:36:47,282][root][INFO] - ㄴ dropout              : 0.03

[2024-09-19 10:36:47,282][root][INFO] - 

[2024-09-19 10:36:47,282][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs
[2024-09-19 10:36:47,283][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs/ckpt
[2024-09-19 10:36:47,283][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs/tb
[2024-09-19 10:36:47,283][root][INFO] - * tb interval           : 100

[2024-09-19 10:36:47,283][root][INFO] - 

[2024-09-19 10:36:47,283][root][INFO] - Start the Training !
[2024-09-19 10:36:47,286][root][INFO] - 
[1/ 5 Epoch]
[2024-09-19 10:37:02,406][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-19 10:37:02,406][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-19 10:37:02,407][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-19 10:37:02,407][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-19 10:37:02,408][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-19 10:37:02,408][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-19 10:37:02,408][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-19 10:37:02,409][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-19 10:37:02,409][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-19 10:37:02,409][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-19 10:37:02,410][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-19 10:37:02,410][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-19 10:37:02,411][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-19 10:37:02,411][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-19 10:37:02,412][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-19 10:37:02,412][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-19 10:37:02,412][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-19 10:37:02,413][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-19 10:37:02,413][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-19 10:37:02,414][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-19 10:37:02,414][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-19 10:37:02,414][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-19 10:37:02,415][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-19 10:37:02,415][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-19 10:37:02,417][root][INFO] - Trainable params: 884736 || all params: 126050304 || trainable: 0.70 %
[2024-09-19 10:37:02,422][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-19 10:37:02,428][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-19 10:37:02,430][root][INFO] - Trainable params: 1298304 || all params: 126463872 || trainable: 1.03 %
[2024-09-19 10:37:02,606][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 10:37:04,784][root][INFO] - 

[2024-09-19 10:37:04,784][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-19 10:37:04,785][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 10:37:04,794][root][INFO] - vocab size              : 51200
[2024-09-19 10:37:04,794][root][INFO] - device                  : gpu
[2024-09-19 10:37:04,794][root][INFO] - random seed             : 42
[2024-09-19 10:37:04,794][root][INFO] - train data size         : 28864
[2024-09-19 10:37:04,794][root][INFO] - max epochs              : 5
[2024-09-19 10:37:04,794][root][INFO] - total steps             : 9020
[2024-09-19 10:37:04,794][root][INFO] - warmup steps            : 902
[2024-09-19 10:37:04,795][root][INFO] - batch size              : 64
[2024-09-19 10:37:04,795][root][INFO] - accumulation steps      : 4
[2024-09-19 10:37:04,795][root][INFO] - optimizer               : adamwscale
[2024-09-19 10:37:04,795][root][INFO] - lr_scheduler            : cosine
[2024-09-19 10:37:04,795][root][INFO] - learning rate           : 5e-05
[2024-09-19 10:37:04,795][root][INFO] - max length              : 128

[2024-09-19 10:37:04,795][root][INFO] - LoRA Configuration
[2024-09-19 10:37:04,795][root][INFO] - ㄴ r                    : 16
[2024-09-19 10:37:04,795][root][INFO] - ㄴ alpha                : 64
[2024-09-19 10:37:04,795][root][INFO] - ㄴ dropout              : 0.03

[2024-09-19 10:37:04,795][root][INFO] - KOMBO Configuration
[2024-09-19 10:37:04,795][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-19 10:37:04,796][root][INFO] - ㄴ reducer              : linear
[2024-09-19 10:37:04,796][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-19 10:37:04,796][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-19 10:37:04,796][root][INFO] - ㄴ do_combination       : False
[2024-09-19 10:37:04,796][root][INFO] - 

[2024-09-19 10:37:04,796][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs
[2024-09-19 10:37:04,796][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs/ckpt
[2024-09-19 10:37:04,796][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs/tb
[2024-09-19 10:37:04,796][root][INFO] - * tb interval           : 100

[2024-09-19 10:37:04,796][root][INFO] - 

[2024-09-19 10:37:04,796][root][INFO] - Start the Training !
[2024-09-19 10:37:04,799][root][INFO] - 
[1/ 5 Epoch]
[2024-09-19 10:37:10,750][root][INFO] - Step: 100/9020  |  Loss: 0.7038  |  Score: 59.41 [%]  |  Seq Length: 128.0
[2024-09-19 10:37:17,830][root][INFO] - Step: 100/9020  |  Loss: 0.9553  |  Score: 48.53 [%]  |  Seq Length: 128.0
[2024-09-19 10:37:41,929][root][INFO] - Step: 200/9020  |  Loss: 0.5332  |  Score: 74.34 [%]  |  Seq Length: 128.0
[2024-09-19 10:37:45,551][root][INFO] - Step: 200/9020  |  Loss: 0.9379  |  Score: 46.94 [%]  |  Seq Length: 128.0
[2024-09-19 10:37:47,241][root][INFO] - Step: 100/9020  |  Loss: 0.9631  |  Score: 47.75 [%]  |  Seq Length: 128.0
[2024-09-19 10:38:12,544][root][INFO] - Step: 300/9020  |  Loss: 0.4663  |  Score: 78.41 [%]  |  Seq Length: 128.0
[2024-09-19 10:38:14,299][root][INFO] - Step: 300/9020  |  Loss: 0.8871  |  Score: 47.05 [%]  |  Seq Length: 128.0
[2024-09-19 10:38:26,868][root][INFO] - Step: 200/9020  |  Loss: 0.9255  |  Score: 47.17 [%]  |  Seq Length: 128.0
[2024-09-19 10:38:43,146][root][INFO] - Step: 400/9020  |  Loss: 0.8638  |  Score: 46.30 [%]  |  Seq Length: 128.0
[2024-09-19 10:38:43,255][root][INFO] - Step: 400/9020  |  Loss: 0.4260  |  Score: 80.80 [%]  |  Seq Length: 128.0
[2024-09-19 10:39:07,136][root][INFO] - Step: 300/9020  |  Loss: 0.8873  |  Score: 46.97 [%]  |  Seq Length: 128.0
[2024-09-19 10:39:11,922][root][INFO] - Step: 500/9020  |  Loss: 0.8241  |  Score: 48.08 [%]  |  Seq Length: 128.0
[2024-09-19 10:39:13,381][root][INFO] - Step: 500/9020  |  Loss: 0.4129  |  Score: 81.75 [%]  |  Seq Length: 128.0
[2024-09-19 10:39:39,839][root][INFO] - Step: 600/9020  |  Loss: 0.8222  |  Score: 47.69 [%]  |  Seq Length: 128.0
[2024-09-19 10:39:43,000][root][INFO] - Step: 600/9020  |  Loss: 0.3989  |  Score: 82.16 [%]  |  Seq Length: 128.0
[2024-09-19 10:39:47,789][root][INFO] - Step: 400/9020  |  Loss: 0.8704  |  Score: 46.45 [%]  |  Seq Length: 128.0
[2024-09-19 10:40:08,496][root][INFO] - Step: 700/9020  |  Loss: 0.8189  |  Score: 47.89 [%]  |  Seq Length: 128.0
[2024-09-19 10:40:11,336][root][INFO] - Step: 700/9020  |  Loss: 0.3939  |  Score: 82.16 [%]  |  Seq Length: 128.0
[2024-09-19 10:40:26,718][root][INFO] - Step: 500/9020  |  Loss: 0.8420  |  Score: 46.78 [%]  |  Seq Length: 128.0
[2024-09-19 10:40:37,443][root][INFO] - Step: 800/9020  |  Loss: 0.7933  |  Score: 49.88 [%]  |  Seq Length: 128.0
[2024-09-19 10:40:41,942][root][INFO] - Step: 800/9020  |  Loss: 0.3746  |  Score: 83.86 [%]  |  Seq Length: 128.0
[2024-09-19 10:41:06,035][root][INFO] - Step: 900/9020  |  Loss: 0.7866  |  Score: 49.98 [%]  |  Seq Length: 128.0
[2024-09-19 10:41:07,227][root][INFO] - Step: 600/9020  |  Loss: 0.8216  |  Score: 47.62 [%]  |  Seq Length: 128.0
[2024-09-19 10:41:12,360][root][INFO] - Step: 900/9020  |  Loss: 0.3680  |  Score: 83.56 [%]  |  Seq Length: 128.0
[2024-09-19 10:41:34,775][root][INFO] - Step: 1000/9020  |  Loss: 0.7816  |  Score: 50.53 [%]  |  Seq Length: 128.0
[2024-09-19 10:41:42,839][root][INFO] - Step: 1000/9020  |  Loss: 0.3855  |  Score: 82.75 [%]  |  Seq Length: 128.0
[2024-09-19 10:41:46,853][root][INFO] - Step: 700/9020  |  Loss: 0.8121  |  Score: 48.55 [%]  |  Seq Length: 128.0
[2024-09-19 10:42:03,754][root][INFO] - Step: 1100/9020  |  Loss: 0.7723  |  Score: 50.94 [%]  |  Seq Length: 128.0
[2024-09-19 10:42:14,259][root][INFO] - Step: 1100/9020  |  Loss: 0.3472  |  Score: 85.16 [%]  |  Seq Length: 128.0
[2024-09-19 10:42:25,799][root][INFO] - Step: 800/9020  |  Loss: 0.7997  |  Score: 49.22 [%]  |  Seq Length: 128.0
[2024-09-19 10:42:32,155][root][INFO] - Step: 1200/9020  |  Loss: 0.7676  |  Score: 50.89 [%]  |  Seq Length: 128.0
[2024-09-19 10:42:45,362][root][INFO] - Step: 1200/9020  |  Loss: 0.3510  |  Score: 84.62 [%]  |  Seq Length: 128.0
[2024-09-19 10:43:00,503][root][INFO] - Step: 1300/9020  |  Loss: 0.7493  |  Score: 52.94 [%]  |  Seq Length: 128.0
[2024-09-19 10:43:05,560][root][INFO] - Step: 900/9020  |  Loss: 0.7785  |  Score: 51.16 [%]  |  Seq Length: 128.0
[2024-09-19 10:43:16,451][root][INFO] - Step: 1300/9020  |  Loss: 0.3465  |  Score: 84.84 [%]  |  Seq Length: 128.0
[2024-09-19 10:43:29,034][root][INFO] - Step: 1400/9020  |  Loss: 0.7399  |  Score: 53.92 [%]  |  Seq Length: 128.0
[2024-09-19 10:43:46,300][root][INFO] - Step: 1000/9020  |  Loss: 0.7525  |  Score: 52.39 [%]  |  Seq Length: 128.0
[2024-09-19 10:43:47,032][root][INFO] - Step: 1400/9020  |  Loss: 0.3617  |  Score: 84.64 [%]  |  Seq Length: 128.0
[2024-09-19 10:43:56,125][root][INFO] - Step: 1500/9020  |  Loss: 0.7383  |  Score: 54.34 [%]  |  Seq Length: 128.0
[2024-09-19 10:44:18,526][root][INFO] - Step: 1500/9020  |  Loss: 0.3448  |  Score: 84.97 [%]  |  Seq Length: 128.0
[2024-09-19 10:44:24,833][root][INFO] - Step: 1600/9020  |  Loss: 0.7169  |  Score: 55.36 [%]  |  Seq Length: 128.0
[2024-09-19 10:44:26,061][root][INFO] - Step: 1100/9020  |  Loss: 0.7474  |  Score: 52.88 [%]  |  Seq Length: 128.0
[2024-09-19 10:44:49,084][root][INFO] - Step: 1600/9020  |  Loss: 0.3500  |  Score: 84.33 [%]  |  Seq Length: 128.0
[2024-09-19 10:44:53,155][root][INFO] - Step: 1700/9020  |  Loss: 0.7127  |  Score: 56.83 [%]  |  Seq Length: 128.0
[2024-09-19 10:45:05,695][root][INFO] - Step: 1200/9020  |  Loss: 0.7244  |  Score: 55.41 [%]  |  Seq Length: 128.0
[2024-09-19 10:45:20,511][root][INFO] - Step: 1700/9020  |  Loss: 0.3361  |  Score: 85.23 [%]  |  Seq Length: 128.0
[2024-09-19 10:45:21,284][root][INFO] - Step: 1800/9020  |  Loss: 0.7142  |  Score: 56.48 [%]  |  Seq Length: 128.0
[2024-09-19 10:45:22,521][root][INFO] - Step: 1804/9020  |  Loss: 0.7556  |  Score: 54.14 [%]  |  Seq Length: 128.0
[2024-09-19 10:45:42,078][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 10:45:42,078][root][INFO] - Score: 56.43 [%]  |  Evaluation Time: 19.55 [s]
[2024-09-19 10:45:45,820][root][INFO] - Step: 1300/9020  |  Loss: 0.7181  |  Score: 55.53 [%]  |  Seq Length: 128.0
[2024-09-19 10:45:52,932][root][INFO] - Step: 1800/9020  |  Loss: 0.3447  |  Score: 84.70 [%]  |  Seq Length: 128.0
[2024-09-19 10:45:54,268][root][INFO] - Step: 1804/9020  |  Loss: 0.3097  |  Score: 89.45 [%]  |  Seq Length: 128.0
[2024-09-19 10:46:12,981][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 10:46:12,981][root][INFO] - Score: 85.79 [%]  |  Evaluation Time: 18.71 [s]
[2024-09-19 10:46:25,661][root][INFO] - Step: 1400/9020  |  Loss: 0.7041  |  Score: 57.48 [%]  |  Seq Length: 128.0
[2024-09-19 10:46:47,370][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 10:46:47,370][root][INFO] - Score: 56.81 [%]  |  Evaluation Time: 65.29 [s]
[2024-09-19 10:46:47,371][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 10:46:47,372][root][INFO] - 
[2/ 5 Epoch]
[2024-09-19 10:47:05,982][root][INFO] - Step: 1500/9020  |  Loss: 0.7051  |  Score: 56.75 [%]  |  Seq Length: 128.0
[2024-09-19 10:47:11,901][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 10:47:11,902][root][INFO] - Score: 85.90 [%]  |  Evaluation Time: 58.92 [s]
[2024-09-19 10:47:11,903][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 10:47:11,904][root][INFO] - 
[2/ 5 Epoch]
[2024-09-19 10:47:15,774][root][INFO] - Step: 1900/9020  |  Loss: 0.6995  |  Score: 57.23 [%]  |  Seq Length: 128.0
[2024-09-19 10:47:42,240][root][INFO] - Step: 1900/9020  |  Loss: 0.3280  |  Score: 85.64 [%]  |  Seq Length: 128.0
[2024-09-19 10:47:43,126][root][INFO] - Step: 2000/9020  |  Loss: 0.6956  |  Score: 58.09 [%]  |  Seq Length: 128.0
[2024-09-19 10:47:46,004][root][INFO] - Step: 1600/9020  |  Loss: 0.6865  |  Score: 58.05 [%]  |  Seq Length: 128.0
[2024-09-19 10:48:11,514][root][INFO] - Step: 2100/9020  |  Loss: 0.6957  |  Score: 58.20 [%]  |  Seq Length: 128.0
[2024-09-19 10:48:13,496][root][INFO] - Step: 2000/9020  |  Loss: 0.3137  |  Score: 86.62 [%]  |  Seq Length: 128.0
[2024-09-19 10:48:26,381][root][INFO] - Step: 1700/9020  |  Loss: 0.6859  |  Score: 58.84 [%]  |  Seq Length: 128.0
[2024-09-19 10:48:40,132][root][INFO] - Step: 2200/9020  |  Loss: 0.6896  |  Score: 58.91 [%]  |  Seq Length: 128.0
[2024-09-19 10:48:44,630][root][INFO] - Step: 2100/9020  |  Loss: 0.3148  |  Score: 86.17 [%]  |  Seq Length: 128.0
[2024-09-19 10:49:06,510][root][INFO] - Step: 1800/9020  |  Loss: 0.6823  |  Score: 59.19 [%]  |  Seq Length: 128.0
[2024-09-19 10:49:08,136][root][INFO] - Step: 1804/9020  |  Loss: 0.6879  |  Score: 61.48 [%]  |  Seq Length: 128.0
[2024-09-19 10:49:08,870][root][INFO] - Step: 2300/9020  |  Loss: 0.6755  |  Score: 60.39 [%]  |  Seq Length: 128.0
[2024-09-19 10:49:14,899][root][INFO] - Step: 2200/9020  |  Loss: 0.3223  |  Score: 86.23 [%]  |  Seq Length: 128.0
[2024-09-19 10:49:37,365][root][INFO] - Step: 2400/9020  |  Loss: 0.6708  |  Score: 60.28 [%]  |  Seq Length: 128.0
[2024-09-19 10:49:40,974][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 10:49:40,975][root][INFO] - Score: 60.86 [%]  |  Evaluation Time: 32.84 [s]
[2024-09-19 10:49:44,936][root][INFO] - Step: 2300/9020  |  Loss: 0.3196  |  Score: 86.69 [%]  |  Seq Length: 128.0
[2024-09-19 10:50:05,528][root][INFO] - Step: 2500/9020  |  Loss: 0.6669  |  Score: 61.41 [%]  |  Seq Length: 128.0
[2024-09-19 10:50:15,902][root][INFO] - Step: 2400/9020  |  Loss: 0.3141  |  Score: 86.50 [%]  |  Seq Length: 128.0
[2024-09-19 10:50:33,668][root][INFO] - Step: 2600/9020  |  Loss: 0.6620  |  Score: 62.02 [%]  |  Seq Length: 128.0
[2024-09-19 10:50:46,725][root][INFO] - Step: 2500/9020  |  Loss: 0.3132  |  Score: 86.67 [%]  |  Seq Length: 128.0
[2024-09-19 10:51:01,730][root][INFO] - Step: 2700/9020  |  Loss: 0.6568  |  Score: 62.44 [%]  |  Seq Length: 128.0
[2024-09-19 10:51:17,641][root][INFO] - Step: 2600/9020  |  Loss: 0.3006  |  Score: 86.81 [%]  |  Seq Length: 128.0
[2024-09-19 10:51:29,650][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 10:51:29,651][root][INFO] - Score: 61.16 [%]  |  Evaluation Time: 108.67 [s]
[2024-09-19 10:51:29,652][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 10:51:29,654][root][INFO] - 
[2/ 5 Epoch]
[2024-09-19 10:51:29,790][root][INFO] - Step: 2800/9020  |  Loss: 0.6539  |  Score: 63.28 [%]  |  Seq Length: 128.0
[2024-09-19 10:51:47,963][root][INFO] - Step: 2700/9020  |  Loss: 0.3183  |  Score: 86.50 [%]  |  Seq Length: 128.0
[2024-09-19 10:51:57,468][root][INFO] - Step: 2900/9020  |  Loss: 0.6385  |  Score: 64.27 [%]  |  Seq Length: 128.0
[2024-09-19 10:52:07,560][root][INFO] - Step: 1900/9020  |  Loss: 0.6615  |  Score: 61.04 [%]  |  Seq Length: 128.0
[2024-09-19 10:52:18,670][root][INFO] - Step: 2800/9020  |  Loss: 0.2979  |  Score: 87.62 [%]  |  Seq Length: 128.0
[2024-09-19 10:52:25,636][root][INFO] - Step: 3000/9020  |  Loss: 0.6343  |  Score: 64.28 [%]  |  Seq Length: 128.0
[2024-09-19 10:52:46,466][root][INFO] - Step: 2000/9020  |  Loss: 0.6582  |  Score: 62.27 [%]  |  Seq Length: 128.0
[2024-09-19 10:52:49,932][root][INFO] - Step: 2900/9020  |  Loss: 0.2988  |  Score: 87.47 [%]  |  Seq Length: 128.0
[2024-09-19 10:52:54,054][root][INFO] - Step: 3100/9020  |  Loss: 0.6236  |  Score: 65.03 [%]  |  Seq Length: 128.0
[2024-09-19 10:53:20,803][root][INFO] - Step: 3000/9020  |  Loss: 0.3189  |  Score: 86.19 [%]  |  Seq Length: 128.0
[2024-09-19 10:53:21,879][root][INFO] - Step: 3200/9020  |  Loss: 0.6167  |  Score: 66.59 [%]  |  Seq Length: 128.0
[2024-09-19 10:53:25,874][root][INFO] - Step: 2100/9020  |  Loss: 0.6531  |  Score: 62.41 [%]  |  Seq Length: 128.0
[2024-09-19 10:53:50,415][root][INFO] - Step: 3300/9020  |  Loss: 0.6147  |  Score: 67.20 [%]  |  Seq Length: 128.0
[2024-09-19 10:53:51,993][root][INFO] - Step: 3100/9020  |  Loss: 0.3096  |  Score: 87.11 [%]  |  Seq Length: 128.0
[2024-09-19 10:54:04,060][root][INFO] - Step: 2200/9020  |  Loss: 0.6436  |  Score: 63.69 [%]  |  Seq Length: 128.0
[2024-09-19 10:54:17,945][root][INFO] - Step: 3400/9020  |  Loss: 0.6119  |  Score: 66.52 [%]  |  Seq Length: 128.0
[2024-09-19 10:54:22,449][root][INFO] - Step: 3200/9020  |  Loss: 0.3024  |  Score: 87.12 [%]  |  Seq Length: 128.0
[2024-09-19 10:54:43,087][root][INFO] - Step: 2300/9020  |  Loss: 0.6466  |  Score: 63.20 [%]  |  Seq Length: 128.0
[2024-09-19 10:54:46,455][root][INFO] - Step: 3500/9020  |  Loss: 0.6059  |  Score: 67.48 [%]  |  Seq Length: 128.0
[2024-09-19 10:54:52,934][root][INFO] - Step: 3300/9020  |  Loss: 0.3033  |  Score: 87.12 [%]  |  Seq Length: 128.0
[2024-09-19 10:55:14,280][root][INFO] - Step: 3600/9020  |  Loss: 0.5982  |  Score: 68.09 [%]  |  Seq Length: 128.0
[2024-09-19 10:55:16,393][root][INFO] - Step: 3608/9020  |  Loss: 0.6085  |  Score: 66.91 [%]  |  Seq Length: 128.0
[2024-09-19 10:55:17,467][root][INFO] - Step: 2400/9020  |  Loss: 0.6413  |  Score: 63.59 [%]  |  Seq Length: 128.0
[2024-09-19 10:55:23,871][root][INFO] - Step: 3400/9020  |  Loss: 0.3016  |  Score: 87.39 [%]  |  Seq Length: 128.0
[2024-09-19 10:55:35,964][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 10:55:35,964][root][INFO] - Score: 68.68 [%]  |  Evaluation Time: 19.57 [s]
[2024-09-19 10:55:54,034][root][INFO] - Step: 2500/9020  |  Loss: 0.6270  |  Score: 65.22 [%]  |  Seq Length: 128.0
[2024-09-19 10:55:55,019][root][INFO] - Step: 3500/9020  |  Loss: 0.3041  |  Score: 86.94 [%]  |  Seq Length: 128.0
[2024-09-19 10:56:25,710][root][INFO] - Step: 3600/9020  |  Loss: 0.3074  |  Score: 87.05 [%]  |  Seq Length: 128.0
[2024-09-19 10:56:28,160][root][INFO] - Step: 3608/9020  |  Loss: 0.2901  |  Score: 88.05 [%]  |  Seq Length: 128.0
[2024-09-19 10:56:30,755][root][INFO] - Step: 2600/9020  |  Loss: 0.6185  |  Score: 66.27 [%]  |  Seq Length: 128.0
[2024-09-19 10:56:40,074][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 10:56:40,075][root][INFO] - Score: 68.70 [%]  |  Evaluation Time: 64.11 [s]
[2024-09-19 10:56:40,076][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 10:56:40,077][root][INFO] - 
[3/ 5 Epoch]
[2024-09-19 10:56:46,047][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 10:56:46,048][root][INFO] - Score: 86.79 [%]  |  Evaluation Time: 17.88 [s]
[2024-09-19 10:57:06,458][root][INFO] - Step: 3700/9020  |  Loss: 0.5903  |  Score: 69.75 [%]  |  Seq Length: 128.0
[2024-09-19 10:57:10,190][root][INFO] - Step: 2700/9020  |  Loss: 0.6152  |  Score: 67.11 [%]  |  Seq Length: 128.0
[2024-09-19 10:57:34,753][root][INFO] - Step: 3800/9020  |  Loss: 0.5940  |  Score: 68.53 [%]  |  Seq Length: 128.0
[2024-09-19 10:57:46,836][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 10:57:46,836][root][INFO] - Score: 87.17 [%]  |  Evaluation Time: 60.79 [s]
[2024-09-19 10:57:46,838][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 10:57:46,839][root][INFO] - 
[3/ 5 Epoch]
[2024-09-19 10:57:49,402][root][INFO] - Step: 2800/9020  |  Loss: 0.6056  |  Score: 67.73 [%]  |  Seq Length: 128.0
[2024-09-19 10:58:02,933][root][INFO] - Step: 3900/9020  |  Loss: 0.5850  |  Score: 69.05 [%]  |  Seq Length: 128.0
[2024-09-19 10:58:15,579][root][INFO] - Step: 3700/9020  |  Loss: 0.2786  |  Score: 88.45 [%]  |  Seq Length: 128.0
[2024-09-19 10:58:28,415][root][INFO] - Step: 2900/9020  |  Loss: 0.6017  |  Score: 68.16 [%]  |  Seq Length: 128.0
[2024-09-19 10:58:30,974][root][INFO] - Step: 4000/9020  |  Loss: 0.5834  |  Score: 70.23 [%]  |  Seq Length: 128.0
[2024-09-19 10:58:46,650][root][INFO] - Step: 3800/9020  |  Loss: 0.2891  |  Score: 87.80 [%]  |  Seq Length: 128.0
[2024-09-19 10:58:59,652][root][INFO] - Step: 4100/9020  |  Loss: 0.5765  |  Score: 69.92 [%]  |  Seq Length: 128.0
[2024-09-19 10:59:07,476][root][INFO] - Step: 3000/9020  |  Loss: 0.6002  |  Score: 68.50 [%]  |  Seq Length: 128.0
[2024-09-19 10:59:18,442][root][INFO] - Step: 3900/9020  |  Loss: 0.2807  |  Score: 88.73 [%]  |  Seq Length: 128.0
[2024-09-19 10:59:27,618][root][INFO] - Step: 4200/9020  |  Loss: 0.5636  |  Score: 71.67 [%]  |  Seq Length: 128.0
[2024-09-19 10:59:46,805][root][INFO] - Step: 3100/9020  |  Loss: 0.5955  |  Score: 68.64 [%]  |  Seq Length: 128.0
[2024-09-19 10:59:48,930][root][INFO] - Step: 4000/9020  |  Loss: 0.2756  |  Score: 88.81 [%]  |  Seq Length: 128.0
[2024-09-19 10:59:55,518][root][INFO] - Step: 4300/9020  |  Loss: 0.5570  |  Score: 71.75 [%]  |  Seq Length: 128.0
[2024-09-19 11:00:19,806][root][INFO] - Step: 4100/9020  |  Loss: 0.2774  |  Score: 88.30 [%]  |  Seq Length: 128.0
[2024-09-19 11:00:23,911][root][INFO] - Step: 4400/9020  |  Loss: 0.5529  |  Score: 72.22 [%]  |  Seq Length: 128.0
[2024-09-19 11:00:26,013][root][INFO] - Step: 3200/9020  |  Loss: 0.5956  |  Score: 69.55 [%]  |  Seq Length: 128.0
[2024-09-19 11:00:50,792][root][INFO] - Step: 4200/9020  |  Loss: 0.2886  |  Score: 87.17 [%]  |  Seq Length: 128.0
[2024-09-19 11:00:52,230][root][INFO] - Step: 4500/9020  |  Loss: 0.5523  |  Score: 72.42 [%]  |  Seq Length: 128.0
[2024-09-19 11:01:05,218][root][INFO] - Step: 3300/9020  |  Loss: 0.5812  |  Score: 70.58 [%]  |  Seq Length: 128.0
[2024-09-19 11:01:20,027][root][INFO] - Step: 4300/9020  |  Loss: 0.2957  |  Score: 87.23 [%]  |  Seq Length: 128.0
[2024-09-19 11:01:20,807][root][INFO] - Step: 4600/9020  |  Loss: 0.5533  |  Score: 72.38 [%]  |  Seq Length: 128.0
[2024-09-19 11:01:44,680][root][INFO] - Step: 3400/9020  |  Loss: 0.5863  |  Score: 69.38 [%]  |  Seq Length: 128.0
[2024-09-19 11:01:49,384][root][INFO] - Step: 4700/9020  |  Loss: 0.5507  |  Score: 73.33 [%]  |  Seq Length: 128.0
[2024-09-19 11:01:50,800][root][INFO] - Step: 4400/9020  |  Loss: 0.2807  |  Score: 88.14 [%]  |  Seq Length: 128.0
[2024-09-19 11:02:18,093][root][INFO] - Step: 4800/9020  |  Loss: 0.5472  |  Score: 73.08 [%]  |  Seq Length: 128.0
[2024-09-19 11:02:21,250][root][INFO] - Step: 4500/9020  |  Loss: 0.2827  |  Score: 88.23 [%]  |  Seq Length: 128.0
[2024-09-19 11:02:23,836][root][INFO] - Step: 3500/9020  |  Loss: 0.5812  |  Score: 70.20 [%]  |  Seq Length: 128.0
[2024-09-19 11:02:46,543][root][INFO] - Step: 4900/9020  |  Loss: 0.5471  |  Score: 73.00 [%]  |  Seq Length: 128.0
[2024-09-19 11:02:52,365][root][INFO] - Step: 4600/9020  |  Loss: 0.2749  |  Score: 88.41 [%]  |  Seq Length: 128.0
[2024-09-19 11:03:00,704][root][INFO] - Step: 3600/9020  |  Loss: 0.5723  |  Score: 70.86 [%]  |  Seq Length: 128.0
[2024-09-19 11:03:04,106][root][INFO] - Step: 3608/9020  |  Loss: 0.5977  |  Score: 71.25 [%]  |  Seq Length: 128.0
[2024-09-19 11:03:14,039][root][INFO] - Step: 5000/9020  |  Loss: 0.5285  |  Score: 74.39 [%]  |  Seq Length: 128.0
[2024-09-19 11:03:22,723][root][INFO] - Step: 4700/9020  |  Loss: 0.2887  |  Score: 87.61 [%]  |  Seq Length: 128.0
[2024-09-19 11:03:39,410][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 11:03:39,410][root][INFO] - Score: 72.06 [%]  |  Evaluation Time: 35.30 [s]
[2024-09-19 11:03:42,648][root][INFO] - Step: 5100/9020  |  Loss: 0.5347  |  Score: 73.77 [%]  |  Seq Length: 128.0
[2024-09-19 11:03:52,995][root][INFO] - Step: 4800/9020  |  Loss: 0.2899  |  Score: 88.12 [%]  |  Seq Length: 128.0
[2024-09-19 11:04:11,225][root][INFO] - Step: 5200/9020  |  Loss: 0.5175  |  Score: 75.50 [%]  |  Seq Length: 128.0
[2024-09-19 11:04:23,670][root][INFO] - Step: 4900/9020  |  Loss: 0.2694  |  Score: 88.62 [%]  |  Seq Length: 128.0
[2024-09-19 11:04:39,538][root][INFO] - Step: 5300/9020  |  Loss: 0.5350  |  Score: 74.42 [%]  |  Seq Length: 128.0
[2024-09-19 11:04:54,239][root][INFO] - Step: 5000/9020  |  Loss: 0.2950  |  Score: 87.44 [%]  |  Seq Length: 128.0
[2024-09-19 11:05:07,026][root][INFO] - Step: 5400/9020  |  Loss: 0.5161  |  Score: 75.27 [%]  |  Seq Length: 128.0
[2024-09-19 11:05:10,585][root][INFO] - Step: 5412/9020  |  Loss: 0.5392  |  Score: 74.35 [%]  |  Seq Length: 128.0
[2024-09-19 11:05:25,378][root][INFO] - Step: 5100/9020  |  Loss: 0.2846  |  Score: 88.45 [%]  |  Seq Length: 128.0
[2024-09-19 11:05:30,217][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 11:05:30,218][root][INFO] - Score: 72.30 [%]  |  Evaluation Time: 110.80 [s]
[2024-09-19 11:05:30,220][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 11:05:30,222][root][INFO] - 
[3/ 5 Epoch]
[2024-09-19 11:05:30,504][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 11:05:30,505][root][INFO] - Score: 74.83 [%]  |  Evaluation Time: 19.92 [s]
[2024-09-19 11:05:55,767][root][INFO] - Step: 5200/9020  |  Loss: 0.2768  |  Score: 88.31 [%]  |  Seq Length: 128.0
[2024-09-19 11:06:06,478][root][INFO] - Step: 3700/9020  |  Loss: 0.5632  |  Score: 71.60 [%]  |  Seq Length: 128.0
[2024-09-19 11:06:26,398][root][INFO] - Step: 5300/9020  |  Loss: 0.2852  |  Score: 88.20 [%]  |  Seq Length: 128.0
[2024-09-19 11:06:34,382][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 11:06:34,383][root][INFO] - Score: 75.15 [%]  |  Evaluation Time: 63.88 [s]
[2024-09-19 11:06:34,384][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-19 11:06:34,385][root][INFO] - 
[4/ 5 Epoch]
[2024-09-19 11:06:45,680][root][INFO] - Step: 3800/9020  |  Loss: 0.5743  |  Score: 70.66 [%]  |  Seq Length: 128.0
[2024-09-19 11:06:57,340][root][INFO] - Step: 5400/9020  |  Loss: 0.2796  |  Score: 88.19 [%]  |  Seq Length: 128.0
[2024-09-19 11:06:59,360][root][INFO] - Step: 5500/9020  |  Loss: 0.5280  |  Score: 74.47 [%]  |  Seq Length: 128.0
[2024-09-19 11:07:01,391][root][INFO] - Step: 5412/9020  |  Loss: 0.3090  |  Score: 86.93 [%]  |  Seq Length: 128.0
[2024-09-19 11:07:19,103][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 11:07:19,103][root][INFO] - Score: 87.36 [%]  |  Evaluation Time: 17.71 [s]
[2024-09-19 11:07:24,601][root][INFO] - Step: 3900/9020  |  Loss: 0.5726  |  Score: 71.20 [%]  |  Seq Length: 128.0
[2024-09-19 11:07:26,733][root][INFO] - Step: 5600/9020  |  Loss: 0.5234  |  Score: 74.73 [%]  |  Seq Length: 128.0
[2024-09-19 11:07:55,126][root][INFO] - Step: 5700/9020  |  Loss: 0.5175  |  Score: 75.03 [%]  |  Seq Length: 128.0
[2024-09-19 11:08:03,987][root][INFO] - Step: 4000/9020  |  Loss: 0.5636  |  Score: 71.09 [%]  |  Seq Length: 128.0
[2024-09-19 11:08:18,009][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 11:08:18,009][root][INFO] - Score: 87.58 [%]  |  Evaluation Time: 58.90 [s]
[2024-09-19 11:08:18,010][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-19 11:08:18,011][root][INFO] - 
[4/ 5 Epoch]
[2024-09-19 11:08:23,329][root][INFO] - Step: 5800/9020  |  Loss: 0.5074  |  Score: 75.86 [%]  |  Seq Length: 128.0
[2024-09-19 11:08:42,048][root][INFO] - Step: 4100/9020  |  Loss: 0.5553  |  Score: 72.78 [%]  |  Seq Length: 128.0
[2024-09-19 11:08:44,992][root][INFO] - Step: 5500/9020  |  Loss: 0.2605  |  Score: 89.04 [%]  |  Seq Length: 128.0
[2024-09-19 11:08:50,536][root][INFO] - Step: 5900/9020  |  Loss: 0.5165  |  Score: 75.38 [%]  |  Seq Length: 128.0
[2024-09-19 11:09:14,994][root][INFO] - Step: 5600/9020  |  Loss: 0.2694  |  Score: 88.77 [%]  |  Seq Length: 128.0
[2024-09-19 11:09:17,809][root][INFO] - Step: 6000/9020  |  Loss: 0.5083  |  Score: 75.64 [%]  |  Seq Length: 128.0
[2024-09-19 11:09:20,308][root][INFO] - Step: 4200/9020  |  Loss: 0.5607  |  Score: 71.53 [%]  |  Seq Length: 128.0
[2024-09-19 11:09:45,298][root][INFO] - Step: 5700/9020  |  Loss: 0.2715  |  Score: 88.95 [%]  |  Seq Length: 128.0
[2024-09-19 11:09:46,001][root][INFO] - Step: 6100/9020  |  Loss: 0.4987  |  Score: 76.73 [%]  |  Seq Length: 128.0
[2024-09-19 11:09:59,076][root][INFO] - Step: 4300/9020  |  Loss: 0.5612  |  Score: 71.95 [%]  |  Seq Length: 128.0
[2024-09-19 11:10:14,117][root][INFO] - Step: 6200/9020  |  Loss: 0.5144  |  Score: 75.47 [%]  |  Seq Length: 128.0
[2024-09-19 11:10:16,516][root][INFO] - Step: 5800/9020  |  Loss: 0.2636  |  Score: 89.16 [%]  |  Seq Length: 128.0
[2024-09-19 11:10:37,896][root][INFO] - Step: 4400/9020  |  Loss: 0.5696  |  Score: 70.88 [%]  |  Seq Length: 128.0
[2024-09-19 11:10:41,791][root][INFO] - Step: 6300/9020  |  Loss: 0.5077  |  Score: 75.62 [%]  |  Seq Length: 128.0
[2024-09-19 11:10:47,048][root][INFO] - Step: 5900/9020  |  Loss: 0.2817  |  Score: 88.64 [%]  |  Seq Length: 128.0
[2024-09-19 11:11:08,994][root][INFO] - Step: 6400/9020  |  Loss: 0.5096  |  Score: 75.42 [%]  |  Seq Length: 128.0
[2024-09-19 11:11:16,460][root][INFO] - Step: 4500/9020  |  Loss: 0.5551  |  Score: 72.06 [%]  |  Seq Length: 128.0
[2024-09-19 11:11:17,329][root][INFO] - Step: 6000/9020  |  Loss: 0.2814  |  Score: 88.20 [%]  |  Seq Length: 128.0
[2024-09-19 11:11:36,935][root][INFO] - Step: 6500/9020  |  Loss: 0.5049  |  Score: 76.20 [%]  |  Seq Length: 128.0
[2024-09-19 11:11:47,736][root][INFO] - Step: 6100/9020  |  Loss: 0.2805  |  Score: 88.03 [%]  |  Seq Length: 128.0
[2024-09-19 11:11:55,205][root][INFO] - Step: 4600/9020  |  Loss: 0.5500  |  Score: 72.78 [%]  |  Seq Length: 128.0
[2024-09-19 11:12:05,470][root][INFO] - Step: 6600/9020  |  Loss: 0.4934  |  Score: 76.39 [%]  |  Seq Length: 128.0
[2024-09-19 11:12:17,859][root][INFO] - Step: 6200/9020  |  Loss: 0.2597  |  Score: 88.98 [%]  |  Seq Length: 128.0
[2024-09-19 11:12:33,930][root][INFO] - Step: 6700/9020  |  Loss: 0.4981  |  Score: 76.03 [%]  |  Seq Length: 128.0
[2024-09-19 11:12:34,197][root][INFO] - Step: 4700/9020  |  Loss: 0.5586  |  Score: 72.39 [%]  |  Seq Length: 128.0
[2024-09-19 11:12:47,769][root][INFO] - Step: 6300/9020  |  Loss: 0.2613  |  Score: 89.52 [%]  |  Seq Length: 128.0
[2024-09-19 11:13:02,463][root][INFO] - Step: 6800/9020  |  Loss: 0.5015  |  Score: 76.25 [%]  |  Seq Length: 128.0
[2024-09-19 11:13:13,628][root][INFO] - Step: 4800/9020  |  Loss: 0.5462  |  Score: 73.16 [%]  |  Seq Length: 128.0
[2024-09-19 11:13:18,493][root][INFO] - Step: 6400/9020  |  Loss: 0.2579  |  Score: 89.39 [%]  |  Seq Length: 128.0
[2024-09-19 11:13:29,374][root][INFO] - Step: 6900/9020  |  Loss: 0.5050  |  Score: 76.11 [%]  |  Seq Length: 128.0
[2024-09-19 11:13:48,397][root][INFO] - Step: 6500/9020  |  Loss: 0.2646  |  Score: 88.67 [%]  |  Seq Length: 128.0
[2024-09-19 11:13:52,701][root][INFO] - Step: 4900/9020  |  Loss: 0.5474  |  Score: 72.64 [%]  |  Seq Length: 128.0
[2024-09-19 11:13:55,054][root][INFO] - Step: 7000/9020  |  Loss: 0.4956  |  Score: 76.81 [%]  |  Seq Length: 128.0
[2024-09-19 11:14:19,446][root][INFO] - Step: 6600/9020  |  Loss: 0.2647  |  Score: 88.97 [%]  |  Seq Length: 128.0
[2024-09-19 11:14:22,837][root][INFO] - Step: 7100/9020  |  Loss: 0.5045  |  Score: 75.98 [%]  |  Seq Length: 128.0
[2024-09-19 11:14:32,321][root][INFO] - Step: 5000/9020  |  Loss: 0.5448  |  Score: 73.72 [%]  |  Seq Length: 128.0
[2024-09-19 11:14:50,062][root][INFO] - Step: 6700/9020  |  Loss: 0.2649  |  Score: 88.98 [%]  |  Seq Length: 128.0
[2024-09-19 11:14:51,315][root][INFO] - Step: 7200/9020  |  Loss: 0.4943  |  Score: 76.58 [%]  |  Seq Length: 128.0
[2024-09-19 11:14:55,811][root][INFO] - Step: 7216/9020  |  Loss: 0.5084  |  Score: 75.98 [%]  |  Seq Length: 128.0
[2024-09-19 11:15:11,066][root][INFO] - Step: 5100/9020  |  Loss: 0.5463  |  Score: 73.00 [%]  |  Seq Length: 128.0
[2024-09-19 11:15:15,544][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 11:15:15,544][root][INFO] - Score: 76.65 [%]  |  Evaluation Time: 19.73 [s]
[2024-09-19 11:15:20,718][root][INFO] - Step: 6800/9020  |  Loss: 0.2646  |  Score: 88.91 [%]  |  Seq Length: 128.0
[2024-09-19 11:15:49,756][root][INFO] - Step: 5200/9020  |  Loss: 0.5552  |  Score: 71.91 [%]  |  Seq Length: 128.0
[2024-09-19 11:15:51,381][root][INFO] - Step: 6900/9020  |  Loss: 0.2715  |  Score: 88.73 [%]  |  Seq Length: 128.0
[2024-09-19 11:16:20,115][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 11:16:20,116][root][INFO] - Score: 76.93 [%]  |  Evaluation Time: 64.57 [s]
[2024-09-19 11:16:20,117][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-19 11:16:20,118][root][INFO] - 
[5/ 5 Epoch]
[2024-09-19 11:16:22,083][root][INFO] - Step: 7000/9020  |  Loss: 0.2573  |  Score: 89.67 [%]  |  Seq Length: 128.0
[2024-09-19 11:16:28,292][root][INFO] - Step: 5300/9020  |  Loss: 0.5384  |  Score: 73.73 [%]  |  Seq Length: 128.0
[2024-09-19 11:16:44,386][root][INFO] - Step: 7300/9020  |  Loss: 0.4904  |  Score: 76.95 [%]  |  Seq Length: 128.0
[2024-09-19 11:16:53,054][root][INFO] - Step: 7100/9020  |  Loss: 0.2546  |  Score: 89.30 [%]  |  Seq Length: 128.0
[2024-09-19 11:17:07,737][root][INFO] - Step: 5400/9020  |  Loss: 0.5436  |  Score: 73.38 [%]  |  Seq Length: 128.0
[2024-09-19 11:17:12,176][root][INFO] - Step: 7400/9020  |  Loss: 0.4899  |  Score: 77.56 [%]  |  Seq Length: 128.0
[2024-09-19 11:17:12,638][root][INFO] - Step: 5412/9020  |  Loss: 0.5369  |  Score: 74.06 [%]  |  Seq Length: 128.0
[2024-09-19 11:17:23,528][root][INFO] - Step: 7200/9020  |  Loss: 0.2675  |  Score: 88.98 [%]  |  Seq Length: 128.0
[2024-09-19 11:17:28,500][root][INFO] - Step: 7216/9020  |  Loss: 0.2354  |  Score: 90.62 [%]  |  Seq Length: 128.0
[2024-09-19 11:17:38,368][root][INFO] - Step: 7500/9020  |  Loss: 0.5001  |  Score: 76.58 [%]  |  Seq Length: 128.0
[2024-09-19 11:17:45,728][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 11:17:45,728][root][INFO] - Score: 74.48 [%]  |  Evaluation Time: 33.09 [s]
[2024-09-19 11:17:46,744][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 11:17:46,744][root][INFO] - Score: 87.66 [%]  |  Evaluation Time: 18.24 [s]
[2024-09-19 11:18:07,609][root][INFO] - Step: 7600/9020  |  Loss: 0.4875  |  Score: 76.72 [%]  |  Seq Length: 128.0
[2024-09-19 11:18:36,952][root][INFO] - Step: 7700/9020  |  Loss: 0.5029  |  Score: 76.19 [%]  |  Seq Length: 128.0
[2024-09-19 11:18:45,419][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 11:18:45,419][root][INFO] - Score: 87.88 [%]  |  Evaluation Time: 58.67 [s]
[2024-09-19 11:18:45,421][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-19 11:18:45,422][root][INFO] - 
[5/ 5 Epoch]
[2024-09-19 11:19:05,462][root][INFO] - Step: 7800/9020  |  Loss: 0.4899  |  Score: 77.50 [%]  |  Seq Length: 128.0
[2024-09-19 11:19:11,740][root][INFO] - Step: 7300/9020  |  Loss: 0.2621  |  Score: 89.62 [%]  |  Seq Length: 128.0
[2024-09-19 11:19:33,942][root][INFO] - Step: 7900/9020  |  Loss: 0.4917  |  Score: 77.17 [%]  |  Seq Length: 128.0
[2024-09-19 11:19:34,275][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 11:19:34,276][root][INFO] - Score: 74.35 [%]  |  Evaluation Time: 108.54 [s]
[2024-09-19 11:19:34,278][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-19 11:19:34,281][root][INFO] - 
[4/ 5 Epoch]
[2024-09-19 11:19:42,189][root][INFO] - Step: 7400/9020  |  Loss: 0.2586  |  Score: 89.56 [%]  |  Seq Length: 128.0
[2024-09-19 11:20:02,157][root][INFO] - Step: 8000/9020  |  Loss: 0.4964  |  Score: 76.81 [%]  |  Seq Length: 128.0
[2024-09-19 11:20:09,193][root][INFO] - Step: 5500/9020  |  Loss: 0.5412  |  Score: 73.46 [%]  |  Seq Length: 128.0
[2024-09-19 11:20:13,929][root][INFO] - Step: 7500/9020  |  Loss: 0.2547  |  Score: 89.44 [%]  |  Seq Length: 128.0
[2024-09-19 11:20:29,484][root][INFO] - Step: 8100/9020  |  Loss: 0.4943  |  Score: 76.62 [%]  |  Seq Length: 128.0
[2024-09-19 11:20:44,420][root][INFO] - Step: 7600/9020  |  Loss: 0.2540  |  Score: 89.88 [%]  |  Seq Length: 128.0
[2024-09-19 11:20:48,422][root][INFO] - Step: 5600/9020  |  Loss: 0.5405  |  Score: 73.38 [%]  |  Seq Length: 128.0
[2024-09-19 11:20:57,298][root][INFO] - Step: 8200/9020  |  Loss: 0.4921  |  Score: 76.70 [%]  |  Seq Length: 128.0
[2024-09-19 11:21:15,022][root][INFO] - Step: 7700/9020  |  Loss: 0.2489  |  Score: 89.84 [%]  |  Seq Length: 128.0
[2024-09-19 11:21:25,538][root][INFO] - Step: 8300/9020  |  Loss: 0.4880  |  Score: 77.19 [%]  |  Seq Length: 128.0
[2024-09-19 11:21:27,065][root][INFO] - Step: 5700/9020  |  Loss: 0.5449  |  Score: 72.61 [%]  |  Seq Length: 128.0
[2024-09-19 11:21:43,436][root][INFO] - Step: 7800/9020  |  Loss: 0.2440  |  Score: 89.84 [%]  |  Seq Length: 128.0
[2024-09-19 11:21:54,051][root][INFO] - Step: 8400/9020  |  Loss: 0.4988  |  Score: 76.28 [%]  |  Seq Length: 128.0
[2024-09-19 11:22:06,317][root][INFO] - Step: 5800/9020  |  Loss: 0.5352  |  Score: 73.59 [%]  |  Seq Length: 128.0
[2024-09-19 11:22:14,286][root][INFO] - Step: 7900/9020  |  Loss: 0.2530  |  Score: 89.75 [%]  |  Seq Length: 128.0
[2024-09-19 11:22:22,112][root][INFO] - Step: 8500/9020  |  Loss: 0.5004  |  Score: 75.88 [%]  |  Seq Length: 128.0
[2024-09-19 11:22:45,281][root][INFO] - Step: 8000/9020  |  Loss: 0.2685  |  Score: 88.92 [%]  |  Seq Length: 128.0
[2024-09-19 11:22:45,847][root][INFO] - Step: 5900/9020  |  Loss: 0.5403  |  Score: 72.97 [%]  |  Seq Length: 128.0
[2024-09-19 11:22:50,446][root][INFO] - Step: 8600/9020  |  Loss: 0.4952  |  Score: 76.83 [%]  |  Seq Length: 128.0
[2024-09-19 11:23:16,046][root][INFO] - Step: 8100/9020  |  Loss: 0.2481  |  Score: 89.81 [%]  |  Seq Length: 128.0
[2024-09-19 11:23:17,657][root][INFO] - Step: 8700/9020  |  Loss: 0.4845  |  Score: 77.75 [%]  |  Seq Length: 128.0
[2024-09-19 11:23:24,416][root][INFO] - Step: 6000/9020  |  Loss: 0.5473  |  Score: 73.25 [%]  |  Seq Length: 128.0
[2024-09-19 11:23:46,127][root][INFO] - Step: 8800/9020  |  Loss: 0.5023  |  Score: 76.73 [%]  |  Seq Length: 128.0
[2024-09-19 11:23:46,777][root][INFO] - Step: 8200/9020  |  Loss: 0.2549  |  Score: 89.75 [%]  |  Seq Length: 128.0
[2024-09-19 11:24:03,066][root][INFO] - Step: 6100/9020  |  Loss: 0.5366  |  Score: 73.66 [%]  |  Seq Length: 128.0
[2024-09-19 11:24:14,654][root][INFO] - Step: 8900/9020  |  Loss: 0.4886  |  Score: 77.12 [%]  |  Seq Length: 128.0
[2024-09-19 11:24:17,494][root][INFO] - Step: 8300/9020  |  Loss: 0.2621  |  Score: 89.22 [%]  |  Seq Length: 128.0
[2024-09-19 11:24:42,164][root][INFO] - Step: 9000/9020  |  Loss: 0.4765  |  Score: 77.56 [%]  |  Seq Length: 128.0
[2024-09-19 11:24:42,675][root][INFO] - Step: 6200/9020  |  Loss: 0.5507  |  Score: 73.03 [%]  |  Seq Length: 128.0
[2024-09-19 11:24:46,974][root][INFO] - Step: 9020/9020  |  Loss: 0.4613  |  Score: 78.73 [%]  |  Seq Length: 128.0
[2024-09-19 11:24:48,531][root][INFO] - Step: 8400/9020  |  Loss: 0.2564  |  Score: 89.36 [%]  |  Seq Length: 128.0
[2024-09-19 11:25:06,867][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 11:25:06,867][root][INFO] - Score: 77.11 [%]  |  Evaluation Time: 19.89 [s]
[2024-09-19 11:25:19,910][root][INFO] - Step: 8500/9020  |  Loss: 0.2426  |  Score: 89.61 [%]  |  Seq Length: 128.0
[2024-09-19 11:25:21,722][root][INFO] - Step: 6300/9020  |  Loss: 0.5253  |  Score: 74.11 [%]  |  Seq Length: 128.0
[2024-09-19 11:25:51,785][root][INFO] - Step: 8600/9020  |  Loss: 0.2422  |  Score: 89.75 [%]  |  Seq Length: 128.0
[2024-09-19 11:26:01,292][root][INFO] - Step: 6400/9020  |  Loss: 0.5445  |  Score: 72.88 [%]  |  Seq Length: 128.0
[2024-09-19 11:26:11,564][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 11:26:11,564][root][INFO] - Score: 77.45 [%]  |  Evaluation Time: 64.69 [s]
[2024-09-19 11:26:11,565][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-19 11:26:11,565][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 11:26:11,565][root][INFO] - - Epoch: 5
[2024-09-19 11:26:11,565][root][INFO] - - DEV score: 77.11 [%]
[2024-09-19 11:26:11,565][root][INFO] - - TEST score: 77.45 [%]
[2024-09-19 11:26:11,566][root][INFO] - Fine-tuning is done!
[2024-09-19 11:26:22,788][root][INFO] - Step: 8700/9020  |  Loss: 0.2555  |  Score: 89.59 [%]  |  Seq Length: 128.0
[2024-09-19 11:26:41,061][root][INFO] - Step: 6500/9020  |  Loss: 0.5304  |  Score: 74.25 [%]  |  Seq Length: 128.0
[2024-09-19 11:26:53,753][root][INFO] - Step: 8800/9020  |  Loss: 0.2658  |  Score: 88.58 [%]  |  Seq Length: 128.0
[2024-09-19 11:27:19,863][root][INFO] - Step: 6600/9020  |  Loss: 0.5349  |  Score: 73.73 [%]  |  Seq Length: 128.0
[2024-09-19 11:27:25,354][root][INFO] - Step: 8900/9020  |  Loss: 0.2622  |  Score: 89.25 [%]  |  Seq Length: 128.0
[2024-09-19 11:27:56,885][root][INFO] - Step: 9000/9020  |  Loss: 0.2675  |  Score: 89.19 [%]  |  Seq Length: 128.0
[2024-09-19 11:27:58,883][root][INFO] - Step: 6700/9020  |  Loss: 0.5349  |  Score: 73.56 [%]  |  Seq Length: 128.0
[2024-09-19 11:28:03,495][root][INFO] - Step: 9020/9020  |  Loss: 0.2841  |  Score: 88.17 [%]  |  Seq Length: 128.0
[2024-09-19 11:28:21,538][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 11:28:21,538][root][INFO] - Score: 87.67 [%]  |  Evaluation Time: 18.04 [s]
[2024-09-19 11:28:38,340][root][INFO] - Step: 6800/9020  |  Loss: 0.5333  |  Score: 73.86 [%]  |  Seq Length: 128.0
[2024-09-19 11:29:16,089][root][INFO] - Step: 6900/9020  |  Loss: 0.5297  |  Score: 74.48 [%]  |  Seq Length: 128.0
[2024-09-19 11:29:19,997][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 11:29:19,998][root][INFO] - Score: 87.97 [%]  |  Evaluation Time: 58.46 [s]
[2024-09-19 11:29:19,999][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-19 11:29:19,999][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 11:29:19,999][root][INFO] - - Epoch: 5
[2024-09-19 11:29:19,999][root][INFO] - - DEV score: 87.67 [%]
[2024-09-19 11:29:19,999][root][INFO] - - TEST score: 87.97 [%]
[2024-09-19 11:29:20,000][root][INFO] - Fine-tuning is done!
[2024-09-19 11:29:55,203][root][INFO] - Step: 7000/9020  |  Loss: 0.5346  |  Score: 74.09 [%]  |  Seq Length: 128.0
[2024-09-19 11:30:33,818][root][INFO] - Step: 7100/9020  |  Loss: 0.5291  |  Score: 74.34 [%]  |  Seq Length: 128.0
[2024-09-19 11:31:11,381][root][INFO] - Step: 7200/9020  |  Loss: 0.5305  |  Score: 74.11 [%]  |  Seq Length: 128.0
[2024-09-19 11:31:17,864][root][INFO] - Step: 7216/9020  |  Loss: 0.5108  |  Score: 76.15 [%]  |  Seq Length: 128.0
[2024-09-19 11:31:49,897][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 11:31:49,897][root][INFO] - Score: 75.73 [%]  |  Evaluation Time: 32.03 [s]
[2024-09-19 11:33:38,325][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 11:33:38,325][root][INFO] - Score: 75.52 [%]  |  Evaluation Time: 108.42 [s]
[2024-09-19 11:33:38,326][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-19 11:33:38,328][root][INFO] - 
[5/ 5 Epoch]
[2024-09-19 11:34:11,114][root][INFO] - Step: 7300/9020  |  Loss: 0.5222  |  Score: 74.39 [%]  |  Seq Length: 128.0
[2024-09-19 11:34:46,789][root][INFO] - Step: 7400/9020  |  Loss: 0.5349  |  Score: 74.09 [%]  |  Seq Length: 128.0
[2024-09-19 11:35:23,262][root][INFO] - Step: 7500/9020  |  Loss: 0.5284  |  Score: 73.91 [%]  |  Seq Length: 128.0
[2024-09-19 11:35:55,941][root][INFO] - Step: 7600/9020  |  Loss: 0.5298  |  Score: 74.17 [%]  |  Seq Length: 128.0
[2024-09-19 11:36:33,159][root][INFO] - Step: 7700/9020  |  Loss: 0.5338  |  Score: 74.11 [%]  |  Seq Length: 128.0
[2024-09-19 11:37:11,187][root][INFO] - Step: 7800/9020  |  Loss: 0.5224  |  Score: 74.55 [%]  |  Seq Length: 128.0
[2024-09-19 11:37:49,325][root][INFO] - Step: 7900/9020  |  Loss: 0.5260  |  Score: 74.86 [%]  |  Seq Length: 128.0
[2024-09-19 11:38:26,939][root][INFO] - Step: 8000/9020  |  Loss: 0.5243  |  Score: 74.48 [%]  |  Seq Length: 128.0
[2024-09-19 11:39:03,603][root][INFO] - Step: 8100/9020  |  Loss: 0.5177  |  Score: 75.30 [%]  |  Seq Length: 128.0
[2024-09-19 11:39:38,892][root][INFO] - Step: 8200/9020  |  Loss: 0.5162  |  Score: 75.11 [%]  |  Seq Length: 128.0
[2024-09-19 11:40:15,483][root][INFO] - Step: 8300/9020  |  Loss: 0.5292  |  Score: 74.09 [%]  |  Seq Length: 128.0
[2024-09-19 11:40:53,007][root][INFO] - Step: 8400/9020  |  Loss: 0.5327  |  Score: 74.05 [%]  |  Seq Length: 128.0
[2024-09-19 11:41:30,259][root][INFO] - Step: 8500/9020  |  Loss: 0.5239  |  Score: 74.27 [%]  |  Seq Length: 128.0
[2024-09-19 11:42:08,680][root][INFO] - Step: 8600/9020  |  Loss: 0.5334  |  Score: 73.98 [%]  |  Seq Length: 128.0
[2024-09-19 11:42:46,907][root][INFO] - Step: 8700/9020  |  Loss: 0.5285  |  Score: 74.34 [%]  |  Seq Length: 128.0
[2024-09-19 11:43:24,044][root][INFO] - Step: 8800/9020  |  Loss: 0.5146  |  Score: 75.52 [%]  |  Seq Length: 128.0
[2024-09-19 11:44:00,639][root][INFO] - Step: 8900/9020  |  Loss: 0.5254  |  Score: 74.47 [%]  |  Seq Length: 128.0
[2024-09-19 11:44:34,842][root][INFO] - Step: 9000/9020  |  Loss: 0.5199  |  Score: 74.81 [%]  |  Seq Length: 128.0
[2024-09-19 11:44:42,199][root][INFO] - Step: 9020/9020  |  Loss: 0.4892  |  Score: 75.86 [%]  |  Seq Length: 128.0
[2024-09-19 11:45:15,304][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 11:45:15,304][root][INFO] - Score: 75.84 [%]  |  Evaluation Time: 33.10 [s]
[2024-09-19 11:47:02,264][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 11:47:02,264][root][INFO] - Score: 75.77 [%]  |  Evaluation Time: 106.96 [s]
[2024-09-19 11:47:02,266][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-19 11:47:02,266][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 11:47:02,266][root][INFO] - - Epoch: 5
[2024-09-19 11:47:02,266][root][INFO] - - DEV score: 75.84 [%]
[2024-09-19 11:47:02,266][root][INFO] - - TEST score: 75.77 [%]
[2024-09-19 11:47:02,267][root][INFO] - Fine-tuning is done!
[2024-09-19 12:14:36,388][root][INFO] - 

[2024-09-19 12:14:36,388][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 12:14:36,388][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs
[2024-09-19 12:14:36,388][root][INFO] - 

[2024-09-19 12:14:36,388][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 128, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 4, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 12:14:48,126][root][INFO] - 

[2024-09-19 12:14:48,126][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 12:14:48,126][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs
[2024-09-19 12:14:48,126][root][INFO] - 

[2024-09-19 12:14:48,126][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 128, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 4, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 12:14:57,947][root][INFO] - 

[2024-09-19 12:14:57,947][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 12:14:57,947][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs
[2024-09-19 12:14:57,948][root][INFO] - 

[2024-09-19 12:14:57,948][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 128, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 4, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 12:15:00,600][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 12:15:02,493][root][INFO] - 

[2024-09-19 12:15:02,493][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-19 12:15:02,493][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 12:15:02,501][root][INFO] - vocab size              : 51200
[2024-09-19 12:15:02,501][root][INFO] - device                  : gpu
[2024-09-19 12:15:02,501][root][INFO] - random seed             : 42
[2024-09-19 12:15:02,501][root][INFO] - train data size         : 28864
[2024-09-19 12:15:02,501][root][INFO] - max epochs              : 5
[2024-09-19 12:15:02,501][root][INFO] - total steps             : 9020
[2024-09-19 12:15:02,502][root][INFO] - warmup steps            : 902
[2024-09-19 12:15:02,502][root][INFO] - batch size              : 64
[2024-09-19 12:15:02,502][root][INFO] - accumulation steps      : 4
[2024-09-19 12:15:02,502][root][INFO] - optimizer               : adamwscale
[2024-09-19 12:15:02,502][root][INFO] - lr_scheduler            : cosine
[2024-09-19 12:15:02,502][root][INFO] - learning rate           : 0.02
[2024-09-19 12:15:02,502][root][INFO] - max length              : 128

[2024-09-19 12:15:02,502][root][INFO] - 

[2024-09-19 12:15:02,502][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs
[2024-09-19 12:15:02,502][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs/ckpt
[2024-09-19 12:15:02,502][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs/tb
[2024-09-19 12:15:02,502][root][INFO] - * tb interval           : 100

[2024-09-19 12:15:02,503][root][INFO] - 

[2024-09-19 12:15:02,503][root][INFO] - Start the Training !
[2024-09-19 12:15:02,505][root][INFO] - 
[1/ 5 Epoch]
[2024-09-19 12:15:12,532][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:12,532][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:12,533][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:12,533][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:12,533][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:12,534][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:12,534][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:12,534][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:12,535][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:12,535][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:12,535][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:12,535][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:12,536][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:12,536][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:12,536][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:12,537][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:12,537][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:12,537][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:12,538][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:12,538][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:12,538][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:12,539][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:12,539][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:12,539][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:12,541][root][INFO] - Trainable params: 884736 || all params: 126050304 || trainable: 0.70 %
[2024-09-19 12:15:12,722][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 12:15:14,632][root][INFO] - 

[2024-09-19 12:15:14,632][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-19 12:15:14,633][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 12:15:14,640][root][INFO] - vocab size              : 51200
[2024-09-19 12:15:14,641][root][INFO] - device                  : gpu
[2024-09-19 12:15:14,641][root][INFO] - random seed             : 42
[2024-09-19 12:15:14,641][root][INFO] - train data size         : 28864
[2024-09-19 12:15:14,641][root][INFO] - max epochs              : 5
[2024-09-19 12:15:14,641][root][INFO] - total steps             : 9020
[2024-09-19 12:15:14,641][root][INFO] - warmup steps            : 902
[2024-09-19 12:15:14,641][root][INFO] - batch size              : 64
[2024-09-19 12:15:14,641][root][INFO] - accumulation steps      : 4
[2024-09-19 12:15:14,641][root][INFO] - optimizer               : adamwscale
[2024-09-19 12:15:14,641][root][INFO] - lr_scheduler            : cosine
[2024-09-19 12:15:14,642][root][INFO] - learning rate           : 0.02
[2024-09-19 12:15:14,642][root][INFO] - max length              : 128

[2024-09-19 12:15:14,642][root][INFO] - LoRA Configuration
[2024-09-19 12:15:14,642][root][INFO] - ㄴ r                    : 16
[2024-09-19 12:15:14,642][root][INFO] - ㄴ alpha                : 64
[2024-09-19 12:15:14,642][root][INFO] - ㄴ dropout              : 0.03

[2024-09-19 12:15:14,642][root][INFO] - 

[2024-09-19 12:15:14,642][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs
[2024-09-19 12:15:14,642][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs/ckpt
[2024-09-19 12:15:14,642][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs/tb
[2024-09-19 12:15:14,643][root][INFO] - * tb interval           : 100

[2024-09-19 12:15:14,643][root][INFO] - 

[2024-09-19 12:15:14,643][root][INFO] - Start the Training !
[2024-09-19 12:15:14,646][root][INFO] - 
[1/ 5 Epoch]
[2024-09-19 12:15:22,374][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:22,375][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:22,375][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:22,375][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:22,376][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:22,376][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:22,377][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:22,377][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:22,377][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:22,378][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:22,378][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:22,378][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:22,378][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:22,379][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:22,379][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:22,379][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:22,380][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:22,380][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:22,380][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:22,381][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:22,381][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:22,381][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:22,382][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:22,382][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:22,384][root][INFO] - Trainable params: 884736 || all params: 126050304 || trainable: 0.70 %
[2024-09-19 12:15:22,387][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-19 12:15:22,393][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-19 12:15:22,395][root][INFO] - Trainable params: 1298304 || all params: 126463872 || trainable: 1.03 %
[2024-09-19 12:15:22,572][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 12:15:24,480][root][INFO] - 

[2024-09-19 12:15:24,480][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-19 12:15:24,480][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 12:15:24,488][root][INFO] - vocab size              : 51200
[2024-09-19 12:15:24,488][root][INFO] - device                  : gpu
[2024-09-19 12:15:24,488][root][INFO] - random seed             : 42
[2024-09-19 12:15:24,488][root][INFO] - train data size         : 28864
[2024-09-19 12:15:24,488][root][INFO] - max epochs              : 5
[2024-09-19 12:15:24,488][root][INFO] - total steps             : 9020
[2024-09-19 12:15:24,489][root][INFO] - warmup steps            : 902
[2024-09-19 12:15:24,489][root][INFO] - batch size              : 64
[2024-09-19 12:15:24,489][root][INFO] - accumulation steps      : 4
[2024-09-19 12:15:24,489][root][INFO] - optimizer               : adamwscale
[2024-09-19 12:15:24,489][root][INFO] - lr_scheduler            : cosine
[2024-09-19 12:15:24,489][root][INFO] - learning rate           : 0.02
[2024-09-19 12:15:24,489][root][INFO] - max length              : 128

[2024-09-19 12:15:24,489][root][INFO] - LoRA Configuration
[2024-09-19 12:15:24,489][root][INFO] - ㄴ r                    : 16
[2024-09-19 12:15:24,489][root][INFO] - ㄴ alpha                : 64
[2024-09-19 12:15:24,489][root][INFO] - ㄴ dropout              : 0.03

[2024-09-19 12:15:24,489][root][INFO] - KOMBO Configuration
[2024-09-19 12:15:24,490][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-19 12:15:24,490][root][INFO] - ㄴ reducer              : linear
[2024-09-19 12:15:24,490][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-19 12:15:24,490][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-19 12:15:24,490][root][INFO] - ㄴ do_combination       : False
[2024-09-19 12:15:24,490][root][INFO] - 

[2024-09-19 12:15:24,490][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs
[2024-09-19 12:15:24,490][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs/ckpt
[2024-09-19 12:15:24,490][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs/tb
[2024-09-19 12:15:24,490][root][INFO] - * tb interval           : 100

[2024-09-19 12:15:24,490][root][INFO] - 

[2024-09-19 12:15:24,491][root][INFO] - Start the Training !
[2024-09-19 12:15:24,493][root][INFO] - 
[1/ 5 Epoch]
[2024-09-19 12:15:34,665][root][INFO] - Step: 100/9020  |  Loss: 0.7128  |  Score: 67.62 [%]  |  Seq Length: 128.0
[2024-09-19 12:15:44,895][root][INFO] - Step: 100/9020  |  Loss: 0.5816  |  Score: 69.56 [%]  |  Seq Length: 128.0
[2024-09-19 12:16:05,111][root][INFO] - Step: 200/9020  |  Loss: 0.4706  |  Score: 78.67 [%]  |  Seq Length: 128.0
[2024-09-19 12:16:05,290][root][INFO] - Step: 100/9020  |  Loss: 0.6445  |  Score: 63.14 [%]  |  Seq Length: 128.0
[2024-09-19 12:16:13,811][root][INFO] - Step: 200/9020  |  Loss: 0.4273  |  Score: 80.27 [%]  |  Seq Length: 128.0
[2024-09-19 12:16:35,544][root][INFO] - Step: 300/9020  |  Loss: 0.4347  |  Score: 80.44 [%]  |  Seq Length: 128.0
[2024-09-19 12:16:42,550][root][INFO] - Step: 300/9020  |  Loss: 0.3947  |  Score: 82.42 [%]  |  Seq Length: 128.0
[2024-09-19 12:16:44,288][root][INFO] - Step: 200/9020  |  Loss: 0.4689  |  Score: 78.06 [%]  |  Seq Length: 128.0
[2024-09-19 12:17:06,585][root][INFO] - Step: 400/9020  |  Loss: 0.4044  |  Score: 81.38 [%]  |  Seq Length: 128.0
[2024-09-19 12:17:10,834][root][INFO] - Step: 400/9020  |  Loss: 0.4059  |  Score: 81.86 [%]  |  Seq Length: 128.0
[2024-09-19 12:17:23,802][root][INFO] - Step: 300/9020  |  Loss: 0.4342  |  Score: 79.95 [%]  |  Seq Length: 128.0
[2024-09-19 12:17:36,807][root][INFO] - Step: 500/9020  |  Loss: 0.4114  |  Score: 81.97 [%]  |  Seq Length: 128.0
[2024-09-19 12:17:39,554][root][INFO] - Step: 500/9020  |  Loss: 0.3820  |  Score: 83.09 [%]  |  Seq Length: 128.0
[2024-09-19 12:18:03,859][root][INFO] - Step: 400/9020  |  Loss: 0.4197  |  Score: 81.47 [%]  |  Seq Length: 128.0
[2024-09-19 12:18:07,315][root][INFO] - Step: 600/9020  |  Loss: 0.4015  |  Score: 81.83 [%]  |  Seq Length: 128.0
[2024-09-19 12:18:08,355][root][INFO] - Step: 600/9020  |  Loss: 0.3603  |  Score: 84.45 [%]  |  Seq Length: 128.0
[2024-09-19 12:18:36,576][root][INFO] - Step: 700/9020  |  Loss: 0.3739  |  Score: 83.56 [%]  |  Seq Length: 128.0
[2024-09-19 12:18:38,123][root][INFO] - Step: 700/9020  |  Loss: 0.4165  |  Score: 81.80 [%]  |  Seq Length: 128.0
[2024-09-19 12:18:43,771][root][INFO] - Step: 500/9020  |  Loss: 0.5131  |  Score: 74.17 [%]  |  Seq Length: 128.0
[2024-09-19 12:19:05,001][root][INFO] - Step: 800/9020  |  Loss: 0.3571  |  Score: 84.42 [%]  |  Seq Length: 128.0
[2024-09-19 12:19:08,884][root][INFO] - Step: 800/9020  |  Loss: 0.4076  |  Score: 81.58 [%]  |  Seq Length: 128.0
[2024-09-19 12:19:22,061][root][INFO] - Step: 600/9020  |  Loss: 0.4797  |  Score: 76.95 [%]  |  Seq Length: 128.0
[2024-09-19 12:19:32,333][root][INFO] - Step: 900/9020  |  Loss: 0.3649  |  Score: 84.62 [%]  |  Seq Length: 128.0
[2024-09-19 12:19:39,879][root][INFO] - Step: 900/9020  |  Loss: 0.3895  |  Score: 82.92 [%]  |  Seq Length: 128.0
[2024-09-19 12:20:00,567][root][INFO] - Step: 1000/9020  |  Loss: 0.3736  |  Score: 83.47 [%]  |  Seq Length: 128.0
[2024-09-19 12:20:01,024][root][INFO] - Step: 700/9020  |  Loss: 0.4571  |  Score: 78.75 [%]  |  Seq Length: 128.0
[2024-09-19 12:20:10,597][root][INFO] - Step: 1000/9020  |  Loss: 0.4181  |  Score: 80.86 [%]  |  Seq Length: 128.0
[2024-09-19 12:20:28,593][root][INFO] - Step: 1100/9020  |  Loss: 0.3502  |  Score: 84.66 [%]  |  Seq Length: 128.0
[2024-09-19 12:20:40,089][root][INFO] - Step: 800/9020  |  Loss: 0.4435  |  Score: 78.92 [%]  |  Seq Length: 128.0
[2024-09-19 12:20:40,655][root][INFO] - Step: 1100/9020  |  Loss: 0.3843  |  Score: 82.98 [%]  |  Seq Length: 128.0
[2024-09-19 12:20:56,582][root][INFO] - Step: 1200/9020  |  Loss: 0.3411  |  Score: 84.78 [%]  |  Seq Length: 128.0
[2024-09-19 12:21:10,611][root][INFO] - Step: 1200/9020  |  Loss: 0.3828  |  Score: 83.47 [%]  |  Seq Length: 128.0
[2024-09-19 12:21:19,662][root][INFO] - Step: 900/9020  |  Loss: 0.4463  |  Score: 79.08 [%]  |  Seq Length: 128.0
[2024-09-19 12:21:24,614][root][INFO] - Step: 1300/9020  |  Loss: 0.3456  |  Score: 84.84 [%]  |  Seq Length: 128.0
[2024-09-19 12:21:41,241][root][INFO] - Step: 1300/9020  |  Loss: 0.3715  |  Score: 83.28 [%]  |  Seq Length: 128.0
[2024-09-19 12:21:52,575][root][INFO] - Step: 1400/9020  |  Loss: 0.3423  |  Score: 85.20 [%]  |  Seq Length: 128.0
[2024-09-19 12:21:59,158][root][INFO] - Step: 1000/9020  |  Loss: 0.4764  |  Score: 77.05 [%]  |  Seq Length: 128.0
[2024-09-19 12:22:11,745][root][INFO] - Step: 1400/9020  |  Loss: 0.3894  |  Score: 83.03 [%]  |  Seq Length: 128.0
[2024-09-19 12:22:19,800][root][INFO] - Step: 1500/9020  |  Loss: 0.3433  |  Score: 85.42 [%]  |  Seq Length: 128.0
[2024-09-19 12:22:38,584][root][INFO] - Step: 1100/9020  |  Loss: 0.4879  |  Score: 76.25 [%]  |  Seq Length: 128.0
[2024-09-19 12:22:41,779][root][INFO] - Step: 1500/9020  |  Loss: 0.3761  |  Score: 83.30 [%]  |  Seq Length: 128.0
[2024-09-19 12:22:46,742][root][INFO] - Step: 1600/9020  |  Loss: 0.3402  |  Score: 85.44 [%]  |  Seq Length: 128.0
[2024-09-19 12:23:12,475][root][INFO] - Step: 1600/9020  |  Loss: 0.3822  |  Score: 82.98 [%]  |  Seq Length: 128.0
[2024-09-19 12:23:15,367][root][INFO] - Step: 1700/9020  |  Loss: 0.3409  |  Score: 85.05 [%]  |  Seq Length: 128.0
[2024-09-19 12:23:17,842][root][INFO] - Step: 1200/9020  |  Loss: 0.4496  |  Score: 78.59 [%]  |  Seq Length: 128.0
[2024-09-19 12:23:42,522][root][INFO] - Step: 1800/9020  |  Loss: 0.3286  |  Score: 85.75 [%]  |  Seq Length: 128.0
[2024-09-19 12:23:42,597][root][INFO] - Step: 1700/9020  |  Loss: 0.3690  |  Score: 83.58 [%]  |  Seq Length: 128.0
[2024-09-19 12:23:43,680][root][INFO] - Step: 1804/9020  |  Loss: 0.2808  |  Score: 87.03 [%]  |  Seq Length: 128.0
[2024-09-19 12:23:57,985][root][INFO] - Step: 1300/9020  |  Loss: 0.4920  |  Score: 76.25 [%]  |  Seq Length: 128.0
[2024-09-19 12:24:03,084][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 12:24:03,084][root][INFO] - Score: 86.38 [%]  |  Evaluation Time: 19.40 [s]
[2024-09-19 12:24:13,367][root][INFO] - Step: 1800/9020  |  Loss: 0.3758  |  Score: 82.97 [%]  |  Seq Length: 128.0
[2024-09-19 12:24:14,719][root][INFO] - Step: 1804/9020  |  Loss: 0.3306  |  Score: 87.50 [%]  |  Seq Length: 128.0
[2024-09-19 12:24:32,948][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 12:24:32,948][root][INFO] - Score: 84.04 [%]  |  Evaluation Time: 18.23 [s]
[2024-09-19 12:24:37,700][root][INFO] - Step: 1400/9020  |  Loss: 0.4858  |  Score: 76.28 [%]  |  Seq Length: 128.0
[2024-09-19 12:25:06,643][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 12:25:06,643][root][INFO] - Score: 86.21 [%]  |  Evaluation Time: 63.56 [s]
[2024-09-19 12:25:06,644][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 12:25:06,645][root][INFO] - 
[2/ 5 Epoch]
[2024-09-19 12:25:17,489][root][INFO] - Step: 1500/9020  |  Loss: 0.5439  |  Score: 71.17 [%]  |  Seq Length: 128.0
[2024-09-19 12:25:31,647][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 12:25:31,647][root][INFO] - Score: 83.72 [%]  |  Evaluation Time: 58.70 [s]
[2024-09-19 12:25:31,649][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 12:25:31,650][root][INFO] - 
[2/ 5 Epoch]
[2024-09-19 12:25:32,228][root][INFO] - Step: 1900/9020  |  Loss: 0.3145  |  Score: 86.46 [%]  |  Seq Length: 128.0
[2024-09-19 12:25:56,730][root][INFO] - Step: 1600/9020  |  Loss: 0.4980  |  Score: 75.48 [%]  |  Seq Length: 128.0
[2024-09-19 12:26:00,036][root][INFO] - Step: 2000/9020  |  Loss: 0.3154  |  Score: 86.22 [%]  |  Seq Length: 128.0
[2024-09-19 12:26:01,364][root][INFO] - Step: 1900/9020  |  Loss: 0.2976  |  Score: 87.50 [%]  |  Seq Length: 128.0
[2024-09-19 12:26:27,789][root][INFO] - Step: 2100/9020  |  Loss: 0.3115  |  Score: 86.86 [%]  |  Seq Length: 128.0
[2024-09-19 12:26:31,936][root][INFO] - Step: 2000/9020  |  Loss: 0.3053  |  Score: 86.80 [%]  |  Seq Length: 128.0
[2024-09-19 12:26:34,967][root][INFO] - Step: 1700/9020  |  Loss: 0.4542  |  Score: 78.59 [%]  |  Seq Length: 128.0
[2024-09-19 12:26:54,351][root][INFO] - Step: 2200/9020  |  Loss: 0.3174  |  Score: 86.73 [%]  |  Seq Length: 128.0
[2024-09-19 12:27:02,756][root][INFO] - Step: 2100/9020  |  Loss: 0.3007  |  Score: 87.03 [%]  |  Seq Length: 128.0
[2024-09-19 12:27:13,489][root][INFO] - Step: 1800/9020  |  Loss: 0.4471  |  Score: 78.86 [%]  |  Seq Length: 128.0
[2024-09-19 12:27:15,024][root][INFO] - Step: 1804/9020  |  Loss: 0.5065  |  Score: 74.77 [%]  |  Seq Length: 128.0
[2024-09-19 12:27:22,569][root][INFO] - Step: 2300/9020  |  Loss: 0.3172  |  Score: 86.55 [%]  |  Seq Length: 128.0
[2024-09-19 12:27:33,043][root][INFO] - Step: 2200/9020  |  Loss: 0.3115  |  Score: 86.66 [%]  |  Seq Length: 128.0
[2024-09-19 12:27:47,639][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 12:27:47,639][root][INFO] - Score: 78.12 [%]  |  Evaluation Time: 32.61 [s]
[2024-09-19 12:27:50,275][root][INFO] - Step: 2400/9020  |  Loss: 0.3088  |  Score: 87.23 [%]  |  Seq Length: 128.0
[2024-09-19 12:28:04,289][root][INFO] - Step: 2300/9020  |  Loss: 0.3141  |  Score: 86.69 [%]  |  Seq Length: 128.0
[2024-09-19 12:28:18,320][root][INFO] - Step: 2500/9020  |  Loss: 0.3268  |  Score: 85.77 [%]  |  Seq Length: 128.0
[2024-09-19 12:28:34,867][root][INFO] - Step: 2400/9020  |  Loss: 0.3096  |  Score: 86.77 [%]  |  Seq Length: 128.0
[2024-09-19 12:28:46,241][root][INFO] - Step: 2600/9020  |  Loss: 0.3175  |  Score: 86.47 [%]  |  Seq Length: 128.0
[2024-09-19 12:29:05,973][root][INFO] - Step: 2500/9020  |  Loss: 0.3173  |  Score: 86.17 [%]  |  Seq Length: 128.0
[2024-09-19 12:29:14,378][root][INFO] - Step: 2700/9020  |  Loss: 0.3005  |  Score: 87.11 [%]  |  Seq Length: 128.0
[2024-09-19 12:29:34,884][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 12:29:34,885][root][INFO] - Score: 78.47 [%]  |  Evaluation Time: 107.24 [s]
[2024-09-19 12:29:34,886][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 12:29:34,887][root][INFO] - 
[2/ 5 Epoch]
[2024-09-19 12:29:36,844][root][INFO] - Step: 2600/9020  |  Loss: 0.3076  |  Score: 86.92 [%]  |  Seq Length: 128.0
[2024-09-19 12:29:42,049][root][INFO] - Step: 2800/9020  |  Loss: 0.3254  |  Score: 86.36 [%]  |  Seq Length: 128.0
[2024-09-19 12:30:07,310][root][INFO] - Step: 2700/9020  |  Loss: 0.3189  |  Score: 86.56 [%]  |  Seq Length: 128.0
[2024-09-19 12:30:10,675][root][INFO] - Step: 2900/9020  |  Loss: 0.3127  |  Score: 86.34 [%]  |  Seq Length: 128.0
[2024-09-19 12:30:13,202][root][INFO] - Step: 1900/9020  |  Loss: 0.4469  |  Score: 79.25 [%]  |  Seq Length: 128.0
[2024-09-19 12:30:38,214][root][INFO] - Step: 2800/9020  |  Loss: 0.3250  |  Score: 86.08 [%]  |  Seq Length: 128.0
[2024-09-19 12:30:38,833][root][INFO] - Step: 3000/9020  |  Loss: 0.3161  |  Score: 86.14 [%]  |  Seq Length: 128.0
[2024-09-19 12:30:52,421][root][INFO] - Step: 2000/9020  |  Loss: 0.4150  |  Score: 80.47 [%]  |  Seq Length: 128.0
[2024-09-19 12:31:06,354][root][INFO] - Step: 3100/9020  |  Loss: 0.3070  |  Score: 86.92 [%]  |  Seq Length: 128.0
[2024-09-19 12:31:08,760][root][INFO] - Step: 2900/9020  |  Loss: 0.3058  |  Score: 87.22 [%]  |  Seq Length: 128.0
[2024-09-19 12:31:31,538][root][INFO] - Step: 2100/9020  |  Loss: 0.4051  |  Score: 81.44 [%]  |  Seq Length: 128.0
[2024-09-19 12:31:34,230][root][INFO] - Step: 3200/9020  |  Loss: 0.3004  |  Score: 87.31 [%]  |  Seq Length: 128.0
[2024-09-19 12:31:40,031][root][INFO] - Step: 3000/9020  |  Loss: 0.3192  |  Score: 86.44 [%]  |  Seq Length: 128.0
[2024-09-19 12:32:01,403][root][INFO] - Step: 3300/9020  |  Loss: 0.3074  |  Score: 87.11 [%]  |  Seq Length: 128.0
[2024-09-19 12:32:10,205][root][INFO] - Step: 2200/9020  |  Loss: 0.4007  |  Score: 82.22 [%]  |  Seq Length: 128.0
[2024-09-19 12:32:10,397][root][INFO] - Step: 3100/9020  |  Loss: 0.3152  |  Score: 86.98 [%]  |  Seq Length: 128.0
[2024-09-19 12:32:28,762][root][INFO] - Step: 3400/9020  |  Loss: 0.3123  |  Score: 86.39 [%]  |  Seq Length: 128.0
[2024-09-19 12:32:42,233][root][INFO] - Step: 3200/9020  |  Loss: 0.3153  |  Score: 86.09 [%]  |  Seq Length: 128.0
[2024-09-19 12:32:49,041][root][INFO] - Step: 2300/9020  |  Loss: 0.3922  |  Score: 82.44 [%]  |  Seq Length: 128.0
[2024-09-19 12:32:57,055][root][INFO] - Step: 3500/9020  |  Loss: 0.3124  |  Score: 86.67 [%]  |  Seq Length: 128.0
[2024-09-19 12:33:13,146][root][INFO] - Step: 3300/9020  |  Loss: 0.3111  |  Score: 86.77 [%]  |  Seq Length: 128.0
[2024-09-19 12:33:25,269][root][INFO] - Step: 3600/9020  |  Loss: 0.3130  |  Score: 86.23 [%]  |  Seq Length: 128.0
[2024-09-19 12:33:27,621][root][INFO] - Step: 3608/9020  |  Loss: 0.3088  |  Score: 86.88 [%]  |  Seq Length: 128.0
[2024-09-19 12:33:28,056][root][INFO] - Step: 2400/9020  |  Loss: 0.4096  |  Score: 81.28 [%]  |  Seq Length: 128.0
[2024-09-19 12:33:44,241][root][INFO] - Step: 3400/9020  |  Loss: 0.3207  |  Score: 85.89 [%]  |  Seq Length: 128.0
[2024-09-19 12:33:47,098][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 12:33:47,098][root][INFO] - Score: 87.11 [%]  |  Evaluation Time: 19.47 [s]
[2024-09-19 12:34:07,006][root][INFO] - Step: 2500/9020  |  Loss: 0.3704  |  Score: 83.48 [%]  |  Seq Length: 128.0
[2024-09-19 12:34:15,134][root][INFO] - Step: 3500/9020  |  Loss: 0.3186  |  Score: 86.00 [%]  |  Seq Length: 128.0
[2024-09-19 12:34:45,597][root][INFO] - Step: 2600/9020  |  Loss: 0.3942  |  Score: 82.67 [%]  |  Seq Length: 128.0
[2024-09-19 12:34:46,344][root][INFO] - Step: 3600/9020  |  Loss: 0.3185  |  Score: 86.44 [%]  |  Seq Length: 128.0
[2024-09-19 12:34:48,686][root][INFO] - Step: 3608/9020  |  Loss: 0.3188  |  Score: 86.09 [%]  |  Seq Length: 128.0
[2024-09-19 12:34:50,622][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 12:34:50,623][root][INFO] - Score: 87.22 [%]  |  Evaluation Time: 63.52 [s]
[2024-09-19 12:34:50,624][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 12:34:50,625][root][INFO] - 
[3/ 5 Epoch]
[2024-09-19 12:35:07,044][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 12:35:07,044][root][INFO] - Score: 83.72 [%]  |  Evaluation Time: 18.36 [s]
[2024-09-19 12:35:13,943][root][INFO] - Step: 3700/9020  |  Loss: 0.2724  |  Score: 88.76 [%]  |  Seq Length: 128.0
[2024-09-19 12:35:24,756][root][INFO] - Step: 2700/9020  |  Loss: 0.3667  |  Score: 84.17 [%]  |  Seq Length: 128.0
[2024-09-19 12:35:42,286][root][INFO] - Step: 3800/9020  |  Loss: 0.2866  |  Score: 87.42 [%]  |  Seq Length: 128.0
[2024-09-19 12:36:04,408][root][INFO] - Step: 2800/9020  |  Loss: 0.3789  |  Score: 82.94 [%]  |  Seq Length: 128.0
[2024-09-19 12:36:06,143][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 12:36:06,143][root][INFO] - Score: 84.03 [%]  |  Evaluation Time: 59.10 [s]
[2024-09-19 12:36:06,145][root][INFO] - 
[3/ 5 Epoch]
[2024-09-19 12:36:11,196][root][INFO] - Step: 3900/9020  |  Loss: 0.2811  |  Score: 88.42 [%]  |  Seq Length: 128.0
[2024-09-19 12:36:34,248][root][INFO] - Step: 3700/9020  |  Loss: 0.2296  |  Score: 91.03 [%]  |  Seq Length: 128.0
[2024-09-19 12:36:39,391][root][INFO] - Step: 4000/9020  |  Loss: 0.2894  |  Score: 87.97 [%]  |  Seq Length: 128.0
[2024-09-19 12:36:43,586][root][INFO] - Step: 2900/9020  |  Loss: 0.3626  |  Score: 83.81 [%]  |  Seq Length: 128.0
[2024-09-19 12:37:05,187][root][INFO] - Step: 3800/9020  |  Loss: 0.2335  |  Score: 90.44 [%]  |  Seq Length: 128.0
[2024-09-19 12:37:08,303][root][INFO] - Step: 4100/9020  |  Loss: 0.2766  |  Score: 88.19 [%]  |  Seq Length: 128.0
[2024-09-19 12:37:21,915][root][INFO] - Step: 3000/9020  |  Loss: 0.3475  |  Score: 84.36 [%]  |  Seq Length: 128.0
[2024-09-19 12:37:35,968][root][INFO] - Step: 3900/9020  |  Loss: 0.2292  |  Score: 90.72 [%]  |  Seq Length: 128.0
[2024-09-19 12:37:37,189][root][INFO] - Step: 4200/9020  |  Loss: 0.2695  |  Score: 88.50 [%]  |  Seq Length: 128.0
[2024-09-19 12:38:00,219][root][INFO] - Step: 3100/9020  |  Loss: 0.3602  |  Score: 83.98 [%]  |  Seq Length: 128.0
[2024-09-19 12:38:05,012][root][INFO] - Step: 4300/9020  |  Loss: 0.2742  |  Score: 88.16 [%]  |  Seq Length: 128.0
[2024-09-19 12:38:06,902][root][INFO] - Step: 4000/9020  |  Loss: 0.2375  |  Score: 89.84 [%]  |  Seq Length: 128.0
[2024-09-19 12:38:33,338][root][INFO] - Step: 4400/9020  |  Loss: 0.2761  |  Score: 88.45 [%]  |  Seq Length: 128.0
[2024-09-19 12:38:37,381][root][INFO] - Step: 4100/9020  |  Loss: 0.2305  |  Score: 90.55 [%]  |  Seq Length: 128.0
[2024-09-19 12:38:38,573][root][INFO] - Step: 3200/9020  |  Loss: 0.3475  |  Score: 84.80 [%]  |  Seq Length: 128.0
[2024-09-19 12:39:02,132][root][INFO] - Step: 4500/9020  |  Loss: 0.2869  |  Score: 88.00 [%]  |  Seq Length: 128.0
[2024-09-19 12:39:07,454][root][INFO] - Step: 4200/9020  |  Loss: 0.2459  |  Score: 89.48 [%]  |  Seq Length: 128.0
[2024-09-19 12:39:17,399][root][INFO] - Step: 3300/9020  |  Loss: 0.3490  |  Score: 84.69 [%]  |  Seq Length: 128.0
[2024-09-19 12:39:30,611][root][INFO] - Step: 4600/9020  |  Loss: 0.2856  |  Score: 87.78 [%]  |  Seq Length: 128.0
[2024-09-19 12:39:38,591][root][INFO] - Step: 4300/9020  |  Loss: 0.2420  |  Score: 89.91 [%]  |  Seq Length: 128.0
[2024-09-19 12:39:52,659][root][INFO] - Step: 3400/9020  |  Loss: 0.3453  |  Score: 84.47 [%]  |  Seq Length: 128.0
[2024-09-19 12:39:58,938][root][INFO] - Step: 4700/9020  |  Loss: 0.2965  |  Score: 87.27 [%]  |  Seq Length: 128.0
[2024-09-19 12:40:08,983][root][INFO] - Step: 4400/9020  |  Loss: 0.2324  |  Score: 90.28 [%]  |  Seq Length: 128.0
[2024-09-19 12:40:27,369][root][INFO] - Step: 4800/9020  |  Loss: 0.2799  |  Score: 88.09 [%]  |  Seq Length: 128.0
[2024-09-19 12:40:31,045][root][INFO] - Step: 3500/9020  |  Loss: 0.3427  |  Score: 85.59 [%]  |  Seq Length: 128.0
[2024-09-19 12:40:39,125][root][INFO] - Step: 4500/9020  |  Loss: 0.2434  |  Score: 89.62 [%]  |  Seq Length: 128.0
[2024-09-19 12:40:56,158][root][INFO] - Step: 4900/9020  |  Loss: 0.2838  |  Score: 88.33 [%]  |  Seq Length: 128.0
[2024-09-19 12:41:08,375][root][INFO] - Step: 3600/9020  |  Loss: 0.3431  |  Score: 85.02 [%]  |  Seq Length: 128.0
[2024-09-19 12:41:09,267][root][INFO] - Step: 4600/9020  |  Loss: 0.2318  |  Score: 90.27 [%]  |  Seq Length: 128.0
[2024-09-19 12:41:11,486][root][INFO] - Step: 3608/9020  |  Loss: 0.3977  |  Score: 84.14 [%]  |  Seq Length: 128.0
[2024-09-19 12:41:25,197][root][INFO] - Step: 5000/9020  |  Loss: 0.2757  |  Score: 88.52 [%]  |  Seq Length: 128.0
[2024-09-19 12:41:40,274][root][INFO] - Step: 4700/9020  |  Loss: 0.2453  |  Score: 89.42 [%]  |  Seq Length: 128.0
[2024-09-19 12:41:44,309][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 12:41:44,309][root][INFO] - Score: 82.94 [%]  |  Evaluation Time: 32.82 [s]
[2024-09-19 12:41:54,291][root][INFO] - Step: 5100/9020  |  Loss: 0.2785  |  Score: 88.48 [%]  |  Seq Length: 128.0
[2024-09-19 12:42:10,732][root][INFO] - Step: 4800/9020  |  Loss: 0.2472  |  Score: 89.95 [%]  |  Seq Length: 128.0
[2024-09-19 12:42:23,148][root][INFO] - Step: 5200/9020  |  Loss: 0.2694  |  Score: 88.64 [%]  |  Seq Length: 128.0
[2024-09-19 12:42:40,011][root][INFO] - Step: 4900/9020  |  Loss: 0.2388  |  Score: 90.33 [%]  |  Seq Length: 128.0
[2024-09-19 12:42:51,943][root][INFO] - Step: 5300/9020  |  Loss: 0.2783  |  Score: 88.36 [%]  |  Seq Length: 128.0
[2024-09-19 12:43:10,866][root][INFO] - Step: 5000/9020  |  Loss: 0.2542  |  Score: 89.52 [%]  |  Seq Length: 128.0
[2024-09-19 12:43:18,679][root][INFO] - Step: 5400/9020  |  Loss: 0.2687  |  Score: 88.41 [%]  |  Seq Length: 128.0
[2024-09-19 12:43:22,217][root][INFO] - Step: 5412/9020  |  Loss: 0.2676  |  Score: 89.45 [%]  |  Seq Length: 128.0
[2024-09-19 12:43:33,086][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 12:43:33,087][root][INFO] - Score: 83.11 [%]  |  Evaluation Time: 108.77 [s]
[2024-09-19 12:43:33,089][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 12:43:33,092][root][INFO] - 
[3/ 5 Epoch]
[2024-09-19 12:43:41,593][root][INFO] - Step: 5100/9020  |  Loss: 0.2423  |  Score: 90.00 [%]  |  Seq Length: 128.0
[2024-09-19 12:43:41,830][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 12:43:41,830][root][INFO] - Score: 87.62 [%]  |  Evaluation Time: 19.61 [s]
[2024-09-19 12:44:08,989][root][INFO] - Step: 3700/9020  |  Loss: 0.3231  |  Score: 86.33 [%]  |  Seq Length: 128.0
[2024-09-19 12:44:12,047][root][INFO] - Step: 5200/9020  |  Loss: 0.2451  |  Score: 89.95 [%]  |  Seq Length: 128.0
[2024-09-19 12:44:43,508][root][INFO] - Step: 5300/9020  |  Loss: 0.2463  |  Score: 90.06 [%]  |  Seq Length: 128.0
[2024-09-19 12:44:45,589][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 12:44:45,589][root][INFO] - Score: 87.79 [%]  |  Evaluation Time: 63.76 [s]
[2024-09-19 12:44:45,590][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-19 12:44:45,591][root][INFO] - 
[4/ 5 Epoch]
[2024-09-19 12:44:47,422][root][INFO] - Step: 3800/9020  |  Loss: 0.3388  |  Score: 85.41 [%]  |  Seq Length: 128.0
[2024-09-19 12:45:10,862][root][INFO] - Step: 5500/9020  |  Loss: 0.2523  |  Score: 89.35 [%]  |  Seq Length: 128.0
[2024-09-19 12:45:14,746][root][INFO] - Step: 5400/9020  |  Loss: 0.2348  |  Score: 90.23 [%]  |  Seq Length: 128.0
[2024-09-19 12:45:18,395][root][INFO] - Step: 5412/9020  |  Loss: 0.2608  |  Score: 89.30 [%]  |  Seq Length: 128.0
[2024-09-19 12:45:25,748][root][INFO] - Step: 3900/9020  |  Loss: 0.3349  |  Score: 85.78 [%]  |  Seq Length: 128.0
[2024-09-19 12:45:37,083][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 12:45:37,083][root][INFO] - Score: 83.83 [%]  |  Evaluation Time: 18.69 [s]
[2024-09-19 12:45:39,045][root][INFO] - Step: 5600/9020  |  Loss: 0.2454  |  Score: 90.11 [%]  |  Seq Length: 128.0
[2024-09-19 12:46:03,851][root][INFO] - Step: 4000/9020  |  Loss: 0.3264  |  Score: 86.61 [%]  |  Seq Length: 128.0
[2024-09-19 12:46:07,603][root][INFO] - Step: 5700/9020  |  Loss: 0.2414  |  Score: 89.92 [%]  |  Seq Length: 128.0
[2024-09-19 12:46:36,414][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 12:46:36,414][root][INFO] - Score: 83.85 [%]  |  Evaluation Time: 59.33 [s]
[2024-09-19 12:46:36,417][root][INFO] - 
[4/ 5 Epoch]
[2024-09-19 12:46:36,454][root][INFO] - Step: 5800/9020  |  Loss: 0.2382  |  Score: 90.06 [%]  |  Seq Length: 128.0
[2024-09-19 12:46:39,806][root][INFO] - Step: 4100/9020  |  Loss: 0.3304  |  Score: 85.89 [%]  |  Seq Length: 128.0
[2024-09-19 12:47:03,825][root][INFO] - Step: 5500/9020  |  Loss: 0.1540  |  Score: 94.03 [%]  |  Seq Length: 128.0
[2024-09-19 12:47:04,819][root][INFO] - Step: 5900/9020  |  Loss: 0.2390  |  Score: 90.22 [%]  |  Seq Length: 128.0
[2024-09-19 12:47:17,545][root][INFO] - Step: 4200/9020  |  Loss: 0.3038  |  Score: 87.08 [%]  |  Seq Length: 128.0
[2024-09-19 12:47:33,280][root][INFO] - Step: 6000/9020  |  Loss: 0.2322  |  Score: 90.47 [%]  |  Seq Length: 128.0
[2024-09-19 12:47:35,579][root][INFO] - Step: 5600/9020  |  Loss: 0.1490  |  Score: 94.14 [%]  |  Seq Length: 128.0
[2024-09-19 12:47:53,528][root][INFO] - Step: 4300/9020  |  Loss: 0.3192  |  Score: 86.45 [%]  |  Seq Length: 128.0
[2024-09-19 12:48:02,401][root][INFO] - Step: 6100/9020  |  Loss: 0.2336  |  Score: 90.50 [%]  |  Seq Length: 128.0
[2024-09-19 12:48:06,453][root][INFO] - Step: 5700/9020  |  Loss: 0.1681  |  Score: 93.48 [%]  |  Seq Length: 128.0
[2024-09-19 12:48:30,682][root][INFO] - Step: 6200/9020  |  Loss: 0.2413  |  Score: 89.56 [%]  |  Seq Length: 128.0
[2024-09-19 12:48:31,879][root][INFO] - Step: 4400/9020  |  Loss: 0.3241  |  Score: 86.19 [%]  |  Seq Length: 128.0
[2024-09-19 12:48:36,932][root][INFO] - Step: 5800/9020  |  Loss: 0.1645  |  Score: 93.91 [%]  |  Seq Length: 128.0
[2024-09-19 12:48:58,141][root][INFO] - Step: 6300/9020  |  Loss: 0.2403  |  Score: 89.94 [%]  |  Seq Length: 128.0
[2024-09-19 12:49:07,605][root][INFO] - Step: 5900/9020  |  Loss: 0.1681  |  Score: 93.55 [%]  |  Seq Length: 128.0
[2024-09-19 12:49:09,198][root][INFO] - Step: 4500/9020  |  Loss: 0.3090  |  Score: 86.95 [%]  |  Seq Length: 128.0
[2024-09-19 12:49:27,212][root][INFO] - Step: 6400/9020  |  Loss: 0.2356  |  Score: 90.30 [%]  |  Seq Length: 128.0
[2024-09-19 12:49:38,119][root][INFO] - Step: 6000/9020  |  Loss: 0.1743  |  Score: 93.11 [%]  |  Seq Length: 128.0
[2024-09-19 12:49:47,995][root][INFO] - Step: 4600/9020  |  Loss: 0.3135  |  Score: 86.64 [%]  |  Seq Length: 128.0
[2024-09-19 12:49:56,187][root][INFO] - Step: 6500/9020  |  Loss: 0.2363  |  Score: 90.38 [%]  |  Seq Length: 128.0
[2024-09-19 12:50:08,624][root][INFO] - Step: 6100/9020  |  Loss: 0.1715  |  Score: 93.16 [%]  |  Seq Length: 128.0
[2024-09-19 12:50:24,875][root][INFO] - Step: 6600/9020  |  Loss: 0.2347  |  Score: 90.06 [%]  |  Seq Length: 128.0
[2024-09-19 12:50:26,394][root][INFO] - Step: 4700/9020  |  Loss: 0.3133  |  Score: 86.16 [%]  |  Seq Length: 128.0
[2024-09-19 12:50:39,149][root][INFO] - Step: 6200/9020  |  Loss: 0.1613  |  Score: 93.59 [%]  |  Seq Length: 128.0
[2024-09-19 12:50:53,471][root][INFO] - Step: 6700/9020  |  Loss: 0.2410  |  Score: 89.86 [%]  |  Seq Length: 128.0
[2024-09-19 12:51:05,349][root][INFO] - Step: 4800/9020  |  Loss: 0.3097  |  Score: 86.67 [%]  |  Seq Length: 128.0
[2024-09-19 12:51:09,430][root][INFO] - Step: 6300/9020  |  Loss: 0.1605  |  Score: 93.53 [%]  |  Seq Length: 128.0
[2024-09-19 12:51:21,943][root][INFO] - Step: 6800/9020  |  Loss: 0.2293  |  Score: 90.88 [%]  |  Seq Length: 128.0
[2024-09-19 12:51:39,885][root][INFO] - Step: 6400/9020  |  Loss: 0.1598  |  Score: 93.31 [%]  |  Seq Length: 128.0
[2024-09-19 12:51:43,652][root][INFO] - Step: 4900/9020  |  Loss: 0.3070  |  Score: 87.20 [%]  |  Seq Length: 128.0
[2024-09-19 12:51:50,477][root][INFO] - Step: 6900/9020  |  Loss: 0.2376  |  Score: 90.33 [%]  |  Seq Length: 128.0
[2024-09-19 12:52:10,779][root][INFO] - Step: 6500/9020  |  Loss: 0.1615  |  Score: 93.58 [%]  |  Seq Length: 128.0
[2024-09-19 12:52:19,062][root][INFO] - Step: 7000/9020  |  Loss: 0.2311  |  Score: 90.42 [%]  |  Seq Length: 128.0
[2024-09-19 12:52:21,585][root][INFO] - Step: 5000/9020  |  Loss: 0.2990  |  Score: 87.30 [%]  |  Seq Length: 128.0
[2024-09-19 12:52:42,358][root][INFO] - Step: 6600/9020  |  Loss: 0.1617  |  Score: 93.50 [%]  |  Seq Length: 128.0
[2024-09-19 12:52:48,155][root][INFO] - Step: 7100/9020  |  Loss: 0.2403  |  Score: 90.17 [%]  |  Seq Length: 128.0
[2024-09-19 12:52:59,621][root][INFO] - Step: 5100/9020  |  Loss: 0.3142  |  Score: 86.39 [%]  |  Seq Length: 128.0
[2024-09-19 12:53:13,438][root][INFO] - Step: 6700/9020  |  Loss: 0.1591  |  Score: 93.55 [%]  |  Seq Length: 128.0
[2024-09-19 12:53:16,235][root][INFO] - Step: 7200/9020  |  Loss: 0.2434  |  Score: 90.11 [%]  |  Seq Length: 128.0
[2024-09-19 12:53:21,009][root][INFO] - Step: 7216/9020  |  Loss: 0.2366  |  Score: 90.33 [%]  |  Seq Length: 128.0
[2024-09-19 12:53:38,381][root][INFO] - Step: 5200/9020  |  Loss: 0.3044  |  Score: 86.94 [%]  |  Seq Length: 128.0
[2024-09-19 12:53:40,457][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 12:53:40,457][root][INFO] - Score: 88.30 [%]  |  Evaluation Time: 19.45 [s]
[2024-09-19 12:53:44,222][root][INFO] - Step: 6800/9020  |  Loss: 0.1582  |  Score: 93.69 [%]  |  Seq Length: 128.0
[2024-09-19 12:54:15,098][root][INFO] - Step: 6900/9020  |  Loss: 0.1602  |  Score: 93.31 [%]  |  Seq Length: 128.0
[2024-09-19 12:54:17,158][root][INFO] - Step: 5300/9020  |  Loss: 0.3061  |  Score: 87.08 [%]  |  Seq Length: 128.0
[2024-09-19 12:54:44,317][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 12:54:44,318][root][INFO] - Score: 88.47 [%]  |  Evaluation Time: 63.86 [s]
[2024-09-19 12:54:44,319][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-19 12:54:44,320][root][INFO] - 
[5/ 5 Epoch]
[2024-09-19 12:54:45,361][root][INFO] - Step: 7000/9020  |  Loss: 0.1580  |  Score: 93.64 [%]  |  Seq Length: 128.0
[2024-09-19 12:54:55,527][root][INFO] - Step: 5400/9020  |  Loss: 0.3089  |  Score: 87.09 [%]  |  Seq Length: 128.0
[2024-09-19 12:54:59,426][root][INFO] - Step: 5412/9020  |  Loss: 0.3000  |  Score: 87.21 [%]  |  Seq Length: 128.0
[2024-09-19 12:55:08,333][root][INFO] - Step: 7300/9020  |  Loss: 0.2054  |  Score: 91.11 [%]  |  Seq Length: 128.0
[2024-09-19 12:55:16,754][root][INFO] - Step: 7100/9020  |  Loss: 0.1639  |  Score: 93.75 [%]  |  Seq Length: 128.0
[2024-09-19 12:55:32,839][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 12:55:32,840][root][INFO] - Score: 87.30 [%]  |  Evaluation Time: 33.41 [s]
[2024-09-19 12:55:36,702][root][INFO] - Step: 7400/9020  |  Loss: 0.2017  |  Score: 91.77 [%]  |  Seq Length: 128.0
[2024-09-19 12:55:47,706][root][INFO] - Step: 7200/9020  |  Loss: 0.1626  |  Score: 93.20 [%]  |  Seq Length: 128.0
[2024-09-19 12:55:52,884][root][INFO] - Step: 7216/9020  |  Loss: 0.1486  |  Score: 94.24 [%]  |  Seq Length: 128.0
[2024-09-19 12:56:05,800][root][INFO] - Step: 7500/9020  |  Loss: 0.2084  |  Score: 91.47 [%]  |  Seq Length: 128.0
[2024-09-19 12:56:10,693][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 12:56:10,693][root][INFO] - Score: 83.56 [%]  |  Evaluation Time: 17.81 [s]
[2024-09-19 12:56:34,884][root][INFO] - Step: 7600/9020  |  Loss: 0.1952  |  Score: 92.23 [%]  |  Seq Length: 128.0
[2024-09-19 12:57:04,243][root][INFO] - Step: 7700/9020  |  Loss: 0.2146  |  Score: 91.30 [%]  |  Seq Length: 128.0
[2024-09-19 12:57:08,357][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 12:57:08,357][root][INFO] - Score: 83.42 [%]  |  Evaluation Time: 57.66 [s]
[2024-09-19 12:57:08,360][root][INFO] - 
[5/ 5 Epoch]
[2024-09-19 12:57:19,193][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 12:57:19,193][root][INFO] - Score: 87.24 [%]  |  Evaluation Time: 106.35 [s]
[2024-09-19 12:57:19,194][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-19 12:57:19,196][root][INFO] - 
[4/ 5 Epoch]
[2024-09-19 12:57:33,006][root][INFO] - Step: 7800/9020  |  Loss: 0.2048  |  Score: 91.70 [%]  |  Seq Length: 128.0
[2024-09-19 12:57:34,027][root][INFO] - Step: 7300/9020  |  Loss: 0.1130  |  Score: 95.65 [%]  |  Seq Length: 128.0
[2024-09-19 12:57:52,658][root][INFO] - Step: 5500/9020  |  Loss: 0.2764  |  Score: 88.67 [%]  |  Seq Length: 128.0
[2024-09-19 12:58:01,500][root][INFO] - Step: 7900/9020  |  Loss: 0.2023  |  Score: 92.00 [%]  |  Seq Length: 128.0
[2024-09-19 12:58:04,682][root][INFO] - Step: 7400/9020  |  Loss: 0.1145  |  Score: 95.56 [%]  |  Seq Length: 128.0
[2024-09-19 12:58:25,356][root][INFO] - Step: 5600/9020  |  Loss: 0.2713  |  Score: 87.95 [%]  |  Seq Length: 128.0
[2024-09-19 12:58:30,030][root][INFO] - Step: 8000/9020  |  Loss: 0.2054  |  Score: 92.00 [%]  |  Seq Length: 128.0
[2024-09-19 12:58:35,442][root][INFO] - Step: 7500/9020  |  Loss: 0.1026  |  Score: 96.11 [%]  |  Seq Length: 128.0
[2024-09-19 12:58:58,603][root][INFO] - Step: 8100/9020  |  Loss: 0.2064  |  Score: 91.91 [%]  |  Seq Length: 128.0
[2024-09-19 12:59:03,333][root][INFO] - Step: 5700/9020  |  Loss: 0.2752  |  Score: 88.27 [%]  |  Seq Length: 128.0
[2024-09-19 12:59:05,508][root][INFO] - Step: 7600/9020  |  Loss: 0.1089  |  Score: 95.83 [%]  |  Seq Length: 128.0
[2024-09-19 12:59:27,146][root][INFO] - Step: 8200/9020  |  Loss: 0.2095  |  Score: 91.61 [%]  |  Seq Length: 128.0
[2024-09-19 12:59:35,887][root][INFO] - Step: 7700/9020  |  Loss: 0.1003  |  Score: 96.20 [%]  |  Seq Length: 128.0
[2024-09-19 12:59:41,663][root][INFO] - Step: 5800/9020  |  Loss: 0.2735  |  Score: 88.50 [%]  |  Seq Length: 128.0
[2024-09-19 12:59:55,042][root][INFO] - Step: 8300/9020  |  Loss: 0.2048  |  Score: 91.98 [%]  |  Seq Length: 128.0
[2024-09-19 13:00:06,685][root][INFO] - Step: 7800/9020  |  Loss: 0.0983  |  Score: 96.19 [%]  |  Seq Length: 128.0
[2024-09-19 13:00:19,400][root][INFO] - Step: 5900/9020  |  Loss: 0.2680  |  Score: 88.70 [%]  |  Seq Length: 128.0
[2024-09-19 13:00:21,962][root][INFO] - Step: 8400/9020  |  Loss: 0.2114  |  Score: 91.62 [%]  |  Seq Length: 128.0
[2024-09-19 13:00:36,003][root][INFO] - Step: 7900/9020  |  Loss: 0.1104  |  Score: 95.83 [%]  |  Seq Length: 128.0
[2024-09-19 13:00:49,196][root][INFO] - Step: 8500/9020  |  Loss: 0.2115  |  Score: 91.02 [%]  |  Seq Length: 128.0
[2024-09-19 13:00:57,620][root][INFO] - Step: 6000/9020  |  Loss: 0.2767  |  Score: 88.09 [%]  |  Seq Length: 128.0
[2024-09-19 13:01:06,451][root][INFO] - Step: 8000/9020  |  Loss: 0.1106  |  Score: 95.92 [%]  |  Seq Length: 128.0
[2024-09-19 13:01:17,211][root][INFO] - Step: 8600/9020  |  Loss: 0.2134  |  Score: 91.17 [%]  |  Seq Length: 128.0
[2024-09-19 13:01:36,600][root][INFO] - Step: 6100/9020  |  Loss: 0.2747  |  Score: 88.34 [%]  |  Seq Length: 128.0
[2024-09-19 13:01:37,227][root][INFO] - Step: 8100/9020  |  Loss: 0.1129  |  Score: 95.80 [%]  |  Seq Length: 128.0
[2024-09-19 13:01:45,929][root][INFO] - Step: 8700/9020  |  Loss: 0.2010  |  Score: 91.94 [%]  |  Seq Length: 128.0
[2024-09-19 13:02:08,264][root][INFO] - Step: 8200/9020  |  Loss: 0.1045  |  Score: 95.89 [%]  |  Seq Length: 128.0
[2024-09-19 13:02:14,043][root][INFO] - Step: 8800/9020  |  Loss: 0.2139  |  Score: 91.39 [%]  |  Seq Length: 128.0
[2024-09-19 13:02:14,441][root][INFO] - Step: 6200/9020  |  Loss: 0.2723  |  Score: 88.75 [%]  |  Seq Length: 128.0
[2024-09-19 13:02:38,857][root][INFO] - Step: 8300/9020  |  Loss: 0.1109  |  Score: 95.73 [%]  |  Seq Length: 128.0
[2024-09-19 13:02:41,889][root][INFO] - Step: 8900/9020  |  Loss: 0.2158  |  Score: 91.31 [%]  |  Seq Length: 128.0
[2024-09-19 13:02:53,552][root][INFO] - Step: 6300/9020  |  Loss: 0.2678  |  Score: 88.61 [%]  |  Seq Length: 128.0
[2024-09-19 13:03:09,439][root][INFO] - Step: 8400/9020  |  Loss: 0.1022  |  Score: 96.16 [%]  |  Seq Length: 128.0
[2024-09-19 13:03:09,974][root][INFO] - Step: 9000/9020  |  Loss: 0.2025  |  Score: 91.89 [%]  |  Seq Length: 128.0
[2024-09-19 13:03:15,766][root][INFO] - Step: 9020/9020  |  Loss: 0.1918  |  Score: 92.81 [%]  |  Seq Length: 128.0
[2024-09-19 13:03:31,219][root][INFO] - Step: 6400/9020  |  Loss: 0.2737  |  Score: 88.34 [%]  |  Seq Length: 128.0
[2024-09-19 13:03:35,433][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 13:03:35,433][root][INFO] - Score: 88.48 [%]  |  Evaluation Time: 19.66 [s]
[2024-09-19 13:03:38,802][root][INFO] - Step: 8500/9020  |  Loss: 0.1004  |  Score: 96.30 [%]  |  Seq Length: 128.0
[2024-09-19 13:04:09,832][root][INFO] - Step: 6500/9020  |  Loss: 0.2704  |  Score: 88.95 [%]  |  Seq Length: 128.0
[2024-09-19 13:04:10,991][root][INFO] - Step: 8600/9020  |  Loss: 0.0902  |  Score: 96.48 [%]  |  Seq Length: 128.0
[2024-09-19 13:04:39,136][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 13:04:39,137][root][INFO] - Score: 88.57 [%]  |  Evaluation Time: 63.70 [s]
[2024-09-19 13:04:39,138][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-19 13:04:39,138][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 13:04:39,138][root][INFO] - - Epoch: 5
[2024-09-19 13:04:39,138][root][INFO] - - DEV score: 88.48 [%]
[2024-09-19 13:04:39,138][root][INFO] - - TEST score: 88.57 [%]
[2024-09-19 13:04:39,139][root][INFO] - Fine-tuning is done!
[2024-09-19 13:04:41,295][root][INFO] - Step: 8700/9020  |  Loss: 0.0982  |  Score: 96.30 [%]  |  Seq Length: 128.0
[2024-09-19 13:04:49,106][root][INFO] - Step: 6600/9020  |  Loss: 0.2615  |  Score: 88.94 [%]  |  Seq Length: 128.0
[2024-09-19 13:05:12,035][root][INFO] - Step: 8800/9020  |  Loss: 0.1161  |  Score: 95.98 [%]  |  Seq Length: 128.0
[2024-09-19 13:05:25,923][root][INFO] - Step: 6700/9020  |  Loss: 0.2646  |  Score: 89.23 [%]  |  Seq Length: 128.0
[2024-09-19 13:05:42,737][root][INFO] - Step: 8900/9020  |  Loss: 0.1144  |  Score: 95.66 [%]  |  Seq Length: 128.0
[2024-09-19 13:06:04,782][root][INFO] - Step: 6800/9020  |  Loss: 0.2652  |  Score: 88.92 [%]  |  Seq Length: 128.0
[2024-09-19 13:06:14,001][root][INFO] - Step: 9000/9020  |  Loss: 0.1002  |  Score: 96.28 [%]  |  Seq Length: 128.0
[2024-09-19 13:06:20,266][root][INFO] - Step: 9020/9020  |  Loss: 0.1324  |  Score: 95.47 [%]  |  Seq Length: 128.0
[2024-09-19 13:06:37,983][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 13:06:37,984][root][INFO] - Score: 83.18 [%]  |  Evaluation Time: 17.72 [s]
[2024-09-19 13:06:43,018][root][INFO] - Step: 6900/9020  |  Loss: 0.2652  |  Score: 88.95 [%]  |  Seq Length: 128.0
[2024-09-19 13:07:21,730][root][INFO] - Step: 7000/9020  |  Loss: 0.2458  |  Score: 90.00 [%]  |  Seq Length: 128.0
[2024-09-19 13:07:38,476][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 13:07:38,477][root][INFO] - Score: 83.19 [%]  |  Evaluation Time: 60.49 [s]
[2024-09-19 13:07:38,478][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 13:07:38,478][root][INFO] - - Epoch: 1
[2024-09-19 13:07:38,478][root][INFO] - - DEV score: 84.04 [%]
[2024-09-19 13:07:38,478][root][INFO] - - TEST score: 83.72 [%]
[2024-09-19 13:07:38,480][root][INFO] - Fine-tuning is done!
[2024-09-19 13:08:00,562][root][INFO] - Step: 7100/9020  |  Loss: 0.2585  |  Score: 89.34 [%]  |  Seq Length: 128.0
[2024-09-19 13:08:37,631][root][INFO] - Step: 7200/9020  |  Loss: 0.2561  |  Score: 89.22 [%]  |  Seq Length: 128.0
[2024-09-19 13:08:43,691][root][INFO] - Step: 7216/9020  |  Loss: 0.2810  |  Score: 88.34 [%]  |  Seq Length: 128.0
[2024-09-19 13:09:16,823][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 13:09:16,824][root][INFO] - Score: 88.10 [%]  |  Evaluation Time: 33.13 [s]
[2024-09-19 13:11:00,167][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 13:11:00,167][root][INFO] - Score: 87.98 [%]  |  Evaluation Time: 103.34 [s]
[2024-09-19 13:11:00,168][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-19 13:11:00,170][root][INFO] - 
[5/ 5 Epoch]
[2024-09-19 13:11:31,883][root][INFO] - Step: 7300/9020  |  Loss: 0.2322  |  Score: 90.85 [%]  |  Seq Length: 128.0
[2024-09-19 13:12:08,833][root][INFO] - Step: 7400/9020  |  Loss: 0.2354  |  Score: 90.11 [%]  |  Seq Length: 128.0
[2024-09-19 13:12:45,628][root][INFO] - Step: 7500/9020  |  Loss: 0.2378  |  Score: 90.61 [%]  |  Seq Length: 128.0
[2024-09-19 13:13:22,294][root][INFO] - Step: 7600/9020  |  Loss: 0.2316  |  Score: 90.48 [%]  |  Seq Length: 128.0
[2024-09-19 13:13:58,614][root][INFO] - Step: 7700/9020  |  Loss: 0.2390  |  Score: 89.98 [%]  |  Seq Length: 128.0
[2024-09-19 13:14:35,410][root][INFO] - Step: 7800/9020  |  Loss: 0.2311  |  Score: 90.92 [%]  |  Seq Length: 128.0
[2024-09-19 13:15:14,373][root][INFO] - Step: 7900/9020  |  Loss: 0.2217  |  Score: 90.97 [%]  |  Seq Length: 128.0
[2024-09-19 13:15:52,480][root][INFO] - Step: 8000/9020  |  Loss: 0.2289  |  Score: 90.52 [%]  |  Seq Length: 128.0
[2024-09-19 13:16:29,654][root][INFO] - Step: 8100/9020  |  Loss: 0.2360  |  Score: 90.12 [%]  |  Seq Length: 128.0
[2024-09-19 13:17:06,623][root][INFO] - Step: 8200/9020  |  Loss: 0.2318  |  Score: 90.64 [%]  |  Seq Length: 128.0
[2024-09-19 13:17:44,200][root][INFO] - Step: 8300/9020  |  Loss: 0.2301  |  Score: 90.75 [%]  |  Seq Length: 128.0
[2024-09-19 13:18:22,706][root][INFO] - Step: 8400/9020  |  Loss: 0.2269  |  Score: 90.56 [%]  |  Seq Length: 128.0
[2024-09-19 13:18:59,936][root][INFO] - Step: 8500/9020  |  Loss: 0.2264  |  Score: 90.56 [%]  |  Seq Length: 128.0
[2024-09-19 13:19:37,582][root][INFO] - Step: 8600/9020  |  Loss: 0.2376  |  Score: 90.16 [%]  |  Seq Length: 128.0
[2024-09-19 13:20:16,008][root][INFO] - Step: 8700/9020  |  Loss: 0.2344  |  Score: 90.33 [%]  |  Seq Length: 128.0
[2024-09-19 13:20:53,904][root][INFO] - Step: 8800/9020  |  Loss: 0.2256  |  Score: 90.78 [%]  |  Seq Length: 128.0
[2024-09-19 13:21:30,609][root][INFO] - Step: 8900/9020  |  Loss: 0.2282  |  Score: 90.67 [%]  |  Seq Length: 128.0
[2024-09-19 13:22:08,673][root][INFO] - Step: 9000/9020  |  Loss: 0.2315  |  Score: 90.52 [%]  |  Seq Length: 128.0
[2024-09-19 13:22:16,109][root][INFO] - Step: 9020/9020  |  Loss: 0.2041  |  Score: 92.09 [%]  |  Seq Length: 128.0
[2024-09-19 13:22:48,148][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 13:22:48,148][root][INFO] - Score: 88.20 [%]  |  Evaluation Time: 32.04 [s]
[2024-09-19 13:24:32,089][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 13:24:32,089][root][INFO] - Score: 88.10 [%]  |  Evaluation Time: 103.94 [s]
[2024-09-19 13:24:32,090][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-19 13:24:32,090][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 13:24:32,090][root][INFO] - - Epoch: 5
[2024-09-19 13:24:32,091][root][INFO] - - DEV score: 88.20 [%]
[2024-09-19 13:24:32,091][root][INFO] - - TEST score: 88.10 [%]
[2024-09-19 13:24:32,091][root][INFO] - Fine-tuning is done!
[2024-09-19 13:32:48,860][root][INFO] - 

[2024-09-19 13:32:48,860][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 13:32:48,860][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.0001lr_42rs
[2024-09-19 13:32:48,860][root][INFO] - 

[2024-09-19 13:32:48,860][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 128, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.0001, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 4, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.0001lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.0001lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.0001lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 13:33:13,205][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 13:33:13,971][root][INFO] - 

[2024-09-19 13:33:13,971][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 13:33:13,971][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs
[2024-09-19 13:33:13,971][root][INFO] - 

[2024-09-19 13:33:13,971][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 128, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 8, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 13:33:14,987][root][INFO] - 

[2024-09-19 13:33:14,987][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-19 13:33:14,987][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 13:33:14,994][root][INFO] - vocab size              : 51200
[2024-09-19 13:33:14,994][root][INFO] - device                  : gpu
[2024-09-19 13:33:14,994][root][INFO] - random seed             : 42
[2024-09-19 13:33:14,995][root][INFO] - train data size         : 28864
[2024-09-19 13:33:14,995][root][INFO] - max epochs              : 5
[2024-09-19 13:33:14,995][root][INFO] - total steps             : 9020
[2024-09-19 13:33:14,995][root][INFO] - warmup steps            : 902
[2024-09-19 13:33:14,995][root][INFO] - batch size              : 64
[2024-09-19 13:33:14,995][root][INFO] - accumulation steps      : 4
[2024-09-19 13:33:14,995][root][INFO] - optimizer               : adamwscale
[2024-09-19 13:33:14,995][root][INFO] - lr_scheduler            : cosine
[2024-09-19 13:33:14,995][root][INFO] - learning rate           : 0.0001
[2024-09-19 13:33:14,995][root][INFO] - max length              : 128

[2024-09-19 13:33:14,995][root][INFO] - 

[2024-09-19 13:33:14,996][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.0001lr_42rs
[2024-09-19 13:33:14,996][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.0001lr_42rs/ckpt
[2024-09-19 13:33:14,996][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.0001lr_42rs/tb
[2024-09-19 13:33:14,996][root][INFO] - * tb interval           : 100

[2024-09-19 13:33:14,996][root][INFO] - 

[2024-09-19 13:33:14,996][root][INFO] - Start the Training !
[2024-09-19 13:33:14,999][root][INFO] - 
[1/ 5 Epoch]
[2024-09-19 13:33:18,892][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:18,892][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:18,893][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:18,893][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:18,893][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:18,894][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:18,894][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:18,894][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:18,895][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:18,895][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:18,896][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:18,896][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:18,896][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:18,897][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:18,897][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:18,898][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:18,898][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:18,898][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:18,899][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:18,899][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:18,900][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:18,900][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:18,901][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:18,901][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:18,903][root][INFO] - Trainable params: 884736 || all params: 126049536 || trainable: 0.70 %
[2024-09-19 13:33:19,073][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 13:33:20,874][root][INFO] - 

[2024-09-19 13:33:20,874][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-19 13:33:20,874][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 13:33:20,881][root][INFO] - vocab size              : 51200
[2024-09-19 13:33:20,882][root][INFO] - device                  : gpu
[2024-09-19 13:33:20,882][root][INFO] - random seed             : 42
[2024-09-19 13:33:20,882][root][INFO] - train data size         : 544
[2024-09-19 13:33:20,882][root][INFO] - max epochs              : 15
[2024-09-19 13:33:20,882][root][INFO] - total steps             : 1033
[2024-09-19 13:33:20,882][root][INFO] - warmup steps            : 103
[2024-09-19 13:33:20,882][root][INFO] - batch size              : 64
[2024-09-19 13:33:20,882][root][INFO] - accumulation steps      : 8
[2024-09-19 13:33:20,882][root][INFO] - optimizer               : adamwscale
[2024-09-19 13:33:20,882][root][INFO] - lr_scheduler            : cosine
[2024-09-19 13:33:20,882][root][INFO] - learning rate           : 0.02
[2024-09-19 13:33:20,882][root][INFO] - max length              : 128

[2024-09-19 13:33:20,883][root][INFO] - LoRA Configuration
[2024-09-19 13:33:20,883][root][INFO] - ㄴ r                    : 16
[2024-09-19 13:33:20,883][root][INFO] - ㄴ alpha                : 64
[2024-09-19 13:33:20,883][root][INFO] - ㄴ dropout              : 0.03

[2024-09-19 13:33:20,883][root][INFO] - 

[2024-09-19 13:33:20,883][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs
[2024-09-19 13:33:20,883][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs/ckpt
[2024-09-19 13:33:20,883][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs/tb
[2024-09-19 13:33:20,883][root][INFO] - * tb interval           : 15

[2024-09-19 13:33:20,883][root][INFO] - 

[2024-09-19 13:33:20,883][root][INFO] - Start the Training !
[2024-09-19 13:33:20,886][root][INFO] - 
[1/ 15 Epoch]
[2024-09-19 13:33:27,008][root][INFO] - 

[2024-09-19 13:33:27,008][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 13:33:27,008][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs
[2024-09-19 13:33:27,008][root][INFO] - 

[2024-09-19 13:33:27,008][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 128, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 8, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 13:33:30,680][root][INFO] - Step: 15/1033  |  Loss: 3.1790  |  Score: 3.91 [%]  |  Seq Length: 128.0
[2024-09-19 13:33:32,279][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:32,279][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:32,280][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:32,280][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:32,281][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:32,281][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:32,281][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:32,282][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:32,282][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:32,283][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:32,283][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:32,283][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:32,284][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:32,284][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:32,284][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:32,285][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:32,285][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:32,286][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:32,286][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:32,286][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:32,287][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:32,287][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:32,288][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:32,288][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:32,290][root][INFO] - Trainable params: 884736 || all params: 126049536 || trainable: 0.70 %
[2024-09-19 13:33:32,293][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-19 13:33:32,299][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-19 13:33:32,301][root][INFO] - Trainable params: 1298304 || all params: 126463104 || trainable: 1.03 %
[2024-09-19 13:33:32,475][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 13:33:34,712][root][INFO] - 

[2024-09-19 13:33:34,712][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-19 13:33:34,712][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 13:33:34,724][root][INFO] - vocab size              : 51200
[2024-09-19 13:33:34,724][root][INFO] - device                  : gpu
[2024-09-19 13:33:34,724][root][INFO] - random seed             : 42
[2024-09-19 13:33:34,725][root][INFO] - train data size         : 544
[2024-09-19 13:33:34,725][root][INFO] - max epochs              : 15
[2024-09-19 13:33:34,725][root][INFO] - total steps             : 1033
[2024-09-19 13:33:34,725][root][INFO] - warmup steps            : 103
[2024-09-19 13:33:34,725][root][INFO] - batch size              : 64
[2024-09-19 13:33:34,725][root][INFO] - accumulation steps      : 8
[2024-09-19 13:33:34,725][root][INFO] - optimizer               : adamwscale
[2024-09-19 13:33:34,725][root][INFO] - lr_scheduler            : cosine
[2024-09-19 13:33:34,725][root][INFO] - learning rate           : 0.02
[2024-09-19 13:33:34,725][root][INFO] - max length              : 128

[2024-09-19 13:33:34,725][root][INFO] - LoRA Configuration
[2024-09-19 13:33:34,726][root][INFO] - ㄴ r                    : 16
[2024-09-19 13:33:34,726][root][INFO] - ㄴ alpha                : 64
[2024-09-19 13:33:34,726][root][INFO] - ㄴ dropout              : 0.03

[2024-09-19 13:33:34,726][root][INFO] - KOMBO Configuration
[2024-09-19 13:33:34,726][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-19 13:33:34,726][root][INFO] - ㄴ reducer              : linear
[2024-09-19 13:33:34,726][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-19 13:33:34,726][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-19 13:33:34,726][root][INFO] - ㄴ do_combination       : False
[2024-09-19 13:33:34,727][root][INFO] - 

[2024-09-19 13:33:34,727][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs
[2024-09-19 13:33:34,727][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs/ckpt
[2024-09-19 13:33:34,727][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs/tb
[2024-09-19 13:33:34,727][root][INFO] - * tb interval           : 15

[2024-09-19 13:33:34,727][root][INFO] - 

[2024-09-19 13:33:34,727][root][INFO] - Start the Training !
[2024-09-19 13:33:34,730][root][INFO] - 
[1/ 15 Epoch]
[2024-09-19 13:33:39,377][root][INFO] - Step: 30/1033  |  Loss: 2.2442  |  Score: 20.29 [%]  |  Seq Length: 128.0
[2024-09-19 13:33:46,637][root][INFO] - Step: 15/1033  |  Loss: 3.0365  |  Score: 13.74 [%]  |  Seq Length: 128.0
[2024-09-19 13:33:47,572][root][INFO] - Step: 45/1033  |  Loss: 1.8205  |  Score: 40.67 [%]  |  Seq Length: 128.0
[2024-09-19 13:33:48,277][root][INFO] - Step: 100/9020  |  Loss: 0.6317  |  Score: 65.78 [%]  |  Seq Length: 128.0
[2024-09-19 13:33:55,730][root][INFO] - Step: 60/1033  |  Loss: 1.3726  |  Score: 57.96 [%]  |  Seq Length: 128.0
[2024-09-19 13:33:56,825][root][INFO] - Step: 30/1033  |  Loss: 2.3732  |  Score: 17.91 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:00,702][root][INFO] - Step: 68/1033  |  Loss: 1.6100  |  Score: 53.91 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:04,637][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 13:34:04,637][root][INFO] - Score: 66.62 [%]  |  Evaluation Time: 3.93 [s]
[2024-09-19 13:34:05,586][root][INFO] - Step: 45/1033  |  Loss: 1.9895  |  Score: 39.03 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:08,674][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 13:34:08,674][root][INFO] - Score: 61.42 [%]  |  Evaluation Time: 4.03 [s]
[2024-09-19 13:34:08,675][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 13:34:08,676][root][INFO] - 
[2/ 15 Epoch]
[2024-09-19 13:34:12,419][root][INFO] - Step: 75/1033  |  Loss: 1.7902  |  Score: 59.36 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:14,279][root][INFO] - Step: 60/1033  |  Loss: 1.6042  |  Score: 49.10 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:18,564][root][INFO] - Step: 200/9020  |  Loss: 0.4676  |  Score: 78.94 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:20,289][root][INFO] - Step: 68/1033  |  Loss: 1.7632  |  Score: 51.26 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:20,587][root][INFO] - Step: 90/1033  |  Loss: 1.3893  |  Score: 60.41 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:25,822][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 13:34:25,822][root][INFO] - Score: 63.84 [%]  |  Evaluation Time: 5.53 [s]
[2024-09-19 13:34:28,065][root][INFO] - Step: 105/1033  |  Loss: 1.1970  |  Score: 63.25 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:31,109][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 13:34:31,109][root][INFO] - Score: 58.93 [%]  |  Evaluation Time: 5.28 [s]
[2024-09-19 13:34:31,110][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 13:34:31,111][root][INFO] - 
[2/ 15 Epoch]
[2024-09-19 13:34:35,482][root][INFO] - Step: 75/1033  |  Loss: 1.6489  |  Score: 48.35 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:36,403][root][INFO] - Step: 120/1033  |  Loss: 1.2150  |  Score: 63.51 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:44,713][root][INFO] - Step: 135/1033  |  Loss: 1.3111  |  Score: 55.91 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:45,461][root][INFO] - Step: 90/1033  |  Loss: 1.4478  |  Score: 52.00 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:46,325][root][INFO] - Step: 137/1033  |  Loss: 1.0421  |  Score: 63.16 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:50,252][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 13:34:50,252][root][INFO] - Score: 68.95 [%]  |  Evaluation Time: 3.92 [s]
[2024-09-19 13:34:51,107][root][INFO] - Step: 300/9020  |  Loss: 0.4199  |  Score: 81.50 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:54,113][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 13:34:54,113][root][INFO] - Score: 64.12 [%]  |  Evaluation Time: 3.86 [s]
[2024-09-19 13:34:54,114][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 13:34:54,116][root][INFO] - 
[3/ 15 Epoch]
[2024-09-19 13:34:55,848][root][INFO] - Step: 105/1033  |  Loss: 1.2806  |  Score: 63.42 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:01,268][root][INFO] - Step: 150/1033  |  Loss: 1.1158  |  Score: 68.69 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:06,283][root][INFO] - Step: 120/1033  |  Loss: 1.3832  |  Score: 56.50 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:10,074][root][INFO] - Step: 165/1033  |  Loss: 1.0546  |  Score: 63.01 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:16,609][root][INFO] - Step: 135/1033  |  Loss: 1.4762  |  Score: 55.99 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:18,311][root][INFO] - Step: 180/1033  |  Loss: 1.0355  |  Score: 67.48 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:18,524][root][INFO] - Step: 137/1033  |  Loss: 1.3340  |  Score: 66.67 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:22,058][root][INFO] - Step: 400/9020  |  Loss: 0.3903  |  Score: 82.89 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:23,948][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 13:35:23,948][root][INFO] - Score: 69.70 [%]  |  Evaluation Time: 5.42 [s]
[2024-09-19 13:35:26,697][root][INFO] - Step: 195/1033  |  Loss: 0.9870  |  Score: 66.59 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:29,111][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 13:35:29,111][root][INFO] - Score: 64.43 [%]  |  Evaluation Time: 5.16 [s]
[2024-09-19 13:35:29,112][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 13:35:29,113][root][INFO] - 
[3/ 15 Epoch]
[2024-09-19 13:35:33,386][root][INFO] - Step: 206/1033  |  Loss: 1.0521  |  Score: 65.29 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:37,397][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 13:35:37,398][root][INFO] - Score: 69.94 [%]  |  Evaluation Time: 4.01 [s]
[2024-09-19 13:35:37,804][root][INFO] - Step: 150/1033  |  Loss: 1.2217  |  Score: 62.47 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:41,202][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 13:35:41,202][root][INFO] - Score: 67.54 [%]  |  Evaluation Time: 3.80 [s]
[2024-09-19 13:35:41,203][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-19 13:35:41,204][root][INFO] - 
[4/ 15 Epoch]
[2024-09-19 13:35:43,351][root][INFO] - Step: 210/1033  |  Loss: 1.0454  |  Score: 70.80 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:48,001][root][INFO] - Step: 165/1033  |  Loss: 1.7544  |  Score: 45.41 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:51,757][root][INFO] - Step: 225/1033  |  Loss: 0.8365  |  Score: 71.34 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:53,048][root][INFO] - Step: 500/9020  |  Loss: 0.3776  |  Score: 83.41 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:58,406][root][INFO] - Step: 180/1033  |  Loss: 1.7745  |  Score: 44.84 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:59,697][root][INFO] - Step: 240/1033  |  Loss: 0.9283  |  Score: 70.68 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:07,346][root][INFO] - Step: 195/1033  |  Loss: 1.5625  |  Score: 52.40 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:07,836][root][INFO] - Step: 255/1033  |  Loss: 0.8809  |  Score: 70.23 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:15,026][root][INFO] - Step: 206/1033  |  Loss: 1.2410  |  Score: 56.59 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:16,098][root][INFO] - Step: 270/1033  |  Loss: 0.9333  |  Score: 69.07 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:19,161][root][INFO] - Step: 275/1033  |  Loss: 0.7357  |  Score: 76.38 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:20,568][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 13:36:20,568][root][INFO] - Score: 63.29 [%]  |  Evaluation Time: 5.54 [s]
[2024-09-19 13:36:23,239][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 13:36:23,240][root][INFO] - Score: 75.17 [%]  |  Evaluation Time: 4.07 [s]
[2024-09-19 13:36:23,841][root][INFO] - Step: 600/9020  |  Loss: 0.3683  |  Score: 83.34 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:25,830][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 13:36:25,830][root][INFO] - Score: 60.36 [%]  |  Evaluation Time: 5.26 [s]
[2024-09-19 13:36:25,832][root][INFO] - 
[4/ 15 Epoch]
[2024-09-19 13:36:27,028][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 13:36:27,029][root][INFO] - Score: 65.60 [%]  |  Evaluation Time: 3.79 [s]
[2024-09-19 13:36:27,030][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-19 13:36:27,031][root][INFO] - 
[5/ 15 Epoch]
[2024-09-19 13:36:28,415][root][INFO] - Step: 210/1033  |  Loss: 1.4502  |  Score: 58.85 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:32,389][root][INFO] - Step: 285/1033  |  Loss: 0.6935  |  Score: 75.53 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:38,576][root][INFO] - Step: 225/1033  |  Loss: 1.2243  |  Score: 59.42 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:39,828][root][INFO] - Step: 300/1033  |  Loss: 0.7788  |  Score: 73.49 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:48,610][root][INFO] - Step: 240/1033  |  Loss: 1.3819  |  Score: 58.58 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:48,743][root][INFO] - Step: 315/1033  |  Loss: 0.7126  |  Score: 77.50 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:55,262][root][INFO] - Step: 700/9020  |  Loss: 0.3668  |  Score: 83.66 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:57,063][root][INFO] - Step: 330/1033  |  Loss: 0.8002  |  Score: 75.09 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:58,900][root][INFO] - Step: 255/1033  |  Loss: 1.3560  |  Score: 55.38 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:05,071][root][INFO] - Step: 344/1033  |  Loss: 0.7201  |  Score: 73.59 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:09,011][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 13:37:09,011][root][INFO] - Score: 69.98 [%]  |  Evaluation Time: 3.94 [s]
[2024-09-19 13:37:09,230][root][INFO] - Step: 270/1033  |  Loss: 1.2105  |  Score: 60.87 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:12,814][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 13:37:12,814][root][INFO] - Score: 64.62 [%]  |  Evaluation Time: 3.80 [s]
[2024-09-19 13:37:12,819][root][INFO] - 
[6/ 15 Epoch]
[2024-09-19 13:37:12,879][root][INFO] - Step: 275/1033  |  Loss: 1.4420  |  Score: 52.95 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:13,453][root][INFO] - Step: 345/1033  |  Loss: 0.4812  |  Score: 75.95 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:18,462][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 13:37:18,462][root][INFO] - Score: 46.62 [%]  |  Evaluation Time: 5.58 [s]
[2024-09-19 13:37:22,210][root][INFO] - Step: 360/1033  |  Loss: 0.6074  |  Score: 78.42 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:23,691][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 13:37:23,691][root][INFO] - Score: 47.25 [%]  |  Evaluation Time: 5.23 [s]
[2024-09-19 13:37:23,693][root][INFO] - 
[5/ 15 Epoch]
[2024-09-19 13:37:26,433][root][INFO] - Step: 800/9020  |  Loss: 0.3470  |  Score: 85.14 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:30,361][root][INFO] - Step: 285/1033  |  Loss: 1.4337  |  Score: 53.20 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:30,477][root][INFO] - Step: 375/1033  |  Loss: 0.6458  |  Score: 81.51 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:38,624][root][INFO] - Step: 390/1033  |  Loss: 0.6032  |  Score: 77.40 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:40,543][root][INFO] - Step: 300/1033  |  Loss: 1.1816  |  Score: 62.42 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:46,969][root][INFO] - Step: 405/1033  |  Loss: 0.6265  |  Score: 75.16 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:50,680][root][INFO] - Step: 315/1033  |  Loss: 1.1357  |  Score: 65.05 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:51,442][root][INFO] - Step: 413/1033  |  Loss: 0.6393  |  Score: 74.58 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:55,320][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-19 13:37:55,320][root][INFO] - Score: 72.11 [%]  |  Evaluation Time: 3.88 [s]
[2024-09-19 13:37:56,999][root][INFO] - Step: 900/9020  |  Loss: 0.3431  |  Score: 84.98 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:59,143][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-19 13:37:59,143][root][INFO] - Score: 66.17 [%]  |  Evaluation Time: 3.82 [s]
[2024-09-19 13:37:59,145][root][INFO] - 
[7/ 15 Epoch]
[2024-09-19 13:38:01,098][root][INFO] - Step: 330/1033  |  Loss: 1.0440  |  Score: 63.74 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:02,987][root][INFO] - Step: 420/1033  |  Loss: 0.5809  |  Score: 80.15 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:10,763][root][INFO] - Step: 435/1033  |  Loss: 0.4817  |  Score: 80.45 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:10,889][root][INFO] - Step: 344/1033  |  Loss: 1.0669  |  Score: 67.22 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:16,472][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 13:38:16,472][root][INFO] - Score: 67.25 [%]  |  Evaluation Time: 5.58 [s]
[2024-09-19 13:38:19,044][root][INFO] - Step: 450/1033  |  Loss: 0.5513  |  Score: 80.68 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:21,861][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 13:38:21,861][root][INFO] - Score: 62.26 [%]  |  Evaluation Time: 5.39 [s]
[2024-09-19 13:38:21,862][root][INFO] - 
[6/ 15 Epoch]
[2024-09-19 13:38:22,509][root][INFO] - Step: 345/1033  |  Loss: 1.2624  |  Score: 69.19 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:27,342][root][INFO] - Step: 465/1033  |  Loss: 0.5740  |  Score: 79.65 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:27,848][root][INFO] - Step: 1000/9020  |  Loss: 0.3661  |  Score: 83.73 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:32,682][root][INFO] - Step: 360/1033  |  Loss: 0.9799  |  Score: 67.69 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:35,662][root][INFO] - Step: 480/1033  |  Loss: 0.5163  |  Score: 80.52 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:36,949][root][INFO] - Step: 482/1033  |  Loss: 0.5080  |  Score: 79.83 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:41,666][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-19 13:38:41,666][root][INFO] - Score: 71.49 [%]  |  Evaluation Time: 4.71 [s]
[2024-09-19 13:38:42,709][root][INFO] - Step: 375/1033  |  Loss: 1.0848  |  Score: 63.27 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:46,171][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-19 13:38:46,171][root][INFO] - Score: 63.55 [%]  |  Evaluation Time: 4.50 [s]
[2024-09-19 13:38:46,173][root][INFO] - 
[8/ 15 Epoch]
[2024-09-19 13:38:53,073][root][INFO] - Step: 390/1033  |  Loss: 0.9357  |  Score: 67.30 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:54,174][root][INFO] - Step: 495/1033  |  Loss: 0.4448  |  Score: 81.94 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:58,424][root][INFO] - Step: 1100/9020  |  Loss: 0.3277  |  Score: 85.78 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:02,521][root][INFO] - Step: 510/1033  |  Loss: 0.4516  |  Score: 83.49 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:03,083][root][INFO] - Step: 405/1033  |  Loss: 0.9601  |  Score: 66.05 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:08,607][root][INFO] - Step: 413/1033  |  Loss: 0.8160  |  Score: 70.15 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:10,534][root][INFO] - Step: 525/1033  |  Loss: 0.4675  |  Score: 82.27 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:14,152][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-19 13:39:14,152][root][INFO] - Score: 66.54 [%]  |  Evaluation Time: 5.54 [s]
[2024-09-19 13:39:18,504][root][INFO] - Step: 540/1033  |  Loss: 0.4436  |  Score: 79.97 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:19,590][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-19 13:39:19,590][root][INFO] - Score: 62.67 [%]  |  Evaluation Time: 5.44 [s]
[2024-09-19 13:39:19,592][root][INFO] - 
[7/ 15 Epoch]
[2024-09-19 13:39:24,391][root][INFO] - Step: 420/1033  |  Loss: 0.8734  |  Score: 66.97 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:24,552][root][INFO] - Step: 551/1033  |  Loss: 0.5128  |  Score: 82.64 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:28,454][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-19 13:39:28,454][root][INFO] - Score: 73.02 [%]  |  Evaluation Time: 3.90 [s]
[2024-09-19 13:39:30,111][root][INFO] - Step: 1200/9020  |  Loss: 0.3298  |  Score: 85.64 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:32,618][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-19 13:39:32,618][root][INFO] - Score: 63.36 [%]  |  Evaluation Time: 4.16 [s]
[2024-09-19 13:39:32,623][root][INFO] - 
[9/ 15 Epoch]
[2024-09-19 13:39:34,692][root][INFO] - Step: 435/1033  |  Loss: 0.8400  |  Score: 70.95 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:34,828][root][INFO] - Step: 555/1033  |  Loss: 0.4223  |  Score: 82.47 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:43,186][root][INFO] - Step: 570/1033  |  Loss: 0.4005  |  Score: 84.64 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:45,014][root][INFO] - Step: 450/1033  |  Loss: 0.9450  |  Score: 69.84 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:51,637][root][INFO] - Step: 585/1033  |  Loss: 0.3854  |  Score: 83.54 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:55,312][root][INFO] - Step: 465/1033  |  Loss: 0.8001  |  Score: 68.85 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:59,891][root][INFO] - Step: 600/1033  |  Loss: 0.4226  |  Score: 85.64 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:00,001][root][INFO] - Step: 1300/9020  |  Loss: 0.3276  |  Score: 85.83 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:04,369][root][INFO] - Step: 480/1033  |  Loss: 0.8307  |  Score: 74.63 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:05,476][root][INFO] - Step: 482/1033  |  Loss: 0.9642  |  Score: 67.66 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:08,068][root][INFO] - Step: 615/1033  |  Loss: 0.3579  |  Score: 84.83 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:10,821][root][INFO] - Step: 619/1033  |  Loss: 0.4489  |  Score: 79.47 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:10,970][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-19 13:40:10,970][root][INFO] - Score: 69.54 [%]  |  Evaluation Time: 5.49 [s]
[2024-09-19 13:40:14,802][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-19 13:40:14,802][root][INFO] - Score: 72.11 [%]  |  Evaluation Time: 3.98 [s]
[2024-09-19 13:40:16,222][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-19 13:40:16,222][root][INFO] - Score: 66.40 [%]  |  Evaluation Time: 5.25 [s]
[2024-09-19 13:40:16,223][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-19 13:40:16,224][root][INFO] - 
[8/ 15 Epoch]
[2024-09-19 13:40:18,571][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-19 13:40:18,572][root][INFO] - Score: 64.57 [%]  |  Evaluation Time: 3.77 [s]
[2024-09-19 13:40:18,574][root][INFO] - 
[10/ 15 Epoch]
[2024-09-19 13:40:24,611][root][INFO] - Step: 630/1033  |  Loss: 0.3376  |  Score: 86.57 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:25,228][root][INFO] - Step: 495/1033  |  Loss: 0.6719  |  Score: 76.99 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:31,595][root][INFO] - Step: 1400/9020  |  Loss: 0.3436  |  Score: 84.98 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:32,752][root][INFO] - Step: 645/1033  |  Loss: 0.3390  |  Score: 85.43 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:35,576][root][INFO] - Step: 510/1033  |  Loss: 0.7648  |  Score: 75.31 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:40,572][root][INFO] - Step: 660/1033  |  Loss: 0.3667  |  Score: 85.64 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:45,967][root][INFO] - Step: 525/1033  |  Loss: 0.7659  |  Score: 72.94 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:48,477][root][INFO] - Step: 675/1033  |  Loss: 0.3292  |  Score: 85.38 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:55,394][root][INFO] - Step: 540/1033  |  Loss: 0.6774  |  Score: 74.97 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:55,721][root][INFO] - Step: 688/1033  |  Loss: 0.3538  |  Score: 87.38 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:59,671][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-19 13:40:59,671][root][INFO] - Score: 70.93 [%]  |  Evaluation Time: 3.95 [s]
[2024-09-19 13:41:02,761][root][INFO] - Step: 551/1033  |  Loss: 0.7113  |  Score: 76.49 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:03,002][root][INFO] - Step: 1500/9020  |  Loss: 0.3253  |  Score: 86.22 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:03,513][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-19 13:41:03,513][root][INFO] - Score: 63.83 [%]  |  Evaluation Time: 3.84 [s]
[2024-09-19 13:41:03,515][root][INFO] - 
[11/ 15 Epoch]
[2024-09-19 13:41:04,490][root][INFO] - Step: 690/1033  |  Loss: 0.2664  |  Score: 90.36 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:08,229][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-19 13:41:08,229][root][INFO] - Score: 71.40 [%]  |  Evaluation Time: 5.47 [s]
[2024-09-19 13:41:13,128][root][INFO] - Step: 705/1033  |  Loss: 0.3079  |  Score: 88.01 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:13,362][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-19 13:41:13,363][root][INFO] - Score: 65.99 [%]  |  Evaluation Time: 5.13 [s]
[2024-09-19 13:41:13,363][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-19 13:41:13,364][root][INFO] - 
[9/ 15 Epoch]
[2024-09-19 13:41:16,241][root][INFO] - Step: 555/1033  |  Loss: 0.6276  |  Score: 79.70 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:22,204][root][INFO] - Step: 720/1033  |  Loss: 0.3197  |  Score: 86.99 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:26,326][root][INFO] - Step: 570/1033  |  Loss: 0.5551  |  Score: 80.44 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:30,537][root][INFO] - Step: 735/1033  |  Loss: 0.2936  |  Score: 88.03 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:33,738][root][INFO] - Step: 1600/9020  |  Loss: 0.3334  |  Score: 85.67 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:36,297][root][INFO] - Step: 585/1033  |  Loss: 0.6163  |  Score: 76.77 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:38,767][root][INFO] - Step: 750/1033  |  Loss: 0.3296  |  Score: 85.04 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:43,003][root][INFO] - Step: 757/1033  |  Loss: 0.3123  |  Score: 87.43 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:46,509][root][INFO] - Step: 600/1033  |  Loss: 0.5483  |  Score: 79.96 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:46,933][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-19 13:41:46,933][root][INFO] - Score: 74.22 [%]  |  Evaluation Time: 3.93 [s]
[2024-09-19 13:41:50,708][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-19 13:41:50,708][root][INFO] - Score: 65.26 [%]  |  Evaluation Time: 3.77 [s]
[2024-09-19 13:41:50,710][root][INFO] - 
[12/ 15 Epoch]
[2024-09-19 13:41:54,975][root][INFO] - Step: 765/1033  |  Loss: 0.2261  |  Score: 89.85 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:56,811][root][INFO] - Step: 615/1033  |  Loss: 0.6251  |  Score: 77.94 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:00,214][root][INFO] - Step: 619/1033  |  Loss: 0.5890  |  Score: 77.90 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:03,369][root][INFO] - Step: 780/1033  |  Loss: 0.2979  |  Score: 88.31 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:05,724][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-19 13:42:05,725][root][INFO] - Score: 72.81 [%]  |  Evaluation Time: 5.51 [s]
[2024-09-19 13:42:06,153][root][INFO] - Step: 1700/9020  |  Loss: 0.3191  |  Score: 86.44 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:10,889][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-19 13:42:10,889][root][INFO] - Score: 64.20 [%]  |  Evaluation Time: 5.16 [s]
[2024-09-19 13:42:10,891][root][INFO] - 
[10/ 15 Epoch]
[2024-09-19 13:42:11,587][root][INFO] - Step: 795/1033  |  Loss: 0.3002  |  Score: 87.72 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:17,809][root][INFO] - Step: 630/1033  |  Loss: 0.4728  |  Score: 81.36 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:19,820][root][INFO] - Step: 810/1033  |  Loss: 0.2773  |  Score: 88.23 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:27,979][root][INFO] - Step: 645/1033  |  Loss: 0.5224  |  Score: 81.29 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:28,040][root][INFO] - Step: 825/1033  |  Loss: 0.2826  |  Score: 87.16 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:28,935][root][INFO] - Step: 826/1033  |  Loss: 0.3296  |  Score: 82.23 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:32,882][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-19 13:42:32,882][root][INFO] - Score: 70.63 [%]  |  Evaluation Time: 3.94 [s]
[2024-09-19 13:42:36,665][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-19 13:42:36,665][root][INFO] - Score: 66.84 [%]  |  Evaluation Time: 3.78 [s]
[2024-09-19 13:42:36,667][root][INFO] - 
[13/ 15 Epoch]
[2024-09-19 13:42:37,177][root][INFO] - Step: 1800/9020  |  Loss: 0.3262  |  Score: 85.67 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:37,956][root][INFO] - Step: 660/1033  |  Loss: 0.5082  |  Score: 82.90 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:38,593][root][INFO] - Step: 1804/9020  |  Loss: 0.2828  |  Score: 90.23 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:44,345][root][INFO] - Step: 840/1033  |  Loss: 0.2625  |  Score: 89.38 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:48,097][root][INFO] - Step: 675/1033  |  Loss: 0.4812  |  Score: 82.21 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:52,100][root][INFO] - Step: 855/1033  |  Loss: 0.2592  |  Score: 89.08 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:56,552][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 13:42:56,552][root][INFO] - Score: 86.67 [%]  |  Evaluation Time: 17.96 [s]
[2024-09-19 13:42:57,063][root][INFO] - Step: 688/1033  |  Loss: 0.4515  |  Score: 84.02 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:01,060][root][INFO] - Step: 870/1033  |  Loss: 0.2567  |  Score: 88.81 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:02,526][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-19 13:43:02,526][root][INFO] - Score: 75.26 [%]  |  Evaluation Time: 5.46 [s]
[2024-09-19 13:43:07,775][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-19 13:43:07,775][root][INFO] - Score: 65.63 [%]  |  Evaluation Time: 5.25 [s]
[2024-09-19 13:43:07,776][root][INFO] - 
Save new Best Score (Epoch: 10)
[2024-09-19 13:43:07,777][root][INFO] - 
[11/ 15 Epoch]
[2024-09-19 13:43:08,862][root][INFO] - Step: 690/1033  |  Loss: 0.4456  |  Score: 70.76 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:09,821][root][INFO] - Step: 885/1033  |  Loss: 0.2386  |  Score: 88.42 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:14,408][root][INFO] - Step: 895/1033  |  Loss: 0.2420  |  Score: 88.80 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:18,386][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-19 13:43:18,386][root][INFO] - Score: 73.05 [%]  |  Evaluation Time: 3.97 [s]
[2024-09-19 13:43:18,500][root][INFO] - Step: 705/1033  |  Loss: 0.3898  |  Score: 85.26 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:22,205][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-19 13:43:22,205][root][INFO] - Score: 65.06 [%]  |  Evaluation Time: 3.82 [s]
[2024-09-19 13:43:22,207][root][INFO] - 
[14/ 15 Epoch]
[2024-09-19 13:43:25,123][root][INFO] - Step: 900/1033  |  Loss: 0.2395  |  Score: 88.73 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:27,464][root][INFO] - Step: 720/1033  |  Loss: 0.4247  |  Score: 81.91 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:33,896][root][INFO] - Step: 915/1033  |  Loss: 0.2554  |  Score: 87.42 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:37,177][root][INFO] - Step: 735/1033  |  Loss: 0.4018  |  Score: 84.73 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:42,445][root][INFO] - Step: 930/1033  |  Loss: 0.2448  |  Score: 88.99 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:46,457][root][INFO] - Step: 750/1033  |  Loss: 0.4605  |  Score: 82.13 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:50,700][root][INFO] - Step: 945/1033  |  Loss: 0.2509  |  Score: 89.15 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:51,479][root][INFO] - Step: 757/1033  |  Loss: 0.3966  |  Score: 84.51 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:56,934][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-19 13:43:56,935][root][INFO] - Score: 74.17 [%]  |  Evaluation Time: 5.45 [s]
[2024-09-19 13:43:57,791][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 13:43:57,792][root][INFO] - Score: 86.83 [%]  |  Evaluation Time: 61.24 [s]
[2024-09-19 13:43:57,793][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 13:43:57,796][root][INFO] - 
[2/ 5 Epoch]
[2024-09-19 13:43:59,077][root][INFO] - Step: 960/1033  |  Loss: 0.2457  |  Score: 88.21 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:01,522][root][INFO] - Step: 964/1033  |  Loss: 0.2188  |  Score: 92.50 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:02,125][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-19 13:44:02,125][root][INFO] - Score: 67.15 [%]  |  Evaluation Time: 5.19 [s]
[2024-09-19 13:44:02,126][root][INFO] - 
Save new Best Score (Epoch: 11)
[2024-09-19 13:44:02,127][root][INFO] - 
[12/ 15 Epoch]
[2024-09-19 13:44:05,746][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-19 13:44:05,746][root][INFO] - Score: 74.33 [%]  |  Evaluation Time: 4.22 [s]
[2024-09-19 13:44:07,351][root][INFO] - Step: 765/1033  |  Loss: 0.3354  |  Score: 86.57 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:09,569][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-19 13:44:09,569][root][INFO] - Score: 63.45 [%]  |  Evaluation Time: 3.82 [s]
[2024-09-19 13:44:09,571][root][INFO] - 
[15/ 15 Epoch]
[2024-09-19 13:44:15,719][root][INFO] - Step: 975/1033  |  Loss: 0.2363  |  Score: 88.32 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:17,307][root][INFO] - Step: 780/1033  |  Loss: 0.3925  |  Score: 84.63 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:24,174][root][INFO] - Step: 990/1033  |  Loss: 0.2597  |  Score: 87.83 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:27,198][root][INFO] - Step: 795/1033  |  Loss: 0.3679  |  Score: 85.43 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:27,708][root][INFO] - Step: 1900/9020  |  Loss: 0.3012  |  Score: 86.83 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:32,483][root][INFO] - Step: 1005/1033  |  Loss: 0.2360  |  Score: 89.56 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:36,128][root][INFO] - Step: 810/1033  |  Loss: 0.3660  |  Score: 85.25 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:41,424][root][INFO] - Step: 1020/1033  |  Loss: 0.2343  |  Score: 87.63 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:45,348][root][INFO] - Step: 825/1033  |  Loss: 0.3662  |  Score: 85.70 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:46,364][root][INFO] - Step: 826/1033  |  Loss: 0.3183  |  Score: 84.69 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:48,593][root][INFO] - Step: 1033/1033  |  Loss: 0.2289  |  Score: 88.99 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:51,781][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-19 13:44:51,782][root][INFO] - Score: 72.68 [%]  |  Evaluation Time: 5.41 [s]
[2024-09-19 13:44:53,045][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-19 13:44:53,046][root][INFO] - Score: 75.11 [%]  |  Evaluation Time: 4.45 [s]
[2024-09-19 13:44:56,843][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-19 13:44:56,843][root][INFO] - Score: 67.48 [%]  |  Evaluation Time: 3.80 [s]
[2024-09-19 13:44:56,844][root][INFO] - 
Save new Best Score (Epoch: 15)
[2024-09-19 13:44:56,844][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 13:44:56,844][root][INFO] - - Epoch: 15
[2024-09-19 13:44:56,844][root][INFO] - - DEV score: 75.11 [%]
[2024-09-19 13:44:56,844][root][INFO] - - TEST score: 67.48 [%]
[2024-09-19 13:44:56,845][root][INFO] - Fine-tuning is done!
[2024-09-19 13:44:56,909][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-19 13:44:56,909][root][INFO] - Score: 63.66 [%]  |  Evaluation Time: 5.13 [s]
[2024-09-19 13:44:56,911][root][INFO] - 
[13/ 15 Epoch]
[2024-09-19 13:44:59,373][root][INFO] - Step: 2000/9020  |  Loss: 0.2901  |  Score: 87.95 [%]  |  Seq Length: 128.0
[2024-09-19 13:45:05,999][root][INFO] - Step: 840/1033  |  Loss: 0.3296  |  Score: 86.14 [%]  |  Seq Length: 128.0
[2024-09-19 13:45:15,738][root][INFO] - Step: 855/1033  |  Loss: 0.3233  |  Score: 84.86 [%]  |  Seq Length: 128.0
[2024-09-19 13:45:25,614][root][INFO] - Step: 870/1033  |  Loss: 0.3203  |  Score: 85.41 [%]  |  Seq Length: 128.0
[2024-09-19 13:45:29,783][root][INFO] - Step: 2100/9020  |  Loss: 0.2896  |  Score: 87.58 [%]  |  Seq Length: 128.0
[2024-09-19 13:45:35,526][root][INFO] - Step: 885/1033  |  Loss: 0.3301  |  Score: 86.89 [%]  |  Seq Length: 128.0
[2024-09-19 13:45:42,398][root][INFO] - Step: 895/1033  |  Loss: 0.3365  |  Score: 88.47 [%]  |  Seq Length: 128.0
[2024-09-19 13:45:47,780][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-19 13:45:47,780][root][INFO] - Score: 74.16 [%]  |  Evaluation Time: 5.38 [s]
[2024-09-19 13:45:53,182][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-19 13:45:53,182][root][INFO] - Score: 66.58 [%]  |  Evaluation Time: 5.40 [s]
[2024-09-19 13:45:53,184][root][INFO] - 
[14/ 15 Epoch]
[2024-09-19 13:45:56,452][root][INFO] - Step: 900/1033  |  Loss: 0.2744  |  Score: 88.11 [%]  |  Seq Length: 128.0
[2024-09-19 13:46:00,038][root][INFO] - Step: 2200/9020  |  Loss: 0.2956  |  Score: 87.67 [%]  |  Seq Length: 128.0
[2024-09-19 13:46:06,217][root][INFO] - Step: 915/1033  |  Loss: 0.3110  |  Score: 85.71 [%]  |  Seq Length: 128.0
[2024-09-19 13:46:14,330][root][INFO] - Step: 930/1033  |  Loss: 0.3049  |  Score: 86.66 [%]  |  Seq Length: 128.0
[2024-09-19 13:46:22,582][root][INFO] - Step: 945/1033  |  Loss: 0.2845  |  Score: 86.48 [%]  |  Seq Length: 128.0
[2024-09-19 13:46:28,932][root][INFO] - Step: 2300/9020  |  Loss: 0.2987  |  Score: 87.36 [%]  |  Seq Length: 128.0
[2024-09-19 13:46:32,362][root][INFO] - Step: 960/1033  |  Loss: 0.3399  |  Score: 86.10 [%]  |  Seq Length: 128.0
[2024-09-19 13:46:35,242][root][INFO] - Step: 964/1033  |  Loss: 0.2986  |  Score: 85.60 [%]  |  Seq Length: 128.0
[2024-09-19 13:46:40,684][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-19 13:46:40,684][root][INFO] - Score: 71.97 [%]  |  Evaluation Time: 5.44 [s]
[2024-09-19 13:46:45,775][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-19 13:46:45,775][root][INFO] - Score: 64.37 [%]  |  Evaluation Time: 5.09 [s]
[2024-09-19 13:46:45,777][root][INFO] - 
[15/ 15 Epoch]
[2024-09-19 13:46:53,072][root][INFO] - Step: 975/1033  |  Loss: 0.3162  |  Score: 86.75 [%]  |  Seq Length: 128.0
[2024-09-19 13:46:56,977][root][INFO] - Step: 2400/9020  |  Loss: 0.2891  |  Score: 87.86 [%]  |  Seq Length: 128.0
[2024-09-19 13:47:02,719][root][INFO] - Step: 990/1033  |  Loss: 0.3047  |  Score: 87.13 [%]  |  Seq Length: 128.0
[2024-09-19 13:47:12,349][root][INFO] - Step: 1005/1033  |  Loss: 0.3052  |  Score: 86.88 [%]  |  Seq Length: 128.0
[2024-09-19 13:47:22,101][root][INFO] - Step: 1020/1033  |  Loss: 0.3064  |  Score: 88.08 [%]  |  Seq Length: 128.0
[2024-09-19 13:47:29,179][root][INFO] - Step: 2500/9020  |  Loss: 0.2887  |  Score: 87.92 [%]  |  Seq Length: 128.0
[2024-09-19 13:47:30,750][root][INFO] - Step: 1033/1033  |  Loss: 0.2921  |  Score: 87.27 [%]  |  Seq Length: 128.0
[2024-09-19 13:47:36,154][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-19 13:47:36,154][root][INFO] - Score: 72.76 [%]  |  Evaluation Time: 5.40 [s]
[2024-09-19 13:47:41,291][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-19 13:47:41,291][root][INFO] - Score: 64.42 [%]  |  Evaluation Time: 5.14 [s]
[2024-09-19 13:47:41,292][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 13:47:41,292][root][INFO] - - Epoch: 11
[2024-09-19 13:47:41,293][root][INFO] - - DEV score: 74.17 [%]
[2024-09-19 13:47:41,293][root][INFO] - - TEST score: 67.15 [%]
[2024-09-19 13:47:41,293][root][INFO] - Fine-tuning is done!
[2024-09-19 13:47:59,930][root][INFO] - Step: 2600/9020  |  Loss: 0.2797  |  Score: 87.94 [%]  |  Seq Length: 128.0
[2024-09-19 13:48:30,619][root][INFO] - Step: 2700/9020  |  Loss: 0.2974  |  Score: 87.45 [%]  |  Seq Length: 128.0
[2024-09-19 13:49:02,064][root][INFO] - Step: 2800/9020  |  Loss: 0.2770  |  Score: 88.44 [%]  |  Seq Length: 128.0
[2024-09-19 13:49:32,414][root][INFO] - Step: 2900/9020  |  Loss: 0.2778  |  Score: 88.27 [%]  |  Seq Length: 128.0
[2024-09-19 13:50:03,745][root][INFO] - Step: 3000/9020  |  Loss: 0.2967  |  Score: 87.47 [%]  |  Seq Length: 128.0
[2024-09-19 13:50:34,056][root][INFO] - Step: 3100/9020  |  Loss: 0.2886  |  Score: 87.67 [%]  |  Seq Length: 128.0
[2024-09-19 13:51:04,994][root][INFO] - Step: 3200/9020  |  Loss: 0.2820  |  Score: 88.28 [%]  |  Seq Length: 128.0
[2024-09-19 13:51:35,583][root][INFO] - Step: 3300/9020  |  Loss: 0.2805  |  Score: 88.69 [%]  |  Seq Length: 128.0
[2024-09-19 13:52:07,095][root][INFO] - Step: 3400/9020  |  Loss: 0.2813  |  Score: 87.95 [%]  |  Seq Length: 128.0
[2024-09-19 13:52:37,768][root][INFO] - Step: 3500/9020  |  Loss: 0.2836  |  Score: 88.09 [%]  |  Seq Length: 128.0
[2024-09-19 13:53:08,532][root][INFO] - Step: 3600/9020  |  Loss: 0.2859  |  Score: 88.14 [%]  |  Seq Length: 128.0
[2024-09-19 13:53:11,033][root][INFO] - Step: 3608/9020  |  Loss: 0.2597  |  Score: 89.02 [%]  |  Seq Length: 128.0
[2024-09-19 13:53:31,016][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 13:53:31,017][root][INFO] - Score: 87.72 [%]  |  Evaluation Time: 19.98 [s]
[2024-09-19 13:54:28,970][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 13:54:28,970][root][INFO] - Score: 88.06 [%]  |  Evaluation Time: 57.95 [s]
[2024-09-19 13:54:28,971][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 13:54:28,972][root][INFO] - 
[3/ 5 Epoch]
[2024-09-19 13:54:57,492][root][INFO] - Step: 3700/9020  |  Loss: 0.2447  |  Score: 90.20 [%]  |  Seq Length: 128.0
[2024-09-19 13:55:28,465][root][INFO] - Step: 3800/9020  |  Loss: 0.2567  |  Score: 89.62 [%]  |  Seq Length: 128.0
[2024-09-19 13:55:58,337][root][INFO] - Step: 3900/9020  |  Loss: 0.2481  |  Score: 89.94 [%]  |  Seq Length: 128.0
[2024-09-19 13:56:29,268][root][INFO] - Step: 4000/9020  |  Loss: 0.2460  |  Score: 89.88 [%]  |  Seq Length: 128.0
[2024-09-19 13:56:59,109][root][INFO] - Step: 4100/9020  |  Loss: 0.2480  |  Score: 89.89 [%]  |  Seq Length: 128.0
[2024-09-19 13:57:29,350][root][INFO] - Step: 4200/9020  |  Loss: 0.2596  |  Score: 88.75 [%]  |  Seq Length: 128.0
[2024-09-19 13:58:00,717][root][INFO] - Step: 4300/9020  |  Loss: 0.2663  |  Score: 88.48 [%]  |  Seq Length: 128.0
[2024-09-19 13:58:31,128][root][INFO] - Step: 4400/9020  |  Loss: 0.2517  |  Score: 89.59 [%]  |  Seq Length: 128.0
[2024-09-19 13:59:01,797][root][INFO] - Step: 4500/9020  |  Loss: 0.2544  |  Score: 89.88 [%]  |  Seq Length: 128.0
[2024-09-19 13:59:32,327][root][INFO] - Step: 4600/9020  |  Loss: 0.2468  |  Score: 90.03 [%]  |  Seq Length: 128.0
[2024-09-19 14:00:03,658][root][INFO] - Step: 4700/9020  |  Loss: 0.2590  |  Score: 89.28 [%]  |  Seq Length: 128.0
[2024-09-19 14:00:34,556][root][INFO] - Step: 4800/9020  |  Loss: 0.2580  |  Score: 89.48 [%]  |  Seq Length: 128.0
[2024-09-19 14:01:03,247][root][INFO] - Step: 4900/9020  |  Loss: 0.2411  |  Score: 90.03 [%]  |  Seq Length: 128.0
[2024-09-19 14:01:33,863][root][INFO] - Step: 5000/9020  |  Loss: 0.2653  |  Score: 88.92 [%]  |  Seq Length: 128.0
[2024-09-19 14:02:05,394][root][INFO] - Step: 5100/9020  |  Loss: 0.2559  |  Score: 89.48 [%]  |  Seq Length: 128.0
[2024-09-19 14:02:36,447][root][INFO] - Step: 5200/9020  |  Loss: 0.2485  |  Score: 89.94 [%]  |  Seq Length: 128.0
[2024-09-19 14:03:05,625][root][INFO] - Step: 5300/9020  |  Loss: 0.2561  |  Score: 89.36 [%]  |  Seq Length: 128.0
[2024-09-19 14:03:35,156][root][INFO] - Step: 5400/9020  |  Loss: 0.2492  |  Score: 89.86 [%]  |  Seq Length: 128.0
[2024-09-19 14:03:38,633][root][INFO] - Step: 5412/9020  |  Loss: 0.2856  |  Score: 87.97 [%]  |  Seq Length: 128.0
[2024-09-19 14:03:56,292][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 14:03:56,292][root][INFO] - Score: 88.05 [%]  |  Evaluation Time: 17.66 [s]
[2024-09-19 14:04:56,573][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 14:04:56,574][root][INFO] - Score: 88.37 [%]  |  Evaluation Time: 60.28 [s]
[2024-09-19 14:04:56,575][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-19 14:04:56,576][root][INFO] - 
[4/ 5 Epoch]
[2024-09-19 14:05:23,469][root][INFO] - Step: 5500/9020  |  Loss: 0.2222  |  Score: 91.12 [%]  |  Seq Length: 128.0
[2024-09-19 14:05:53,515][root][INFO] - Step: 5600/9020  |  Loss: 0.2308  |  Score: 90.67 [%]  |  Seq Length: 128.0
[2024-09-19 14:06:24,583][root][INFO] - Step: 5700/9020  |  Loss: 0.2326  |  Score: 90.53 [%]  |  Seq Length: 128.0
[2024-09-19 14:06:54,719][root][INFO] - Step: 5800/9020  |  Loss: 0.2272  |  Score: 90.78 [%]  |  Seq Length: 128.0
[2024-09-19 14:07:25,764][root][INFO] - Step: 5900/9020  |  Loss: 0.2440  |  Score: 90.38 [%]  |  Seq Length: 128.0
[2024-09-19 14:07:57,469][root][INFO] - Step: 6000/9020  |  Loss: 0.2431  |  Score: 89.95 [%]  |  Seq Length: 128.0
[2024-09-19 14:08:27,024][root][INFO] - Step: 6100/9020  |  Loss: 0.2438  |  Score: 89.98 [%]  |  Seq Length: 128.0
[2024-09-19 14:08:57,493][root][INFO] - Step: 6200/9020  |  Loss: 0.2224  |  Score: 90.83 [%]  |  Seq Length: 128.0
[2024-09-19 14:09:28,077][root][INFO] - Step: 6300/9020  |  Loss: 0.2247  |  Score: 91.14 [%]  |  Seq Length: 128.0
[2024-09-19 14:09:58,184][root][INFO] - Step: 6400/9020  |  Loss: 0.2212  |  Score: 91.03 [%]  |  Seq Length: 128.0
[2024-09-19 14:10:28,586][root][INFO] - Step: 6500/9020  |  Loss: 0.2282  |  Score: 90.47 [%]  |  Seq Length: 128.0
[2024-09-19 14:10:58,873][root][INFO] - Step: 6600/9020  |  Loss: 0.2256  |  Score: 91.02 [%]  |  Seq Length: 128.0
[2024-09-19 14:11:30,922][root][INFO] - Step: 6700/9020  |  Loss: 0.2270  |  Score: 90.98 [%]  |  Seq Length: 128.0
[2024-09-19 14:12:01,079][root][INFO] - Step: 6800/9020  |  Loss: 0.2251  |  Score: 90.94 [%]  |  Seq Length: 128.0
[2024-09-19 14:12:30,844][root][INFO] - Step: 6900/9020  |  Loss: 0.2347  |  Score: 90.30 [%]  |  Seq Length: 128.0
[2024-09-19 14:13:01,572][root][INFO] - Step: 7000/9020  |  Loss: 0.2213  |  Score: 91.41 [%]  |  Seq Length: 128.0
[2024-09-19 14:13:31,566][root][INFO] - Step: 7100/9020  |  Loss: 0.2170  |  Score: 90.72 [%]  |  Seq Length: 128.0
[2024-09-19 14:14:02,840][root][INFO] - Step: 7200/9020  |  Loss: 0.2313  |  Score: 90.69 [%]  |  Seq Length: 128.0
[2024-09-19 14:14:07,705][root][INFO] - Step: 7216/9020  |  Loss: 0.2020  |  Score: 92.38 [%]  |  Seq Length: 128.0
[2024-09-19 14:14:25,218][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 14:14:25,218][root][INFO] - Score: 88.28 [%]  |  Evaluation Time: 17.51 [s]
[2024-09-19 14:15:24,807][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 14:15:24,807][root][INFO] - Score: 88.61 [%]  |  Evaluation Time: 59.59 [s]
[2024-09-19 14:15:24,808][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-19 14:15:24,809][root][INFO] - 
[5/ 5 Epoch]
[2024-09-19 14:15:50,175][root][INFO] - Step: 7300/9020  |  Loss: 0.2193  |  Score: 91.28 [%]  |  Seq Length: 128.0
[2024-09-19 14:16:19,791][root][INFO] - Step: 7400/9020  |  Loss: 0.2182  |  Score: 91.48 [%]  |  Seq Length: 128.0
[2024-09-19 14:16:50,684][root][INFO] - Step: 7500/9020  |  Loss: 0.2112  |  Score: 91.45 [%]  |  Seq Length: 128.0
[2024-09-19 14:17:21,320][root][INFO] - Step: 7600/9020  |  Loss: 0.2114  |  Score: 91.95 [%]  |  Seq Length: 128.0
[2024-09-19 14:17:53,739][root][INFO] - Step: 7700/9020  |  Loss: 0.2104  |  Score: 91.42 [%]  |  Seq Length: 128.0
[2024-09-19 14:18:24,071][root][INFO] - Step: 7800/9020  |  Loss: 0.2047  |  Score: 91.50 [%]  |  Seq Length: 128.0
[2024-09-19 14:18:54,521][root][INFO] - Step: 7900/9020  |  Loss: 0.2125  |  Score: 91.62 [%]  |  Seq Length: 128.0
[2024-09-19 14:19:25,238][root][INFO] - Step: 8000/9020  |  Loss: 0.2238  |  Score: 91.08 [%]  |  Seq Length: 128.0
[2024-09-19 14:19:55,607][root][INFO] - Step: 8100/9020  |  Loss: 0.2072  |  Score: 91.83 [%]  |  Seq Length: 128.0
[2024-09-19 14:20:26,186][root][INFO] - Step: 8200/9020  |  Loss: 0.2148  |  Score: 91.69 [%]  |  Seq Length: 128.0
[2024-09-19 14:20:57,088][root][INFO] - Step: 8300/9020  |  Loss: 0.2175  |  Score: 90.94 [%]  |  Seq Length: 128.0
[2024-09-19 14:21:27,444][root][INFO] - Step: 8400/9020  |  Loss: 0.2148  |  Score: 91.36 [%]  |  Seq Length: 128.0
[2024-09-19 14:21:57,463][root][INFO] - Step: 8500/9020  |  Loss: 0.2007  |  Score: 91.73 [%]  |  Seq Length: 128.0
[2024-09-19 14:22:27,392][root][INFO] - Step: 8600/9020  |  Loss: 0.1995  |  Score: 92.20 [%]  |  Seq Length: 128.0
[2024-09-19 14:22:56,932][root][INFO] - Step: 8700/9020  |  Loss: 0.2175  |  Score: 91.30 [%]  |  Seq Length: 128.0
[2024-09-19 14:23:28,211][root][INFO] - Step: 8800/9020  |  Loss: 0.2235  |  Score: 90.94 [%]  |  Seq Length: 128.0
[2024-09-19 14:23:59,300][root][INFO] - Step: 8900/9020  |  Loss: 0.2210  |  Score: 91.09 [%]  |  Seq Length: 128.0
[2024-09-19 14:24:29,663][root][INFO] - Step: 9000/9020  |  Loss: 0.2248  |  Score: 91.12 [%]  |  Seq Length: 128.0
[2024-09-19 14:24:35,673][root][INFO] - Step: 9020/9020  |  Loss: 0.2408  |  Score: 90.22 [%]  |  Seq Length: 128.0
[2024-09-19 14:24:53,342][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 14:24:53,342][root][INFO] - Score: 88.33 [%]  |  Evaluation Time: 17.67 [s]
[2024-09-19 14:25:51,213][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 14:25:51,214][root][INFO] - Score: 88.60 [%]  |  Evaluation Time: 57.87 [s]
[2024-09-19 14:25:51,215][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-19 14:25:51,215][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 14:25:51,215][root][INFO] - - Epoch: 5
[2024-09-19 14:25:51,215][root][INFO] - - DEV score: 88.33 [%]
[2024-09-19 14:25:51,215][root][INFO] - - TEST score: 88.60 [%]
[2024-09-19 14:25:51,216][root][INFO] - Fine-tuning is done!
[2024-09-19 16:42:14,472][root][INFO] - 

[2024-09-19 16:42:14,472][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 16:42:14,472][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs
[2024-09-19 16:42:14,472][root][INFO] - 

[2024-09-19 16:42:14,472][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 16:42:33,966][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-19 16:42:33,966][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-19 16:42:33,967][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-19 16:42:33,967][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-19 16:42:33,968][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-19 16:42:33,968][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-19 16:42:33,969][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-19 16:42:33,969][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-19 16:42:33,970][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-19 16:42:33,970][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-19 16:42:33,971][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-19 16:42:33,971][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-19 16:42:33,972][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-19 16:42:33,972][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-19 16:42:33,972][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-19 16:42:33,973][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-19 16:42:33,973][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-19 16:42:33,974][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-19 16:42:33,974][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-19 16:42:33,975][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-19 16:42:33,975][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-19 16:42:33,976][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-19 16:42:33,976][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-19 16:42:33,976][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-19 16:42:33,978][root][INFO] - Trainable params: 1769472 || all params: 126935040 || trainable: 1.39 %
[2024-09-19 16:42:34,163][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 16:42:36,040][root][INFO] - 

[2024-09-19 16:42:36,040][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-19 16:42:36,040][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 16:42:36,048][root][INFO] - vocab size              : 51200
[2024-09-19 16:42:36,048][root][INFO] - device                  : gpu
[2024-09-19 16:42:36,049][root][INFO] - random seed             : 42
[2024-09-19 16:42:36,049][root][INFO] - train data size         : 115456
[2024-09-19 16:42:36,049][root][INFO] - max epochs              : 5
[2024-09-19 16:42:36,049][root][INFO] - total steps             : 9020
[2024-09-19 16:42:36,049][root][INFO] - warmup steps            : 902
[2024-09-19 16:42:36,049][root][INFO] - batch size              : 64
[2024-09-19 16:42:36,049][root][INFO] - accumulation steps      : 1
[2024-09-19 16:42:36,049][root][INFO] - optimizer               : adamwscale
[2024-09-19 16:42:36,049][root][INFO] - lr_scheduler            : cosine
[2024-09-19 16:42:36,049][root][INFO] - learning rate           : 0.02
[2024-09-19 16:42:36,050][root][INFO] - max length              : 256

[2024-09-19 16:42:36,050][root][INFO] - LoRA Configuration
[2024-09-19 16:42:36,050][root][INFO] - ㄴ r                    : 32
[2024-09-19 16:42:36,050][root][INFO] - ㄴ alpha                : 128
[2024-09-19 16:42:36,050][root][INFO] - ㄴ dropout              : 0.03

[2024-09-19 16:42:36,050][root][INFO] - 

[2024-09-19 16:42:36,050][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs
[2024-09-19 16:42:36,050][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs/ckpt
[2024-09-19 16:42:36,050][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs/tb
[2024-09-19 16:42:36,051][root][INFO] - * tb interval           : 100

[2024-09-19 16:42:36,051][root][INFO] - 

[2024-09-19 16:42:36,051][root][INFO] - Start the Training !
[2024-09-19 16:42:36,054][root][INFO] - 
[1/ 5 Epoch]
[2024-09-19 16:43:13,897][root][INFO] - Step: 100/9020  |  Loss: 0.5514  |  Score: 71.67 [%]  |  Seq Length: 256.0
[2024-09-19 16:43:50,353][root][INFO] - Step: 200/9020  |  Loss: 0.4262  |  Score: 80.92 [%]  |  Seq Length: 256.0
[2024-09-19 16:44:26,920][root][INFO] - Step: 300/9020  |  Loss: 0.4085  |  Score: 82.20 [%]  |  Seq Length: 256.0
[2024-09-19 16:44:37,409][root][INFO] - 

[2024-09-19 16:44:37,410][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 16:44:37,410][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs
[2024-09-19 16:44:37,410][root][INFO] - 

[2024-09-19 16:44:37,410][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 16:44:56,720][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-19 16:44:56,721][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-19 16:44:56,721][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-19 16:44:56,722][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-19 16:44:56,722][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-19 16:44:56,723][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-19 16:44:56,723][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-19 16:44:56,724][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-19 16:44:56,724][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-19 16:44:56,724][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-19 16:44:56,725][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-19 16:44:56,725][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-19 16:44:56,726][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-19 16:44:56,726][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-19 16:44:56,727][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-19 16:44:56,727][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-19 16:44:56,727][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-19 16:44:56,728][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-19 16:44:56,728][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-19 16:44:56,729][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-19 16:44:56,729][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-19 16:44:56,730][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-19 16:44:56,730][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-19 16:44:56,731][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-19 16:44:56,732][root][INFO] - Trainable params: 1769472 || all params: 126935040 || trainable: 1.39 %
[2024-09-19 16:44:56,736][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-19 16:44:56,840][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-19 16:44:56,842][root][INFO] - Trainable params: 8985600 || all params: 134151168 || trainable: 6.70 %
[2024-09-19 16:44:57,030][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 16:45:00,134][root][INFO] - 

[2024-09-19 16:45:00,134][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-19 16:45:00,135][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 16:45:00,142][root][INFO] - vocab size              : 51200
[2024-09-19 16:45:00,142][root][INFO] - device                  : gpu
[2024-09-19 16:45:00,142][root][INFO] - random seed             : 42
[2024-09-19 16:45:00,142][root][INFO] - train data size         : 115456
[2024-09-19 16:45:00,142][root][INFO] - max epochs              : 5
[2024-09-19 16:45:00,142][root][INFO] - total steps             : 9020
[2024-09-19 16:45:00,143][root][INFO] - warmup steps            : 902
[2024-09-19 16:45:00,143][root][INFO] - batch size              : 64
[2024-09-19 16:45:00,143][root][INFO] - accumulation steps      : 1
[2024-09-19 16:45:00,143][root][INFO] - optimizer               : adamwscale
[2024-09-19 16:45:00,143][root][INFO] - lr_scheduler            : cosine
[2024-09-19 16:45:00,143][root][INFO] - learning rate           : 0.02
[2024-09-19 16:45:00,143][root][INFO] - max length              : 256

[2024-09-19 16:45:00,143][root][INFO] - LoRA Configuration
[2024-09-19 16:45:00,143][root][INFO] - ㄴ r                    : 32
[2024-09-19 16:45:00,143][root][INFO] - ㄴ alpha                : 128
[2024-09-19 16:45:00,143][root][INFO] - ㄴ dropout              : 0.03

[2024-09-19 16:45:00,143][root][INFO] - KOMBO Configuration
[2024-09-19 16:45:00,144][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-19 16:45:00,144][root][INFO] - ㄴ reducer              : linear
[2024-09-19 16:45:00,144][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-19 16:45:00,144][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-19 16:45:00,144][root][INFO] - ㄴ do_combination       : True
[2024-09-19 16:45:00,144][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-19 16:45:00,144][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-19 16:45:00,144][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-19 16:45:00,144][root][INFO] -   ㄴ add_lora           : False
[2024-09-19 16:45:00,145][root][INFO] - 

[2024-09-19 16:45:00,145][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs
[2024-09-19 16:45:00,145][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs/ckpt
[2024-09-19 16:45:00,145][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs/tb
[2024-09-19 16:45:00,145][root][INFO] - * tb interval           : 100

[2024-09-19 16:45:00,145][root][INFO] - 

[2024-09-19 16:45:00,145][root][INFO] - Start the Training !
[2024-09-19 16:45:00,148][root][INFO] - 
[1/ 5 Epoch]
[2024-09-19 16:45:03,530][root][INFO] - Step: 400/9020  |  Loss: 0.3744  |  Score: 83.59 [%]  |  Seq Length: 256.0
[2024-09-19 16:45:40,292][root][INFO] - Step: 500/9020  |  Loss: 0.3725  |  Score: 83.95 [%]  |  Seq Length: 256.0
[2024-09-19 16:45:50,022][root][INFO] - Step: 100/9020  |  Loss: 0.5303  |  Score: 73.59 [%]  |  Seq Length: 256.0
[2024-09-19 16:45:55,460][root][INFO] - 

[2024-09-19 16:45:55,460][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 16:45:55,461][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs
[2024-09-19 16:45:55,461][root][INFO] - 

[2024-09-19 16:45:55,461][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 16:46:15,875][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 16:46:16,978][root][INFO] - Step: 600/9020  |  Loss: 0.3585  |  Score: 83.89 [%]  |  Seq Length: 256.0
[2024-09-19 16:46:17,773][root][INFO] - 

[2024-09-19 16:46:17,774][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-19 16:46:17,774][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 16:46:17,784][root][INFO] - vocab size              : 51200
[2024-09-19 16:46:17,784][root][INFO] - device                  : gpu
[2024-09-19 16:46:17,784][root][INFO] - random seed             : 42
[2024-09-19 16:46:17,784][root][INFO] - train data size         : 115456
[2024-09-19 16:46:17,784][root][INFO] - max epochs              : 5
[2024-09-19 16:46:17,784][root][INFO] - total steps             : 9020
[2024-09-19 16:46:17,784][root][INFO] - warmup steps            : 902
[2024-09-19 16:46:17,784][root][INFO] - batch size              : 64
[2024-09-19 16:46:17,785][root][INFO] - accumulation steps      : 1
[2024-09-19 16:46:17,785][root][INFO] - optimizer               : adamwscale
[2024-09-19 16:46:17,785][root][INFO] - lr_scheduler            : cosine
[2024-09-19 16:46:17,785][root][INFO] - learning rate           : 0.02
[2024-09-19 16:46:17,785][root][INFO] - max length              : 256

[2024-09-19 16:46:17,785][root][INFO] - 

[2024-09-19 16:46:17,785][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs
[2024-09-19 16:46:17,785][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs/ckpt
[2024-09-19 16:46:17,785][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs/tb
[2024-09-19 16:46:17,786][root][INFO] - * tb interval           : 100

[2024-09-19 16:46:17,786][root][INFO] - 

[2024-09-19 16:46:17,786][root][INFO] - Start the Training !
[2024-09-19 16:46:17,789][root][INFO] - 
[1/ 5 Epoch]
[2024-09-19 16:46:39,649][root][INFO] - Step: 200/9020  |  Loss: 0.4278  |  Score: 80.78 [%]  |  Seq Length: 256.0
[2024-09-19 16:46:53,640][root][INFO] - Step: 700/9020  |  Loss: 0.3622  |  Score: 84.06 [%]  |  Seq Length: 256.0
[2024-09-19 16:47:02,978][root][INFO] - Step: 100/9020  |  Loss: 0.7323  |  Score: 69.39 [%]  |  Seq Length: 256.0
[2024-09-19 16:47:29,384][root][INFO] - Step: 300/9020  |  Loss: 0.4043  |  Score: 81.94 [%]  |  Seq Length: 256.0
[2024-09-19 16:47:30,342][root][INFO] - Step: 800/9020  |  Loss: 0.3636  |  Score: 84.11 [%]  |  Seq Length: 256.0
[2024-09-19 16:47:47,154][root][INFO] - Step: 200/9020  |  Loss: 0.4600  |  Score: 79.33 [%]  |  Seq Length: 256.0
[2024-09-19 16:48:07,046][root][INFO] - Step: 900/9020  |  Loss: 0.3322  |  Score: 86.09 [%]  |  Seq Length: 256.0
[2024-09-19 16:48:18,823][root][INFO] - Step: 400/9020  |  Loss: 0.3931  |  Score: 82.72 [%]  |  Seq Length: 256.0
[2024-09-19 16:48:31,392][root][INFO] - Step: 300/9020  |  Loss: 0.4333  |  Score: 80.20 [%]  |  Seq Length: 256.0
[2024-09-19 16:48:43,757][root][INFO] - Step: 1000/9020  |  Loss: 0.3504  |  Score: 84.41 [%]  |  Seq Length: 256.0
[2024-09-19 16:49:08,311][root][INFO] - Step: 500/9020  |  Loss: 0.3678  |  Score: 83.97 [%]  |  Seq Length: 256.0
[2024-09-19 16:49:15,625][root][INFO] - Step: 400/9020  |  Loss: 0.4111  |  Score: 81.59 [%]  |  Seq Length: 256.0
[2024-09-19 16:49:20,486][root][INFO] - Step: 1100/9020  |  Loss: 0.3357  |  Score: 85.08 [%]  |  Seq Length: 256.0
[2024-09-19 16:49:57,222][root][INFO] - Step: 1200/9020  |  Loss: 0.3434  |  Score: 85.28 [%]  |  Seq Length: 256.0
[2024-09-19 16:49:57,747][root][INFO] - Step: 600/9020  |  Loss: 0.3591  |  Score: 84.30 [%]  |  Seq Length: 256.0
[2024-09-19 16:49:59,935][root][INFO] - Step: 500/9020  |  Loss: 0.4339  |  Score: 80.98 [%]  |  Seq Length: 256.0
[2024-09-19 16:50:33,959][root][INFO] - Step: 1300/9020  |  Loss: 0.3422  |  Score: 85.14 [%]  |  Seq Length: 256.0
[2024-09-19 16:50:44,309][root][INFO] - Step: 600/9020  |  Loss: 0.4286  |  Score: 80.42 [%]  |  Seq Length: 256.0
[2024-09-19 16:50:47,466][root][INFO] - Step: 700/9020  |  Loss: 0.3695  |  Score: 83.50 [%]  |  Seq Length: 256.0
[2024-09-19 16:51:10,699][root][INFO] - Step: 1400/9020  |  Loss: 0.3434  |  Score: 84.91 [%]  |  Seq Length: 256.0
[2024-09-19 16:51:28,613][root][INFO] - Step: 700/9020  |  Loss: 0.4390  |  Score: 80.55 [%]  |  Seq Length: 256.0
[2024-09-19 16:51:37,355][root][INFO] - Step: 800/9020  |  Loss: 0.3614  |  Score: 84.27 [%]  |  Seq Length: 256.0
[2024-09-19 16:51:47,433][root][INFO] - Step: 1500/9020  |  Loss: 0.3427  |  Score: 85.36 [%]  |  Seq Length: 256.0
[2024-09-19 16:52:12,906][root][INFO] - Step: 800/9020  |  Loss: 0.4488  |  Score: 79.66 [%]  |  Seq Length: 256.0
[2024-09-19 16:52:24,210][root][INFO] - Step: 1600/9020  |  Loss: 0.3542  |  Score: 84.64 [%]  |  Seq Length: 256.0
[2024-09-19 16:52:27,035][root][INFO] - Step: 900/9020  |  Loss: 0.3622  |  Score: 83.61 [%]  |  Seq Length: 256.0
[2024-09-19 16:52:57,274][root][INFO] - Step: 900/9020  |  Loss: 0.4425  |  Score: 80.22 [%]  |  Seq Length: 256.0
[2024-09-19 16:53:00,952][root][INFO] - Step: 1700/9020  |  Loss: 0.3430  |  Score: 85.30 [%]  |  Seq Length: 256.0
[2024-09-19 16:53:15,587][root][INFO] - Step: 1000/9020  |  Loss: 0.3522  |  Score: 84.89 [%]  |  Seq Length: 256.0
[2024-09-19 16:53:37,842][root][INFO] - Step: 1800/9020  |  Loss: 0.3458  |  Score: 84.84 [%]  |  Seq Length: 256.0
[2024-09-19 16:53:39,370][root][INFO] - Step: 1804/9020  |  Loss: 0.4418  |  Score: 80.75 [%]  |  Seq Length: 256.0
[2024-09-19 16:53:41,665][root][INFO] - Step: 1000/9020  |  Loss: 0.4818  |  Score: 77.58 [%]  |  Seq Length: 256.0
[2024-09-19 16:54:05,349][root][INFO] - Step: 1100/9020  |  Loss: 0.3473  |  Score: 85.17 [%]  |  Seq Length: 256.0
[2024-09-19 16:54:08,648][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 16:54:08,648][root][INFO] - Score: 86.00 [%]  |  Evaluation Time: 29.28 [s]
[2024-09-19 16:54:26,010][root][INFO] - Step: 1100/9020  |  Loss: 0.4520  |  Score: 79.62 [%]  |  Seq Length: 256.0
[2024-09-19 16:54:54,791][root][INFO] - Step: 1200/9020  |  Loss: 0.3528  |  Score: 84.05 [%]  |  Seq Length: 256.0
[2024-09-19 16:55:10,371][root][INFO] - Step: 1200/9020  |  Loss: 0.4417  |  Score: 79.72 [%]  |  Seq Length: 256.0
[2024-09-19 16:55:44,296][root][INFO] - Step: 1300/9020  |  Loss: 0.3452  |  Score: 84.70 [%]  |  Seq Length: 256.0
[2024-09-19 16:55:44,866][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 16:55:44,866][root][INFO] - Score: 85.90 [%]  |  Evaluation Time: 96.22 [s]
[2024-09-19 16:55:44,867][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 16:55:44,868][root][INFO] - 
[2/ 5 Epoch]
[2024-09-19 16:55:54,761][root][INFO] - Step: 1300/9020  |  Loss: 0.4572  |  Score: 79.36 [%]  |  Seq Length: 256.0
[2024-09-19 16:56:20,468][root][INFO] - Step: 1900/9020  |  Loss: 0.2993  |  Score: 87.47 [%]  |  Seq Length: 256.0
[2024-09-19 16:56:33,684][root][INFO] - Step: 1400/9020  |  Loss: 0.3352  |  Score: 85.77 [%]  |  Seq Length: 256.0
[2024-09-19 16:56:39,101][root][INFO] - Step: 1400/9020  |  Loss: 0.4493  |  Score: 79.42 [%]  |  Seq Length: 256.0
[2024-09-19 16:56:57,205][root][INFO] - Step: 2000/9020  |  Loss: 0.3199  |  Score: 86.08 [%]  |  Seq Length: 256.0
[2024-09-19 16:57:23,147][root][INFO] - Step: 1500/9020  |  Loss: 0.3312  |  Score: 86.16 [%]  |  Seq Length: 256.0
[2024-09-19 16:57:23,480][root][INFO] - Step: 1500/9020  |  Loss: 0.4362  |  Score: 80.34 [%]  |  Seq Length: 256.0
[2024-09-19 16:57:33,945][root][INFO] - Step: 2100/9020  |  Loss: 0.3120  |  Score: 86.67 [%]  |  Seq Length: 256.0
[2024-09-19 16:58:07,839][root][INFO] - Step: 1600/9020  |  Loss: 0.4405  |  Score: 80.05 [%]  |  Seq Length: 256.0
[2024-09-19 16:58:10,690][root][INFO] - Step: 2200/9020  |  Loss: 0.3161  |  Score: 86.59 [%]  |  Seq Length: 256.0
[2024-09-19 16:58:12,654][root][INFO] - Step: 1600/9020  |  Loss: 0.3402  |  Score: 85.34 [%]  |  Seq Length: 256.0
[2024-09-19 16:58:47,436][root][INFO] - Step: 2300/9020  |  Loss: 0.3211  |  Score: 86.45 [%]  |  Seq Length: 256.0
[2024-09-19 16:58:52,209][root][INFO] - Step: 1700/9020  |  Loss: 0.4375  |  Score: 80.02 [%]  |  Seq Length: 256.0
[2024-09-19 16:59:02,437][root][INFO] - Step: 1700/9020  |  Loss: 0.3452  |  Score: 85.00 [%]  |  Seq Length: 256.0
[2024-09-19 16:59:24,183][root][INFO] - Step: 2400/9020  |  Loss: 0.3024  |  Score: 86.39 [%]  |  Seq Length: 256.0
[2024-09-19 16:59:36,644][root][INFO] - Step: 1800/9020  |  Loss: 0.4529  |  Score: 79.53 [%]  |  Seq Length: 256.0
[2024-09-19 16:59:38,424][root][INFO] - Step: 1804/9020  |  Loss: 0.4012  |  Score: 85.37 [%]  |  Seq Length: 256.0
[2024-09-19 16:59:51,970][root][INFO] - Step: 1800/9020  |  Loss: 0.3401  |  Score: 84.89 [%]  |  Seq Length: 256.0
[2024-09-19 16:59:53,960][root][INFO] - Step: 1804/9020  |  Loss: 0.3170  |  Score: 85.84 [%]  |  Seq Length: 256.0
[2024-09-19 17:00:00,961][root][INFO] - Step: 2500/9020  |  Loss: 0.3280  |  Score: 85.72 [%]  |  Seq Length: 256.0
[2024-09-19 17:00:07,790][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 17:00:07,790][root][INFO] - Score: 80.14 [%]  |  Evaluation Time: 29.36 [s]
[2024-09-19 17:00:37,732][root][INFO] - Step: 2600/9020  |  Loss: 0.2995  |  Score: 87.08 [%]  |  Seq Length: 256.0
[2024-09-19 17:00:38,879][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 17:00:38,879][root][INFO] - Score: 86.61 [%]  |  Evaluation Time: 44.92 [s]
[2024-09-19 17:01:14,512][root][INFO] - Step: 2700/9020  |  Loss: 0.3155  |  Score: 86.97 [%]  |  Seq Length: 256.0
[2024-09-19 17:01:44,553][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 17:01:44,553][root][INFO] - Score: 80.11 [%]  |  Evaluation Time: 96.76 [s]
[2024-09-19 17:01:44,554][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 17:01:44,555][root][INFO] - 
[2/ 5 Epoch]
[2024-09-19 17:01:51,275][root][INFO] - Step: 2800/9020  |  Loss: 0.3226  |  Score: 85.94 [%]  |  Seq Length: 256.0
[2024-09-19 17:02:27,413][root][INFO] - Step: 1900/9020  |  Loss: 0.3968  |  Score: 82.34 [%]  |  Seq Length: 256.0
[2024-09-19 17:02:28,050][root][INFO] - Step: 2900/9020  |  Loss: 0.3184  |  Score: 86.50 [%]  |  Seq Length: 256.0
[2024-09-19 17:03:04,807][root][INFO] - Step: 3000/9020  |  Loss: 0.3249  |  Score: 86.09 [%]  |  Seq Length: 256.0
[2024-09-19 17:03:08,355][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 17:03:08,355][root][INFO] - Score: 86.35 [%]  |  Evaluation Time: 149.47 [s]
[2024-09-19 17:03:08,356][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 17:03:08,358][root][INFO] - 
[2/ 5 Epoch]
[2024-09-19 17:03:11,746][root][INFO] - Step: 2000/9020  |  Loss: 0.4143  |  Score: 82.16 [%]  |  Seq Length: 256.0
[2024-09-19 17:03:41,572][root][INFO] - Step: 3100/9020  |  Loss: 0.3107  |  Score: 86.83 [%]  |  Seq Length: 256.0
[2024-09-19 17:03:55,946][root][INFO] - Step: 1900/9020  |  Loss: 0.3150  |  Score: 86.88 [%]  |  Seq Length: 256.0
[2024-09-19 17:03:56,045][root][INFO] - Step: 2100/9020  |  Loss: 0.3895  |  Score: 83.25 [%]  |  Seq Length: 256.0
[2024-09-19 17:04:18,343][root][INFO] - Step: 3200/9020  |  Loss: 0.3091  |  Score: 87.08 [%]  |  Seq Length: 256.0
[2024-09-19 17:04:39,596][root][INFO] - Step: 2200/9020  |  Loss: 0.4024  |  Score: 82.55 [%]  |  Seq Length: 256.0
[2024-09-19 17:04:45,464][root][INFO] - Step: 2000/9020  |  Loss: 0.3169  |  Score: 86.52 [%]  |  Seq Length: 256.0
[2024-09-19 17:04:55,122][root][INFO] - Step: 3300/9020  |  Loss: 0.3125  |  Score: 86.77 [%]  |  Seq Length: 256.0
[2024-09-19 17:05:23,869][root][INFO] - Step: 2300/9020  |  Loss: 0.3909  |  Score: 82.75 [%]  |  Seq Length: 256.0
[2024-09-19 17:05:31,922][root][INFO] - Step: 3400/9020  |  Loss: 0.3077  |  Score: 86.78 [%]  |  Seq Length: 256.0
[2024-09-19 17:05:35,422][root][INFO] - Step: 2100/9020  |  Loss: 0.3074  |  Score: 87.27 [%]  |  Seq Length: 256.0
[2024-09-19 17:06:08,162][root][INFO] - Step: 2400/9020  |  Loss: 0.3972  |  Score: 83.11 [%]  |  Seq Length: 256.0
[2024-09-19 17:06:08,713][root][INFO] - Step: 3500/9020  |  Loss: 0.3053  |  Score: 87.33 [%]  |  Seq Length: 256.0
[2024-09-19 17:06:24,906][root][INFO] - Step: 2200/9020  |  Loss: 0.3204  |  Score: 86.48 [%]  |  Seq Length: 256.0
[2024-09-19 17:06:45,477][root][INFO] - Step: 3600/9020  |  Loss: 0.3139  |  Score: 86.78 [%]  |  Seq Length: 256.0
[2024-09-19 17:06:48,453][root][INFO] - Step: 3608/9020  |  Loss: 0.2856  |  Score: 87.49 [%]  |  Seq Length: 256.0
[2024-09-19 17:06:52,264][root][INFO] - Step: 2500/9020  |  Loss: 0.4001  |  Score: 83.09 [%]  |  Seq Length: 256.0
[2024-09-19 17:07:14,504][root][INFO] - Step: 2300/9020  |  Loss: 0.3152  |  Score: 86.67 [%]  |  Seq Length: 256.0
[2024-09-19 17:07:17,694][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 17:07:17,695][root][INFO] - Score: 87.17 [%]  |  Evaluation Time: 29.24 [s]
[2024-09-19 17:07:35,711][root][INFO] - Step: 2600/9020  |  Loss: 0.3921  |  Score: 82.95 [%]  |  Seq Length: 256.0
[2024-09-19 17:08:04,138][root][INFO] - Step: 2400/9020  |  Loss: 0.3212  |  Score: 86.20 [%]  |  Seq Length: 256.0
[2024-09-19 17:08:19,170][root][INFO] - Step: 2700/9020  |  Loss: 0.4118  |  Score: 82.25 [%]  |  Seq Length: 256.0
[2024-09-19 17:08:53,848][root][INFO] - Step: 2500/9020  |  Loss: 0.3059  |  Score: 86.91 [%]  |  Seq Length: 256.0
[2024-09-19 17:08:54,011][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 17:08:54,011][root][INFO] - Score: 87.16 [%]  |  Evaluation Time: 96.31 [s]
[2024-09-19 17:08:54,012][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 17:08:54,014][root][INFO] - 
[3/ 5 Epoch]
[2024-09-19 17:09:02,617][root][INFO] - Step: 2800/9020  |  Loss: 0.4188  |  Score: 81.20 [%]  |  Seq Length: 256.0
[2024-09-19 17:09:28,288][root][INFO] - Step: 3700/9020  |  Loss: 0.2731  |  Score: 88.65 [%]  |  Seq Length: 256.0
[2024-09-19 17:09:42,855][root][INFO] - Step: 2600/9020  |  Loss: 0.3206  |  Score: 86.47 [%]  |  Seq Length: 256.0
[2024-09-19 17:09:46,723][root][INFO] - Step: 2900/9020  |  Loss: 0.4230  |  Score: 81.02 [%]  |  Seq Length: 256.0
[2024-09-19 17:10:05,168][root][INFO] - Step: 3800/9020  |  Loss: 0.2853  |  Score: 87.78 [%]  |  Seq Length: 256.0
[2024-09-19 17:10:30,995][root][INFO] - Step: 3000/9020  |  Loss: 0.4071  |  Score: 82.16 [%]  |  Seq Length: 256.0
[2024-09-19 17:10:32,376][root][INFO] - Step: 2700/9020  |  Loss: 0.3185  |  Score: 86.62 [%]  |  Seq Length: 256.0
[2024-09-19 17:10:42,034][root][INFO] - Step: 3900/9020  |  Loss: 0.2888  |  Score: 87.81 [%]  |  Seq Length: 256.0
[2024-09-19 17:11:14,573][root][INFO] - Step: 3100/9020  |  Loss: 0.4069  |  Score: 81.88 [%]  |  Seq Length: 256.0
[2024-09-19 17:11:18,937][root][INFO] - Step: 4000/9020  |  Loss: 0.2623  |  Score: 89.34 [%]  |  Seq Length: 256.0
[2024-09-19 17:11:21,006][root][INFO] - Step: 2800/9020  |  Loss: 0.3205  |  Score: 86.34 [%]  |  Seq Length: 256.0
[2024-09-19 17:11:55,812][root][INFO] - Step: 4100/9020  |  Loss: 0.2871  |  Score: 88.09 [%]  |  Seq Length: 256.0
[2024-09-19 17:11:58,039][root][INFO] - Step: 3200/9020  |  Loss: 0.4062  |  Score: 81.98 [%]  |  Seq Length: 256.0
[2024-09-19 17:12:10,392][root][INFO] - Step: 2900/9020  |  Loss: 0.3095  |  Score: 86.92 [%]  |  Seq Length: 256.0
[2024-09-19 17:12:32,667][root][INFO] - Step: 4200/9020  |  Loss: 0.2749  |  Score: 88.55 [%]  |  Seq Length: 256.0
[2024-09-19 17:12:41,514][root][INFO] - Step: 3300/9020  |  Loss: 0.4193  |  Score: 80.95 [%]  |  Seq Length: 256.0
[2024-09-19 17:13:00,100][root][INFO] - Step: 3000/9020  |  Loss: 0.3301  |  Score: 85.80 [%]  |  Seq Length: 256.0
[2024-09-19 17:13:09,528][root][INFO] - Step: 4300/9020  |  Loss: 0.2734  |  Score: 88.28 [%]  |  Seq Length: 256.0
[2024-09-19 17:13:25,831][root][INFO] - Step: 3400/9020  |  Loss: 0.4189  |  Score: 81.66 [%]  |  Seq Length: 256.0
[2024-09-19 17:13:46,400][root][INFO] - Step: 4400/9020  |  Loss: 0.2813  |  Score: 88.20 [%]  |  Seq Length: 256.0
[2024-09-19 17:13:49,575][root][INFO] - Step: 3100/9020  |  Loss: 0.3074  |  Score: 86.94 [%]  |  Seq Length: 256.0
[2024-09-19 17:14:10,118][root][INFO] - Step: 3500/9020  |  Loss: 0.4265  |  Score: 81.05 [%]  |  Seq Length: 256.0
[2024-09-19 17:14:23,298][root][INFO] - Step: 4500/9020  |  Loss: 0.2755  |  Score: 88.41 [%]  |  Seq Length: 256.0
[2024-09-19 17:14:39,383][root][INFO] - Step: 3200/9020  |  Loss: 0.3026  |  Score: 87.28 [%]  |  Seq Length: 256.0
[2024-09-19 17:14:54,458][root][INFO] - Step: 3600/9020  |  Loss: 0.4295  |  Score: 81.00 [%]  |  Seq Length: 256.0
[2024-09-19 17:14:58,003][root][INFO] - Step: 3608/9020  |  Loss: 0.4211  |  Score: 80.38 [%]  |  Seq Length: 256.0
[2024-09-19 17:15:00,162][root][INFO] - Step: 4600/9020  |  Loss: 0.2759  |  Score: 88.16 [%]  |  Seq Length: 256.0
[2024-09-19 17:15:27,358][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 17:15:27,359][root][INFO] - Score: 79.61 [%]  |  Evaluation Time: 29.35 [s]
[2024-09-19 17:15:28,925][root][INFO] - Step: 3300/9020  |  Loss: 0.3022  |  Score: 87.11 [%]  |  Seq Length: 256.0
[2024-09-19 17:15:37,123][root][INFO] - Step: 4700/9020  |  Loss: 0.2674  |  Score: 88.50 [%]  |  Seq Length: 256.0
[2024-09-19 17:16:14,031][root][INFO] - Step: 4800/9020  |  Loss: 0.2799  |  Score: 88.34 [%]  |  Seq Length: 256.0
[2024-09-19 17:16:18,473][root][INFO] - Step: 3400/9020  |  Loss: 0.3160  |  Score: 86.84 [%]  |  Seq Length: 256.0
[2024-09-19 17:16:51,035][root][INFO] - Step: 4900/9020  |  Loss: 0.2853  |  Score: 87.73 [%]  |  Seq Length: 256.0
[2024-09-19 17:17:04,157][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 17:17:04,158][root][INFO] - Score: 79.61 [%]  |  Evaluation Time: 96.80 [s]
[2024-09-19 17:17:04,160][root][INFO] - 
[3/ 5 Epoch]
[2024-09-19 17:17:08,288][root][INFO] - Step: 3500/9020  |  Loss: 0.3046  |  Score: 87.41 [%]  |  Seq Length: 256.0
[2024-09-19 17:17:28,062][root][INFO] - Step: 5000/9020  |  Loss: 0.2760  |  Score: 88.47 [%]  |  Seq Length: 256.0
[2024-09-19 17:17:45,301][root][INFO] - Step: 3700/9020  |  Loss: 0.4132  |  Score: 81.88 [%]  |  Seq Length: 256.0
[2024-09-19 17:17:58,122][root][INFO] - Step: 3600/9020  |  Loss: 0.2979  |  Score: 87.39 [%]  |  Seq Length: 256.0
[2024-09-19 17:18:02,108][root][INFO] - Step: 3608/9020  |  Loss: 0.2787  |  Score: 89.06 [%]  |  Seq Length: 256.0
[2024-09-19 17:18:05,083][root][INFO] - Step: 5100/9020  |  Loss: 0.2946  |  Score: 87.23 [%]  |  Seq Length: 256.0
[2024-09-19 17:18:29,627][root][INFO] - Step: 3800/9020  |  Loss: 0.4103  |  Score: 82.11 [%]  |  Seq Length: 256.0
[2024-09-19 17:18:41,954][root][INFO] - Step: 5200/9020  |  Loss: 0.2747  |  Score: 88.38 [%]  |  Seq Length: 256.0
[2024-09-19 17:18:47,117][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 17:18:47,118][root][INFO] - Score: 86.64 [%]  |  Evaluation Time: 45.01 [s]
[2024-09-19 17:19:13,938][root][INFO] - Step: 3900/9020  |  Loss: 0.4039  |  Score: 82.58 [%]  |  Seq Length: 256.0
[2024-09-19 17:19:18,832][root][INFO] - Step: 5300/9020  |  Loss: 0.2643  |  Score: 88.91 [%]  |  Seq Length: 256.0
[2024-09-19 17:19:55,713][root][INFO] - Step: 5400/9020  |  Loss: 0.2665  |  Score: 89.09 [%]  |  Seq Length: 256.0
[2024-09-19 17:19:58,199][root][INFO] - Step: 4000/9020  |  Loss: 0.4097  |  Score: 81.75 [%]  |  Seq Length: 256.0
[2024-09-19 17:20:00,167][root][INFO] - Step: 5412/9020  |  Loss: 0.2256  |  Score: 90.72 [%]  |  Seq Length: 256.0
[2024-09-19 17:20:29,341][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 17:20:29,341][root][INFO] - Score: 87.96 [%]  |  Evaluation Time: 29.17 [s]
[2024-09-19 17:20:42,487][root][INFO] - Step: 4100/9020  |  Loss: 0.3943  |  Score: 83.00 [%]  |  Seq Length: 256.0
[2024-09-19 17:21:15,508][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 17:21:15,508][root][INFO] - Score: 86.87 [%]  |  Evaluation Time: 148.39 [s]
[2024-09-19 17:21:15,510][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 17:21:15,511][root][INFO] - 
[3/ 5 Epoch]
[2024-09-19 17:21:26,755][root][INFO] - Step: 4200/9020  |  Loss: 0.4064  |  Score: 81.67 [%]  |  Seq Length: 256.0
[2024-09-19 17:22:01,562][root][INFO] - Step: 3700/9020  |  Loss: 0.2825  |  Score: 88.01 [%]  |  Seq Length: 256.0
[2024-09-19 17:22:05,540][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 17:22:05,540][root][INFO] - Score: 87.89 [%]  |  Evaluation Time: 96.20 [s]
[2024-09-19 17:22:05,541][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-19 17:22:05,543][root][INFO] - 
[4/ 5 Epoch]
[2024-09-19 17:22:11,076][root][INFO] - Step: 4300/9020  |  Loss: 0.4158  |  Score: 81.38 [%]  |  Seq Length: 256.0
[2024-09-19 17:22:38,409][root][INFO] - Step: 5500/9020  |  Loss: 0.2320  |  Score: 90.71 [%]  |  Seq Length: 256.0
[2024-09-19 17:22:51,289][root][INFO] - Step: 3800/9020  |  Loss: 0.2903  |  Score: 87.30 [%]  |  Seq Length: 256.0
[2024-09-19 17:22:55,390][root][INFO] - Step: 4400/9020  |  Loss: 0.4023  |  Score: 82.38 [%]  |  Seq Length: 256.0
[2024-09-19 17:23:15,301][root][INFO] - Step: 5600/9020  |  Loss: 0.2472  |  Score: 89.91 [%]  |  Seq Length: 256.0
[2024-09-19 17:23:39,705][root][INFO] - Step: 4500/9020  |  Loss: 0.4176  |  Score: 81.77 [%]  |  Seq Length: 256.0
[2024-09-19 17:23:41,075][root][INFO] - Step: 3900/9020  |  Loss: 0.2848  |  Score: 87.91 [%]  |  Seq Length: 256.0
[2024-09-19 17:23:52,184][root][INFO] - Step: 5700/9020  |  Loss: 0.2287  |  Score: 90.53 [%]  |  Seq Length: 256.0
[2024-09-19 17:24:24,031][root][INFO] - Step: 4600/9020  |  Loss: 0.4267  |  Score: 80.67 [%]  |  Seq Length: 256.0
[2024-09-19 17:24:29,093][root][INFO] - Step: 5800/9020  |  Loss: 0.2424  |  Score: 90.12 [%]  |  Seq Length: 256.0
[2024-09-19 17:24:30,725][root][INFO] - Step: 4000/9020  |  Loss: 0.2703  |  Score: 89.28 [%]  |  Seq Length: 256.0
[2024-09-19 17:25:06,293][root][INFO] - Step: 5900/9020  |  Loss: 0.2239  |  Score: 90.56 [%]  |  Seq Length: 256.0
[2024-09-19 17:25:08,339][root][INFO] - Step: 4700/9020  |  Loss: 0.4293  |  Score: 80.77 [%]  |  Seq Length: 256.0
[2024-09-19 17:25:20,360][root][INFO] - Step: 4100/9020  |  Loss: 0.2851  |  Score: 88.05 [%]  |  Seq Length: 256.0
[2024-09-19 17:25:43,196][root][INFO] - Step: 6000/9020  |  Loss: 0.2317  |  Score: 90.64 [%]  |  Seq Length: 256.0
[2024-09-19 17:25:52,638][root][INFO] - Step: 4800/9020  |  Loss: 0.4278  |  Score: 81.05 [%]  |  Seq Length: 256.0
[2024-09-19 17:26:10,026][root][INFO] - Step: 4200/9020  |  Loss: 0.2806  |  Score: 88.31 [%]  |  Seq Length: 256.0
[2024-09-19 17:26:20,099][root][INFO] - Step: 6100/9020  |  Loss: 0.2369  |  Score: 90.28 [%]  |  Seq Length: 256.0
[2024-09-19 17:26:36,950][root][INFO] - Step: 4900/9020  |  Loss: 0.4241  |  Score: 81.41 [%]  |  Seq Length: 256.0
[2024-09-19 17:26:57,004][root][INFO] - Step: 6200/9020  |  Loss: 0.2328  |  Score: 90.42 [%]  |  Seq Length: 256.0
[2024-09-19 17:26:59,571][root][INFO] - Step: 4300/9020  |  Loss: 0.2806  |  Score: 88.23 [%]  |  Seq Length: 256.0
[2024-09-19 17:27:21,277][root][INFO] - Step: 5000/9020  |  Loss: 0.4304  |  Score: 80.69 [%]  |  Seq Length: 256.0
[2024-09-19 17:27:34,078][root][INFO] - Step: 6300/9020  |  Loss: 0.2322  |  Score: 90.69 [%]  |  Seq Length: 256.0
[2024-09-19 17:27:49,461][root][INFO] - Step: 4400/9020  |  Loss: 0.2841  |  Score: 87.56 [%]  |  Seq Length: 256.0
[2024-09-19 17:28:05,586][root][INFO] - Step: 5100/9020  |  Loss: 0.4262  |  Score: 80.83 [%]  |  Seq Length: 256.0
[2024-09-19 17:28:10,983][root][INFO] - Step: 6400/9020  |  Loss: 0.2319  |  Score: 90.47 [%]  |  Seq Length: 256.0
[2024-09-19 17:28:39,337][root][INFO] - Step: 4500/9020  |  Loss: 0.2807  |  Score: 88.25 [%]  |  Seq Length: 256.0
[2024-09-19 17:28:48,014][root][INFO] - Step: 6500/9020  |  Loss: 0.2399  |  Score: 90.39 [%]  |  Seq Length: 256.0
[2024-09-19 17:28:49,333][root][INFO] - Step: 5200/9020  |  Loss: 0.4329  |  Score: 80.94 [%]  |  Seq Length: 256.0
[2024-09-19 17:29:24,922][root][INFO] - Step: 6600/9020  |  Loss: 0.2174  |  Score: 90.59 [%]  |  Seq Length: 256.0
[2024-09-19 17:29:28,666][root][INFO] - Step: 4600/9020  |  Loss: 0.2704  |  Score: 88.47 [%]  |  Seq Length: 256.0
[2024-09-19 17:29:32,796][root][INFO] - Step: 5300/9020  |  Loss: 0.4305  |  Score: 80.69 [%]  |  Seq Length: 256.0
[2024-09-19 17:30:01,909][root][INFO] - Step: 6700/9020  |  Loss: 0.2158  |  Score: 91.70 [%]  |  Seq Length: 256.0
[2024-09-19 17:30:16,251][root][INFO] - Step: 5400/9020  |  Loss: 0.4398  |  Score: 80.38 [%]  |  Seq Length: 256.0
[2024-09-19 17:30:18,399][root][INFO] - Step: 4700/9020  |  Loss: 0.2783  |  Score: 88.23 [%]  |  Seq Length: 256.0
[2024-09-19 17:30:21,500][root][INFO] - Step: 5412/9020  |  Loss: 0.4498  |  Score: 78.79 [%]  |  Seq Length: 256.0
[2024-09-19 17:30:38,807][root][INFO] - Step: 6800/9020  |  Loss: 0.2275  |  Score: 91.09 [%]  |  Seq Length: 256.0
[2024-09-19 17:30:50,944][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 17:30:50,945][root][INFO] - Score: 78.66 [%]  |  Evaluation Time: 29.44 [s]
[2024-09-19 17:31:08,164][root][INFO] - Step: 4800/9020  |  Loss: 0.2729  |  Score: 88.84 [%]  |  Seq Length: 256.0
[2024-09-19 17:31:15,693][root][INFO] - Step: 6900/9020  |  Loss: 0.2406  |  Score: 90.02 [%]  |  Seq Length: 256.0
[2024-09-19 17:31:52,592][root][INFO] - Step: 7000/9020  |  Loss: 0.2169  |  Score: 91.22 [%]  |  Seq Length: 256.0
[2024-09-19 17:31:57,732][root][INFO] - Step: 4900/9020  |  Loss: 0.2847  |  Score: 88.36 [%]  |  Seq Length: 256.0
[2024-09-19 17:32:27,989][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 17:32:27,990][root][INFO] - Score: 78.20 [%]  |  Evaluation Time: 97.04 [s]
[2024-09-19 17:32:27,992][root][INFO] - 
[4/ 5 Epoch]
[2024-09-19 17:32:29,481][root][INFO] - Step: 7100/9020  |  Loss: 0.2257  |  Score: 91.06 [%]  |  Seq Length: 256.0
[2024-09-19 17:32:47,490][root][INFO] - Step: 5000/9020  |  Loss: 0.2665  |  Score: 89.00 [%]  |  Seq Length: 256.0
[2024-09-19 17:33:06,363][root][INFO] - Step: 7200/9020  |  Loss: 0.2257  |  Score: 90.78 [%]  |  Seq Length: 256.0
[2024-09-19 17:33:07,347][root][INFO] - Step: 5500/9020  |  Loss: 0.4168  |  Score: 81.92 [%]  |  Seq Length: 256.0
[2024-09-19 17:33:12,288][root][INFO] - Step: 7216/9020  |  Loss: 0.2287  |  Score: 92.09 [%]  |  Seq Length: 256.0
[2024-09-19 17:33:37,048][root][INFO] - Step: 5100/9020  |  Loss: 0.2659  |  Score: 88.73 [%]  |  Seq Length: 256.0
[2024-09-19 17:33:41,525][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 17:33:41,526][root][INFO] - Score: 88.61 [%]  |  Evaluation Time: 29.23 [s]
[2024-09-19 17:33:51,697][root][INFO] - Step: 5600/9020  |  Loss: 0.4135  |  Score: 81.97 [%]  |  Seq Length: 256.0
[2024-09-19 17:34:26,631][root][INFO] - Step: 5200/9020  |  Loss: 0.2758  |  Score: 88.06 [%]  |  Seq Length: 256.0
[2024-09-19 17:34:36,022][root][INFO] - Step: 5700/9020  |  Loss: 0.4209  |  Score: 81.58 [%]  |  Seq Length: 256.0
[2024-09-19 17:35:16,183][root][INFO] - Step: 5300/9020  |  Loss: 0.2761  |  Score: 88.45 [%]  |  Seq Length: 256.0
[2024-09-19 17:35:17,726][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 17:35:17,726][root][INFO] - Score: 88.66 [%]  |  Evaluation Time: 96.20 [s]
[2024-09-19 17:35:17,727][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-19 17:35:17,728][root][INFO] - 
[5/ 5 Epoch]
[2024-09-19 17:35:20,418][root][INFO] - Step: 5800/9020  |  Loss: 0.4320  |  Score: 80.92 [%]  |  Seq Length: 256.0
[2024-09-19 17:35:49,094][root][INFO] - Step: 7300/9020  |  Loss: 0.2032  |  Score: 92.04 [%]  |  Seq Length: 256.0
[2024-09-19 17:36:04,767][root][INFO] - Step: 5900/9020  |  Loss: 0.4225  |  Score: 81.34 [%]  |  Seq Length: 256.0
[2024-09-19 17:36:05,834][root][INFO] - Step: 5400/9020  |  Loss: 0.2704  |  Score: 88.59 [%]  |  Seq Length: 256.0
[2024-09-19 17:36:11,791][root][INFO] - Step: 5412/9020  |  Loss: 0.2529  |  Score: 89.19 [%]  |  Seq Length: 256.0
[2024-09-19 17:36:26,022][root][INFO] - Step: 7400/9020  |  Loss: 0.1913  |  Score: 92.55 [%]  |  Seq Length: 256.0
[2024-09-19 17:36:49,154][root][INFO] - Step: 6000/9020  |  Loss: 0.4284  |  Score: 81.31 [%]  |  Seq Length: 256.0
[2024-09-19 17:36:56,812][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 17:36:56,813][root][INFO] - Score: 87.84 [%]  |  Evaluation Time: 45.02 [s]
[2024-09-19 17:37:02,917][root][INFO] - Step: 7500/9020  |  Loss: 0.2034  |  Score: 91.80 [%]  |  Seq Length: 256.0
[2024-09-19 17:37:33,524][root][INFO] - Step: 6100/9020  |  Loss: 0.4280  |  Score: 80.89 [%]  |  Seq Length: 256.0
[2024-09-19 17:37:39,808][root][INFO] - Step: 7600/9020  |  Loss: 0.1806  |  Score: 92.95 [%]  |  Seq Length: 256.0
[2024-09-19 17:38:16,738][root][INFO] - Step: 7700/9020  |  Loss: 0.1940  |  Score: 92.25 [%]  |  Seq Length: 256.0
[2024-09-19 17:38:17,796][root][INFO] - Step: 6200/9020  |  Loss: 0.4238  |  Score: 81.20 [%]  |  Seq Length: 256.0
[2024-09-19 17:38:53,669][root][INFO] - Step: 7800/9020  |  Loss: 0.1970  |  Score: 92.17 [%]  |  Seq Length: 256.0
[2024-09-19 17:39:02,011][root][INFO] - Step: 6300/9020  |  Loss: 0.4302  |  Score: 81.42 [%]  |  Seq Length: 256.0
[2024-09-19 17:39:25,333][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 17:39:25,333][root][INFO] - Score: 88.07 [%]  |  Evaluation Time: 148.52 [s]
[2024-09-19 17:39:25,334][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-19 17:39:25,336][root][INFO] - 
[4/ 5 Epoch]
[2024-09-19 17:39:30,574][root][INFO] - Step: 7900/9020  |  Loss: 0.1954  |  Score: 92.50 [%]  |  Seq Length: 256.0
[2024-09-19 17:39:46,376][root][INFO] - Step: 6400/9020  |  Loss: 0.4238  |  Score: 81.95 [%]  |  Seq Length: 256.0
[2024-09-19 17:40:07,484][root][INFO] - Step: 8000/9020  |  Loss: 0.1864  |  Score: 92.69 [%]  |  Seq Length: 256.0
[2024-09-19 17:40:09,572][root][INFO] - Step: 5500/9020  |  Loss: 0.2334  |  Score: 90.66 [%]  |  Seq Length: 256.0
[2024-09-19 17:40:30,731][root][INFO] - Step: 6500/9020  |  Loss: 0.4277  |  Score: 80.95 [%]  |  Seq Length: 256.0
[2024-09-19 17:40:44,402][root][INFO] - Step: 8100/9020  |  Loss: 0.1881  |  Score: 92.59 [%]  |  Seq Length: 256.0
[2024-09-19 17:40:59,272][root][INFO] - Step: 5600/9020  |  Loss: 0.2303  |  Score: 90.34 [%]  |  Seq Length: 256.0
[2024-09-19 17:41:15,597][root][INFO] - Step: 6600/9020  |  Loss: 0.4263  |  Score: 81.59 [%]  |  Seq Length: 256.0
[2024-09-19 17:41:21,561][root][INFO] - Step: 8200/9020  |  Loss: 0.1799  |  Score: 92.84 [%]  |  Seq Length: 256.0
[2024-09-19 17:41:48,835][root][INFO] - Step: 5700/9020  |  Loss: 0.2319  |  Score: 90.73 [%]  |  Seq Length: 256.0
[2024-09-19 17:41:58,669][root][INFO] - Step: 8300/9020  |  Loss: 0.2008  |  Score: 92.25 [%]  |  Seq Length: 256.0
[2024-09-19 17:42:00,021][root][INFO] - Step: 6700/9020  |  Loss: 0.4273  |  Score: 81.28 [%]  |  Seq Length: 256.0
[2024-09-19 17:42:35,544][root][INFO] - Step: 8400/9020  |  Loss: 0.1897  |  Score: 92.23 [%]  |  Seq Length: 256.0
[2024-09-19 17:42:38,756][root][INFO] - Step: 5800/9020  |  Loss: 0.2273  |  Score: 90.92 [%]  |  Seq Length: 256.0
[2024-09-19 17:42:44,531][root][INFO] - Step: 6800/9020  |  Loss: 0.4146  |  Score: 81.83 [%]  |  Seq Length: 256.0
[2024-09-19 17:43:12,442][root][INFO] - Step: 8500/9020  |  Loss: 0.1951  |  Score: 92.25 [%]  |  Seq Length: 256.0
[2024-09-19 17:43:27,914][root][INFO] - Step: 5900/9020  |  Loss: 0.2319  |  Score: 90.48 [%]  |  Seq Length: 256.0
[2024-09-19 17:43:28,855][root][INFO] - Step: 6900/9020  |  Loss: 0.4348  |  Score: 80.11 [%]  |  Seq Length: 256.0
[2024-09-19 17:43:49,345][root][INFO] - Step: 8600/9020  |  Loss: 0.1799  |  Score: 93.00 [%]  |  Seq Length: 256.0
[2024-09-19 17:44:13,082][root][INFO] - Step: 7000/9020  |  Loss: 0.4250  |  Score: 81.58 [%]  |  Seq Length: 256.0
[2024-09-19 17:44:17,689][root][INFO] - Step: 6000/9020  |  Loss: 0.2347  |  Score: 90.30 [%]  |  Seq Length: 256.0
[2024-09-19 17:44:26,261][root][INFO] - Step: 8700/9020  |  Loss: 0.1926  |  Score: 92.36 [%]  |  Seq Length: 256.0
[2024-09-19 17:44:56,642][root][INFO] - Step: 7100/9020  |  Loss: 0.4266  |  Score: 81.09 [%]  |  Seq Length: 256.0
[2024-09-19 17:45:03,184][root][INFO] - Step: 8800/9020  |  Loss: 0.1820  |  Score: 92.83 [%]  |  Seq Length: 256.0
[2024-09-19 17:45:07,571][root][INFO] - Step: 6100/9020  |  Loss: 0.2298  |  Score: 90.97 [%]  |  Seq Length: 256.0
[2024-09-19 17:45:40,107][root][INFO] - Step: 8900/9020  |  Loss: 0.1861  |  Score: 92.23 [%]  |  Seq Length: 256.0
[2024-09-19 17:45:40,144][root][INFO] - Step: 7200/9020  |  Loss: 0.4314  |  Score: 81.22 [%]  |  Seq Length: 256.0
[2024-09-19 17:45:47,132][root][INFO] - Step: 7216/9020  |  Loss: 0.4041  |  Score: 83.51 [%]  |  Seq Length: 256.0
[2024-09-19 17:45:57,309][root][INFO] - Step: 6200/9020  |  Loss: 0.2392  |  Score: 90.28 [%]  |  Seq Length: 256.0
[2024-09-19 17:46:16,570][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 17:46:16,570][root][INFO] - Score: 78.56 [%]  |  Evaluation Time: 29.44 [s]
[2024-09-19 17:46:17,019][root][INFO] - Step: 9000/9020  |  Loss: 0.1870  |  Score: 92.53 [%]  |  Seq Length: 256.0
[2024-09-19 17:46:24,411][root][INFO] - Step: 9020/9020  |  Loss: 0.1702  |  Score: 93.39 [%]  |  Seq Length: 256.0
[2024-09-19 17:46:46,477][root][INFO] - Step: 6300/9020  |  Loss: 0.2422  |  Score: 90.11 [%]  |  Seq Length: 256.0
[2024-09-19 17:46:53,613][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 17:46:53,614][root][INFO] - Score: 88.78 [%]  |  Evaluation Time: 29.20 [s]
[2024-09-19 17:47:35,734][root][INFO] - Step: 6400/9020  |  Loss: 0.2281  |  Score: 90.50 [%]  |  Seq Length: 256.0
[2024-09-19 17:47:53,518][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 17:47:53,519][root][INFO] - Score: 78.46 [%]  |  Evaluation Time: 96.95 [s]
[2024-09-19 17:47:53,521][root][INFO] - 
[5/ 5 Epoch]
[2024-09-19 17:48:24,522][root][INFO] - Step: 6500/9020  |  Loss: 0.2274  |  Score: 90.41 [%]  |  Seq Length: 256.0
[2024-09-19 17:48:29,970][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 17:48:29,970][root][INFO] - Score: 88.66 [%]  |  Evaluation Time: 96.35 [s]
[2024-09-19 17:48:29,971][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-19 17:48:29,971][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 17:48:29,971][root][INFO] - - Epoch: 5
[2024-09-19 17:48:29,971][root][INFO] - - DEV score: 88.78 [%]
[2024-09-19 17:48:29,971][root][INFO] - - TEST score: 88.66 [%]
[2024-09-19 17:48:29,972][root][INFO] - Fine-tuning is done!
[2024-09-19 17:48:31,161][root][INFO] - Step: 7300/9020  |  Loss: 0.4341  |  Score: 80.51 [%]  |  Seq Length: 256.0
[2024-09-19 17:49:14,388][root][INFO] - Step: 6600/9020  |  Loss: 0.2379  |  Score: 90.20 [%]  |  Seq Length: 256.0
[2024-09-19 17:49:15,513][root][INFO] - Step: 7400/9020  |  Loss: 0.4277  |  Score: 81.06 [%]  |  Seq Length: 256.0
[2024-09-19 17:49:59,818][root][INFO] - Step: 7500/9020  |  Loss: 0.4260  |  Score: 81.30 [%]  |  Seq Length: 256.0
[2024-09-19 17:50:03,046][root][INFO] - Step: 6700/9020  |  Loss: 0.2325  |  Score: 90.56 [%]  |  Seq Length: 256.0
[2024-09-19 17:50:44,049][root][INFO] - Step: 7600/9020  |  Loss: 0.4235  |  Score: 81.39 [%]  |  Seq Length: 256.0
[2024-09-19 17:50:52,682][root][INFO] - Step: 6800/9020  |  Loss: 0.2264  |  Score: 90.86 [%]  |  Seq Length: 256.0
[2024-09-19 17:51:28,294][root][INFO] - Step: 7700/9020  |  Loss: 0.3996  |  Score: 82.56 [%]  |  Seq Length: 256.0
[2024-09-19 17:51:42,513][root][INFO] - Step: 6900/9020  |  Loss: 0.2324  |  Score: 90.52 [%]  |  Seq Length: 256.0
[2024-09-19 17:52:12,629][root][INFO] - Step: 7800/9020  |  Loss: 0.4031  |  Score: 82.48 [%]  |  Seq Length: 256.0
[2024-09-19 17:52:32,244][root][INFO] - Step: 7000/9020  |  Loss: 0.2228  |  Score: 91.11 [%]  |  Seq Length: 256.0
[2024-09-19 17:52:56,937][root][INFO] - Step: 7900/9020  |  Loss: 0.4198  |  Score: 80.89 [%]  |  Seq Length: 256.0
[2024-09-19 17:53:21,990][root][INFO] - Step: 7100/9020  |  Loss: 0.2162  |  Score: 91.25 [%]  |  Seq Length: 256.0
[2024-09-19 17:53:41,238][root][INFO] - Step: 8000/9020  |  Loss: 0.4082  |  Score: 82.52 [%]  |  Seq Length: 256.0
[2024-09-19 17:54:11,656][root][INFO] - Step: 7200/9020  |  Loss: 0.2240  |  Score: 91.00 [%]  |  Seq Length: 256.0
[2024-09-19 17:54:19,716][root][INFO] - Step: 7216/9020  |  Loss: 0.2331  |  Score: 90.48 [%]  |  Seq Length: 256.0
[2024-09-19 17:54:25,488][root][INFO] - Step: 8100/9020  |  Loss: 0.4094  |  Score: 81.84 [%]  |  Seq Length: 256.0
[2024-09-19 17:55:04,971][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 17:55:04,971][root][INFO] - Score: 88.58 [%]  |  Evaluation Time: 45.25 [s]
[2024-09-19 17:55:09,794][root][INFO] - Step: 8200/9020  |  Loss: 0.4072  |  Score: 82.47 [%]  |  Seq Length: 256.0
[2024-09-19 17:55:54,184][root][INFO] - Step: 8300/9020  |  Loss: 0.4112  |  Score: 82.06 [%]  |  Seq Length: 256.0
[2024-09-19 17:56:38,653][root][INFO] - Step: 8400/9020  |  Loss: 0.4115  |  Score: 81.83 [%]  |  Seq Length: 256.0
[2024-09-19 17:57:23,073][root][INFO] - Step: 8500/9020  |  Loss: 0.4061  |  Score: 81.94 [%]  |  Seq Length: 256.0
[2024-09-19 17:57:33,782][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 17:57:33,782][root][INFO] - Score: 88.49 [%]  |  Evaluation Time: 148.81 [s]
[2024-09-19 17:57:33,783][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-19 17:57:33,785][root][INFO] - 
[5/ 5 Epoch]
[2024-09-19 17:58:07,490][root][INFO] - Step: 8600/9020  |  Loss: 0.4041  |  Score: 82.19 [%]  |  Seq Length: 256.0
[2024-09-19 17:58:16,005][root][INFO] - Step: 7300/9020  |  Loss: 0.1865  |  Score: 92.28 [%]  |  Seq Length: 256.0
[2024-09-19 17:58:51,945][root][INFO] - Step: 8700/9020  |  Loss: 0.4049  |  Score: 82.64 [%]  |  Seq Length: 256.0
[2024-09-19 17:59:05,855][root][INFO] - Step: 7400/9020  |  Loss: 0.1918  |  Score: 92.11 [%]  |  Seq Length: 256.0
[2024-09-19 17:59:36,363][root][INFO] - Step: 8800/9020  |  Loss: 0.4287  |  Score: 80.94 [%]  |  Seq Length: 256.0
[2024-09-19 17:59:55,640][root][INFO] - Step: 7500/9020  |  Loss: 0.1841  |  Score: 92.84 [%]  |  Seq Length: 256.0
[2024-09-19 18:00:20,724][root][INFO] - Step: 8900/9020  |  Loss: 0.4182  |  Score: 81.83 [%]  |  Seq Length: 256.0
[2024-09-19 18:00:45,270][root][INFO] - Step: 7600/9020  |  Loss: 0.1878  |  Score: 92.55 [%]  |  Seq Length: 256.0
[2024-09-19 18:01:05,011][root][INFO] - Step: 9000/9020  |  Loss: 0.4247  |  Score: 81.02 [%]  |  Seq Length: 256.0
[2024-09-19 18:01:13,718][root][INFO] - Step: 9020/9020  |  Loss: 0.4172  |  Score: 82.54 [%]  |  Seq Length: 256.0
[2024-09-19 18:01:34,789][root][INFO] - Step: 7700/9020  |  Loss: 0.1935  |  Score: 92.28 [%]  |  Seq Length: 256.0
[2024-09-19 18:01:43,168][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 18:01:43,168][root][INFO] - Score: 78.67 [%]  |  Evaluation Time: 29.45 [s]
[2024-09-19 18:02:24,372][root][INFO] - Step: 7800/9020  |  Loss: 0.1962  |  Score: 92.12 [%]  |  Seq Length: 256.0
[2024-09-19 18:03:14,370][root][INFO] - Step: 7900/9020  |  Loss: 0.1813  |  Score: 92.81 [%]  |  Seq Length: 256.0
[2024-09-19 18:03:20,166][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 18:03:20,167][root][INFO] - Score: 78.62 [%]  |  Evaluation Time: 97.00 [s]
[2024-09-19 18:03:20,168][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 18:03:20,168][root][INFO] - - Epoch: 1
[2024-09-19 18:03:20,168][root][INFO] - - DEV score: 80.14 [%]
[2024-09-19 18:03:20,168][root][INFO] - - TEST score: 80.11 [%]
[2024-09-19 18:03:20,169][root][INFO] - Fine-tuning is done!
[2024-09-19 18:03:25,129][root][INFO] - 

[2024-09-19 18:03:25,129][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 18:03:25,129][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.02lr_42rs
[2024-09-19 18:03:25,129][root][INFO] - 

[2024-09-19 18:03:25,130][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 18:04:02,832][root][INFO] - Step: 8000/9020  |  Loss: 0.1991  |  Score: 91.94 [%]  |  Seq Length: 256.0
[2024-09-19 18:04:44,797][root][INFO] - 

[2024-09-19 18:04:44,797][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 18:04:44,797][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.0001lr_42rs
[2024-09-19 18:04:44,797][root][INFO] - 

[2024-09-19 18:04:44,797][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.0001, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.0001lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.0001lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.0001lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 18:04:51,328][root][INFO] - Step: 8100/9020  |  Loss: 0.1781  |  Score: 92.78 [%]  |  Seq Length: 256.0
[2024-09-19 18:05:05,004][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 18:05:09,043][root][INFO] - 

[2024-09-19 18:05:09,044][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-19 18:05:09,044][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 18:05:09,053][root][INFO] - vocab size              : 51200
[2024-09-19 18:05:09,053][root][INFO] - device                  : gpu
[2024-09-19 18:05:09,053][root][INFO] - random seed             : 42
[2024-09-19 18:05:09,054][root][INFO] - train data size         : 115456
[2024-09-19 18:05:09,054][root][INFO] - max epochs              : 5
[2024-09-19 18:05:09,054][root][INFO] - total steps             : 9020
[2024-09-19 18:05:09,054][root][INFO] - warmup steps            : 902
[2024-09-19 18:05:09,054][root][INFO] - batch size              : 64
[2024-09-19 18:05:09,054][root][INFO] - accumulation steps      : 1
[2024-09-19 18:05:09,054][root][INFO] - optimizer               : adamwscale
[2024-09-19 18:05:09,054][root][INFO] - lr_scheduler            : cosine
[2024-09-19 18:05:09,054][root][INFO] - learning rate           : 0.0001
[2024-09-19 18:05:09,054][root][INFO] - max length              : 256

[2024-09-19 18:05:09,054][root][INFO] - 

[2024-09-19 18:05:09,055][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.0001lr_42rs
[2024-09-19 18:05:09,055][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.0001lr_42rs/ckpt
[2024-09-19 18:05:09,055][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.0001lr_42rs/tb
[2024-09-19 18:05:09,055][root][INFO] - * tb interval           : 100

[2024-09-19 18:05:09,055][root][INFO] - 

[2024-09-19 18:05:09,055][root][INFO] - Start the Training !
[2024-09-19 18:05:09,058][root][INFO] - 
[1/ 5 Epoch]
[2024-09-19 18:05:17,369][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-19 18:05:17,370][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-19 18:05:17,370][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-19 18:05:17,371][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-19 18:05:17,372][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-19 18:05:17,372][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-19 18:05:17,373][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-19 18:05:17,373][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-19 18:05:17,374][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-19 18:05:17,374][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-19 18:05:17,375][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-19 18:05:17,375][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-19 18:05:17,376][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-19 18:05:17,376][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-19 18:05:17,377][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-19 18:05:17,378][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-19 18:05:17,378][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-19 18:05:17,379][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-19 18:05:17,379][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-19 18:05:17,380][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-19 18:05:17,381][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-19 18:05:17,381][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-19 18:05:17,382][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-19 18:05:17,382][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-19 18:05:17,385][root][INFO] - Trainable params: 1769472 || all params: 126935808 || trainable: 1.39 %
[2024-09-19 18:05:17,613][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 18:05:23,659][root][INFO] - 

[2024-09-19 18:05:23,659][root][INFO] - ========== Fine-tuning on KorNLI ==========
[2024-09-19 18:05:23,659][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 18:05:23,673][root][INFO] - vocab size              : 51200
[2024-09-19 18:05:23,673][root][INFO] - device                  : gpu
[2024-09-19 18:05:23,674][root][INFO] - random seed             : 42
[2024-09-19 18:05:23,674][root][INFO] - train data size         : 845504
[2024-09-19 18:05:23,674][root][INFO] - max epochs              : 3
[2024-09-19 18:05:23,674][root][INFO] - total steps             : 39633
[2024-09-19 18:05:23,674][root][INFO] - warmup steps            : 3963
[2024-09-19 18:05:23,674][root][INFO] - batch size              : 64
[2024-09-19 18:05:23,675][root][INFO] - accumulation steps      : 1
[2024-09-19 18:05:23,675][root][INFO] - optimizer               : adamwscale
[2024-09-19 18:05:23,675][root][INFO] - lr_scheduler            : cosine
[2024-09-19 18:05:23,675][root][INFO] - learning rate           : 0.02
[2024-09-19 18:05:23,675][root][INFO] - max length              : 256

[2024-09-19 18:05:23,675][root][INFO] - LoRA Configuration
[2024-09-19 18:05:23,675][root][INFO] - ㄴ r                    : 32
[2024-09-19 18:05:23,676][root][INFO] - ㄴ alpha                : 128
[2024-09-19 18:05:23,676][root][INFO] - ㄴ dropout              : 0.03

[2024-09-19 18:05:23,676][root][INFO] - 

[2024-09-19 18:05:23,676][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.02lr_42rs
[2024-09-19 18:05:23,676][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.02lr_42rs/ckpt
[2024-09-19 18:05:23,676][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.02lr_42rs/tb
[2024-09-19 18:05:23,677][root][INFO] - * tb interval           : 400

[2024-09-19 18:05:23,677][root][INFO] - 

[2024-09-19 18:05:23,677][root][INFO] - Start the Training !
[2024-09-19 18:05:23,682][root][INFO] - 
[1/ 3 Epoch]
[2024-09-19 18:05:41,149][root][INFO] - Step: 8200/9020  |  Loss: 0.1933  |  Score: 92.25 [%]  |  Seq Length: 256.0
[2024-09-19 18:05:56,380][root][INFO] - Step: 100/9020  |  Loss: 0.6294  |  Score: 65.36 [%]  |  Seq Length: 256.0
[2024-09-19 18:06:26,955][root][INFO] - 

[2024-09-19 18:06:26,955][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 18:06:26,955][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.02lr_42rs
[2024-09-19 18:06:26,955][root][INFO] - 

[2024-09-19 18:06:26,956][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 2, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 18:06:31,008][root][INFO] - Step: 8300/9020  |  Loss: 0.1872  |  Score: 92.64 [%]  |  Seq Length: 256.0
[2024-09-19 18:06:40,632][root][INFO] - Step: 200/9020  |  Loss: 0.4611  |  Score: 79.02 [%]  |  Seq Length: 256.0
[2024-09-19 18:07:20,946][root][INFO] - Step: 8400/9020  |  Loss: 0.1774  |  Score: 92.94 [%]  |  Seq Length: 256.0
[2024-09-19 18:07:24,954][root][INFO] - Step: 300/9020  |  Loss: 0.4174  |  Score: 81.48 [%]  |  Seq Length: 256.0
[2024-09-19 18:08:09,296][root][INFO] - Step: 400/9020  |  Loss: 0.3947  |  Score: 82.19 [%]  |  Seq Length: 256.0
[2024-09-19 18:08:10,480][root][INFO] - Step: 8500/9020  |  Loss: 0.1848  |  Score: 93.05 [%]  |  Seq Length: 256.0
[2024-09-19 18:08:32,378][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-19 18:08:32,378][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-19 18:08:32,379][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-19 18:08:32,379][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-19 18:08:32,380][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-19 18:08:32,380][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-19 18:08:32,381][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-19 18:08:32,382][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-19 18:08:32,382][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-19 18:08:32,383][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-19 18:08:32,384][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-19 18:08:32,384][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-19 18:08:32,385][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-19 18:08:32,386][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-19 18:08:32,387][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-19 18:08:32,387][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-19 18:08:32,388][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-19 18:08:32,388][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-19 18:08:32,389][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-19 18:08:32,390][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-19 18:08:32,390][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-19 18:08:32,391][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-19 18:08:32,391][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-19 18:08:32,392][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-19 18:08:32,393][root][INFO] - Trainable params: 1769472 || all params: 126935808 || trainable: 1.39 %
[2024-09-19 18:08:32,840][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 18:08:39,538][root][INFO] - 

[2024-09-19 18:08:39,538][root][INFO] - ========== Fine-tuning on KorNLI ==========
[2024-09-19 18:08:39,538][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 18:08:39,547][root][INFO] - vocab size              : 51200
[2024-09-19 18:08:39,547][root][INFO] - device                  : gpu
[2024-09-19 18:08:39,547][root][INFO] - random seed             : 42
[2024-09-19 18:08:39,547][root][INFO] - train data size         : 422752
[2024-09-19 18:08:39,547][root][INFO] - max epochs              : 3
[2024-09-19 18:08:39,547][root][INFO] - total steps             : 39633
[2024-09-19 18:08:39,547][root][INFO] - warmup steps            : 3963
[2024-09-19 18:08:39,548][root][INFO] - batch size              : 64
[2024-09-19 18:08:39,548][root][INFO] - accumulation steps      : 2
[2024-09-19 18:08:39,548][root][INFO] - optimizer               : adamwscale
[2024-09-19 18:08:39,548][root][INFO] - lr_scheduler            : cosine
[2024-09-19 18:08:39,548][root][INFO] - learning rate           : 0.02
[2024-09-19 18:08:39,548][root][INFO] - max length              : 256

[2024-09-19 18:08:39,548][root][INFO] - LoRA Configuration
[2024-09-19 18:08:39,548][root][INFO] - ㄴ r                    : 32
[2024-09-19 18:08:39,548][root][INFO] - ㄴ alpha                : 128
[2024-09-19 18:08:39,548][root][INFO] - ㄴ dropout              : 0.03

[2024-09-19 18:08:39,548][root][INFO] - 

[2024-09-19 18:08:39,549][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.02lr_42rs
[2024-09-19 18:08:39,549][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.02lr_42rs/ckpt
[2024-09-19 18:08:39,549][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.02lr_42rs/tb
[2024-09-19 18:08:39,549][root][INFO] - * tb interval           : 400

[2024-09-19 18:08:39,549][root][INFO] - 

[2024-09-19 18:08:39,549][root][INFO] - Start the Training !
[2024-09-19 18:08:39,552][root][INFO] - 
[1/ 3 Epoch]
[2024-09-19 18:08:53,664][root][INFO] - Step: 500/9020  |  Loss: 0.3819  |  Score: 82.83 [%]  |  Seq Length: 256.0
[2024-09-19 18:08:59,031][root][INFO] - Step: 8600/9020  |  Loss: 0.1805  |  Score: 92.83 [%]  |  Seq Length: 256.0
[2024-09-19 18:09:38,073][root][INFO] - Step: 600/9020  |  Loss: 0.3693  |  Score: 83.83 [%]  |  Seq Length: 256.0
[2024-09-19 18:09:48,581][root][INFO] - Step: 8700/9020  |  Loss: 0.1889  |  Score: 92.28 [%]  |  Seq Length: 256.0
[2024-09-19 18:10:22,454][root][INFO] - Step: 700/9020  |  Loss: 0.3657  |  Score: 83.41 [%]  |  Seq Length: 256.0
[2024-09-19 18:10:37,658][root][INFO] - Step: 8800/9020  |  Loss: 0.1901  |  Score: 92.06 [%]  |  Seq Length: 256.0
[2024-09-19 18:11:06,818][root][INFO] - Step: 800/9020  |  Loss: 0.3476  |  Score: 84.92 [%]  |  Seq Length: 256.0
[2024-09-19 18:11:27,275][root][INFO] - Step: 8900/9020  |  Loss: 0.1762  |  Score: 92.83 [%]  |  Seq Length: 256.0
[2024-09-19 18:11:51,214][root][INFO] - Step: 900/9020  |  Loss: 0.3396  |  Score: 85.23 [%]  |  Seq Length: 256.0
[2024-09-19 18:12:16,960][root][INFO] - Step: 9000/9020  |  Loss: 0.1861  |  Score: 92.67 [%]  |  Seq Length: 256.0
[2024-09-19 18:12:26,960][root][INFO] - Step: 9020/9020  |  Loss: 0.1821  |  Score: 92.28 [%]  |  Seq Length: 256.0
[2024-09-19 18:12:35,617][root][INFO] - Step: 1000/9020  |  Loss: 0.3611  |  Score: 84.05 [%]  |  Seq Length: 256.0
[2024-09-19 18:13:12,233][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 18:13:12,233][root][INFO] - Score: 88.43 [%]  |  Evaluation Time: 45.27 [s]
[2024-09-19 18:13:20,001][root][INFO] - Step: 1100/9020  |  Loss: 0.3260  |  Score: 85.69 [%]  |  Seq Length: 256.0
[2024-09-19 18:14:04,447][root][INFO] - Step: 1200/9020  |  Loss: 0.3323  |  Score: 85.84 [%]  |  Seq Length: 256.0
[2024-09-19 18:14:48,888][root][INFO] - Step: 1300/9020  |  Loss: 0.3297  |  Score: 86.06 [%]  |  Seq Length: 256.0
[2024-09-19 18:15:33,284][root][INFO] - Step: 1400/9020  |  Loss: 0.3390  |  Score: 85.66 [%]  |  Seq Length: 256.0
[2024-09-19 18:15:40,943][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 18:15:40,943][root][INFO] - Score: 88.59 [%]  |  Evaluation Time: 148.70 [s]
[2024-09-19 18:15:40,944][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 18:15:40,944][root][INFO] - - Epoch: 4
[2024-09-19 18:15:40,944][root][INFO] - - DEV score: 88.58 [%]
[2024-09-19 18:15:40,945][root][INFO] - - TEST score: 88.49 [%]
[2024-09-19 18:15:40,945][root][INFO] - Fine-tuning is done!
[2024-09-19 18:16:17,752][root][INFO] - Step: 1500/9020  |  Loss: 0.3297  |  Score: 85.94 [%]  |  Seq Length: 256.0
[2024-09-19 18:17:02,166][root][INFO] - Step: 1600/9020  |  Loss: 0.3328  |  Score: 85.41 [%]  |  Seq Length: 256.0
[2024-09-19 18:17:46,547][root][INFO] - Step: 1700/9020  |  Loss: 0.3148  |  Score: 86.98 [%]  |  Seq Length: 256.0
[2024-09-19 18:18:31,013][root][INFO] - Step: 1800/9020  |  Loss: 0.3202  |  Score: 86.05 [%]  |  Seq Length: 256.0
[2024-09-19 18:18:32,810][root][INFO] - Step: 1804/9020  |  Loss: 0.3009  |  Score: 87.24 [%]  |  Seq Length: 256.0
[2024-09-19 18:19:02,201][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 18:19:02,201][root][INFO] - Score: 86.80 [%]  |  Evaluation Time: 29.39 [s]
[2024-09-19 18:20:39,055][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 18:20:39,055][root][INFO] - Score: 86.87 [%]  |  Evaluation Time: 96.85 [s]
[2024-09-19 18:20:39,056][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 18:20:39,057][root][INFO] - 
[2/ 5 Epoch]
[2024-09-19 18:21:22,166][root][INFO] - Step: 1900/9020  |  Loss: 0.3061  |  Score: 86.80 [%]  |  Seq Length: 256.0
[2024-09-19 18:22:06,499][root][INFO] - Step: 2000/9020  |  Loss: 0.2920  |  Score: 87.67 [%]  |  Seq Length: 256.0
[2024-09-19 18:22:50,792][root][INFO] - Step: 2100/9020  |  Loss: 0.2942  |  Score: 87.45 [%]  |  Seq Length: 256.0
[2024-09-19 18:23:35,154][root][INFO] - Step: 2200/9020  |  Loss: 0.2940  |  Score: 87.67 [%]  |  Seq Length: 256.0
[2024-09-19 18:24:19,533][root][INFO] - Step: 2300/9020  |  Loss: 0.2965  |  Score: 87.42 [%]  |  Seq Length: 256.0
[2024-09-19 18:25:03,958][root][INFO] - Step: 2400/9020  |  Loss: 0.2855  |  Score: 88.12 [%]  |  Seq Length: 256.0
[2024-09-19 18:25:48,321][root][INFO] - Step: 2500/9020  |  Loss: 0.2892  |  Score: 87.77 [%]  |  Seq Length: 256.0
[2024-09-19 18:26:32,703][root][INFO] - Step: 2600/9020  |  Loss: 0.2804  |  Score: 88.02 [%]  |  Seq Length: 256.0
[2024-09-19 18:27:17,096][root][INFO] - Step: 2700/9020  |  Loss: 0.2893  |  Score: 88.06 [%]  |  Seq Length: 256.0
[2024-09-19 18:28:01,438][root][INFO] - Step: 2800/9020  |  Loss: 0.2792  |  Score: 88.58 [%]  |  Seq Length: 256.0
[2024-09-19 18:28:45,826][root][INFO] - Step: 2900/9020  |  Loss: 0.2773  |  Score: 88.22 [%]  |  Seq Length: 256.0
[2024-09-19 18:29:30,243][root][INFO] - Step: 3000/9020  |  Loss: 0.2988  |  Score: 87.38 [%]  |  Seq Length: 256.0
[2024-09-19 18:30:14,649][root][INFO] - Step: 3100/9020  |  Loss: 0.2819  |  Score: 88.06 [%]  |  Seq Length: 256.0
[2024-09-19 18:30:59,053][root][INFO] - Step: 3200/9020  |  Loss: 0.2824  |  Score: 88.44 [%]  |  Seq Length: 256.0
[2024-09-19 18:31:43,502][root][INFO] - Step: 3300/9020  |  Loss: 0.2810  |  Score: 88.05 [%]  |  Seq Length: 256.0
[2024-09-19 18:32:27,899][root][INFO] - Step: 3400/9020  |  Loss: 0.2806  |  Score: 88.02 [%]  |  Seq Length: 256.0
[2024-09-19 18:33:12,301][root][INFO] - Step: 3500/9020  |  Loss: 0.2852  |  Score: 88.05 [%]  |  Seq Length: 256.0
[2024-09-19 18:33:56,715][root][INFO] - Step: 3600/9020  |  Loss: 0.2890  |  Score: 87.86 [%]  |  Seq Length: 256.0
[2024-09-19 18:34:00,282][root][INFO] - Step: 3608/9020  |  Loss: 0.2820  |  Score: 87.30 [%]  |  Seq Length: 256.0
[2024-09-19 18:34:29,654][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 18:34:29,654][root][INFO] - Score: 87.75 [%]  |  Evaluation Time: 29.37 [s]
[2024-09-19 18:36:06,620][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 18:36:06,620][root][INFO] - Score: 87.96 [%]  |  Evaluation Time: 96.96 [s]
[2024-09-19 18:36:06,621][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 18:36:06,622][root][INFO] - 
[3/ 5 Epoch]
[2024-09-19 18:36:47,965][root][INFO] - Step: 3700/9020  |  Loss: 0.2383  |  Score: 90.27 [%]  |  Seq Length: 256.0
[2024-09-19 18:37:32,381][root][INFO] - Step: 3800/9020  |  Loss: 0.2556  |  Score: 89.77 [%]  |  Seq Length: 256.0
[2024-09-19 18:38:16,814][root][INFO] - Step: 3900/9020  |  Loss: 0.2484  |  Score: 89.78 [%]  |  Seq Length: 256.0
[2024-09-19 18:39:01,155][root][INFO] - Step: 4000/9020  |  Loss: 0.2453  |  Score: 89.91 [%]  |  Seq Length: 256.0
[2024-09-19 18:39:45,566][root][INFO] - Step: 4100/9020  |  Loss: 0.2414  |  Score: 89.98 [%]  |  Seq Length: 256.0
[2024-09-19 18:40:29,999][root][INFO] - Step: 4200/9020  |  Loss: 0.2581  |  Score: 89.09 [%]  |  Seq Length: 256.0
[2024-09-19 18:41:14,484][root][INFO] - Step: 4300/9020  |  Loss: 0.2658  |  Score: 88.69 [%]  |  Seq Length: 256.0
[2024-09-19 18:41:58,862][root][INFO] - Step: 4400/9020  |  Loss: 0.2525  |  Score: 89.72 [%]  |  Seq Length: 256.0
[2024-09-19 18:42:43,279][root][INFO] - Step: 4500/9020  |  Loss: 0.2513  |  Score: 89.45 [%]  |  Seq Length: 256.0
[2024-09-19 18:43:27,672][root][INFO] - Step: 4600/9020  |  Loss: 0.2405  |  Score: 90.38 [%]  |  Seq Length: 256.0
[2024-09-19 18:44:12,093][root][INFO] - Step: 4700/9020  |  Loss: 0.2610  |  Score: 89.25 [%]  |  Seq Length: 256.0
[2024-09-19 18:44:56,462][root][INFO] - Step: 4800/9020  |  Loss: 0.2639  |  Score: 88.92 [%]  |  Seq Length: 256.0
[2024-09-19 18:45:40,870][root][INFO] - Step: 4900/9020  |  Loss: 0.2430  |  Score: 90.23 [%]  |  Seq Length: 256.0
[2024-09-19 18:46:25,296][root][INFO] - Step: 5000/9020  |  Loss: 0.2660  |  Score: 89.02 [%]  |  Seq Length: 256.0
[2024-09-19 18:47:09,699][root][INFO] - Step: 5100/9020  |  Loss: 0.2567  |  Score: 89.62 [%]  |  Seq Length: 256.0
[2024-09-19 18:47:54,049][root][INFO] - Step: 5200/9020  |  Loss: 0.2448  |  Score: 89.89 [%]  |  Seq Length: 256.0
[2024-09-19 18:48:38,425][root][INFO] - Step: 5300/9020  |  Loss: 0.2557  |  Score: 89.62 [%]  |  Seq Length: 256.0
[2024-09-19 18:49:22,849][root][INFO] - Step: 5400/9020  |  Loss: 0.2515  |  Score: 89.89 [%]  |  Seq Length: 256.0
[2024-09-19 18:49:28,186][root][INFO] - Step: 5412/9020  |  Loss: 0.2716  |  Score: 89.24 [%]  |  Seq Length: 256.0
[2024-09-19 18:49:57,533][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 18:49:57,533][root][INFO] - Score: 88.02 [%]  |  Evaluation Time: 29.34 [s]
[2024-09-19 18:51:34,533][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 18:51:34,534][root][INFO] - Score: 88.27 [%]  |  Evaluation Time: 97.00 [s]
[2024-09-19 18:51:34,535][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-19 18:51:34,536][root][INFO] - 
[4/ 5 Epoch]
[2024-09-19 18:52:13,942][root][INFO] - Step: 5500/9020  |  Loss: 0.2220  |  Score: 90.80 [%]  |  Seq Length: 256.0
[2024-09-19 18:52:58,261][root][INFO] - Step: 5600/9020  |  Loss: 0.2243  |  Score: 91.20 [%]  |  Seq Length: 256.0
[2024-09-19 18:53:42,570][root][INFO] - Step: 5700/9020  |  Loss: 0.2322  |  Score: 90.62 [%]  |  Seq Length: 256.0
[2024-09-19 18:54:26,854][root][INFO] - Step: 5800/9020  |  Loss: 0.2241  |  Score: 91.02 [%]  |  Seq Length: 256.0
[2024-09-19 18:55:11,138][root][INFO] - Step: 5900/9020  |  Loss: 0.2426  |  Score: 90.30 [%]  |  Seq Length: 256.0
[2024-09-19 18:55:55,449][root][INFO] - Step: 6000/9020  |  Loss: 0.2463  |  Score: 90.12 [%]  |  Seq Length: 256.0
[2024-09-19 18:56:39,730][root][INFO] - Step: 6100/9020  |  Loss: 0.2459  |  Score: 90.09 [%]  |  Seq Length: 256.0
[2024-09-19 18:57:24,077][root][INFO] - Step: 6200/9020  |  Loss: 0.2211  |  Score: 91.22 [%]  |  Seq Length: 256.0
[2024-09-19 18:58:08,394][root][INFO] - Step: 6300/9020  |  Loss: 0.2213  |  Score: 91.17 [%]  |  Seq Length: 256.0
[2024-09-19 18:58:52,672][root][INFO] - Step: 6400/9020  |  Loss: 0.2221  |  Score: 91.03 [%]  |  Seq Length: 256.0
[2024-09-19 18:59:37,042][root][INFO] - Step: 6500/9020  |  Loss: 0.2277  |  Score: 90.47 [%]  |  Seq Length: 256.0
[2024-09-19 19:00:21,318][root][INFO] - Step: 6600/9020  |  Loss: 0.2253  |  Score: 90.80 [%]  |  Seq Length: 256.0
[2024-09-19 19:01:05,598][root][INFO] - Step: 6700/9020  |  Loss: 0.2218  |  Score: 91.55 [%]  |  Seq Length: 256.0
[2024-09-19 19:01:49,882][root][INFO] - Step: 6800/9020  |  Loss: 0.2214  |  Score: 90.97 [%]  |  Seq Length: 256.0
[2024-09-19 19:02:34,176][root][INFO] - Step: 6900/9020  |  Loss: 0.2371  |  Score: 89.97 [%]  |  Seq Length: 256.0
[2024-09-19 19:03:18,459][root][INFO] - Step: 7000/9020  |  Loss: 0.2255  |  Score: 91.06 [%]  |  Seq Length: 256.0
[2024-09-19 19:04:02,736][root][INFO] - Step: 7100/9020  |  Loss: 0.2239  |  Score: 90.77 [%]  |  Seq Length: 256.0
[2024-09-19 19:04:47,070][root][INFO] - Step: 7200/9020  |  Loss: 0.2303  |  Score: 90.83 [%]  |  Seq Length: 256.0
[2024-09-19 19:04:54,183][root][INFO] - Step: 7216/9020  |  Loss: 0.2006  |  Score: 92.79 [%]  |  Seq Length: 256.0
[2024-09-19 19:05:23,687][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 19:05:23,687][root][INFO] - Score: 88.34 [%]  |  Evaluation Time: 29.50 [s]
[2024-09-19 19:07:00,525][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 19:07:00,526][root][INFO] - Score: 88.64 [%]  |  Evaluation Time: 96.84 [s]
[2024-09-19 19:07:00,527][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-19 19:07:00,528][root][INFO] - 
[5/ 5 Epoch]
[2024-09-19 19:07:38,164][root][INFO] - Step: 7300/9020  |  Loss: 0.2168  |  Score: 91.31 [%]  |  Seq Length: 256.0
[2024-09-19 19:08:22,482][root][INFO] - Step: 7400/9020  |  Loss: 0.2168  |  Score: 91.56 [%]  |  Seq Length: 256.0
[2024-09-19 19:09:06,785][root][INFO] - Step: 7500/9020  |  Loss: 0.2106  |  Score: 91.56 [%]  |  Seq Length: 256.0
[2024-09-19 19:09:51,076][root][INFO] - Step: 7600/9020  |  Loss: 0.2079  |  Score: 91.78 [%]  |  Seq Length: 256.0
[2024-09-19 19:10:35,361][root][INFO] - Step: 7700/9020  |  Loss: 0.2137  |  Score: 91.67 [%]  |  Seq Length: 256.0
[2024-09-19 19:11:19,622][root][INFO] - Step: 7800/9020  |  Loss: 0.2009  |  Score: 91.69 [%]  |  Seq Length: 256.0
[2024-09-19 19:12:03,855][root][INFO] - Step: 7900/9020  |  Loss: 0.2078  |  Score: 91.66 [%]  |  Seq Length: 256.0
[2024-09-19 19:12:48,267][root][INFO] - Step: 8000/9020  |  Loss: 0.2155  |  Score: 91.44 [%]  |  Seq Length: 256.0
[2024-09-19 19:13:32,563][root][INFO] - Step: 8100/9020  |  Loss: 0.2078  |  Score: 91.53 [%]  |  Seq Length: 256.0
[2024-09-19 19:14:16,890][root][INFO] - Step: 8200/9020  |  Loss: 0.2173  |  Score: 91.30 [%]  |  Seq Length: 256.0
[2024-09-19 19:15:01,189][root][INFO] - Step: 8300/9020  |  Loss: 0.2224  |  Score: 91.30 [%]  |  Seq Length: 256.0
[2024-09-19 19:15:45,535][root][INFO] - Step: 8400/9020  |  Loss: 0.2090  |  Score: 91.69 [%]  |  Seq Length: 256.0
[2024-09-19 19:16:29,824][root][INFO] - Step: 8500/9020  |  Loss: 0.2022  |  Score: 91.64 [%]  |  Seq Length: 256.0
[2024-09-19 19:17:14,135][root][INFO] - Step: 8600/9020  |  Loss: 0.1967  |  Score: 92.23 [%]  |  Seq Length: 256.0
[2024-09-19 19:17:58,427][root][INFO] - Step: 8700/9020  |  Loss: 0.2198  |  Score: 91.12 [%]  |  Seq Length: 256.0
[2024-09-19 19:18:42,733][root][INFO] - Step: 8800/9020  |  Loss: 0.2203  |  Score: 91.25 [%]  |  Seq Length: 256.0
[2024-09-19 19:19:27,024][root][INFO] - Step: 8900/9020  |  Loss: 0.2260  |  Score: 90.84 [%]  |  Seq Length: 256.0
[2024-09-19 19:20:11,352][root][INFO] - Step: 9000/9020  |  Loss: 0.2231  |  Score: 90.73 [%]  |  Seq Length: 256.0
[2024-09-19 19:20:20,260][root][INFO] - Step: 9020/9020  |  Loss: 0.2354  |  Score: 90.31 [%]  |  Seq Length: 256.0
[2024-09-19 19:20:49,621][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 19:20:49,621][root][INFO] - Score: 88.38 [%]  |  Evaluation Time: 29.36 [s]
[2024-09-19 19:22:26,339][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 19:22:26,340][root][INFO] - Score: 88.59 [%]  |  Evaluation Time: 96.72 [s]
[2024-09-19 19:22:26,341][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 19:22:26,341][root][INFO] - - Epoch: 4
[2024-09-19 19:22:26,341][root][INFO] - - DEV score: 88.34 [%]
[2024-09-19 19:22:26,341][root][INFO] - - TEST score: 88.64 [%]
[2024-09-19 19:22:26,342][root][INFO] - Fine-tuning is done!
[2024-09-20 01:25:54,947][root][INFO] - 

[2024-09-20 01:25:54,947][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-20 01:25:54,948][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.02lr_42rs
[2024-09-20 01:25:54,948][root][INFO] - 

[2024-09-20 01:25:54,948][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 4, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-20 01:28:23,409][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-20 01:28:23,410][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-20 01:28:23,411][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-20 01:28:23,411][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-20 01:28:23,412][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-20 01:28:23,412][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-20 01:28:23,412][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-20 01:28:23,413][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-20 01:28:23,413][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-20 01:28:23,414][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-20 01:28:23,414][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-20 01:28:23,415][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-20 01:28:23,415][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-20 01:28:23,416][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-20 01:28:23,416][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-20 01:28:23,417][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-20 01:28:23,417][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-20 01:28:23,418][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-20 01:28:23,418][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-20 01:28:23,419][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-20 01:28:23,419][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-20 01:28:23,420][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-20 01:28:23,420][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-20 01:28:23,421][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-20 01:28:23,422][root][INFO] - Trainable params: 1769472 || all params: 126935808 || trainable: 1.39 %
[2024-09-20 01:28:23,722][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-20 01:28:27,889][root][INFO] - 

[2024-09-20 01:28:27,889][root][INFO] - ========== Fine-tuning on KorNLI ==========
[2024-09-20 01:28:27,889][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-20 01:28:27,897][root][INFO] - vocab size              : 51200
[2024-09-20 01:28:27,897][root][INFO] - device                  : gpu
[2024-09-20 01:28:27,897][root][INFO] - random seed             : 42
[2024-09-20 01:28:27,898][root][INFO] - train data size         : 211376
[2024-09-20 01:28:27,898][root][INFO] - max epochs              : 3
[2024-09-20 01:28:27,898][root][INFO] - total steps             : 39633
[2024-09-20 01:28:27,898][root][INFO] - warmup steps            : 3963
[2024-09-20 01:28:27,898][root][INFO] - batch size              : 64
[2024-09-20 01:28:27,898][root][INFO] - accumulation steps      : 4
[2024-09-20 01:28:27,898][root][INFO] - optimizer               : adamwscale
[2024-09-20 01:28:27,898][root][INFO] - lr_scheduler            : cosine
[2024-09-20 01:28:27,898][root][INFO] - learning rate           : 0.02
[2024-09-20 01:28:27,898][root][INFO] - max length              : 256

[2024-09-20 01:28:27,898][root][INFO] - LoRA Configuration
[2024-09-20 01:28:27,898][root][INFO] - ㄴ r                    : 32
[2024-09-20 01:28:27,899][root][INFO] - ㄴ alpha                : 128
[2024-09-20 01:28:27,899][root][INFO] - ㄴ dropout              : 0.03

[2024-09-20 01:28:27,899][root][INFO] - 

[2024-09-20 01:28:27,899][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.02lr_42rs
[2024-09-20 01:28:27,899][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.02lr_42rs/ckpt
[2024-09-20 01:28:27,899][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.02lr_42rs/tb
[2024-09-20 01:28:27,899][root][INFO] - * tb interval           : 400

[2024-09-20 01:28:27,899][root][INFO] - 

[2024-09-20 01:28:27,899][root][INFO] - Start the Training !
[2024-09-20 01:28:27,902][root][INFO] - 
[1/ 3 Epoch]
[2024-09-20 01:31:14,279][root][INFO] - Step: 400/39633  |  Loss: 0.9445  |  Score: 54.19 [%]  |  Seq Length: 256.0
[2024-09-20 01:33:58,140][root][INFO] - Step: 800/39633  |  Loss: 0.8245  |  Score: 63.18 [%]  |  Seq Length: 256.0
[2024-09-20 01:36:41,854][root][INFO] - Step: 1200/39633  |  Loss: 0.7888  |  Score: 65.18 [%]  |  Seq Length: 256.0
[2024-09-20 01:39:25,903][root][INFO] - Step: 1600/39633  |  Loss: 0.7789  |  Score: 65.76 [%]  |  Seq Length: 256.0
[2024-09-20 01:42:09,566][root][INFO] - Step: 2000/39633  |  Loss: 0.7577  |  Score: 67.11 [%]  |  Seq Length: 256.0
[2024-09-20 01:44:53,118][root][INFO] - Step: 2400/39633  |  Loss: 0.7485  |  Score: 67.39 [%]  |  Seq Length: 256.0
[2024-09-20 01:47:36,840][root][INFO] - Step: 2800/39633  |  Loss: 0.7397  |  Score: 67.96 [%]  |  Seq Length: 256.0
[2024-09-20 01:50:20,785][root][INFO] - Step: 3200/39633  |  Loss: 0.7405  |  Score: 67.86 [%]  |  Seq Length: 256.0
[2024-09-20 01:53:04,713][root][INFO] - Step: 3600/39633  |  Loss: 0.7295  |  Score: 68.67 [%]  |  Seq Length: 256.0
[2024-09-20 01:55:48,432][root][INFO] - Step: 4000/39633  |  Loss: 0.7299  |  Score: 68.77 [%]  |  Seq Length: 256.0
[2024-09-20 01:58:32,183][root][INFO] - Step: 4400/39633  |  Loss: 0.7389  |  Score: 68.34 [%]  |  Seq Length: 256.0
[2024-09-20 02:01:16,132][root][INFO] - Step: 4800/39633  |  Loss: 0.7374  |  Score: 67.93 [%]  |  Seq Length: 256.0
[2024-09-20 02:03:59,964][root][INFO] - Step: 5200/39633  |  Loss: 0.7384  |  Score: 68.12 [%]  |  Seq Length: 256.0
[2024-09-20 02:06:43,858][root][INFO] - Step: 5600/39633  |  Loss: 0.7272  |  Score: 68.67 [%]  |  Seq Length: 256.0
[2024-09-20 02:09:27,614][root][INFO] - Step: 6000/39633  |  Loss: 0.7390  |  Score: 68.09 [%]  |  Seq Length: 256.0
[2024-09-20 02:12:11,452][root][INFO] - Step: 6400/39633  |  Loss: 0.7419  |  Score: 67.71 [%]  |  Seq Length: 256.0
[2024-09-20 02:14:55,357][root][INFO] - Step: 6800/39633  |  Loss: 0.7344  |  Score: 68.39 [%]  |  Seq Length: 256.0
[2024-09-20 02:17:39,209][root][INFO] - Step: 7200/39633  |  Loss: 0.7531  |  Score: 67.57 [%]  |  Seq Length: 256.0
[2024-09-20 02:20:23,038][root][INFO] - Step: 7600/39633  |  Loss: 0.7465  |  Score: 67.50 [%]  |  Seq Length: 256.0
[2024-09-20 02:23:07,207][root][INFO] - Step: 8000/39633  |  Loss: 0.7555  |  Score: 67.38 [%]  |  Seq Length: 256.0
[2024-09-20 02:25:51,285][root][INFO] - Step: 8400/39633  |  Loss: 0.7646  |  Score: 66.47 [%]  |  Seq Length: 256.0
[2024-09-20 02:28:35,528][root][INFO] - Step: 8800/39633  |  Loss: 0.7673  |  Score: 66.70 [%]  |  Seq Length: 256.0
[2024-09-20 02:31:19,631][root][INFO] - Step: 9200/39633  |  Loss: 0.7664  |  Score: 66.42 [%]  |  Seq Length: 256.0
[2024-09-20 02:34:03,735][root][INFO] - Step: 9600/39633  |  Loss: 0.7689  |  Score: 66.31 [%]  |  Seq Length: 256.0
[2024-09-20 02:36:47,730][root][INFO] - Step: 10000/39633  |  Loss: 0.7790  |  Score: 65.63 [%]  |  Seq Length: 256.0
[2024-09-20 02:39:31,908][root][INFO] - Step: 10400/39633  |  Loss: 0.7844  |  Score: 65.24 [%]  |  Seq Length: 256.0
[2024-09-20 02:42:16,058][root][INFO] - Step: 10800/39633  |  Loss: 0.7918  |  Score: 65.00 [%]  |  Seq Length: 256.0
[2024-09-20 02:45:00,261][root][INFO] - Step: 11200/39633  |  Loss: 0.7932  |  Score: 65.04 [%]  |  Seq Length: 256.0
[2024-09-20 02:47:44,212][root][INFO] - Step: 11600/39633  |  Loss: 0.7959  |  Score: 64.83 [%]  |  Seq Length: 256.0
[2024-09-20 02:50:28,310][root][INFO] - Step: 12000/39633  |  Loss: 0.7904  |  Score: 64.96 [%]  |  Seq Length: 256.0
[2024-09-20 02:53:12,588][root][INFO] - Step: 12400/39633  |  Loss: 0.8014  |  Score: 64.56 [%]  |  Seq Length: 256.0
[2024-09-20 02:55:56,702][root][INFO] - Step: 12800/39633  |  Loss: 0.8137  |  Score: 63.52 [%]  |  Seq Length: 256.0
[2024-09-20 02:58:40,616][root][INFO] - Step: 13200/39633  |  Loss: 0.8165  |  Score: 63.31 [%]  |  Seq Length: 256.0
[2024-09-20 02:58:45,179][root][INFO] - Step: 13211/39633  |  Loss: 0.8099  |  Score: 65.34 [%]  |  Seq Length: 256.0
[2024-09-20 02:58:50,720][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-20 02:58:50,720][root][INFO] - Score: 61.74 [%]  |  Evaluation Time: 5.54 [s]
[2024-09-20 02:59:00,887][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-20 02:59:00,888][root][INFO] - Score: 61.32 [%]  |  Evaluation Time: 10.16 [s]
[2024-09-20 02:59:00,889][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-20 02:59:00,890][root][INFO] - 
[2/ 3 Epoch]
[2024-09-20 03:01:40,644][root][INFO] - Step: 13600/39633  |  Loss: 0.8155  |  Score: 63.47 [%]  |  Seq Length: 256.0
[2024-09-20 03:04:24,588][root][INFO] - Step: 14000/39633  |  Loss: 0.8085  |  Score: 63.60 [%]  |  Seq Length: 256.0
[2024-09-20 03:07:08,415][root][INFO] - Step: 14400/39633  |  Loss: 0.8183  |  Score: 63.45 [%]  |  Seq Length: 256.0
[2024-09-20 03:09:52,215][root][INFO] - Step: 14800/39633  |  Loss: 0.8178  |  Score: 62.99 [%]  |  Seq Length: 256.0
[2024-09-20 03:12:35,754][root][INFO] - Step: 15200/39633  |  Loss: 0.8342  |  Score: 62.51 [%]  |  Seq Length: 256.0
[2024-09-20 03:15:19,421][root][INFO] - Step: 15600/39633  |  Loss: 0.8303  |  Score: 62.50 [%]  |  Seq Length: 256.0
[2024-09-20 03:18:03,172][root][INFO] - Step: 16000/39633  |  Loss: 0.8445  |  Score: 61.70 [%]  |  Seq Length: 256.0
[2024-09-20 03:20:46,966][root][INFO] - Step: 16400/39633  |  Loss: 0.8313  |  Score: 62.51 [%]  |  Seq Length: 256.0
[2024-09-20 03:23:30,507][root][INFO] - Step: 16800/39633  |  Loss: 0.8408  |  Score: 61.86 [%]  |  Seq Length: 256.0
[2024-09-20 03:26:14,468][root][INFO] - Step: 17200/39633  |  Loss: 0.8449  |  Score: 61.33 [%]  |  Seq Length: 256.0
[2024-09-20 03:28:58,479][root][INFO] - Step: 17600/39633  |  Loss: 0.8308  |  Score: 62.35 [%]  |  Seq Length: 256.0
[2024-09-20 03:31:42,476][root][INFO] - Step: 18000/39633  |  Loss: 0.8474  |  Score: 61.52 [%]  |  Seq Length: 256.0
[2024-09-20 03:34:26,332][root][INFO] - Step: 18400/39633  |  Loss: 0.8371  |  Score: 62.16 [%]  |  Seq Length: 256.0
[2024-09-20 03:37:10,292][root][INFO] - Step: 18800/39633  |  Loss: 0.8366  |  Score: 62.09 [%]  |  Seq Length: 256.0
[2024-09-20 03:39:54,077][root][INFO] - Step: 19200/39633  |  Loss: 0.8295  |  Score: 62.39 [%]  |  Seq Length: 256.0
[2024-09-20 03:42:37,812][root][INFO] - Step: 19600/39633  |  Loss: 0.8294  |  Score: 62.52 [%]  |  Seq Length: 256.0
[2024-09-20 03:45:21,521][root][INFO] - Step: 20000/39633  |  Loss: 0.8281  |  Score: 62.39 [%]  |  Seq Length: 256.0
[2024-09-20 03:48:05,337][root][INFO] - Step: 20400/39633  |  Loss: 0.8191  |  Score: 63.12 [%]  |  Seq Length: 256.0
[2024-09-20 03:50:49,129][root][INFO] - Step: 20800/39633  |  Loss: 0.8195  |  Score: 62.95 [%]  |  Seq Length: 256.0
[2024-09-20 03:53:32,702][root][INFO] - Step: 21200/39633  |  Loss: 0.8213  |  Score: 63.07 [%]  |  Seq Length: 256.0
[2024-09-20 03:56:16,596][root][INFO] - Step: 21600/39633  |  Loss: 0.8178  |  Score: 63.11 [%]  |  Seq Length: 256.0
[2024-09-20 03:59:00,331][root][INFO] - Step: 22000/39633  |  Loss: 0.8217  |  Score: 62.69 [%]  |  Seq Length: 256.0
[2024-09-20 04:01:44,068][root][INFO] - Step: 22400/39633  |  Loss: 0.8135  |  Score: 63.58 [%]  |  Seq Length: 256.0
[2024-09-20 04:04:27,891][root][INFO] - Step: 22800/39633  |  Loss: 0.8153  |  Score: 63.07 [%]  |  Seq Length: 256.0
[2024-09-20 04:07:11,481][root][INFO] - Step: 23200/39633  |  Loss: 0.8113  |  Score: 63.56 [%]  |  Seq Length: 256.0
[2024-09-20 04:09:55,223][root][INFO] - Step: 23600/39633  |  Loss: 0.8045  |  Score: 63.57 [%]  |  Seq Length: 256.0
[2024-09-20 04:12:38,898][root][INFO] - Step: 24000/39633  |  Loss: 0.8006  |  Score: 64.18 [%]  |  Seq Length: 256.0
[2024-09-20 04:15:22,987][root][INFO] - Step: 24400/39633  |  Loss: 0.7956  |  Score: 64.19 [%]  |  Seq Length: 256.0
[2024-09-20 04:18:06,982][root][INFO] - Step: 24800/39633  |  Loss: 0.7941  |  Score: 64.60 [%]  |  Seq Length: 256.0
[2024-09-20 04:20:50,921][root][INFO] - Step: 25200/39633  |  Loss: 0.7876  |  Score: 64.68 [%]  |  Seq Length: 256.0
[2024-09-20 04:23:34,885][root][INFO] - Step: 25600/39633  |  Loss: 0.7734  |  Score: 65.62 [%]  |  Seq Length: 256.0
[2024-09-20 04:26:19,037][root][INFO] - Step: 26000/39633  |  Loss: 0.7786  |  Score: 65.64 [%]  |  Seq Length: 256.0
[2024-09-20 04:29:03,242][root][INFO] - Step: 26400/39633  |  Loss: 0.7714  |  Score: 65.85 [%]  |  Seq Length: 256.0
[2024-09-20 04:29:12,385][root][INFO] - Step: 26422/39633  |  Loss: 0.7579  |  Score: 66.83 [%]  |  Seq Length: 256.0
[2024-09-20 04:29:17,760][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-20 04:29:17,760][root][INFO] - Score: 65.06 [%]  |  Evaluation Time: 5.37 [s]
[2024-09-20 04:29:27,836][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-20 04:29:27,837][root][INFO] - Score: 63.76 [%]  |  Evaluation Time: 10.07 [s]
[2024-09-20 04:29:27,838][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-20 04:29:27,839][root][INFO] - 
[3/ 3 Epoch]
[2024-09-20 04:32:03,689][root][INFO] - Step: 26800/39633  |  Loss: 0.7658  |  Score: 66.25 [%]  |  Seq Length: 256.0
[2024-09-20 04:34:47,891][root][INFO] - Step: 27200/39633  |  Loss: 0.7530  |  Score: 66.96 [%]  |  Seq Length: 256.0
[2024-09-20 04:37:31,737][root][INFO] - Step: 27600/39633  |  Loss: 0.7500  |  Score: 67.30 [%]  |  Seq Length: 256.0
[2024-09-20 04:40:16,103][root][INFO] - Step: 28000/39633  |  Loss: 0.7506  |  Score: 67.03 [%]  |  Seq Length: 256.0
[2024-09-20 04:43:00,239][root][INFO] - Step: 28400/39633  |  Loss: 0.7439  |  Score: 67.43 [%]  |  Seq Length: 256.0
[2024-09-20 04:45:44,383][root][INFO] - Step: 28800/39633  |  Loss: 0.7307  |  Score: 67.89 [%]  |  Seq Length: 256.0
[2024-09-20 04:48:28,269][root][INFO] - Step: 29200/39633  |  Loss: 0.7249  |  Score: 68.50 [%]  |  Seq Length: 256.0
[2024-09-20 04:51:12,377][root][INFO] - Step: 29600/39633  |  Loss: 0.7257  |  Score: 68.26 [%]  |  Seq Length: 256.0
[2024-09-20 04:53:56,506][root][INFO] - Step: 30000/39633  |  Loss: 0.7290  |  Score: 68.13 [%]  |  Seq Length: 256.0
[2024-09-20 04:56:40,604][root][INFO] - Step: 30400/39633  |  Loss: 0.7153  |  Score: 69.06 [%]  |  Seq Length: 256.0
[2024-09-20 04:59:24,910][root][INFO] - Step: 30800/39633  |  Loss: 0.7140  |  Score: 69.21 [%]  |  Seq Length: 256.0
[2024-09-20 05:02:09,091][root][INFO] - Step: 31200/39633  |  Loss: 0.7143  |  Score: 68.90 [%]  |  Seq Length: 256.0
[2024-09-20 05:04:53,220][root][INFO] - Step: 31600/39633  |  Loss: 0.7040  |  Score: 69.72 [%]  |  Seq Length: 256.0
[2024-09-20 05:07:37,393][root][INFO] - Step: 32000/39633  |  Loss: 0.7084  |  Score: 69.48 [%]  |  Seq Length: 256.0
[2024-09-20 05:10:21,574][root][INFO] - Step: 32400/39633  |  Loss: 0.7027  |  Score: 69.75 [%]  |  Seq Length: 256.0
[2024-09-20 05:13:05,948][root][INFO] - Step: 32800/39633  |  Loss: 0.7008  |  Score: 69.90 [%]  |  Seq Length: 256.0
[2024-09-20 05:15:50,039][root][INFO] - Step: 33200/39633  |  Loss: 0.6951  |  Score: 69.88 [%]  |  Seq Length: 256.0
[2024-09-20 05:18:34,248][root][INFO] - Step: 33600/39633  |  Loss: 0.6963  |  Score: 70.26 [%]  |  Seq Length: 256.0
[2024-09-20 05:21:18,251][root][INFO] - Step: 34000/39633  |  Loss: 0.6998  |  Score: 69.78 [%]  |  Seq Length: 256.0
[2024-09-20 05:24:02,378][root][INFO] - Step: 34400/39633  |  Loss: 0.6871  |  Score: 70.22 [%]  |  Seq Length: 256.0
[2024-09-20 05:26:46,191][root][INFO] - Step: 34800/39633  |  Loss: 0.6886  |  Score: 70.43 [%]  |  Seq Length: 256.0
[2024-09-20 05:29:30,216][root][INFO] - Step: 35200/39633  |  Loss: 0.6850  |  Score: 71.00 [%]  |  Seq Length: 256.0
[2024-09-20 05:32:14,182][root][INFO] - Step: 35600/39633  |  Loss: 0.6889  |  Score: 70.65 [%]  |  Seq Length: 256.0
[2024-09-20 05:34:58,183][root][INFO] - Step: 36000/39633  |  Loss: 0.6790  |  Score: 71.00 [%]  |  Seq Length: 256.0
[2024-09-20 05:37:42,241][root][INFO] - Step: 36400/39633  |  Loss: 0.6825  |  Score: 70.62 [%]  |  Seq Length: 256.0
[2024-09-20 05:40:26,060][root][INFO] - Step: 36800/39633  |  Loss: 0.6816  |  Score: 70.83 [%]  |  Seq Length: 256.0
[2024-09-20 05:43:09,989][root][INFO] - Step: 37200/39633  |  Loss: 0.6783  |  Score: 71.13 [%]  |  Seq Length: 256.0
[2024-09-20 05:45:53,901][root][INFO] - Step: 37600/39633  |  Loss: 0.6798  |  Score: 71.05 [%]  |  Seq Length: 256.0
[2024-09-20 05:48:38,084][root][INFO] - Step: 38000/39633  |  Loss: 0.6756  |  Score: 71.05 [%]  |  Seq Length: 256.0
[2024-09-20 05:51:22,217][root][INFO] - Step: 38400/39633  |  Loss: 0.6849  |  Score: 70.38 [%]  |  Seq Length: 256.0
[2024-09-20 05:54:06,235][root][INFO] - Step: 38800/39633  |  Loss: 0.6809  |  Score: 70.70 [%]  |  Seq Length: 256.0
[2024-09-20 05:56:50,294][root][INFO] - Step: 39200/39633  |  Loss: 0.6797  |  Score: 70.58 [%]  |  Seq Length: 256.0
[2024-09-20 05:59:34,205][root][INFO] - Step: 39600/39633  |  Loss: 0.6929  |  Score: 70.42 [%]  |  Seq Length: 256.0
[2024-09-20 05:59:47,822][root][INFO] - Step: 39633/39633  |  Loss: 0.6657  |  Score: 71.78 [%]  |  Seq Length: 256.0
[2024-09-20 05:59:53,397][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-20 05:59:53,397][root][INFO] - Score: 66.11 [%]  |  Evaluation Time: 5.57 [s]
[2024-09-20 06:00:03,535][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-20 06:00:03,535][root][INFO] - Score: 67.15 [%]  |  Evaluation Time: 10.14 [s]
[2024-09-20 06:00:03,536][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-20 06:00:03,536][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-20 06:00:03,536][root][INFO] - - Epoch: 3
[2024-09-20 06:00:03,536][root][INFO] - - DEV score: 66.11 [%]
[2024-09-20 06:00:03,536][root][INFO] - - TEST score: 67.15 [%]
[2024-09-20 06:00:03,537][root][INFO] - Fine-tuning is done!
[2024-09-20 15:35:14,446][root][INFO] - 

[2024-09-20 15:35:14,446][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-20 15:35:14,446][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs
[2024-09-20 15:35:14,446][root][INFO] - 

[2024-09-20 15:35:14,446][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 4, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-20 15:37:39,735][root][INFO] - 

[2024-09-20 15:37:39,736][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-20 15:37:39,736][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs
[2024-09-20 15:37:39,736][root][INFO] - 

[2024-09-20 15:37:39,736][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 4, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-20 15:37:49,450][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-20 15:37:49,450][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-20 15:37:49,451][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-20 15:37:49,451][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-20 15:37:49,452][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-20 15:37:49,452][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-20 15:37:49,453][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-20 15:37:49,453][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-20 15:37:49,453][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-20 15:37:49,454][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-20 15:37:49,454][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-20 15:37:49,455][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-20 15:37:49,455][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-20 15:37:49,455][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-20 15:37:49,456][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-20 15:37:49,456][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-20 15:37:49,457][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-20 15:37:49,457][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-20 15:37:49,458][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-20 15:37:49,458][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-20 15:37:49,458][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-20 15:37:49,459][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-20 15:37:49,459][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-20 15:37:49,460][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-20 15:37:49,461][root][INFO] - Trainable params: 1769472 || all params: 126935808 || trainable: 1.39 %
[2024-09-20 15:37:49,835][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-20 15:37:56,447][root][INFO] - 

[2024-09-20 15:37:56,447][root][INFO] - ========== Fine-tuning on KorNLI ==========
[2024-09-20 15:37:56,448][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-20 15:37:56,457][root][INFO] - vocab size              : 51200
[2024-09-20 15:37:56,458][root][INFO] - device                  : gpu
[2024-09-20 15:37:56,458][root][INFO] - random seed             : 42
[2024-09-20 15:37:56,458][root][INFO] - train data size         : 211376
[2024-09-20 15:37:56,458][root][INFO] - max epochs              : 3
[2024-09-20 15:37:56,458][root][INFO] - total steps             : 39633
[2024-09-20 15:37:56,458][root][INFO] - warmup steps            : 3963
[2024-09-20 15:37:56,458][root][INFO] - batch size              : 64
[2024-09-20 15:37:56,458][root][INFO] - accumulation steps      : 4
[2024-09-20 15:37:56,458][root][INFO] - optimizer               : adamwscale
[2024-09-20 15:37:56,458][root][INFO] - lr_scheduler            : cosine
[2024-09-20 15:37:56,459][root][INFO] - learning rate           : 0.01
[2024-09-20 15:37:56,459][root][INFO] - max length              : 256

[2024-09-20 15:37:56,459][root][INFO] - LoRA Configuration
[2024-09-20 15:37:56,459][root][INFO] - ㄴ r                    : 32
[2024-09-20 15:37:56,459][root][INFO] - ㄴ alpha                : 128
[2024-09-20 15:37:56,459][root][INFO] - ㄴ dropout              : 0.03

[2024-09-20 15:37:56,459][root][INFO] - 

[2024-09-20 15:37:56,459][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs
[2024-09-20 15:37:56,459][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs/ckpt
[2024-09-20 15:37:56,459][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs/tb
[2024-09-20 15:37:56,459][root][INFO] - * tb interval           : 400

[2024-09-20 15:37:56,460][root][INFO] - 

[2024-09-20 15:37:56,460][root][INFO] - Start the Training !
[2024-09-20 15:37:56,463][root][INFO] - 
[1/ 3 Epoch]
[2024-09-20 15:38:24,440][root][INFO] - 

[2024-09-20 15:38:24,441][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-20 15:38:24,441][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_4s_0.0001lr_42rs
[2024-09-20 15:38:24,441][root][INFO] - 

[2024-09-20 15:38:24,441][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.0001, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 4, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_4s_0.0001lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_4s_0.0001lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_4s_0.0001lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-20 15:38:52,329][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-20 15:38:58,425][root][INFO] - 

[2024-09-20 15:38:58,425][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-20 15:38:58,426][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-20 15:38:58,434][root][INFO] - vocab size              : 51200
[2024-09-20 15:38:58,434][root][INFO] - device                  : gpu
[2024-09-20 15:38:58,434][root][INFO] - random seed             : 42
[2024-09-20 15:38:58,434][root][INFO] - train data size         : 28864
[2024-09-20 15:38:58,434][root][INFO] - max epochs              : 5
[2024-09-20 15:38:58,434][root][INFO] - total steps             : 9020
[2024-09-20 15:38:58,434][root][INFO] - warmup steps            : 902
[2024-09-20 15:38:58,435][root][INFO] - batch size              : 64
[2024-09-20 15:38:58,435][root][INFO] - accumulation steps      : 4
[2024-09-20 15:38:58,435][root][INFO] - optimizer               : adamwscale
[2024-09-20 15:38:58,435][root][INFO] - lr_scheduler            : cosine
[2024-09-20 15:38:58,435][root][INFO] - learning rate           : 0.0001
[2024-09-20 15:38:58,435][root][INFO] - max length              : 256

[2024-09-20 15:38:58,435][root][INFO] - 

[2024-09-20 15:38:58,435][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_4s_0.0001lr_42rs
[2024-09-20 15:38:58,435][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_4s_0.0001lr_42rs/ckpt
[2024-09-20 15:38:58,435][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_4s_0.0001lr_42rs/tb
[2024-09-20 15:38:58,435][root][INFO] - * tb interval           : 100

[2024-09-20 15:38:58,435][root][INFO] - 

[2024-09-20 15:38:58,436][root][INFO] - Start the Training !
[2024-09-20 15:38:58,438][root][INFO] - 
[1/ 5 Epoch]
[2024-09-20 15:39:53,907][root][INFO] - 

[2024-09-20 15:39:53,907][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-20 15:39:53,907][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_8s_0.0001lr_42rs
[2024-09-20 15:39:53,907][root][INFO] - 

[2024-09-20 15:39:53,908][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.0001, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 8, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_8s_0.0001lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_8s_0.0001lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_8s_0.0001lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-20 15:40:14,434][root][INFO] - 

[2024-09-20 15:40:14,434][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-20 15:40:14,434][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.0001lr_42rs
[2024-09-20 15:40:14,434][root][INFO] - 

[2024-09-20 15:40:14,435][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.0001, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 4, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.0001lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.0001lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.0001lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-20 15:40:16,689][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-20 15:40:16,690][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-20 15:40:16,690][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-20 15:40:16,691][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-20 15:40:16,691][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-20 15:40:16,691][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-20 15:40:16,692][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-20 15:40:16,692][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-20 15:40:16,693][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-20 15:40:16,693][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-20 15:40:16,694][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-20 15:40:16,694][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-20 15:40:16,695][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-20 15:40:16,695][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-20 15:40:16,696][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-20 15:40:16,696][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-20 15:40:16,697][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-20 15:40:16,698][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-20 15:40:16,698][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-20 15:40:16,698][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-20 15:40:16,699][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-20 15:40:16,700][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-20 15:40:16,700][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-20 15:40:16,701][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-20 15:40:16,702][root][INFO] - Trainable params: 1769472 || all params: 126935808 || trainable: 1.39 %
[2024-09-20 15:40:16,708][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-20 15:40:16,816][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-20 15:40:16,818][root][INFO] - Trainable params: 8985600 || all params: 134151936 || trainable: 6.70 %
[2024-09-20 15:40:17,139][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-20 15:40:24,662][root][INFO] - 

[2024-09-20 15:40:24,662][root][INFO] - ========== Fine-tuning on KorNLI ==========
[2024-09-20 15:40:24,663][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-20 15:40:24,673][root][INFO] - vocab size              : 51200
[2024-09-20 15:40:24,673][root][INFO] - device                  : gpu
[2024-09-20 15:40:24,673][root][INFO] - random seed             : 42
[2024-09-20 15:40:24,673][root][INFO] - train data size         : 211376
[2024-09-20 15:40:24,673][root][INFO] - max epochs              : 3
[2024-09-20 15:40:24,673][root][INFO] - total steps             : 39633
[2024-09-20 15:40:24,673][root][INFO] - warmup steps            : 3963
[2024-09-20 15:40:24,673][root][INFO] - batch size              : 64
[2024-09-20 15:40:24,673][root][INFO] - accumulation steps      : 4
[2024-09-20 15:40:24,673][root][INFO] - optimizer               : adamwscale
[2024-09-20 15:40:24,674][root][INFO] - lr_scheduler            : cosine
[2024-09-20 15:40:24,674][root][INFO] - learning rate           : 0.01
[2024-09-20 15:40:24,674][root][INFO] - max length              : 256

[2024-09-20 15:40:24,674][root][INFO] - LoRA Configuration
[2024-09-20 15:40:24,674][root][INFO] - ㄴ r                    : 32
[2024-09-20 15:40:24,674][root][INFO] - ㄴ alpha                : 128
[2024-09-20 15:40:24,674][root][INFO] - ㄴ dropout              : 0.03

[2024-09-20 15:40:24,674][root][INFO] - KOMBO Configuration
[2024-09-20 15:40:24,674][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-20 15:40:24,674][root][INFO] - ㄴ reducer              : linear
[2024-09-20 15:40:24,674][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-20 15:40:24,675][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-20 15:40:24,675][root][INFO] - ㄴ do_combination       : True
[2024-09-20 15:40:24,675][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-20 15:40:24,675][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-20 15:40:24,675][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-20 15:40:24,675][root][INFO] -   ㄴ add_lora           : False
[2024-09-20 15:40:24,675][root][INFO] - 

[2024-09-20 15:40:24,675][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs
[2024-09-20 15:40:24,675][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs/ckpt
[2024-09-20 15:40:24,675][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs/tb
[2024-09-20 15:40:24,676][root][INFO] - * tb interval           : 400

[2024-09-20 15:40:24,676][root][INFO] - 

[2024-09-20 15:40:24,676][root][INFO] - Start the Training !
[2024-09-20 15:40:24,679][root][INFO] - 
[1/ 3 Epoch]
[2024-09-20 15:43:37,830][root][INFO] - 

[2024-09-20 15:43:37,830][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-20 15:43:37,830][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs
[2024-09-20 15:43:37,830][root][INFO] - 

[2024-09-20 15:43:37,830][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 2, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-20 15:45:41,195][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-20 15:45:41,196][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-20 15:45:41,197][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-20 15:45:41,197][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-20 15:45:41,198][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-20 15:45:41,199][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-20 15:45:41,199][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-20 15:45:41,200][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-20 15:45:41,201][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-20 15:45:41,201][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-20 15:45:41,202][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-20 15:45:41,203][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-20 15:45:41,203][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-20 15:45:41,204][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-20 15:45:41,205][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-20 15:45:41,205][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-20 15:45:41,206][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-20 15:45:41,207][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-20 15:45:41,207][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-20 15:45:41,208][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-20 15:45:41,209][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-20 15:45:41,210][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-20 15:45:41,210][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-20 15:45:41,211][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-20 15:45:41,213][root][INFO] - Trainable params: 1769472 || all params: 126935808 || trainable: 1.39 %
[2024-09-20 15:45:41,219][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-20 15:45:41,326][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-20 15:45:41,328][root][INFO] - Trainable params: 8985600 || all params: 134151936 || trainable: 6.70 %
[2024-09-20 15:45:41,848][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-20 15:45:49,393][root][INFO] - 

[2024-09-20 15:45:49,393][root][INFO] - ========== Fine-tuning on KorNLI ==========
[2024-09-20 15:45:49,393][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-20 15:45:49,401][root][INFO] - vocab size              : 51200
[2024-09-20 15:45:49,401][root][INFO] - device                  : gpu
[2024-09-20 15:45:49,401][root][INFO] - random seed             : 42
[2024-09-20 15:45:49,402][root][INFO] - train data size         : 422752
[2024-09-20 15:45:49,402][root][INFO] - max epochs              : 3
[2024-09-20 15:45:49,402][root][INFO] - total steps             : 39633
[2024-09-20 15:45:49,402][root][INFO] - warmup steps            : 3963
[2024-09-20 15:45:49,402][root][INFO] - batch size              : 64
[2024-09-20 15:45:49,402][root][INFO] - accumulation steps      : 2
[2024-09-20 15:45:49,402][root][INFO] - optimizer               : adamwscale
[2024-09-20 15:45:49,402][root][INFO] - lr_scheduler            : cosine
[2024-09-20 15:45:49,402][root][INFO] - learning rate           : 0.01
[2024-09-20 15:45:49,402][root][INFO] - max length              : 256

[2024-09-20 15:45:49,402][root][INFO] - LoRA Configuration
[2024-09-20 15:45:49,403][root][INFO] - ㄴ r                    : 32
[2024-09-20 15:45:49,403][root][INFO] - ㄴ alpha                : 128
[2024-09-20 15:45:49,403][root][INFO] - ㄴ dropout              : 0.03

[2024-09-20 15:45:49,403][root][INFO] - KOMBO Configuration
[2024-09-20 15:45:49,403][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-20 15:45:49,403][root][INFO] - ㄴ reducer              : linear
[2024-09-20 15:45:49,403][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-20 15:45:49,403][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-20 15:45:49,403][root][INFO] - ㄴ do_combination       : True
[2024-09-20 15:45:49,403][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-20 15:45:49,404][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-20 15:45:49,404][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-20 15:45:49,404][root][INFO] -   ㄴ add_lora           : False
[2024-09-20 15:45:49,404][root][INFO] - 

[2024-09-20 15:45:49,404][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs
[2024-09-20 15:45:49,404][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/ckpt
[2024-09-20 15:45:49,404][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/tb
[2024-09-20 15:45:49,404][root][INFO] - * tb interval           : 400

[2024-09-20 15:45:49,404][root][INFO] - 

[2024-09-20 15:45:49,404][root][INFO] - Start the Training !
[2024-09-20 15:45:49,407][root][INFO] - 
[1/ 3 Epoch]
[2024-09-20 15:49:40,071][root][INFO] - Step: 400/39633  |  Loss: 0.9909  |  Score: 49.91 [%]  |  Seq Length: 256.0
[2024-09-20 15:53:29,251][root][INFO] - Step: 800/39633  |  Loss: 0.8547  |  Score: 61.30 [%]  |  Seq Length: 256.0
[2024-09-20 15:57:19,249][root][INFO] - Step: 1200/39633  |  Loss: 0.8124  |  Score: 63.97 [%]  |  Seq Length: 256.0
[2024-09-20 16:01:09,510][root][INFO] - Step: 1600/39633  |  Loss: 0.7795  |  Score: 65.90 [%]  |  Seq Length: 256.0
[2024-09-20 16:04:59,270][root][INFO] - Step: 2000/39633  |  Loss: 0.7639  |  Score: 66.91 [%]  |  Seq Length: 256.0
[2024-09-20 16:08:47,954][root][INFO] - Step: 2400/39633  |  Loss: 0.7437  |  Score: 67.61 [%]  |  Seq Length: 256.0
[2024-09-20 16:12:36,422][root][INFO] - Step: 2800/39633  |  Loss: 0.7395  |  Score: 68.15 [%]  |  Seq Length: 256.0
[2024-09-20 16:16:24,676][root][INFO] - Step: 3200/39633  |  Loss: 0.7348  |  Score: 68.29 [%]  |  Seq Length: 256.0
[2024-09-20 16:20:12,495][root][INFO] - Step: 3600/39633  |  Loss: 0.7153  |  Score: 69.62 [%]  |  Seq Length: 256.0
[2024-09-20 16:24:00,940][root][INFO] - Step: 4000/39633  |  Loss: 0.7087  |  Score: 69.56 [%]  |  Seq Length: 256.0
[2024-09-20 16:27:49,823][root][INFO] - Step: 4400/39633  |  Loss: 0.7117  |  Score: 69.73 [%]  |  Seq Length: 256.0
[2024-09-20 16:31:37,976][root][INFO] - Step: 4800/39633  |  Loss: 0.6993  |  Score: 70.09 [%]  |  Seq Length: 256.0
[2024-09-20 16:35:26,485][root][INFO] - Step: 5200/39633  |  Loss: 0.6967  |  Score: 70.45 [%]  |  Seq Length: 256.0
[2024-09-20 16:39:14,610][root][INFO] - Step: 5600/39633  |  Loss: 0.6924  |  Score: 70.92 [%]  |  Seq Length: 256.0
[2024-09-20 16:43:03,247][root][INFO] - Step: 6000/39633  |  Loss: 0.6778  |  Score: 71.41 [%]  |  Seq Length: 256.0
[2024-09-20 16:46:51,632][root][INFO] - Step: 6400/39633  |  Loss: 0.6731  |  Score: 71.46 [%]  |  Seq Length: 256.0
[2024-09-20 16:50:39,643][root][INFO] - Step: 6800/39633  |  Loss: 0.6684  |  Score: 71.92 [%]  |  Seq Length: 256.0
[2024-09-20 16:54:28,377][root][INFO] - Step: 7200/39633  |  Loss: 0.6644  |  Score: 72.19 [%]  |  Seq Length: 256.0
[2024-09-20 16:58:16,820][root][INFO] - Step: 7600/39633  |  Loss: 0.6694  |  Score: 71.67 [%]  |  Seq Length: 256.0
[2024-09-20 17:02:06,516][root][INFO] - Step: 8000/39633  |  Loss: 0.6708  |  Score: 71.71 [%]  |  Seq Length: 256.0
[2024-09-20 17:05:54,688][root][INFO] - Step: 8400/39633  |  Loss: 0.6598  |  Score: 72.10 [%]  |  Seq Length: 256.0
[2024-09-20 17:09:43,312][root][INFO] - Step: 8800/39633  |  Loss: 0.6755  |  Score: 71.41 [%]  |  Seq Length: 256.0
[2024-09-20 17:13:32,075][root][INFO] - Step: 9200/39633  |  Loss: 0.6558  |  Score: 72.20 [%]  |  Seq Length: 256.0
[2024-09-20 17:17:20,879][root][INFO] - Step: 9600/39633  |  Loss: 0.6523  |  Score: 72.46 [%]  |  Seq Length: 256.0
[2024-09-20 17:21:09,380][root][INFO] - Step: 10000/39633  |  Loss: 0.6514  |  Score: 72.86 [%]  |  Seq Length: 256.0
[2024-09-20 17:24:59,237][root][INFO] - Step: 10400/39633  |  Loss: 0.6411  |  Score: 73.09 [%]  |  Seq Length: 256.0
[2024-09-20 17:28:48,412][root][INFO] - Step: 10800/39633  |  Loss: 0.6417  |  Score: 73.30 [%]  |  Seq Length: 256.0
[2024-09-20 17:32:37,432][root][INFO] - Step: 11200/39633  |  Loss: 0.6495  |  Score: 72.86 [%]  |  Seq Length: 256.0
[2024-09-20 17:36:26,635][root][INFO] - Step: 11600/39633  |  Loss: 0.6456  |  Score: 73.27 [%]  |  Seq Length: 256.0
[2024-09-20 17:40:14,903][root][INFO] - Step: 12000/39633  |  Loss: 0.6459  |  Score: 73.17 [%]  |  Seq Length: 256.0
[2024-09-20 17:44:03,215][root][INFO] - Step: 12400/39633  |  Loss: 0.6400  |  Score: 73.46 [%]  |  Seq Length: 256.0
[2024-09-20 17:47:51,976][root][INFO] - Step: 12800/39633  |  Loss: 0.6414  |  Score: 73.21 [%]  |  Seq Length: 256.0
[2024-09-20 17:51:05,652][root][INFO] - 

[2024-09-20 17:51:05,652][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-20 17:51:05,652][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs
[2024-09-20 17:51:05,652][root][INFO] - 

[2024-09-20 17:51:05,652][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 4, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-20 17:51:31,707][root][INFO] - 

[2024-09-20 17:51:31,708][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-20 17:51:31,708][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs
[2024-09-20 17:51:31,708][root][INFO] - 

[2024-09-20 17:51:31,708][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 2, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-20 17:51:40,600][root][INFO] - Step: 13200/39633  |  Loss: 0.6371  |  Score: 73.43 [%]  |  Seq Length: 256.0
[2024-09-20 17:51:47,067][root][INFO] - Step: 13211/39633  |  Loss: 0.6631  |  Score: 71.16 [%]  |  Seq Length: 256.0
[2024-09-20 17:51:55,986][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-20 17:51:55,986][root][INFO] - Score: 69.95 [%]  |  Evaluation Time: 8.91 [s]
[2024-09-20 17:52:12,427][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-20 17:52:12,427][root][INFO] - Score: 70.62 [%]  |  Evaluation Time: 16.44 [s]
[2024-09-20 17:52:12,428][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-20 17:52:12,429][root][INFO] - 
[2/ 3 Epoch]
[2024-09-20 17:53:36,161][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-20 17:53:36,162][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-20 17:53:36,162][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-20 17:53:36,163][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-20 17:53:36,164][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-20 17:53:36,164][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-20 17:53:36,165][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-20 17:53:36,165][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-20 17:53:36,166][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-20 17:53:36,166][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-20 17:53:36,167][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-20 17:53:36,167][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-20 17:53:36,168][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-20 17:53:36,169][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-20 17:53:36,169][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-20 17:53:36,170][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-20 17:53:36,170][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-20 17:53:36,171][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-20 17:53:36,171][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-20 17:53:36,172][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-20 17:53:36,173][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-20 17:53:36,173][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-20 17:53:36,174][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-20 17:53:36,174][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-20 17:53:36,176][root][INFO] - Trainable params: 1769472 || all params: 126935808 || trainable: 1.39 %
[2024-09-20 17:53:36,606][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-20 17:53:40,698][root][INFO] - 

[2024-09-20 17:53:40,699][root][INFO] - ========== Fine-tuning on KorNLI ==========
[2024-09-20 17:53:40,699][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-20 17:53:40,706][root][INFO] - vocab size              : 51200
[2024-09-20 17:53:40,707][root][INFO] - device                  : gpu
[2024-09-20 17:53:40,707][root][INFO] - random seed             : 42
[2024-09-20 17:53:40,707][root][INFO] - train data size         : 422752
[2024-09-20 17:53:40,707][root][INFO] - max epochs              : 3
[2024-09-20 17:53:40,707][root][INFO] - total steps             : 39633
[2024-09-20 17:53:40,707][root][INFO] - warmup steps            : 3963
[2024-09-20 17:53:40,707][root][INFO] - batch size              : 64
[2024-09-20 17:53:40,707][root][INFO] - accumulation steps      : 2
[2024-09-20 17:53:40,707][root][INFO] - optimizer               : adamwscale
[2024-09-20 17:53:40,707][root][INFO] - lr_scheduler            : cosine
[2024-09-20 17:53:40,707][root][INFO] - learning rate           : 0.01
[2024-09-20 17:53:40,708][root][INFO] - max length              : 256

[2024-09-20 17:53:40,708][root][INFO] - LoRA Configuration
[2024-09-20 17:53:40,708][root][INFO] - ㄴ r                    : 32
[2024-09-20 17:53:40,708][root][INFO] - ㄴ alpha                : 128
[2024-09-20 17:53:40,708][root][INFO] - ㄴ dropout              : 0.03

[2024-09-20 17:53:40,708][root][INFO] - 

[2024-09-20 17:53:40,708][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs
[2024-09-20 17:53:40,708][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/ckpt
[2024-09-20 17:53:40,708][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/tb
[2024-09-20 17:53:40,708][root][INFO] - * tb interval           : 400

[2024-09-20 17:53:40,708][root][INFO] - 

[2024-09-20 17:53:40,708][root][INFO] - Start the Training !
[2024-09-20 17:53:40,711][root][INFO] - 
[1/ 3 Epoch]
[2024-09-20 17:55:55,805][root][INFO] - Step: 13600/39633  |  Loss: 0.6066  |  Score: 75.40 [%]  |  Seq Length: 256.0
[2024-09-20 17:56:18,215][root][INFO] - Step: 400/39633  |  Loss: 0.9893  |  Score: 49.87 [%]  |  Seq Length: 256.0
[2024-09-20 17:58:52,926][root][INFO] - Step: 800/39633  |  Loss: 0.8463  |  Score: 61.90 [%]  |  Seq Length: 256.0
[2024-09-20 17:59:44,350][root][INFO] - Step: 14000/39633  |  Loss: 0.6092  |  Score: 74.68 [%]  |  Seq Length: 256.0
[2024-09-20 18:01:26,955][root][INFO] - Step: 1200/39633  |  Loss: 0.8028  |  Score: 64.42 [%]  |  Seq Length: 256.0
[2024-09-20 18:03:33,118][root][INFO] - Step: 14400/39633  |  Loss: 0.6230  |  Score: 74.20 [%]  |  Seq Length: 256.0
[2024-09-20 18:04:00,937][root][INFO] - Step: 1600/39633  |  Loss: 0.7852  |  Score: 65.62 [%]  |  Seq Length: 256.0
[2024-09-20 18:06:34,791][root][INFO] - Step: 2000/39633  |  Loss: 0.7646  |  Score: 66.96 [%]  |  Seq Length: 256.0
[2024-09-20 18:07:21,528][root][INFO] - Step: 14800/39633  |  Loss: 0.6150  |  Score: 74.68 [%]  |  Seq Length: 256.0
[2024-09-20 18:09:08,802][root][INFO] - Step: 2400/39633  |  Loss: 0.7484  |  Score: 67.52 [%]  |  Seq Length: 256.0
[2024-09-20 18:11:10,043][root][INFO] - Step: 15200/39633  |  Loss: 0.6124  |  Score: 74.47 [%]  |  Seq Length: 256.0
[2024-09-20 18:11:42,728][root][INFO] - Step: 2800/39633  |  Loss: 0.7329  |  Score: 68.04 [%]  |  Seq Length: 256.0
[2024-09-20 18:14:16,836][root][INFO] - Step: 3200/39633  |  Loss: 0.7344  |  Score: 68.72 [%]  |  Seq Length: 256.0
[2024-09-20 18:14:59,285][root][INFO] - Step: 15600/39633  |  Loss: 0.6103  |  Score: 74.82 [%]  |  Seq Length: 256.0
[2024-09-20 18:16:50,833][root][INFO] - Step: 3600/39633  |  Loss: 0.7124  |  Score: 69.69 [%]  |  Seq Length: 256.0
[2024-09-20 18:18:47,328][root][INFO] - Step: 16000/39633  |  Loss: 0.6001  |  Score: 75.41 [%]  |  Seq Length: 256.0
[2024-09-20 18:19:24,791][root][INFO] - Step: 4000/39633  |  Loss: 0.7018  |  Score: 70.12 [%]  |  Seq Length: 256.0
[2024-09-20 18:21:58,835][root][INFO] - Step: 4400/39633  |  Loss: 0.7123  |  Score: 69.73 [%]  |  Seq Length: 256.0
[2024-09-20 18:22:35,302][root][INFO] - Step: 16400/39633  |  Loss: 0.6000  |  Score: 75.28 [%]  |  Seq Length: 256.0
[2024-09-20 18:24:32,770][root][INFO] - Step: 4800/39633  |  Loss: 0.6975  |  Score: 70.57 [%]  |  Seq Length: 256.0
[2024-09-20 18:26:23,765][root][INFO] - Step: 16800/39633  |  Loss: 0.6086  |  Score: 74.89 [%]  |  Seq Length: 256.0
[2024-09-20 18:27:06,700][root][INFO] - Step: 5200/39633  |  Loss: 0.6966  |  Score: 70.54 [%]  |  Seq Length: 256.0
[2024-09-20 18:29:40,803][root][INFO] - Step: 5600/39633  |  Loss: 0.6751  |  Score: 71.36 [%]  |  Seq Length: 256.0
[2024-09-20 18:30:12,015][root][INFO] - Step: 17200/39633  |  Loss: 0.5982  |  Score: 75.58 [%]  |  Seq Length: 256.0
[2024-09-20 18:32:14,938][root][INFO] - Step: 6000/39633  |  Loss: 0.6830  |  Score: 71.39 [%]  |  Seq Length: 256.0
[2024-09-20 18:34:00,326][root][INFO] - Step: 17600/39633  |  Loss: 0.6026  |  Score: 75.12 [%]  |  Seq Length: 256.0
[2024-09-20 18:34:49,056][root][INFO] - Step: 6400/39633  |  Loss: 0.6785  |  Score: 71.46 [%]  |  Seq Length: 256.0
[2024-09-20 18:37:23,281][root][INFO] - Step: 6800/39633  |  Loss: 0.6698  |  Score: 71.76 [%]  |  Seq Length: 256.0
[2024-09-20 18:37:49,015][root][INFO] - Step: 18000/39633  |  Loss: 0.6000  |  Score: 75.41 [%]  |  Seq Length: 256.0
[2024-09-20 18:39:57,430][root][INFO] - Step: 7200/39633  |  Loss: 0.6798  |  Score: 71.37 [%]  |  Seq Length: 256.0
[2024-09-20 18:41:38,457][root][INFO] - Step: 18400/39633  |  Loss: 0.5971  |  Score: 75.79 [%]  |  Seq Length: 256.0
[2024-09-20 18:42:31,467][root][INFO] - Step: 7600/39633  |  Loss: 0.6704  |  Score: 71.79 [%]  |  Seq Length: 256.0
[2024-09-20 18:45:05,259][root][INFO] - Step: 8000/39633  |  Loss: 0.6697  |  Score: 71.84 [%]  |  Seq Length: 256.0
[2024-09-20 18:45:26,574][root][INFO] - Step: 18800/39633  |  Loss: 0.5907  |  Score: 75.90 [%]  |  Seq Length: 256.0
[2024-09-20 18:47:39,064][root][INFO] - Step: 8400/39633  |  Loss: 0.6789  |  Score: 71.35 [%]  |  Seq Length: 256.0
[2024-09-20 18:49:14,478][root][INFO] - Step: 19200/39633  |  Loss: 0.5921  |  Score: 75.71 [%]  |  Seq Length: 256.0
[2024-09-20 18:50:12,831][root][INFO] - Step: 8800/39633  |  Loss: 0.6630  |  Score: 72.40 [%]  |  Seq Length: 256.0
[2024-09-20 18:52:46,465][root][INFO] - Step: 9200/39633  |  Loss: 0.6588  |  Score: 72.41 [%]  |  Seq Length: 256.0
[2024-09-20 18:53:02,775][root][INFO] - Step: 19600/39633  |  Loss: 0.5955  |  Score: 75.58 [%]  |  Seq Length: 256.0
[2024-09-20 18:55:20,138][root][INFO] - Step: 9600/39633  |  Loss: 0.6590  |  Score: 72.07 [%]  |  Seq Length: 256.0
[2024-09-20 18:56:50,556][root][INFO] - Step: 20000/39633  |  Loss: 0.5992  |  Score: 75.13 [%]  |  Seq Length: 256.0
[2024-09-20 18:57:53,836][root][INFO] - Step: 10000/39633  |  Loss: 0.6551  |  Score: 72.48 [%]  |  Seq Length: 256.0
[2024-09-20 19:00:27,513][root][INFO] - Step: 10400/39633  |  Loss: 0.6550  |  Score: 72.65 [%]  |  Seq Length: 256.0
[2024-09-20 19:00:38,755][root][INFO] - Step: 20400/39633  |  Loss: 0.5935  |  Score: 75.68 [%]  |  Seq Length: 256.0
[2024-09-20 19:03:01,190][root][INFO] - Step: 10800/39633  |  Loss: 0.6490  |  Score: 72.77 [%]  |  Seq Length: 256.0
[2024-09-20 19:04:26,454][root][INFO] - Step: 20800/39633  |  Loss: 0.5872  |  Score: 75.71 [%]  |  Seq Length: 256.0
[2024-09-20 19:05:34,940][root][INFO] - Step: 11200/39633  |  Loss: 0.6465  |  Score: 73.01 [%]  |  Seq Length: 256.0
[2024-09-20 19:08:08,704][root][INFO] - Step: 11600/39633  |  Loss: 0.6447  |  Score: 73.30 [%]  |  Seq Length: 256.0
[2024-09-20 19:08:13,728][root][INFO] - Step: 21200/39633  |  Loss: 0.5952  |  Score: 75.51 [%]  |  Seq Length: 256.0
[2024-09-20 19:10:42,627][root][INFO] - Step: 12000/39633  |  Loss: 0.6428  |  Score: 73.49 [%]  |  Seq Length: 256.0
[2024-09-20 19:12:01,600][root][INFO] - Step: 21600/39633  |  Loss: 0.5911  |  Score: 76.21 [%]  |  Seq Length: 256.0
[2024-09-20 19:13:16,454][root][INFO] - Step: 12400/39633  |  Loss: 0.6404  |  Score: 73.26 [%]  |  Seq Length: 256.0
[2024-09-20 19:15:49,353][root][INFO] - Step: 22000/39633  |  Loss: 0.5819  |  Score: 76.26 [%]  |  Seq Length: 256.0
[2024-09-20 19:15:50,274][root][INFO] - Step: 12800/39633  |  Loss: 0.6384  |  Score: 73.63 [%]  |  Seq Length: 256.0
[2024-09-20 19:18:23,976][root][INFO] - Step: 13200/39633  |  Loss: 0.6387  |  Score: 73.64 [%]  |  Seq Length: 256.0
[2024-09-20 19:18:28,282][root][INFO] - Step: 13211/39633  |  Loss: 0.6513  |  Score: 73.82 [%]  |  Seq Length: 256.0
[2024-09-20 19:18:33,332][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-20 19:18:33,332][root][INFO] - Score: 72.16 [%]  |  Evaluation Time: 5.05 [s]
[2024-09-20 19:18:42,792][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-20 19:18:42,792][root][INFO] - Score: 71.43 [%]  |  Evaluation Time: 9.46 [s]
[2024-09-20 19:18:42,793][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-20 19:18:42,794][root][INFO] - 
[2/ 3 Epoch]
[2024-09-20 19:19:36,424][root][INFO] - Step: 22400/39633  |  Loss: 0.5789  |  Score: 76.21 [%]  |  Seq Length: 256.0
[2024-09-20 19:21:12,880][root][INFO] - Step: 13600/39633  |  Loss: 0.6213  |  Score: 74.24 [%]  |  Seq Length: 256.0
[2024-09-20 19:23:24,424][root][INFO] - Step: 22800/39633  |  Loss: 0.5763  |  Score: 76.36 [%]  |  Seq Length: 256.0
[2024-09-20 19:23:46,644][root][INFO] - Step: 14000/39633  |  Loss: 0.6103  |  Score: 74.63 [%]  |  Seq Length: 256.0
[2024-09-20 19:26:20,533][root][INFO] - Step: 14400/39633  |  Loss: 0.6158  |  Score: 74.68 [%]  |  Seq Length: 256.0
[2024-09-20 19:27:12,283][root][INFO] - Step: 23200/39633  |  Loss: 0.5813  |  Score: 76.12 [%]  |  Seq Length: 256.0
[2024-09-20 19:28:54,398][root][INFO] - Step: 14800/39633  |  Loss: 0.6157  |  Score: 74.59 [%]  |  Seq Length: 256.0
[2024-09-20 19:30:59,863][root][INFO] - Step: 23600/39633  |  Loss: 0.5775  |  Score: 76.40 [%]  |  Seq Length: 256.0
[2024-09-20 19:31:28,371][root][INFO] - Step: 15200/39633  |  Loss: 0.6177  |  Score: 74.53 [%]  |  Seq Length: 256.0
[2024-09-20 19:34:02,395][root][INFO] - Step: 15600/39633  |  Loss: 0.6142  |  Score: 74.70 [%]  |  Seq Length: 256.0
[2024-09-20 19:34:47,946][root][INFO] - Step: 24000/39633  |  Loss: 0.5748  |  Score: 76.12 [%]  |  Seq Length: 256.0
[2024-09-20 19:36:36,334][root][INFO] - Step: 16000/39633  |  Loss: 0.6189  |  Score: 74.38 [%]  |  Seq Length: 256.0
[2024-09-20 19:38:35,194][root][INFO] - Step: 24400/39633  |  Loss: 0.5749  |  Score: 76.92 [%]  |  Seq Length: 256.0
[2024-09-20 19:39:10,306][root][INFO] - Step: 16400/39633  |  Loss: 0.6148  |  Score: 74.61 [%]  |  Seq Length: 256.0
[2024-09-20 19:41:44,313][root][INFO] - Step: 16800/39633  |  Loss: 0.6119  |  Score: 74.83 [%]  |  Seq Length: 256.0
[2024-09-20 19:42:23,862][root][INFO] - Step: 24800/39633  |  Loss: 0.5753  |  Score: 76.61 [%]  |  Seq Length: 256.0
[2024-09-20 19:44:18,320][root][INFO] - Step: 17200/39633  |  Loss: 0.6110  |  Score: 74.90 [%]  |  Seq Length: 256.0
[2024-09-20 19:46:12,182][root][INFO] - Step: 25200/39633  |  Loss: 0.5718  |  Score: 76.71 [%]  |  Seq Length: 256.0
[2024-09-20 19:46:52,364][root][INFO] - Step: 17600/39633  |  Loss: 0.6017  |  Score: 75.15 [%]  |  Seq Length: 256.0
[2024-09-20 19:49:26,464][root][INFO] - Step: 18000/39633  |  Loss: 0.6116  |  Score: 74.92 [%]  |  Seq Length: 256.0
[2024-09-20 19:50:00,343][root][INFO] - Step: 25600/39633  |  Loss: 0.5791  |  Score: 76.44 [%]  |  Seq Length: 256.0
[2024-09-20 19:52:00,446][root][INFO] - Step: 18400/39633  |  Loss: 0.6007  |  Score: 75.35 [%]  |  Seq Length: 256.0
[2024-09-20 19:53:48,547][root][INFO] - Step: 26000/39633  |  Loss: 0.5706  |  Score: 76.99 [%]  |  Seq Length: 256.0
[2024-09-20 19:54:34,311][root][INFO] - Step: 18800/39633  |  Loss: 0.6029  |  Score: 75.00 [%]  |  Seq Length: 256.0
[2024-09-20 19:57:08,320][root][INFO] - Step: 19200/39633  |  Loss: 0.6003  |  Score: 75.38 [%]  |  Seq Length: 256.0
[2024-09-20 19:57:36,380][root][INFO] - Step: 26400/39633  |  Loss: 0.5669  |  Score: 77.08 [%]  |  Seq Length: 256.0
[2024-09-20 19:57:49,007][root][INFO] - Step: 26422/39633  |  Loss: 0.5529  |  Score: 78.48 [%]  |  Seq Length: 256.0
[2024-09-20 19:57:57,658][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-20 19:57:57,658][root][INFO] - Score: 73.03 [%]  |  Evaluation Time: 8.65 [s]
[2024-09-20 19:58:14,298][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-20 19:58:14,298][root][INFO] - Score: 73.59 [%]  |  Evaluation Time: 16.64 [s]
[2024-09-20 19:58:14,301][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-20 19:58:14,304][root][INFO] - 
[3/ 3 Epoch]
[2024-09-20 19:59:42,347][root][INFO] - Step: 19600/39633  |  Loss: 0.6009  |  Score: 75.20 [%]  |  Seq Length: 256.0
[2024-09-20 20:01:49,928][root][INFO] - Step: 26800/39633  |  Loss: 0.5312  |  Score: 78.50 [%]  |  Seq Length: 256.0
[2024-09-20 20:02:16,379][root][INFO] - Step: 20000/39633  |  Loss: 0.6025  |  Score: 74.77 [%]  |  Seq Length: 256.0
[2024-09-20 20:04:50,414][root][INFO] - Step: 20400/39633  |  Loss: 0.5896  |  Score: 75.63 [%]  |  Seq Length: 256.0
[2024-09-20 20:05:38,048][root][INFO] - Step: 27200/39633  |  Loss: 0.5358  |  Score: 78.44 [%]  |  Seq Length: 256.0
[2024-09-20 20:07:24,469][root][INFO] - Step: 20800/39633  |  Loss: 0.5990  |  Score: 75.50 [%]  |  Seq Length: 256.0
[2024-09-20 20:09:25,636][root][INFO] - Step: 27600/39633  |  Loss: 0.5448  |  Score: 77.60 [%]  |  Seq Length: 256.0
[2024-09-20 20:09:58,491][root][INFO] - Step: 21200/39633  |  Loss: 0.5969  |  Score: 75.51 [%]  |  Seq Length: 256.0
[2024-09-20 20:12:32,598][root][INFO] - Step: 21600/39633  |  Loss: 0.5901  |  Score: 75.84 [%]  |  Seq Length: 256.0
[2024-09-20 20:13:14,012][root][INFO] - Step: 28000/39633  |  Loss: 0.5310  |  Score: 78.51 [%]  |  Seq Length: 256.0
[2024-09-20 20:15:06,637][root][INFO] - Step: 22000/39633  |  Loss: 0.5918  |  Score: 75.66 [%]  |  Seq Length: 256.0
[2024-09-20 20:17:02,364][root][INFO] - Step: 28400/39633  |  Loss: 0.5313  |  Score: 78.39 [%]  |  Seq Length: 256.0
[2024-09-20 20:17:40,766][root][INFO] - Step: 22400/39633  |  Loss: 0.5835  |  Score: 76.23 [%]  |  Seq Length: 256.0
[2024-09-20 20:20:14,711][root][INFO] - Step: 22800/39633  |  Loss: 0.5968  |  Score: 75.48 [%]  |  Seq Length: 256.0
[2024-09-20 20:20:50,987][root][INFO] - Step: 28800/39633  |  Loss: 0.5418  |  Score: 78.34 [%]  |  Seq Length: 256.0
[2024-09-20 20:22:49,135][root][INFO] - Step: 23200/39633  |  Loss: 0.5881  |  Score: 75.80 [%]  |  Seq Length: 256.0
[2024-09-20 20:24:39,252][root][INFO] - Step: 29200/39633  |  Loss: 0.5312  |  Score: 78.60 [%]  |  Seq Length: 256.0
[2024-09-20 20:25:23,270][root][INFO] - Step: 23600/39633  |  Loss: 0.5870  |  Score: 75.79 [%]  |  Seq Length: 256.0
[2024-09-20 20:27:57,284][root][INFO] - Step: 24000/39633  |  Loss: 0.5816  |  Score: 76.25 [%]  |  Seq Length: 256.0
[2024-09-20 20:28:27,365][root][INFO] - Step: 29600/39633  |  Loss: 0.5287  |  Score: 78.71 [%]  |  Seq Length: 256.0
[2024-09-20 20:30:31,304][root][INFO] - Step: 24400/39633  |  Loss: 0.5844  |  Score: 76.02 [%]  |  Seq Length: 256.0
[2024-09-20 20:32:15,748][root][INFO] - Step: 30000/39633  |  Loss: 0.5371  |  Score: 78.33 [%]  |  Seq Length: 256.0
[2024-09-20 20:33:05,393][root][INFO] - Step: 24800/39633  |  Loss: 0.5849  |  Score: 76.32 [%]  |  Seq Length: 256.0
[2024-09-20 20:35:39,500][root][INFO] - Step: 25200/39633  |  Loss: 0.5832  |  Score: 76.09 [%]  |  Seq Length: 256.0
[2024-09-20 20:36:04,135][root][INFO] - Step: 30400/39633  |  Loss: 0.5374  |  Score: 78.27 [%]  |  Seq Length: 256.0
[2024-09-20 20:38:13,561][root][INFO] - Step: 25600/39633  |  Loss: 0.5704  |  Score: 76.44 [%]  |  Seq Length: 256.0
[2024-09-20 20:39:51,464][root][INFO] - Step: 30800/39633  |  Loss: 0.5256  |  Score: 78.79 [%]  |  Seq Length: 256.0
[2024-09-20 20:40:47,648][root][INFO] - Step: 26000/39633  |  Loss: 0.5772  |  Score: 76.39 [%]  |  Seq Length: 256.0
[2024-09-20 20:43:21,710][root][INFO] - Step: 26400/39633  |  Loss: 0.5777  |  Score: 76.53 [%]  |  Seq Length: 256.0
[2024-09-20 20:43:30,296][root][INFO] - Step: 26422/39633  |  Loss: 0.5690  |  Score: 76.37 [%]  |  Seq Length: 256.0
[2024-09-20 20:43:35,463][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-20 20:43:35,464][root][INFO] - Score: 74.20 [%]  |  Evaluation Time: 5.16 [s]
[2024-09-20 20:43:40,215][root][INFO] - Step: 31200/39633  |  Loss: 0.5314  |  Score: 78.45 [%]  |  Seq Length: 256.0
[2024-09-20 20:43:45,023][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-20 20:43:45,024][root][INFO] - Score: 73.18 [%]  |  Evaluation Time: 9.56 [s]
[2024-09-20 20:43:45,025][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-20 20:43:45,026][root][INFO] - 
[3/ 3 Epoch]
[2024-09-20 20:46:11,027][root][INFO] - Step: 26800/39633  |  Loss: 0.5514  |  Score: 77.79 [%]  |  Seq Length: 256.0
[2024-09-20 20:47:27,905][root][INFO] - Step: 31600/39633  |  Loss: 0.5300  |  Score: 78.62 [%]  |  Seq Length: 256.0
[2024-09-20 20:48:45,054][root][INFO] - Step: 27200/39633  |  Loss: 0.5480  |  Score: 77.96 [%]  |  Seq Length: 256.0
[2024-09-20 20:51:16,706][root][INFO] - Step: 32000/39633  |  Loss: 0.5352  |  Score: 78.29 [%]  |  Seq Length: 256.0
[2024-09-20 20:51:19,068][root][INFO] - Step: 27600/39633  |  Loss: 0.5426  |  Score: 78.02 [%]  |  Seq Length: 256.0
[2024-09-20 20:53:53,075][root][INFO] - Step: 28000/39633  |  Loss: 0.5464  |  Score: 78.07 [%]  |  Seq Length: 256.0
[2024-09-20 20:55:04,761][root][INFO] - Step: 32400/39633  |  Loss: 0.5235  |  Score: 78.88 [%]  |  Seq Length: 256.0
[2024-09-20 20:56:27,172][root][INFO] - Step: 28400/39633  |  Loss: 0.5466  |  Score: 77.87 [%]  |  Seq Length: 256.0
[2024-09-20 20:58:49,673][root][INFO] - 

[2024-09-20 20:58:49,673][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-20 20:58:49,673][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.0001lr_42rs
[2024-09-20 20:58:49,673][root][INFO] - 

[2024-09-20 20:58:49,673][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.0001, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 2, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.0001lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.0001lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.0001lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-20 20:58:52,678][root][INFO] - Step: 32800/39633  |  Loss: 0.5311  |  Score: 78.55 [%]  |  Seq Length: 256.0
[2024-09-20 20:59:01,304][root][INFO] - Step: 28800/39633  |  Loss: 0.5455  |  Score: 77.91 [%]  |  Seq Length: 256.0
[2024-09-20 21:00:55,238][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-20 21:00:59,484][root][INFO] - 

[2024-09-20 21:00:59,485][root][INFO] - ========== Fine-tuning on KorNLI ==========
[2024-09-20 21:00:59,485][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-20 21:00:59,492][root][INFO] - vocab size              : 51200
[2024-09-20 21:00:59,493][root][INFO] - device                  : gpu
[2024-09-20 21:00:59,493][root][INFO] - random seed             : 42
[2024-09-20 21:00:59,493][root][INFO] - train data size         : 422752
[2024-09-20 21:00:59,493][root][INFO] - max epochs              : 3
[2024-09-20 21:00:59,493][root][INFO] - total steps             : 39633
[2024-09-20 21:00:59,493][root][INFO] - warmup steps            : 3963
[2024-09-20 21:00:59,493][root][INFO] - batch size              : 64
[2024-09-20 21:00:59,493][root][INFO] - accumulation steps      : 2
[2024-09-20 21:00:59,493][root][INFO] - optimizer               : adamwscale
[2024-09-20 21:00:59,493][root][INFO] - lr_scheduler            : cosine
[2024-09-20 21:00:59,493][root][INFO] - learning rate           : 0.0001
[2024-09-20 21:00:59,494][root][INFO] - max length              : 256

[2024-09-20 21:00:59,494][root][INFO] - 

[2024-09-20 21:00:59,494][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.0001lr_42rs
[2024-09-20 21:00:59,494][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.0001lr_42rs/ckpt
[2024-09-20 21:00:59,494][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.0001lr_42rs/tb
[2024-09-20 21:00:59,494][root][INFO] - * tb interval           : 400

[2024-09-20 21:00:59,494][root][INFO] - 

[2024-09-20 21:00:59,494][root][INFO] - Start the Training !
[2024-09-20 21:00:59,497][root][INFO] - 
[1/ 3 Epoch]
[2024-09-20 21:01:35,328][root][INFO] - Step: 29200/39633  |  Loss: 0.5389  |  Score: 77.97 [%]  |  Seq Length: 256.0
[2024-09-20 21:02:41,190][root][INFO] - Step: 33200/39633  |  Loss: 0.5273  |  Score: 78.64 [%]  |  Seq Length: 256.0
[2024-09-20 21:04:09,067][root][INFO] - Step: 400/39633  |  Loss: 1.0254  |  Score: 46.79 [%]  |  Seq Length: 256.0
[2024-09-20 21:04:09,537][root][INFO] - Step: 29600/39633  |  Loss: 0.5362  |  Score: 78.65 [%]  |  Seq Length: 256.0
[2024-09-20 21:06:29,137][root][INFO] - Step: 33600/39633  |  Loss: 0.5347  |  Score: 78.36 [%]  |  Seq Length: 256.0
[2024-09-20 21:06:43,619][root][INFO] - Step: 30000/39633  |  Loss: 0.5419  |  Score: 77.92 [%]  |  Seq Length: 256.0
[2024-09-20 21:07:16,118][root][INFO] - Step: 800/39633  |  Loss: 0.8817  |  Score: 59.55 [%]  |  Seq Length: 256.0
[2024-09-20 21:09:17,759][root][INFO] - Step: 30400/39633  |  Loss: 0.5404  |  Score: 78.11 [%]  |  Seq Length: 256.0
[2024-09-20 21:10:16,597][root][INFO] - Step: 34000/39633  |  Loss: 0.5305  |  Score: 78.64 [%]  |  Seq Length: 256.0
[2024-09-20 21:10:23,556][root][INFO] - Step: 1200/39633  |  Loss: 0.8309  |  Score: 62.81 [%]  |  Seq Length: 256.0
[2024-09-20 21:11:51,816][root][INFO] - Step: 30800/39633  |  Loss: 0.5364  |  Score: 78.45 [%]  |  Seq Length: 256.0
[2024-09-20 21:13:30,899][root][INFO] - Step: 1600/39633  |  Loss: 0.8015  |  Score: 64.50 [%]  |  Seq Length: 256.0
[2024-09-20 21:14:05,501][root][INFO] - Step: 34400/39633  |  Loss: 0.5187  |  Score: 79.17 [%]  |  Seq Length: 256.0
[2024-09-20 21:14:25,900][root][INFO] - Step: 31200/39633  |  Loss: 0.5401  |  Score: 78.30 [%]  |  Seq Length: 256.0
[2024-09-20 21:16:38,359][root][INFO] - Step: 2000/39633  |  Loss: 0.7808  |  Score: 65.38 [%]  |  Seq Length: 256.0
[2024-09-20 21:17:00,046][root][INFO] - Step: 31600/39633  |  Loss: 0.5339  |  Score: 78.43 [%]  |  Seq Length: 256.0
[2024-09-20 21:17:54,639][root][INFO] - Step: 34800/39633  |  Loss: 0.5263  |  Score: 78.60 [%]  |  Seq Length: 256.0
[2024-09-20 21:19:34,384][root][INFO] - Step: 32000/39633  |  Loss: 0.5408  |  Score: 78.29 [%]  |  Seq Length: 256.0
[2024-09-20 21:19:46,112][root][INFO] - Step: 2400/39633  |  Loss: 0.7632  |  Score: 67.01 [%]  |  Seq Length: 256.0
[2024-09-20 21:21:43,952][root][INFO] - Step: 35200/39633  |  Loss: 0.5259  |  Score: 78.88 [%]  |  Seq Length: 256.0
[2024-09-20 21:22:08,678][root][INFO] - Step: 32400/39633  |  Loss: 0.5327  |  Score: 78.94 [%]  |  Seq Length: 256.0
[2024-09-20 21:22:53,380][root][INFO] - Step: 2800/39633  |  Loss: 0.7484  |  Score: 67.58 [%]  |  Seq Length: 256.0
[2024-09-20 21:24:42,916][root][INFO] - Step: 32800/39633  |  Loss: 0.5344  |  Score: 78.62 [%]  |  Seq Length: 256.0
[2024-09-20 21:25:32,583][root][INFO] - Step: 35600/39633  |  Loss: 0.5203  |  Score: 79.31 [%]  |  Seq Length: 256.0
[2024-09-20 21:26:00,855][root][INFO] - Step: 3200/39633  |  Loss: 0.7421  |  Score: 68.04 [%]  |  Seq Length: 256.0
[2024-09-20 21:27:17,341][root][INFO] - Step: 33200/39633  |  Loss: 0.5365  |  Score: 78.54 [%]  |  Seq Length: 256.0
[2024-09-20 21:29:08,127][root][INFO] - Step: 3600/39633  |  Loss: 0.7264  |  Score: 68.68 [%]  |  Seq Length: 256.0
[2024-09-20 21:29:20,854][root][INFO] - Step: 36000/39633  |  Loss: 0.5275  |  Score: 78.88 [%]  |  Seq Length: 256.0
[2024-09-20 21:29:51,570][root][INFO] - Step: 33600/39633  |  Loss: 0.5407  |  Score: 78.12 [%]  |  Seq Length: 256.0
[2024-09-20 21:32:15,675][root][INFO] - Step: 4000/39633  |  Loss: 0.7182  |  Score: 69.22 [%]  |  Seq Length: 256.0
[2024-09-20 21:32:25,899][root][INFO] - Step: 34000/39633  |  Loss: 0.5390  |  Score: 78.02 [%]  |  Seq Length: 256.0
[2024-09-20 21:33:08,842][root][INFO] - Step: 36400/39633  |  Loss: 0.5252  |  Score: 78.70 [%]  |  Seq Length: 256.0
[2024-09-20 21:35:00,127][root][INFO] - Step: 34400/39633  |  Loss: 0.5321  |  Score: 78.20 [%]  |  Seq Length: 256.0
[2024-09-20 21:35:23,171][root][INFO] - Step: 4400/39633  |  Loss: 0.7036  |  Score: 70.04 [%]  |  Seq Length: 256.0
[2024-09-20 21:36:56,600][root][INFO] - Step: 36800/39633  |  Loss: 0.5178  |  Score: 79.21 [%]  |  Seq Length: 256.0
[2024-09-20 21:37:34,585][root][INFO] - Step: 34800/39633  |  Loss: 0.5347  |  Score: 78.30 [%]  |  Seq Length: 256.0
[2024-09-20 21:38:30,472][root][INFO] - Step: 4800/39633  |  Loss: 0.6948  |  Score: 70.38 [%]  |  Seq Length: 256.0
[2024-09-20 21:40:08,795][root][INFO] - Step: 35200/39633  |  Loss: 0.5311  |  Score: 78.70 [%]  |  Seq Length: 256.0
[2024-09-20 21:40:44,834][root][INFO] - Step: 37200/39633  |  Loss: 0.5329  |  Score: 78.47 [%]  |  Seq Length: 256.0
[2024-09-20 21:41:37,866][root][INFO] - Step: 5200/39633  |  Loss: 0.6931  |  Score: 70.65 [%]  |  Seq Length: 256.0
[2024-09-20 21:42:42,904][root][INFO] - Step: 35600/39633  |  Loss: 0.5375  |  Score: 78.41 [%]  |  Seq Length: 256.0
[2024-09-20 21:44:32,982][root][INFO] - Step: 37600/39633  |  Loss: 0.5183  |  Score: 79.17 [%]  |  Seq Length: 256.0
[2024-09-20 21:44:45,257][root][INFO] - Step: 5600/39633  |  Loss: 0.6819  |  Score: 71.02 [%]  |  Seq Length: 256.0
[2024-09-20 21:45:17,079][root][INFO] - Step: 36000/39633  |  Loss: 0.5285  |  Score: 78.92 [%]  |  Seq Length: 256.0
[2024-09-20 21:47:51,254][root][INFO] - Step: 36400/39633  |  Loss: 0.5344  |  Score: 78.37 [%]  |  Seq Length: 256.0
[2024-09-20 21:47:52,706][root][INFO] - Step: 6000/39633  |  Loss: 0.6800  |  Score: 71.43 [%]  |  Seq Length: 256.0
[2024-09-20 21:48:21,000][root][INFO] - Step: 38000/39633  |  Loss: 0.5162  |  Score: 79.21 [%]  |  Seq Length: 256.0
[2024-09-20 21:50:25,466][root][INFO] - Step: 36800/39633  |  Loss: 0.5363  |  Score: 78.31 [%]  |  Seq Length: 256.0
[2024-09-20 21:51:00,141][root][INFO] - Step: 6400/39633  |  Loss: 0.6720  |  Score: 71.66 [%]  |  Seq Length: 256.0
[2024-09-20 21:52:08,887][root][INFO] - Step: 38400/39633  |  Loss: 0.5233  |  Score: 79.06 [%]  |  Seq Length: 256.0
[2024-09-20 21:52:59,748][root][INFO] - Step: 37200/39633  |  Loss: 0.5268  |  Score: 78.69 [%]  |  Seq Length: 256.0
[2024-09-20 21:54:07,802][root][INFO] - Step: 6800/39633  |  Loss: 0.6622  |  Score: 72.31 [%]  |  Seq Length: 256.0
[2024-09-20 21:55:33,934][root][INFO] - Step: 37600/39633  |  Loss: 0.5327  |  Score: 78.55 [%]  |  Seq Length: 256.0
[2024-09-20 21:55:56,816][root][INFO] - Step: 38800/39633  |  Loss: 0.5252  |  Score: 78.57 [%]  |  Seq Length: 256.0
[2024-09-20 21:57:15,517][root][INFO] - Step: 7200/39633  |  Loss: 0.6558  |  Score: 72.39 [%]  |  Seq Length: 256.0
[2024-09-20 21:58:08,157][root][INFO] - Step: 38000/39633  |  Loss: 0.5273  |  Score: 78.97 [%]  |  Seq Length: 256.0
[2024-09-20 21:59:44,780][root][INFO] - Step: 39200/39633  |  Loss: 0.5192  |  Score: 79.21 [%]  |  Seq Length: 256.0
[2024-09-20 22:00:22,779][root][INFO] - Step: 7600/39633  |  Loss: 0.6549  |  Score: 72.56 [%]  |  Seq Length: 256.0
[2024-09-20 22:00:42,370][root][INFO] - Step: 38400/39633  |  Loss: 0.5347  |  Score: 78.48 [%]  |  Seq Length: 256.0
[2024-09-20 22:03:16,479][root][INFO] - Step: 38800/39633  |  Loss: 0.5369  |  Score: 78.34 [%]  |  Seq Length: 256.0
[2024-09-20 22:03:30,184][root][INFO] - Step: 8000/39633  |  Loss: 0.6496  |  Score: 72.86 [%]  |  Seq Length: 256.0
[2024-09-20 22:03:32,527][root][INFO] - Step: 39600/39633  |  Loss: 0.5245  |  Score: 78.85 [%]  |  Seq Length: 256.0
[2024-09-20 22:03:51,536][root][INFO] - Step: 39633/39633  |  Loss: 0.5090  |  Score: 79.75 [%]  |  Seq Length: 256.0
[2024-09-20 22:04:00,341][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-20 22:04:00,342][root][INFO] - Score: 74.36 [%]  |  Evaluation Time: 8.80 [s]
[2024-09-20 22:04:17,124][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-20 22:04:17,124][root][INFO] - Score: 74.48 [%]  |  Evaluation Time: 16.78 [s]
[2024-09-20 22:04:17,125][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-20 22:04:17,125][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-20 22:04:17,125][root][INFO] - - Epoch: 3
[2024-09-20 22:04:17,125][root][INFO] - - DEV score: 74.36 [%]
[2024-09-20 22:04:17,125][root][INFO] - - TEST score: 74.48 [%]
[2024-09-20 22:04:17,126][root][INFO] - Fine-tuning is done!
[2024-09-20 22:05:50,590][root][INFO] - Step: 39200/39633  |  Loss: 0.5324  |  Score: 78.36 [%]  |  Seq Length: 256.0
[2024-09-20 22:06:37,312][root][INFO] - Step: 8400/39633  |  Loss: 0.6530  |  Score: 72.23 [%]  |  Seq Length: 256.0
[2024-09-20 22:08:24,578][root][INFO] - Step: 39600/39633  |  Loss: 0.5415  |  Score: 78.20 [%]  |  Seq Length: 256.0
[2024-09-20 22:08:37,339][root][INFO] - Step: 39633/39633  |  Loss: 0.5060  |  Score: 78.84 [%]  |  Seq Length: 256.0
[2024-09-20 22:08:42,417][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-20 22:08:42,418][root][INFO] - Score: 74.92 [%]  |  Evaluation Time: 5.08 [s]
[2024-09-20 22:08:51,879][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-20 22:08:51,879][root][INFO] - Score: 74.61 [%]  |  Evaluation Time: 9.46 [s]
[2024-09-20 22:08:51,880][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-20 22:08:51,880][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-20 22:08:51,880][root][INFO] - - Epoch: 3
[2024-09-20 22:08:51,880][root][INFO] - - DEV score: 74.92 [%]
[2024-09-20 22:08:51,880][root][INFO] - - TEST score: 74.61 [%]
[2024-09-20 22:08:51,881][root][INFO] - Fine-tuning is done!
[2024-09-20 22:09:44,293][root][INFO] - Step: 8800/39633  |  Loss: 0.6439  |  Score: 72.85 [%]  |  Seq Length: 256.0
[2024-09-20 22:12:50,997][root][INFO] - Step: 9200/39633  |  Loss: 0.6276  |  Score: 74.29 [%]  |  Seq Length: 256.0
[2024-09-20 22:15:57,674][root][INFO] - Step: 9600/39633  |  Loss: 0.6383  |  Score: 73.54 [%]  |  Seq Length: 256.0
[2024-09-20 22:19:04,099][root][INFO] - Step: 10000/39633  |  Loss: 0.6298  |  Score: 73.77 [%]  |  Seq Length: 256.0
[2024-09-20 22:22:10,749][root][INFO] - Step: 10400/39633  |  Loss: 0.6264  |  Score: 74.21 [%]  |  Seq Length: 256.0
[2024-09-20 22:25:17,413][root][INFO] - Step: 10800/39633  |  Loss: 0.6371  |  Score: 73.59 [%]  |  Seq Length: 256.0
[2024-09-20 22:28:23,634][root][INFO] - Step: 11200/39633  |  Loss: 0.6175  |  Score: 74.52 [%]  |  Seq Length: 256.0
[2024-09-20 22:31:29,827][root][INFO] - Step: 11600/39633  |  Loss: 0.6224  |  Score: 74.34 [%]  |  Seq Length: 256.0
[2024-09-20 22:34:35,988][root][INFO] - Step: 12000/39633  |  Loss: 0.6156  |  Score: 74.31 [%]  |  Seq Length: 256.0
[2024-09-20 22:37:42,315][root][INFO] - Step: 12400/39633  |  Loss: 0.6086  |  Score: 75.16 [%]  |  Seq Length: 256.0
[2024-09-20 22:40:48,627][root][INFO] - Step: 12800/39633  |  Loss: 0.6161  |  Score: 74.39 [%]  |  Seq Length: 256.0
[2024-09-20 22:43:55,075][root][INFO] - Step: 13200/39633  |  Loss: 0.6089  |  Score: 75.09 [%]  |  Seq Length: 256.0
[2024-09-20 22:44:00,269][root][INFO] - Step: 13211/39633  |  Loss: 0.6397  |  Score: 73.63 [%]  |  Seq Length: 256.0
[2024-09-20 22:44:05,374][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-20 22:44:05,374][root][INFO] - Score: 72.57 [%]  |  Evaluation Time: 5.10 [s]
[2024-09-20 22:44:14,871][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-20 22:44:14,871][root][INFO] - Score: 71.77 [%]  |  Evaluation Time: 9.49 [s]
[2024-09-20 22:44:14,872][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-20 22:44:14,873][root][INFO] - 
[2/ 3 Epoch]
[2024-09-20 22:47:16,105][root][INFO] - Step: 13600/39633  |  Loss: 0.5919  |  Score: 75.74 [%]  |  Seq Length: 256.0
[2024-09-20 22:50:21,628][root][INFO] - Step: 14000/39633  |  Loss: 0.5833  |  Score: 76.02 [%]  |  Seq Length: 256.0
[2024-09-20 22:53:27,245][root][INFO] - Step: 14400/39633  |  Loss: 0.5920  |  Score: 75.75 [%]  |  Seq Length: 256.0
[2024-09-20 22:56:33,146][root][INFO] - Step: 14800/39633  |  Loss: 0.5752  |  Score: 76.59 [%]  |  Seq Length: 256.0
[2024-09-20 22:59:38,862][root][INFO] - Step: 15200/39633  |  Loss: 0.5825  |  Score: 76.12 [%]  |  Seq Length: 256.0
[2024-09-20 23:02:44,571][root][INFO] - Step: 15600/39633  |  Loss: 0.5719  |  Score: 76.79 [%]  |  Seq Length: 256.0
[2024-09-20 23:05:50,097][root][INFO] - Step: 16000/39633  |  Loss: 0.5781  |  Score: 76.29 [%]  |  Seq Length: 256.0
[2024-09-20 23:08:55,843][root][INFO] - Step: 16400/39633  |  Loss: 0.5750  |  Score: 76.73 [%]  |  Seq Length: 256.0
[2024-09-20 23:12:01,616][root][INFO] - Step: 16800/39633  |  Loss: 0.5738  |  Score: 76.59 [%]  |  Seq Length: 256.0
[2024-09-20 23:15:07,347][root][INFO] - Step: 17200/39633  |  Loss: 0.5810  |  Score: 76.26 [%]  |  Seq Length: 256.0
[2024-09-20 23:18:13,151][root][INFO] - Step: 17600/39633  |  Loss: 0.5810  |  Score: 76.51 [%]  |  Seq Length: 256.0
[2024-09-20 23:21:18,765][root][INFO] - Step: 18000/39633  |  Loss: 0.5754  |  Score: 76.52 [%]  |  Seq Length: 256.0
[2024-09-20 23:24:24,673][root][INFO] - Step: 18400/39633  |  Loss: 0.5771  |  Score: 76.23 [%]  |  Seq Length: 256.0
[2024-09-20 23:27:30,635][root][INFO] - Step: 18800/39633  |  Loss: 0.5774  |  Score: 76.39 [%]  |  Seq Length: 256.0
[2024-09-20 23:30:36,385][root][INFO] - Step: 19200/39633  |  Loss: 0.5781  |  Score: 76.51 [%]  |  Seq Length: 256.0
[2024-09-20 23:33:42,081][root][INFO] - Step: 19600/39633  |  Loss: 0.5686  |  Score: 76.63 [%]  |  Seq Length: 256.0
[2024-09-20 23:36:47,839][root][INFO] - Step: 20000/39633  |  Loss: 0.5734  |  Score: 76.53 [%]  |  Seq Length: 256.0
[2024-09-20 23:39:53,480][root][INFO] - Step: 20400/39633  |  Loss: 0.5695  |  Score: 76.89 [%]  |  Seq Length: 256.0
[2024-09-20 23:42:59,210][root][INFO] - Step: 20800/39633  |  Loss: 0.5716  |  Score: 76.83 [%]  |  Seq Length: 256.0
[2024-09-20 23:46:04,852][root][INFO] - Step: 21200/39633  |  Loss: 0.5664  |  Score: 76.95 [%]  |  Seq Length: 256.0
[2024-09-20 23:49:10,736][root][INFO] - Step: 21600/39633  |  Loss: 0.5699  |  Score: 76.80 [%]  |  Seq Length: 256.0
[2024-09-20 23:52:16,418][root][INFO] - Step: 22000/39633  |  Loss: 0.5664  |  Score: 76.91 [%]  |  Seq Length: 256.0
[2024-09-20 23:55:22,058][root][INFO] - Step: 22400/39633  |  Loss: 0.5703  |  Score: 76.86 [%]  |  Seq Length: 256.0
[2024-09-20 23:58:27,817][root][INFO] - Step: 22800/39633  |  Loss: 0.5587  |  Score: 77.27 [%]  |  Seq Length: 256.0
[2024-09-21 00:01:33,573][root][INFO] - Step: 23200/39633  |  Loss: 0.5596  |  Score: 77.56 [%]  |  Seq Length: 256.0
[2024-09-21 00:04:39,281][root][INFO] - Step: 23600/39633  |  Loss: 0.5585  |  Score: 77.61 [%]  |  Seq Length: 256.0
[2024-09-21 00:07:44,978][root][INFO] - Step: 24000/39633  |  Loss: 0.5569  |  Score: 77.36 [%]  |  Seq Length: 256.0
[2024-09-21 00:10:50,565][root][INFO] - Step: 24400/39633  |  Loss: 0.5620  |  Score: 76.93 [%]  |  Seq Length: 256.0
[2024-09-21 00:13:56,352][root][INFO] - Step: 24800/39633  |  Loss: 0.5602  |  Score: 77.11 [%]  |  Seq Length: 256.0
[2024-09-21 00:17:01,995][root][INFO] - Step: 25200/39633  |  Loss: 0.5572  |  Score: 77.53 [%]  |  Seq Length: 256.0
[2024-09-21 00:20:07,817][root][INFO] - Step: 25600/39633  |  Loss: 0.5610  |  Score: 77.19 [%]  |  Seq Length: 256.0
[2024-09-21 00:23:13,377][root][INFO] - Step: 26000/39633  |  Loss: 0.5568  |  Score: 77.30 [%]  |  Seq Length: 256.0
[2024-09-21 00:26:19,037][root][INFO] - Step: 26400/39633  |  Loss: 0.5554  |  Score: 77.37 [%]  |  Seq Length: 256.0
[2024-09-21 00:26:29,380][root][INFO] - Step: 26422/39633  |  Loss: 0.5432  |  Score: 79.21 [%]  |  Seq Length: 256.0
[2024-09-21 00:26:34,586][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-21 00:26:34,587][root][INFO] - Score: 73.47 [%]  |  Evaluation Time: 5.20 [s]
[2024-09-21 00:26:44,163][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-21 00:26:44,164][root][INFO] - Score: 74.09 [%]  |  Evaluation Time: 9.57 [s]
[2024-09-21 00:26:44,165][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-21 00:26:44,166][root][INFO] - 
[3/ 3 Epoch]
[2024-09-21 00:29:40,327][root][INFO] - Step: 26800/39633  |  Loss: 0.5436  |  Score: 78.17 [%]  |  Seq Length: 256.0
[2024-09-21 00:32:46,058][root][INFO] - Step: 27200/39633  |  Loss: 0.5376  |  Score: 78.34 [%]  |  Seq Length: 256.0
[2024-09-21 00:35:51,910][root][INFO] - Step: 27600/39633  |  Loss: 0.5362  |  Score: 78.37 [%]  |  Seq Length: 256.0
[2024-09-21 00:38:57,824][root][INFO] - Step: 28000/39633  |  Loss: 0.5330  |  Score: 78.58 [%]  |  Seq Length: 256.0
[2024-09-21 00:42:03,734][root][INFO] - Step: 28400/39633  |  Loss: 0.5365  |  Score: 78.32 [%]  |  Seq Length: 256.0
[2024-09-21 00:45:09,695][root][INFO] - Step: 28800/39633  |  Loss: 0.5380  |  Score: 78.22 [%]  |  Seq Length: 256.0
[2024-09-21 00:48:15,457][root][INFO] - Step: 29200/39633  |  Loss: 0.5279  |  Score: 78.88 [%]  |  Seq Length: 256.0
[2024-09-21 00:51:21,428][root][INFO] - Step: 29600/39633  |  Loss: 0.5275  |  Score: 79.02 [%]  |  Seq Length: 256.0
[2024-09-21 00:54:27,238][root][INFO] - Step: 30000/39633  |  Loss: 0.5345  |  Score: 78.46 [%]  |  Seq Length: 256.0
[2024-09-21 00:57:33,155][root][INFO] - Step: 30400/39633  |  Loss: 0.5314  |  Score: 78.46 [%]  |  Seq Length: 256.0
[2024-09-21 01:00:38,957][root][INFO] - Step: 30800/39633  |  Loss: 0.5326  |  Score: 78.66 [%]  |  Seq Length: 256.0
[2024-09-21 01:03:44,592][root][INFO] - Step: 31200/39633  |  Loss: 0.5307  |  Score: 78.80 [%]  |  Seq Length: 256.0
[2024-09-21 01:06:50,088][root][INFO] - Step: 31600/39633  |  Loss: 0.5257  |  Score: 78.65 [%]  |  Seq Length: 256.0
[2024-09-21 01:09:55,487][root][INFO] - Step: 32000/39633  |  Loss: 0.5272  |  Score: 78.82 [%]  |  Seq Length: 256.0
[2024-09-21 01:13:01,050][root][INFO] - Step: 32400/39633  |  Loss: 0.5167  |  Score: 79.18 [%]  |  Seq Length: 256.0
[2024-09-21 01:16:06,750][root][INFO] - Step: 32800/39633  |  Loss: 0.5351  |  Score: 78.47 [%]  |  Seq Length: 256.0
[2024-09-21 01:19:12,294][root][INFO] - Step: 33200/39633  |  Loss: 0.5361  |  Score: 78.30 [%]  |  Seq Length: 256.0
[2024-09-21 01:22:17,855][root][INFO] - Step: 33600/39633  |  Loss: 0.5244  |  Score: 78.89 [%]  |  Seq Length: 256.0
[2024-09-21 01:25:23,334][root][INFO] - Step: 34000/39633  |  Loss: 0.5307  |  Score: 78.61 [%]  |  Seq Length: 256.0
[2024-09-21 01:28:28,919][root][INFO] - Step: 34400/39633  |  Loss: 0.5310  |  Score: 78.75 [%]  |  Seq Length: 256.0
[2024-09-21 01:31:34,741][root][INFO] - Step: 34800/39633  |  Loss: 0.5175  |  Score: 79.19 [%]  |  Seq Length: 256.0
[2024-09-21 01:34:40,575][root][INFO] - Step: 35200/39633  |  Loss: 0.5242  |  Score: 78.58 [%]  |  Seq Length: 256.0
[2024-09-21 01:37:46,196][root][INFO] - Step: 35600/39633  |  Loss: 0.5232  |  Score: 79.07 [%]  |  Seq Length: 256.0
[2024-09-21 01:40:52,055][root][INFO] - Step: 36000/39633  |  Loss: 0.5257  |  Score: 78.83 [%]  |  Seq Length: 256.0
[2024-09-21 01:43:57,724][root][INFO] - Step: 36400/39633  |  Loss: 0.5241  |  Score: 78.84 [%]  |  Seq Length: 256.0
[2024-09-21 01:47:03,557][root][INFO] - Step: 36800/39633  |  Loss: 0.5260  |  Score: 78.75 [%]  |  Seq Length: 256.0
[2024-09-21 01:50:09,342][root][INFO] - Step: 37200/39633  |  Loss: 0.5267  |  Score: 78.69 [%]  |  Seq Length: 256.0
[2024-09-21 01:53:14,793][root][INFO] - Step: 37600/39633  |  Loss: 0.5351  |  Score: 78.38 [%]  |  Seq Length: 256.0
[2024-09-21 01:56:20,646][root][INFO] - Step: 38000/39633  |  Loss: 0.5279  |  Score: 78.93 [%]  |  Seq Length: 256.0
[2024-09-21 01:59:26,274][root][INFO] - Step: 38400/39633  |  Loss: 0.5301  |  Score: 78.73 [%]  |  Seq Length: 256.0
[2024-09-21 02:02:31,998][root][INFO] - Step: 38800/39633  |  Loss: 0.5254  |  Score: 78.96 [%]  |  Seq Length: 256.0
[2024-09-21 02:05:37,580][root][INFO] - Step: 39200/39633  |  Loss: 0.5299  |  Score: 78.53 [%]  |  Seq Length: 256.0
[2024-09-21 02:08:42,939][root][INFO] - Step: 39600/39633  |  Loss: 0.5249  |  Score: 78.71 [%]  |  Seq Length: 256.0
[2024-09-21 02:08:58,364][root][INFO] - Step: 39633/39633  |  Loss: 0.5303  |  Score: 78.98 [%]  |  Seq Length: 256.0
[2024-09-21 02:09:03,527][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-21 02:09:03,527][root][INFO] - Score: 74.62 [%]  |  Evaluation Time: 5.16 [s]
[2024-09-21 02:09:13,073][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-21 02:09:13,074][root][INFO] - Score: 73.49 [%]  |  Evaluation Time: 9.54 [s]
[2024-09-21 02:09:13,075][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-21 02:09:13,075][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-21 02:09:13,075][root][INFO] - - Epoch: 3
[2024-09-21 02:09:13,075][root][INFO] - - DEV score: 74.62 [%]
[2024-09-21 02:09:13,075][root][INFO] - - TEST score: 73.49 [%]
[2024-09-21 02:09:13,076][root][INFO] - Fine-tuning is done!
[2024-09-22 11:57:46,040][root][INFO] - 

[2024-09-22 11:57:46,040][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 11:57:46,041][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs
[2024-09-22 11:57:46,041][root][INFO] - 

[2024-09-22 11:57:46,041][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.0001, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 11:57:50,502][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 11:57:52,511][root][INFO] - 

[2024-09-22 11:57:52,511][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-22 11:57:52,512][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 11:57:52,521][root][INFO] - vocab size              : 51200
[2024-09-22 11:57:52,521][root][INFO] - device                  : gpu
[2024-09-22 11:57:52,521][root][INFO] - random seed             : 42
[2024-09-22 11:57:52,521][root][INFO] - train data size         : 4416
[2024-09-22 11:57:52,522][root][INFO] - max epochs              : 15
[2024-09-22 11:57:52,522][root][INFO] - total steps             : 1035
[2024-09-22 11:57:52,522][root][INFO] - warmup steps            : 104
[2024-09-22 11:57:52,522][root][INFO] - batch size              : 64
[2024-09-22 11:57:52,522][root][INFO] - accumulation steps      : 1
[2024-09-22 11:57:52,522][root][INFO] - optimizer               : adamwscale
[2024-09-22 11:57:52,522][root][INFO] - lr_scheduler            : cosine
[2024-09-22 11:57:52,522][root][INFO] - learning rate           : 0.0001
[2024-09-22 11:57:52,522][root][INFO] - max length              : 256

[2024-09-22 11:57:52,522][root][INFO] - 

[2024-09-22 11:57:52,522][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs
[2024-09-22 11:57:52,522][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs/ckpt
[2024-09-22 11:57:52,523][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs/tb
[2024-09-22 11:57:52,523][root][INFO] - * tb interval           : 15

[2024-09-22 11:57:52,523][root][INFO] - 

[2024-09-22 11:57:52,523][root][INFO] - Start the Training !
[2024-09-22 11:57:52,526][root][INFO] - 
[1/ 15 Epoch]
[2024-09-22 11:58:00,520][root][INFO] - Step: 15/1035  |  Loss: 3.8143  |  Score: 6.57 [%]  |  Seq Length: 256.0
[2024-09-22 11:58:07,115][root][INFO] - Step: 30/1035  |  Loss: 2.6538  |  Score: 12.41 [%]  |  Seq Length: 256.0
[2024-09-22 11:58:13,687][root][INFO] - Step: 45/1035  |  Loss: 2.2784  |  Score: 21.98 [%]  |  Seq Length: 256.0
[2024-09-22 11:58:20,265][root][INFO] - Step: 60/1035  |  Loss: 2.2505  |  Score: 24.52 [%]  |  Seq Length: 256.0
[2024-09-22 11:58:24,248][root][INFO] - Step: 69/1035  |  Loss: 2.0590  |  Score: 33.89 [%]  |  Seq Length: 256.0
[2024-09-22 11:58:27,383][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 11:58:27,383][root][INFO] - Score: 36.33 [%]  |  Evaluation Time: 3.13 [s]
[2024-09-22 11:58:28,505][root][INFO] - 

[2024-09-22 11:58:28,505][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 11:58:28,506][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs
[2024-09-22 11:58:28,506][root][INFO] - 

[2024-09-22 11:58:28,506][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 11:58:30,357][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 11:58:30,357][root][INFO] - Score: 38.49 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-22 11:58:30,358][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 11:58:30,359][root][INFO] - 
[2/ 15 Epoch]
[2024-09-22 11:58:33,092][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 11:58:33,093][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 11:58:33,094][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 11:58:33,094][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 11:58:33,095][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 11:58:33,095][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 11:58:33,096][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 11:58:33,096][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 11:58:33,097][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 11:58:33,098][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 11:58:33,098][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 11:58:33,099][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 11:58:33,099][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 11:58:33,100][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 11:58:33,100][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 11:58:33,101][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 11:58:33,102][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 11:58:33,102][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 11:58:33,103][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 11:58:33,103][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 11:58:33,104][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 11:58:33,104][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 11:58:33,105][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 11:58:33,106][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 11:58:33,108][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-22 11:58:33,273][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 11:58:33,415][root][INFO] - Step: 75/1035  |  Loss: 1.7878  |  Score: 43.37 [%]  |  Seq Length: 256.0
[2024-09-22 11:58:35,171][root][INFO] - 

[2024-09-22 11:58:35,171][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-22 11:58:35,171][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 11:58:35,179][root][INFO] - vocab size              : 51200
[2024-09-22 11:58:35,179][root][INFO] - device                  : gpu
[2024-09-22 11:58:35,179][root][INFO] - random seed             : 42
[2024-09-22 11:58:35,180][root][INFO] - train data size         : 4416
[2024-09-22 11:58:35,180][root][INFO] - max epochs              : 15
[2024-09-22 11:58:35,180][root][INFO] - total steps             : 1035
[2024-09-22 11:58:35,180][root][INFO] - warmup steps            : 104
[2024-09-22 11:58:35,180][root][INFO] - batch size              : 64
[2024-09-22 11:58:35,180][root][INFO] - accumulation steps      : 1
[2024-09-22 11:58:35,180][root][INFO] - optimizer               : adamwscale
[2024-09-22 11:58:35,180][root][INFO] - lr_scheduler            : cosine
[2024-09-22 11:58:35,180][root][INFO] - learning rate           : 0.02
[2024-09-22 11:58:35,180][root][INFO] - max length              : 256

[2024-09-22 11:58:35,180][root][INFO] - LoRA Configuration
[2024-09-22 11:58:35,181][root][INFO] - ㄴ r                    : 32
[2024-09-22 11:58:35,181][root][INFO] - ㄴ alpha                : 128
[2024-09-22 11:58:35,181][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 11:58:35,181][root][INFO] - 

[2024-09-22 11:58:35,181][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs
[2024-09-22 11:58:35,181][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs/ckpt
[2024-09-22 11:58:35,181][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs/tb
[2024-09-22 11:58:35,181][root][INFO] - * tb interval           : 15

[2024-09-22 11:58:35,181][root][INFO] - 

[2024-09-22 11:58:35,181][root][INFO] - Start the Training !
[2024-09-22 11:58:35,184][root][INFO] - 
[1/ 15 Epoch]
[2024-09-22 11:58:40,015][root][INFO] - Step: 90/1035  |  Loss: 1.6794  |  Score: 53.68 [%]  |  Seq Length: 256.0
[2024-09-22 11:58:42,060][root][INFO] - Step: 15/1035  |  Loss: 3.2085  |  Score: 4.52 [%]  |  Seq Length: 256.0
[2024-09-22 11:58:46,598][root][INFO] - Step: 105/1035  |  Loss: 1.5230  |  Score: 59.53 [%]  |  Seq Length: 256.0
[2024-09-22 11:58:47,529][root][INFO] - Step: 30/1035  |  Loss: 2.0614  |  Score: 35.10 [%]  |  Seq Length: 256.0
[2024-09-22 11:58:53,005][root][INFO] - Step: 45/1035  |  Loss: 1.6893  |  Score: 54.72 [%]  |  Seq Length: 256.0
[2024-09-22 11:58:53,209][root][INFO] - Step: 120/1035  |  Loss: 1.4308  |  Score: 59.96 [%]  |  Seq Length: 256.0
[2024-09-22 11:58:57,886][root][INFO] - 

[2024-09-22 11:58:57,886][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 11:58:57,886][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs
[2024-09-22 11:58:57,886][root][INFO] - 

[2024-09-22 11:58:57,887][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 11:58:58,482][root][INFO] - Step: 60/1035  |  Loss: 1.4378  |  Score: 60.12 [%]  |  Seq Length: 256.0
[2024-09-22 11:58:59,835][root][INFO] - Step: 135/1035  |  Loss: 1.4268  |  Score: 56.71 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:01,214][root][INFO] - Step: 138/1035  |  Loss: 1.4092  |  Score: 66.52 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:01,781][root][INFO] - Step: 69/1035  |  Loss: 1.3767  |  Score: 66.11 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:02,238][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 11:59:02,239][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 11:59:02,240][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 11:59:02,240][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 11:59:02,241][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 11:59:02,242][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 11:59:02,242][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 11:59:02,243][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 11:59:02,244][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 11:59:02,245][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 11:59:02,245][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 11:59:02,246][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 11:59:02,247][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 11:59:02,247][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 11:59:02,248][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 11:59:02,249][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 11:59:02,249][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 11:59:02,250][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 11:59:02,251][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 11:59:02,251][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 11:59:02,252][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 11:59:02,253][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 11:59:02,253][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 11:59:02,254][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 11:59:02,257][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-22 11:59:02,262][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-22 11:59:02,394][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-22 11:59:02,397][root][INFO] - Trainable params: 8985600 || all params: 134150400 || trainable: 6.70 %
[2024-09-22 11:59:02,575][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 11:59:04,284][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 11:59:04,284][root][INFO] - Score: 71.37 [%]  |  Evaluation Time: 3.07 [s]
[2024-09-22 11:59:04,826][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 11:59:04,826][root][INFO] - Score: 74.90 [%]  |  Evaluation Time: 3.04 [s]
[2024-09-22 11:59:05,700][root][INFO] - 

[2024-09-22 11:59:05,700][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-22 11:59:05,700][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 11:59:05,708][root][INFO] - vocab size              : 51200
[2024-09-22 11:59:05,709][root][INFO] - device                  : gpu
[2024-09-22 11:59:05,709][root][INFO] - random seed             : 42
[2024-09-22 11:59:05,709][root][INFO] - train data size         : 4416
[2024-09-22 11:59:05,709][root][INFO] - max epochs              : 15
[2024-09-22 11:59:05,709][root][INFO] - total steps             : 1035
[2024-09-22 11:59:05,709][root][INFO] - warmup steps            : 104
[2024-09-22 11:59:05,709][root][INFO] - batch size              : 64
[2024-09-22 11:59:05,709][root][INFO] - accumulation steps      : 1
[2024-09-22 11:59:05,709][root][INFO] - optimizer               : adamwscale
[2024-09-22 11:59:05,709][root][INFO] - lr_scheduler            : cosine
[2024-09-22 11:59:05,709][root][INFO] - learning rate           : 0.02
[2024-09-22 11:59:05,710][root][INFO] - max length              : 256

[2024-09-22 11:59:05,710][root][INFO] - LoRA Configuration
[2024-09-22 11:59:05,710][root][INFO] - ㄴ r                    : 32
[2024-09-22 11:59:05,710][root][INFO] - ㄴ alpha                : 128
[2024-09-22 11:59:05,710][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 11:59:05,710][root][INFO] - KOMBO Configuration
[2024-09-22 11:59:05,710][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-22 11:59:05,710][root][INFO] - ㄴ reducer              : linear
[2024-09-22 11:59:05,710][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-22 11:59:05,710][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-22 11:59:05,710][root][INFO] - ㄴ do_combination       : True
[2024-09-22 11:59:05,711][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-22 11:59:05,711][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-22 11:59:05,711][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-22 11:59:05,711][root][INFO] -   ㄴ add_lora           : False
[2024-09-22 11:59:05,711][root][INFO] - 

[2024-09-22 11:59:05,711][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs
[2024-09-22 11:59:05,711][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs/ckpt
[2024-09-22 11:59:05,711][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs/tb
[2024-09-22 11:59:05,711][root][INFO] - * tb interval           : 15

[2024-09-22 11:59:05,711][root][INFO] - 

[2024-09-22 11:59:05,712][root][INFO] - Start the Training !
[2024-09-22 11:59:05,715][root][INFO] - 
[1/ 15 Epoch]
[2024-09-22 11:59:07,268][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 11:59:07,268][root][INFO] - Score: 64.82 [%]  |  Evaluation Time: 2.98 [s]
[2024-09-22 11:59:07,269][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 11:59:07,270][root][INFO] - 
[3/ 15 Epoch]
[2024-09-22 11:59:07,767][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 11:59:07,768][root][INFO] - Score: 68.29 [%]  |  Evaluation Time: 2.94 [s]
[2024-09-22 11:59:07,769][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 11:59:07,771][root][INFO] - 
[2/ 15 Epoch]
[2024-09-22 11:59:10,258][root][INFO] - Step: 75/1035  |  Loss: 1.1836  |  Score: 67.92 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:12,987][root][INFO] - Step: 150/1035  |  Loss: 1.1005  |  Score: 68.35 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:14,200][root][INFO] - Step: 15/1035  |  Loss: 3.0988  |  Score: 8.60 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:15,738][root][INFO] - Step: 90/1035  |  Loss: 1.2766  |  Score: 65.58 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:19,656][root][INFO] - Step: 165/1035  |  Loss: 1.2221  |  Score: 68.53 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:21,219][root][INFO] - Step: 105/1035  |  Loss: 1.2676  |  Score: 64.33 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:21,921][root][INFO] - Step: 30/1035  |  Loss: 2.2847  |  Score: 38.90 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:26,292][root][INFO] - Step: 180/1035  |  Loss: 1.2678  |  Score: 65.17 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:26,698][root][INFO] - Step: 120/1035  |  Loss: 1.3036  |  Score: 68.61 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:29,623][root][INFO] - Step: 45/1035  |  Loss: 1.5757  |  Score: 58.83 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:32,180][root][INFO] - Step: 135/1035  |  Loss: 1.2159  |  Score: 69.42 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:32,922][root][INFO] - Step: 195/1035  |  Loss: 1.0749  |  Score: 72.28 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:33,299][root][INFO] - Step: 138/1035  |  Loss: 1.2745  |  Score: 74.38 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:36,359][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 11:59:36,359][root][INFO] - Score: 75.60 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-22 11:59:37,450][root][INFO] - Step: 60/1035  |  Loss: 1.4859  |  Score: 59.03 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:38,265][root][INFO] - Step: 207/1035  |  Loss: 1.1674  |  Score: 67.53 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:39,280][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 11:59:39,280][root][INFO] - Score: 67.99 [%]  |  Evaluation Time: 2.92 [s]
[2024-09-22 11:59:39,281][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 11:59:39,282][root][INFO] - 
[3/ 15 Epoch]
[2024-09-22 11:59:41,421][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 11:59:41,421][root][INFO] - Score: 74.51 [%]  |  Evaluation Time: 3.15 [s]
[2024-09-22 11:59:42,102][root][INFO] - Step: 69/1035  |  Loss: 1.4921  |  Score: 63.05 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:44,047][root][INFO] - Step: 150/1035  |  Loss: 1.0714  |  Score: 70.87 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:44,443][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 11:59:44,443][root][INFO] - Score: 67.82 [%]  |  Evaluation Time: 3.02 [s]
[2024-09-22 11:59:44,444][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 11:59:44,445][root][INFO] - 
[4/ 15 Epoch]
[2024-09-22 11:59:46,136][root][INFO] - Step: 210/1035  |  Loss: 1.0103  |  Score: 77.99 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:47,001][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 11:59:47,001][root][INFO] - Score: 73.81 [%]  |  Evaluation Time: 4.90 [s]
[2024-09-22 11:59:49,538][root][INFO] - Step: 165/1035  |  Loss: 0.9192  |  Score: 73.32 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:51,781][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 11:59:51,781][root][INFO] - Score: 66.85 [%]  |  Evaluation Time: 4.78 [s]
[2024-09-22 11:59:51,783][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 11:59:51,784][root][INFO] - 
[2/ 15 Epoch]
[2024-09-22 11:59:52,773][root][INFO] - Step: 225/1035  |  Loss: 1.0267  |  Score: 73.04 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:55,039][root][INFO] - Step: 180/1035  |  Loss: 0.9068  |  Score: 74.56 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:55,211][root][INFO] - Step: 75/1035  |  Loss: 1.3830  |  Score: 63.54 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:59,438][root][INFO] - Step: 240/1035  |  Loss: 1.0343  |  Score: 70.06 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:00,534][root][INFO] - Step: 195/1035  |  Loss: 0.9798  |  Score: 74.77 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:02,934][root][INFO] - Step: 90/1035  |  Loss: 1.1899  |  Score: 69.41 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:04,974][root][INFO] - Step: 207/1035  |  Loss: 0.9934  |  Score: 73.50 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:06,067][root][INFO] - Step: 255/1035  |  Loss: 0.9259  |  Score: 73.09 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:08,031][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 12:00:08,031][root][INFO] - Score: 77.83 [%]  |  Evaluation Time: 3.05 [s]
[2024-09-22 12:00:10,630][root][INFO] - Step: 105/1035  |  Loss: 1.2420  |  Score: 67.37 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:11,004][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 12:00:11,004][root][INFO] - Score: 68.59 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-22 12:00:11,005][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 12:00:11,007][root][INFO] - 
[4/ 15 Epoch]
[2024-09-22 12:00:12,420][root][INFO] - Step: 210/1035  |  Loss: 0.9664  |  Score: 79.70 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:12,698][root][INFO] - Step: 270/1035  |  Loss: 0.9114  |  Score: 75.12 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:15,417][root][INFO] - Step: 276/1035  |  Loss: 0.9190  |  Score: 79.46 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:17,923][root][INFO] - Step: 225/1035  |  Loss: 0.9081  |  Score: 78.87 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:18,406][root][INFO] - Step: 120/1035  |  Loss: 1.3664  |  Score: 66.22 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:18,514][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 12:00:18,515][root][INFO] - Score: 75.25 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-22 12:00:21,511][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 12:00:21,511][root][INFO] - Score: 69.27 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-22 12:00:21,513][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-22 12:00:21,513][root][INFO] - 
[5/ 15 Epoch]
[2024-09-22 12:00:23,428][root][INFO] - Step: 240/1035  |  Loss: 0.7167  |  Score: 79.44 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:25,841][root][INFO] - Step: 285/1035  |  Loss: 0.8415  |  Score: 80.05 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:26,297][root][INFO] - Step: 135/1035  |  Loss: 1.4570  |  Score: 62.44 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:27,915][root][INFO] - Step: 138/1035  |  Loss: 1.2473  |  Score: 69.75 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:28,932][root][INFO] - Step: 255/1035  |  Loss: 0.7462  |  Score: 80.62 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:32,482][root][INFO] - Step: 300/1035  |  Loss: 0.8839  |  Score: 75.19 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:32,933][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 12:00:32,933][root][INFO] - Score: 75.19 [%]  |  Evaluation Time: 5.02 [s]
[2024-09-22 12:00:34,439][root][INFO] - Step: 270/1035  |  Loss: 0.8303  |  Score: 80.09 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:36,714][root][INFO] - Step: 276/1035  |  Loss: 1.0444  |  Score: 73.26 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:37,583][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 12:00:37,583][root][INFO] - Score: 68.96 [%]  |  Evaluation Time: 4.65 [s]
[2024-09-22 12:00:37,584][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 12:00:37,585][root][INFO] - 
[3/ 15 Epoch]
[2024-09-22 12:00:39,114][root][INFO] - Step: 315/1035  |  Loss: 0.8509  |  Score: 76.55 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:39,755][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 12:00:39,755][root][INFO] - Score: 76.08 [%]  |  Evaluation Time: 3.04 [s]
[2024-09-22 12:00:42,687][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 12:00:42,687][root][INFO] - Score: 67.32 [%]  |  Evaluation Time: 2.93 [s]
[2024-09-22 12:00:42,689][root][INFO] - 
[5/ 15 Epoch]
[2024-09-22 12:00:44,082][root][INFO] - Step: 150/1035  |  Loss: 0.9850  |  Score: 73.53 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:45,755][root][INFO] - Step: 330/1035  |  Loss: 0.8143  |  Score: 78.70 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:46,279][root][INFO] - Step: 285/1035  |  Loss: 0.8080  |  Score: 83.18 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:51,778][root][INFO] - Step: 300/1035  |  Loss: 0.6927  |  Score: 82.93 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:51,807][root][INFO] - Step: 165/1035  |  Loss: 1.0567  |  Score: 75.65 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:52,521][root][INFO] - Step: 345/1035  |  Loss: 0.8637  |  Score: 74.66 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:55,635][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 12:00:55,635][root][INFO] - Score: 76.12 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-22 12:00:57,283][root][INFO] - Step: 315/1035  |  Loss: 0.5970  |  Score: 83.64 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:58,701][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 12:00:58,702][root][INFO] - Score: 68.25 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-22 12:00:58,704][root][INFO] - 
[6/ 15 Epoch]
[2024-09-22 12:00:59,551][root][INFO] - Step: 346/1035  |  Loss: 0.7462  |  Score: 73.86 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:59,589][root][INFO] - Step: 180/1035  |  Loss: 1.0289  |  Score: 70.80 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:02,832][root][INFO] - Step: 330/1035  |  Loss: 0.6533  |  Score: 82.61 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:05,748][root][INFO] - Step: 360/1035  |  Loss: 0.7617  |  Score: 80.02 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:07,258][root][INFO] - Step: 195/1035  |  Loss: 0.9486  |  Score: 71.78 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:08,409][root][INFO] - Step: 345/1035  |  Loss: 0.6662  |  Score: 81.67 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:11,505][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 12:01:11,505][root][INFO] - Score: 77.41 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-22 12:01:12,382][root][INFO] - Step: 375/1035  |  Loss: 0.7211  |  Score: 79.47 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:13,492][root][INFO] - Step: 207/1035  |  Loss: 0.9271  |  Score: 76.23 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:14,467][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 12:01:14,467][root][INFO] - Score: 71.41 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-22 12:01:14,469][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-22 12:01:14,470][root][INFO] - 
[6/ 15 Epoch]
[2024-09-22 12:01:15,180][root][INFO] - Step: 346/1035  |  Loss: 0.5794  |  Score: 85.84 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:18,443][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 12:01:18,444][root][INFO] - Score: 75.56 [%]  |  Evaluation Time: 4.95 [s]
[2024-09-22 12:01:19,019][root][INFO] - Step: 390/1035  |  Loss: 0.7668  |  Score: 78.96 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:20,321][root][INFO] - Step: 360/1035  |  Loss: 0.5790  |  Score: 86.03 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:23,146][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 12:01:23,146][root][INFO] - Score: 64.79 [%]  |  Evaluation Time: 4.70 [s]
[2024-09-22 12:01:23,150][root][INFO] - 
[4/ 15 Epoch]
[2024-09-22 12:01:25,100][root][INFO] - Step: 210/1035  |  Loss: 1.5042  |  Score: 71.68 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:25,658][root][INFO] - Step: 405/1035  |  Loss: 0.7667  |  Score: 79.12 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:25,833][root][INFO] - Step: 375/1035  |  Loss: 0.6390  |  Score: 86.58 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:29,687][root][INFO] - Step: 414/1035  |  Loss: 0.7389  |  Score: 77.81 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:31,337][root][INFO] - Step: 390/1035  |  Loss: 0.5513  |  Score: 84.65 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:32,802][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-22 12:01:32,802][root][INFO] - Score: 76.38 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-22 12:01:32,869][root][INFO] - Step: 225/1035  |  Loss: 0.9006  |  Score: 77.52 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:35,837][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-22 12:01:35,837][root][INFO] - Score: 69.59 [%]  |  Evaluation Time: 3.03 [s]
[2024-09-22 12:01:35,838][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-22 12:01:35,839][root][INFO] - 
[7/ 15 Epoch]
[2024-09-22 12:01:36,853][root][INFO] - Step: 405/1035  |  Loss: 0.5375  |  Score: 85.45 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:38,818][root][INFO] - Step: 420/1035  |  Loss: 0.7207  |  Score: 80.19 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:40,251][root][INFO] - Step: 414/1035  |  Loss: 0.5649  |  Score: 86.26 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:40,614][root][INFO] - Step: 240/1035  |  Loss: 0.9769  |  Score: 76.65 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:43,310][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-22 12:01:43,310][root][INFO] - Score: 77.15 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-22 12:01:45,449][root][INFO] - Step: 435/1035  |  Loss: 0.7045  |  Score: 80.49 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:46,305][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-22 12:01:46,305][root][INFO] - Score: 72.08 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-22 12:01:46,306][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-22 12:01:46,307][root][INFO] - 
[7/ 15 Epoch]
[2024-09-22 12:01:48,325][root][INFO] - Step: 255/1035  |  Loss: 0.8494  |  Score: 78.27 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:48,818][root][INFO] - Step: 420/1035  |  Loss: 0.5044  |  Score: 86.75 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:52,072][root][INFO] - Step: 450/1035  |  Loss: 0.6882  |  Score: 80.92 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:54,329][root][INFO] - Step: 435/1035  |  Loss: 0.4187  |  Score: 89.69 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:55,991][root][INFO] - Step: 270/1035  |  Loss: 0.8454  |  Score: 79.67 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:58,720][root][INFO] - Step: 465/1035  |  Loss: 0.6271  |  Score: 82.42 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:59,146][root][INFO] - Step: 276/1035  |  Loss: 0.8400  |  Score: 78.02 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:59,861][root][INFO] - Step: 450/1035  |  Loss: 0.4200  |  Score: 88.86 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:04,109][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 12:02:04,109][root][INFO] - Score: 77.50 [%]  |  Evaluation Time: 4.96 [s]
[2024-09-22 12:02:05,372][root][INFO] - Step: 480/1035  |  Loss: 0.6760  |  Score: 80.69 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:05,377][root][INFO] - Step: 465/1035  |  Loss: 0.4482  |  Score: 88.22 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:06,755][root][INFO] - Step: 483/1035  |  Loss: 0.6893  |  Score: 82.95 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:08,859][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 12:02:08,859][root][INFO] - Score: 71.07 [%]  |  Evaluation Time: 4.75 [s]
[2024-09-22 12:02:08,860][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-22 12:02:08,862][root][INFO] - 
[5/ 15 Epoch]
[2024-09-22 12:02:09,857][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-22 12:02:09,857][root][INFO] - Score: 76.28 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-22 12:02:10,883][root][INFO] - Step: 480/1035  |  Loss: 0.5186  |  Score: 86.37 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:12,052][root][INFO] - Step: 483/1035  |  Loss: 0.4487  |  Score: 87.20 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:12,959][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-22 12:02:12,959][root][INFO] - Score: 70.63 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-22 12:02:12,960][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-22 12:02:12,961][root][INFO] - 
[8/ 15 Epoch]
[2024-09-22 12:02:13,842][root][INFO] - Step: 285/1035  |  Loss: 0.6245  |  Score: 85.09 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:15,107][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-22 12:02:15,108][root][INFO] - Score: 77.43 [%]  |  Evaluation Time: 3.05 [s]
[2024-09-22 12:02:18,061][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-22 12:02:18,061][root][INFO] - Score: 70.79 [%]  |  Evaluation Time: 2.95 [s]
[2024-09-22 12:02:18,063][root][INFO] - 
[8/ 15 Epoch]
[2024-09-22 12:02:18,592][root][INFO] - Step: 495/1035  |  Loss: 0.6492  |  Score: 83.33 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:21,724][root][INFO] - Step: 300/1035  |  Loss: 0.6615  |  Score: 83.40 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:22,796][root][INFO] - Step: 495/1035  |  Loss: 0.3584  |  Score: 89.50 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:25,242][root][INFO] - Step: 510/1035  |  Loss: 0.6083  |  Score: 83.50 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:28,311][root][INFO] - Step: 510/1035  |  Loss: 0.3816  |  Score: 89.88 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:29,468][root][INFO] - Step: 315/1035  |  Loss: 0.7818  |  Score: 80.43 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:31,881][root][INFO] - Step: 525/1035  |  Loss: 0.6877  |  Score: 82.08 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:33,823][root][INFO] - Step: 525/1035  |  Loss: 0.4137  |  Score: 88.79 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:37,167][root][INFO] - Step: 330/1035  |  Loss: 0.6478  |  Score: 81.73 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:38,522][root][INFO] - Step: 540/1035  |  Loss: 0.5530  |  Score: 83.80 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:39,341][root][INFO] - Step: 540/1035  |  Loss: 0.3856  |  Score: 90.04 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:43,802][root][INFO] - Step: 552/1035  |  Loss: 0.3568  |  Score: 89.48 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:43,888][root][INFO] - Step: 552/1035  |  Loss: 0.5821  |  Score: 84.73 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:44,984][root][INFO] - Step: 345/1035  |  Loss: 0.6837  |  Score: 83.14 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:46,951][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-22 12:02:46,951][root][INFO] - Score: 76.93 [%]  |  Evaluation Time: 3.15 [s]
[2024-09-22 12:02:47,000][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-22 12:02:47,000][root][INFO] - Score: 76.74 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-22 12:02:49,905][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 12:02:49,905][root][INFO] - Score: 78.41 [%]  |  Evaluation Time: 4.92 [s]
[2024-09-22 12:02:49,940][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-22 12:02:49,941][root][INFO] - Score: 70.39 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-22 12:02:49,943][root][INFO] - 
[9/ 15 Epoch]
[2024-09-22 12:02:50,055][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-22 12:02:50,056][root][INFO] - Score: 70.58 [%]  |  Evaluation Time: 3.05 [s]
[2024-09-22 12:02:50,057][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-22 12:02:50,058][root][INFO] - 
[9/ 15 Epoch]
[2024-09-22 12:02:51,442][root][INFO] - Step: 555/1035  |  Loss: 0.3453  |  Score: 91.02 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:51,770][root][INFO] - Step: 555/1035  |  Loss: 0.6641  |  Score: 84.31 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:54,629][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 12:02:54,629][root][INFO] - Score: 71.75 [%]  |  Evaluation Time: 4.72 [s]
[2024-09-22 12:02:54,631][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-22 12:02:54,632][root][INFO] - 
[6/ 15 Epoch]
[2024-09-22 12:02:55,550][root][INFO] - Step: 346/1035  |  Loss: 0.6052  |  Score: 82.28 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:56,970][root][INFO] - Step: 570/1035  |  Loss: 0.3059  |  Score: 91.17 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:58,429][root][INFO] - Step: 570/1035  |  Loss: 0.5409  |  Score: 85.73 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:02,493][root][INFO] - Step: 585/1035  |  Loss: 0.3197  |  Score: 91.29 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:02,900][root][INFO] - Step: 360/1035  |  Loss: 0.4917  |  Score: 86.02 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:05,071][root][INFO] - Step: 585/1035  |  Loss: 0.5563  |  Score: 84.05 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:08,012][root][INFO] - Step: 600/1035  |  Loss: 0.3100  |  Score: 91.24 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:10,682][root][INFO] - Step: 375/1035  |  Loss: 0.5801  |  Score: 85.01 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:11,703][root][INFO] - Step: 600/1035  |  Loss: 0.6130  |  Score: 82.50 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:13,535][root][INFO] - Step: 615/1035  |  Loss: 0.3032  |  Score: 91.24 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:15,800][root][INFO] - Step: 621/1035  |  Loss: 0.3650  |  Score: 89.63 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:18,370][root][INFO] - Step: 615/1035  |  Loss: 0.6072  |  Score: 82.49 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:18,404][root][INFO] - Step: 390/1035  |  Loss: 0.5132  |  Score: 86.01 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:18,901][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-22 12:03:18,901][root][INFO] - Score: 76.39 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-22 12:03:21,080][root][INFO] - Step: 621/1035  |  Loss: 0.6412  |  Score: 82.42 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:21,851][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-22 12:03:21,851][root][INFO] - Score: 70.30 [%]  |  Evaluation Time: 2.95 [s]
[2024-09-22 12:03:21,853][root][INFO] - 
[10/ 15 Epoch]
[2024-09-22 12:03:24,252][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-22 12:03:24,252][root][INFO] - Score: 77.24 [%]  |  Evaluation Time: 3.17 [s]
[2024-09-22 12:03:25,509][root][INFO] - Step: 630/1035  |  Loss: 0.2710  |  Score: 93.32 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:26,144][root][INFO] - Step: 405/1035  |  Loss: 0.5340  |  Score: 85.88 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:27,347][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-22 12:03:27,348][root][INFO] - Score: 70.02 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-22 12:03:27,350][root][INFO] - 
[10/ 15 Epoch]
[2024-09-22 12:03:30,813][root][INFO] - Step: 414/1035  |  Loss: 0.6192  |  Score: 85.43 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:31,028][root][INFO] - Step: 645/1035  |  Loss: 0.2770  |  Score: 93.11 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:31,767][root][INFO] - Step: 630/1035  |  Loss: 0.5463  |  Score: 84.95 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:35,863][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-22 12:03:35,863][root][INFO] - Score: 77.34 [%]  |  Evaluation Time: 5.05 [s]
[2024-09-22 12:03:36,560][root][INFO] - Step: 660/1035  |  Loss: 0.2689  |  Score: 91.97 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:38,493][root][INFO] - Step: 645/1035  |  Loss: 0.5209  |  Score: 84.41 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:40,458][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-22 12:03:40,458][root][INFO] - Score: 71.78 [%]  |  Evaluation Time: 4.59 [s]
[2024-09-22 12:03:40,460][root][INFO] - 
[7/ 15 Epoch]
[2024-09-22 12:03:42,082][root][INFO] - Step: 675/1035  |  Loss: 0.2797  |  Score: 91.83 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:43,911][root][INFO] - Step: 420/1035  |  Loss: 0.5195  |  Score: 89.09 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:45,132][root][INFO] - Step: 660/1035  |  Loss: 0.5318  |  Score: 84.75 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:47,650][root][INFO] - Step: 690/1035  |  Loss: 0.2749  |  Score: 92.26 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:50,726][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-22 12:03:50,726][root][INFO] - Score: 77.28 [%]  |  Evaluation Time: 3.07 [s]
[2024-09-22 12:03:51,655][root][INFO] - Step: 435/1035  |  Loss: 0.4062  |  Score: 89.13 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:51,775][root][INFO] - Step: 675/1035  |  Loss: 0.5015  |  Score: 87.32 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:53,680][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-22 12:03:53,680][root][INFO] - Score: 70.83 [%]  |  Evaluation Time: 2.95 [s]
[2024-09-22 12:03:53,682][root][INFO] - 
[11/ 15 Epoch]
[2024-09-22 12:03:54,349][root][INFO] - Step: 691/1035  |  Loss: 0.2234  |  Score: 94.03 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:58,463][root][INFO] - Step: 690/1035  |  Loss: 0.5613  |  Score: 83.91 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:59,405][root][INFO] - Step: 450/1035  |  Loss: 0.4256  |  Score: 89.22 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:59,497][root][INFO] - Step: 705/1035  |  Loss: 0.2406  |  Score: 93.55 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:01,564][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-22 12:04:01,564][root][INFO] - Score: 76.16 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-22 12:04:04,578][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-22 12:04:04,579][root][INFO] - Score: 70.79 [%]  |  Evaluation Time: 3.01 [s]
[2024-09-22 12:04:04,581][root][INFO] - 
[11/ 15 Epoch]
[2024-09-22 12:04:05,021][root][INFO] - Step: 720/1035  |  Loss: 0.2420  |  Score: 92.89 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:05,367][root][INFO] - Step: 691/1035  |  Loss: 0.7158  |  Score: 79.19 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:07,165][root][INFO] - Step: 465/1035  |  Loss: 0.4367  |  Score: 86.05 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:10,556][root][INFO] - Step: 735/1035  |  Loss: 0.2353  |  Score: 93.53 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:11,706][root][INFO] - Step: 705/1035  |  Loss: 0.5126  |  Score: 86.03 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:14,805][root][INFO] - Step: 480/1035  |  Loss: 0.4596  |  Score: 86.36 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:16,088][root][INFO] - Step: 750/1035  |  Loss: 0.2430  |  Score: 93.42 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:16,420][root][INFO] - Step: 483/1035  |  Loss: 0.4443  |  Score: 88.90 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:18,437][root][INFO] - Step: 720/1035  |  Loss: 0.5080  |  Score: 85.23 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:19,449][root][INFO] - Step: 759/1035  |  Loss: 0.2500  |  Score: 93.67 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:21,402][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-22 12:04:21,403][root][INFO] - Score: 79.17 [%]  |  Evaluation Time: 4.98 [s]
[2024-09-22 12:04:22,535][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-22 12:04:22,535][root][INFO] - Score: 78.17 [%]  |  Evaluation Time: 3.08 [s]
[2024-09-22 12:04:25,076][root][INFO] - Step: 735/1035  |  Loss: 0.5225  |  Score: 85.36 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:25,572][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-22 12:04:25,572][root][INFO] - Score: 70.19 [%]  |  Evaluation Time: 3.03 [s]
[2024-09-22 12:04:25,574][root][INFO] - 
[12/ 15 Epoch]
[2024-09-22 12:04:26,161][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-22 12:04:26,161][root][INFO] - Score: 70.27 [%]  |  Evaluation Time: 4.76 [s]
[2024-09-22 12:04:26,163][root][INFO] - 
[8/ 15 Epoch]
[2024-09-22 12:04:28,162][root][INFO] - Step: 765/1035  |  Loss: 0.2042  |  Score: 93.55 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:31,735][root][INFO] - Step: 750/1035  |  Loss: 0.4950  |  Score: 85.57 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:32,799][root][INFO] - Step: 495/1035  |  Loss: 0.3609  |  Score: 89.80 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:33,686][root][INFO] - Step: 780/1035  |  Loss: 0.2144  |  Score: 93.92 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:35,794][root][INFO] - Step: 759/1035  |  Loss: 0.4440  |  Score: 87.10 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:38,929][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-22 12:04:38,929][root][INFO] - Score: 76.23 [%]  |  Evaluation Time: 3.13 [s]
[2024-09-22 12:04:39,211][root][INFO] - Step: 795/1035  |  Loss: 0.2127  |  Score: 94.16 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:40,533][root][INFO] - Step: 510/1035  |  Loss: 0.3864  |  Score: 88.59 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:41,934][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-22 12:04:41,934][root][INFO] - Score: 70.93 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-22 12:04:41,936][root][INFO] - 
[12/ 15 Epoch]
[2024-09-22 12:04:44,753][root][INFO] - Step: 810/1035  |  Loss: 0.2118  |  Score: 93.98 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:44,928][root][INFO] - Step: 765/1035  |  Loss: 0.4444  |  Score: 87.66 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:48,229][root][INFO] - Step: 525/1035  |  Loss: 0.3917  |  Score: 89.04 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:50,298][root][INFO] - Step: 825/1035  |  Loss: 0.2304  |  Score: 93.48 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:51,462][root][INFO] - Step: 828/1035  |  Loss: 0.1625  |  Score: 95.29 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:51,589][root][INFO] - Step: 780/1035  |  Loss: 0.5246  |  Score: 85.74 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:54,541][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-22 12:04:54,541][root][INFO] - Score: 77.60 [%]  |  Evaluation Time: 3.08 [s]
[2024-09-22 12:04:55,965][root][INFO] - Step: 540/1035  |  Loss: 0.4193  |  Score: 90.05 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:57,537][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-22 12:04:57,537][root][INFO] - Score: 70.55 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-22 12:04:57,539][root][INFO] - 
[13/ 15 Epoch]
[2024-09-22 12:04:58,262][root][INFO] - Step: 795/1035  |  Loss: 0.5291  |  Score: 86.89 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:02,223][root][INFO] - Step: 552/1035  |  Loss: 0.4098  |  Score: 89.83 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:02,289][root][INFO] - Step: 840/1035  |  Loss: 0.1900  |  Score: 94.74 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:04,901][root][INFO] - Step: 810/1035  |  Loss: 0.5230  |  Score: 84.09 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:07,263][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-22 12:05:07,263][root][INFO] - Score: 77.20 [%]  |  Evaluation Time: 5.04 [s]
[2024-09-22 12:05:07,815][root][INFO] - Step: 855/1035  |  Loss: 0.1868  |  Score: 94.73 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:11,552][root][INFO] - Step: 825/1035  |  Loss: 0.4801  |  Score: 86.70 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:12,026][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-22 12:05:12,027][root][INFO] - Score: 69.94 [%]  |  Evaluation Time: 4.76 [s]
[2024-09-22 12:05:12,029][root][INFO] - 
[9/ 15 Epoch]
[2024-09-22 12:05:12,942][root][INFO] - Step: 828/1035  |  Loss: 0.5014  |  Score: 87.20 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:13,380][root][INFO] - Step: 870/1035  |  Loss: 0.1799  |  Score: 94.67 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:13,924][root][INFO] - Step: 555/1035  |  Loss: 0.3242  |  Score: 91.28 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:16,107][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-22 12:05:16,108][root][INFO] - Score: 76.35 [%]  |  Evaluation Time: 3.16 [s]
[2024-09-22 12:05:18,968][root][INFO] - Step: 885/1035  |  Loss: 0.1888  |  Score: 94.52 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:19,138][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-22 12:05:19,138][root][INFO] - Score: 72.65 [%]  |  Evaluation Time: 3.03 [s]
[2024-09-22 12:05:19,139][root][INFO] - 
Save new Best Score (Epoch: 12)
[2024-09-22 12:05:19,140][root][INFO] - 
[13/ 15 Epoch]
[2024-09-22 12:05:21,622][root][INFO] - Step: 570/1035  |  Loss: 0.3073  |  Score: 90.82 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:23,452][root][INFO] - Step: 897/1035  |  Loss: 0.1910  |  Score: 94.20 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:24,813][root][INFO] - Step: 840/1035  |  Loss: 0.4407  |  Score: 87.55 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:26,491][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-22 12:05:26,491][root][INFO] - Score: 78.06 [%]  |  Evaluation Time: 3.04 [s]
[2024-09-22 12:05:29,421][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-22 12:05:29,421][root][INFO] - Score: 70.68 [%]  |  Evaluation Time: 2.93 [s]
[2024-09-22 12:05:29,423][root][INFO] - 
[14/ 15 Epoch]
[2024-09-22 12:05:29,473][root][INFO] - Step: 585/1035  |  Loss: 0.2809  |  Score: 92.11 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:30,860][root][INFO] - Step: 900/1035  |  Loss: 0.2097  |  Score: 92.28 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:31,473][root][INFO] - Step: 855/1035  |  Loss: 0.4874  |  Score: 86.51 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:36,381][root][INFO] - Step: 915/1035  |  Loss: 0.1995  |  Score: 93.99 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:37,285][root][INFO] - Step: 600/1035  |  Loss: 0.3272  |  Score: 89.96 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:38,113][root][INFO] - Step: 870/1035  |  Loss: 0.4658  |  Score: 86.42 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:41,900][root][INFO] - Step: 930/1035  |  Loss: 0.1800  |  Score: 94.80 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:44,763][root][INFO] - Step: 885/1035  |  Loss: 0.4758  |  Score: 87.55 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:45,013][root][INFO] - Step: 615/1035  |  Loss: 0.2994  |  Score: 91.75 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:47,434][root][INFO] - Step: 945/1035  |  Loss: 0.1770  |  Score: 94.94 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:48,143][root][INFO] - Step: 621/1035  |  Loss: 0.3467  |  Score: 91.94 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:50,125][root][INFO] - Step: 897/1035  |  Loss: 0.5108  |  Score: 84.81 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:52,977][root][INFO] - Step: 960/1035  |  Loss: 0.1681  |  Score: 95.06 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:53,088][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-22 12:05:53,088][root][INFO] - Score: 78.48 [%]  |  Evaluation Time: 4.94 [s]
[2024-09-22 12:05:53,261][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-22 12:05:53,261][root][INFO] - Score: 77.15 [%]  |  Evaluation Time: 3.13 [s]
[2024-09-22 12:05:55,243][root][INFO] - Step: 966/1035  |  Loss: 0.1857  |  Score: 94.93 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:56,258][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-22 12:05:56,258][root][INFO] - Score: 71.48 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-22 12:05:56,260][root][INFO] - 
[14/ 15 Epoch]
[2024-09-22 12:05:57,836][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-22 12:05:57,837][root][INFO] - Score: 69.86 [%]  |  Evaluation Time: 4.75 [s]
[2024-09-22 12:05:57,839][root][INFO] - 
[10/ 15 Epoch]
[2024-09-22 12:05:58,024][root][INFO] - Step: 900/1035  |  Loss: 0.5248  |  Score: 86.56 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:58,294][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-22 12:05:58,294][root][INFO] - Score: 77.09 [%]  |  Evaluation Time: 3.05 [s]
[2024-09-22 12:06:01,301][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-22 12:06:01,301][root][INFO] - Score: 71.07 [%]  |  Evaluation Time: 3.01 [s]
[2024-09-22 12:06:01,304][root][INFO] - 
[15/ 15 Epoch]
[2024-09-22 12:06:02,894][root][INFO] - Step: 630/1035  |  Loss: 0.2500  |  Score: 92.62 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:04,698][root][INFO] - Step: 915/1035  |  Loss: 0.4802  |  Score: 86.96 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:04,943][root][INFO] - Step: 975/1035  |  Loss: 0.1916  |  Score: 94.68 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:10,464][root][INFO] - Step: 990/1035  |  Loss: 0.1817  |  Score: 95.28 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:10,756][root][INFO] - Step: 645/1035  |  Loss: 0.2697  |  Score: 93.09 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:11,367][root][INFO] - Step: 930/1035  |  Loss: 0.4581  |  Score: 85.86 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:15,983][root][INFO] - Step: 1005/1035  |  Loss: 0.1835  |  Score: 94.60 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:18,024][root][INFO] - Step: 945/1035  |  Loss: 0.4580  |  Score: 87.11 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:18,627][root][INFO] - Step: 660/1035  |  Loss: 0.2729  |  Score: 92.22 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:21,499][root][INFO] - Step: 1020/1035  |  Loss: 0.1829  |  Score: 94.33 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:24,697][root][INFO] - Step: 960/1035  |  Loss: 0.4721  |  Score: 86.85 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:26,473][root][INFO] - Step: 675/1035  |  Loss: 0.2459  |  Score: 92.51 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:27,062][root][INFO] - Step: 1035/1035  |  Loss: 0.1874  |  Score: 93.84 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:27,400][root][INFO] - Step: 966/1035  |  Loss: 0.4748  |  Score: 86.52 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:30,180][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-22 12:06:30,180][root][INFO] - Score: 77.85 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-22 12:06:30,533][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-22 12:06:30,533][root][INFO] - Score: 77.11 [%]  |  Evaluation Time: 3.13 [s]
[2024-09-22 12:06:33,113][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-22 12:06:33,113][root][INFO] - Score: 71.29 [%]  |  Evaluation Time: 2.93 [s]
[2024-09-22 12:06:33,114][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 12:06:33,115][root][INFO] - - Epoch: 6
[2024-09-22 12:06:33,115][root][INFO] - - DEV score: 77.15 [%]
[2024-09-22 12:06:33,115][root][INFO] - - TEST score: 72.08 [%]
[2024-09-22 12:06:33,116][root][INFO] - Fine-tuning is done!
[2024-09-22 12:06:33,538][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-22 12:06:33,538][root][INFO] - Score: 71.34 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-22 12:06:33,542][root][INFO] - 
[15/ 15 Epoch]
[2024-09-22 12:06:34,284][root][INFO] - Step: 690/1035  |  Loss: 0.2652  |  Score: 93.12 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:37,929][root][INFO] - Step: 975/1035  |  Loss: 0.3817  |  Score: 90.33 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:39,263][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-22 12:06:39,263][root][INFO] - Score: 77.96 [%]  |  Evaluation Time: 4.98 [s]
[2024-09-22 12:06:43,801][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-22 12:06:43,801][root][INFO] - Score: 69.58 [%]  |  Evaluation Time: 4.54 [s]
[2024-09-22 12:06:43,804][root][INFO] - 
[11/ 15 Epoch]
[2024-09-22 12:06:44,589][root][INFO] - Step: 990/1035  |  Loss: 0.4833  |  Score: 86.94 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:44,689][root][INFO] - Step: 691/1035  |  Loss: 0.2448  |  Score: 94.56 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:51,245][root][INFO] - Step: 1005/1035  |  Loss: 0.4339  |  Score: 87.52 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:51,855][root][INFO] - Step: 705/1035  |  Loss: 0.2304  |  Score: 93.79 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:57,900][root][INFO] - Step: 1020/1035  |  Loss: 0.4956  |  Score: 86.21 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:59,555][root][INFO] - Step: 720/1035  |  Loss: 0.2501  |  Score: 92.98 [%]  |  Seq Length: 256.0
[2024-09-22 12:07:04,601][root][INFO] - Step: 1035/1035  |  Loss: 0.4675  |  Score: 86.12 [%]  |  Seq Length: 256.0
[2024-09-22 12:07:07,287][root][INFO] - Step: 735/1035  |  Loss: 0.2484  |  Score: 93.34 [%]  |  Seq Length: 256.0
[2024-09-22 12:07:07,720][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-22 12:07:07,720][root][INFO] - Score: 76.71 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-22 12:07:10,760][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-22 12:07:10,760][root][INFO] - Score: 71.66 [%]  |  Evaluation Time: 3.04 [s]
[2024-09-22 12:07:10,761][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 12:07:10,762][root][INFO] - - Epoch: 12
[2024-09-22 12:07:10,762][root][INFO] - - DEV score: 76.35 [%]
[2024-09-22 12:07:10,762][root][INFO] - - TEST score: 72.65 [%]
[2024-09-22 12:07:10,763][root][INFO] - Fine-tuning is done!
[2024-09-22 12:07:14,956][root][INFO] - Step: 750/1035  |  Loss: 0.2348  |  Score: 93.82 [%]  |  Seq Length: 256.0
[2024-09-22 12:07:19,633][root][INFO] - Step: 759/1035  |  Loss: 0.2423  |  Score: 94.03 [%]  |  Seq Length: 256.0
[2024-09-22 12:07:24,519][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-22 12:07:24,519][root][INFO] - Score: 78.06 [%]  |  Evaluation Time: 4.88 [s]
[2024-09-22 12:07:29,175][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-22 12:07:29,175][root][INFO] - Score: 71.06 [%]  |  Evaluation Time: 4.65 [s]
[2024-09-22 12:07:29,177][root][INFO] - 
[12/ 15 Epoch]
[2024-09-22 12:07:32,673][root][INFO] - Step: 765/1035  |  Loss: 0.2229  |  Score: 94.65 [%]  |  Seq Length: 256.0
[2024-09-22 12:07:40,407][root][INFO] - Step: 780/1035  |  Loss: 0.2147  |  Score: 93.82 [%]  |  Seq Length: 256.0
[2024-09-22 12:07:48,148][root][INFO] - Step: 795/1035  |  Loss: 0.1919  |  Score: 94.78 [%]  |  Seq Length: 256.0
[2024-09-22 12:07:55,764][root][INFO] - Step: 810/1035  |  Loss: 0.1901  |  Score: 93.81 [%]  |  Seq Length: 256.0
[2024-09-22 12:08:03,397][root][INFO] - Step: 825/1035  |  Loss: 0.1926  |  Score: 94.45 [%]  |  Seq Length: 256.0
[2024-09-22 12:08:04,997][root][INFO] - Step: 828/1035  |  Loss: 0.2197  |  Score: 94.66 [%]  |  Seq Length: 256.0
[2024-09-22 12:08:09,878][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-22 12:08:09,879][root][INFO] - Score: 78.99 [%]  |  Evaluation Time: 4.88 [s]
[2024-09-22 12:08:14,493][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-22 12:08:14,493][root][INFO] - Score: 70.67 [%]  |  Evaluation Time: 4.61 [s]
[2024-09-22 12:08:14,496][root][INFO] - 
[13/ 15 Epoch]
[2024-09-22 12:08:20,955][root][INFO] - Step: 840/1035  |  Loss: 0.1851  |  Score: 95.15 [%]  |  Seq Length: 256.0
[2024-09-22 12:08:28,681][root][INFO] - Step: 855/1035  |  Loss: 0.1860  |  Score: 94.60 [%]  |  Seq Length: 256.0
[2024-09-22 12:08:36,342][root][INFO] - Step: 870/1035  |  Loss: 0.1954  |  Score: 94.64 [%]  |  Seq Length: 256.0
[2024-09-22 12:08:44,037][root][INFO] - Step: 885/1035  |  Loss: 0.1810  |  Score: 94.78 [%]  |  Seq Length: 256.0
[2024-09-22 12:08:50,228][root][INFO] - Step: 897/1035  |  Loss: 0.1887  |  Score: 94.72 [%]  |  Seq Length: 256.0
[2024-09-22 12:08:55,122][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-22 12:08:55,122][root][INFO] - Score: 78.88 [%]  |  Evaluation Time: 4.89 [s]
[2024-09-22 12:08:59,707][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-22 12:08:59,707][root][INFO] - Score: 70.55 [%]  |  Evaluation Time: 4.58 [s]
[2024-09-22 12:08:59,710][root][INFO] - 
[14/ 15 Epoch]
[2024-09-22 12:09:01,653][root][INFO] - Step: 900/1035  |  Loss: 0.1624  |  Score: 95.40 [%]  |  Seq Length: 256.0
[2024-09-22 12:09:09,343][root][INFO] - Step: 915/1035  |  Loss: 0.1665  |  Score: 94.89 [%]  |  Seq Length: 256.0
[2024-09-22 12:09:17,023][root][INFO] - Step: 930/1035  |  Loss: 0.1847  |  Score: 95.17 [%]  |  Seq Length: 256.0
[2024-09-22 12:09:24,689][root][INFO] - Step: 945/1035  |  Loss: 0.1707  |  Score: 94.69 [%]  |  Seq Length: 256.0
[2024-09-22 12:09:32,401][root][INFO] - Step: 960/1035  |  Loss: 0.1808  |  Score: 95.44 [%]  |  Seq Length: 256.0
[2024-09-22 12:09:35,521][root][INFO] - Step: 966/1035  |  Loss: 0.1863  |  Score: 94.11 [%]  |  Seq Length: 256.0
[2024-09-22 12:09:40,343][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-22 12:09:40,343][root][INFO] - Score: 78.47 [%]  |  Evaluation Time: 4.82 [s]
[2024-09-22 12:09:45,013][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-22 12:09:45,013][root][INFO] - Score: 71.47 [%]  |  Evaluation Time: 4.67 [s]
[2024-09-22 12:09:45,016][root][INFO] - 
[15/ 15 Epoch]
[2024-09-22 12:09:50,003][root][INFO] - Step: 975/1035  |  Loss: 0.1725  |  Score: 94.58 [%]  |  Seq Length: 256.0
[2024-09-22 12:09:57,725][root][INFO] - Step: 990/1035  |  Loss: 0.1651  |  Score: 95.29 [%]  |  Seq Length: 256.0
[2024-09-22 12:10:05,401][root][INFO] - Step: 1005/1035  |  Loss: 0.1560  |  Score: 95.00 [%]  |  Seq Length: 256.0
[2024-09-22 12:10:13,052][root][INFO] - Step: 1020/1035  |  Loss: 0.1843  |  Score: 95.02 [%]  |  Seq Length: 256.0
[2024-09-22 12:10:20,771][root][INFO] - Step: 1035/1035  |  Loss: 0.1750  |  Score: 95.00 [%]  |  Seq Length: 256.0
[2024-09-22 12:10:25,684][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-22 12:10:25,686][root][INFO] - Score: 79.54 [%]  |  Evaluation Time: 4.91 [s]
[2024-09-22 12:10:30,360][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-22 12:10:30,360][root][INFO] - Score: 71.36 [%]  |  Evaluation Time: 4.67 [s]
[2024-09-22 12:10:30,361][root][INFO] - 
Save new Best Score (Epoch: 15)
[2024-09-22 12:10:30,361][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 12:10:30,361][root][INFO] - - Epoch: 15
[2024-09-22 12:10:30,361][root][INFO] - - DEV score: 79.54 [%]
[2024-09-22 12:10:30,361][root][INFO] - - TEST score: 71.36 [%]
[2024-09-22 12:10:30,362][root][INFO] - Fine-tuning is done!
[2024-09-22 12:15:10,317][root][INFO] - 

[2024-09-22 12:15:10,317][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 12:15:10,317][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.0001lr_42rs
[2024-09-22 12:15:10,317][root][INFO] - 

[2024-09-22 12:15:10,317][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'PAWS_X'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.0001, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 75, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.0001lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.0001lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.0001lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 12:15:19,017][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 12:15:19,550][root][INFO] - 

[2024-09-22 12:15:19,550][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 12:15:19,550][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs
[2024-09-22 12:15:19,550][root][INFO] - 

[2024-09-22 12:15:19,550][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'PAWS_X'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 75, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 12:15:20,838][root][INFO] - 

[2024-09-22 12:15:20,839][root][INFO] - ========== Fine-tuning on PAWS_X ==========
[2024-09-22 12:15:20,839][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 12:15:20,855][root][INFO] - vocab size              : 51200
[2024-09-22 12:15:20,855][root][INFO] - device                  : gpu
[2024-09-22 12:15:20,855][root][INFO] - random seed             : 42
[2024-09-22 12:15:20,855][root][INFO] - train data size         : 24256
[2024-09-22 12:15:20,856][root][INFO] - max epochs              : 5
[2024-09-22 12:15:20,856][root][INFO] - total steps             : 1895
[2024-09-22 12:15:20,856][root][INFO] - warmup steps            : 190
[2024-09-22 12:15:20,856][root][INFO] - batch size              : 64
[2024-09-22 12:15:20,856][root][INFO] - accumulation steps      : 1
[2024-09-22 12:15:20,856][root][INFO] - optimizer               : adamwscale
[2024-09-22 12:15:20,856][root][INFO] - lr_scheduler            : cosine
[2024-09-22 12:15:20,856][root][INFO] - learning rate           : 0.0001
[2024-09-22 12:15:20,857][root][INFO] - max length              : 256

[2024-09-22 12:15:20,857][root][INFO] - 

[2024-09-22 12:15:20,857][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.0001lr_42rs
[2024-09-22 12:15:20,857][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.0001lr_42rs/ckpt
[2024-09-22 12:15:20,857][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.0001lr_42rs/tb
[2024-09-22 12:15:20,857][root][INFO] - * tb interval           : 75

[2024-09-22 12:15:20,857][root][INFO] - 

[2024-09-22 12:15:20,857][root][INFO] - Start the Training !
[2024-09-22 12:15:20,861][root][INFO] - 
[1/ 5 Epoch]
[2024-09-22 12:15:27,906][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:27,907][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:27,907][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:27,908][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:27,908][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:27,909][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:27,909][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:27,910][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:27,911][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:27,911][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:27,912][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:27,912][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:27,913][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:27,913][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:27,914][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:27,914][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:27,915][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:27,915][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:27,915][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:27,916][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:27,919][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:27,919][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:27,920][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:27,920][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:27,923][root][INFO] - Trainable params: 1769472 || all params: 126935040 || trainable: 1.39 %
[2024-09-22 12:15:28,106][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 12:15:29,813][root][INFO] - 

[2024-09-22 12:15:29,813][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 12:15:29,813][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs
[2024-09-22 12:15:29,813][root][INFO] - 

[2024-09-22 12:15:29,813][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'PAWS_X'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 75, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 12:15:30,074][root][INFO] - 

[2024-09-22 12:15:30,075][root][INFO] - ========== Fine-tuning on PAWS_X ==========
[2024-09-22 12:15:30,075][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 12:15:30,084][root][INFO] - vocab size              : 51200
[2024-09-22 12:15:30,084][root][INFO] - device                  : gpu
[2024-09-22 12:15:30,084][root][INFO] - random seed             : 42
[2024-09-22 12:15:30,085][root][INFO] - train data size         : 24256
[2024-09-22 12:15:30,085][root][INFO] - max epochs              : 5
[2024-09-22 12:15:30,085][root][INFO] - total steps             : 1895
[2024-09-22 12:15:30,085][root][INFO] - warmup steps            : 190
[2024-09-22 12:15:30,085][root][INFO] - batch size              : 64
[2024-09-22 12:15:30,085][root][INFO] - accumulation steps      : 1
[2024-09-22 12:15:30,085][root][INFO] - optimizer               : adamwscale
[2024-09-22 12:15:30,085][root][INFO] - lr_scheduler            : cosine
[2024-09-22 12:15:30,085][root][INFO] - learning rate           : 0.02
[2024-09-22 12:15:30,085][root][INFO] - max length              : 256

[2024-09-22 12:15:30,085][root][INFO] - LoRA Configuration
[2024-09-22 12:15:30,086][root][INFO] - ㄴ r                    : 32
[2024-09-22 12:15:30,086][root][INFO] - ㄴ alpha                : 128
[2024-09-22 12:15:30,086][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 12:15:30,086][root][INFO] - 

[2024-09-22 12:15:30,086][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs
[2024-09-22 12:15:30,086][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs/ckpt
[2024-09-22 12:15:30,086][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs/tb
[2024-09-22 12:15:30,086][root][INFO] - * tb interval           : 75

[2024-09-22 12:15:30,086][root][INFO] - 

[2024-09-22 12:15:30,086][root][INFO] - Start the Training !
[2024-09-22 12:15:30,090][root][INFO] - 
[1/ 5 Epoch]
[2024-09-22 12:15:38,098][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:38,099][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:38,099][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:38,099][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:38,100][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:38,100][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:38,101][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:38,101][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:38,102][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:38,102][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:38,102][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:38,103][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:38,103][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:38,104][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:38,104][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:38,105][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:38,105][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:38,105][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:38,106][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:38,106][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:38,108][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:38,109][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:38,109][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:38,109][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:38,111][root][INFO] - Trainable params: 1769472 || all params: 126935040 || trainable: 1.39 %
[2024-09-22 12:15:38,115][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-22 12:15:38,219][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-22 12:15:38,221][root][INFO] - Trainable params: 8985600 || all params: 134151168 || trainable: 6.70 %
[2024-09-22 12:15:38,400][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 12:15:41,529][root][INFO] - 

[2024-09-22 12:15:41,529][root][INFO] - ========== Fine-tuning on PAWS_X ==========
[2024-09-22 12:15:41,530][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 12:15:41,537][root][INFO] - vocab size              : 51200
[2024-09-22 12:15:41,538][root][INFO] - device                  : gpu
[2024-09-22 12:15:41,538][root][INFO] - random seed             : 42
[2024-09-22 12:15:41,538][root][INFO] - train data size         : 24256
[2024-09-22 12:15:41,538][root][INFO] - max epochs              : 5
[2024-09-22 12:15:41,538][root][INFO] - total steps             : 1895
[2024-09-22 12:15:41,538][root][INFO] - warmup steps            : 190
[2024-09-22 12:15:41,538][root][INFO] - batch size              : 64
[2024-09-22 12:15:41,538][root][INFO] - accumulation steps      : 1
[2024-09-22 12:15:41,538][root][INFO] - optimizer               : adamwscale
[2024-09-22 12:15:41,538][root][INFO] - lr_scheduler            : cosine
[2024-09-22 12:15:41,539][root][INFO] - learning rate           : 0.02
[2024-09-22 12:15:41,539][root][INFO] - max length              : 256

[2024-09-22 12:15:41,539][root][INFO] - LoRA Configuration
[2024-09-22 12:15:41,539][root][INFO] - ㄴ r                    : 32
[2024-09-22 12:15:41,539][root][INFO] - ㄴ alpha                : 128
[2024-09-22 12:15:41,539][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 12:15:41,539][root][INFO] - KOMBO Configuration
[2024-09-22 12:15:41,539][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-22 12:15:41,539][root][INFO] - ㄴ reducer              : linear
[2024-09-22 12:15:41,539][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-22 12:15:41,539][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-22 12:15:41,539][root][INFO] - ㄴ do_combination       : True
[2024-09-22 12:15:41,540][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-22 12:15:41,540][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-22 12:15:41,540][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-22 12:15:41,540][root][INFO] -   ㄴ add_lora           : False
[2024-09-22 12:15:41,540][root][INFO] - 

[2024-09-22 12:15:41,540][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs
[2024-09-22 12:15:41,540][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs/ckpt
[2024-09-22 12:15:41,540][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs/tb
[2024-09-22 12:15:41,540][root][INFO] - * tb interval           : 75

[2024-09-22 12:15:41,540][root][INFO] - 

[2024-09-22 12:15:41,540][root][INFO] - Start the Training !
[2024-09-22 12:15:41,544][root][INFO] - 
[1/ 5 Epoch]
[2024-09-22 12:15:55,399][root][INFO] - Step: 75/1895  |  Loss: 0.7329  |  Score: 51.83 [%]  |  Seq Length: 256.0
[2024-09-22 12:15:59,204][root][INFO] - Step: 75/1895  |  Loss: 0.7296  |  Score: 52.40 [%]  |  Seq Length: 256.0
[2024-09-22 12:16:25,259][root][INFO] - Step: 75/1895  |  Loss: 0.7094  |  Score: 52.27 [%]  |  Seq Length: 256.0
[2024-09-22 12:16:26,658][root][INFO] - Step: 150/1895  |  Loss: 0.7112  |  Score: 51.56 [%]  |  Seq Length: 256.0
[2024-09-22 12:16:28,430][root][INFO] - Step: 150/1895  |  Loss: 0.7017  |  Score: 52.44 [%]  |  Seq Length: 256.0
[2024-09-22 12:16:54,191][root][INFO] - Step: 225/1895  |  Loss: 0.6971  |  Score: 53.79 [%]  |  Seq Length: 256.0
[2024-09-22 12:17:01,588][root][INFO] - Step: 225/1895  |  Loss: 0.6946  |  Score: 53.75 [%]  |  Seq Length: 256.0
[2024-09-22 12:17:08,749][root][INFO] - Step: 150/1895  |  Loss: 0.6945  |  Score: 54.29 [%]  |  Seq Length: 256.0
[2024-09-22 12:17:21,704][root][INFO] - Step: 300/1895  |  Loss: 0.6802  |  Score: 57.77 [%]  |  Seq Length: 256.0
[2024-09-22 12:17:34,816][root][INFO] - Step: 300/1895  |  Loss: 0.6940  |  Score: 54.37 [%]  |  Seq Length: 256.0
[2024-09-22 12:17:49,246][root][INFO] - Step: 375/1895  |  Loss: 0.6685  |  Score: 58.73 [%]  |  Seq Length: 256.0
[2024-09-22 12:17:50,522][root][INFO] - Step: 379/1895  |  Loss: 0.6578  |  Score: 62.37 [%]  |  Seq Length: 256.0
[2024-09-22 12:17:52,159][root][INFO] - Step: 225/1895  |  Loss: 0.7064  |  Score: 51.94 [%]  |  Seq Length: 256.0
[2024-09-22 12:17:53,122][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 12:17:53,122][root][INFO] - Score: 59.90 [%]  |  Evaluation Time: 2.60 [s]
[2024-09-22 12:17:55,687][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 12:17:55,688][root][INFO] - Score: 59.32 [%]  |  Evaluation Time: 2.56 [s]
[2024-09-22 12:17:55,689][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 12:17:55,690][root][INFO] - 
[2/ 5 Epoch]
[2024-09-22 12:18:07,996][root][INFO] - Step: 375/1895  |  Loss: 0.6867  |  Score: 55.04 [%]  |  Seq Length: 256.0
[2024-09-22 12:18:09,521][root][INFO] - Step: 379/1895  |  Loss: 0.6657  |  Score: 58.46 [%]  |  Seq Length: 256.0
[2024-09-22 12:18:12,170][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 12:18:12,170][root][INFO] - Score: 51.95 [%]  |  Evaluation Time: 2.65 [s]
[2024-09-22 12:18:14,733][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 12:18:14,733][root][INFO] - Score: 56.37 [%]  |  Evaluation Time: 2.56 [s]
[2024-09-22 12:18:14,735][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 12:18:14,736][root][INFO] - 
[2/ 5 Epoch]
[2024-09-22 12:18:22,100][root][INFO] - Step: 450/1895  |  Loss: 0.6443  |  Score: 62.81 [%]  |  Seq Length: 256.0
[2024-09-22 12:18:35,269][root][INFO] - Step: 300/1895  |  Loss: 0.6909  |  Score: 55.42 [%]  |  Seq Length: 256.0
[2024-09-22 12:18:46,684][root][INFO] - Step: 450/1895  |  Loss: 0.6799  |  Score: 57.17 [%]  |  Seq Length: 256.0
[2024-09-22 12:18:49,734][root][INFO] - Step: 525/1895  |  Loss: 0.6469  |  Score: 62.40 [%]  |  Seq Length: 256.0
[2024-09-22 12:19:17,311][root][INFO] - Step: 600/1895  |  Loss: 0.6065  |  Score: 66.60 [%]  |  Seq Length: 256.0
[2024-09-22 12:19:18,350][root][INFO] - Step: 375/1895  |  Loss: 0.6450  |  Score: 62.19 [%]  |  Seq Length: 256.0
[2024-09-22 12:19:19,852][root][INFO] - Step: 525/1895  |  Loss: 0.6789  |  Score: 57.71 [%]  |  Seq Length: 256.0
[2024-09-22 12:19:20,363][root][INFO] - Step: 379/1895  |  Loss: 0.6376  |  Score: 69.27 [%]  |  Seq Length: 256.0
[2024-09-22 12:19:25,170][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 12:19:25,171][root][INFO] - Score: 65.30 [%]  |  Evaluation Time: 4.80 [s]
[2024-09-22 12:19:29,711][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 12:19:29,711][root][INFO] - Score: 60.72 [%]  |  Evaluation Time: 4.54 [s]
[2024-09-22 12:19:29,712][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 12:19:29,714][root][INFO] - 
[2/ 5 Epoch]
[2024-09-22 12:19:44,942][root][INFO] - Step: 675/1895  |  Loss: 0.5816  |  Score: 69.96 [%]  |  Seq Length: 256.0
[2024-09-22 12:19:53,192][root][INFO] - Step: 600/1895  |  Loss: 0.6622  |  Score: 60.65 [%]  |  Seq Length: 256.0
[2024-09-22 12:20:11,016][root][INFO] - Step: 450/1895  |  Loss: 0.6110  |  Score: 66.20 [%]  |  Seq Length: 256.0
[2024-09-22 12:20:12,644][root][INFO] - Step: 750/1895  |  Loss: 0.5807  |  Score: 69.58 [%]  |  Seq Length: 256.0
[2024-09-22 12:20:15,434][root][INFO] - Step: 758/1895  |  Loss: 0.5694  |  Score: 73.05 [%]  |  Seq Length: 256.0
[2024-09-22 12:20:18,028][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 12:20:18,028][root][INFO] - Score: 67.35 [%]  |  Evaluation Time: 2.59 [s]
[2024-09-22 12:20:20,527][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 12:20:20,528][root][INFO] - Score: 63.36 [%]  |  Evaluation Time: 2.50 [s]
[2024-09-22 12:20:20,529][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 12:20:20,530][root][INFO] - 
[3/ 5 Epoch]
[2024-09-22 12:20:26,442][root][INFO] - Step: 675/1895  |  Loss: 0.6510  |  Score: 62.60 [%]  |  Seq Length: 256.0
[2024-09-22 12:20:45,475][root][INFO] - Step: 825/1895  |  Loss: 0.5226  |  Score: 74.04 [%]  |  Seq Length: 256.0
[2024-09-22 12:20:53,913][root][INFO] - Step: 525/1895  |  Loss: 0.5871  |  Score: 68.46 [%]  |  Seq Length: 256.0
[2024-09-22 12:20:59,813][root][INFO] - Step: 750/1895  |  Loss: 0.6530  |  Score: 62.96 [%]  |  Seq Length: 256.0
[2024-09-22 12:21:03,163][root][INFO] - Step: 758/1895  |  Loss: 0.6171  |  Score: 66.08 [%]  |  Seq Length: 256.0
[2024-09-22 12:21:05,791][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 12:21:05,791][root][INFO] - Score: 60.29 [%]  |  Evaluation Time: 2.62 [s]
[2024-09-22 12:21:08,367][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 12:21:08,367][root][INFO] - Score: 58.53 [%]  |  Evaluation Time: 2.57 [s]
[2024-09-22 12:21:08,369][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 12:21:08,370][root][INFO] - 
[3/ 5 Epoch]
[2024-09-22 12:21:13,110][root][INFO] - Step: 900/1895  |  Loss: 0.5195  |  Score: 74.15 [%]  |  Seq Length: 256.0
[2024-09-22 12:21:36,774][root][INFO] - Step: 600/1895  |  Loss: 0.5947  |  Score: 68.67 [%]  |  Seq Length: 256.0
[2024-09-22 12:21:38,471][root][INFO] - Step: 825/1895  |  Loss: 0.6006  |  Score: 67.84 [%]  |  Seq Length: 256.0
[2024-09-22 12:21:40,852][root][INFO] - Step: 975/1895  |  Loss: 0.5128  |  Score: 74.92 [%]  |  Seq Length: 256.0
[2024-09-22 12:22:08,575][root][INFO] - Step: 1050/1895  |  Loss: 0.5176  |  Score: 74.40 [%]  |  Seq Length: 256.0
[2024-09-22 12:22:11,878][root][INFO] - Step: 900/1895  |  Loss: 0.6085  |  Score: 67.31 [%]  |  Seq Length: 256.0
[2024-09-22 12:22:20,091][root][INFO] - Step: 675/1895  |  Loss: 0.5619  |  Score: 70.62 [%]  |  Seq Length: 256.0
[2024-09-22 12:22:36,252][root][INFO] - Step: 1125/1895  |  Loss: 0.5111  |  Score: 74.94 [%]  |  Seq Length: 256.0
[2024-09-22 12:22:40,489][root][INFO] - Step: 1137/1895  |  Loss: 0.4775  |  Score: 78.08 [%]  |  Seq Length: 256.0
[2024-09-22 12:22:43,070][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 12:22:43,071][root][INFO] - Score: 66.63 [%]  |  Evaluation Time: 2.58 [s]
[2024-09-22 12:22:45,111][root][INFO] - Step: 975/1895  |  Loss: 0.6027  |  Score: 67.33 [%]  |  Seq Length: 256.0
[2024-09-22 12:22:45,644][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 12:22:45,644][root][INFO] - Score: 66.76 [%]  |  Evaluation Time: 2.57 [s]
[2024-09-22 12:22:45,645][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 12:22:45,646][root][INFO] - 
[4/ 5 Epoch]
[2024-09-22 12:23:03,245][root][INFO] - Step: 750/1895  |  Loss: 0.5456  |  Score: 72.94 [%]  |  Seq Length: 256.0
[2024-09-22 12:23:07,483][root][INFO] - Step: 758/1895  |  Loss: 0.5557  |  Score: 73.37 [%]  |  Seq Length: 256.0
[2024-09-22 12:23:09,185][root][INFO] - Step: 1200/1895  |  Loss: 0.4586  |  Score: 78.17 [%]  |  Seq Length: 256.0
[2024-09-22 12:23:12,150][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 12:23:12,151][root][INFO] - Score: 64.78 [%]  |  Evaluation Time: 4.67 [s]
[2024-09-22 12:23:16,774][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 12:23:16,774][root][INFO] - Score: 65.50 [%]  |  Evaluation Time: 4.62 [s]
[2024-09-22 12:23:16,775][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 12:23:16,776][root][INFO] - 
[3/ 5 Epoch]
[2024-09-22 12:23:18,457][root][INFO] - Step: 1050/1895  |  Loss: 0.5992  |  Score: 68.00 [%]  |  Seq Length: 256.0
[2024-09-22 12:23:36,964][root][INFO] - Step: 1275/1895  |  Loss: 0.4513  |  Score: 77.81 [%]  |  Seq Length: 256.0
[2024-09-22 12:23:51,716][root][INFO] - Step: 1125/1895  |  Loss: 0.5870  |  Score: 69.35 [%]  |  Seq Length: 256.0
[2024-09-22 12:23:55,597][root][INFO] - Step: 825/1895  |  Loss: 0.5056  |  Score: 74.60 [%]  |  Seq Length: 256.0
[2024-09-22 12:23:56,816][root][INFO] - Step: 1137/1895  |  Loss: 0.5957  |  Score: 68.88 [%]  |  Seq Length: 256.0
[2024-09-22 12:23:59,464][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 12:23:59,464][root][INFO] - Score: 62.08 [%]  |  Evaluation Time: 2.65 [s]
[2024-09-22 12:24:02,053][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 12:24:02,053][root][INFO] - Score: 59.65 [%]  |  Evaluation Time: 2.59 [s]
[2024-09-22 12:24:02,054][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 12:24:02,055][root][INFO] - 
[4/ 5 Epoch]
[2024-09-22 12:24:04,672][root][INFO] - Step: 1350/1895  |  Loss: 0.4372  |  Score: 79.38 [%]  |  Seq Length: 256.0
[2024-09-22 12:24:30,596][root][INFO] - Step: 1200/1895  |  Loss: 0.5630  |  Score: 71.38 [%]  |  Seq Length: 256.0
[2024-09-22 12:24:32,382][root][INFO] - Step: 1425/1895  |  Loss: 0.4492  |  Score: 78.65 [%]  |  Seq Length: 256.0
[2024-09-22 12:24:38,920][root][INFO] - Step: 900/1895  |  Loss: 0.4922  |  Score: 75.77 [%]  |  Seq Length: 256.0
[2024-09-22 12:25:00,038][root][INFO] - Step: 1500/1895  |  Loss: 0.4171  |  Score: 81.35 [%]  |  Seq Length: 256.0
[2024-09-22 12:25:04,006][root][INFO] - Step: 1275/1895  |  Loss: 0.5598  |  Score: 71.08 [%]  |  Seq Length: 256.0
[2024-09-22 12:25:05,731][root][INFO] - Step: 1516/1895  |  Loss: 0.4459  |  Score: 78.29 [%]  |  Seq Length: 256.0
[2024-09-22 12:25:08,316][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 12:25:08,317][root][INFO] - Score: 69.50 [%]  |  Evaluation Time: 2.58 [s]
[2024-09-22 12:25:10,831][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 12:25:10,832][root][INFO] - Score: 67.30 [%]  |  Evaluation Time: 2.51 [s]
[2024-09-22 12:25:10,833][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-22 12:25:10,835][root][INFO] - 
[5/ 5 Epoch]
[2024-09-22 12:25:22,103][root][INFO] - Step: 975/1895  |  Loss: 0.4968  |  Score: 75.88 [%]  |  Seq Length: 256.0
[2024-09-22 12:25:32,904][root][INFO] - Step: 1575/1895  |  Loss: 0.3899  |  Score: 82.42 [%]  |  Seq Length: 256.0
[2024-09-22 12:25:37,357][root][INFO] - Step: 1350/1895  |  Loss: 0.5694  |  Score: 70.29 [%]  |  Seq Length: 256.0
[2024-09-22 12:26:00,543][root][INFO] - Step: 1650/1895  |  Loss: 0.3908  |  Score: 82.69 [%]  |  Seq Length: 256.0
[2024-09-22 12:26:05,028][root][INFO] - Step: 1050/1895  |  Loss: 0.4923  |  Score: 76.52 [%]  |  Seq Length: 256.0
[2024-09-22 12:26:10,681][root][INFO] - Step: 1425/1895  |  Loss: 0.5552  |  Score: 71.33 [%]  |  Seq Length: 256.0
[2024-09-22 12:26:28,171][root][INFO] - Step: 1725/1895  |  Loss: 0.3902  |  Score: 82.15 [%]  |  Seq Length: 256.0
[2024-09-22 12:26:44,134][root][INFO] - Step: 1500/1895  |  Loss: 0.5464  |  Score: 72.31 [%]  |  Seq Length: 256.0
[2024-09-22 12:26:48,287][root][INFO] - Step: 1125/1895  |  Loss: 0.4978  |  Score: 75.71 [%]  |  Seq Length: 256.0
[2024-09-22 12:26:51,014][root][INFO] - Step: 1516/1895  |  Loss: 0.5708  |  Score: 70.21 [%]  |  Seq Length: 256.0
[2024-09-22 12:26:53,679][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 12:26:53,679][root][INFO] - Score: 62.63 [%]  |  Evaluation Time: 2.66 [s]
[2024-09-22 12:26:54,917][root][INFO] - Step: 1137/1895  |  Loss: 0.4697  |  Score: 77.39 [%]  |  Seq Length: 256.0
[2024-09-22 12:26:55,804][root][INFO] - Step: 1800/1895  |  Loss: 0.3670  |  Score: 82.67 [%]  |  Seq Length: 256.0
[2024-09-22 12:26:56,260][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 12:26:56,260][root][INFO] - Score: 60.36 [%]  |  Evaluation Time: 2.58 [s]
[2024-09-22 12:26:56,261][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-22 12:26:56,262][root][INFO] - 
[5/ 5 Epoch]
[2024-09-22 12:26:59,511][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 12:26:59,512][root][INFO] - Score: 71.29 [%]  |  Evaluation Time: 4.59 [s]
[2024-09-22 12:27:04,201][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 12:27:04,201][root][INFO] - Score: 67.09 [%]  |  Evaluation Time: 4.69 [s]
[2024-09-22 12:27:04,202][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 12:27:04,204][root][INFO] - 
[4/ 5 Epoch]
[2024-09-22 12:27:23,032][root][INFO] - Step: 1575/1895  |  Loss: 0.5446  |  Score: 72.83 [%]  |  Seq Length: 256.0
[2024-09-22 12:27:23,561][root][INFO] - Step: 1875/1895  |  Loss: 0.3891  |  Score: 82.04 [%]  |  Seq Length: 256.0
[2024-09-22 12:27:30,724][root][INFO] - Step: 1895/1895  |  Loss: 0.3981  |  Score: 82.29 [%]  |  Seq Length: 256.0
[2024-09-22 12:27:33,288][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 12:27:33,289][root][INFO] - Score: 71.78 [%]  |  Evaluation Time: 2.56 [s]
[2024-09-22 12:27:35,813][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 12:27:35,813][root][INFO] - Score: 68.12 [%]  |  Evaluation Time: 2.52 [s]
[2024-09-22 12:27:35,814][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-22 12:27:35,814][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 12:27:35,814][root][INFO] - - Epoch: 5
[2024-09-22 12:27:35,814][root][INFO] - - DEV score: 71.78 [%]
[2024-09-22 12:27:35,814][root][INFO] - - TEST score: 68.12 [%]
[2024-09-22 12:27:35,815][root][INFO] - Fine-tuning is done!
[2024-09-22 12:27:40,805][root][INFO] - Step: 1200/1895  |  Loss: 0.4468  |  Score: 78.92 [%]  |  Seq Length: 256.0
[2024-09-22 12:27:56,377][root][INFO] - Step: 1650/1895  |  Loss: 0.5318  |  Score: 72.81 [%]  |  Seq Length: 256.0
[2024-09-22 12:28:23,578][root][INFO] - Step: 1275/1895  |  Loss: 0.4260  |  Score: 80.27 [%]  |  Seq Length: 256.0
[2024-09-22 12:28:29,702][root][INFO] - Step: 1725/1895  |  Loss: 0.5309  |  Score: 73.65 [%]  |  Seq Length: 256.0
[2024-09-22 12:29:03,064][root][INFO] - Step: 1800/1895  |  Loss: 0.5459  |  Score: 72.48 [%]  |  Seq Length: 256.0
[2024-09-22 12:29:06,364][root][INFO] - Step: 1350/1895  |  Loss: 0.4133  |  Score: 81.31 [%]  |  Seq Length: 256.0
[2024-09-22 12:29:36,399][root][INFO] - Step: 1875/1895  |  Loss: 0.5431  |  Score: 72.08 [%]  |  Seq Length: 256.0
[2024-09-22 12:29:45,079][root][INFO] - Step: 1895/1895  |  Loss: 0.5334  |  Score: 72.42 [%]  |  Seq Length: 256.0
[2024-09-22 12:29:47,700][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 12:29:47,700][root][INFO] - Score: 63.61 [%]  |  Evaluation Time: 2.62 [s]
[2024-09-22 12:29:49,166][root][INFO] - Step: 1425/1895  |  Loss: 0.4220  |  Score: 80.02 [%]  |  Seq Length: 256.0
[2024-09-22 12:29:50,262][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 12:29:50,262][root][INFO] - Score: 60.07 [%]  |  Evaluation Time: 2.56 [s]
[2024-09-22 12:29:50,264][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-22 12:29:50,264][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 12:29:50,264][root][INFO] - - Epoch: 5
[2024-09-22 12:29:50,264][root][INFO] - - DEV score: 63.61 [%]
[2024-09-22 12:29:50,264][root][INFO] - - TEST score: 60.07 [%]
[2024-09-22 12:29:50,265][root][INFO] - Fine-tuning is done!
[2024-09-22 12:30:31,896][root][INFO] - Step: 1500/1895  |  Loss: 0.4113  |  Score: 81.31 [%]  |  Seq Length: 256.0
[2024-09-22 12:30:40,696][root][INFO] - Step: 1516/1895  |  Loss: 0.3768  |  Score: 82.45 [%]  |  Seq Length: 256.0
[2024-09-22 12:30:45,266][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 12:30:45,266][root][INFO] - Score: 70.57 [%]  |  Evaluation Time: 4.57 [s]
[2024-09-22 12:30:49,847][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 12:30:49,847][root][INFO] - Score: 68.59 [%]  |  Evaluation Time: 4.58 [s]
[2024-09-22 12:30:49,848][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-22 12:30:49,850][root][INFO] - 
[5/ 5 Epoch]
[2024-09-22 12:31:23,839][root][INFO] - Step: 1575/1895  |  Loss: 0.3701  |  Score: 82.94 [%]  |  Seq Length: 256.0
[2024-09-22 12:32:06,386][root][INFO] - Step: 1650/1895  |  Loss: 0.3648  |  Score: 83.60 [%]  |  Seq Length: 256.0
[2024-09-22 12:32:49,074][root][INFO] - Step: 1725/1895  |  Loss: 0.3788  |  Score: 82.15 [%]  |  Seq Length: 256.0
[2024-09-22 12:33:31,623][root][INFO] - Step: 1800/1895  |  Loss: 0.3741  |  Score: 83.12 [%]  |  Seq Length: 256.0
[2024-09-22 12:34:14,266][root][INFO] - Step: 1875/1895  |  Loss: 0.3542  |  Score: 84.50 [%]  |  Seq Length: 256.0
[2024-09-22 12:34:25,234][root][INFO] - Step: 1895/1895  |  Loss: 0.3794  |  Score: 83.23 [%]  |  Seq Length: 256.0
[2024-09-22 12:34:29,840][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 12:34:29,840][root][INFO] - Score: 73.05 [%]  |  Evaluation Time: 4.60 [s]
[2024-09-22 12:34:34,387][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 12:34:34,387][root][INFO] - Score: 68.02 [%]  |  Evaluation Time: 4.54 [s]
[2024-09-22 12:34:34,388][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-22 12:34:34,388][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 12:34:34,388][root][INFO] - - Epoch: 5
[2024-09-22 12:34:34,388][root][INFO] - - DEV score: 73.05 [%]
[2024-09-22 12:34:34,388][root][INFO] - - TEST score: 68.02 [%]
[2024-09-22 12:34:34,389][root][INFO] - Fine-tuning is done!
[2024-09-22 12:41:43,075][root][INFO] - 

[2024-09-22 12:41:43,075][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 12:41:43,075][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs
[2024-09-22 12:41:43,075][root][INFO] - 

[2024-09-22 12:41:43,075][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 12:44:21,168][root][INFO] - 

[2024-09-22 12:44:21,168][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 12:44:21,169][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs
[2024-09-22 12:44:21,169][root][INFO] - 

[2024-09-22 12:44:21,169][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 12:44:40,902][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 12:44:40,902][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 12:44:40,903][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 12:44:40,903][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 12:44:40,904][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 12:44:40,904][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 12:44:40,905][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 12:44:40,905][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 12:44:40,905][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 12:44:40,906][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 12:44:40,906][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 12:44:40,907][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 12:44:40,907][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 12:44:40,908][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 12:44:40,908][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 12:44:40,908][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 12:44:40,909][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 12:44:40,909][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 12:44:40,910][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 12:44:40,910][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 12:44:40,911][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 12:44:40,911][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 12:44:40,912][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 12:44:40,912][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 12:44:40,914][root][INFO] - Trainable params: 1769472 || all params: 126935040 || trainable: 1.39 %
[2024-09-22 12:44:40,918][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-22 12:44:41,021][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-22 12:44:41,023][root][INFO] - Trainable params: 9034752 || all params: 134200320 || trainable: 6.73 %
[2024-09-22 12:44:41,239][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 12:44:44,340][root][INFO] - 

[2024-09-22 12:44:44,340][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-22 12:44:44,340][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 12:44:44,347][root][INFO] - vocab size              : 51200
[2024-09-22 12:44:44,347][root][INFO] - device                  : gpu
[2024-09-22 12:44:44,347][root][INFO] - random seed             : 42
[2024-09-22 12:44:44,347][root][INFO] - train data size         : 115456
[2024-09-22 12:44:44,348][root][INFO] - max epochs              : 5
[2024-09-22 12:44:44,348][root][INFO] - total steps             : 9020
[2024-09-22 12:44:44,348][root][INFO] - warmup steps            : 902
[2024-09-22 12:44:44,348][root][INFO] - batch size              : 64
[2024-09-22 12:44:44,348][root][INFO] - accumulation steps      : 1
[2024-09-22 12:44:44,348][root][INFO] - optimizer               : adamwscale
[2024-09-22 12:44:44,348][root][INFO] - lr_scheduler            : cosine
[2024-09-22 12:44:44,348][root][INFO] - learning rate           : 0.01
[2024-09-22 12:44:44,348][root][INFO] - max length              : 256

[2024-09-22 12:44:44,348][root][INFO] - LoRA Configuration
[2024-09-22 12:44:44,348][root][INFO] - ㄴ r                    : 32
[2024-09-22 12:44:44,348][root][INFO] - ㄴ alpha                : 128
[2024-09-22 12:44:44,349][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 12:44:44,349][root][INFO] - KOMBO Configuration
[2024-09-22 12:44:44,349][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-22 12:44:44,349][root][INFO] - ㄴ reducer              : linear
[2024-09-22 12:44:44,349][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-22 12:44:44,349][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-22 12:44:44,349][root][INFO] - ㄴ do_combination       : True
[2024-09-22 12:44:44,349][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-22 12:44:44,349][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-22 12:44:44,350][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-22 12:44:44,350][root][INFO] -   ㄴ add_lora           : True
[2024-09-22 12:44:44,350][root][INFO] -     ㄴ LoRA in KOMBO Configuration
[2024-09-22 12:44:44,350][root][INFO] -     ㄴ r                : 32
[2024-09-22 12:44:44,350][root][INFO] -     ㄴ alpha            : 128
[2024-09-22 12:44:44,350][root][INFO] -     ㄴ dropout          : 0.03

[2024-09-22 12:44:44,350][root][INFO] - 

[2024-09-22 12:44:44,350][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs
[2024-09-22 12:44:44,350][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-22 12:44:44,350][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/tb
[2024-09-22 12:44:44,351][root][INFO] - * tb interval           : 100

[2024-09-22 12:44:44,351][root][INFO] - 

[2024-09-22 12:44:44,351][root][INFO] - Start the Training !
[2024-09-22 12:44:44,354][root][INFO] - 
[1/ 5 Epoch]
[2024-09-22 12:45:24,794][root][INFO] - 

[2024-09-22 12:45:24,794][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 12:45:24,795][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs
[2024-09-22 12:45:24,795][root][INFO] - 

[2024-09-22 12:45:24,795][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 12:45:43,943][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 12:45:43,944][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 12:45:43,944][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 12:45:43,944][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 12:45:43,945][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 12:45:43,945][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 12:45:43,946][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 12:45:43,946][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 12:45:43,946][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 12:45:43,947][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 12:45:43,947][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 12:45:43,948][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 12:45:43,948][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 12:45:43,949][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 12:45:43,949][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 12:45:43,949][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 12:45:43,950][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 12:45:43,950][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 12:45:43,951][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 12:45:43,951][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 12:45:43,951][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 12:45:43,952][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 12:45:43,952][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 12:45:43,953][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 12:45:43,954][root][INFO] - Trainable params: 1769472 || all params: 126935040 || trainable: 1.39 %
[2024-09-22 12:45:43,958][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-22 12:45:44,062][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-22 12:45:44,064][root][INFO] - Trainable params: 9034752 || all params: 134200320 || trainable: 6.73 %
[2024-09-22 12:45:44,261][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 12:45:47,279][root][INFO] - 

[2024-09-22 12:45:47,280][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-22 12:45:47,280][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 12:45:47,287][root][INFO] - vocab size              : 51200
[2024-09-22 12:45:47,288][root][INFO] - device                  : gpu
[2024-09-22 12:45:47,288][root][INFO] - random seed             : 42
[2024-09-22 12:45:47,288][root][INFO] - train data size         : 115456
[2024-09-22 12:45:47,288][root][INFO] - max epochs              : 5
[2024-09-22 12:45:47,288][root][INFO] - total steps             : 9020
[2024-09-22 12:45:47,288][root][INFO] - warmup steps            : 902
[2024-09-22 12:45:47,288][root][INFO] - batch size              : 64
[2024-09-22 12:45:47,288][root][INFO] - accumulation steps      : 1
[2024-09-22 12:45:47,288][root][INFO] - optimizer               : adamwscale
[2024-09-22 12:45:47,288][root][INFO] - lr_scheduler            : cosine
[2024-09-22 12:45:47,289][root][INFO] - learning rate           : 0.01
[2024-09-22 12:45:47,289][root][INFO] - max length              : 256

[2024-09-22 12:45:47,289][root][INFO] - LoRA Configuration
[2024-09-22 12:45:47,289][root][INFO] - ㄴ r                    : 32
[2024-09-22 12:45:47,289][root][INFO] - ㄴ alpha                : 128
[2024-09-22 12:45:47,289][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 12:45:47,289][root][INFO] - KOMBO Configuration
[2024-09-22 12:45:47,289][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-22 12:45:47,289][root][INFO] - ㄴ reducer              : linear
[2024-09-22 12:45:47,290][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-22 12:45:47,290][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-22 12:45:47,290][root][INFO] - ㄴ do_combination       : True
[2024-09-22 12:45:47,290][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-22 12:45:47,290][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-22 12:45:47,290][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-22 12:45:47,290][root][INFO] -   ㄴ add_lora           : True
[2024-09-22 12:45:47,290][root][INFO] -     ㄴ LoRA in KOMBO Configuration
[2024-09-22 12:45:47,290][root][INFO] -     ㄴ r                : 32
[2024-09-22 12:45:47,291][root][INFO] -     ㄴ alpha            : 128
[2024-09-22 12:45:47,291][root][INFO] -     ㄴ dropout          : 0.03

[2024-09-22 12:45:47,291][root][INFO] - 

[2024-09-22 12:45:47,291][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs
[2024-09-22 12:45:47,291][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-22 12:45:47,291][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/tb
[2024-09-22 12:45:47,291][root][INFO] - * tb interval           : 100

[2024-09-22 12:45:47,291][root][INFO] - 

[2024-09-22 12:45:47,291][root][INFO] - Start the Training !
[2024-09-22 12:45:47,294][root][INFO] - 
[1/ 5 Epoch]
[2024-09-22 12:45:48,612][root][INFO] - 

[2024-09-22 12:45:48,612][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 12:45:48,613][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.01lr_42rs
[2024-09-22 12:45:48,613][root][INFO] - 

[2024-09-22 12:45:48,613][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 12:46:37,481][root][INFO] - Step: 100/9020  |  Loss: 0.5869  |  Score: 68.53 [%]  |  Seq Length: 256.0
[2024-09-22 12:46:44,953][root][INFO] - 

[2024-09-22 12:46:44,953][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 12:46:44,953][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs
[2024-09-22 12:46:44,953][root][INFO] - 

[2024-09-22 12:46:44,953][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 12:47:04,634][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 12:47:04,635][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 12:47:04,636][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 12:47:04,636][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 12:47:04,637][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 12:47:04,637][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 12:47:04,638][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 12:47:04,638][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 12:47:04,639][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 12:47:04,639][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 12:47:04,640][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 12:47:04,640][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 12:47:04,641][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 12:47:04,641][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 12:47:04,642][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 12:47:04,642][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 12:47:04,643][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 12:47:04,643][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 12:47:04,644][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 12:47:04,644][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 12:47:04,645][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 12:47:04,645][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 12:47:04,646][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 12:47:04,646][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 12:47:04,648][root][INFO] - Trainable params: 1769472 || all params: 126935040 || trainable: 1.39 %
[2024-09-22 12:47:04,653][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-22 12:47:04,662][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-22 12:47:04,664][root][INFO] - Trainable params: 2445312 || all params: 127610880 || trainable: 1.92 %
[2024-09-22 12:47:04,851][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 12:47:06,757][root][INFO] - 

[2024-09-22 12:47:06,757][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-22 12:47:06,757][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 12:47:06,765][root][INFO] - vocab size              : 51200
[2024-09-22 12:47:06,765][root][INFO] - device                  : gpu
[2024-09-22 12:47:06,765][root][INFO] - random seed             : 42
[2024-09-22 12:47:06,765][root][INFO] - train data size         : 115456
[2024-09-22 12:47:06,765][root][INFO] - max epochs              : 5
[2024-09-22 12:47:06,765][root][INFO] - total steps             : 9020
[2024-09-22 12:47:06,766][root][INFO] - warmup steps            : 902
[2024-09-22 12:47:06,766][root][INFO] - batch size              : 64
[2024-09-22 12:47:06,766][root][INFO] - accumulation steps      : 1
[2024-09-22 12:47:06,766][root][INFO] - optimizer               : adamwscale
[2024-09-22 12:47:06,766][root][INFO] - lr_scheduler            : cosine
[2024-09-22 12:47:06,766][root][INFO] - learning rate           : 0.01
[2024-09-22 12:47:06,766][root][INFO] - max length              : 256

[2024-09-22 12:47:06,766][root][INFO] - LoRA Configuration
[2024-09-22 12:47:06,766][root][INFO] - ㄴ r                    : 32
[2024-09-22 12:47:06,766][root][INFO] - ㄴ alpha                : 128
[2024-09-22 12:47:06,766][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 12:47:06,767][root][INFO] - KOMBO Configuration
[2024-09-22 12:47:06,767][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-22 12:47:06,767][root][INFO] - ㄴ reducer              : linear
[2024-09-22 12:47:06,767][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-22 12:47:06,767][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-22 12:47:06,767][root][INFO] - ㄴ do_combination       : False
[2024-09-22 12:47:06,767][root][INFO] - 

[2024-09-22 12:47:06,767][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs
[2024-09-22 12:47:06,767][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-22 12:47:06,767][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/tb
[2024-09-22 12:47:06,767][root][INFO] - * tb interval           : 100

[2024-09-22 12:47:06,768][root][INFO] - 

[2024-09-22 12:47:06,768][root][INFO] - Start the Training !
[2024-09-22 12:47:06,771][root][INFO] - 
[1/ 5 Epoch]
[2024-09-22 12:47:26,725][root][INFO] - Step: 200/9020  |  Loss: 0.4385  |  Score: 80.33 [%]  |  Seq Length: 256.0
[2024-09-22 12:47:53,464][root][INFO] - Step: 100/9020  |  Loss: 0.5863  |  Score: 68.59 [%]  |  Seq Length: 256.0
[2024-09-22 12:48:16,233][root][INFO] - Step: 300/9020  |  Loss: 0.4220  |  Score: 80.72 [%]  |  Seq Length: 256.0
[2024-09-22 12:48:38,786][root][INFO] - Step: 200/9020  |  Loss: 0.4514  |  Score: 78.97 [%]  |  Seq Length: 256.0
[2024-09-22 12:49:05,661][root][INFO] - Step: 400/9020  |  Loss: 0.4040  |  Score: 81.73 [%]  |  Seq Length: 256.0
[2024-09-22 12:49:24,123][root][INFO] - Step: 300/9020  |  Loss: 0.4210  |  Score: 81.06 [%]  |  Seq Length: 256.0
[2024-09-22 12:49:55,054][root][INFO] - Step: 500/9020  |  Loss: 0.3787  |  Score: 83.58 [%]  |  Seq Length: 256.0
[2024-09-22 12:50:09,356][root][INFO] - Step: 400/9020  |  Loss: 0.4012  |  Score: 82.44 [%]  |  Seq Length: 256.0
[2024-09-22 12:50:44,365][root][INFO] - Step: 600/9020  |  Loss: 0.3875  |  Score: 82.86 [%]  |  Seq Length: 256.0
[2024-09-22 12:50:54,762][root][INFO] - Step: 500/9020  |  Loss: 0.3856  |  Score: 82.66 [%]  |  Seq Length: 256.0
[2024-09-22 12:51:34,176][root][INFO] - Step: 700/9020  |  Loss: 0.3675  |  Score: 83.25 [%]  |  Seq Length: 256.0
[2024-09-22 12:51:40,198][root][INFO] - Step: 600/9020  |  Loss: 0.3665  |  Score: 84.19 [%]  |  Seq Length: 256.0
[2024-09-22 12:52:23,589][root][INFO] - Step: 800/9020  |  Loss: 0.3626  |  Score: 84.25 [%]  |  Seq Length: 256.0
[2024-09-22 12:52:25,540][root][INFO] - Step: 700/9020  |  Loss: 0.3775  |  Score: 83.38 [%]  |  Seq Length: 256.0
[2024-09-22 12:53:10,792][root][INFO] - Step: 800/9020  |  Loss: 0.3794  |  Score: 82.75 [%]  |  Seq Length: 256.0
[2024-09-22 12:53:13,070][root][INFO] - Step: 900/9020  |  Loss: 0.3537  |  Score: 84.62 [%]  |  Seq Length: 256.0
[2024-09-22 12:53:56,122][root][INFO] - Step: 900/9020  |  Loss: 0.3782  |  Score: 83.14 [%]  |  Seq Length: 256.0
[2024-09-22 12:54:02,480][root][INFO] - Step: 1000/9020  |  Loss: 0.3565  |  Score: 84.39 [%]  |  Seq Length: 256.0
[2024-09-22 12:54:41,425][root][INFO] - Step: 1000/9020  |  Loss: 0.3679  |  Score: 83.78 [%]  |  Seq Length: 256.0
[2024-09-22 12:54:51,951][root][INFO] - Step: 1100/9020  |  Loss: 0.3341  |  Score: 85.56 [%]  |  Seq Length: 256.0
[2024-09-22 12:55:26,674][root][INFO] - Step: 1100/9020  |  Loss: 0.3668  |  Score: 83.56 [%]  |  Seq Length: 256.0
[2024-09-22 12:55:41,389][root][INFO] - Step: 1200/9020  |  Loss: 0.3398  |  Score: 85.30 [%]  |  Seq Length: 256.0
[2024-09-22 12:56:11,615][root][INFO] - Step: 1200/9020  |  Loss: 0.3720  |  Score: 83.41 [%]  |  Seq Length: 256.0
[2024-09-22 12:56:30,891][root][INFO] - Step: 1300/9020  |  Loss: 0.3400  |  Score: 84.94 [%]  |  Seq Length: 256.0
[2024-09-22 12:56:56,882][root][INFO] - Step: 1300/9020  |  Loss: 0.3563  |  Score: 84.12 [%]  |  Seq Length: 256.0
[2024-09-22 12:57:20,385][root][INFO] - Step: 1400/9020  |  Loss: 0.3295  |  Score: 86.09 [%]  |  Seq Length: 256.0
[2024-09-22 12:57:42,236][root][INFO] - Step: 1400/9020  |  Loss: 0.3543  |  Score: 84.05 [%]  |  Seq Length: 256.0
[2024-09-22 12:58:09,808][root][INFO] - Step: 1500/9020  |  Loss: 0.3284  |  Score: 85.84 [%]  |  Seq Length: 256.0
[2024-09-22 12:58:27,760][root][INFO] - Step: 1500/9020  |  Loss: 0.3590  |  Score: 83.81 [%]  |  Seq Length: 256.0
[2024-09-22 12:58:59,149][root][INFO] - Step: 1600/9020  |  Loss: 0.3350  |  Score: 85.50 [%]  |  Seq Length: 256.0
[2024-09-22 12:59:12,960][root][INFO] - Step: 1600/9020  |  Loss: 0.3590  |  Score: 84.17 [%]  |  Seq Length: 256.0
[2024-09-22 12:59:48,654][root][INFO] - Step: 1700/9020  |  Loss: 0.3249  |  Score: 86.23 [%]  |  Seq Length: 256.0
[2024-09-22 12:59:57,613][root][INFO] - Step: 1700/9020  |  Loss: 0.3499  |  Score: 84.12 [%]  |  Seq Length: 256.0
[2024-09-22 13:00:37,987][root][INFO] - Step: 1800/9020  |  Loss: 0.3309  |  Score: 85.73 [%]  |  Seq Length: 256.0
[2024-09-22 13:00:39,990][root][INFO] - Step: 1804/9020  |  Loss: 0.3400  |  Score: 86.39 [%]  |  Seq Length: 256.0
[2024-09-22 13:00:43,167][root][INFO] - Step: 1800/9020  |  Loss: 0.3500  |  Score: 84.58 [%]  |  Seq Length: 256.0
[2024-09-22 13:00:44,998][root][INFO] - Step: 1804/9020  |  Loss: 0.4322  |  Score: 79.81 [%]  |  Seq Length: 256.0
[2024-09-22 13:01:24,633][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 13:01:24,633][root][INFO] - Score: 86.92 [%]  |  Evaluation Time: 44.64 [s]
[2024-09-22 13:01:26,808][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 13:01:26,808][root][INFO] - Score: 85.74 [%]  |  Evaluation Time: 41.81 [s]
[2024-09-22 13:03:44,533][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 13:03:44,534][root][INFO] - Score: 85.62 [%]  |  Evaluation Time: 137.72 [s]
[2024-09-22 13:03:44,535][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 13:03:44,536][root][INFO] - 
[2/ 5 Epoch]
[2024-09-22 13:03:51,947][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 13:03:51,947][root][INFO] - Score: 86.67 [%]  |  Evaluation Time: 147.31 [s]
[2024-09-22 13:03:51,949][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 13:03:51,950][root][INFO] - 
[2/ 5 Epoch]
[2024-09-22 13:04:28,371][root][INFO] - Step: 1900/9020  |  Loss: 0.3478  |  Score: 85.03 [%]  |  Seq Length: 256.0
[2024-09-22 13:04:39,854][root][INFO] - Step: 1900/9020  |  Loss: 0.2927  |  Score: 87.71 [%]  |  Seq Length: 256.0
[2024-09-22 13:05:13,664][root][INFO] - Step: 2000/9020  |  Loss: 0.3172  |  Score: 86.00 [%]  |  Seq Length: 256.0
[2024-09-22 13:05:29,289][root][INFO] - Step: 2000/9020  |  Loss: 0.2986  |  Score: 87.72 [%]  |  Seq Length: 256.0
[2024-09-22 13:05:58,957][root][INFO] - Step: 2100/9020  |  Loss: 0.3365  |  Score: 85.69 [%]  |  Seq Length: 256.0
[2024-09-22 13:06:18,618][root][INFO] - Step: 2100/9020  |  Loss: 0.2886  |  Score: 87.45 [%]  |  Seq Length: 256.0
[2024-09-22 13:06:44,240][root][INFO] - Step: 2200/9020  |  Loss: 0.3151  |  Score: 86.22 [%]  |  Seq Length: 256.0
[2024-09-22 13:07:08,436][root][INFO] - Step: 2200/9020  |  Loss: 0.2998  |  Score: 87.25 [%]  |  Seq Length: 256.0
[2024-09-22 13:07:29,622][root][INFO] - Step: 2300/9020  |  Loss: 0.3296  |  Score: 85.72 [%]  |  Seq Length: 256.0
[2024-09-22 13:07:57,942][root][INFO] - Step: 2300/9020  |  Loss: 0.3073  |  Score: 86.44 [%]  |  Seq Length: 256.0
[2024-09-22 13:08:15,070][root][INFO] - Step: 2400/9020  |  Loss: 0.3272  |  Score: 85.59 [%]  |  Seq Length: 256.0
[2024-09-22 13:08:47,607][root][INFO] - Step: 2400/9020  |  Loss: 0.2877  |  Score: 88.25 [%]  |  Seq Length: 256.0
[2024-09-22 13:09:00,630][root][INFO] - Step: 2500/9020  |  Loss: 0.3115  |  Score: 86.64 [%]  |  Seq Length: 256.0
[2024-09-22 13:09:37,072][root][INFO] - Step: 2500/9020  |  Loss: 0.3055  |  Score: 86.78 [%]  |  Seq Length: 256.0
[2024-09-22 13:09:45,940][root][INFO] - Step: 2600/9020  |  Loss: 0.3191  |  Score: 86.36 [%]  |  Seq Length: 256.0
[2024-09-22 13:10:26,711][root][INFO] - Step: 2600/9020  |  Loss: 0.2918  |  Score: 87.61 [%]  |  Seq Length: 256.0
[2024-09-22 13:10:31,262][root][INFO] - Step: 2700/9020  |  Loss: 0.3323  |  Score: 85.45 [%]  |  Seq Length: 256.0
[2024-09-22 13:11:16,141][root][INFO] - Step: 2700/9020  |  Loss: 0.2904  |  Score: 87.78 [%]  |  Seq Length: 256.0
[2024-09-22 13:11:16,578][root][INFO] - Step: 2800/9020  |  Loss: 0.3306  |  Score: 85.84 [%]  |  Seq Length: 256.0
[2024-09-22 13:12:01,870][root][INFO] - Step: 2900/9020  |  Loss: 0.3293  |  Score: 85.31 [%]  |  Seq Length: 256.0
[2024-09-22 13:12:05,895][root][INFO] - Step: 2800/9020  |  Loss: 0.2961  |  Score: 87.38 [%]  |  Seq Length: 256.0
[2024-09-22 13:12:47,181][root][INFO] - Step: 3000/9020  |  Loss: 0.3083  |  Score: 86.52 [%]  |  Seq Length: 256.0
[2024-09-22 13:12:55,708][root][INFO] - Step: 2900/9020  |  Loss: 0.3003  |  Score: 87.64 [%]  |  Seq Length: 256.0
[2024-09-22 13:13:32,511][root][INFO] - Step: 3100/9020  |  Loss: 0.3120  |  Score: 86.25 [%]  |  Seq Length: 256.0
[2024-09-22 13:13:45,196][root][INFO] - Step: 3000/9020  |  Loss: 0.2993  |  Score: 88.05 [%]  |  Seq Length: 256.0
[2024-09-22 13:14:17,795][root][INFO] - Step: 3200/9020  |  Loss: 0.3066  |  Score: 86.89 [%]  |  Seq Length: 256.0
[2024-09-22 13:14:34,851][root][INFO] - Step: 3100/9020  |  Loss: 0.2858  |  Score: 88.02 [%]  |  Seq Length: 256.0
[2024-09-22 13:15:03,468][root][INFO] - Step: 3300/9020  |  Loss: 0.3077  |  Score: 87.02 [%]  |  Seq Length: 256.0
[2024-09-22 13:15:24,720][root][INFO] - Step: 3200/9020  |  Loss: 0.2889  |  Score: 87.78 [%]  |  Seq Length: 256.0
[2024-09-22 13:15:49,417][root][INFO] - Step: 3400/9020  |  Loss: 0.3039  |  Score: 86.62 [%]  |  Seq Length: 256.0
[2024-09-22 13:16:14,107][root][INFO] - Step: 3300/9020  |  Loss: 0.2902  |  Score: 87.77 [%]  |  Seq Length: 256.0
[2024-09-22 13:16:35,001][root][INFO] - Step: 3500/9020  |  Loss: 0.3005  |  Score: 87.20 [%]  |  Seq Length: 256.0
[2024-09-22 13:17:03,564][root][INFO] - Step: 3400/9020  |  Loss: 0.2923  |  Score: 87.25 [%]  |  Seq Length: 256.0
[2024-09-22 13:17:20,288][root][INFO] - Step: 3600/9020  |  Loss: 0.3166  |  Score: 86.73 [%]  |  Seq Length: 256.0
[2024-09-22 13:17:23,925][root][INFO] - Step: 3608/9020  |  Loss: 0.3246  |  Score: 86.08 [%]  |  Seq Length: 256.0
[2024-09-22 13:17:52,997][root][INFO] - Step: 3500/9020  |  Loss: 0.2986  |  Score: 87.19 [%]  |  Seq Length: 256.0
[2024-09-22 13:18:05,310][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 13:18:05,310][root][INFO] - Score: 86.84 [%]  |  Evaluation Time: 41.38 [s]
[2024-09-22 13:18:42,519][root][INFO] - Step: 3600/9020  |  Loss: 0.2918  |  Score: 87.38 [%]  |  Seq Length: 256.0
[2024-09-22 13:18:46,509][root][INFO] - Step: 3608/9020  |  Loss: 0.2855  |  Score: 87.69 [%]  |  Seq Length: 256.0
[2024-09-22 13:19:31,229][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 13:19:31,229][root][INFO] - Score: 87.85 [%]  |  Evaluation Time: 44.72 [s]
[2024-09-22 13:20:22,064][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 13:20:22,064][root][INFO] - Score: 86.89 [%]  |  Evaluation Time: 136.75 [s]
[2024-09-22 13:20:22,065][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 13:20:22,067][root][INFO] - 
[3/ 5 Epoch]
[2024-09-22 13:21:04,306][root][INFO] - Step: 3700/9020  |  Loss: 0.2785  |  Score: 87.84 [%]  |  Seq Length: 256.0
[2024-09-22 13:21:49,883][root][INFO] - Step: 3800/9020  |  Loss: 0.2791  |  Score: 87.88 [%]  |  Seq Length: 256.0
[2024-09-22 13:21:58,417][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 13:21:58,418][root][INFO] - Score: 87.62 [%]  |  Evaluation Time: 147.19 [s]
[2024-09-22 13:21:58,419][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 13:21:58,420][root][INFO] - 
[3/ 5 Epoch]
[2024-09-22 13:22:35,178][root][INFO] - Step: 3900/9020  |  Loss: 0.2799  |  Score: 87.83 [%]  |  Seq Length: 256.0
[2024-09-22 13:22:44,166][root][INFO] - Step: 3700/9020  |  Loss: 0.2520  |  Score: 89.78 [%]  |  Seq Length: 256.0
[2024-09-22 13:23:20,502][root][INFO] - Step: 4000/9020  |  Loss: 0.2819  |  Score: 88.31 [%]  |  Seq Length: 256.0
[2024-09-22 13:23:33,635][root][INFO] - Step: 3800/9020  |  Loss: 0.2581  |  Score: 89.16 [%]  |  Seq Length: 256.0
[2024-09-22 13:24:05,800][root][INFO] - Step: 4100/9020  |  Loss: 0.2764  |  Score: 88.61 [%]  |  Seq Length: 256.0
[2024-09-22 13:24:23,048][root][INFO] - Step: 3900/9020  |  Loss: 0.2509  |  Score: 89.72 [%]  |  Seq Length: 256.0
[2024-09-22 13:24:51,102][root][INFO] - Step: 4200/9020  |  Loss: 0.2784  |  Score: 88.66 [%]  |  Seq Length: 256.0
[2024-09-22 13:25:12,628][root][INFO] - Step: 4000/9020  |  Loss: 0.2446  |  Score: 90.05 [%]  |  Seq Length: 256.0
[2024-09-22 13:25:36,391][root][INFO] - Step: 4300/9020  |  Loss: 0.2780  |  Score: 88.19 [%]  |  Seq Length: 256.0
[2024-09-22 13:26:02,493][root][INFO] - Step: 4100/9020  |  Loss: 0.2537  |  Score: 89.59 [%]  |  Seq Length: 256.0
[2024-09-22 13:26:21,691][root][INFO] - Step: 4400/9020  |  Loss: 0.2738  |  Score: 88.34 [%]  |  Seq Length: 256.0
[2024-09-22 13:26:52,314][root][INFO] - Step: 4200/9020  |  Loss: 0.2611  |  Score: 89.05 [%]  |  Seq Length: 256.0
[2024-09-22 13:27:07,016][root][INFO] - Step: 4500/9020  |  Loss: 0.2828  |  Score: 87.66 [%]  |  Seq Length: 256.0
[2024-09-22 13:27:42,097][root][INFO] - Step: 4300/9020  |  Loss: 0.2554  |  Score: 89.30 [%]  |  Seq Length: 256.0
[2024-09-22 13:27:52,432][root][INFO] - Step: 4600/9020  |  Loss: 0.2800  |  Score: 88.42 [%]  |  Seq Length: 256.0
[2024-09-22 13:28:31,585][root][INFO] - Step: 4400/9020  |  Loss: 0.2523  |  Score: 89.66 [%]  |  Seq Length: 256.0
[2024-09-22 13:28:37,938][root][INFO] - Step: 4700/9020  |  Loss: 0.2774  |  Score: 88.31 [%]  |  Seq Length: 256.0
[2024-09-22 13:29:21,007][root][INFO] - Step: 4500/9020  |  Loss: 0.2550  |  Score: 89.42 [%]  |  Seq Length: 256.0
[2024-09-22 13:29:23,283][root][INFO] - Step: 4800/9020  |  Loss: 0.2834  |  Score: 87.89 [%]  |  Seq Length: 256.0
[2024-09-22 13:30:08,666][root][INFO] - Step: 4900/9020  |  Loss: 0.2689  |  Score: 89.03 [%]  |  Seq Length: 256.0
[2024-09-22 13:30:10,413][root][INFO] - Step: 4600/9020  |  Loss: 0.2593  |  Score: 89.14 [%]  |  Seq Length: 256.0
[2024-09-22 13:30:53,942][root][INFO] - Step: 5000/9020  |  Loss: 0.2737  |  Score: 88.47 [%]  |  Seq Length: 256.0
[2024-09-22 13:30:59,809][root][INFO] - Step: 4700/9020  |  Loss: 0.2552  |  Score: 89.41 [%]  |  Seq Length: 256.0
[2024-09-22 13:31:39,476][root][INFO] - Step: 5100/9020  |  Loss: 0.2662  |  Score: 89.08 [%]  |  Seq Length: 256.0
[2024-09-22 13:31:49,509][root][INFO] - Step: 4800/9020  |  Loss: 0.2508  |  Score: 89.67 [%]  |  Seq Length: 256.0
[2024-09-22 13:32:25,029][root][INFO] - Step: 5200/9020  |  Loss: 0.2652  |  Score: 88.66 [%]  |  Seq Length: 256.0
[2024-09-22 13:32:38,982][root][INFO] - Step: 4900/9020  |  Loss: 0.2466  |  Score: 90.30 [%]  |  Seq Length: 256.0
[2024-09-22 13:33:10,315][root][INFO] - Step: 5300/9020  |  Loss: 0.2702  |  Score: 88.70 [%]  |  Seq Length: 256.0
[2024-09-22 13:33:28,535][root][INFO] - Step: 5000/9020  |  Loss: 0.2523  |  Score: 89.39 [%]  |  Seq Length: 256.0
[2024-09-22 13:33:55,621][root][INFO] - Step: 5400/9020  |  Loss: 0.2712  |  Score: 88.50 [%]  |  Seq Length: 256.0
[2024-09-22 13:34:01,091][root][INFO] - Step: 5412/9020  |  Loss: 0.2654  |  Score: 88.43 [%]  |  Seq Length: 256.0
[2024-09-22 13:34:18,070][root][INFO] - Step: 5100/9020  |  Loss: 0.2613  |  Score: 89.23 [%]  |  Seq Length: 256.0
[2024-09-22 13:34:42,538][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 13:34:42,538][root][INFO] - Score: 88.12 [%]  |  Evaluation Time: 41.44 [s]
[2024-09-22 13:35:07,589][root][INFO] - Step: 5200/9020  |  Loss: 0.2572  |  Score: 89.73 [%]  |  Seq Length: 256.0
[2024-09-22 13:35:57,045][root][INFO] - Step: 5300/9020  |  Loss: 0.2566  |  Score: 89.42 [%]  |  Seq Length: 256.0
[2024-09-22 13:36:46,730][root][INFO] - Step: 5400/9020  |  Loss: 0.2494  |  Score: 89.97 [%]  |  Seq Length: 256.0
[2024-09-22 13:36:52,698][root][INFO] - Step: 5412/9020  |  Loss: 0.2576  |  Score: 88.87 [%]  |  Seq Length: 256.0
[2024-09-22 13:36:59,392][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 13:36:59,392][root][INFO] - Score: 88.02 [%]  |  Evaluation Time: 136.85 [s]
[2024-09-22 13:36:59,393][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 13:36:59,394][root][INFO] - 
[4/ 5 Epoch]
[2024-09-22 13:37:37,378][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 13:37:37,379][root][INFO] - Score: 88.43 [%]  |  Evaluation Time: 44.68 [s]
[2024-09-22 13:37:39,615][root][INFO] - Step: 5500/9020  |  Loss: 0.2248  |  Score: 90.84 [%]  |  Seq Length: 256.0
[2024-09-22 13:38:24,888][root][INFO] - Step: 5600/9020  |  Loss: 0.2425  |  Score: 90.20 [%]  |  Seq Length: 256.0
[2024-09-22 13:39:10,253][root][INFO] - Step: 5700/9020  |  Loss: 0.2500  |  Score: 89.75 [%]  |  Seq Length: 256.0
[2024-09-22 13:39:54,571][root][INFO] - Step: 5800/9020  |  Loss: 0.2392  |  Score: 90.27 [%]  |  Seq Length: 256.0
[2024-09-22 13:40:04,522][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 13:40:04,523][root][INFO] - Score: 88.22 [%]  |  Evaluation Time: 147.14 [s]
[2024-09-22 13:40:04,523][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 13:40:04,525][root][INFO] - 
[4/ 5 Epoch]
[2024-09-22 13:40:39,263][root][INFO] - Step: 5900/9020  |  Loss: 0.2468  |  Score: 89.67 [%]  |  Seq Length: 256.0
[2024-09-22 13:40:48,723][root][INFO] - Step: 5500/9020  |  Loss: 0.2180  |  Score: 91.30 [%]  |  Seq Length: 256.0
[2024-09-22 13:41:24,535][root][INFO] - Step: 6000/9020  |  Loss: 0.2401  |  Score: 89.94 [%]  |  Seq Length: 256.0
[2024-09-22 13:41:38,371][root][INFO] - Step: 5600/9020  |  Loss: 0.2113  |  Score: 91.66 [%]  |  Seq Length: 256.0
[2024-09-22 13:42:09,829][root][INFO] - Step: 6100/9020  |  Loss: 0.2256  |  Score: 90.64 [%]  |  Seq Length: 256.0
[2024-09-22 13:42:28,321][root][INFO] - Step: 5700/9020  |  Loss: 0.2166  |  Score: 91.52 [%]  |  Seq Length: 256.0
[2024-09-22 13:42:55,139][root][INFO] - Step: 6200/9020  |  Loss: 0.2303  |  Score: 90.92 [%]  |  Seq Length: 256.0
[2024-09-22 13:43:18,146][root][INFO] - Step: 5800/9020  |  Loss: 0.2212  |  Score: 90.66 [%]  |  Seq Length: 256.0
[2024-09-22 13:43:40,434][root][INFO] - Step: 6300/9020  |  Loss: 0.2428  |  Score: 90.05 [%]  |  Seq Length: 256.0
[2024-09-22 13:44:07,564][root][INFO] - Step: 5900/9020  |  Loss: 0.2280  |  Score: 90.95 [%]  |  Seq Length: 256.0
[2024-09-22 13:44:25,771][root][INFO] - Step: 6400/9020  |  Loss: 0.2321  |  Score: 90.39 [%]  |  Seq Length: 256.0
[2024-09-22 13:44:57,008][root][INFO] - Step: 6000/9020  |  Loss: 0.2247  |  Score: 91.02 [%]  |  Seq Length: 256.0
[2024-09-22 13:45:11,137][root][INFO] - Step: 6500/9020  |  Loss: 0.2402  |  Score: 90.75 [%]  |  Seq Length: 256.0
[2024-09-22 13:45:46,443][root][INFO] - Step: 6100/9020  |  Loss: 0.2294  |  Score: 90.70 [%]  |  Seq Length: 256.0
[2024-09-22 13:45:56,388][root][INFO] - Step: 6600/9020  |  Loss: 0.2384  |  Score: 90.00 [%]  |  Seq Length: 256.0
[2024-09-22 13:46:35,882][root][INFO] - Step: 6200/9020  |  Loss: 0.2167  |  Score: 91.56 [%]  |  Seq Length: 256.0
[2024-09-22 13:46:41,714][root][INFO] - Step: 6700/9020  |  Loss: 0.2381  |  Score: 90.66 [%]  |  Seq Length: 256.0
[2024-09-22 13:47:25,325][root][INFO] - Step: 6300/9020  |  Loss: 0.2148  |  Score: 91.19 [%]  |  Seq Length: 256.0
[2024-09-22 13:47:27,074][root][INFO] - Step: 6800/9020  |  Loss: 0.2302  |  Score: 90.06 [%]  |  Seq Length: 256.0
[2024-09-22 13:48:12,306][root][INFO] - Step: 6900/9020  |  Loss: 0.2250  |  Score: 90.73 [%]  |  Seq Length: 256.0
[2024-09-22 13:48:14,831][root][INFO] - Step: 6400/9020  |  Loss: 0.2174  |  Score: 91.39 [%]  |  Seq Length: 256.0
[2024-09-22 13:48:57,603][root][INFO] - Step: 7000/9020  |  Loss: 0.2471  |  Score: 89.62 [%]  |  Seq Length: 256.0
[2024-09-22 13:49:04,250][root][INFO] - Step: 6500/9020  |  Loss: 0.1997  |  Score: 91.88 [%]  |  Seq Length: 256.0
[2024-09-22 13:49:43,000][root][INFO] - Step: 7100/9020  |  Loss: 0.2352  |  Score: 90.48 [%]  |  Seq Length: 256.0
[2024-09-22 13:49:53,690][root][INFO] - Step: 6600/9020  |  Loss: 0.2103  |  Score: 91.48 [%]  |  Seq Length: 256.0
[2024-09-22 13:50:28,427][root][INFO] - Step: 7200/9020  |  Loss: 0.2255  |  Score: 90.62 [%]  |  Seq Length: 256.0
[2024-09-22 13:50:35,715][root][INFO] - Step: 7216/9020  |  Loss: 0.2105  |  Score: 91.74 [%]  |  Seq Length: 256.0
[2024-09-22 13:50:43,598][root][INFO] - Step: 6700/9020  |  Loss: 0.2171  |  Score: 91.59 [%]  |  Seq Length: 256.0
[2024-09-22 13:51:17,383][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 13:51:17,383][root][INFO] - Score: 88.51 [%]  |  Evaluation Time: 41.67 [s]
[2024-09-22 13:51:33,141][root][INFO] - Step: 6800/9020  |  Loss: 0.2130  |  Score: 91.20 [%]  |  Seq Length: 256.0
[2024-09-22 13:52:22,794][root][INFO] - Step: 6900/9020  |  Loss: 0.2245  |  Score: 91.08 [%]  |  Seq Length: 256.0
[2024-09-22 13:53:12,241][root][INFO] - Step: 7000/9020  |  Loss: 0.2105  |  Score: 91.50 [%]  |  Seq Length: 256.0
[2024-09-22 13:53:35,048][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 13:53:35,048][root][INFO] - Score: 88.44 [%]  |  Evaluation Time: 137.66 [s]
[2024-09-22 13:53:35,049][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-22 13:53:35,051][root][INFO] - 
[5/ 5 Epoch]
[2024-09-22 13:54:01,877][root][INFO] - Step: 7100/9020  |  Loss: 0.2178  |  Score: 91.16 [%]  |  Seq Length: 256.0
[2024-09-22 13:54:13,502][root][INFO] - Step: 7300/9020  |  Loss: 0.2092  |  Score: 91.63 [%]  |  Seq Length: 256.0
[2024-09-22 13:54:51,333][root][INFO] - Step: 7200/9020  |  Loss: 0.2182  |  Score: 90.84 [%]  |  Seq Length: 256.0
[2024-09-22 13:54:58,795][root][INFO] - Step: 7400/9020  |  Loss: 0.2071  |  Score: 91.97 [%]  |  Seq Length: 256.0
[2024-09-22 13:54:59,247][root][INFO] - Step: 7216/9020  |  Loss: 0.2157  |  Score: 91.62 [%]  |  Seq Length: 256.0
[2024-09-22 13:55:43,959][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 13:55:43,959][root][INFO] - Score: 88.65 [%]  |  Evaluation Time: 44.71 [s]
[2024-09-22 13:55:44,058][root][INFO] - Step: 7500/9020  |  Loss: 0.2053  |  Score: 91.55 [%]  |  Seq Length: 256.0
[2024-09-22 13:56:29,871][root][INFO] - Step: 7600/9020  |  Loss: 0.2131  |  Score: 91.14 [%]  |  Seq Length: 256.0
[2024-09-22 13:57:15,218][root][INFO] - Step: 7700/9020  |  Loss: 0.2093  |  Score: 91.30 [%]  |  Seq Length: 256.0
[2024-09-22 13:58:00,661][root][INFO] - Step: 7800/9020  |  Loss: 0.2150  |  Score: 91.16 [%]  |  Seq Length: 256.0
[2024-09-22 13:58:11,328][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 13:58:11,328][root][INFO] - Score: 88.34 [%]  |  Evaluation Time: 147.37 [s]
[2024-09-22 13:58:11,329][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-22 13:58:11,330][root][INFO] - 
[5/ 5 Epoch]
[2024-09-22 13:58:45,989][root][INFO] - Step: 7900/9020  |  Loss: 0.2066  |  Score: 91.59 [%]  |  Seq Length: 256.0
[2024-09-22 13:58:53,297][root][INFO] - Step: 7300/9020  |  Loss: 0.1935  |  Score: 92.22 [%]  |  Seq Length: 256.0
[2024-09-22 13:59:31,317][root][INFO] - Step: 8000/9020  |  Loss: 0.2132  |  Score: 91.39 [%]  |  Seq Length: 256.0
[2024-09-22 13:59:42,669][root][INFO] - Step: 7400/9020  |  Loss: 0.1877  |  Score: 92.64 [%]  |  Seq Length: 256.0
[2024-09-22 14:00:16,803][root][INFO] - Step: 8100/9020  |  Loss: 0.2071  |  Score: 91.52 [%]  |  Seq Length: 256.0
[2024-09-22 14:00:32,012][root][INFO] - Step: 7500/9020  |  Loss: 0.1997  |  Score: 91.78 [%]  |  Seq Length: 256.0
[2024-09-22 14:01:02,104][root][INFO] - Step: 8200/9020  |  Loss: 0.2113  |  Score: 91.78 [%]  |  Seq Length: 256.0
[2024-09-22 14:01:21,718][root][INFO] - Step: 7600/9020  |  Loss: 0.2011  |  Score: 91.86 [%]  |  Seq Length: 256.0
[2024-09-22 14:01:47,383][root][INFO] - Step: 8300/9020  |  Loss: 0.2097  |  Score: 91.50 [%]  |  Seq Length: 256.0
[2024-09-22 14:02:11,240][root][INFO] - Step: 7700/9020  |  Loss: 0.1926  |  Score: 92.56 [%]  |  Seq Length: 256.0
[2024-09-22 14:02:32,659][root][INFO] - Step: 8400/9020  |  Loss: 0.2081  |  Score: 91.73 [%]  |  Seq Length: 256.0
[2024-09-22 14:03:00,596][root][INFO] - Step: 7800/9020  |  Loss: 0.1967  |  Score: 91.95 [%]  |  Seq Length: 256.0
[2024-09-22 14:03:18,100][root][INFO] - Step: 8500/9020  |  Loss: 0.2127  |  Score: 91.08 [%]  |  Seq Length: 256.0
[2024-09-22 14:03:50,101][root][INFO] - Step: 7900/9020  |  Loss: 0.1865  |  Score: 92.55 [%]  |  Seq Length: 256.0
[2024-09-22 14:04:03,485][root][INFO] - Step: 8600/9020  |  Loss: 0.2073  |  Score: 91.17 [%]  |  Seq Length: 256.0
[2024-09-22 14:04:39,629][root][INFO] - Step: 8000/9020  |  Loss: 0.1967  |  Score: 92.03 [%]  |  Seq Length: 256.0
[2024-09-22 14:04:49,190][root][INFO] - Step: 8700/9020  |  Loss: 0.2099  |  Score: 91.56 [%]  |  Seq Length: 256.0
[2024-09-22 14:05:29,256][root][INFO] - Step: 8100/9020  |  Loss: 0.2031  |  Score: 92.19 [%]  |  Seq Length: 256.0
[2024-09-22 14:05:34,700][root][INFO] - Step: 8800/9020  |  Loss: 0.2189  |  Score: 91.30 [%]  |  Seq Length: 256.0
[2024-09-22 14:06:18,684][root][INFO] - Step: 8200/9020  |  Loss: 0.1881  |  Score: 92.39 [%]  |  Seq Length: 256.0
[2024-09-22 14:06:19,985][root][INFO] - Step: 8900/9020  |  Loss: 0.1939  |  Score: 92.41 [%]  |  Seq Length: 256.0
[2024-09-22 14:07:05,363][root][INFO] - Step: 9000/9020  |  Loss: 0.2095  |  Score: 91.39 [%]  |  Seq Length: 256.0
[2024-09-22 14:07:08,137][root][INFO] - Step: 8300/9020  |  Loss: 0.1923  |  Score: 92.67 [%]  |  Seq Length: 256.0
[2024-09-22 14:07:14,492][root][INFO] - Step: 9020/9020  |  Loss: 0.2046  |  Score: 91.98 [%]  |  Seq Length: 256.0
[2024-09-22 14:07:55,922][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 14:07:55,923][root][INFO] - Score: 88.31 [%]  |  Evaluation Time: 41.43 [s]
[2024-09-22 14:07:57,856][root][INFO] - Step: 8400/9020  |  Loss: 0.1971  |  Score: 92.19 [%]  |  Seq Length: 256.0
[2024-09-22 14:08:45,936][root][INFO] - Step: 8500/9020  |  Loss: 0.1899  |  Score: 92.83 [%]  |  Seq Length: 256.0
[2024-09-22 14:09:34,016][root][INFO] - Step: 8600/9020  |  Loss: 0.1870  |  Score: 92.52 [%]  |  Seq Length: 256.0
[2024-09-22 14:10:13,633][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 14:10:13,633][root][INFO] - Score: 88.49 [%]  |  Evaluation Time: 137.71 [s]
[2024-09-22 14:10:13,634][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 14:10:13,635][root][INFO] - - Epoch: 4
[2024-09-22 14:10:13,635][root][INFO] - - DEV score: 88.51 [%]
[2024-09-22 14:10:13,635][root][INFO] - - TEST score: 88.44 [%]
[2024-09-22 14:10:13,635][root][INFO] - Fine-tuning is done!
[2024-09-22 14:10:23,540][root][INFO] - Step: 8700/9020  |  Loss: 0.1963  |  Score: 92.05 [%]  |  Seq Length: 256.0
[2024-09-22 14:11:12,913][root][INFO] - Step: 8800/9020  |  Loss: 0.1876  |  Score: 92.64 [%]  |  Seq Length: 256.0
[2024-09-22 14:12:02,239][root][INFO] - Step: 8900/9020  |  Loss: 0.1932  |  Score: 92.27 [%]  |  Seq Length: 256.0
[2024-09-22 14:12:50,158][root][INFO] - Step: 9000/9020  |  Loss: 0.1940  |  Score: 91.98 [%]  |  Seq Length: 256.0
[2024-09-22 14:12:59,796][root][INFO] - Step: 9020/9020  |  Loss: 0.1756  |  Score: 93.01 [%]  |  Seq Length: 256.0
[2024-09-22 14:13:44,298][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 14:13:44,298][root][INFO] - Score: 88.73 [%]  |  Evaluation Time: 44.50 [s]
[2024-09-22 14:16:11,825][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 14:16:11,825][root][INFO] - Score: 88.51 [%]  |  Evaluation Time: 147.52 [s]
[2024-09-22 14:16:11,826][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-22 14:16:11,826][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 14:16:11,827][root][INFO] - - Epoch: 5
[2024-09-22 14:16:11,827][root][INFO] - - DEV score: 88.73 [%]
[2024-09-22 14:16:11,827][root][INFO] - - TEST score: 88.51 [%]
[2024-09-22 14:16:11,828][root][INFO] - Fine-tuning is done!
[2024-09-22 14:40:24,084][root][INFO] - 

[2024-09-22 14:40:24,085][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 14:40:24,085][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-22 14:40:24,085][root][INFO] - 

[2024-09-22 14:40:24,085][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 14:40:29,351][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:29,352][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:29,352][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:29,353][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:29,354][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:29,354][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:29,355][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:29,355][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:29,356][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:29,356][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:29,357][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:29,357][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:29,358][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:29,358][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:29,359][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:29,359][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:29,360][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:29,360][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:29,361][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:29,361][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:29,362][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:29,362][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:29,363][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:29,363][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:29,365][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-22 14:40:29,369][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-22 14:40:29,480][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-22 14:40:29,482][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-22 14:40:29,672][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 14:40:32,894][root][INFO] - 

[2024-09-22 14:40:32,894][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-22 14:40:32,894][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 14:40:32,903][root][INFO] - vocab size              : 51200
[2024-09-22 14:40:32,903][root][INFO] - device                  : gpu
[2024-09-22 14:40:32,903][root][INFO] - random seed             : 42
[2024-09-22 14:40:32,904][root][INFO] - train data size         : 4416
[2024-09-22 14:40:32,904][root][INFO] - max epochs              : 15
[2024-09-22 14:40:32,904][root][INFO] - total steps             : 1035
[2024-09-22 14:40:32,904][root][INFO] - warmup steps            : 104
[2024-09-22 14:40:32,904][root][INFO] - batch size              : 64
[2024-09-22 14:40:32,904][root][INFO] - accumulation steps      : 1
[2024-09-22 14:40:32,904][root][INFO] - optimizer               : adamwscale
[2024-09-22 14:40:32,904][root][INFO] - lr_scheduler            : cosine
[2024-09-22 14:40:32,904][root][INFO] - learning rate           : 0.01
[2024-09-22 14:40:32,904][root][INFO] - max length              : 256

[2024-09-22 14:40:32,904][root][INFO] - LoRA Configuration
[2024-09-22 14:40:32,905][root][INFO] - ㄴ r                    : 32
[2024-09-22 14:40:32,905][root][INFO] - ㄴ alpha                : 128
[2024-09-22 14:40:32,905][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 14:40:32,905][root][INFO] - KOMBO Configuration
[2024-09-22 14:40:32,905][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-22 14:40:32,905][root][INFO] - ㄴ reducer              : linear
[2024-09-22 14:40:32,905][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-22 14:40:32,905][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-22 14:40:32,905][root][INFO] - ㄴ do_combination       : True
[2024-09-22 14:40:32,905][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-22 14:40:32,906][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-22 14:40:32,906][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-22 14:40:32,906][root][INFO] -   ㄴ add_lora           : True
[2024-09-22 14:40:32,906][root][INFO] -     ㄴ LoRA in KOMBO Configuration
[2024-09-22 14:40:32,906][root][INFO] -     ㄴ r                : 32
[2024-09-22 14:40:32,906][root][INFO] -     ㄴ alpha            : 128
[2024-09-22 14:40:32,906][root][INFO] -     ㄴ dropout          : 0.03

[2024-09-22 14:40:32,906][root][INFO] - 

[2024-09-22 14:40:32,906][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-22 14:40:32,906][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-22 14:40:32,907][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb
[2024-09-22 14:40:32,907][root][INFO] - * tb interval           : 15

[2024-09-22 14:40:32,907][root][INFO] - 

[2024-09-22 14:40:32,907][root][INFO] - Start the Training !
[2024-09-22 14:40:32,910][root][INFO] - 
[1/ 15 Epoch]
[2024-09-22 14:40:37,022][root][INFO] - 

[2024-09-22 14:40:37,022][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 14:40:37,022][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-22 14:40:37,022][root][INFO] - 

[2024-09-22 14:40:37,022][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 14:40:41,302][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:41,302][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:41,303][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:41,303][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:41,304][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:41,304][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:41,305][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:41,305][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:41,306][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:41,306][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:41,307][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:41,307][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:41,308][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:41,308][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:41,309][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:41,309][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:41,310][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:41,310][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:41,311][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:41,311][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:41,312][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:41,312][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:41,313][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:41,313][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:41,315][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-22 14:40:41,319][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-22 14:40:41,321][root][INFO] - Step: 15/1035  |  Loss: 3.1755  |  Score: 6.57 [%]  |  Seq Length: 256.0
[2024-09-22 14:40:41,328][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-22 14:40:41,330][root][INFO] - Trainable params: 2445312 || all params: 127610112 || trainable: 1.92 %
[2024-09-22 14:40:41,508][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 14:40:43,367][root][INFO] - 

[2024-09-22 14:40:43,367][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-22 14:40:43,367][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 14:40:43,377][root][INFO] - vocab size              : 51200
[2024-09-22 14:40:43,377][root][INFO] - device                  : gpu
[2024-09-22 14:40:43,377][root][INFO] - random seed             : 42
[2024-09-22 14:40:43,377][root][INFO] - train data size         : 4416
[2024-09-22 14:40:43,377][root][INFO] - max epochs              : 15
[2024-09-22 14:40:43,377][root][INFO] - total steps             : 1035
[2024-09-22 14:40:43,377][root][INFO] - warmup steps            : 104
[2024-09-22 14:40:43,377][root][INFO] - batch size              : 64
[2024-09-22 14:40:43,377][root][INFO] - accumulation steps      : 1
[2024-09-22 14:40:43,377][root][INFO] - optimizer               : adamwscale
[2024-09-22 14:40:43,378][root][INFO] - lr_scheduler            : cosine
[2024-09-22 14:40:43,378][root][INFO] - learning rate           : 0.01
[2024-09-22 14:40:43,378][root][INFO] - max length              : 256

[2024-09-22 14:40:43,378][root][INFO] - LoRA Configuration
[2024-09-22 14:40:43,378][root][INFO] - ㄴ r                    : 32
[2024-09-22 14:40:43,378][root][INFO] - ㄴ alpha                : 128
[2024-09-22 14:40:43,378][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 14:40:43,378][root][INFO] - KOMBO Configuration
[2024-09-22 14:40:43,378][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-22 14:40:43,378][root][INFO] - ㄴ reducer              : linear
[2024-09-22 14:40:43,378][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-22 14:40:43,379][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-22 14:40:43,379][root][INFO] - ㄴ do_combination       : False
[2024-09-22 14:40:43,379][root][INFO] - 

[2024-09-22 14:40:43,379][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-22 14:40:43,379][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-22 14:40:43,379][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb
[2024-09-22 14:40:43,379][root][INFO] - * tb interval           : 15

[2024-09-22 14:40:43,379][root][INFO] - 

[2024-09-22 14:40:43,379][root][INFO] - Start the Training !
[2024-09-22 14:40:43,382][root][INFO] - 
[1/ 15 Epoch]
[2024-09-22 14:40:49,081][root][INFO] - Step: 30/1035  |  Loss: 2.2292  |  Score: 15.33 [%]  |  Seq Length: 256.0
[2024-09-22 14:40:51,886][root][INFO] - Step: 15/1035  |  Loss: 3.3616  |  Score: 1.68 [%]  |  Seq Length: 256.0
[2024-09-22 14:40:56,752][root][INFO] - Step: 45/1035  |  Loss: 1.9333  |  Score: 44.29 [%]  |  Seq Length: 256.0
[2024-09-22 14:40:58,842][root][INFO] - Step: 30/1035  |  Loss: 2.3374  |  Score: 17.76 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:04,431][root][INFO] - Step: 60/1035  |  Loss: 1.5788  |  Score: 60.56 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:05,792][root][INFO] - Step: 45/1035  |  Loss: 2.0065  |  Score: 42.24 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:09,056][root][INFO] - Step: 69/1035  |  Loss: 1.4620  |  Score: 59.51 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:12,745][root][INFO] - Step: 60/1035  |  Loss: 1.7463  |  Score: 54.26 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:14,042][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 14:41:14,042][root][INFO] - Score: 69.61 [%]  |  Evaluation Time: 4.98 [s]
[2024-09-22 14:41:16,936][root][INFO] - Step: 69/1035  |  Loss: 1.6465  |  Score: 50.62 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:18,749][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 14:41:18,750][root][INFO] - Score: 64.70 [%]  |  Evaluation Time: 4.70 [s]
[2024-09-22 14:41:18,751][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 14:41:18,752][root][INFO] - 
[2/ 15 Epoch]
[2024-09-22 14:41:21,504][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 14:41:21,504][root][INFO] - Score: 69.14 [%]  |  Evaluation Time: 4.57 [s]
[2024-09-22 14:41:22,277][root][INFO] - Step: 75/1035  |  Loss: 1.4586  |  Score: 63.10 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:25,815][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 14:41:25,816][root][INFO] - Score: 62.88 [%]  |  Evaluation Time: 4.31 [s]
[2024-09-22 14:41:25,817][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 14:41:25,818][root][INFO] - 
[2/ 15 Epoch]
[2024-09-22 14:41:28,990][root][INFO] - Step: 75/1035  |  Loss: 1.4359  |  Score: 60.42 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:29,930][root][INFO] - Step: 90/1035  |  Loss: 1.3902  |  Score: 60.89 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:35,951][root][INFO] - Step: 90/1035  |  Loss: 1.3881  |  Score: 63.46 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:37,637][root][INFO] - Step: 105/1035  |  Loss: 1.3371  |  Score: 66.18 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:42,902][root][INFO] - Step: 105/1035  |  Loss: 1.4297  |  Score: 60.37 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:45,405][root][INFO] - Step: 120/1035  |  Loss: 1.3008  |  Score: 64.73 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:49,875][root][INFO] - Step: 120/1035  |  Loss: 1.5446  |  Score: 62.32 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:53,073][root][INFO] - Step: 135/1035  |  Loss: 1.2237  |  Score: 65.09 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:54,671][root][INFO] - Step: 138/1035  |  Loss: 1.0851  |  Score: 66.37 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:56,835][root][INFO] - Step: 135/1035  |  Loss: 1.3655  |  Score: 66.50 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:58,282][root][INFO] - Step: 138/1035  |  Loss: 1.1967  |  Score: 64.19 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:59,643][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 14:41:59,643][root][INFO] - Score: 76.44 [%]  |  Evaluation Time: 4.97 [s]
[2024-09-22 14:42:02,863][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 14:42:02,863][root][INFO] - Score: 74.39 [%]  |  Evaluation Time: 4.58 [s]
[2024-09-22 14:42:04,311][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 14:42:04,311][root][INFO] - Score: 68.69 [%]  |  Evaluation Time: 4.67 [s]
[2024-09-22 14:42:04,313][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 14:42:04,314][root][INFO] - 
[3/ 15 Epoch]
[2024-09-22 14:42:07,217][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 14:42:07,217][root][INFO] - Score: 66.36 [%]  |  Evaluation Time: 4.35 [s]
[2024-09-22 14:42:07,219][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 14:42:07,220][root][INFO] - 
[3/ 15 Epoch]
[2024-09-22 14:42:10,884][root][INFO] - Step: 150/1035  |  Loss: 1.0193  |  Score: 70.70 [%]  |  Seq Length: 256.0
[2024-09-22 14:42:13,148][root][INFO] - Step: 150/1035  |  Loss: 1.1084  |  Score: 67.75 [%]  |  Seq Length: 256.0
[2024-09-22 14:42:18,618][root][INFO] - Step: 165/1035  |  Loss: 1.0329  |  Score: 73.95 [%]  |  Seq Length: 256.0
[2024-09-22 14:42:20,158][root][INFO] - Step: 165/1035  |  Loss: 1.1663  |  Score: 67.43 [%]  |  Seq Length: 256.0
[2024-09-22 14:42:26,272][root][INFO] - Step: 180/1035  |  Loss: 1.0868  |  Score: 69.52 [%]  |  Seq Length: 256.0
[2024-09-22 14:42:27,225][root][INFO] - Step: 180/1035  |  Loss: 1.0554  |  Score: 72.25 [%]  |  Seq Length: 256.0
[2024-09-22 14:42:34,008][root][INFO] - Step: 195/1035  |  Loss: 1.0960  |  Score: 69.89 [%]  |  Seq Length: 256.0
[2024-09-22 14:42:34,218][root][INFO] - Step: 195/1035  |  Loss: 1.0936  |  Score: 71.21 [%]  |  Seq Length: 256.0
[2024-09-22 14:42:39,892][root][INFO] - Step: 207/1035  |  Loss: 1.1163  |  Score: 70.33 [%]  |  Seq Length: 256.0
[2024-09-22 14:42:40,223][root][INFO] - Step: 207/1035  |  Loss: 1.1138  |  Score: 69.19 [%]  |  Seq Length: 256.0
[2024-09-22 14:42:44,506][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 14:42:44,506][root][INFO] - Score: 77.16 [%]  |  Evaluation Time: 4.61 [s]
[2024-09-22 14:42:45,208][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 14:42:45,208][root][INFO] - Score: 77.39 [%]  |  Evaluation Time: 4.98 [s]
[2024-09-22 14:42:48,807][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 14:42:48,807][root][INFO] - Score: 69.85 [%]  |  Evaluation Time: 4.30 [s]
[2024-09-22 14:42:48,808][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 14:42:48,810][root][INFO] - 
[4/ 15 Epoch]
[2024-09-22 14:42:49,878][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 14:42:49,879][root][INFO] - Score: 68.75 [%]  |  Evaluation Time: 4.67 [s]
[2024-09-22 14:42:49,880][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 14:42:49,882][root][INFO] - 
[4/ 15 Epoch]
[2024-09-22 14:42:50,607][root][INFO] - Step: 210/1035  |  Loss: 0.6890  |  Score: 81.80 [%]  |  Seq Length: 256.0
[2024-09-22 14:42:51,826][root][INFO] - Step: 210/1035  |  Loss: 1.1022  |  Score: 77.70 [%]  |  Seq Length: 256.0
[2024-09-22 14:42:57,494][root][INFO] - Step: 225/1035  |  Loss: 0.8860  |  Score: 74.24 [%]  |  Seq Length: 256.0
[2024-09-22 14:42:59,644][root][INFO] - Step: 225/1035  |  Loss: 0.9247  |  Score: 76.09 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:04,482][root][INFO] - Step: 240/1035  |  Loss: 0.9064  |  Score: 74.64 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:07,505][root][INFO] - Step: 240/1035  |  Loss: 1.0435  |  Score: 74.08 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:11,455][root][INFO] - Step: 255/1035  |  Loss: 0.9375  |  Score: 74.47 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:15,294][root][INFO] - Step: 255/1035  |  Loss: 0.9443  |  Score: 72.96 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:18,413][root][INFO] - Step: 270/1035  |  Loss: 0.9591  |  Score: 76.70 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:21,258][root][INFO] - Step: 276/1035  |  Loss: 0.8056  |  Score: 77.31 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:23,011][root][INFO] - Step: 270/1035  |  Loss: 0.8937  |  Score: 76.51 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:25,846][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 14:43:25,846][root][INFO] - Score: 77.20 [%]  |  Evaluation Time: 4.58 [s]
[2024-09-22 14:43:26,158][root][INFO] - Step: 276/1035  |  Loss: 0.8483  |  Score: 77.13 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:30,144][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 14:43:30,144][root][INFO] - Score: 70.85 [%]  |  Evaluation Time: 4.30 [s]
[2024-09-22 14:43:30,145][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-22 14:43:30,147][root][INFO] - 
[5/ 15 Epoch]
[2024-09-22 14:43:31,134][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 14:43:31,134][root][INFO] - Score: 76.88 [%]  |  Evaluation Time: 4.97 [s]
[2024-09-22 14:43:34,722][root][INFO] - Step: 285/1035  |  Loss: 0.8870  |  Score: 81.01 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:35,946][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 14:43:35,946][root][INFO] - Score: 70.36 [%]  |  Evaluation Time: 4.81 [s]
[2024-09-22 14:43:35,947][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-22 14:43:35,949][root][INFO] - 
[5/ 15 Epoch]
[2024-09-22 14:43:40,913][root][INFO] - Step: 285/1035  |  Loss: 0.8454  |  Score: 79.29 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:41,782][root][INFO] - Step: 300/1035  |  Loss: 0.7352  |  Score: 81.76 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:48,775][root][INFO] - Step: 315/1035  |  Loss: 0.7920  |  Score: 80.64 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:48,794][root][INFO] - Step: 300/1035  |  Loss: 0.7618  |  Score: 81.51 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:55,748][root][INFO] - Step: 330/1035  |  Loss: 0.8909  |  Score: 77.15 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:56,573][root][INFO] - Step: 315/1035  |  Loss: 0.8042  |  Score: 76.65 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:02,759][root][INFO] - Step: 345/1035  |  Loss: 0.8306  |  Score: 75.86 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:04,308][root][INFO] - Step: 330/1035  |  Loss: 0.8230  |  Score: 77.59 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:07,304][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 14:44:07,304][root][INFO] - Score: 75.96 [%]  |  Evaluation Time: 4.54 [s]
[2024-09-22 14:44:11,630][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 14:44:11,630][root][INFO] - Score: 70.43 [%]  |  Evaluation Time: 4.32 [s]
[2024-09-22 14:44:11,632][root][INFO] - 
[6/ 15 Epoch]
[2024-09-22 14:44:12,112][root][INFO] - Step: 345/1035  |  Loss: 0.8123  |  Score: 76.86 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:12,475][root][INFO] - Step: 346/1035  |  Loss: 0.8210  |  Score: 79.65 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:17,213][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 14:44:17,213][root][INFO] - Score: 77.42 [%]  |  Evaluation Time: 5.10 [s]
[2024-09-22 14:44:18,994][root][INFO] - Step: 360/1035  |  Loss: 0.6674  |  Score: 82.55 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:21,814][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 14:44:21,814][root][INFO] - Score: 70.11 [%]  |  Evaluation Time: 4.60 [s]
[2024-09-22 14:44:21,815][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-22 14:44:21,817][root][INFO] - 
[6/ 15 Epoch]
[2024-09-22 14:44:22,711][root][INFO] - Step: 346/1035  |  Loss: 0.6872  |  Score: 83.17 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:25,970][root][INFO] - Step: 375/1035  |  Loss: 0.6461  |  Score: 80.95 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:29,946][root][INFO] - Step: 360/1035  |  Loss: 0.7082  |  Score: 80.57 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:32,957][root][INFO] - Step: 390/1035  |  Loss: 0.6440  |  Score: 83.21 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:37,672][root][INFO] - Step: 375/1035  |  Loss: 0.6758  |  Score: 80.06 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:39,961][root][INFO] - Step: 405/1035  |  Loss: 0.7017  |  Score: 78.79 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:44,248][root][INFO] - Step: 414/1035  |  Loss: 0.6846  |  Score: 82.24 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:45,368][root][INFO] - Step: 390/1035  |  Loss: 0.7430  |  Score: 79.01 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:48,850][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-22 14:44:48,850][root][INFO] - Score: 76.21 [%]  |  Evaluation Time: 4.60 [s]
[2024-09-22 14:44:53,064][root][INFO] - Step: 405/1035  |  Loss: 0.7902  |  Score: 80.39 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:53,144][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-22 14:44:53,145][root][INFO] - Score: 69.14 [%]  |  Evaluation Time: 4.29 [s]
[2024-09-22 14:44:53,147][root][INFO] - 
[7/ 15 Epoch]
[2024-09-22 14:44:56,353][root][INFO] - Step: 420/1035  |  Loss: 0.5867  |  Score: 83.84 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:57,873][root][INFO] - Step: 414/1035  |  Loss: 0.7998  |  Score: 80.93 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:02,870][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-22 14:45:02,870][root][INFO] - Score: 78.78 [%]  |  Evaluation Time: 4.99 [s]
[2024-09-22 14:45:03,410][root][INFO] - Step: 435/1035  |  Loss: 0.5462  |  Score: 85.26 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:07,534][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-22 14:45:07,534][root][INFO] - Score: 70.78 [%]  |  Evaluation Time: 4.66 [s]
[2024-09-22 14:45:07,536][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-22 14:45:07,537][root][INFO] - 
[7/ 15 Epoch]
[2024-09-22 14:45:10,401][root][INFO] - Step: 450/1035  |  Loss: 0.5845  |  Score: 84.25 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:11,046][root][INFO] - Step: 420/1035  |  Loss: 0.6725  |  Score: 82.98 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:17,352][root][INFO] - Step: 465/1035  |  Loss: 0.6200  |  Score: 82.97 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:18,792][root][INFO] - Step: 435/1035  |  Loss: 0.6210  |  Score: 83.57 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:24,301][root][INFO] - Step: 480/1035  |  Loss: 0.5693  |  Score: 83.56 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:25,777][root][INFO] - Step: 483/1035  |  Loss: 0.4703  |  Score: 87.98 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:26,510][root][INFO] - Step: 450/1035  |  Loss: 0.6591  |  Score: 81.53 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:30,307][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-22 14:45:30,307][root][INFO] - Score: 76.38 [%]  |  Evaluation Time: 4.53 [s]
[2024-09-22 14:45:34,243][root][INFO] - Step: 465/1035  |  Loss: 0.6958  |  Score: 80.06 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:34,635][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-22 14:45:34,635][root][INFO] - Score: 69.15 [%]  |  Evaluation Time: 4.32 [s]
[2024-09-22 14:45:34,638][root][INFO] - 
[8/ 15 Epoch]
[2024-09-22 14:45:40,586][root][INFO] - Step: 495/1035  |  Loss: 0.4987  |  Score: 85.38 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:41,901][root][INFO] - Step: 480/1035  |  Loss: 0.6175  |  Score: 83.61 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:43,508][root][INFO] - Step: 483/1035  |  Loss: 0.4885  |  Score: 87.55 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:47,678][root][INFO] - Step: 510/1035  |  Loss: 0.5902  |  Score: 85.03 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:48,551][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-22 14:45:48,551][root][INFO] - Score: 77.21 [%]  |  Evaluation Time: 5.04 [s]
[2024-09-22 14:45:53,228][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-22 14:45:53,229][root][INFO] - Score: 69.85 [%]  |  Evaluation Time: 4.67 [s]
[2024-09-22 14:45:53,231][root][INFO] - 
[8/ 15 Epoch]
[2024-09-22 14:45:54,695][root][INFO] - Step: 525/1035  |  Loss: 0.5029  |  Score: 87.17 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:59,804][root][INFO] - Step: 495/1035  |  Loss: 0.5479  |  Score: 86.06 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:01,671][root][INFO] - Step: 540/1035  |  Loss: 0.4947  |  Score: 86.79 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:07,320][root][INFO] - Step: 552/1035  |  Loss: 0.5306  |  Score: 84.17 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:07,521][root][INFO] - Step: 510/1035  |  Loss: 0.5316  |  Score: 84.91 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:11,847][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-22 14:46:11,847][root][INFO] - Score: 77.59 [%]  |  Evaluation Time: 4.52 [s]
[2024-09-22 14:46:15,283][root][INFO] - Step: 525/1035  |  Loss: 0.5587  |  Score: 85.03 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:16,203][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-22 14:46:16,203][root][INFO] - Score: 70.11 [%]  |  Evaluation Time: 4.35 [s]
[2024-09-22 14:46:16,206][root][INFO] - 
[9/ 15 Epoch]
[2024-09-22 14:46:17,948][root][INFO] - Step: 555/1035  |  Loss: 0.3929  |  Score: 88.06 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:23,046][root][INFO] - Step: 540/1035  |  Loss: 0.5785  |  Score: 85.12 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:24,932][root][INFO] - Step: 570/1035  |  Loss: 0.5206  |  Score: 86.96 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:29,282][root][INFO] - Step: 552/1035  |  Loss: 0.5210  |  Score: 83.40 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:31,912][root][INFO] - Step: 585/1035  |  Loss: 0.4483  |  Score: 87.39 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:34,278][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-22 14:46:34,278][root][INFO] - Score: 78.04 [%]  |  Evaluation Time: 4.99 [s]
[2024-09-22 14:46:38,901][root][INFO] - Step: 600/1035  |  Loss: 0.4252  |  Score: 88.71 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:39,028][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-22 14:46:39,029][root][INFO] - Score: 70.54 [%]  |  Evaluation Time: 4.75 [s]
[2024-09-22 14:46:39,031][root][INFO] - 
[9/ 15 Epoch]
[2024-09-22 14:46:40,914][root][INFO] - Step: 555/1035  |  Loss: 0.4475  |  Score: 89.08 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:45,906][root][INFO] - Step: 615/1035  |  Loss: 0.4243  |  Score: 87.57 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:48,642][root][INFO] - Step: 570/1035  |  Loss: 0.4427  |  Score: 87.30 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:48,774][root][INFO] - Step: 621/1035  |  Loss: 0.5340  |  Score: 83.42 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:53,325][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-22 14:46:53,325][root][INFO] - Score: 75.61 [%]  |  Evaluation Time: 4.55 [s]
[2024-09-22 14:46:56,357][root][INFO] - Step: 585/1035  |  Loss: 0.5534  |  Score: 86.54 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:57,604][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-22 14:46:57,604][root][INFO] - Score: 70.64 [%]  |  Evaluation Time: 4.28 [s]
[2024-09-22 14:46:57,607][root][INFO] - 
[10/ 15 Epoch]
[2024-09-22 14:47:02,178][root][INFO] - Step: 630/1035  |  Loss: 0.4078  |  Score: 88.96 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:04,076][root][INFO] - Step: 600/1035  |  Loss: 0.5639  |  Score: 84.84 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:09,175][root][INFO] - Step: 645/1035  |  Loss: 0.3911  |  Score: 89.41 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:11,810][root][INFO] - Step: 615/1035  |  Loss: 0.4776  |  Score: 85.89 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:15,033][root][INFO] - Step: 621/1035  |  Loss: 0.4834  |  Score: 85.83 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:16,195][root][INFO] - Step: 660/1035  |  Loss: 0.3678  |  Score: 89.94 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:20,027][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-22 14:47:20,027][root][INFO] - Score: 77.21 [%]  |  Evaluation Time: 4.99 [s]
[2024-09-22 14:47:23,229][root][INFO] - Step: 675/1035  |  Loss: 0.4434  |  Score: 88.34 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:24,723][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-22 14:47:24,723][root][INFO] - Score: 70.99 [%]  |  Evaluation Time: 4.69 [s]
[2024-09-22 14:47:24,726][root][INFO] - 
[10/ 15 Epoch]
[2024-09-22 14:47:29,719][root][INFO] - Step: 630/1035  |  Loss: 0.4556  |  Score: 85.32 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:30,286][root][INFO] - Step: 690/1035  |  Loss: 0.3997  |  Score: 88.92 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:34,807][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-22 14:47:34,807][root][INFO] - Score: 76.82 [%]  |  Evaluation Time: 4.52 [s]
[2024-09-22 14:47:37,501][root][INFO] - Step: 645/1035  |  Loss: 0.4086  |  Score: 89.64 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:39,102][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-22 14:47:39,103][root][INFO] - Score: 70.31 [%]  |  Evaluation Time: 4.29 [s]
[2024-09-22 14:47:39,105][root][INFO] - 
[11/ 15 Epoch]
[2024-09-22 14:47:39,932][root][INFO] - Step: 691/1035  |  Loss: 0.3019  |  Score: 93.34 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:45,242][root][INFO] - Step: 660/1035  |  Loss: 0.4189  |  Score: 87.49 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:46,523][root][INFO] - Step: 705/1035  |  Loss: 0.3664  |  Score: 90.58 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:53,065][root][INFO] - Step: 675/1035  |  Loss: 0.4473  |  Score: 87.90 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:53,539][root][INFO] - Step: 720/1035  |  Loss: 0.4145  |  Score: 90.35 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:00,596][root][INFO] - Step: 735/1035  |  Loss: 0.3326  |  Score: 90.42 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:00,840][root][INFO] - Step: 690/1035  |  Loss: 0.4637  |  Score: 86.98 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:05,811][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-22 14:48:05,811][root][INFO] - Score: 77.35 [%]  |  Evaluation Time: 4.97 [s]
[2024-09-22 14:48:07,619][root][INFO] - Step: 750/1035  |  Loss: 0.3554  |  Score: 89.62 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:10,544][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-22 14:48:10,544][root][INFO] - Score: 72.13 [%]  |  Evaluation Time: 4.73 [s]
[2024-09-22 14:48:10,546][root][INFO] - 
[11/ 15 Epoch]
[2024-09-22 14:48:11,506][root][INFO] - Step: 691/1035  |  Loss: 0.5337  |  Score: 86.28 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:11,910][root][INFO] - Step: 759/1035  |  Loss: 0.3664  |  Score: 89.73 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:16,472][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-22 14:48:16,473][root][INFO] - Score: 77.74 [%]  |  Evaluation Time: 4.56 [s]
[2024-09-22 14:48:18,748][root][INFO] - Step: 705/1035  |  Loss: 0.3915  |  Score: 89.11 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:20,802][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-22 14:48:20,803][root][INFO] - Score: 70.69 [%]  |  Evaluation Time: 4.33 [s]
[2024-09-22 14:48:20,804][root][INFO] - 
Save new Best Score (Epoch: 11)
[2024-09-22 14:48:20,805][root][INFO] - 
[12/ 15 Epoch]
[2024-09-22 14:48:23,964][root][INFO] - Step: 765/1035  |  Loss: 0.3250  |  Score: 90.56 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:26,465][root][INFO] - Step: 720/1035  |  Loss: 0.3999  |  Score: 88.90 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:30,991][root][INFO] - Step: 780/1035  |  Loss: 0.3438  |  Score: 90.52 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:34,307][root][INFO] - Step: 735/1035  |  Loss: 0.4172  |  Score: 87.29 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:38,025][root][INFO] - Step: 795/1035  |  Loss: 0.3284  |  Score: 90.90 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:42,039][root][INFO] - Step: 750/1035  |  Loss: 0.4258  |  Score: 89.42 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:45,076][root][INFO] - Step: 810/1035  |  Loss: 0.3432  |  Score: 91.07 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:46,759][root][INFO] - Step: 759/1035  |  Loss: 0.4569  |  Score: 87.97 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:51,831][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-22 14:48:51,831][root][INFO] - Score: 77.40 [%]  |  Evaluation Time: 5.07 [s]
[2024-09-22 14:48:52,141][root][INFO] - Step: 825/1035  |  Loss: 0.3527  |  Score: 89.96 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:53,642][root][INFO] - Step: 828/1035  |  Loss: 0.3349  |  Score: 91.83 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:56,698][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-22 14:48:56,698][root][INFO] - Score: 69.76 [%]  |  Evaluation Time: 4.87 [s]
[2024-09-22 14:48:56,701][root][INFO] - 
[12/ 15 Epoch]
[2024-09-22 14:48:58,415][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-22 14:48:58,415][root][INFO] - Score: 77.17 [%]  |  Evaluation Time: 4.77 [s]
[2024-09-22 14:49:00,252][root][INFO] - Step: 765/1035  |  Loss: 0.3614  |  Score: 87.29 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:02,743][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-22 14:49:02,744][root][INFO] - Score: 70.26 [%]  |  Evaluation Time: 4.32 [s]
[2024-09-22 14:49:02,747][root][INFO] - 
[13/ 15 Epoch]
[2024-09-22 14:49:08,038][root][INFO] - Step: 780/1035  |  Loss: 0.3956  |  Score: 89.17 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:08,730][root][INFO] - Step: 840/1035  |  Loss: 0.3277  |  Score: 90.57 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:15,710][root][INFO] - Step: 855/1035  |  Loss: 0.3138  |  Score: 91.32 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:15,764][root][INFO] - Step: 795/1035  |  Loss: 0.3972  |  Score: 88.92 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:22,721][root][INFO] - Step: 870/1035  |  Loss: 0.3283  |  Score: 91.26 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:23,481][root][INFO] - Step: 810/1035  |  Loss: 0.3434  |  Score: 91.29 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:29,696][root][INFO] - Step: 885/1035  |  Loss: 0.3400  |  Score: 90.52 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:31,165][root][INFO] - Step: 825/1035  |  Loss: 0.3996  |  Score: 88.90 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:32,786][root][INFO] - Step: 828/1035  |  Loss: 0.3424  |  Score: 91.10 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:35,363][root][INFO] - Step: 897/1035  |  Loss: 0.2887  |  Score: 90.16 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:37,762][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-22 14:49:37,762][root][INFO] - Score: 78.39 [%]  |  Evaluation Time: 4.97 [s]
[2024-09-22 14:49:39,938][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-22 14:49:39,938][root][INFO] - Score: 77.27 [%]  |  Evaluation Time: 4.57 [s]
[2024-09-22 14:49:42,480][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-22 14:49:42,480][root][INFO] - Score: 70.51 [%]  |  Evaluation Time: 4.72 [s]
[2024-09-22 14:49:42,483][root][INFO] - 
[13/ 15 Epoch]
[2024-09-22 14:49:44,287][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-22 14:49:44,287][root][INFO] - Score: 69.67 [%]  |  Evaluation Time: 4.35 [s]
[2024-09-22 14:49:44,290][root][INFO] - 
[14/ 15 Epoch]
[2024-09-22 14:49:46,052][root][INFO] - Step: 900/1035  |  Loss: 0.2292  |  Score: 94.13 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:49,134][root][INFO] - Step: 840/1035  |  Loss: 0.3860  |  Score: 89.38 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:53,053][root][INFO] - Step: 915/1035  |  Loss: 0.3199  |  Score: 91.15 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:56,807][root][INFO] - Step: 855/1035  |  Loss: 0.3876  |  Score: 90.05 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:00,124][root][INFO] - Step: 930/1035  |  Loss: 0.3082  |  Score: 91.54 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:04,531][root][INFO] - Step: 870/1035  |  Loss: 0.3850  |  Score: 88.01 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:07,146][root][INFO] - Step: 945/1035  |  Loss: 0.3072  |  Score: 91.79 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:12,329][root][INFO] - Step: 885/1035  |  Loss: 0.3411  |  Score: 89.87 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:14,162][root][INFO] - Step: 960/1035  |  Loss: 0.3090  |  Score: 91.20 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:17,020][root][INFO] - Step: 966/1035  |  Loss: 0.2850  |  Score: 92.58 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:18,656][root][INFO] - Step: 897/1035  |  Loss: 0.3517  |  Score: 89.95 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:21,644][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-22 14:50:21,644][root][INFO] - Score: 76.64 [%]  |  Evaluation Time: 4.62 [s]
[2024-09-22 14:50:23,617][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-22 14:50:23,617][root][INFO] - Score: 77.13 [%]  |  Evaluation Time: 4.96 [s]
[2024-09-22 14:50:25,979][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-22 14:50:25,979][root][INFO] - Score: 70.93 [%]  |  Evaluation Time: 4.33 [s]
[2024-09-22 14:50:25,982][root][INFO] - 
[15/ 15 Epoch]
[2024-09-22 14:50:28,407][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-22 14:50:28,407][root][INFO] - Score: 70.25 [%]  |  Evaluation Time: 4.79 [s]
[2024-09-22 14:50:28,410][root][INFO] - 
[14/ 15 Epoch]
[2024-09-22 14:50:30,382][root][INFO] - Step: 900/1035  |  Loss: 0.3753  |  Score: 89.61 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:30,532][root][INFO] - Step: 975/1035  |  Loss: 0.3150  |  Score: 91.16 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:37,666][root][INFO] - Step: 990/1035  |  Loss: 0.3177  |  Score: 91.06 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:38,196][root][INFO] - Step: 915/1035  |  Loss: 0.3530  |  Score: 89.12 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:44,657][root][INFO] - Step: 1005/1035  |  Loss: 0.3040  |  Score: 91.52 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:45,942][root][INFO] - Step: 930/1035  |  Loss: 0.3562  |  Score: 90.03 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:51,645][root][INFO] - Step: 1020/1035  |  Loss: 0.2872  |  Score: 92.25 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:53,714][root][INFO] - Step: 945/1035  |  Loss: 0.3456  |  Score: 90.43 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:58,642][root][INFO] - Step: 1035/1035  |  Loss: 0.2910  |  Score: 91.42 [%]  |  Seq Length: 256.0
[2024-09-22 14:51:01,362][root][INFO] - Step: 960/1035  |  Loss: 0.3494  |  Score: 89.30 [%]  |  Seq Length: 256.0
[2024-09-22 14:51:03,200][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-22 14:51:03,200][root][INFO] - Score: 76.10 [%]  |  Evaluation Time: 4.55 [s]
[2024-09-22 14:51:04,528][root][INFO] - Step: 966/1035  |  Loss: 0.3569  |  Score: 89.88 [%]  |  Seq Length: 256.0
[2024-09-22 14:51:07,469][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-22 14:51:07,469][root][INFO] - Score: 70.42 [%]  |  Evaluation Time: 4.27 [s]
[2024-09-22 14:51:07,471][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 14:51:07,471][root][INFO] - - Epoch: 11
[2024-09-22 14:51:07,471][root][INFO] - - DEV score: 77.74 [%]
[2024-09-22 14:51:07,471][root][INFO] - - TEST score: 70.69 [%]
[2024-09-22 14:51:07,472][root][INFO] - Fine-tuning is done!
[2024-09-22 14:51:09,783][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-22 14:51:09,783][root][INFO] - Score: 77.45 [%]  |  Evaluation Time: 5.25 [s]
[2024-09-22 14:51:14,500][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-22 14:51:14,500][root][INFO] - Score: 70.36 [%]  |  Evaluation Time: 4.71 [s]
[2024-09-22 14:51:14,503][root][INFO] - 
[15/ 15 Epoch]
[2024-09-22 14:51:19,449][root][INFO] - Step: 975/1035  |  Loss: 0.3409  |  Score: 90.86 [%]  |  Seq Length: 256.0
[2024-09-22 14:51:27,139][root][INFO] - Step: 990/1035  |  Loss: 0.3503  |  Score: 90.01 [%]  |  Seq Length: 256.0
[2024-09-22 14:51:34,855][root][INFO] - Step: 1005/1035  |  Loss: 0.3195  |  Score: 91.16 [%]  |  Seq Length: 256.0
[2024-09-22 14:51:42,580][root][INFO] - Step: 1020/1035  |  Loss: 0.3550  |  Score: 88.45 [%]  |  Seq Length: 256.0
[2024-09-22 14:51:50,359][root][INFO] - Step: 1035/1035  |  Loss: 0.3544  |  Score: 90.79 [%]  |  Seq Length: 256.0
[2024-09-22 14:51:55,399][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-22 14:51:55,399][root][INFO] - Score: 77.21 [%]  |  Evaluation Time: 5.04 [s]
[2024-09-22 14:52:00,148][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-22 14:52:00,148][root][INFO] - Score: 71.31 [%]  |  Evaluation Time: 4.75 [s]
[2024-09-22 14:52:00,149][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 14:52:00,149][root][INFO] - - Epoch: 6
[2024-09-22 14:52:00,150][root][INFO] - - DEV score: 78.78 [%]
[2024-09-22 14:52:00,150][root][INFO] - - TEST score: 70.78 [%]
[2024-09-22 14:52:00,150][root][INFO] - Fine-tuning is done!
[2024-09-22 14:55:28,421][root][INFO] - 

[2024-09-22 14:55:28,421][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 14:55:28,422][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs
[2024-09-22 14:55:28,422][root][INFO] - 

[2024-09-22 14:55:28,422][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'PAWS_X'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 75, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 14:55:36,628][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 14:55:36,628][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 14:55:36,629][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 14:55:36,630][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 14:55:36,630][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 14:55:36,630][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 14:55:36,631][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 14:55:36,631][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 14:55:36,632][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 14:55:36,632][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 14:55:36,633][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 14:55:36,633][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 14:55:36,634][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 14:55:36,634][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 14:55:36,635][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 14:55:36,635][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 14:55:36,636][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 14:55:36,636][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 14:55:36,636][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 14:55:36,637][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 14:55:36,639][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 14:55:36,639][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 14:55:36,640][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 14:55:36,640][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 14:55:36,642][root][INFO] - Trainable params: 1769472 || all params: 126935040 || trainable: 1.39 %
[2024-09-22 14:55:36,646][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-22 14:55:36,656][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-22 14:55:36,658][root][INFO] - Trainable params: 2445312 || all params: 127610880 || trainable: 1.92 %
[2024-09-22 14:55:36,841][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 14:55:38,738][root][INFO] - 

[2024-09-22 14:55:38,738][root][INFO] - ========== Fine-tuning on PAWS_X ==========
[2024-09-22 14:55:38,738][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 14:55:38,746][root][INFO] - vocab size              : 51200
[2024-09-22 14:55:38,746][root][INFO] - device                  : gpu
[2024-09-22 14:55:38,746][root][INFO] - random seed             : 42
[2024-09-22 14:55:38,746][root][INFO] - train data size         : 24256
[2024-09-22 14:55:38,746][root][INFO] - max epochs              : 5
[2024-09-22 14:55:38,746][root][INFO] - total steps             : 1895
[2024-09-22 14:55:38,747][root][INFO] - warmup steps            : 190
[2024-09-22 14:55:38,747][root][INFO] - batch size              : 64
[2024-09-22 14:55:38,747][root][INFO] - accumulation steps      : 1
[2024-09-22 14:55:38,747][root][INFO] - optimizer               : adamwscale
[2024-09-22 14:55:38,747][root][INFO] - lr_scheduler            : cosine
[2024-09-22 14:55:38,747][root][INFO] - learning rate           : 0.01
[2024-09-22 14:55:38,747][root][INFO] - max length              : 256

[2024-09-22 14:55:38,747][root][INFO] - LoRA Configuration
[2024-09-22 14:55:38,747][root][INFO] - ㄴ r                    : 32
[2024-09-22 14:55:38,747][root][INFO] - ㄴ alpha                : 128
[2024-09-22 14:55:38,747][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 14:55:38,747][root][INFO] - KOMBO Configuration
[2024-09-22 14:55:38,748][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-22 14:55:38,748][root][INFO] - ㄴ reducer              : linear
[2024-09-22 14:55:38,748][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-22 14:55:38,748][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-22 14:55:38,748][root][INFO] - ㄴ do_combination       : False
[2024-09-22 14:55:38,748][root][INFO] - 

[2024-09-22 14:55:38,748][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs
[2024-09-22 14:55:38,748][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-22 14:55:38,748][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs/tb
[2024-09-22 14:55:38,748][root][INFO] - * tb interval           : 75

[2024-09-22 14:55:38,748][root][INFO] - 

[2024-09-22 14:55:38,748][root][INFO] - Start the Training !
[2024-09-22 14:55:38,751][root][INFO] - 
[1/ 5 Epoch]
[2024-09-22 14:55:47,357][root][INFO] - 

[2024-09-22 14:55:47,357][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 14:55:47,357][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs
[2024-09-22 14:55:47,358][root][INFO] - 

[2024-09-22 14:55:47,358][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'PAWS_X'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 75, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 14:56:10,549][root][INFO] - 

[2024-09-22 14:56:10,549][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 14:56:10,549][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs
[2024-09-22 14:56:10,549][root][INFO] - 

[2024-09-22 14:56:10,549][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'PAWS_X'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 75, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 14:56:17,727][root][INFO] - Step: 75/1895  |  Loss: 0.7248  |  Score: 51.08 [%]  |  Seq Length: 256.0
[2024-09-22 14:56:18,701][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 14:56:18,702][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 14:56:18,702][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 14:56:18,703][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 14:56:18,703][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 14:56:18,704][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 14:56:18,705][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 14:56:18,705][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 14:56:18,706][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 14:56:18,706][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 14:56:18,707][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 14:56:18,707][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 14:56:18,708][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 14:56:18,708][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 14:56:18,709][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 14:56:18,710][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 14:56:18,710][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 14:56:18,711][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 14:56:18,711][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 14:56:18,712][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 14:56:18,715][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 14:56:18,716][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 14:56:18,716][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 14:56:18,717][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 14:56:18,719][root][INFO] - Trainable params: 1769472 || all params: 126935040 || trainable: 1.39 %
[2024-09-22 14:56:18,723][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-22 14:56:18,828][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-22 14:56:18,831][root][INFO] - Trainable params: 9034752 || all params: 134200320 || trainable: 6.73 %
[2024-09-22 14:56:19,025][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 14:56:22,211][root][INFO] - 

[2024-09-22 14:56:22,211][root][INFO] - ========== Fine-tuning on PAWS_X ==========
[2024-09-22 14:56:22,211][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 14:56:22,222][root][INFO] - vocab size              : 51200
[2024-09-22 14:56:22,222][root][INFO] - device                  : gpu
[2024-09-22 14:56:22,222][root][INFO] - random seed             : 42
[2024-09-22 14:56:22,222][root][INFO] - train data size         : 24256
[2024-09-22 14:56:22,222][root][INFO] - max epochs              : 5
[2024-09-22 14:56:22,223][root][INFO] - total steps             : 1895
[2024-09-22 14:56:22,223][root][INFO] - warmup steps            : 190
[2024-09-22 14:56:22,223][root][INFO] - batch size              : 64
[2024-09-22 14:56:22,223][root][INFO] - accumulation steps      : 1
[2024-09-22 14:56:22,223][root][INFO] - optimizer               : adamwscale
[2024-09-22 14:56:22,223][root][INFO] - lr_scheduler            : cosine
[2024-09-22 14:56:22,223][root][INFO] - learning rate           : 0.01
[2024-09-22 14:56:22,223][root][INFO] - max length              : 256

[2024-09-22 14:56:22,223][root][INFO] - LoRA Configuration
[2024-09-22 14:56:22,223][root][INFO] - ㄴ r                    : 32
[2024-09-22 14:56:22,223][root][INFO] - ㄴ alpha                : 128
[2024-09-22 14:56:22,223][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 14:56:22,224][root][INFO] - KOMBO Configuration
[2024-09-22 14:56:22,224][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-22 14:56:22,224][root][INFO] - ㄴ reducer              : linear
[2024-09-22 14:56:22,224][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-22 14:56:22,224][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-22 14:56:22,224][root][INFO] - ㄴ do_combination       : True
[2024-09-22 14:56:22,224][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-22 14:56:22,224][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-22 14:56:22,224][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-22 14:56:22,224][root][INFO] -   ㄴ add_lora           : True
[2024-09-22 14:56:22,225][root][INFO] -     ㄴ LoRA in KOMBO Configuration
[2024-09-22 14:56:22,225][root][INFO] -     ㄴ r                : 32
[2024-09-22 14:56:22,225][root][INFO] -     ㄴ alpha            : 128
[2024-09-22 14:56:22,225][root][INFO] -     ㄴ dropout          : 0.03

[2024-09-22 14:56:22,225][root][INFO] - 

[2024-09-22 14:56:22,225][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs
[2024-09-22 14:56:22,225][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-22 14:56:22,225][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs/tb
[2024-09-22 14:56:22,225][root][INFO] - * tb interval           : 75

[2024-09-22 14:56:22,225][root][INFO] - 

[2024-09-22 14:56:22,225][root][INFO] - Start the Training !
[2024-09-22 14:56:22,228][root][INFO] - 
[1/ 5 Epoch]
[2024-09-22 14:56:55,458][root][INFO] - Step: 150/1895  |  Loss: 0.7018  |  Score: 52.15 [%]  |  Seq Length: 256.0
[2024-09-22 14:57:06,039][root][INFO] - Step: 75/1895  |  Loss: 0.7196  |  Score: 52.60 [%]  |  Seq Length: 256.0
[2024-09-22 14:57:33,137][root][INFO] - Step: 225/1895  |  Loss: 0.7236  |  Score: 51.83 [%]  |  Seq Length: 256.0
[2024-09-22 14:57:49,127][root][INFO] - Step: 150/1895  |  Loss: 0.7044  |  Score: 52.21 [%]  |  Seq Length: 256.0
[2024-09-22 14:58:10,831][root][INFO] - Step: 300/1895  |  Loss: 0.6976  |  Score: 52.79 [%]  |  Seq Length: 256.0
[2024-09-22 14:58:32,139][root][INFO] - Step: 225/1895  |  Loss: 0.6947  |  Score: 54.21 [%]  |  Seq Length: 256.0
[2024-09-22 14:58:48,540][root][INFO] - Step: 375/1895  |  Loss: 0.7057  |  Score: 51.77 [%]  |  Seq Length: 256.0
[2024-09-22 14:58:50,285][root][INFO] - Step: 379/1895  |  Loss: 0.6775  |  Score: 59.90 [%]  |  Seq Length: 256.0
[2024-09-22 14:58:54,538][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 14:58:54,538][root][INFO] - Score: 52.28 [%]  |  Evaluation Time: 4.25 [s]
[2024-09-22 14:58:58,695][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 14:58:58,695][root][INFO] - Score: 52.93 [%]  |  Evaluation Time: 4.15 [s]
[2024-09-22 14:58:58,697][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 14:58:58,698][root][INFO] - 
[2/ 5 Epoch]
[2024-09-22 14:59:15,144][root][INFO] - Step: 300/1895  |  Loss: 0.6790  |  Score: 58.06 [%]  |  Seq Length: 256.0
[2024-09-22 14:59:34,750][root][INFO] - Step: 450/1895  |  Loss: 0.6974  |  Score: 52.20 [%]  |  Seq Length: 256.0
[2024-09-22 14:59:58,124][root][INFO] - Step: 375/1895  |  Loss: 0.6519  |  Score: 63.96 [%]  |  Seq Length: 256.0
[2024-09-22 15:00:00,073][root][INFO] - Step: 379/1895  |  Loss: 0.5906  |  Score: 73.70 [%]  |  Seq Length: 256.0
[2024-09-22 15:00:04,705][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 15:00:04,705][root][INFO] - Score: 59.41 [%]  |  Evaluation Time: 4.63 [s]
[2024-09-22 15:00:09,250][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 15:00:09,250][root][INFO] - Score: 59.91 [%]  |  Evaluation Time: 4.54 [s]
[2024-09-22 15:00:09,251][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 15:00:09,252][root][INFO] - 
[2/ 5 Epoch]
[2024-09-22 15:00:12,299][root][INFO] - Step: 525/1895  |  Loss: 0.6975  |  Score: 52.88 [%]  |  Seq Length: 256.0
[2024-09-22 15:00:49,904][root][INFO] - Step: 600/1895  |  Loss: 0.7008  |  Score: 50.54 [%]  |  Seq Length: 256.0
[2024-09-22 15:00:50,480][root][INFO] - Step: 450/1895  |  Loss: 0.6007  |  Score: 67.67 [%]  |  Seq Length: 256.0
[2024-09-22 15:01:27,543][root][INFO] - Step: 675/1895  |  Loss: 0.6944  |  Score: 53.94 [%]  |  Seq Length: 256.0
[2024-09-22 15:01:33,718][root][INFO] - Step: 525/1895  |  Loss: 0.5923  |  Score: 69.00 [%]  |  Seq Length: 256.0
[2024-09-22 15:02:05,199][root][INFO] - Step: 750/1895  |  Loss: 0.6957  |  Score: 52.12 [%]  |  Seq Length: 256.0
[2024-09-22 15:02:08,989][root][INFO] - Step: 758/1895  |  Loss: 0.7067  |  Score: 48.44 [%]  |  Seq Length: 256.0
[2024-09-22 15:02:13,202][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 15:02:13,202][root][INFO] - Score: 55.37 [%]  |  Evaluation Time: 4.21 [s]
[2024-09-22 15:02:16,825][root][INFO] - Step: 600/1895  |  Loss: 0.5603  |  Score: 71.02 [%]  |  Seq Length: 256.0
[2024-09-22 15:02:17,391][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 15:02:17,391][root][INFO] - Score: 53.31 [%]  |  Evaluation Time: 4.19 [s]
[2024-09-22 15:02:17,392][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 15:02:17,394][root][INFO] - 
[3/ 5 Epoch]
[2024-09-22 15:02:51,482][root][INFO] - Step: 825/1895  |  Loss: 0.6962  |  Score: 52.99 [%]  |  Seq Length: 256.0
[2024-09-22 15:02:59,967][root][INFO] - Step: 675/1895  |  Loss: 0.5570  |  Score: 71.44 [%]  |  Seq Length: 256.0
[2024-09-22 15:03:29,139][root][INFO] - Step: 900/1895  |  Loss: 0.6918  |  Score: 53.85 [%]  |  Seq Length: 256.0
[2024-09-22 15:03:43,255][root][INFO] - Step: 750/1895  |  Loss: 0.5660  |  Score: 70.75 [%]  |  Seq Length: 256.0
[2024-09-22 15:03:47,529][root][INFO] - Step: 758/1895  |  Loss: 0.5607  |  Score: 72.98 [%]  |  Seq Length: 256.0
[2024-09-22 15:03:52,198][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 15:03:52,198][root][INFO] - Score: 63.90 [%]  |  Evaluation Time: 4.67 [s]
[2024-09-22 15:03:56,806][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 15:03:56,806][root][INFO] - Score: 63.22 [%]  |  Evaluation Time: 4.61 [s]
[2024-09-22 15:03:56,808][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 15:03:56,811][root][INFO] - 
[3/ 5 Epoch]
[2024-09-22 15:04:06,690][root][INFO] - Step: 975/1895  |  Loss: 0.7008  |  Score: 51.44 [%]  |  Seq Length: 256.0
[2024-09-22 15:04:36,097][root][INFO] - Step: 825/1895  |  Loss: 0.5127  |  Score: 74.39 [%]  |  Seq Length: 256.0
[2024-09-22 15:04:44,272][root][INFO] - Step: 1050/1895  |  Loss: 0.6933  |  Score: 53.54 [%]  |  Seq Length: 256.0
[2024-09-22 15:05:19,353][root][INFO] - Step: 900/1895  |  Loss: 0.5065  |  Score: 74.98 [%]  |  Seq Length: 256.0
[2024-09-22 15:05:21,832][root][INFO] - Step: 1125/1895  |  Loss: 0.6921  |  Score: 54.04 [%]  |  Seq Length: 256.0
[2024-09-22 15:05:27,564][root][INFO] - Step: 1137/1895  |  Loss: 0.6891  |  Score: 55.03 [%]  |  Seq Length: 256.0
[2024-09-22 15:05:31,859][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 15:05:31,860][root][INFO] - Score: 54.36 [%]  |  Evaluation Time: 4.29 [s]
[2024-09-22 15:05:36,017][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 15:05:36,017][root][INFO] - Score: 52.88 [%]  |  Evaluation Time: 4.15 [s]
[2024-09-22 15:05:36,020][root][INFO] - 
[4/ 5 Epoch]
[2024-09-22 15:06:02,551][root][INFO] - Step: 975/1895  |  Loss: 0.5018  |  Score: 75.62 [%]  |  Seq Length: 256.0
[2024-09-22 15:06:08,026][root][INFO] - Step: 1200/1895  |  Loss: 0.6919  |  Score: 53.60 [%]  |  Seq Length: 256.0
[2024-09-22 15:06:45,542][root][INFO] - Step: 1050/1895  |  Loss: 0.4944  |  Score: 76.00 [%]  |  Seq Length: 256.0
[2024-09-22 15:06:45,610][root][INFO] - Step: 1275/1895  |  Loss: 0.6877  |  Score: 55.35 [%]  |  Seq Length: 256.0
[2024-09-22 15:07:23,270][root][INFO] - Step: 1350/1895  |  Loss: 0.6894  |  Score: 54.33 [%]  |  Seq Length: 256.0
[2024-09-22 15:07:28,583][root][INFO] - Step: 1125/1895  |  Loss: 0.5106  |  Score: 74.83 [%]  |  Seq Length: 256.0
[2024-09-22 15:07:35,113][root][INFO] - Step: 1137/1895  |  Loss: 0.5070  |  Score: 75.95 [%]  |  Seq Length: 256.0
[2024-09-22 15:07:39,778][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 15:07:39,779][root][INFO] - Score: 65.23 [%]  |  Evaluation Time: 4.66 [s]
[2024-09-22 15:07:44,359][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 15:07:44,359][root][INFO] - Score: 65.60 [%]  |  Evaluation Time: 4.58 [s]
[2024-09-22 15:07:44,360][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 15:07:44,362][root][INFO] - 
[4/ 5 Epoch]
[2024-09-22 15:08:00,917][root][INFO] - Step: 1425/1895  |  Loss: 0.6886  |  Score: 54.19 [%]  |  Seq Length: 256.0
[2024-09-22 15:08:21,001][root][INFO] - Step: 1200/1895  |  Loss: 0.4637  |  Score: 77.41 [%]  |  Seq Length: 256.0
[2024-09-22 15:08:38,648][root][INFO] - Step: 1500/1895  |  Loss: 0.6874  |  Score: 54.92 [%]  |  Seq Length: 256.0
[2024-09-22 15:08:46,379][root][INFO] - Step: 1516/1895  |  Loss: 0.6744  |  Score: 59.67 [%]  |  Seq Length: 256.0
[2024-09-22 15:08:50,620][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 15:08:50,621][root][INFO] - Score: 54.46 [%]  |  Evaluation Time: 4.24 [s]
[2024-09-22 15:08:54,867][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 15:08:54,867][root][INFO] - Score: 53.00 [%]  |  Evaluation Time: 4.24 [s]
[2024-09-22 15:08:54,870][root][INFO] - 
[5/ 5 Epoch]
[2024-09-22 15:09:04,195][root][INFO] - Step: 1275/1895  |  Loss: 0.4496  |  Score: 79.02 [%]  |  Seq Length: 256.0
[2024-09-22 15:09:24,879][root][INFO] - Step: 1575/1895  |  Loss: 0.6777  |  Score: 56.67 [%]  |  Seq Length: 256.0
[2024-09-22 15:09:47,040][root][INFO] - Step: 1350/1895  |  Loss: 0.4550  |  Score: 78.27 [%]  |  Seq Length: 256.0
[2024-09-22 15:10:02,458][root][INFO] - Step: 1650/1895  |  Loss: 0.6784  |  Score: 56.73 [%]  |  Seq Length: 256.0
[2024-09-22 15:10:30,166][root][INFO] - Step: 1425/1895  |  Loss: 0.4382  |  Score: 79.27 [%]  |  Seq Length: 256.0
[2024-09-22 15:10:40,047][root][INFO] - Step: 1725/1895  |  Loss: 0.6722  |  Score: 58.52 [%]  |  Seq Length: 256.0
[2024-09-22 15:11:13,405][root][INFO] - Step: 1500/1895  |  Loss: 0.4497  |  Score: 78.92 [%]  |  Seq Length: 256.0
[2024-09-22 15:11:17,565][root][INFO] - Step: 1800/1895  |  Loss: 0.6734  |  Score: 57.96 [%]  |  Seq Length: 256.0
[2024-09-22 15:11:22,369][root][INFO] - Step: 1516/1895  |  Loss: 0.4357  |  Score: 79.17 [%]  |  Seq Length: 256.0
[2024-09-22 15:11:27,013][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 15:11:27,013][root][INFO] - Score: 69.21 [%]  |  Evaluation Time: 4.64 [s]
[2024-09-22 15:11:31,540][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 15:11:31,540][root][INFO] - Score: 66.81 [%]  |  Evaluation Time: 4.52 [s]
[2024-09-22 15:11:31,541][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-22 15:11:31,543][root][INFO] - 
[5/ 5 Epoch]
[2024-09-22 15:11:55,223][root][INFO] - Step: 1875/1895  |  Loss: 0.6690  |  Score: 58.56 [%]  |  Seq Length: 256.0
[2024-09-22 15:12:04,985][root][INFO] - Step: 1895/1895  |  Loss: 0.6758  |  Score: 56.69 [%]  |  Seq Length: 256.0
[2024-09-22 15:12:05,605][root][INFO] - Step: 1575/1895  |  Loss: 0.4151  |  Score: 80.64 [%]  |  Seq Length: 256.0
[2024-09-22 15:12:09,208][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 15:12:09,208][root][INFO] - Score: 50.94 [%]  |  Evaluation Time: 4.22 [s]
[2024-09-22 15:12:13,390][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 15:12:13,391][root][INFO] - Score: 51.56 [%]  |  Evaluation Time: 4.18 [s]
[2024-09-22 15:12:13,392][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 15:12:13,392][root][INFO] - - Epoch: 2
[2024-09-22 15:12:13,392][root][INFO] - - DEV score: 55.37 [%]
[2024-09-22 15:12:13,392][root][INFO] - - TEST score: 53.31 [%]
[2024-09-22 15:12:13,393][root][INFO] - Fine-tuning is done!
[2024-09-22 15:12:48,599][root][INFO] - Step: 1650/1895  |  Loss: 0.4203  |  Score: 80.50 [%]  |  Seq Length: 256.0
[2024-09-22 15:13:31,685][root][INFO] - Step: 1725/1895  |  Loss: 0.4160  |  Score: 80.98 [%]  |  Seq Length: 256.0
[2024-09-22 15:14:14,399][root][INFO] - Step: 1800/1895  |  Loss: 0.4229  |  Score: 80.71 [%]  |  Seq Length: 256.0
[2024-09-22 15:14:57,163][root][INFO] - Step: 1875/1895  |  Loss: 0.4272  |  Score: 80.50 [%]  |  Seq Length: 256.0
[2024-09-22 15:15:08,456][root][INFO] - Step: 1895/1895  |  Loss: 0.4179  |  Score: 80.60 [%]  |  Seq Length: 256.0
[2024-09-22 15:15:13,110][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 15:15:13,110][root][INFO] - Score: 72.27 [%]  |  Evaluation Time: 4.65 [s]
[2024-09-22 15:15:17,704][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 15:15:17,704][root][INFO] - Score: 66.68 [%]  |  Evaluation Time: 4.59 [s]
[2024-09-22 15:15:17,706][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-22 15:15:17,706][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 15:15:17,706][root][INFO] - - Epoch: 5
[2024-09-22 15:15:17,706][root][INFO] - - DEV score: 72.27 [%]
[2024-09-22 15:15:17,706][root][INFO] - - TEST score: 66.68 [%]
[2024-09-22 15:15:17,707][root][INFO] - Fine-tuning is done!
[2024-09-22 15:49:12,051][root][INFO] - 

[2024-09-22 15:49:12,051][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 15:49:12,051][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs
[2024-09-22 15:49:12,052][root][INFO] - 

[2024-09-22 15:49:12,052][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'PAWS_X'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 75, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 15:49:21,115][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 15:49:21,116][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 15:49:21,117][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 15:49:21,117][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 15:49:21,117][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 15:49:21,118][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 15:49:21,118][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 15:49:21,119][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 15:49:21,119][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 15:49:21,120][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 15:49:21,120][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 15:49:21,120][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 15:49:21,121][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 15:49:21,121][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 15:49:21,122][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 15:49:21,122][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 15:49:21,123][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 15:49:21,123][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 15:49:21,123][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 15:49:21,124][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 15:49:21,127][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 15:49:21,127][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 15:49:21,128][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 15:49:21,128][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 15:49:21,130][root][INFO] - Trainable params: 1769472 || all params: 126935040 || trainable: 1.39 %
[2024-09-22 15:49:21,134][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-22 15:49:21,147][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-22 15:49:21,149][root][INFO] - Trainable params: 2445312 || all params: 127610880 || trainable: 1.92 %
[2024-09-22 15:49:21,340][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 15:49:23,413][root][INFO] - 

[2024-09-22 15:49:23,413][root][INFO] - ========== Fine-tuning on PAWS_X ==========
[2024-09-22 15:49:23,413][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 15:49:23,421][root][INFO] - vocab size              : 51200
[2024-09-22 15:49:23,421][root][INFO] - device                  : gpu
[2024-09-22 15:49:23,421][root][INFO] - random seed             : 42
[2024-09-22 15:49:23,421][root][INFO] - train data size         : 24256
[2024-09-22 15:49:23,421][root][INFO] - max epochs              : 5
[2024-09-22 15:49:23,421][root][INFO] - total steps             : 1895
[2024-09-22 15:49:23,421][root][INFO] - warmup steps            : 190
[2024-09-22 15:49:23,422][root][INFO] - batch size              : 64
[2024-09-22 15:49:23,422][root][INFO] - accumulation steps      : 1
[2024-09-22 15:49:23,422][root][INFO] - optimizer               : adamwscale
[2024-09-22 15:49:23,422][root][INFO] - lr_scheduler            : cosine
[2024-09-22 15:49:23,422][root][INFO] - learning rate           : 0.02
[2024-09-22 15:49:23,422][root][INFO] - max length              : 256

[2024-09-22 15:49:23,422][root][INFO] - LoRA Configuration
[2024-09-22 15:49:23,422][root][INFO] - ㄴ r                    : 32
[2024-09-22 15:49:23,422][root][INFO] - ㄴ alpha                : 128
[2024-09-22 15:49:23,422][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 15:49:23,422][root][INFO] - KOMBO Configuration
[2024-09-22 15:49:23,423][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-22 15:49:23,423][root][INFO] - ㄴ reducer              : linear
[2024-09-22 15:49:23,423][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-22 15:49:23,423][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-22 15:49:23,423][root][INFO] - ㄴ do_combination       : False
[2024-09-22 15:49:23,423][root][INFO] - 

[2024-09-22 15:49:23,423][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs
[2024-09-22 15:49:23,423][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs/ckpt
[2024-09-22 15:49:23,423][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs/tb
[2024-09-22 15:49:23,423][root][INFO] - * tb interval           : 75

[2024-09-22 15:49:23,423][root][INFO] - 

[2024-09-22 15:49:23,424][root][INFO] - Start the Training !
[2024-09-22 15:49:23,426][root][INFO] - 
[1/ 5 Epoch]
[2024-09-22 15:50:02,368][root][INFO] - Step: 75/1895  |  Loss: 0.7267  |  Score: 50.85 [%]  |  Seq Length: 256.0
[2024-09-22 15:50:39,601][root][INFO] - Step: 150/1895  |  Loss: 0.7101  |  Score: 52.58 [%]  |  Seq Length: 256.0
[2024-09-22 15:51:17,054][root][INFO] - Step: 225/1895  |  Loss: 0.7036  |  Score: 52.19 [%]  |  Seq Length: 256.0
[2024-09-22 15:51:54,428][root][INFO] - Step: 300/1895  |  Loss: 0.7033  |  Score: 52.02 [%]  |  Seq Length: 256.0
[2024-09-22 15:52:31,670][root][INFO] - Step: 375/1895  |  Loss: 0.7063  |  Score: 51.60 [%]  |  Seq Length: 256.0
[2024-09-22 15:52:33,395][root][INFO] - Step: 379/1895  |  Loss: 0.7048  |  Score: 54.04 [%]  |  Seq Length: 256.0
[2024-09-22 15:52:37,560][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 15:52:37,561][root][INFO] - Score: 52.28 [%]  |  Evaluation Time: 4.16 [s]
[2024-09-22 15:52:41,607][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 15:52:41,607][root][INFO] - Score: 52.93 [%]  |  Evaluation Time: 4.04 [s]
[2024-09-22 15:52:41,609][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 15:52:41,612][root][INFO] - 
[2/ 5 Epoch]
[2024-09-22 15:53:17,353][root][INFO] - Step: 450/1895  |  Loss: 0.7026  |  Score: 52.55 [%]  |  Seq Length: 256.0
[2024-09-22 15:53:19,268][root][INFO] - 

[2024-09-22 15:53:19,268][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 15:53:19,268][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs
[2024-09-22 15:53:19,268][root][INFO] - 

[2024-09-22 15:53:19,268][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 2, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 15:53:54,955][root][INFO] - Step: 525/1895  |  Loss: 0.7020  |  Score: 52.12 [%]  |  Seq Length: 256.0
[2024-09-22 15:54:32,541][root][INFO] - Step: 600/1895  |  Loss: 0.6997  |  Score: 52.29 [%]  |  Seq Length: 256.0
[2024-09-22 15:55:09,910][root][INFO] - Step: 675/1895  |  Loss: 0.6946  |  Score: 54.00 [%]  |  Seq Length: 256.0
[2024-09-22 15:55:23,421][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 15:55:23,421][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 15:55:23,422][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 15:55:23,423][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 15:55:23,423][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 15:55:23,424][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 15:55:23,425][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 15:55:23,425][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 15:55:23,426][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 15:55:23,426][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 15:55:23,427][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 15:55:23,427][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 15:55:23,428][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 15:55:23,428][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 15:55:23,428][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 15:55:23,429][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 15:55:23,429][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 15:55:23,430][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 15:55:23,430][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 15:55:23,430][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 15:55:23,431][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 15:55:23,431][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 15:55:23,432][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 15:55:23,433][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 15:55:23,435][root][INFO] - Trainable params: 1769472 || all params: 126935808 || trainable: 1.39 %
[2024-09-22 15:55:23,440][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-22 15:55:23,547][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-22 15:55:23,549][root][INFO] - Trainable params: 9034752 || all params: 134201088 || trainable: 6.73 %
[2024-09-22 15:55:23,782][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 15:55:26,869][root][INFO] - 

[2024-09-22 15:55:26,869][root][INFO] - ========== Fine-tuning on KorNLI ==========
[2024-09-22 15:55:26,869][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 15:55:26,877][root][INFO] - vocab size              : 51200
[2024-09-22 15:55:26,877][root][INFO] - device                  : gpu
[2024-09-22 15:55:26,877][root][INFO] - random seed             : 42
[2024-09-22 15:55:26,877][root][INFO] - train data size         : 422752
[2024-09-22 15:55:26,877][root][INFO] - max epochs              : 3
[2024-09-22 15:55:26,877][root][INFO] - total steps             : 39633
[2024-09-22 15:55:26,878][root][INFO] - warmup steps            : 3963
[2024-09-22 15:55:26,878][root][INFO] - batch size              : 64
[2024-09-22 15:55:26,878][root][INFO] - accumulation steps      : 2
[2024-09-22 15:55:26,878][root][INFO] - optimizer               : adamwscale
[2024-09-22 15:55:26,878][root][INFO] - lr_scheduler            : cosine
[2024-09-22 15:55:26,878][root][INFO] - learning rate           : 0.01
[2024-09-22 15:55:26,878][root][INFO] - max length              : 256

[2024-09-22 15:55:26,878][root][INFO] - LoRA Configuration
[2024-09-22 15:55:26,878][root][INFO] - ㄴ r                    : 32
[2024-09-22 15:55:26,878][root][INFO] - ㄴ alpha                : 128
[2024-09-22 15:55:26,878][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 15:55:26,878][root][INFO] - KOMBO Configuration
[2024-09-22 15:55:26,879][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-22 15:55:26,879][root][INFO] - ㄴ reducer              : linear
[2024-09-22 15:55:26,879][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-22 15:55:26,879][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-22 15:55:26,879][root][INFO] - ㄴ do_combination       : True
[2024-09-22 15:55:26,879][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-22 15:55:26,879][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-22 15:55:26,879][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-22 15:55:26,879][root][INFO] -   ㄴ add_lora           : True
[2024-09-22 15:55:26,880][root][INFO] -     ㄴ LoRA in KOMBO Configuration
[2024-09-22 15:55:26,880][root][INFO] -     ㄴ r                : 32
[2024-09-22 15:55:26,880][root][INFO] -     ㄴ alpha            : 128
[2024-09-22 15:55:26,880][root][INFO] -     ㄴ dropout          : 0.03

[2024-09-22 15:55:26,880][root][INFO] - 

[2024-09-22 15:55:26,880][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs
[2024-09-22 15:55:26,880][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/ckpt
[2024-09-22 15:55:26,880][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/tb
[2024-09-22 15:55:26,880][root][INFO] - * tb interval           : 400

[2024-09-22 15:55:26,880][root][INFO] - 

[2024-09-22 15:55:26,880][root][INFO] - Start the Training !
[2024-09-22 15:55:26,883][root][INFO] - 
[1/ 3 Epoch]
[2024-09-22 15:55:47,163][root][INFO] - Step: 750/1895  |  Loss: 0.7059  |  Score: 51.60 [%]  |  Seq Length: 256.0
[2024-09-22 15:55:50,879][root][INFO] - Step: 758/1895  |  Loss: 0.6990  |  Score: 48.24 [%]  |  Seq Length: 256.0
[2024-09-22 15:55:55,100][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 15:55:55,100][root][INFO] - Score: 51.73 [%]  |  Evaluation Time: 4.22 [s]
[2024-09-22 15:55:59,283][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 15:55:59,284][root][INFO] - Score: 52.06 [%]  |  Evaluation Time: 4.18 [s]
[2024-09-22 15:55:59,286][root][INFO] - 
[3/ 5 Epoch]
[2024-09-22 15:56:32,601][root][INFO] - Step: 825/1895  |  Loss: 0.6975  |  Score: 52.43 [%]  |  Seq Length: 256.0
[2024-09-22 15:57:08,860][root][INFO] - Step: 900/1895  |  Loss: 0.6956  |  Score: 53.21 [%]  |  Seq Length: 256.0
[2024-09-22 15:57:45,092][root][INFO] - Step: 975/1895  |  Loss: 0.7024  |  Score: 52.38 [%]  |  Seq Length: 256.0
[2024-09-22 15:58:21,566][root][INFO] - Step: 1050/1895  |  Loss: 0.6942  |  Score: 52.90 [%]  |  Seq Length: 256.0
[2024-09-22 15:58:58,929][root][INFO] - Step: 1125/1895  |  Loss: 0.6908  |  Score: 54.83 [%]  |  Seq Length: 256.0
[2024-09-22 15:59:04,631][root][INFO] - Step: 1137/1895  |  Loss: 0.6788  |  Score: 56.47 [%]  |  Seq Length: 256.0
[2024-09-22 15:59:08,832][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 15:59:08,832][root][INFO] - Score: 51.20 [%]  |  Evaluation Time: 4.20 [s]
[2024-09-22 15:59:12,981][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 15:59:12,982][root][INFO] - Score: 52.31 [%]  |  Evaluation Time: 4.15 [s]
[2024-09-22 15:59:12,984][root][INFO] - 
[4/ 5 Epoch]
[2024-09-22 15:59:13,540][root][INFO] - Step: 400/39633  |  Loss: 1.0030  |  Score: 48.87 [%]  |  Seq Length: 256.0
[2024-09-22 15:59:44,787][root][INFO] - Step: 1200/1895  |  Loss: 0.6889  |  Score: 55.08 [%]  |  Seq Length: 256.0
[2024-09-22 16:00:22,158][root][INFO] - Step: 1275/1895  |  Loss: 0.6826  |  Score: 56.90 [%]  |  Seq Length: 256.0
[2024-09-22 16:00:59,531][root][INFO] - Step: 1350/1895  |  Loss: 0.6751  |  Score: 57.63 [%]  |  Seq Length: 256.0
[2024-09-22 16:01:37,157][root][INFO] - Step: 1425/1895  |  Loss: 0.6726  |  Score: 57.63 [%]  |  Seq Length: 256.0
[2024-09-22 16:02:14,692][root][INFO] - Step: 1500/1895  |  Loss: 0.6687  |  Score: 59.04 [%]  |  Seq Length: 256.0
[2024-09-22 16:02:22,381][root][INFO] - Step: 1516/1895  |  Loss: 0.6571  |  Score: 59.64 [%]  |  Seq Length: 256.0
[2024-09-22 16:02:26,577][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 16:02:26,577][root][INFO] - Score: 52.02 [%]  |  Evaluation Time: 4.19 [s]
[2024-09-22 16:02:30,730][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 16:02:30,731][root][INFO] - Score: 52.81 [%]  |  Evaluation Time: 4.15 [s]
[2024-09-22 16:02:30,733][root][INFO] - 
[5/ 5 Epoch]
[2024-09-22 16:02:59,629][root][INFO] - Step: 800/39633  |  Loss: 0.8511  |  Score: 61.86 [%]  |  Seq Length: 256.0
[2024-09-22 16:03:00,604][root][INFO] - Step: 1575/1895  |  Loss: 0.6042  |  Score: 67.35 [%]  |  Seq Length: 256.0
[2024-09-22 16:03:38,077][root][INFO] - Step: 1650/1895  |  Loss: 0.6055  |  Score: 66.58 [%]  |  Seq Length: 256.0
[2024-09-22 16:04:15,733][root][INFO] - Step: 1725/1895  |  Loss: 0.5910  |  Score: 68.12 [%]  |  Seq Length: 256.0
[2024-09-22 16:04:53,177][root][INFO] - Step: 1800/1895  |  Loss: 0.5917  |  Score: 67.65 [%]  |  Seq Length: 256.0
[2024-09-22 16:05:30,564][root][INFO] - Step: 1875/1895  |  Loss: 0.5822  |  Score: 68.71 [%]  |  Seq Length: 256.0
[2024-09-22 16:05:40,259][root][INFO] - Step: 1895/1895  |  Loss: 0.5942  |  Score: 67.24 [%]  |  Seq Length: 256.0
[2024-09-22 16:05:44,472][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 16:05:44,472][root][INFO] - Score: 51.14 [%]  |  Evaluation Time: 4.21 [s]
[2024-09-22 16:05:48,617][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 16:05:48,617][root][INFO] - Score: 50.19 [%]  |  Evaluation Time: 4.14 [s]
[2024-09-22 16:05:48,618][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 16:05:48,618][root][INFO] - - Epoch: 1
[2024-09-22 16:05:48,618][root][INFO] - - DEV score: 52.28 [%]
[2024-09-22 16:05:48,619][root][INFO] - - TEST score: 52.93 [%]
[2024-09-22 16:05:48,620][root][INFO] - Fine-tuning is done!
[2024-09-22 16:06:44,530][root][INFO] - Step: 1200/39633  |  Loss: 0.8159  |  Score: 63.74 [%]  |  Seq Length: 256.0
[2024-09-22 16:09:11,550][root][INFO] - 

[2024-09-22 16:09:11,550][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 16:09:11,551][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.005lr_42rs
[2024-09-22 16:09:11,551][root][INFO] - 

[2024-09-22 16:09:11,551][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'PAWS_X'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.005, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 75, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.005lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.005lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.005lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 16:09:20,008][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 16:09:20,009][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 16:09:20,010][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 16:09:20,010][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 16:09:20,011][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 16:09:20,011][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 16:09:20,012][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 16:09:20,013][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 16:09:20,013][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 16:09:20,013][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 16:09:20,014][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 16:09:20,014][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 16:09:20,015][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 16:09:20,015][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 16:09:20,016][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 16:09:20,016][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 16:09:20,017][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 16:09:20,017][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 16:09:20,018][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 16:09:20,018][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 16:09:20,025][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 16:09:20,026][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 16:09:20,026][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 16:09:20,027][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 16:09:20,030][root][INFO] - Trainable params: 1769472 || all params: 126935040 || trainable: 1.39 %
[2024-09-22 16:09:20,038][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-22 16:09:20,052][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-22 16:09:20,054][root][INFO] - Trainable params: 2445312 || all params: 127610880 || trainable: 1.92 %
[2024-09-22 16:09:20,235][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 16:09:22,163][root][INFO] - 

[2024-09-22 16:09:22,163][root][INFO] - ========== Fine-tuning on PAWS_X ==========
[2024-09-22 16:09:22,163][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 16:09:22,171][root][INFO] - vocab size              : 51200
[2024-09-22 16:09:22,171][root][INFO] - device                  : gpu
[2024-09-22 16:09:22,171][root][INFO] - random seed             : 42
[2024-09-22 16:09:22,171][root][INFO] - train data size         : 24256
[2024-09-22 16:09:22,171][root][INFO] - max epochs              : 5
[2024-09-22 16:09:22,171][root][INFO] - total steps             : 1895
[2024-09-22 16:09:22,172][root][INFO] - warmup steps            : 190
[2024-09-22 16:09:22,172][root][INFO] - batch size              : 64
[2024-09-22 16:09:22,172][root][INFO] - accumulation steps      : 1
[2024-09-22 16:09:22,172][root][INFO] - optimizer               : adamwscale
[2024-09-22 16:09:22,172][root][INFO] - lr_scheduler            : cosine
[2024-09-22 16:09:22,172][root][INFO] - learning rate           : 0.005
[2024-09-22 16:09:22,172][root][INFO] - max length              : 256

[2024-09-22 16:09:22,172][root][INFO] - LoRA Configuration
[2024-09-22 16:09:22,172][root][INFO] - ㄴ r                    : 32
[2024-09-22 16:09:22,172][root][INFO] - ㄴ alpha                : 128
[2024-09-22 16:09:22,172][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 16:09:22,173][root][INFO] - KOMBO Configuration
[2024-09-22 16:09:22,173][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-22 16:09:22,173][root][INFO] - ㄴ reducer              : linear
[2024-09-22 16:09:22,173][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-22 16:09:22,173][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-22 16:09:22,173][root][INFO] - ㄴ do_combination       : False
[2024-09-22 16:09:22,173][root][INFO] - 

[2024-09-22 16:09:22,173][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.005lr_42rs
[2024-09-22 16:09:22,173][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.005lr_42rs/ckpt
[2024-09-22 16:09:22,173][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.005lr_42rs/tb
[2024-09-22 16:09:22,173][root][INFO] - * tb interval           : 75

[2024-09-22 16:09:22,173][root][INFO] - 

[2024-09-22 16:09:22,174][root][INFO] - Start the Training !
[2024-09-22 16:09:22,177][root][INFO] - 
[1/ 5 Epoch]
[2024-09-22 16:10:01,041][root][INFO] - Step: 75/1895  |  Loss: 0.7394  |  Score: 51.12 [%]  |  Seq Length: 256.0
[2024-09-22 16:10:31,280][root][INFO] - Step: 1600/39633  |  Loss: 0.7839  |  Score: 65.71 [%]  |  Seq Length: 256.0
[2024-09-22 16:10:38,713][root][INFO] - Step: 150/1895  |  Loss: 0.6997  |  Score: 53.44 [%]  |  Seq Length: 256.0
[2024-09-22 16:11:16,385][root][INFO] - Step: 225/1895  |  Loss: 0.6975  |  Score: 53.23 [%]  |  Seq Length: 256.0
[2024-09-22 16:11:53,996][root][INFO] - Step: 300/1895  |  Loss: 0.6984  |  Score: 53.15 [%]  |  Seq Length: 256.0
[2024-09-22 16:12:31,695][root][INFO] - Step: 375/1895  |  Loss: 0.6990  |  Score: 53.33 [%]  |  Seq Length: 256.0
[2024-09-22 16:12:33,464][root][INFO] - Step: 379/1895  |  Loss: 0.6853  |  Score: 55.60 [%]  |  Seq Length: 256.0
[2024-09-22 16:12:37,695][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 16:12:37,696][root][INFO] - Score: 52.18 [%]  |  Evaluation Time: 4.23 [s]
[2024-09-22 16:12:41,925][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 16:12:41,925][root][INFO] - Score: 52.80 [%]  |  Evaluation Time: 4.23 [s]
[2024-09-22 16:12:41,926][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 16:12:41,928][root][INFO] - 
[2/ 5 Epoch]
[2024-09-22 16:13:18,089][root][INFO] - Step: 450/1895  |  Loss: 0.7077  |  Score: 51.36 [%]  |  Seq Length: 256.0
[2024-09-22 16:13:55,912][root][INFO] - Step: 525/1895  |  Loss: 0.6992  |  Score: 52.62 [%]  |  Seq Length: 256.0
[2024-09-22 16:14:19,110][root][INFO] - Step: 2000/39633  |  Loss: 0.7745  |  Score: 66.22 [%]  |  Seq Length: 256.0
[2024-09-22 16:14:33,483][root][INFO] - Step: 600/1895  |  Loss: 0.7072  |  Score: 50.94 [%]  |  Seq Length: 256.0
[2024-09-22 16:15:11,142][root][INFO] - Step: 675/1895  |  Loss: 0.6929  |  Score: 53.62 [%]  |  Seq Length: 256.0
[2024-09-22 16:15:48,994][root][INFO] - Step: 750/1895  |  Loss: 0.6965  |  Score: 52.31 [%]  |  Seq Length: 256.0
[2024-09-22 16:15:52,745][root][INFO] - Step: 758/1895  |  Loss: 0.6984  |  Score: 51.11 [%]  |  Seq Length: 256.0
[2024-09-22 16:15:57,130][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 16:15:57,130][root][INFO] - Score: 45.93 [%]  |  Evaluation Time: 4.38 [s]
[2024-09-22 16:16:01,362][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 16:16:01,362][root][INFO] - Score: 47.02 [%]  |  Evaluation Time: 4.23 [s]
[2024-09-22 16:16:01,365][root][INFO] - 
[3/ 5 Epoch]
[2024-09-22 16:16:35,336][root][INFO] - Step: 825/1895  |  Loss: 0.6946  |  Score: 52.75 [%]  |  Seq Length: 256.0
[2024-09-22 16:17:13,124][root][INFO] - Step: 900/1895  |  Loss: 0.6907  |  Score: 53.77 [%]  |  Seq Length: 256.0
[2024-09-22 16:17:50,858][root][INFO] - Step: 975/1895  |  Loss: 0.6992  |  Score: 51.38 [%]  |  Seq Length: 256.0
[2024-09-22 16:18:07,340][root][INFO] - Step: 2400/39633  |  Loss: 0.7525  |  Score: 67.54 [%]  |  Seq Length: 256.0
[2024-09-22 16:18:28,515][root][INFO] - Step: 1050/1895  |  Loss: 0.6930  |  Score: 52.94 [%]  |  Seq Length: 256.0
[2024-09-22 16:19:06,225][root][INFO] - Step: 1125/1895  |  Loss: 0.6910  |  Score: 54.23 [%]  |  Seq Length: 256.0
[2024-09-22 16:19:11,941][root][INFO] - Step: 1137/1895  |  Loss: 0.6867  |  Score: 56.38 [%]  |  Seq Length: 256.0
[2024-09-22 16:19:16,190][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 16:19:16,190][root][INFO] - Score: 54.26 [%]  |  Evaluation Time: 4.25 [s]
[2024-09-22 16:19:20,431][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 16:19:20,431][root][INFO] - Score: 52.86 [%]  |  Evaluation Time: 4.24 [s]
[2024-09-22 16:19:20,433][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 16:19:20,434][root][INFO] - 
[4/ 5 Epoch]
[2024-09-22 16:19:52,369][root][INFO] - Step: 1200/1895  |  Loss: 0.6904  |  Score: 53.60 [%]  |  Seq Length: 256.0
[2024-09-22 16:20:29,955][root][INFO] - Step: 1275/1895  |  Loss: 0.6857  |  Score: 55.94 [%]  |  Seq Length: 256.0
[2024-09-22 16:20:46,576][root][INFO] - 

[2024-09-22 16:20:46,576][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 16:20:46,576][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.01lr_42rs
[2024-09-22 16:20:46,576][root][INFO] - 

[2024-09-22 16:20:46,577][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 16:21:07,782][root][INFO] - Step: 1350/1895  |  Loss: 0.6828  |  Score: 56.21 [%]  |  Seq Length: 256.0
[2024-09-22 16:21:15,059][root][INFO] - 

[2024-09-22 16:21:15,059][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 16:21:15,059][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs
[2024-09-22 16:21:15,059][root][INFO] - 

[2024-09-22 16:21:15,059][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 2, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 16:21:45,620][root][INFO] - Step: 1425/1895  |  Loss: 0.6855  |  Score: 54.92 [%]  |  Seq Length: 256.0
[2024-09-22 16:21:54,805][root][INFO] - Step: 2800/39633  |  Loss: 0.7393  |  Score: 68.11 [%]  |  Seq Length: 256.0
[2024-09-22 16:22:23,352][root][INFO] - Step: 1500/1895  |  Loss: 0.6869  |  Score: 54.77 [%]  |  Seq Length: 256.0
[2024-09-22 16:22:31,115][root][INFO] - Step: 1516/1895  |  Loss: 0.6707  |  Score: 59.18 [%]  |  Seq Length: 256.0
[2024-09-22 16:22:35,368][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 16:22:35,368][root][INFO] - Score: 54.26 [%]  |  Evaluation Time: 4.25 [s]
[2024-09-22 16:22:39,600][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 16:22:39,600][root][INFO] - Score: 53.21 [%]  |  Evaluation Time: 4.23 [s]
[2024-09-22 16:22:39,602][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-22 16:22:39,605][root][INFO] - 
[5/ 5 Epoch]
[2024-09-22 16:23:09,817][root][INFO] - Step: 1575/1895  |  Loss: 0.6809  |  Score: 56.09 [%]  |  Seq Length: 256.0
[2024-09-22 16:23:22,071][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 16:23:22,071][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 16:23:22,072][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 16:23:22,073][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 16:23:22,073][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 16:23:22,074][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 16:23:22,074][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 16:23:22,075][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 16:23:22,075][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 16:23:22,076][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 16:23:22,077][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 16:23:22,077][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 16:23:22,078][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 16:23:22,078][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 16:23:22,079][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 16:23:22,079][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 16:23:22,080][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 16:23:22,081][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 16:23:22,081][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 16:23:22,082][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 16:23:22,083][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 16:23:22,083][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 16:23:22,084][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 16:23:22,084][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 16:23:22,086][root][INFO] - Trainable params: 1769472 || all params: 126935808 || trainable: 1.39 %
[2024-09-22 16:23:22,092][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-22 16:23:22,102][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-22 16:23:22,104][root][INFO] - Trainable params: 2445312 || all params: 127611648 || trainable: 1.92 %
[2024-09-22 16:23:22,333][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 16:23:24,560][root][INFO] - 

[2024-09-22 16:23:24,560][root][INFO] - ========== Fine-tuning on KorNLI ==========
[2024-09-22 16:23:24,560][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 16:23:24,568][root][INFO] - vocab size              : 51200
[2024-09-22 16:23:24,568][root][INFO] - device                  : gpu
[2024-09-22 16:23:24,568][root][INFO] - random seed             : 42
[2024-09-22 16:23:24,569][root][INFO] - train data size         : 422752
[2024-09-22 16:23:24,569][root][INFO] - max epochs              : 3
[2024-09-22 16:23:24,569][root][INFO] - total steps             : 39633
[2024-09-22 16:23:24,569][root][INFO] - warmup steps            : 3963
[2024-09-22 16:23:24,569][root][INFO] - batch size              : 64
[2024-09-22 16:23:24,569][root][INFO] - accumulation steps      : 2
[2024-09-22 16:23:24,569][root][INFO] - optimizer               : adamwscale
[2024-09-22 16:23:24,569][root][INFO] - lr_scheduler            : cosine
[2024-09-22 16:23:24,569][root][INFO] - learning rate           : 0.01
[2024-09-22 16:23:24,569][root][INFO] - max length              : 256

[2024-09-22 16:23:24,569][root][INFO] - LoRA Configuration
[2024-09-22 16:23:24,569][root][INFO] - ㄴ r                    : 32
[2024-09-22 16:23:24,570][root][INFO] - ㄴ alpha                : 128
[2024-09-22 16:23:24,570][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 16:23:24,570][root][INFO] - KOMBO Configuration
[2024-09-22 16:23:24,570][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-22 16:23:24,570][root][INFO] - ㄴ reducer              : linear
[2024-09-22 16:23:24,570][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-22 16:23:24,570][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-22 16:23:24,570][root][INFO] - ㄴ do_combination       : False
[2024-09-22 16:23:24,570][root][INFO] - 

[2024-09-22 16:23:24,570][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs
[2024-09-22 16:23:24,571][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/ckpt
[2024-09-22 16:23:24,571][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/tb
[2024-09-22 16:23:24,571][root][INFO] - * tb interval           : 400

[2024-09-22 16:23:24,571][root][INFO] - 

[2024-09-22 16:23:24,571][root][INFO] - Start the Training !
[2024-09-22 16:23:24,574][root][INFO] - 
[1/ 3 Epoch]
[2024-09-22 16:23:47,661][root][INFO] - Step: 1650/1895  |  Loss: 0.6816  |  Score: 55.88 [%]  |  Seq Length: 256.0
[2024-09-22 16:24:25,289][root][INFO] - Step: 1725/1895  |  Loss: 0.6766  |  Score: 57.04 [%]  |  Seq Length: 256.0
[2024-09-22 16:25:03,060][root][INFO] - Step: 1800/1895  |  Loss: 0.6759  |  Score: 57.46 [%]  |  Seq Length: 256.0
[2024-09-22 16:25:40,505][root][INFO] - Step: 1875/1895  |  Loss: 0.6760  |  Score: 57.42 [%]  |  Seq Length: 256.0
[2024-09-22 16:25:42,030][root][INFO] - Step: 3200/39633  |  Loss: 0.7251  |  Score: 68.80 [%]  |  Seq Length: 256.0
[2024-09-22 16:25:50,172][root][INFO] - Step: 1895/1895  |  Loss: 0.6776  |  Score: 58.18 [%]  |  Seq Length: 256.0
[2024-09-22 16:25:54,401][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 16:25:54,401][root][INFO] - Score: 49.54 [%]  |  Evaluation Time: 4.23 [s]
[2024-09-22 16:25:58,571][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 16:25:58,572][root][INFO] - Score: 52.46 [%]  |  Evaluation Time: 4.17 [s]
[2024-09-22 16:25:58,573][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 16:25:58,573][root][INFO] - - Epoch: 4
[2024-09-22 16:25:58,573][root][INFO] - - DEV score: 54.26 [%]
[2024-09-22 16:25:58,573][root][INFO] - - TEST score: 53.21 [%]
[2024-09-22 16:25:58,574][root][INFO] - Fine-tuning is done!
[2024-09-22 16:26:47,505][root][INFO] - Step: 400/39633  |  Loss: 0.9985  |  Score: 49.27 [%]  |  Seq Length: 256.0
[2024-09-22 16:29:29,251][root][INFO] - Step: 3600/39633  |  Loss: 0.7296  |  Score: 68.59 [%]  |  Seq Length: 256.0
[2024-09-22 16:30:09,835][root][INFO] - Step: 800/39633  |  Loss: 0.8587  |  Score: 61.11 [%]  |  Seq Length: 256.0
[2024-09-22 16:33:16,648][root][INFO] - Step: 4000/39633  |  Loss: 0.7111  |  Score: 69.71 [%]  |  Seq Length: 256.0
[2024-09-22 16:33:31,373][root][INFO] - Step: 1200/39633  |  Loss: 0.8189  |  Score: 63.55 [%]  |  Seq Length: 256.0
[2024-09-22 16:36:53,413][root][INFO] - Step: 1600/39633  |  Loss: 0.7960  |  Score: 64.94 [%]  |  Seq Length: 256.0
[2024-09-22 16:37:02,859][root][INFO] - Step: 4400/39633  |  Loss: 0.7146  |  Score: 69.38 [%]  |  Seq Length: 256.0
[2024-09-22 16:40:15,369][root][INFO] - Step: 2000/39633  |  Loss: 0.7852  |  Score: 65.34 [%]  |  Seq Length: 256.0
[2024-09-22 16:40:49,534][root][INFO] - Step: 4800/39633  |  Loss: 0.6987  |  Score: 70.43 [%]  |  Seq Length: 256.0
[2024-09-22 16:43:37,544][root][INFO] - Step: 2400/39633  |  Loss: 0.7787  |  Score: 65.93 [%]  |  Seq Length: 256.0
[2024-09-22 16:44:36,488][root][INFO] - Step: 5200/39633  |  Loss: 0.6812  |  Score: 71.12 [%]  |  Seq Length: 256.0
[2024-09-22 16:46:59,081][root][INFO] - Step: 2800/39633  |  Loss: 0.7669  |  Score: 66.65 [%]  |  Seq Length: 256.0
[2024-09-22 16:48:22,971][root][INFO] - Step: 5600/39633  |  Loss: 0.6865  |  Score: 71.09 [%]  |  Seq Length: 256.0
[2024-09-22 16:50:20,474][root][INFO] - Step: 3200/39633  |  Loss: 0.7580  |  Score: 66.97 [%]  |  Seq Length: 256.0
[2024-09-22 16:52:10,164][root][INFO] - Step: 6000/39633  |  Loss: 0.6826  |  Score: 71.32 [%]  |  Seq Length: 256.0
[2024-09-22 16:53:42,351][root][INFO] - Step: 3600/39633  |  Loss: 0.7509  |  Score: 67.32 [%]  |  Seq Length: 256.0
[2024-09-22 16:55:57,191][root][INFO] - Step: 6400/39633  |  Loss: 0.6811  |  Score: 71.14 [%]  |  Seq Length: 256.0
[2024-09-22 16:57:04,269][root][INFO] - Step: 4000/39633  |  Loss: 0.7392  |  Score: 68.18 [%]  |  Seq Length: 256.0
[2024-09-22 16:59:44,177][root][INFO] - Step: 6800/39633  |  Loss: 0.6651  |  Score: 72.02 [%]  |  Seq Length: 256.0
[2024-09-22 17:00:26,291][root][INFO] - Step: 4400/39633  |  Loss: 0.7363  |  Score: 68.02 [%]  |  Seq Length: 256.0
[2024-09-22 17:03:31,146][root][INFO] - Step: 7200/39633  |  Loss: 0.6755  |  Score: 71.57 [%]  |  Seq Length: 256.0
[2024-09-22 17:03:47,817][root][INFO] - Step: 4800/39633  |  Loss: 0.7232  |  Score: 68.71 [%]  |  Seq Length: 256.0
[2024-09-22 17:07:09,819][root][INFO] - Step: 5200/39633  |  Loss: 0.7186  |  Score: 69.36 [%]  |  Seq Length: 256.0
[2024-09-22 17:07:18,968][root][INFO] - Step: 7600/39633  |  Loss: 0.6771  |  Score: 71.21 [%]  |  Seq Length: 256.0
[2024-09-22 17:10:31,992][root][INFO] - Step: 5600/39633  |  Loss: 0.7180  |  Score: 69.37 [%]  |  Seq Length: 256.0
[2024-09-22 17:11:06,103][root][INFO] - Step: 8000/39633  |  Loss: 0.6637  |  Score: 72.08 [%]  |  Seq Length: 256.0
[2024-09-22 17:13:54,048][root][INFO] - Step: 6000/39633  |  Loss: 0.6999  |  Score: 70.03 [%]  |  Seq Length: 256.0
[2024-09-22 17:14:53,447][root][INFO] - Step: 8400/39633  |  Loss: 0.6637  |  Score: 72.38 [%]  |  Seq Length: 256.0
[2024-09-22 17:17:15,947][root][INFO] - Step: 6400/39633  |  Loss: 0.7065  |  Score: 69.84 [%]  |  Seq Length: 256.0
[2024-09-22 17:18:40,787][root][INFO] - Step: 8800/39633  |  Loss: 0.6548  |  Score: 72.64 [%]  |  Seq Length: 256.0
[2024-09-22 17:20:37,802][root][INFO] - Step: 6800/39633  |  Loss: 0.6980  |  Score: 70.92 [%]  |  Seq Length: 256.0
[2024-09-22 17:22:27,986][root][INFO] - Step: 9200/39633  |  Loss: 0.6577  |  Score: 72.42 [%]  |  Seq Length: 256.0
[2024-09-22 17:24:00,035][root][INFO] - Step: 7200/39633  |  Loss: 0.6962  |  Score: 70.72 [%]  |  Seq Length: 256.0
[2024-09-22 17:26:14,972][root][INFO] - Step: 9600/39633  |  Loss: 0.6595  |  Score: 72.35 [%]  |  Seq Length: 256.0
[2024-09-22 17:27:22,392][root][INFO] - Step: 7600/39633  |  Loss: 0.6929  |  Score: 70.61 [%]  |  Seq Length: 256.0
[2024-09-22 17:30:01,826][root][INFO] - Step: 10000/39633  |  Loss: 0.6553  |  Score: 72.73 [%]  |  Seq Length: 256.0
[2024-09-22 17:30:43,878][root][INFO] - Step: 8000/39633  |  Loss: 0.6809  |  Score: 70.89 [%]  |  Seq Length: 256.0
[2024-09-22 17:33:48,904][root][INFO] - Step: 10400/39633  |  Loss: 0.6575  |  Score: 72.55 [%]  |  Seq Length: 256.0
[2024-09-22 17:34:06,261][root][INFO] - Step: 8400/39633  |  Loss: 0.6812  |  Score: 70.92 [%]  |  Seq Length: 256.0
[2024-09-22 17:37:28,172][root][INFO] - Step: 8800/39633  |  Loss: 0.6827  |  Score: 71.18 [%]  |  Seq Length: 256.0
[2024-09-22 17:37:36,397][root][INFO] - Step: 10800/39633  |  Loss: 0.6450  |  Score: 73.21 [%]  |  Seq Length: 256.0
[2024-09-22 17:40:50,497][root][INFO] - Step: 9200/39633  |  Loss: 0.6753  |  Score: 71.30 [%]  |  Seq Length: 256.0
[2024-09-22 17:41:23,957][root][INFO] - Step: 11200/39633  |  Loss: 0.6566  |  Score: 72.38 [%]  |  Seq Length: 256.0
[2024-09-22 17:44:12,638][root][INFO] - Step: 9600/39633  |  Loss: 0.6735  |  Score: 71.40 [%]  |  Seq Length: 256.0
[2024-09-22 17:45:11,428][root][INFO] - Step: 11600/39633  |  Loss: 0.6418  |  Score: 73.14 [%]  |  Seq Length: 256.0
[2024-09-22 17:47:34,520][root][INFO] - Step: 10000/39633  |  Loss: 0.6700  |  Score: 72.05 [%]  |  Seq Length: 256.0
[2024-09-22 17:48:59,462][root][INFO] - Step: 12000/39633  |  Loss: 0.6417  |  Score: 73.12 [%]  |  Seq Length: 256.0
[2024-09-22 17:50:56,931][root][INFO] - Step: 10400/39633  |  Loss: 0.6704  |  Score: 71.99 [%]  |  Seq Length: 256.0
[2024-09-22 17:52:46,848][root][INFO] - Step: 12400/39633  |  Loss: 0.6384  |  Score: 73.40 [%]  |  Seq Length: 256.0
[2024-09-22 17:54:18,531][root][INFO] - Step: 10800/39633  |  Loss: 0.6630  |  Score: 72.18 [%]  |  Seq Length: 256.0
[2024-09-22 17:56:33,385][root][INFO] - Step: 12800/39633  |  Loss: 0.6356  |  Score: 73.65 [%]  |  Seq Length: 256.0
[2024-09-22 17:57:40,736][root][INFO] - Step: 11200/39633  |  Loss: 0.6535  |  Score: 72.66 [%]  |  Seq Length: 256.0
[2024-09-22 18:00:19,700][root][INFO] - Step: 13200/39633  |  Loss: 0.6312  |  Score: 73.93 [%]  |  Seq Length: 256.0
[2024-09-22 18:00:25,958][root][INFO] - Step: 13211/39633  |  Loss: 0.6232  |  Score: 74.86 [%]  |  Seq Length: 256.0
[2024-09-22 18:00:34,437][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 18:00:34,437][root][INFO] - Score: 71.03 [%]  |  Evaluation Time: 8.48 [s]
[2024-09-22 18:00:50,557][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 18:00:50,557][root][INFO] - Score: 71.30 [%]  |  Evaluation Time: 16.12 [s]
[2024-09-22 18:00:50,558][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 18:00:50,560][root][INFO] - 
[2/ 3 Epoch]
[2024-09-22 18:01:02,785][root][INFO] - Step: 11600/39633  |  Loss: 0.6545  |  Score: 72.62 [%]  |  Seq Length: 256.0
[2024-09-22 18:04:24,943][root][INFO] - Step: 12000/39633  |  Loss: 0.6522  |  Score: 72.85 [%]  |  Seq Length: 256.0
[2024-09-22 18:04:31,371][root][INFO] - Step: 13600/39633  |  Loss: 0.6204  |  Score: 74.39 [%]  |  Seq Length: 256.0
[2024-09-22 18:07:47,671][root][INFO] - Step: 12400/39633  |  Loss: 0.6580  |  Score: 72.39 [%]  |  Seq Length: 256.0
[2024-09-22 18:08:18,955][root][INFO] - Step: 14000/39633  |  Loss: 0.6192  |  Score: 74.40 [%]  |  Seq Length: 256.0
[2024-09-22 18:11:09,647][root][INFO] - Step: 12800/39633  |  Loss: 0.6514  |  Score: 72.55 [%]  |  Seq Length: 256.0
[2024-09-22 18:12:05,520][root][INFO] - Step: 14400/39633  |  Loss: 0.6164  |  Score: 74.43 [%]  |  Seq Length: 256.0
[2024-09-22 18:14:32,119][root][INFO] - Step: 13200/39633  |  Loss: 0.6463  |  Score: 73.15 [%]  |  Seq Length: 256.0
[2024-09-22 18:14:37,629][root][INFO] - Step: 13211/39633  |  Loss: 0.6218  |  Score: 74.67 [%]  |  Seq Length: 256.0
[2024-09-22 18:14:45,548][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 18:14:45,548][root][INFO] - Score: 69.90 [%]  |  Evaluation Time: 7.92 [s]
[2024-09-22 18:15:00,291][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 18:15:00,291][root][INFO] - Score: 69.82 [%]  |  Evaluation Time: 14.74 [s]
[2024-09-22 18:15:00,292][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 18:15:00,293][root][INFO] - 
[2/ 3 Epoch]
[2024-09-22 18:15:52,449][root][INFO] - Step: 14800/39633  |  Loss: 0.6169  |  Score: 74.51 [%]  |  Seq Length: 256.0
[2024-09-22 18:18:17,943][root][INFO] - Step: 13600/39633  |  Loss: 0.6317  |  Score: 73.77 [%]  |  Seq Length: 256.0
[2024-09-22 18:19:39,479][root][INFO] - Step: 15200/39633  |  Loss: 0.6112  |  Score: 74.66 [%]  |  Seq Length: 256.0
[2024-09-22 18:21:41,045][root][INFO] - Step: 14000/39633  |  Loss: 0.6289  |  Score: 74.07 [%]  |  Seq Length: 256.0
[2024-09-22 18:23:27,066][root][INFO] - Step: 15600/39633  |  Loss: 0.5999  |  Score: 75.54 [%]  |  Seq Length: 256.0
[2024-09-22 18:25:03,943][root][INFO] - Step: 14400/39633  |  Loss: 0.6323  |  Score: 73.41 [%]  |  Seq Length: 256.0
[2024-09-22 18:27:14,298][root][INFO] - Step: 16000/39633  |  Loss: 0.6118  |  Score: 74.64 [%]  |  Seq Length: 256.0
[2024-09-22 18:28:24,676][root][INFO] - Step: 14800/39633  |  Loss: 0.6209  |  Score: 74.44 [%]  |  Seq Length: 256.0
[2024-09-22 18:30:58,735][root][INFO] - Step: 16400/39633  |  Loss: 0.6133  |  Score: 74.77 [%]  |  Seq Length: 256.0
[2024-09-22 18:31:45,695][root][INFO] - Step: 15200/39633  |  Loss: 0.6257  |  Score: 73.75 [%]  |  Seq Length: 256.0
[2024-09-22 18:34:45,853][root][INFO] - Step: 16800/39633  |  Loss: 0.6096  |  Score: 74.85 [%]  |  Seq Length: 256.0
[2024-09-22 18:35:05,883][root][INFO] - Step: 15600/39633  |  Loss: 0.6267  |  Score: 74.05 [%]  |  Seq Length: 256.0
[2024-09-22 18:38:27,853][root][INFO] - Step: 16000/39633  |  Loss: 0.6267  |  Score: 74.09 [%]  |  Seq Length: 256.0
[2024-09-22 18:38:31,484][root][INFO] - Step: 17200/39633  |  Loss: 0.5998  |  Score: 75.07 [%]  |  Seq Length: 256.0
[2024-09-22 18:41:49,657][root][INFO] - Step: 16400/39633  |  Loss: 0.6192  |  Score: 74.20 [%]  |  Seq Length: 256.0
[2024-09-22 18:42:16,302][root][INFO] - Step: 17600/39633  |  Loss: 0.6056  |  Score: 75.11 [%]  |  Seq Length: 256.0
[2024-09-22 18:45:11,055][root][INFO] - Step: 16800/39633  |  Loss: 0.6149  |  Score: 74.52 [%]  |  Seq Length: 256.0
[2024-09-22 18:46:03,419][root][INFO] - Step: 18000/39633  |  Loss: 0.5999  |  Score: 75.48 [%]  |  Seq Length: 256.0
[2024-09-22 18:48:29,451][root][INFO] - Step: 17200/39633  |  Loss: 0.6236  |  Score: 74.21 [%]  |  Seq Length: 256.0
[2024-09-22 18:49:50,781][root][INFO] - Step: 18400/39633  |  Loss: 0.6014  |  Score: 75.26 [%]  |  Seq Length: 256.0
[2024-09-22 18:51:49,947][root][INFO] - Step: 17600/39633  |  Loss: 0.6152  |  Score: 74.71 [%]  |  Seq Length: 256.0
[2024-09-22 18:53:37,864][root][INFO] - Step: 18800/39633  |  Loss: 0.6036  |  Score: 75.10 [%]  |  Seq Length: 256.0
[2024-09-22 18:55:11,546][root][INFO] - Step: 18000/39633  |  Loss: 0.6089  |  Score: 74.93 [%]  |  Seq Length: 256.0
[2024-09-22 18:57:22,996][root][INFO] - Step: 19200/39633  |  Loss: 0.6054  |  Score: 74.82 [%]  |  Seq Length: 256.0
[2024-09-22 18:58:32,300][root][INFO] - Step: 18400/39633  |  Loss: 0.6107  |  Score: 74.57 [%]  |  Seq Length: 256.0
[2024-09-22 19:01:09,741][root][INFO] - Step: 19600/39633  |  Loss: 0.5957  |  Score: 75.64 [%]  |  Seq Length: 256.0
[2024-09-22 19:01:54,046][root][INFO] - Step: 18800/39633  |  Loss: 0.6154  |  Score: 74.75 [%]  |  Seq Length: 256.0
[2024-09-22 19:04:55,370][root][INFO] - Step: 20000/39633  |  Loss: 0.6022  |  Score: 75.20 [%]  |  Seq Length: 256.0
[2024-09-22 19:05:16,160][root][INFO] - Step: 19200/39633  |  Loss: 0.6138  |  Score: 74.58 [%]  |  Seq Length: 256.0
[2024-09-22 19:08:38,258][root][INFO] - Step: 19600/39633  |  Loss: 0.6124  |  Score: 74.60 [%]  |  Seq Length: 256.0
[2024-09-22 19:08:41,897][root][INFO] - Step: 20400/39633  |  Loss: 0.5957  |  Score: 75.46 [%]  |  Seq Length: 256.0
[2024-09-22 19:12:00,144][root][INFO] - Step: 20000/39633  |  Loss: 0.6081  |  Score: 75.08 [%]  |  Seq Length: 256.0
[2024-09-22 19:12:28,725][root][INFO] - Step: 20800/39633  |  Loss: 0.5994  |  Score: 75.52 [%]  |  Seq Length: 256.0
[2024-09-22 19:15:21,300][root][INFO] - Step: 20400/39633  |  Loss: 0.6060  |  Score: 74.85 [%]  |  Seq Length: 256.0
[2024-09-22 19:16:15,850][root][INFO] - Step: 21200/39633  |  Loss: 0.5915  |  Score: 75.74 [%]  |  Seq Length: 256.0
[2024-09-22 19:18:42,499][root][INFO] - Step: 20800/39633  |  Loss: 0.5926  |  Score: 75.73 [%]  |  Seq Length: 256.0
[2024-09-22 19:20:01,821][root][INFO] - Step: 21600/39633  |  Loss: 0.5859  |  Score: 76.11 [%]  |  Seq Length: 256.0
[2024-09-22 19:22:05,001][root][INFO] - Step: 21200/39633  |  Loss: 0.5983  |  Score: 75.54 [%]  |  Seq Length: 256.0
[2024-09-22 19:23:49,067][root][INFO] - Step: 22000/39633  |  Loss: 0.5892  |  Score: 75.95 [%]  |  Seq Length: 256.0
[2024-09-22 19:25:27,420][root][INFO] - Step: 21600/39633  |  Loss: 0.5995  |  Score: 75.31 [%]  |  Seq Length: 256.0
[2024-09-22 19:27:35,349][root][INFO] - Step: 22400/39633  |  Loss: 0.5869  |  Score: 76.07 [%]  |  Seq Length: 256.0
[2024-09-22 19:28:48,633][root][INFO] - Step: 22000/39633  |  Loss: 0.5994  |  Score: 75.29 [%]  |  Seq Length: 256.0
[2024-09-22 19:31:20,461][root][INFO] - Step: 22800/39633  |  Loss: 0.5868  |  Score: 75.76 [%]  |  Seq Length: 256.0
[2024-09-22 19:32:10,682][root][INFO] - Step: 22400/39633  |  Loss: 0.5928  |  Score: 75.51 [%]  |  Seq Length: 256.0
[2024-09-22 19:35:07,455][root][INFO] - Step: 23200/39633  |  Loss: 0.5882  |  Score: 75.78 [%]  |  Seq Length: 256.0
[2024-09-22 19:35:32,615][root][INFO] - Step: 22800/39633  |  Loss: 0.5936  |  Score: 75.64 [%]  |  Seq Length: 256.0
[2024-09-22 19:38:54,950][root][INFO] - Step: 23200/39633  |  Loss: 0.6023  |  Score: 75.14 [%]  |  Seq Length: 256.0
[2024-09-22 19:38:55,500][root][INFO] - Step: 23600/39633  |  Loss: 0.5751  |  Score: 76.63 [%]  |  Seq Length: 256.0
[2024-09-22 19:42:16,061][root][INFO] - Step: 23600/39633  |  Loss: 0.5814  |  Score: 76.21 [%]  |  Seq Length: 256.0
[2024-09-22 19:42:40,634][root][INFO] - Step: 24000/39633  |  Loss: 0.5742  |  Score: 76.80 [%]  |  Seq Length: 256.0
[2024-09-22 19:45:38,204][root][INFO] - Step: 24000/39633  |  Loss: 0.5923  |  Score: 75.77 [%]  |  Seq Length: 256.0
[2024-09-22 19:46:28,766][root][INFO] - Step: 24400/39633  |  Loss: 0.5830  |  Score: 76.21 [%]  |  Seq Length: 256.0
[2024-09-22 19:48:57,120][root][INFO] - Step: 24400/39633  |  Loss: 0.5863  |  Score: 75.73 [%]  |  Seq Length: 256.0
[2024-09-22 19:50:13,389][root][INFO] - Step: 24800/39633  |  Loss: 0.5794  |  Score: 76.42 [%]  |  Seq Length: 256.0
[2024-09-22 19:52:19,728][root][INFO] - Step: 24800/39633  |  Loss: 0.5842  |  Score: 76.16 [%]  |  Seq Length: 256.0
[2024-09-22 19:54:01,025][root][INFO] - Step: 25200/39633  |  Loss: 0.5759  |  Score: 76.57 [%]  |  Seq Length: 256.0
[2024-09-22 19:55:37,525][root][INFO] - Step: 25200/39633  |  Loss: 0.5854  |  Score: 75.94 [%]  |  Seq Length: 256.0
[2024-09-22 19:57:49,174][root][INFO] - Step: 25600/39633  |  Loss: 0.5793  |  Score: 76.24 [%]  |  Seq Length: 256.0
[2024-09-22 19:58:54,528][root][INFO] - Step: 25600/39633  |  Loss: 0.5835  |  Score: 76.09 [%]  |  Seq Length: 256.0
[2024-09-22 20:01:32,566][root][INFO] - Step: 26000/39633  |  Loss: 0.5719  |  Score: 76.54 [%]  |  Seq Length: 256.0
[2024-09-22 20:02:17,725][root][INFO] - Step: 26000/39633  |  Loss: 0.5761  |  Score: 76.29 [%]  |  Seq Length: 256.0
[2024-09-22 20:05:20,251][root][INFO] - Step: 26400/39633  |  Loss: 0.5798  |  Score: 76.29 [%]  |  Seq Length: 256.0
[2024-09-22 20:05:32,622][root][INFO] - Step: 26422/39633  |  Loss: 0.5619  |  Score: 76.61 [%]  |  Seq Length: 256.0
[2024-09-22 20:05:40,294][root][INFO] - Step: 26400/39633  |  Loss: 0.5710  |  Score: 76.62 [%]  |  Seq Length: 256.0
[2024-09-22 20:05:41,218][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 20:05:41,218][root][INFO] - Score: 73.59 [%]  |  Evaluation Time: 8.59 [s]
[2024-09-22 20:05:51,573][root][INFO] - Step: 26422/39633  |  Loss: 0.5871  |  Score: 76.68 [%]  |  Seq Length: 256.0
[2024-09-22 20:05:57,326][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 20:05:57,327][root][INFO] - Score: 74.06 [%]  |  Evaluation Time: 16.11 [s]
[2024-09-22 20:05:57,327][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 20:05:57,329][root][INFO] - 
[3/ 3 Epoch]
[2024-09-22 20:05:59,412][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 20:05:59,412][root][INFO] - Score: 74.52 [%]  |  Evaluation Time: 7.84 [s]
[2024-09-22 20:06:14,011][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 20:06:14,011][root][INFO] - Score: 73.52 [%]  |  Evaluation Time: 14.60 [s]
[2024-09-22 20:06:14,012][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 20:06:14,014][root][INFO] - 
[3/ 3 Epoch]
[2024-09-22 20:09:24,561][root][INFO] - Step: 26800/39633  |  Loss: 0.5480  |  Score: 77.80 [%]  |  Seq Length: 256.0
[2024-09-22 20:09:28,893][root][INFO] - Step: 26800/39633  |  Loss: 0.5460  |  Score: 77.62 [%]  |  Seq Length: 256.0
[2024-09-22 20:12:45,986][root][INFO] - Step: 27200/39633  |  Loss: 0.5499  |  Score: 77.70 [%]  |  Seq Length: 256.0
[2024-09-22 20:13:17,551][root][INFO] - Step: 27200/39633  |  Loss: 0.5413  |  Score: 77.80 [%]  |  Seq Length: 256.0
[2024-09-22 20:16:08,504][root][INFO] - Step: 27600/39633  |  Loss: 0.5551  |  Score: 77.66 [%]  |  Seq Length: 256.0
[2024-09-22 20:17:01,251][root][INFO] - Step: 27600/39633  |  Loss: 0.5451  |  Score: 78.18 [%]  |  Seq Length: 256.0
[2024-09-22 20:19:29,478][root][INFO] - Step: 28000/39633  |  Loss: 0.5502  |  Score: 77.56 [%]  |  Seq Length: 256.0
[2024-09-22 20:20:48,234][root][INFO] - Step: 28000/39633  |  Loss: 0.5452  |  Score: 77.93 [%]  |  Seq Length: 256.0
[2024-09-22 20:22:48,793][root][INFO] - Step: 28400/39633  |  Loss: 0.5426  |  Score: 78.06 [%]  |  Seq Length: 256.0
[2024-09-22 20:24:37,990][root][INFO] - Step: 28400/39633  |  Loss: 0.5450  |  Score: 77.64 [%]  |  Seq Length: 256.0
[2024-09-22 20:26:09,235][root][INFO] - Step: 28800/39633  |  Loss: 0.5443  |  Score: 77.91 [%]  |  Seq Length: 256.0
[2024-09-22 20:28:27,061][root][INFO] - Step: 28800/39633  |  Loss: 0.5431  |  Score: 77.57 [%]  |  Seq Length: 256.0
[2024-09-22 20:29:29,489][root][INFO] - Step: 29200/39633  |  Loss: 0.5514  |  Score: 77.56 [%]  |  Seq Length: 256.0
[2024-09-22 20:32:13,341][root][INFO] - Step: 29200/39633  |  Loss: 0.5378  |  Score: 78.36 [%]  |  Seq Length: 256.0
[2024-09-22 20:32:52,132][root][INFO] - Step: 29600/39633  |  Loss: 0.5542  |  Score: 77.63 [%]  |  Seq Length: 256.0
[2024-09-22 20:36:01,205][root][INFO] - Step: 29600/39633  |  Loss: 0.5407  |  Score: 78.03 [%]  |  Seq Length: 256.0
[2024-09-22 20:36:13,546][root][INFO] - Step: 30000/39633  |  Loss: 0.5475  |  Score: 77.62 [%]  |  Seq Length: 256.0
[2024-09-22 20:39:35,661][root][INFO] - Step: 30400/39633  |  Loss: 0.5522  |  Score: 77.31 [%]  |  Seq Length: 256.0
[2024-09-22 20:39:49,221][root][INFO] - Step: 30000/39633  |  Loss: 0.5431  |  Score: 78.19 [%]  |  Seq Length: 256.0
[2024-09-22 20:42:57,575][root][INFO] - Step: 30800/39633  |  Loss: 0.5369  |  Score: 78.21 [%]  |  Seq Length: 256.0
[2024-09-22 20:43:37,545][root][INFO] - Step: 30400/39633  |  Loss: 0.5438  |  Score: 78.28 [%]  |  Seq Length: 256.0
[2024-09-22 20:46:18,630][root][INFO] - Step: 31200/39633  |  Loss: 0.5396  |  Score: 78.06 [%]  |  Seq Length: 256.0
[2024-09-22 20:47:24,136][root][INFO] - Step: 30800/39633  |  Loss: 0.5360  |  Score: 78.19 [%]  |  Seq Length: 256.0
[2024-09-22 20:49:41,038][root][INFO] - Step: 31600/39633  |  Loss: 0.5409  |  Score: 77.92 [%]  |  Seq Length: 256.0
[2024-09-22 20:51:12,589][root][INFO] - Step: 31200/39633  |  Loss: 0.5341  |  Score: 78.59 [%]  |  Seq Length: 256.0
[2024-09-22 20:53:00,270][root][INFO] - Step: 32000/39633  |  Loss: 0.5484  |  Score: 77.89 [%]  |  Seq Length: 256.0
[2024-09-22 20:55:00,666][root][INFO] - Step: 31600/39633  |  Loss: 0.5412  |  Score: 78.06 [%]  |  Seq Length: 256.0
[2024-09-22 20:56:22,117][root][INFO] - Step: 32400/39633  |  Loss: 0.5449  |  Score: 77.77 [%]  |  Seq Length: 256.0
[2024-09-22 20:58:44,175][root][INFO] - Step: 32000/39633  |  Loss: 0.5336  |  Score: 78.70 [%]  |  Seq Length: 256.0
[2024-09-22 20:59:44,906][root][INFO] - Step: 32800/39633  |  Loss: 0.5362  |  Score: 78.29 [%]  |  Seq Length: 256.0
[2024-09-22 21:02:33,386][root][INFO] - Step: 32400/39633  |  Loss: 0.5323  |  Score: 78.34 [%]  |  Seq Length: 256.0
[2024-09-22 21:03:07,056][root][INFO] - Step: 33200/39633  |  Loss: 0.5416  |  Score: 78.08 [%]  |  Seq Length: 256.0
[2024-09-22 21:06:22,028][root][INFO] - Step: 32800/39633  |  Loss: 0.5348  |  Score: 78.63 [%]  |  Seq Length: 256.0
[2024-09-22 21:06:27,101][root][INFO] - Step: 33600/39633  |  Loss: 0.5345  |  Score: 78.29 [%]  |  Seq Length: 256.0
[2024-09-22 21:09:50,445][root][INFO] - Step: 34000/39633  |  Loss: 0.5436  |  Score: 78.12 [%]  |  Seq Length: 256.0
[2024-09-22 21:10:10,151][root][INFO] - Step: 33200/39633  |  Loss: 0.5372  |  Score: 78.32 [%]  |  Seq Length: 256.0
[2024-09-22 21:13:13,495][root][INFO] - Step: 34400/39633  |  Loss: 0.5396  |  Score: 78.12 [%]  |  Seq Length: 256.0
[2024-09-22 21:13:58,094][root][INFO] - Step: 33600/39633  |  Loss: 0.5315  |  Score: 78.27 [%]  |  Seq Length: 256.0
[2024-09-22 21:16:36,429][root][INFO] - Step: 34800/39633  |  Loss: 0.5441  |  Score: 77.69 [%]  |  Seq Length: 256.0
[2024-09-22 21:17:46,759][root][INFO] - Step: 34000/39633  |  Loss: 0.5338  |  Score: 78.21 [%]  |  Seq Length: 256.0
[2024-09-22 21:19:57,845][root][INFO] - Step: 35200/39633  |  Loss: 0.5331  |  Score: 78.52 [%]  |  Seq Length: 256.0
[2024-09-22 21:21:35,321][root][INFO] - Step: 34400/39633  |  Loss: 0.5326  |  Score: 78.53 [%]  |  Seq Length: 256.0
[2024-09-22 21:23:17,502][root][INFO] - Step: 35600/39633  |  Loss: 0.5291  |  Score: 78.66 [%]  |  Seq Length: 256.0
[2024-09-22 21:25:22,902][root][INFO] - Step: 34800/39633  |  Loss: 0.5220  |  Score: 78.82 [%]  |  Seq Length: 256.0
[2024-09-22 21:26:40,033][root][INFO] - Step: 36000/39633  |  Loss: 0.5382  |  Score: 78.16 [%]  |  Seq Length: 256.0
[2024-09-22 21:29:11,733][root][INFO] - Step: 35200/39633  |  Loss: 0.5315  |  Score: 78.71 [%]  |  Seq Length: 256.0
[2024-09-22 21:30:01,616][root][INFO] - Step: 36400/39633  |  Loss: 0.5320  |  Score: 78.41 [%]  |  Seq Length: 256.0
[2024-09-22 21:32:59,446][root][INFO] - Step: 35600/39633  |  Loss: 0.5372  |  Score: 78.34 [%]  |  Seq Length: 256.0
[2024-09-22 21:33:21,139][root][INFO] - Step: 36800/39633  |  Loss: 0.5315  |  Score: 78.53 [%]  |  Seq Length: 256.0
[2024-09-22 21:36:39,579][root][INFO] - Step: 37200/39633  |  Loss: 0.5365  |  Score: 78.12 [%]  |  Seq Length: 256.0
[2024-09-22 21:36:46,873][root][INFO] - Step: 36000/39633  |  Loss: 0.5272  |  Score: 78.90 [%]  |  Seq Length: 256.0
[2024-09-22 21:40:01,230][root][INFO] - Step: 37600/39633  |  Loss: 0.5383  |  Score: 78.09 [%]  |  Seq Length: 256.0
[2024-09-22 21:40:34,816][root][INFO] - Step: 36400/39633  |  Loss: 0.5293  |  Score: 78.70 [%]  |  Seq Length: 256.0
[2024-09-22 21:43:19,569][root][INFO] - Step: 38000/39633  |  Loss: 0.5331  |  Score: 78.41 [%]  |  Seq Length: 256.0
[2024-09-22 21:44:23,391][root][INFO] - Step: 36800/39633  |  Loss: 0.5298  |  Score: 78.58 [%]  |  Seq Length: 256.0
[2024-09-22 21:46:42,657][root][INFO] - Step: 38400/39633  |  Loss: 0.5284  |  Score: 78.71 [%]  |  Seq Length: 256.0
[2024-09-22 21:48:08,432][root][INFO] - Step: 37200/39633  |  Loss: 0.5323  |  Score: 78.52 [%]  |  Seq Length: 256.0
[2024-09-22 21:50:04,563][root][INFO] - Step: 38800/39633  |  Loss: 0.5421  |  Score: 77.96 [%]  |  Seq Length: 256.0
[2024-09-22 21:51:54,898][root][INFO] - Step: 37600/39633  |  Loss: 0.5239  |  Score: 79.04 [%]  |  Seq Length: 256.0
[2024-09-22 21:53:28,489][root][INFO] - Step: 39200/39633  |  Loss: 0.5327  |  Score: 78.41 [%]  |  Seq Length: 256.0
[2024-09-22 21:55:38,775][root][INFO] - Step: 38000/39633  |  Loss: 0.5271  |  Score: 78.71 [%]  |  Seq Length: 256.0
[2024-09-22 21:56:51,723][root][INFO] - Step: 39600/39633  |  Loss: 0.5312  |  Score: 78.37 [%]  |  Seq Length: 256.0
[2024-09-22 21:57:08,566][root][INFO] - Step: 39633/39633  |  Loss: 0.5499  |  Score: 77.98 [%]  |  Seq Length: 256.0
[2024-09-22 21:57:16,496][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 21:57:16,496][root][INFO] - Score: 74.51 [%]  |  Evaluation Time: 7.93 [s]
[2024-09-22 21:57:31,235][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 21:57:31,235][root][INFO] - Score: 74.40 [%]  |  Evaluation Time: 14.74 [s]
[2024-09-22 21:57:31,237][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 21:57:31,237][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 21:57:31,237][root][INFO] - - Epoch: 3
[2024-09-22 21:57:31,237][root][INFO] - - DEV score: 74.51 [%]
[2024-09-22 21:57:31,237][root][INFO] - - TEST score: 74.40 [%]
[2024-09-22 21:57:31,238][root][INFO] - Fine-tuning is done!
[2024-09-22 21:59:27,543][root][INFO] - Step: 38400/39633  |  Loss: 0.5265  |  Score: 78.70 [%]  |  Seq Length: 256.0
[2024-09-22 22:03:19,198][root][INFO] - Step: 38800/39633  |  Loss: 0.5283  |  Score: 78.48 [%]  |  Seq Length: 256.0
[2024-09-22 22:07:08,080][root][INFO] - Step: 39200/39633  |  Loss: 0.5303  |  Score: 78.62 [%]  |  Seq Length: 256.0
[2024-09-22 22:10:51,123][root][INFO] - Step: 39600/39633  |  Loss: 0.5264  |  Score: 78.84 [%]  |  Seq Length: 256.0
[2024-09-22 22:11:10,111][root][INFO] - Step: 39633/39633  |  Loss: 0.5382  |  Score: 78.05 [%]  |  Seq Length: 256.0
[2024-09-22 22:11:18,965][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 22:11:18,965][root][INFO] - Score: 74.61 [%]  |  Evaluation Time: 8.85 [s]
[2024-09-22 22:11:35,306][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 22:11:35,306][root][INFO] - Score: 75.03 [%]  |  Evaluation Time: 16.34 [s]
[2024-09-22 22:11:35,307][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 22:11:35,307][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 22:11:35,307][root][INFO] - - Epoch: 3
[2024-09-22 22:11:35,307][root][INFO] - - DEV score: 74.61 [%]
[2024-09-22 22:11:35,307][root][INFO] - - TEST score: 75.03 [%]
[2024-09-22 22:11:35,308][root][INFO] - Fine-tuning is done!
[2024-09-22 22:46:08,006][root][INFO] - 

[2024-09-22 22:46:08,006][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 22:46:08,007][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-22 22:46:08,007][root][INFO] - 

[2024-09-22 22:46:08,007][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 22:46:12,387][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 22:46:16,638][root][INFO] - 

[2024-09-22 22:46:16,638][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-22 22:46:16,638][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 22:46:16,646][root][INFO] - vocab size              : 51200
[2024-09-22 22:46:16,646][root][INFO] - device                  : gpu
[2024-09-22 22:46:16,646][root][INFO] - random seed             : 42
[2024-09-22 22:46:16,646][root][INFO] - train data size         : 4416
[2024-09-22 22:46:16,646][root][INFO] - max epochs              : 15
[2024-09-22 22:46:16,646][root][INFO] - total steps             : 1035
[2024-09-22 22:46:16,646][root][INFO] - warmup steps            : 104
[2024-09-22 22:46:16,647][root][INFO] - batch size              : 64
[2024-09-22 22:46:16,647][root][INFO] - accumulation steps      : 1
[2024-09-22 22:46:16,647][root][INFO] - optimizer               : adamwscale
[2024-09-22 22:46:16,647][root][INFO] - lr_scheduler            : cosine
[2024-09-22 22:46:16,647][root][INFO] - learning rate           : 0.01
[2024-09-22 22:46:16,647][root][INFO] - max length              : 256

[2024-09-22 22:46:16,647][root][INFO] - 

[2024-09-22 22:46:16,647][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-22 22:46:16,647][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-22 22:46:16,647][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb
[2024-09-22 22:46:16,647][root][INFO] - * tb interval   : 15

[2024-09-22 22:46:16,647][root][INFO] - 

[2024-09-22 22:46:16,648][root][INFO] - Start the Training !
[2024-09-22 22:46:16,650][root][INFO] - 
[1/ 15 Epoch]
[2024-09-22 22:46:35,893][root][INFO] - 

[2024-09-22 22:46:35,893][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 22:46:35,893][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-22 22:46:35,894][root][INFO] - 

[2024-09-22 22:46:35,894][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 22:46:40,420][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 22:46:40,421][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 22:46:40,422][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 22:46:40,422][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 22:46:40,422][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 22:46:40,423][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 22:46:40,423][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 22:46:40,424][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 22:46:40,424][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 22:46:40,425][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 22:46:40,425][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 22:46:40,426][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 22:46:40,426][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 22:46:40,426][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 22:46:40,427][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 22:46:40,427][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 22:46:40,428][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 22:46:40,428][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 22:46:40,429][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 22:46:40,429][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 22:46:40,429][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 22:46:40,430][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 22:46:40,430][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 22:46:40,431][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 22:46:40,432][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-22 22:46:40,871][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 22:46:44,794][root][INFO] - 

[2024-09-22 22:46:44,794][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-22 22:46:44,794][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 22:46:44,803][root][INFO] - vocab size              : 51200
[2024-09-22 22:46:44,804][root][INFO] - device                  : gpu
[2024-09-22 22:46:44,804][root][INFO] - random seed             : 42
[2024-09-22 22:46:44,804][root][INFO] - train data size         : 4416
[2024-09-22 22:46:44,804][root][INFO] - max epochs              : 15
[2024-09-22 22:46:44,804][root][INFO] - total steps             : 1035
[2024-09-22 22:46:44,804][root][INFO] - warmup steps            : 104
[2024-09-22 22:46:44,804][root][INFO] - batch size              : 64
[2024-09-22 22:46:44,804][root][INFO] - accumulation steps      : 1
[2024-09-22 22:46:44,804][root][INFO] - optimizer               : adamwscale
[2024-09-22 22:46:44,805][root][INFO] - lr_scheduler            : cosine
[2024-09-22 22:46:44,805][root][INFO] - learning rate           : 0.01
[2024-09-22 22:46:44,805][root][INFO] - max length              : 256

[2024-09-22 22:46:44,805][root][INFO] - LoRA Configuration
[2024-09-22 22:46:44,805][root][INFO] - ㄴ r                    : 32
[2024-09-22 22:46:44,805][root][INFO] - ㄴ alpha                : 128
[2024-09-22 22:46:44,805][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 22:46:44,805][root][INFO] - 

[2024-09-22 22:46:44,805][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-22 22:46:44,805][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-22 22:46:44,805][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb
[2024-09-22 22:46:44,806][root][INFO] - * tb interval   : 15

[2024-09-22 22:46:44,806][root][INFO] - 

[2024-09-22 22:46:44,806][root][INFO] - Start the Training !
[2024-09-22 22:46:44,809][root][INFO] - 
[1/ 15 Epoch]
[2024-09-22 22:46:53,267][root][INFO] - Step: 15/1035  |  Loss: 3.3881  |  Score: 0.92 [%]  |  Seq Length: 256.0
[2024-09-22 22:46:58,785][root][INFO] - Step: 30/1035  |  Loss: 2.3165  |  Score: 18.38 [%]  |  Seq Length: 256.0
[2024-09-22 22:47:04,282][root][INFO] - Step: 45/1035  |  Loss: 2.0702  |  Score: 33.89 [%]  |  Seq Length: 256.0
[2024-09-22 22:47:09,803][root][INFO] - Step: 60/1035  |  Loss: 1.6511  |  Score: 53.22 [%]  |  Seq Length: 256.0
[2024-09-22 22:47:13,137][root][INFO] - Step: 69/1035  |  Loss: 1.4205  |  Score: 64.34 [%]  |  Seq Length: 256.0
[2024-09-22 22:47:16,277][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 22:47:16,277][root][INFO] - Score: 73.02 [%]  |  Evaluation Time: 3.14 [s]
[2024-09-22 22:47:19,234][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 22:47:19,235][root][INFO] - Score: 65.20 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-22 22:47:19,236][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 22:47:19,237][root][INFO] - 
[2/ 15 Epoch]
[2024-09-22 22:47:21,908][root][INFO] - Step: 75/1035  |  Loss: 1.3487  |  Score: 64.08 [%]  |  Seq Length: 256.0
[2024-09-22 22:47:27,427][root][INFO] - Step: 90/1035  |  Loss: 1.4792  |  Score: 62.77 [%]  |  Seq Length: 256.0
[2024-09-22 22:47:32,957][root][INFO] - Step: 105/1035  |  Loss: 1.3648  |  Score: 60.90 [%]  |  Seq Length: 256.0
[2024-09-22 22:47:38,499][root][INFO] - Step: 120/1035  |  Loss: 1.2505  |  Score: 68.07 [%]  |  Seq Length: 256.0
[2024-09-22 22:47:44,026][root][INFO] - Step: 135/1035  |  Loss: 1.2024  |  Score: 68.13 [%]  |  Seq Length: 256.0
[2024-09-22 22:47:45,179][root][INFO] - Step: 138/1035  |  Loss: 1.1858  |  Score: 73.19 [%]  |  Seq Length: 256.0
[2024-09-22 22:47:48,272][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 22:47:48,272][root][INFO] - Score: 74.14 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-22 22:47:51,315][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 22:47:51,315][root][INFO] - Score: 67.78 [%]  |  Evaluation Time: 3.04 [s]
[2024-09-22 22:47:51,317][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 22:47:51,318][root][INFO] - 
[3/ 15 Epoch]
[2024-09-22 22:47:56,071][root][INFO] - Step: 150/1035  |  Loss: 1.2068  |  Score: 66.87 [%]  |  Seq Length: 256.0
[2024-09-22 22:48:01,632][root][INFO] - Step: 165/1035  |  Loss: 1.0650  |  Score: 69.80 [%]  |  Seq Length: 256.0
[2024-09-22 22:48:07,199][root][INFO] - Step: 180/1035  |  Loss: 0.9787  |  Score: 71.08 [%]  |  Seq Length: 256.0
[2024-09-22 22:48:12,758][root][INFO] - Step: 195/1035  |  Loss: 1.1842  |  Score: 72.03 [%]  |  Seq Length: 256.0
[2024-09-22 22:48:17,219][root][INFO] - Step: 207/1035  |  Loss: 1.0907  |  Score: 72.14 [%]  |  Seq Length: 256.0
[2024-09-22 22:48:20,392][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 22:48:20,392][root][INFO] - Score: 77.63 [%]  |  Evaluation Time: 3.17 [s]
[2024-09-22 22:48:23,329][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 22:48:23,329][root][INFO] - Score: 70.10 [%]  |  Evaluation Time: 2.93 [s]
[2024-09-22 22:48:23,330][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 22:48:23,331][root][INFO] - 
[4/ 15 Epoch]
[2024-09-22 22:48:24,889][root][INFO] - Step: 210/1035  |  Loss: 1.0733  |  Score: 74.18 [%]  |  Seq Length: 256.0
[2024-09-22 22:48:30,400][root][INFO] - Step: 225/1035  |  Loss: 0.9538  |  Score: 75.82 [%]  |  Seq Length: 256.0
[2024-09-22 22:48:35,911][root][INFO] - Step: 240/1035  |  Loss: 0.8554  |  Score: 75.50 [%]  |  Seq Length: 256.0
[2024-09-22 22:48:41,431][root][INFO] - Step: 255/1035  |  Loss: 0.9215  |  Score: 76.65 [%]  |  Seq Length: 256.0
[2024-09-22 22:48:46,952][root][INFO] - Step: 270/1035  |  Loss: 0.9457  |  Score: 75.43 [%]  |  Seq Length: 256.0
[2024-09-22 22:48:49,219][root][INFO] - Step: 276/1035  |  Loss: 1.0580  |  Score: 68.92 [%]  |  Seq Length: 256.0
[2024-09-22 22:48:52,380][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 22:48:52,381][root][INFO] - Score: 77.79 [%]  |  Evaluation Time: 3.16 [s]
[2024-09-22 22:48:55,643][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 22:48:55,643][root][INFO] - Score: 70.62 [%]  |  Evaluation Time: 3.26 [s]
[2024-09-22 22:48:55,644][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-22 22:48:55,645][root][INFO] - 
[5/ 15 Epoch]
[2024-09-22 22:48:59,309][root][INFO] - Step: 285/1035  |  Loss: 0.8031  |  Score: 79.93 [%]  |  Seq Length: 256.0
[2024-09-22 22:49:04,833][root][INFO] - Step: 300/1035  |  Loss: 0.8312  |  Score: 78.14 [%]  |  Seq Length: 256.0
[2024-09-22 22:49:10,357][root][INFO] - Step: 315/1035  |  Loss: 0.7614  |  Score: 77.96 [%]  |  Seq Length: 256.0
[2024-09-22 22:49:15,879][root][INFO] - Step: 330/1035  |  Loss: 0.7443  |  Score: 79.61 [%]  |  Seq Length: 256.0
[2024-09-22 22:49:21,446][root][INFO] - Step: 345/1035  |  Loss: 0.8749  |  Score: 76.48 [%]  |  Seq Length: 256.0
[2024-09-22 22:49:24,668][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 22:49:24,668][root][INFO] - Score: 74.46 [%]  |  Evaluation Time: 3.22 [s]
[2024-09-22 22:49:27,737][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 22:49:27,738][root][INFO] - Score: 70.54 [%]  |  Evaluation Time: 3.07 [s]
[2024-09-22 22:49:27,740][root][INFO] - 
[6/ 15 Epoch]
[2024-09-22 22:49:28,471][root][INFO] - Step: 346/1035  |  Loss: 0.7237  |  Score: 82.22 [%]  |  Seq Length: 256.0
[2024-09-22 22:49:33,675][root][INFO] - Step: 360/1035  |  Loss: 0.7485  |  Score: 79.44 [%]  |  Seq Length: 256.0
[2024-09-22 22:49:39,261][root][INFO] - Step: 375/1035  |  Loss: 0.7012  |  Score: 82.63 [%]  |  Seq Length: 256.0
[2024-09-22 22:49:44,836][root][INFO] - Step: 390/1035  |  Loss: 0.7539  |  Score: 79.16 [%]  |  Seq Length: 256.0
[2024-09-22 22:49:50,367][root][INFO] - Step: 405/1035  |  Loss: 0.6871  |  Score: 80.66 [%]  |  Seq Length: 256.0
[2024-09-22 22:49:53,727][root][INFO] - Step: 414/1035  |  Loss: 0.7319  |  Score: 80.29 [%]  |  Seq Length: 256.0
[2024-09-22 22:49:56,824][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-22 22:49:56,824][root][INFO] - Score: 77.97 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-22 22:49:59,878][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-22 22:49:59,878][root][INFO] - Score: 72.64 [%]  |  Evaluation Time: 3.05 [s]
[2024-09-22 22:49:59,880][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-22 22:49:59,881][root][INFO] - 
[7/ 15 Epoch]
[2024-09-22 22:50:02,387][root][INFO] - Step: 420/1035  |  Loss: 0.6564  |  Score: 81.01 [%]  |  Seq Length: 256.0
[2024-09-22 22:50:07,921][root][INFO] - Step: 435/1035  |  Loss: 0.5719  |  Score: 85.82 [%]  |  Seq Length: 256.0
[2024-09-22 22:50:13,450][root][INFO] - Step: 450/1035  |  Loss: 0.6278  |  Score: 82.72 [%]  |  Seq Length: 256.0
[2024-09-22 22:50:18,974][root][INFO] - Step: 465/1035  |  Loss: 0.6191  |  Score: 82.97 [%]  |  Seq Length: 256.0
[2024-09-22 22:50:24,497][root][INFO] - Step: 480/1035  |  Loss: 0.6866  |  Score: 81.67 [%]  |  Seq Length: 256.0
[2024-09-22 22:50:25,649][root][INFO] - Step: 483/1035  |  Loss: 0.6383  |  Score: 82.09 [%]  |  Seq Length: 256.0
[2024-09-22 22:50:28,866][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-22 22:50:28,867][root][INFO] - Score: 77.80 [%]  |  Evaluation Time: 3.21 [s]
[2024-09-22 22:50:32,030][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-22 22:50:32,030][root][INFO] - Score: 71.58 [%]  |  Evaluation Time: 3.16 [s]
[2024-09-22 22:50:32,032][root][INFO] - 
[8/ 15 Epoch]
[2024-09-22 22:50:36,742][root][INFO] - Step: 495/1035  |  Loss: 0.5490  |  Score: 84.10 [%]  |  Seq Length: 256.0
[2024-09-22 22:50:42,266][root][INFO] - Step: 510/1035  |  Loss: 0.5319  |  Score: 85.85 [%]  |  Seq Length: 256.0
[2024-09-22 22:50:47,789][root][INFO] - Step: 525/1035  |  Loss: 0.6062  |  Score: 84.35 [%]  |  Seq Length: 256.0
[2024-09-22 22:50:53,308][root][INFO] - Step: 540/1035  |  Loss: 0.5132  |  Score: 85.79 [%]  |  Seq Length: 256.0
[2024-09-22 22:50:57,769][root][INFO] - Step: 552/1035  |  Loss: 0.5103  |  Score: 84.42 [%]  |  Seq Length: 256.0
[2024-09-22 22:51:00,852][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-22 22:51:00,852][root][INFO] - Score: 78.21 [%]  |  Evaluation Time: 3.08 [s]
[2024-09-22 22:51:03,914][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-22 22:51:03,914][root][INFO] - Score: 72.03 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-22 22:51:03,917][root][INFO] - 
[9/ 15 Epoch]
[2024-09-22 22:51:05,407][root][INFO] - Step: 555/1035  |  Loss: 0.5939  |  Score: 84.14 [%]  |  Seq Length: 256.0
[2024-09-22 22:51:10,931][root][INFO] - Step: 570/1035  |  Loss: 0.5033  |  Score: 86.89 [%]  |  Seq Length: 256.0
[2024-09-22 22:51:16,455][root][INFO] - Step: 585/1035  |  Loss: 0.5322  |  Score: 86.52 [%]  |  Seq Length: 256.0
[2024-09-22 22:51:21,980][root][INFO] - Step: 600/1035  |  Loss: 0.5015  |  Score: 86.66 [%]  |  Seq Length: 256.0
[2024-09-22 22:51:27,501][root][INFO] - Step: 615/1035  |  Loss: 0.4757  |  Score: 86.40 [%]  |  Seq Length: 256.0
[2024-09-22 22:51:29,757][root][INFO] - Step: 621/1035  |  Loss: 0.4920  |  Score: 85.61 [%]  |  Seq Length: 256.0
[2024-09-22 22:51:32,852][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-22 22:51:32,852][root][INFO] - Score: 77.05 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-22 22:51:35,810][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-22 22:51:35,810][root][INFO] - Score: 71.47 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-22 22:51:35,812][root][INFO] - 
[10/ 15 Epoch]
[2024-09-22 22:51:39,534][root][INFO] - Step: 630/1035  |  Loss: 0.4708  |  Score: 88.01 [%]  |  Seq Length: 256.0
[2024-09-22 22:51:45,067][root][INFO] - Step: 645/1035  |  Loss: 0.4341  |  Score: 88.53 [%]  |  Seq Length: 256.0
[2024-09-22 22:51:50,590][root][INFO] - Step: 660/1035  |  Loss: 0.4126  |  Score: 87.92 [%]  |  Seq Length: 256.0
[2024-09-22 22:51:56,107][root][INFO] - Step: 675/1035  |  Loss: 0.4452  |  Score: 87.00 [%]  |  Seq Length: 256.0
[2024-09-22 22:52:01,671][root][INFO] - Step: 690/1035  |  Loss: 0.4415  |  Score: 87.96 [%]  |  Seq Length: 256.0
[2024-09-22 22:52:04,769][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-22 22:52:04,770][root][INFO] - Score: 77.82 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-22 22:52:07,730][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-22 22:52:07,731][root][INFO] - Score: 72.47 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-22 22:52:07,733][root][INFO] - 
[11/ 15 Epoch]
[2024-09-22 22:52:08,538][root][INFO] - Step: 691/1035  |  Loss: 0.4966  |  Score: 86.36 [%]  |  Seq Length: 256.0
[2024-09-22 22:52:13,689][root][INFO] - Step: 705/1035  |  Loss: 0.4137  |  Score: 88.48 [%]  |  Seq Length: 256.0
[2024-09-22 22:52:19,210][root][INFO] - Step: 720/1035  |  Loss: 0.4251  |  Score: 87.06 [%]  |  Seq Length: 256.0
[2024-09-22 22:52:24,734][root][INFO] - Step: 735/1035  |  Loss: 0.4029  |  Score: 88.93 [%]  |  Seq Length: 256.0
[2024-09-22 22:52:30,274][root][INFO] - Step: 750/1035  |  Loss: 0.4198  |  Score: 88.41 [%]  |  Seq Length: 256.0
[2024-09-22 22:52:33,653][root][INFO] - Step: 759/1035  |  Loss: 0.4147  |  Score: 89.79 [%]  |  Seq Length: 256.0
[2024-09-22 22:52:36,751][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-22 22:52:36,752][root][INFO] - Score: 78.02 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-22 22:52:39,809][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-22 22:52:39,810][root][INFO] - Score: 71.83 [%]  |  Evaluation Time: 3.05 [s]
[2024-09-22 22:52:39,813][root][INFO] - 
[12/ 15 Epoch]
[2024-09-22 22:52:42,397][root][INFO] - Step: 765/1035  |  Loss: 0.3492  |  Score: 88.73 [%]  |  Seq Length: 256.0
[2024-09-22 22:52:47,917][root][INFO] - Step: 780/1035  |  Loss: 0.3795  |  Score: 89.31 [%]  |  Seq Length: 256.0
[2024-09-22 22:52:53,451][root][INFO] - Step: 795/1035  |  Loss: 0.3844  |  Score: 89.73 [%]  |  Seq Length: 256.0
[2024-09-22 22:52:58,968][root][INFO] - Step: 810/1035  |  Loss: 0.3584  |  Score: 90.26 [%]  |  Seq Length: 256.0
[2024-09-22 22:53:04,489][root][INFO] - Step: 825/1035  |  Loss: 0.4050  |  Score: 88.11 [%]  |  Seq Length: 256.0
[2024-09-22 22:53:05,656][root][INFO] - Step: 828/1035  |  Loss: 0.3388  |  Score: 90.68 [%]  |  Seq Length: 256.0
[2024-09-22 22:53:08,768][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-22 22:53:08,769][root][INFO] - Score: 78.31 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-22 22:53:11,794][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-22 22:53:11,795][root][INFO] - Score: 72.03 [%]  |  Evaluation Time: 3.02 [s]
[2024-09-22 22:53:11,797][root][INFO] - 
[13/ 15 Epoch]
[2024-09-22 22:53:16,525][root][INFO] - Step: 840/1035  |  Loss: 0.3353  |  Score: 90.41 [%]  |  Seq Length: 256.0
[2024-09-22 22:53:22,047][root][INFO] - Step: 855/1035  |  Loss: 0.3523  |  Score: 90.01 [%]  |  Seq Length: 256.0
[2024-09-22 22:53:27,567][root][INFO] - Step: 870/1035  |  Loss: 0.3577  |  Score: 90.13 [%]  |  Seq Length: 256.0
[2024-09-22 22:53:33,083][root][INFO] - Step: 885/1035  |  Loss: 0.3347  |  Score: 90.60 [%]  |  Seq Length: 256.0
[2024-09-22 22:53:37,544][root][INFO] - Step: 897/1035  |  Loss: 0.3900  |  Score: 88.94 [%]  |  Seq Length: 256.0
[2024-09-22 22:53:40,612][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-22 22:53:40,612][root][INFO] - Score: 77.66 [%]  |  Evaluation Time: 3.07 [s]
[2024-09-22 22:53:43,674][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-22 22:53:43,675][root][INFO] - Score: 71.02 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-22 22:53:43,677][root][INFO] - 
[14/ 15 Epoch]
[2024-09-22 22:53:45,121][root][INFO] - Step: 900/1035  |  Loss: 0.3828  |  Score: 87.38 [%]  |  Seq Length: 256.0
[2024-09-22 22:53:50,648][root][INFO] - Step: 915/1035  |  Loss: 0.3964  |  Score: 89.03 [%]  |  Seq Length: 256.0
[2024-09-22 22:53:56,180][root][INFO] - Step: 930/1035  |  Loss: 0.3293  |  Score: 90.71 [%]  |  Seq Length: 256.0
[2024-09-22 22:54:01,704][root][INFO] - Step: 945/1035  |  Loss: 0.3427  |  Score: 90.51 [%]  |  Seq Length: 256.0
[2024-09-22 22:54:07,228][root][INFO] - Step: 960/1035  |  Loss: 0.3117  |  Score: 90.83 [%]  |  Seq Length: 256.0
[2024-09-22 22:54:09,492][root][INFO] - Step: 966/1035  |  Loss: 0.3724  |  Score: 89.52 [%]  |  Seq Length: 256.0
[2024-09-22 22:54:12,681][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-22 22:54:12,682][root][INFO] - Score: 77.26 [%]  |  Evaluation Time: 3.19 [s]
[2024-09-22 22:54:15,747][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-22 22:54:15,748][root][INFO] - Score: 71.62 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-22 22:54:15,750][root][INFO] - 
[15/ 15 Epoch]
[2024-09-22 22:54:19,376][root][INFO] - Step: 975/1035  |  Loss: 0.3609  |  Score: 89.42 [%]  |  Seq Length: 256.0
[2024-09-22 22:54:24,900][root][INFO] - Step: 990/1035  |  Loss: 0.3308  |  Score: 91.49 [%]  |  Seq Length: 256.0
[2024-09-22 22:54:30,420][root][INFO] - Step: 1005/1035  |  Loss: 0.3568  |  Score: 89.84 [%]  |  Seq Length: 256.0
[2024-09-22 22:54:35,955][root][INFO] - Step: 1020/1035  |  Loss: 0.3325  |  Score: 89.93 [%]  |  Seq Length: 256.0
[2024-09-22 22:54:41,525][root][INFO] - Step: 1035/1035  |  Loss: 0.3641  |  Score: 88.96 [%]  |  Seq Length: 256.0
[2024-09-22 22:54:44,639][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-22 22:54:44,639][root][INFO] - Score: 78.10 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-22 22:54:47,769][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-22 22:54:47,769][root][INFO] - Score: 71.31 [%]  |  Evaluation Time: 3.13 [s]
[2024-09-22 22:54:47,770][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 22:54:47,770][root][INFO] - - Epoch: 6
[2024-09-22 22:54:47,770][root][INFO] - - DEV score: 77.97 [%]
[2024-09-22 22:54:47,771][root][INFO] - - TEST score: 72.64 [%]
[2024-09-22 22:54:47,772][root][INFO] - Fine-tuning is done!
[2024-09-25 20:10:10,748][root][INFO] - 

[2024-09-25 20:10:10,748][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-25 20:10:10,748][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs
[2024-09-25 20:10:10,748][root][INFO] - 

[2024-09-25 20:10:10,748][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.0001, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-25 20:10:15,405][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-25 20:10:17,234][root][INFO] - 

[2024-09-25 20:10:17,234][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-25 20:10:17,234][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-25 20:10:17,243][root][INFO] - vocab size              : 51200
[2024-09-25 20:10:17,243][root][INFO] - device                  : gpu
[2024-09-25 20:10:17,244][root][INFO] - random seed             : 42
[2024-09-25 20:10:17,244][root][INFO] - train data size         : 4416
[2024-09-25 20:10:17,244][root][INFO] - max epochs              : 15
[2024-09-25 20:10:17,244][root][INFO] - total steps             : 1035
[2024-09-25 20:10:17,244][root][INFO] - warmup steps            : 104
[2024-09-25 20:10:17,244][root][INFO] - batch size              : 64
[2024-09-25 20:10:17,244][root][INFO] - accumulation steps      : 1
[2024-09-25 20:10:17,244][root][INFO] - optimizer               : adamwscale
[2024-09-25 20:10:17,244][root][INFO] - lr_scheduler            : cosine
[2024-09-25 20:10:17,244][root][INFO] - learning rate           : 0.0001
[2024-09-25 20:10:17,244][root][INFO] - max length              : 256

[2024-09-25 20:10:17,245][root][INFO] - 

[2024-09-25 20:10:17,245][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs
[2024-09-25 20:10:17,245][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs/ckpt
[2024-09-25 20:10:17,245][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs/tb
[2024-09-25 20:10:17,245][root][INFO] - * tb interval   : 15

[2024-09-25 20:10:17,245][root][INFO] - 

[2024-09-25 20:10:17,245][root][INFO] - Start the Training !
[2024-09-25 20:10:17,247][root][INFO] - 
[1/ 15 Epoch]
[2024-09-25 20:10:25,205][root][INFO] - Step: 15/1035  |  Loss: 3.8143  |  Score: 6.57 [%]  |  Seq Length: 256.0
[2024-09-25 20:10:31,750][root][INFO] - Step: 30/1035  |  Loss: 2.6538  |  Score: 12.41 [%]  |  Seq Length: 256.0
[2024-09-25 20:10:38,323][root][INFO] - Step: 45/1035  |  Loss: 2.2784  |  Score: 21.98 [%]  |  Seq Length: 256.0
[2024-09-25 20:10:44,905][root][INFO] - Step: 60/1035  |  Loss: 2.2505  |  Score: 24.52 [%]  |  Seq Length: 256.0
[2024-09-25 20:10:48,877][root][INFO] - Step: 69/1035  |  Loss: 2.0590  |  Score: 33.89 [%]  |  Seq Length: 256.0
[2024-09-25 20:10:51,937][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-25 20:10:51,937][root][INFO] - Score: 36.33 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-25 20:10:54,878][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-25 20:10:54,878][root][INFO] - Score: 38.49 [%]  |  Evaluation Time: 2.94 [s]
[2024-09-25 20:10:54,880][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-25 20:10:54,881][root][INFO] - 
[2/ 15 Epoch]
[2024-09-25 20:10:57,900][root][INFO] - Step: 75/1035  |  Loss: 1.7878  |  Score: 43.37 [%]  |  Seq Length: 256.0
[2024-09-25 20:11:04,653][root][INFO] - Step: 90/1035  |  Loss: 1.6794  |  Score: 53.68 [%]  |  Seq Length: 256.0
[2024-09-25 20:11:11,396][root][INFO] - Step: 105/1035  |  Loss: 1.5230  |  Score: 59.53 [%]  |  Seq Length: 256.0
[2024-09-25 20:11:18,037][root][INFO] - Step: 120/1035  |  Loss: 1.4308  |  Score: 59.96 [%]  |  Seq Length: 256.0
[2024-09-25 20:11:24,683][root][INFO] - Step: 135/1035  |  Loss: 1.4268  |  Score: 56.71 [%]  |  Seq Length: 256.0
[2024-09-25 20:11:26,079][root][INFO] - Step: 138/1035  |  Loss: 1.4092  |  Score: 66.52 [%]  |  Seq Length: 256.0
[2024-09-25 20:11:29,211][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-25 20:11:29,211][root][INFO] - Score: 71.37 [%]  |  Evaluation Time: 3.13 [s]
[2024-09-25 20:11:32,186][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-25 20:11:32,187][root][INFO] - Score: 64.82 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-25 20:11:32,188][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-25 20:11:32,189][root][INFO] - 
[3/ 15 Epoch]
[2024-09-25 20:11:37,851][root][INFO] - Step: 150/1035  |  Loss: 1.1005  |  Score: 68.35 [%]  |  Seq Length: 256.0
[2024-09-25 20:11:44,491][root][INFO] - Step: 165/1035  |  Loss: 1.2221  |  Score: 68.53 [%]  |  Seq Length: 256.0
[2024-09-25 20:11:51,129][root][INFO] - Step: 180/1035  |  Loss: 1.2678  |  Score: 65.17 [%]  |  Seq Length: 256.0
[2024-09-25 20:11:57,772][root][INFO] - Step: 195/1035  |  Loss: 1.0749  |  Score: 72.28 [%]  |  Seq Length: 256.0
[2024-09-25 20:12:03,130][root][INFO] - Step: 207/1035  |  Loss: 1.1674  |  Score: 67.53 [%]  |  Seq Length: 256.0
[2024-09-25 20:12:06,293][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-25 20:12:06,293][root][INFO] - Score: 74.51 [%]  |  Evaluation Time: 3.16 [s]
[2024-09-25 20:12:09,274][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-25 20:12:09,274][root][INFO] - Score: 67.82 [%]  |  Evaluation Time: 2.98 [s]
[2024-09-25 20:12:09,275][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-25 20:12:09,276][root][INFO] - 
[4/ 15 Epoch]
[2024-09-25 20:12:10,953][root][INFO] - Step: 210/1035  |  Loss: 1.0103  |  Score: 77.99 [%]  |  Seq Length: 256.0
[2024-09-25 20:12:17,597][root][INFO] - Step: 225/1035  |  Loss: 1.0267  |  Score: 73.04 [%]  |  Seq Length: 256.0
[2024-09-25 20:12:24,237][root][INFO] - Step: 240/1035  |  Loss: 1.0343  |  Score: 70.06 [%]  |  Seq Length: 256.0
[2024-09-25 20:12:30,878][root][INFO] - Step: 255/1035  |  Loss: 0.9259  |  Score: 73.09 [%]  |  Seq Length: 256.0
[2024-09-25 20:12:37,510][root][INFO] - Step: 270/1035  |  Loss: 0.9114  |  Score: 75.12 [%]  |  Seq Length: 256.0
[2024-09-25 20:12:40,211][root][INFO] - Step: 276/1035  |  Loss: 0.9190  |  Score: 79.46 [%]  |  Seq Length: 256.0
[2024-09-25 20:12:43,420][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-25 20:12:43,421][root][INFO] - Score: 75.25 [%]  |  Evaluation Time: 3.21 [s]
[2024-09-25 20:12:46,432][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-25 20:12:46,432][root][INFO] - Score: 69.27 [%]  |  Evaluation Time: 3.01 [s]
[2024-09-25 20:12:46,433][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-25 20:12:46,434][root][INFO] - 
[5/ 15 Epoch]
[2024-09-25 20:12:50,726][root][INFO] - Step: 285/1035  |  Loss: 0.8415  |  Score: 80.05 [%]  |  Seq Length: 256.0
[2024-09-25 20:12:57,363][root][INFO] - Step: 300/1035  |  Loss: 0.8839  |  Score: 75.19 [%]  |  Seq Length: 256.0
[2024-09-25 20:13:04,021][root][INFO] - Step: 315/1035  |  Loss: 0.8509  |  Score: 76.55 [%]  |  Seq Length: 256.0
[2024-09-25 20:13:10,665][root][INFO] - Step: 330/1035  |  Loss: 0.8143  |  Score: 78.70 [%]  |  Seq Length: 256.0
[2024-09-25 20:13:17,350][root][INFO] - Step: 345/1035  |  Loss: 0.8637  |  Score: 74.66 [%]  |  Seq Length: 256.0
[2024-09-25 20:13:20,487][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-25 20:13:20,487][root][INFO] - Score: 76.12 [%]  |  Evaluation Time: 3.13 [s]
[2024-09-25 20:13:23,513][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-25 20:13:23,513][root][INFO] - Score: 68.25 [%]  |  Evaluation Time: 3.02 [s]
[2024-09-25 20:13:23,515][root][INFO] - 
[6/ 15 Epoch]
[2024-09-25 20:13:24,276][root][INFO] - Step: 346/1035  |  Loss: 0.7462  |  Score: 73.86 [%]  |  Seq Length: 256.0
[2024-09-25 20:13:30,473][root][INFO] - Step: 360/1035  |  Loss: 0.7617  |  Score: 80.02 [%]  |  Seq Length: 256.0
[2024-09-25 20:13:37,115][root][INFO] - Step: 375/1035  |  Loss: 0.7211  |  Score: 79.47 [%]  |  Seq Length: 256.0
[2024-09-25 20:13:43,753][root][INFO] - Step: 390/1035  |  Loss: 0.7668  |  Score: 78.96 [%]  |  Seq Length: 256.0
[2024-09-25 20:13:50,394][root][INFO] - Step: 405/1035  |  Loss: 0.7667  |  Score: 79.12 [%]  |  Seq Length: 256.0
[2024-09-25 20:13:54,425][root][INFO] - Step: 414/1035  |  Loss: 0.7389  |  Score: 77.81 [%]  |  Seq Length: 256.0
[2024-09-25 20:13:57,582][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-25 20:13:57,583][root][INFO] - Score: 76.38 [%]  |  Evaluation Time: 3.16 [s]
[2024-09-25 20:14:00,554][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-25 20:14:00,555][root][INFO] - Score: 69.59 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-25 20:14:00,556][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-25 20:14:00,557][root][INFO] - 
[7/ 15 Epoch]
[2024-09-25 20:14:03,610][root][INFO] - Step: 420/1035  |  Loss: 0.7207  |  Score: 80.19 [%]  |  Seq Length: 256.0
[2024-09-25 20:14:10,269][root][INFO] - Step: 435/1035  |  Loss: 0.7045  |  Score: 80.49 [%]  |  Seq Length: 256.0
[2024-09-25 20:14:16,958][root][INFO] - Step: 450/1035  |  Loss: 0.6882  |  Score: 80.92 [%]  |  Seq Length: 256.0
[2024-09-25 20:14:23,603][root][INFO] - Step: 465/1035  |  Loss: 0.6271  |  Score: 82.42 [%]  |  Seq Length: 256.0
[2024-09-25 20:14:30,248][root][INFO] - Step: 480/1035  |  Loss: 0.6760  |  Score: 80.69 [%]  |  Seq Length: 256.0
[2024-09-25 20:14:31,634][root][INFO] - Step: 483/1035  |  Loss: 0.6893  |  Score: 82.95 [%]  |  Seq Length: 256.0
[2024-09-25 20:14:34,744][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-25 20:14:34,744][root][INFO] - Score: 76.28 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-25 20:14:37,720][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-25 20:14:37,721][root][INFO] - Score: 70.63 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-25 20:14:37,722][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-25 20:14:37,724][root][INFO] - 
[8/ 15 Epoch]
[2024-09-25 20:14:43,347][root][INFO] - Step: 495/1035  |  Loss: 0.6492  |  Score: 83.33 [%]  |  Seq Length: 256.0
[2024-09-25 20:14:50,022][root][INFO] - Step: 510/1035  |  Loss: 0.6083  |  Score: 83.50 [%]  |  Seq Length: 256.0
[2024-09-25 20:14:56,660][root][INFO] - Step: 525/1035  |  Loss: 0.6877  |  Score: 82.08 [%]  |  Seq Length: 256.0
[2024-09-25 20:15:03,309][root][INFO] - Step: 540/1035  |  Loss: 0.5530  |  Score: 83.80 [%]  |  Seq Length: 256.0
[2024-09-25 20:15:08,669][root][INFO] - Step: 552/1035  |  Loss: 0.5821  |  Score: 84.73 [%]  |  Seq Length: 256.0
[2024-09-25 20:15:11,742][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-25 20:15:11,742][root][INFO] - Score: 76.74 [%]  |  Evaluation Time: 3.07 [s]
[2024-09-25 20:15:14,721][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-25 20:15:14,721][root][INFO] - Score: 70.58 [%]  |  Evaluation Time: 2.98 [s]
[2024-09-25 20:15:14,722][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-25 20:15:14,723][root][INFO] - 
[9/ 15 Epoch]
[2024-09-25 20:15:16,338][root][INFO] - Step: 555/1035  |  Loss: 0.6641  |  Score: 84.31 [%]  |  Seq Length: 256.0
[2024-09-25 20:15:22,979][root][INFO] - Step: 570/1035  |  Loss: 0.5409  |  Score: 85.73 [%]  |  Seq Length: 256.0
[2024-09-25 20:15:29,629][root][INFO] - Step: 585/1035  |  Loss: 0.5563  |  Score: 84.05 [%]  |  Seq Length: 256.0
[2024-09-25 20:15:36,271][root][INFO] - Step: 600/1035  |  Loss: 0.6130  |  Score: 82.50 [%]  |  Seq Length: 256.0
[2024-09-25 20:15:42,911][root][INFO] - Step: 615/1035  |  Loss: 0.6072  |  Score: 82.49 [%]  |  Seq Length: 256.0
[2024-09-25 20:15:45,607][root][INFO] - Step: 621/1035  |  Loss: 0.6412  |  Score: 82.42 [%]  |  Seq Length: 256.0
[2024-09-25 20:15:48,717][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-25 20:15:48,718][root][INFO] - Score: 77.24 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-25 20:15:51,731][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-25 20:15:51,731][root][INFO] - Score: 70.02 [%]  |  Evaluation Time: 3.01 [s]
[2024-09-25 20:15:51,734][root][INFO] - 
[10/ 15 Epoch]
[2024-09-25 20:15:56,102][root][INFO] - Step: 630/1035  |  Loss: 0.5463  |  Score: 84.95 [%]  |  Seq Length: 256.0
[2024-09-25 20:16:02,761][root][INFO] - Step: 645/1035  |  Loss: 0.5209  |  Score: 84.41 [%]  |  Seq Length: 256.0
[2024-09-25 20:16:09,402][root][INFO] - Step: 660/1035  |  Loss: 0.5318  |  Score: 84.75 [%]  |  Seq Length: 256.0
[2024-09-25 20:16:16,059][root][INFO] - Step: 675/1035  |  Loss: 0.5015  |  Score: 87.32 [%]  |  Seq Length: 256.0
[2024-09-25 20:16:22,734][root][INFO] - Step: 690/1035  |  Loss: 0.5613  |  Score: 83.91 [%]  |  Seq Length: 256.0
[2024-09-25 20:16:25,827][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-25 20:16:25,828][root][INFO] - Score: 76.16 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-25 20:16:28,805][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-25 20:16:28,805][root][INFO] - Score: 70.79 [%]  |  Evaluation Time: 2.98 [s]
[2024-09-25 20:16:28,808][root][INFO] - 
[11/ 15 Epoch]
[2024-09-25 20:16:29,534][root][INFO] - Step: 691/1035  |  Loss: 0.7158  |  Score: 79.19 [%]  |  Seq Length: 256.0
[2024-09-25 20:16:35,720][root][INFO] - Step: 705/1035  |  Loss: 0.5126  |  Score: 86.03 [%]  |  Seq Length: 256.0
[2024-09-25 20:16:42,371][root][INFO] - Step: 720/1035  |  Loss: 0.5080  |  Score: 85.23 [%]  |  Seq Length: 256.0
[2024-09-25 20:16:49,033][root][INFO] - Step: 735/1035  |  Loss: 0.5225  |  Score: 85.36 [%]  |  Seq Length: 256.0
[2024-09-25 20:16:55,673][root][INFO] - Step: 750/1035  |  Loss: 0.4950  |  Score: 85.57 [%]  |  Seq Length: 256.0
[2024-09-25 20:16:59,689][root][INFO] - Step: 759/1035  |  Loss: 0.4440  |  Score: 87.10 [%]  |  Seq Length: 256.0
[2024-09-25 20:17:02,804][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-25 20:17:02,805][root][INFO] - Score: 76.23 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-25 20:17:05,791][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-25 20:17:05,792][root][INFO] - Score: 70.93 [%]  |  Evaluation Time: 2.98 [s]
[2024-09-25 20:17:05,794][root][INFO] - 
[12/ 15 Epoch]
[2024-09-25 20:17:08,784][root][INFO] - Step: 765/1035  |  Loss: 0.4444  |  Score: 87.66 [%]  |  Seq Length: 256.0
[2024-09-25 20:17:15,426][root][INFO] - Step: 780/1035  |  Loss: 0.5246  |  Score: 85.74 [%]  |  Seq Length: 256.0
[2024-09-25 20:17:22,065][root][INFO] - Step: 795/1035  |  Loss: 0.5291  |  Score: 86.89 [%]  |  Seq Length: 256.0
[2024-09-25 20:17:28,716][root][INFO] - Step: 810/1035  |  Loss: 0.5230  |  Score: 84.09 [%]  |  Seq Length: 256.0
[2024-09-25 20:17:35,365][root][INFO] - Step: 825/1035  |  Loss: 0.4801  |  Score: 86.70 [%]  |  Seq Length: 256.0
[2024-09-25 20:17:36,742][root][INFO] - Step: 828/1035  |  Loss: 0.5014  |  Score: 87.20 [%]  |  Seq Length: 256.0
[2024-09-25 20:17:39,840][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-25 20:17:39,840][root][INFO] - Score: 76.35 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-25 20:17:42,809][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-25 20:17:42,810][root][INFO] - Score: 72.65 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-25 20:17:42,811][root][INFO] - 
Save new Best Score (Epoch: 12)
[2024-09-25 20:17:42,812][root][INFO] - 
[13/ 15 Epoch]
[2024-09-25 20:17:48,572][root][INFO] - Step: 840/1035  |  Loss: 0.4407  |  Score: 87.55 [%]  |  Seq Length: 256.0
[2024-09-25 20:17:55,379][root][INFO] - Step: 855/1035  |  Loss: 0.4874  |  Score: 86.51 [%]  |  Seq Length: 256.0
[2024-09-25 20:18:02,104][root][INFO] - Step: 870/1035  |  Loss: 0.4658  |  Score: 86.42 [%]  |  Seq Length: 256.0
[2024-09-25 20:18:08,751][root][INFO] - Step: 885/1035  |  Loss: 0.4758  |  Score: 87.55 [%]  |  Seq Length: 256.0
[2024-09-25 20:18:14,114][root][INFO] - Step: 897/1035  |  Loss: 0.5108  |  Score: 84.81 [%]  |  Seq Length: 256.0
[2024-09-25 20:18:17,219][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-25 20:18:17,219][root][INFO] - Score: 77.15 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-25 20:18:20,213][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-25 20:18:20,213][root][INFO] - Score: 71.48 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-25 20:18:20,215][root][INFO] - 
[14/ 15 Epoch]
[2024-09-25 20:18:21,863][root][INFO] - Step: 900/1035  |  Loss: 0.5248  |  Score: 86.56 [%]  |  Seq Length: 256.0
[2024-09-25 20:18:28,513][root][INFO] - Step: 915/1035  |  Loss: 0.4802  |  Score: 86.96 [%]  |  Seq Length: 256.0
[2024-09-25 20:18:35,168][root][INFO] - Step: 930/1035  |  Loss: 0.4581  |  Score: 85.86 [%]  |  Seq Length: 256.0
[2024-09-25 20:18:41,815][root][INFO] - Step: 945/1035  |  Loss: 0.4580  |  Score: 87.11 [%]  |  Seq Length: 256.0
[2024-09-25 20:18:48,447][root][INFO] - Step: 960/1035  |  Loss: 0.4721  |  Score: 86.85 [%]  |  Seq Length: 256.0
[2024-09-25 20:18:51,153][root][INFO] - Step: 966/1035  |  Loss: 0.4748  |  Score: 86.52 [%]  |  Seq Length: 256.0
[2024-09-25 20:18:54,275][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-25 20:18:54,276][root][INFO] - Score: 77.11 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-25 20:18:57,286][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-25 20:18:57,287][root][INFO] - Score: 71.34 [%]  |  Evaluation Time: 3.01 [s]
[2024-09-25 20:18:57,289][root][INFO] - 
[15/ 15 Epoch]
[2024-09-25 20:19:01,599][root][INFO] - Step: 975/1035  |  Loss: 0.3817  |  Score: 90.33 [%]  |  Seq Length: 256.0
[2024-09-25 20:19:08,267][root][INFO] - Step: 990/1035  |  Loss: 0.4833  |  Score: 86.94 [%]  |  Seq Length: 256.0
[2024-09-25 20:19:14,938][root][INFO] - Step: 1005/1035  |  Loss: 0.4339  |  Score: 87.52 [%]  |  Seq Length: 256.0
[2024-09-25 20:19:21,579][root][INFO] - Step: 1020/1035  |  Loss: 0.4956  |  Score: 86.21 [%]  |  Seq Length: 256.0
[2024-09-25 20:19:28,269][root][INFO] - Step: 1035/1035  |  Loss: 0.4675  |  Score: 86.12 [%]  |  Seq Length: 256.0
[2024-09-25 20:19:31,441][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-25 20:19:31,441][root][INFO] - Score: 76.71 [%]  |  Evaluation Time: 3.17 [s]
[2024-09-25 20:19:34,500][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-25 20:19:34,500][root][INFO] - Score: 71.66 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-25 20:19:34,502][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-25 20:19:34,502][root][INFO] - - Epoch: 12
[2024-09-25 20:19:34,502][root][INFO] - - DEV score: 76.35 [%]
[2024-09-25 20:19:34,502][root][INFO] - - TEST score: 72.65 [%]
[2024-09-25 20:19:34,503][root][INFO] - Fine-tuning is done!
[2024-09-25 20:21:09,274][root][INFO] - 

[2024-09-25 20:21:09,274][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-25 20:21:09,275][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-25 20:21:09,275][root][INFO] - 

[2024-09-25 20:21:09,275][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-25 20:21:13,904][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-25 20:21:13,904][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-25 20:21:13,905][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-25 20:21:13,905][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-25 20:21:13,906][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-25 20:21:13,906][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-25 20:21:13,907][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-25 20:21:13,907][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-25 20:21:13,908][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-25 20:21:13,908][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-25 20:21:13,909][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-25 20:21:13,909][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-25 20:21:13,910][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-25 20:21:13,910][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-25 20:21:13,911][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-25 20:21:13,911][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-25 20:21:13,912][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-25 20:21:13,913][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-25 20:21:13,913][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-25 20:21:13,914][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-25 20:21:13,914][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-25 20:21:13,915][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-25 20:21:13,916][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-25 20:21:13,916][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-25 20:21:13,918][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-25 20:21:14,095][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-25 20:21:16,011][root][INFO] - 

[2024-09-25 20:21:16,012][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-25 20:21:16,012][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-25 20:21:16,021][root][INFO] - vocab size              : 51200
[2024-09-25 20:21:16,021][root][INFO] - device                  : gpu
[2024-09-25 20:21:16,021][root][INFO] - random seed             : 42
[2024-09-25 20:21:16,021][root][INFO] - train data size         : 4416
[2024-09-25 20:21:16,021][root][INFO] - max epochs              : 15
[2024-09-25 20:21:16,021][root][INFO] - total steps             : 1035
[2024-09-25 20:21:16,021][root][INFO] - warmup steps            : 104
[2024-09-25 20:21:16,021][root][INFO] - batch size              : 64
[2024-09-25 20:21:16,022][root][INFO] - accumulation steps      : 1
[2024-09-25 20:21:16,022][root][INFO] - optimizer               : adamwscale
[2024-09-25 20:21:16,022][root][INFO] - lr_scheduler            : cosine
[2024-09-25 20:21:16,022][root][INFO] - learning rate           : 0.01
[2024-09-25 20:21:16,022][root][INFO] - max length              : 256

[2024-09-25 20:21:16,022][root][INFO] - LoRA Configuration
[2024-09-25 20:21:16,022][root][INFO] - ㄴ r                    : 32
[2024-09-25 20:21:16,022][root][INFO] - ㄴ alpha                : 128
[2024-09-25 20:21:16,022][root][INFO] - ㄴ dropout              : 0.03

[2024-09-25 20:21:16,022][root][INFO] - 

[2024-09-25 20:21:16,022][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-25 20:21:16,023][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-25 20:21:16,023][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb
[2024-09-25 20:21:16,023][root][INFO] - * tb interval   : 15

[2024-09-25 20:21:16,023][root][INFO] - 

[2024-09-25 20:21:16,023][root][INFO] - Start the Training !
[2024-09-25 20:21:16,026][root][INFO] - 
[1/ 15 Epoch]
[2024-09-25 20:21:22,973][root][INFO] - Step: 15/1035  |  Loss: 3.3881  |  Score: 0.92 [%]  |  Seq Length: 256.0
[2024-09-25 20:21:28,426][root][INFO] - Step: 30/1035  |  Loss: 2.3165  |  Score: 18.38 [%]  |  Seq Length: 256.0
[2024-09-25 20:21:33,920][root][INFO] - Step: 45/1035  |  Loss: 2.0702  |  Score: 33.89 [%]  |  Seq Length: 256.0
[2024-09-25 20:21:39,409][root][INFO] - Step: 60/1035  |  Loss: 1.6511  |  Score: 53.22 [%]  |  Seq Length: 256.0
[2024-09-25 20:21:42,720][root][INFO] - Step: 69/1035  |  Loss: 1.4205  |  Score: 64.34 [%]  |  Seq Length: 256.0
[2024-09-25 20:21:45,805][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-25 20:21:45,806][root][INFO] - Score: 73.02 [%]  |  Evaluation Time: 3.08 [s]
[2024-09-25 20:21:48,761][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-25 20:21:48,762][root][INFO] - Score: 65.20 [%]  |  Evaluation Time: 2.95 [s]
[2024-09-25 20:21:48,763][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-25 20:21:48,764][root][INFO] - 
[2/ 15 Epoch]
[2024-09-25 20:21:51,295][root][INFO] - Step: 75/1035  |  Loss: 1.3487  |  Score: 64.08 [%]  |  Seq Length: 256.0
[2024-09-25 20:21:56,781][root][INFO] - Step: 90/1035  |  Loss: 1.4792  |  Score: 62.77 [%]  |  Seq Length: 256.0
[2024-09-25 20:22:02,268][root][INFO] - Step: 105/1035  |  Loss: 1.3648  |  Score: 60.90 [%]  |  Seq Length: 256.0
[2024-09-25 20:22:07,758][root][INFO] - Step: 120/1035  |  Loss: 1.2505  |  Score: 68.07 [%]  |  Seq Length: 256.0
[2024-09-25 20:22:13,244][root][INFO] - Step: 135/1035  |  Loss: 1.2024  |  Score: 68.13 [%]  |  Seq Length: 256.0
[2024-09-25 20:22:14,411][root][INFO] - Step: 138/1035  |  Loss: 1.1858  |  Score: 73.19 [%]  |  Seq Length: 256.0
[2024-09-25 20:22:17,513][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-25 20:22:17,513][root][INFO] - Score: 74.14 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-25 20:22:20,495][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-25 20:22:20,495][root][INFO] - Score: 67.78 [%]  |  Evaluation Time: 2.98 [s]
[2024-09-25 20:22:20,496][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-25 20:22:20,498][root][INFO] - 
[3/ 15 Epoch]
[2024-09-25 20:22:25,286][root][INFO] - Step: 150/1035  |  Loss: 1.2068  |  Score: 66.87 [%]  |  Seq Length: 256.0
[2024-09-25 20:22:30,826][root][INFO] - Step: 165/1035  |  Loss: 1.0650  |  Score: 69.80 [%]  |  Seq Length: 256.0
[2024-09-25 20:22:36,323][root][INFO] - Step: 180/1035  |  Loss: 0.9787  |  Score: 71.08 [%]  |  Seq Length: 256.0
[2024-09-25 20:22:41,821][root][INFO] - Step: 195/1035  |  Loss: 1.1842  |  Score: 72.03 [%]  |  Seq Length: 256.0
[2024-09-25 20:22:46,291][root][INFO] - Step: 207/1035  |  Loss: 1.0907  |  Score: 72.14 [%]  |  Seq Length: 256.0
[2024-09-25 20:22:49,413][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-25 20:22:49,414][root][INFO] - Score: 77.63 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-25 20:22:52,420][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-25 20:22:52,420][root][INFO] - Score: 70.10 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-25 20:22:52,421][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-25 20:22:52,423][root][INFO] - 
[4/ 15 Epoch]
[2024-09-25 20:22:53,871][root][INFO] - Step: 210/1035  |  Loss: 1.0733  |  Score: 74.18 [%]  |  Seq Length: 256.0
[2024-09-25 20:22:59,393][root][INFO] - Step: 225/1035  |  Loss: 0.9538  |  Score: 75.82 [%]  |  Seq Length: 256.0
[2024-09-25 20:23:04,903][root][INFO] - Step: 240/1035  |  Loss: 0.8554  |  Score: 75.50 [%]  |  Seq Length: 256.0
[2024-09-25 20:23:10,406][root][INFO] - Step: 255/1035  |  Loss: 0.9215  |  Score: 76.65 [%]  |  Seq Length: 256.0
[2024-09-25 20:23:15,913][root][INFO] - Step: 270/1035  |  Loss: 0.9457  |  Score: 75.43 [%]  |  Seq Length: 256.0
[2024-09-25 20:23:18,174][root][INFO] - Step: 276/1035  |  Loss: 1.0580  |  Score: 68.92 [%]  |  Seq Length: 256.0
[2024-09-25 20:23:21,322][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-25 20:23:21,322][root][INFO] - Score: 77.79 [%]  |  Evaluation Time: 3.15 [s]
[2024-09-25 20:23:24,360][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-25 20:23:24,361][root][INFO] - Score: 70.62 [%]  |  Evaluation Time: 3.04 [s]
[2024-09-25 20:23:24,362][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-25 20:23:24,363][root][INFO] - 
[5/ 15 Epoch]
[2024-09-25 20:23:28,034][root][INFO] - Step: 285/1035  |  Loss: 0.8031  |  Score: 79.93 [%]  |  Seq Length: 256.0
[2024-09-25 20:23:33,551][root][INFO] - Step: 300/1035  |  Loss: 0.8312  |  Score: 78.14 [%]  |  Seq Length: 256.0
[2024-09-25 20:23:39,062][root][INFO] - Step: 315/1035  |  Loss: 0.7614  |  Score: 77.96 [%]  |  Seq Length: 256.0
[2024-09-25 20:23:44,616][root][INFO] - Step: 330/1035  |  Loss: 0.7443  |  Score: 79.61 [%]  |  Seq Length: 256.0
[2024-09-25 20:23:50,194][root][INFO] - Step: 345/1035  |  Loss: 0.8749  |  Score: 76.48 [%]  |  Seq Length: 256.0
[2024-09-25 20:23:53,325][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-25 20:23:53,326][root][INFO] - Score: 74.46 [%]  |  Evaluation Time: 3.13 [s]
[2024-09-25 20:23:56,339][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-25 20:23:56,339][root][INFO] - Score: 70.54 [%]  |  Evaluation Time: 3.01 [s]
[2024-09-25 20:23:56,341][root][INFO] - 
[6/ 15 Epoch]
[2024-09-25 20:23:57,089][root][INFO] - Step: 346/1035  |  Loss: 0.7237  |  Score: 82.22 [%]  |  Seq Length: 256.0
[2024-09-25 20:24:02,235][root][INFO] - Step: 360/1035  |  Loss: 0.7485  |  Score: 79.44 [%]  |  Seq Length: 256.0
[2024-09-25 20:24:07,752][root][INFO] - Step: 375/1035  |  Loss: 0.7012  |  Score: 82.63 [%]  |  Seq Length: 256.0
[2024-09-25 20:24:13,275][root][INFO] - Step: 390/1035  |  Loss: 0.7539  |  Score: 79.16 [%]  |  Seq Length: 256.0
[2024-09-25 20:24:18,792][root][INFO] - Step: 405/1035  |  Loss: 0.6871  |  Score: 80.66 [%]  |  Seq Length: 256.0
[2024-09-25 20:24:22,172][root][INFO] - Step: 414/1035  |  Loss: 0.7319  |  Score: 80.29 [%]  |  Seq Length: 256.0
[2024-09-25 20:24:25,293][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-25 20:24:25,293][root][INFO] - Score: 77.97 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-25 20:24:28,323][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-25 20:24:28,323][root][INFO] - Score: 72.64 [%]  |  Evaluation Time: 3.03 [s]
[2024-09-25 20:24:28,324][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-25 20:24:28,325][root][INFO] - 
[7/ 15 Epoch]
[2024-09-25 20:24:30,898][root][INFO] - Step: 420/1035  |  Loss: 0.6564  |  Score: 81.01 [%]  |  Seq Length: 256.0
[2024-09-25 20:24:36,471][root][INFO] - Step: 435/1035  |  Loss: 0.5719  |  Score: 85.82 [%]  |  Seq Length: 256.0
[2024-09-25 20:24:42,037][root][INFO] - Step: 450/1035  |  Loss: 0.6278  |  Score: 82.72 [%]  |  Seq Length: 256.0
[2024-09-25 20:24:47,582][root][INFO] - Step: 465/1035  |  Loss: 0.6191  |  Score: 82.97 [%]  |  Seq Length: 256.0
[2024-09-25 20:24:53,107][root][INFO] - Step: 480/1035  |  Loss: 0.6866  |  Score: 81.67 [%]  |  Seq Length: 256.0
[2024-09-25 20:24:54,268][root][INFO] - Step: 483/1035  |  Loss: 0.6383  |  Score: 82.09 [%]  |  Seq Length: 256.0
[2024-09-25 20:24:57,379][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-25 20:24:57,379][root][INFO] - Score: 77.80 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-25 20:25:00,387][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-25 20:25:00,387][root][INFO] - Score: 71.58 [%]  |  Evaluation Time: 3.01 [s]
[2024-09-25 20:25:00,390][root][INFO] - 
[8/ 15 Epoch]
[2024-09-25 20:25:05,163][root][INFO] - Step: 495/1035  |  Loss: 0.5490  |  Score: 84.10 [%]  |  Seq Length: 256.0
[2024-09-25 20:25:10,691][root][INFO] - Step: 510/1035  |  Loss: 0.5319  |  Score: 85.85 [%]  |  Seq Length: 256.0
[2024-09-25 20:25:16,213][root][INFO] - Step: 525/1035  |  Loss: 0.6062  |  Score: 84.35 [%]  |  Seq Length: 256.0
[2024-09-25 20:25:21,732][root][INFO] - Step: 540/1035  |  Loss: 0.5132  |  Score: 85.79 [%]  |  Seq Length: 256.0
[2024-09-25 20:25:26,203][root][INFO] - Step: 552/1035  |  Loss: 0.5103  |  Score: 84.42 [%]  |  Seq Length: 256.0
[2024-09-25 20:25:29,282][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-25 20:25:29,282][root][INFO] - Score: 78.21 [%]  |  Evaluation Time: 3.08 [s]
[2024-09-25 20:25:32,289][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-25 20:25:32,289][root][INFO] - Score: 72.03 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-25 20:25:32,292][root][INFO] - 
[9/ 15 Epoch]
[2024-09-25 20:25:33,765][root][INFO] - Step: 555/1035  |  Loss: 0.5939  |  Score: 84.14 [%]  |  Seq Length: 256.0
[2024-09-25 20:25:39,290][root][INFO] - Step: 570/1035  |  Loss: 0.5033  |  Score: 86.89 [%]  |  Seq Length: 256.0
[2024-09-25 20:25:44,812][root][INFO] - Step: 585/1035  |  Loss: 0.5322  |  Score: 86.52 [%]  |  Seq Length: 256.0
[2024-09-25 20:25:50,331][root][INFO] - Step: 600/1035  |  Loss: 0.5015  |  Score: 86.66 [%]  |  Seq Length: 256.0
[2024-09-25 20:25:55,849][root][INFO] - Step: 615/1035  |  Loss: 0.4757  |  Score: 86.40 [%]  |  Seq Length: 256.0
[2024-09-25 20:25:58,103][root][INFO] - Step: 621/1035  |  Loss: 0.4920  |  Score: 85.61 [%]  |  Seq Length: 256.0
[2024-09-25 20:26:01,217][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-25 20:26:01,217][root][INFO] - Score: 77.05 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-25 20:26:04,243][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-25 20:26:04,243][root][INFO] - Score: 71.47 [%]  |  Evaluation Time: 3.02 [s]
[2024-09-25 20:26:04,246][root][INFO] - 
[10/ 15 Epoch]
[2024-09-25 20:26:07,903][root][INFO] - Step: 630/1035  |  Loss: 0.4708  |  Score: 88.01 [%]  |  Seq Length: 256.0
[2024-09-25 20:26:13,431][root][INFO] - Step: 645/1035  |  Loss: 0.4341  |  Score: 88.53 [%]  |  Seq Length: 256.0
[2024-09-25 20:26:18,954][root][INFO] - Step: 660/1035  |  Loss: 0.4126  |  Score: 87.92 [%]  |  Seq Length: 256.0
[2024-09-25 20:26:24,475][root][INFO] - Step: 675/1035  |  Loss: 0.4452  |  Score: 87.00 [%]  |  Seq Length: 256.0
[2024-09-25 20:26:30,043][root][INFO] - Step: 690/1035  |  Loss: 0.4415  |  Score: 87.96 [%]  |  Seq Length: 256.0
[2024-09-25 20:26:33,138][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-25 20:26:33,138][root][INFO] - Score: 77.82 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-25 20:26:36,151][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-25 20:26:36,151][root][INFO] - Score: 72.47 [%]  |  Evaluation Time: 3.01 [s]
[2024-09-25 20:26:36,154][root][INFO] - 
[11/ 15 Epoch]
[2024-09-25 20:26:36,877][root][INFO] - Step: 691/1035  |  Loss: 0.4966  |  Score: 86.36 [%]  |  Seq Length: 256.0
[2024-09-25 20:26:42,036][root][INFO] - Step: 705/1035  |  Loss: 0.4137  |  Score: 88.48 [%]  |  Seq Length: 256.0
[2024-09-25 20:26:47,574][root][INFO] - Step: 720/1035  |  Loss: 0.4251  |  Score: 87.06 [%]  |  Seq Length: 256.0
[2024-09-25 20:26:53,099][root][INFO] - Step: 735/1035  |  Loss: 0.4029  |  Score: 88.93 [%]  |  Seq Length: 256.0
[2024-09-25 20:26:58,633][root][INFO] - Step: 750/1035  |  Loss: 0.4198  |  Score: 88.41 [%]  |  Seq Length: 256.0
[2024-09-25 20:27:02,002][root][INFO] - Step: 759/1035  |  Loss: 0.4147  |  Score: 89.79 [%]  |  Seq Length: 256.0
[2024-09-25 20:27:05,128][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-25 20:27:05,128][root][INFO] - Score: 78.02 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-25 20:27:08,126][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-25 20:27:08,126][root][INFO] - Score: 71.83 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-25 20:27:08,129][root][INFO] - 
[12/ 15 Epoch]
[2024-09-25 20:27:10,738][root][INFO] - Step: 765/1035  |  Loss: 0.3492  |  Score: 88.73 [%]  |  Seq Length: 256.0
[2024-09-25 20:27:16,302][root][INFO] - Step: 780/1035  |  Loss: 0.3795  |  Score: 89.31 [%]  |  Seq Length: 256.0
[2024-09-25 20:27:21,827][root][INFO] - Step: 795/1035  |  Loss: 0.3844  |  Score: 89.73 [%]  |  Seq Length: 256.0
[2024-09-25 20:27:27,356][root][INFO] - Step: 810/1035  |  Loss: 0.3584  |  Score: 90.26 [%]  |  Seq Length: 256.0
[2024-09-25 20:27:32,880][root][INFO] - Step: 825/1035  |  Loss: 0.4050  |  Score: 88.11 [%]  |  Seq Length: 256.0
[2024-09-25 20:27:34,013][root][INFO] - Step: 828/1035  |  Loss: 0.3388  |  Score: 90.68 [%]  |  Seq Length: 256.0
[2024-09-25 20:27:37,103][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-25 20:27:37,103][root][INFO] - Score: 78.31 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-25 20:27:40,077][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-25 20:27:40,077][root][INFO] - Score: 72.03 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-25 20:27:40,079][root][INFO] - 
[13/ 15 Epoch]
[2024-09-25 20:27:44,862][root][INFO] - Step: 840/1035  |  Loss: 0.3353  |  Score: 90.41 [%]  |  Seq Length: 256.0
[2024-09-25 20:27:50,386][root][INFO] - Step: 855/1035  |  Loss: 0.3523  |  Score: 90.01 [%]  |  Seq Length: 256.0
[2024-09-25 20:27:55,908][root][INFO] - Step: 870/1035  |  Loss: 0.3577  |  Score: 90.13 [%]  |  Seq Length: 256.0
[2024-09-25 20:28:01,426][root][INFO] - Step: 885/1035  |  Loss: 0.3347  |  Score: 90.60 [%]  |  Seq Length: 256.0
[2024-09-25 20:28:05,890][root][INFO] - Step: 897/1035  |  Loss: 0.3900  |  Score: 88.94 [%]  |  Seq Length: 256.0
[2024-09-25 20:28:09,033][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-25 20:28:09,033][root][INFO] - Score: 77.66 [%]  |  Evaluation Time: 3.14 [s]
[2024-09-25 20:28:12,051][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-25 20:28:12,052][root][INFO] - Score: 71.02 [%]  |  Evaluation Time: 3.02 [s]
[2024-09-25 20:28:12,054][root][INFO] - 
[14/ 15 Epoch]
[2024-09-25 20:28:13,510][root][INFO] - Step: 900/1035  |  Loss: 0.3828  |  Score: 87.38 [%]  |  Seq Length: 256.0
[2024-09-25 20:28:19,032][root][INFO] - Step: 915/1035  |  Loss: 0.3964  |  Score: 89.03 [%]  |  Seq Length: 256.0
[2024-09-25 20:28:24,558][root][INFO] - Step: 930/1035  |  Loss: 0.3293  |  Score: 90.71 [%]  |  Seq Length: 256.0
[2024-09-25 20:28:30,078][root][INFO] - Step: 945/1035  |  Loss: 0.3427  |  Score: 90.51 [%]  |  Seq Length: 256.0
[2024-09-25 20:28:35,598][root][INFO] - Step: 960/1035  |  Loss: 0.3117  |  Score: 90.83 [%]  |  Seq Length: 256.0
[2024-09-25 20:28:37,862][root][INFO] - Step: 966/1035  |  Loss: 0.3724  |  Score: 89.52 [%]  |  Seq Length: 256.0
[2024-09-25 20:28:40,983][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-25 20:28:40,983][root][INFO] - Score: 77.26 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-25 20:28:43,990][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-25 20:28:43,990][root][INFO] - Score: 71.62 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-25 20:28:43,992][root][INFO] - 
[15/ 15 Epoch]
[2024-09-25 20:28:47,668][root][INFO] - Step: 975/1035  |  Loss: 0.3609  |  Score: 89.42 [%]  |  Seq Length: 256.0
[2024-09-25 20:28:53,197][root][INFO] - Step: 990/1035  |  Loss: 0.3308  |  Score: 91.49 [%]  |  Seq Length: 256.0
[2024-09-25 20:28:58,720][root][INFO] - Step: 1005/1035  |  Loss: 0.3568  |  Score: 89.84 [%]  |  Seq Length: 256.0
[2024-09-25 20:29:04,248][root][INFO] - Step: 1020/1035  |  Loss: 0.3325  |  Score: 89.93 [%]  |  Seq Length: 256.0
[2024-09-25 20:29:09,807][root][INFO] - Step: 1035/1035  |  Loss: 0.3641  |  Score: 88.96 [%]  |  Seq Length: 256.0
[2024-09-25 20:29:12,926][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-25 20:29:12,927][root][INFO] - Score: 78.10 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-25 20:29:15,924][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-25 20:29:15,924][root][INFO] - Score: 71.31 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-25 20:29:15,925][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-25 20:29:15,925][root][INFO] - - Epoch: 6
[2024-09-25 20:29:15,925][root][INFO] - - DEV score: 77.97 [%]
[2024-09-25 20:29:15,925][root][INFO] - - TEST score: 72.64 [%]
[2024-09-25 20:29:15,926][root][INFO] - Fine-tuning is done!
[2024-09-25 20:31:14,766][root][INFO] - 

[2024-09-25 20:31:14,767][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-25 20:31:14,767][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-25 20:31:14,767][root][INFO] - 

[2024-09-25 20:31:14,767][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-25 20:32:02,531][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-25 20:32:02,532][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-25 20:32:02,532][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-25 20:32:02,533][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-25 20:32:02,533][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-25 20:32:02,534][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-25 20:32:02,534][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-25 20:32:02,534][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-25 20:32:02,535][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-25 20:32:02,535][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-25 20:32:02,536][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-25 20:32:02,536][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-25 20:32:02,537][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-25 20:32:02,537][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-25 20:32:02,538][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-25 20:32:02,538][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-25 20:32:02,539][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-25 20:32:02,539][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-25 20:32:02,540][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-25 20:32:02,540][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-25 20:32:02,541][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-25 20:32:02,541][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-25 20:32:02,542][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-25 20:32:02,542][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-25 20:32:02,544][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-25 20:32:02,736][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-25 20:32:04,585][root][INFO] - 

[2024-09-25 20:32:04,585][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-25 20:32:04,585][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-25 20:32:04,593][root][INFO] - vocab size              : 51200
[2024-09-25 20:32:04,593][root][INFO] - device                  : gpu
[2024-09-25 20:32:04,593][root][INFO] - random seed             : 42
[2024-09-25 20:32:04,593][root][INFO] - train data size         : 4416
[2024-09-25 20:32:04,593][root][INFO] - max epochs              : 15
[2024-09-25 20:32:04,593][root][INFO] - total steps             : 1035
[2024-09-25 20:32:04,593][root][INFO] - warmup steps            : 104
[2024-09-25 20:32:04,593][root][INFO] - batch size              : 64
[2024-09-25 20:32:04,594][root][INFO] - accumulation steps      : 1
[2024-09-25 20:32:04,594][root][INFO] - optimizer               : adamwscale
[2024-09-25 20:32:04,594][root][INFO] - lr_scheduler            : cosine
[2024-09-25 20:32:04,594][root][INFO] - learning rate           : 0.01
[2024-09-25 20:32:04,594][root][INFO] - max length              : 256

[2024-09-25 20:32:04,594][root][INFO] - LoRA Configuration
[2024-09-25 20:32:04,594][root][INFO] - ㄴ r                    : 32
[2024-09-25 20:32:04,594][root][INFO] - ㄴ alpha                : 128
[2024-09-25 20:32:04,594][root][INFO] - ㄴ dropout              : 0.03

[2024-09-25 20:32:04,594][root][INFO] - 

[2024-09-25 20:32:04,594][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-25 20:32:04,594][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-25 20:32:04,595][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb
[2024-09-25 20:32:04,595][root][INFO] - * tb interval   : 15

[2024-09-25 20:32:04,595][root][INFO] - 

[2024-09-25 20:32:04,595][root][INFO] - Start the Training !
[2024-09-25 20:32:04,598][root][INFO] - 
[1/ 15 Epoch]
[2024-09-25 20:32:11,512][root][INFO] - Step: 15/1035  |  Loss: 3.3881  |  Score: 0.92 [%]  |  Seq Length: 256.0
[2024-09-25 20:32:17,023][root][INFO] - Step: 30/1035  |  Loss: 2.3165  |  Score: 18.38 [%]  |  Seq Length: 256.0
[2024-09-25 20:32:22,499][root][INFO] - Step: 45/1035  |  Loss: 2.0702  |  Score: 33.89 [%]  |  Seq Length: 256.0
[2024-09-25 20:32:27,979][root][INFO] - Step: 60/1035  |  Loss: 1.6511  |  Score: 53.22 [%]  |  Seq Length: 256.0
[2024-09-25 20:32:31,294][root][INFO] - Step: 69/1035  |  Loss: 1.4205  |  Score: 64.34 [%]  |  Seq Length: 256.0
[2024-09-25 20:32:34,392][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-25 20:32:34,392][root][INFO] - Score: 73.02 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-25 20:32:37,372][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-25 20:32:37,372][root][INFO] - Score: 65.20 [%]  |  Evaluation Time: 2.98 [s]
[2024-09-25 20:32:37,373][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-25 20:32:37,375][root][INFO] - 
[2/ 15 Epoch]
[2024-09-25 20:32:39,903][root][INFO] - Step: 75/1035  |  Loss: 1.3487  |  Score: 64.08 [%]  |  Seq Length: 256.0
[2024-09-25 20:32:45,400][root][INFO] - Step: 90/1035  |  Loss: 1.4792  |  Score: 62.77 [%]  |  Seq Length: 256.0
[2024-09-25 20:32:50,912][root][INFO] - Step: 105/1035  |  Loss: 1.3648  |  Score: 60.90 [%]  |  Seq Length: 256.0
[2024-09-25 20:32:56,424][root][INFO] - Step: 120/1035  |  Loss: 1.2505  |  Score: 68.07 [%]  |  Seq Length: 256.0
[2024-09-25 20:33:01,936][root][INFO] - Step: 135/1035  |  Loss: 1.2024  |  Score: 68.13 [%]  |  Seq Length: 256.0
[2024-09-25 20:33:03,078][root][INFO] - Step: 138/1035  |  Loss: 1.1858  |  Score: 73.19 [%]  |  Seq Length: 256.0
[2024-09-25 20:33:06,201][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-25 20:33:06,201][root][INFO] - Score: 74.14 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-25 20:33:09,209][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-25 20:33:09,209][root][INFO] - Score: 67.78 [%]  |  Evaluation Time: 3.01 [s]
[2024-09-25 20:33:09,210][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-25 20:33:09,212][root][INFO] - 
[3/ 15 Epoch]
[2024-09-25 20:33:13,984][root][INFO] - Step: 150/1035  |  Loss: 1.2068  |  Score: 66.87 [%]  |  Seq Length: 256.0
[2024-09-25 20:33:19,507][root][INFO] - Step: 165/1035  |  Loss: 1.0650  |  Score: 69.80 [%]  |  Seq Length: 256.0
[2024-09-25 20:33:25,033][root][INFO] - Step: 180/1035  |  Loss: 0.9787  |  Score: 71.08 [%]  |  Seq Length: 256.0
[2024-09-25 20:33:30,597][root][INFO] - Step: 195/1035  |  Loss: 1.1842  |  Score: 72.03 [%]  |  Seq Length: 256.0
[2024-09-25 20:33:35,107][root][INFO] - Step: 207/1035  |  Loss: 1.0907  |  Score: 72.14 [%]  |  Seq Length: 256.0
[2024-09-25 20:33:38,213][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-25 20:33:38,213][root][INFO] - Score: 77.63 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-25 20:33:41,173][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-25 20:33:41,174][root][INFO] - Score: 70.10 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-25 20:33:41,175][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-25 20:33:41,176][root][INFO] - 
[4/ 15 Epoch]
[2024-09-25 20:33:42,613][root][INFO] - Step: 210/1035  |  Loss: 1.0733  |  Score: 74.18 [%]  |  Seq Length: 256.0
[2024-09-25 20:33:48,129][root][INFO] - Step: 225/1035  |  Loss: 0.9538  |  Score: 75.82 [%]  |  Seq Length: 256.0
[2024-09-25 20:33:53,647][root][INFO] - Step: 240/1035  |  Loss: 0.8554  |  Score: 75.50 [%]  |  Seq Length: 256.0
[2024-09-25 20:33:59,162][root][INFO] - Step: 255/1035  |  Loss: 0.9215  |  Score: 76.65 [%]  |  Seq Length: 256.0
[2024-09-25 20:34:04,676][root][INFO] - Step: 270/1035  |  Loss: 0.9457  |  Score: 75.43 [%]  |  Seq Length: 256.0
[2024-09-25 20:34:06,934][root][INFO] - Step: 276/1035  |  Loss: 1.0580  |  Score: 68.92 [%]  |  Seq Length: 256.0
[2024-09-25 20:34:10,034][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-25 20:34:10,034][root][INFO] - Score: 77.79 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-25 20:34:13,011][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-25 20:34:13,011][root][INFO] - Score: 70.62 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-25 20:34:13,012][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-25 20:34:13,013][root][INFO] - 
[5/ 15 Epoch]
[2024-09-25 20:34:16,639][root][INFO] - Step: 285/1035  |  Loss: 0.8031  |  Score: 79.93 [%]  |  Seq Length: 256.0
[2024-09-25 20:34:22,154][root][INFO] - Step: 300/1035  |  Loss: 0.8312  |  Score: 78.14 [%]  |  Seq Length: 256.0
[2024-09-25 20:34:27,665][root][INFO] - Step: 315/1035  |  Loss: 0.7614  |  Score: 77.96 [%]  |  Seq Length: 256.0
[2024-09-25 20:34:33,177][root][INFO] - Step: 330/1035  |  Loss: 0.7443  |  Score: 79.61 [%]  |  Seq Length: 256.0
[2024-09-25 20:34:38,707][root][INFO] - Step: 345/1035  |  Loss: 0.8749  |  Score: 76.48 [%]  |  Seq Length: 256.0
[2024-09-25 20:34:41,820][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-25 20:34:41,821][root][INFO] - Score: 74.46 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-25 20:34:44,797][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-25 20:34:44,797][root][INFO] - Score: 70.54 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-25 20:34:44,799][root][INFO] - 
[6/ 15 Epoch]
[2024-09-25 20:34:45,554][root][INFO] - Step: 346/1035  |  Loss: 0.7237  |  Score: 82.22 [%]  |  Seq Length: 256.0
[2024-09-25 20:34:50,731][root][INFO] - Step: 360/1035  |  Loss: 0.7485  |  Score: 79.44 [%]  |  Seq Length: 256.0
[2024-09-25 20:34:56,257][root][INFO] - Step: 375/1035  |  Loss: 0.7012  |  Score: 82.63 [%]  |  Seq Length: 256.0
[2024-09-25 20:35:01,781][root][INFO] - Step: 390/1035  |  Loss: 0.7539  |  Score: 79.16 [%]  |  Seq Length: 256.0
[2024-09-25 20:35:07,307][root][INFO] - Step: 405/1035  |  Loss: 0.6871  |  Score: 80.66 [%]  |  Seq Length: 256.0
[2024-09-25 20:35:10,684][root][INFO] - Step: 414/1035  |  Loss: 0.7319  |  Score: 80.29 [%]  |  Seq Length: 256.0
[2024-09-25 20:35:13,792][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-25 20:35:13,792][root][INFO] - Score: 77.97 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-25 20:35:16,787][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-25 20:35:16,787][root][INFO] - Score: 72.64 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-25 20:35:16,788][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-25 20:35:16,790][root][INFO] - 
[7/ 15 Epoch]
[2024-09-25 20:35:19,332][root][INFO] - Step: 420/1035  |  Loss: 0.6564  |  Score: 81.01 [%]  |  Seq Length: 256.0
[2024-09-25 20:35:24,849][root][INFO] - Step: 435/1035  |  Loss: 0.5719  |  Score: 85.82 [%]  |  Seq Length: 256.0
[2024-09-25 20:35:30,365][root][INFO] - Step: 450/1035  |  Loss: 0.6278  |  Score: 82.72 [%]  |  Seq Length: 256.0
[2024-09-25 20:35:35,879][root][INFO] - Step: 465/1035  |  Loss: 0.6191  |  Score: 82.97 [%]  |  Seq Length: 256.0
[2024-09-25 20:35:41,393][root][INFO] - Step: 480/1035  |  Loss: 0.6866  |  Score: 81.67 [%]  |  Seq Length: 256.0
[2024-09-25 20:35:42,556][root][INFO] - Step: 483/1035  |  Loss: 0.6383  |  Score: 82.09 [%]  |  Seq Length: 256.0
[2024-09-25 20:35:45,677][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-25 20:35:45,677][root][INFO] - Score: 77.80 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-25 20:35:48,626][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-25 20:35:48,627][root][INFO] - Score: 71.58 [%]  |  Evaluation Time: 2.95 [s]
[2024-09-25 20:35:48,629][root][INFO] - 
[8/ 15 Epoch]
[2024-09-25 20:35:53,367][root][INFO] - Step: 495/1035  |  Loss: 0.5490  |  Score: 84.10 [%]  |  Seq Length: 256.0
[2024-09-25 20:35:58,898][root][INFO] - Step: 510/1035  |  Loss: 0.5319  |  Score: 85.85 [%]  |  Seq Length: 256.0
[2024-09-25 20:36:04,413][root][INFO] - Step: 525/1035  |  Loss: 0.6062  |  Score: 84.35 [%]  |  Seq Length: 256.0
[2024-09-25 20:36:09,925][root][INFO] - Step: 540/1035  |  Loss: 0.5132  |  Score: 85.79 [%]  |  Seq Length: 256.0
[2024-09-25 20:36:14,379][root][INFO] - Step: 552/1035  |  Loss: 0.5103  |  Score: 84.42 [%]  |  Seq Length: 256.0
[2024-09-25 20:36:17,455][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-25 20:36:17,455][root][INFO] - Score: 78.21 [%]  |  Evaluation Time: 3.07 [s]
[2024-09-25 20:36:20,457][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-25 20:36:20,457][root][INFO] - Score: 72.03 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-25 20:36:20,459][root][INFO] - 
[9/ 15 Epoch]
[2024-09-25 20:36:21,881][root][INFO] - Step: 555/1035  |  Loss: 0.5939  |  Score: 84.14 [%]  |  Seq Length: 256.0
[2024-09-25 20:36:27,390][root][INFO] - Step: 570/1035  |  Loss: 0.5033  |  Score: 86.89 [%]  |  Seq Length: 256.0
[2024-09-25 20:36:32,910][root][INFO] - Step: 585/1035  |  Loss: 0.5322  |  Score: 86.52 [%]  |  Seq Length: 256.0
[2024-09-25 20:36:38,424][root][INFO] - Step: 600/1035  |  Loss: 0.5015  |  Score: 86.66 [%]  |  Seq Length: 256.0
[2024-09-25 20:36:43,937][root][INFO] - Step: 615/1035  |  Loss: 0.4757  |  Score: 86.40 [%]  |  Seq Length: 256.0
[2024-09-25 20:36:46,204][root][INFO] - Step: 621/1035  |  Loss: 0.4920  |  Score: 85.61 [%]  |  Seq Length: 256.0
[2024-09-25 20:36:49,296][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-25 20:36:49,297][root][INFO] - Score: 77.05 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-25 20:36:52,224][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-25 20:36:52,224][root][INFO] - Score: 71.47 [%]  |  Evaluation Time: 2.93 [s]
[2024-09-25 20:36:52,226][root][INFO] - 
[10/ 15 Epoch]
[2024-09-25 20:36:55,838][root][INFO] - Step: 630/1035  |  Loss: 0.4708  |  Score: 88.01 [%]  |  Seq Length: 256.0
[2024-09-25 20:37:01,354][root][INFO] - Step: 645/1035  |  Loss: 0.4341  |  Score: 88.53 [%]  |  Seq Length: 256.0
[2024-09-25 20:37:06,875][root][INFO] - Step: 660/1035  |  Loss: 0.4126  |  Score: 87.92 [%]  |  Seq Length: 256.0
[2024-09-25 20:37:12,389][root][INFO] - Step: 675/1035  |  Loss: 0.4452  |  Score: 87.00 [%]  |  Seq Length: 256.0
[2024-09-25 20:37:17,961][root][INFO] - Step: 690/1035  |  Loss: 0.4415  |  Score: 87.96 [%]  |  Seq Length: 256.0
[2024-09-25 20:37:21,022][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-25 20:37:21,022][root][INFO] - Score: 77.82 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-25 20:37:24,022][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-25 20:37:24,022][root][INFO] - Score: 72.47 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-25 20:37:24,024][root][INFO] - 
[11/ 15 Epoch]
[2024-09-25 20:37:24,740][root][INFO] - Step: 691/1035  |  Loss: 0.4966  |  Score: 86.36 [%]  |  Seq Length: 256.0
[2024-09-25 20:37:29,906][root][INFO] - Step: 705/1035  |  Loss: 0.4137  |  Score: 88.48 [%]  |  Seq Length: 256.0
[2024-09-25 20:37:35,438][root][INFO] - Step: 720/1035  |  Loss: 0.4251  |  Score: 87.06 [%]  |  Seq Length: 256.0
[2024-09-25 20:37:40,966][root][INFO] - Step: 735/1035  |  Loss: 0.4029  |  Score: 88.93 [%]  |  Seq Length: 256.0
[2024-09-25 20:37:46,494][root][INFO] - Step: 750/1035  |  Loss: 0.4198  |  Score: 88.41 [%]  |  Seq Length: 256.0
[2024-09-25 20:37:49,854][root][INFO] - Step: 759/1035  |  Loss: 0.4147  |  Score: 89.79 [%]  |  Seq Length: 256.0
[2024-09-25 20:37:52,947][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-25 20:37:52,947][root][INFO] - Score: 78.02 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-25 20:37:55,908][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-25 20:37:55,908][root][INFO] - Score: 71.83 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-25 20:37:55,910][root][INFO] - 
[12/ 15 Epoch]
[2024-09-25 20:37:58,433][root][INFO] - Step: 765/1035  |  Loss: 0.3492  |  Score: 88.73 [%]  |  Seq Length: 256.0
[2024-09-25 20:38:03,951][root][INFO] - Step: 780/1035  |  Loss: 0.3795  |  Score: 89.31 [%]  |  Seq Length: 256.0
[2024-09-25 20:38:09,467][root][INFO] - Step: 795/1035  |  Loss: 0.3844  |  Score: 89.73 [%]  |  Seq Length: 256.0
[2024-09-25 20:38:14,983][root][INFO] - Step: 810/1035  |  Loss: 0.3584  |  Score: 90.26 [%]  |  Seq Length: 256.0
[2024-09-25 20:38:20,499][root][INFO] - Step: 825/1035  |  Loss: 0.4050  |  Score: 88.11 [%]  |  Seq Length: 256.0
[2024-09-25 20:38:21,666][root][INFO] - Step: 828/1035  |  Loss: 0.3388  |  Score: 90.68 [%]  |  Seq Length: 256.0
[2024-09-25 20:38:24,770][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-25 20:38:24,770][root][INFO] - Score: 78.31 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-25 20:38:27,741][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-25 20:38:27,741][root][INFO] - Score: 72.03 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-25 20:38:27,743][root][INFO] - 
[13/ 15 Epoch]
[2024-09-25 20:38:32,519][root][INFO] - Step: 840/1035  |  Loss: 0.3353  |  Score: 90.41 [%]  |  Seq Length: 256.0
[2024-09-25 20:38:38,047][root][INFO] - Step: 855/1035  |  Loss: 0.3523  |  Score: 90.01 [%]  |  Seq Length: 256.0
[2024-09-25 20:38:43,581][root][INFO] - Step: 870/1035  |  Loss: 0.3577  |  Score: 90.13 [%]  |  Seq Length: 256.0
[2024-09-25 20:38:49,108][root][INFO] - Step: 885/1035  |  Loss: 0.3347  |  Score: 90.60 [%]  |  Seq Length: 256.0
[2024-09-25 20:38:53,581][root][INFO] - Step: 897/1035  |  Loss: 0.3900  |  Score: 88.94 [%]  |  Seq Length: 256.0
[2024-09-25 20:38:56,680][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-25 20:38:56,680][root][INFO] - Score: 77.66 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-25 20:38:59,654][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-25 20:38:59,654][root][INFO] - Score: 71.02 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-25 20:38:59,656][root][INFO] - 
[14/ 15 Epoch]
[2024-09-25 20:39:01,072][root][INFO] - Step: 900/1035  |  Loss: 0.3828  |  Score: 87.38 [%]  |  Seq Length: 256.0
[2024-09-25 20:39:06,587][root][INFO] - Step: 915/1035  |  Loss: 0.3964  |  Score: 89.03 [%]  |  Seq Length: 256.0
[2024-09-25 20:39:12,100][root][INFO] - Step: 930/1035  |  Loss: 0.3293  |  Score: 90.71 [%]  |  Seq Length: 256.0
[2024-09-25 20:39:17,622][root][INFO] - Step: 945/1035  |  Loss: 0.3427  |  Score: 90.51 [%]  |  Seq Length: 256.0
[2024-09-25 20:39:23,140][root][INFO] - Step: 960/1035  |  Loss: 0.3117  |  Score: 90.83 [%]  |  Seq Length: 256.0
[2024-09-25 20:39:25,404][root][INFO] - Step: 966/1035  |  Loss: 0.3724  |  Score: 89.52 [%]  |  Seq Length: 256.0
[2024-09-25 20:39:28,527][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-25 20:39:28,527][root][INFO] - Score: 77.26 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-25 20:39:31,493][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-25 20:39:31,493][root][INFO] - Score: 71.62 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-25 20:39:31,495][root][INFO] - 
[15/ 15 Epoch]
[2024-09-25 20:39:35,097][root][INFO] - Step: 975/1035  |  Loss: 0.3609  |  Score: 89.42 [%]  |  Seq Length: 256.0
[2024-09-25 20:39:40,619][root][INFO] - Step: 990/1035  |  Loss: 0.3308  |  Score: 91.49 [%]  |  Seq Length: 256.0
[2024-09-25 20:39:46,135][root][INFO] - Step: 1005/1035  |  Loss: 0.3568  |  Score: 89.84 [%]  |  Seq Length: 256.0
[2024-09-25 20:39:51,655][root][INFO] - Step: 1020/1035  |  Loss: 0.3325  |  Score: 89.93 [%]  |  Seq Length: 256.0
[2024-09-25 20:39:57,190][root][INFO] - Step: 1035/1035  |  Loss: 0.3641  |  Score: 88.96 [%]  |  Seq Length: 256.0
[2024-09-25 20:40:00,245][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-25 20:40:00,245][root][INFO] - Score: 78.10 [%]  |  Evaluation Time: 3.05 [s]
[2024-09-25 20:40:03,245][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-25 20:40:03,245][root][INFO] - Score: 71.31 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-25 20:40:03,246][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-25 20:40:03,246][root][INFO] - - Epoch: 6
[2024-09-25 20:40:03,246][root][INFO] - - DEV score: 77.97 [%]
[2024-09-25 20:40:03,246][root][INFO] - - TEST score: 72.64 [%]
[2024-09-25 20:40:03,247][root][INFO] - Fine-tuning is done!
[2024-09-26 09:36:33,195][root][INFO] - 

[2024-09-26 09:36:33,195][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 09:36:33,195][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_2s_0.01lr_42rs
[2024-09-26 09:36:33,195][root][INFO] - 

[2024-09-26 09:36:33,196][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 2, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_2s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_2s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_2s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 09:36:37,919][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 09:36:37,920][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 09:36:37,921][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 09:36:37,921][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 09:36:37,921][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 09:36:37,922][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 09:36:37,922][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 09:36:37,923][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 09:36:37,923][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 09:36:37,924][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 09:36:37,924][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 09:36:37,925][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 09:36:37,925][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 09:36:37,926][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 09:36:37,926][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 09:36:37,927][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 09:36:37,927][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 09:36:37,928][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 09:36:37,928][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 09:36:37,929][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 09:36:37,929][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 09:36:37,930][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 09:36:37,930][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 09:36:37,931][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 09:36:37,932][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 09:36:38,306][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 09:36:42,738][root][INFO] - 

[2024-09-26 09:36:42,738][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 09:36:42,738][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 09:36:42,749][root][INFO] - vocab size              : 51200
[2024-09-26 09:36:42,749][root][INFO] - device                  : gpu
[2024-09-26 09:36:42,749][root][INFO] - random seed             : 42
[2024-09-26 09:36:42,750][root][INFO] - train data size         : 2208
[2024-09-26 09:36:42,750][root][INFO] - max epochs              : 15
[2024-09-26 09:36:42,750][root][INFO] - total steps             : 1035
[2024-09-26 09:36:42,750][root][INFO] - warmup steps            : 104
[2024-09-26 09:36:42,750][root][INFO] - batch size              : 64
[2024-09-26 09:36:42,750][root][INFO] - accumulation steps      : 2
[2024-09-26 09:36:42,750][root][INFO] - optimizer               : adamwscale
[2024-09-26 09:36:42,750][root][INFO] - lr_scheduler            : cosine
[2024-09-26 09:36:42,750][root][INFO] - learning rate           : 0.01
[2024-09-26 09:36:42,750][root][INFO] - max length              : 256

[2024-09-26 09:36:42,750][root][INFO] - LoRA Configuration
[2024-09-26 09:36:42,751][root][INFO] - ㄴ r                    : 32
[2024-09-26 09:36:42,751][root][INFO] - ㄴ alpha                : 128
[2024-09-26 09:36:42,751][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 09:36:42,751][root][INFO] - 

[2024-09-26 09:36:42,751][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_2s_0.01lr_42rs
[2024-09-26 09:36:42,751][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_2s_0.01lr_42rs/ckpt
[2024-09-26 09:36:42,751][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_2s_0.01lr_42rs/tb
[2024-09-26 09:36:42,751][root][INFO] - * tb interval   : 15

[2024-09-26 09:36:42,751][root][INFO] - 

[2024-09-26 09:36:42,751][root][INFO] - Start the Training !
[2024-09-26 09:36:42,755][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 09:36:51,632][root][INFO] - Step: 15/1035  |  Loss: 3.3363  |  Score: 5.61 [%]  |  Seq Length: 256.0
[2024-09-26 09:36:57,380][root][INFO] - Step: 30/1035  |  Loss: 2.2877  |  Score: 19.93 [%]  |  Seq Length: 256.0
[2024-09-26 09:37:03,123][root][INFO] - Step: 45/1035  |  Loss: 2.0050  |  Score: 38.49 [%]  |  Seq Length: 256.0
[2024-09-26 09:37:08,872][root][INFO] - Step: 60/1035  |  Loss: 1.6025  |  Score: 54.56 [%]  |  Seq Length: 256.0
[2024-09-26 09:37:12,328][root][INFO] - Step: 69/1035  |  Loss: 1.3922  |  Score: 64.35 [%]  |  Seq Length: 256.0
[2024-09-26 09:37:15,613][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 09:37:15,613][root][INFO] - Score: 72.79 [%]  |  Evaluation Time: 3.28 [s]
[2024-09-26 09:37:18,674][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 09:37:18,675][root][INFO] - Score: 64.63 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-26 09:37:18,676][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 09:37:18,677][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 09:37:21,256][root][INFO] - Step: 75/1035  |  Loss: 1.4606  |  Score: 60.51 [%]  |  Seq Length: 256.0
[2024-09-26 09:37:27,017][root][INFO] - Step: 90/1035  |  Loss: 1.3517  |  Score: 64.73 [%]  |  Seq Length: 256.0
[2024-09-26 09:37:32,783][root][INFO] - Step: 105/1035  |  Loss: 1.2640  |  Score: 62.39 [%]  |  Seq Length: 256.0
[2024-09-26 09:37:38,553][root][INFO] - Step: 120/1035  |  Loss: 1.2665  |  Score: 66.27 [%]  |  Seq Length: 256.0
[2024-09-26 09:37:44,324][root][INFO] - Step: 135/1035  |  Loss: 1.2764  |  Score: 65.04 [%]  |  Seq Length: 256.0
[2024-09-26 09:37:45,510][root][INFO] - Step: 138/1035  |  Loss: 1.2290  |  Score: 70.11 [%]  |  Seq Length: 256.0
[2024-09-26 09:37:48,706][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 09:37:48,706][root][INFO] - Score: 75.20 [%]  |  Evaluation Time: 3.19 [s]
[2024-09-26 09:37:51,776][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 09:37:51,776][root][INFO] - Score: 68.87 [%]  |  Evaluation Time: 3.07 [s]
[2024-09-26 09:37:51,777][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 09:37:51,779][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 09:37:56,765][root][INFO] - Step: 150/1035  |  Loss: 1.1366  |  Score: 67.11 [%]  |  Seq Length: 256.0
[2024-09-26 09:38:02,553][root][INFO] - Step: 165/1035  |  Loss: 0.9896  |  Score: 70.96 [%]  |  Seq Length: 256.0
[2024-09-26 09:38:08,342][root][INFO] - Step: 180/1035  |  Loss: 1.0075  |  Score: 72.55 [%]  |  Seq Length: 256.0
[2024-09-26 09:38:14,126][root][INFO] - Step: 195/1035  |  Loss: 1.2036  |  Score: 70.76 [%]  |  Seq Length: 256.0
[2024-09-26 09:38:18,780][root][INFO] - Step: 207/1035  |  Loss: 1.0615  |  Score: 69.35 [%]  |  Seq Length: 256.0
[2024-09-26 09:38:21,977][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 09:38:21,977][root][INFO] - Score: 77.99 [%]  |  Evaluation Time: 3.19 [s]
[2024-09-26 09:38:25,099][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 09:38:25,099][root][INFO] - Score: 68.67 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-26 09:38:25,100][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 09:38:25,101][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 09:38:26,551][root][INFO] - Step: 210/1035  |  Loss: 1.0008  |  Score: 68.36 [%]  |  Seq Length: 256.0
[2024-09-26 09:38:32,329][root][INFO] - Step: 225/1035  |  Loss: 0.8821  |  Score: 75.41 [%]  |  Seq Length: 256.0
[2024-09-26 09:38:38,108][root][INFO] - Step: 240/1035  |  Loss: 0.8443  |  Score: 74.64 [%]  |  Seq Length: 256.0
[2024-09-26 09:38:43,872][root][INFO] - Step: 255/1035  |  Loss: 0.9798  |  Score: 72.92 [%]  |  Seq Length: 256.0
[2024-09-26 09:38:50,548][root][INFO] - Step: 270/1035  |  Loss: 0.9414  |  Score: 73.51 [%]  |  Seq Length: 256.0
[2024-09-26 09:38:54,498][root][INFO] - Step: 276/1035  |  Loss: 1.1301  |  Score: 63.54 [%]  |  Seq Length: 256.0
[2024-09-26 09:38:59,251][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 09:38:59,252][root][INFO] - Score: 75.52 [%]  |  Evaluation Time: 4.75 [s]
[2024-09-26 09:39:03,963][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 09:39:03,963][root][INFO] - Score: 69.76 [%]  |  Evaluation Time: 4.71 [s]
[2024-09-26 09:39:03,965][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 09:39:10,056][root][INFO] - Step: 285/1035  |  Loss: 0.8003  |  Score: 78.33 [%]  |  Seq Length: 256.0
[2024-09-26 09:39:19,630][root][INFO] - Step: 300/1035  |  Loss: 1.0116  |  Score: 75.71 [%]  |  Seq Length: 256.0
[2024-09-26 09:39:29,148][root][INFO] - Step: 315/1035  |  Loss: 0.9072  |  Score: 76.11 [%]  |  Seq Length: 256.0
[2024-09-26 09:39:38,847][root][INFO] - Step: 330/1035  |  Loss: 0.7546  |  Score: 79.15 [%]  |  Seq Length: 256.0
[2024-09-26 09:39:48,610][root][INFO] - Step: 345/1035  |  Loss: 0.9021  |  Score: 75.59 [%]  |  Seq Length: 256.0
[2024-09-26 09:39:53,472][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 09:39:53,472][root][INFO] - Score: 77.47 [%]  |  Evaluation Time: 4.86 [s]
[2024-09-26 09:39:58,150][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 09:39:58,150][root][INFO] - Score: 71.23 [%]  |  Evaluation Time: 4.68 [s]
[2024-09-26 09:39:58,151][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 09:39:58,152][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 09:39:59,161][root][INFO] - Step: 346/1035  |  Loss: 0.7336  |  Score: 75.37 [%]  |  Seq Length: 256.0
[2024-09-26 09:40:08,320][root][INFO] - Step: 360/1035  |  Loss: 0.7129  |  Score: 79.24 [%]  |  Seq Length: 256.0
[2024-09-26 09:40:17,921][root][INFO] - Step: 375/1035  |  Loss: 0.6870  |  Score: 81.73 [%]  |  Seq Length: 256.0
[2024-09-26 09:40:27,746][root][INFO] - Step: 390/1035  |  Loss: 0.7153  |  Score: 79.47 [%]  |  Seq Length: 256.0
[2024-09-26 09:40:37,583][root][INFO] - Step: 405/1035  |  Loss: 0.6654  |  Score: 79.18 [%]  |  Seq Length: 256.0
[2024-09-26 09:40:43,559][root][INFO] - Step: 414/1035  |  Loss: 0.6974  |  Score: 81.67 [%]  |  Seq Length: 256.0
[2024-09-26 09:40:48,488][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 09:40:48,488][root][INFO] - Score: 77.29 [%]  |  Evaluation Time: 4.93 [s]
[2024-09-26 09:40:53,083][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 09:40:53,083][root][INFO] - Score: 72.14 [%]  |  Evaluation Time: 4.59 [s]
[2024-09-26 09:40:53,084][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 09:40:53,085][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 09:40:57,483][root][INFO] - Step: 420/1035  |  Loss: 0.6532  |  Score: 79.19 [%]  |  Seq Length: 256.0
[2024-09-26 09:41:07,261][root][INFO] - Step: 435/1035  |  Loss: 0.6255  |  Score: 84.14 [%]  |  Seq Length: 256.0
[2024-09-26 09:41:16,880][root][INFO] - Step: 450/1035  |  Loss: 0.6226  |  Score: 81.20 [%]  |  Seq Length: 256.0
[2024-09-26 09:41:26,672][root][INFO] - Step: 465/1035  |  Loss: 0.6307  |  Score: 82.00 [%]  |  Seq Length: 256.0
[2024-09-26 09:41:36,351][root][INFO] - Step: 480/1035  |  Loss: 0.6531  |  Score: 79.63 [%]  |  Seq Length: 256.0
[2024-09-26 09:41:38,302][root][INFO] - Step: 483/1035  |  Loss: 0.6380  |  Score: 81.71 [%]  |  Seq Length: 256.0
[2024-09-26 09:41:42,337][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 09:41:42,338][root][INFO] - Score: 76.37 [%]  |  Evaluation Time: 4.03 [s]
[2024-09-26 09:41:45,915][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 09:41:45,915][root][INFO] - Score: 70.55 [%]  |  Evaluation Time: 3.58 [s]
[2024-09-26 09:41:45,917][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 09:41:51,628][root][INFO] - Step: 495/1035  |  Loss: 0.5421  |  Score: 83.01 [%]  |  Seq Length: 256.0
[2024-09-26 09:41:58,526][root][INFO] - Step: 510/1035  |  Loss: 0.5717  |  Score: 82.91 [%]  |  Seq Length: 256.0
[2024-09-26 09:42:05,415][root][INFO] - Step: 525/1035  |  Loss: 0.6044  |  Score: 82.17 [%]  |  Seq Length: 256.0
[2024-09-26 09:42:12,301][root][INFO] - Step: 540/1035  |  Loss: 0.5302  |  Score: 85.15 [%]  |  Seq Length: 256.0
[2024-09-26 09:42:17,827][root][INFO] - Step: 552/1035  |  Loss: 0.5487  |  Score: 83.34 [%]  |  Seq Length: 256.0
[2024-09-26 09:42:21,522][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 09:42:21,522][root][INFO] - Score: 76.64 [%]  |  Evaluation Time: 3.69 [s]
[2024-09-26 09:42:25,100][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 09:42:25,101][root][INFO] - Score: 71.82 [%]  |  Evaluation Time: 3.58 [s]
[2024-09-26 09:42:25,103][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 09:42:26,825][root][INFO] - Step: 555/1035  |  Loss: 0.4136  |  Score: 87.15 [%]  |  Seq Length: 256.0
[2024-09-26 09:42:33,639][root][INFO] - Step: 570/1035  |  Loss: 0.4625  |  Score: 86.05 [%]  |  Seq Length: 256.0
[2024-09-26 09:42:40,536][root][INFO] - Step: 585/1035  |  Loss: 0.4961  |  Score: 86.38 [%]  |  Seq Length: 256.0
[2024-09-26 09:42:47,433][root][INFO] - Step: 600/1035  |  Loss: 0.5264  |  Score: 85.60 [%]  |  Seq Length: 256.0
[2024-09-26 09:42:54,313][root][INFO] - Step: 615/1035  |  Loss: 0.5248  |  Score: 84.88 [%]  |  Seq Length: 256.0
[2024-09-26 09:42:57,097][root][INFO] - Step: 621/1035  |  Loss: 0.4986  |  Score: 84.84 [%]  |  Seq Length: 256.0
[2024-09-26 09:43:00,811][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 09:43:00,811][root][INFO] - Score: 75.67 [%]  |  Evaluation Time: 3.71 [s]
[2024-09-26 09:43:04,405][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 09:43:04,405][root][INFO] - Score: 70.38 [%]  |  Evaluation Time: 3.59 [s]
[2024-09-26 09:43:04,408][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 09:43:09,027][root][INFO] - Step: 630/1035  |  Loss: 0.4267  |  Score: 88.26 [%]  |  Seq Length: 256.0
[2024-09-26 09:43:15,855][root][INFO] - Step: 645/1035  |  Loss: 0.4484  |  Score: 87.76 [%]  |  Seq Length: 256.0
[2024-09-26 09:43:22,726][root][INFO] - Step: 660/1035  |  Loss: 0.4311  |  Score: 86.63 [%]  |  Seq Length: 256.0
[2024-09-26 09:43:29,067][root][INFO] - Step: 675/1035  |  Loss: 0.4780  |  Score: 84.76 [%]  |  Seq Length: 256.0
[2024-09-26 09:43:35,112][root][INFO] - Step: 690/1035  |  Loss: 0.4493  |  Score: 86.99 [%]  |  Seq Length: 256.0
[2024-09-26 09:43:38,335][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 09:43:38,335][root][INFO] - Score: 75.83 [%]  |  Evaluation Time: 3.22 [s]
[2024-09-26 09:43:41,399][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 09:43:41,399][root][INFO] - Score: 71.12 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-26 09:43:41,401][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 09:43:42,257][root][INFO] - Step: 691/1035  |  Loss: 0.3451  |  Score: 90.18 [%]  |  Seq Length: 256.0
[2024-09-26 09:43:47,674][root][INFO] - Step: 705/1035  |  Loss: 0.3841  |  Score: 88.50 [%]  |  Seq Length: 256.0
[2024-09-26 09:43:53,477][root][INFO] - Step: 720/1035  |  Loss: 0.4025  |  Score: 87.18 [%]  |  Seq Length: 256.0
[2024-09-26 09:43:59,270][root][INFO] - Step: 735/1035  |  Loss: 0.4149  |  Score: 87.16 [%]  |  Seq Length: 256.0
[2024-09-26 09:44:05,099][root][INFO] - Step: 750/1035  |  Loss: 0.4184  |  Score: 88.07 [%]  |  Seq Length: 256.0
[2024-09-26 09:44:09,253][root][INFO] - Step: 759/1035  |  Loss: 0.3988  |  Score: 89.00 [%]  |  Seq Length: 256.0
[2024-09-26 09:44:13,051][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 09:44:13,052][root][INFO] - Score: 76.93 [%]  |  Evaluation Time: 3.80 [s]
[2024-09-26 09:44:16,695][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 09:44:16,695][root][INFO] - Score: 70.18 [%]  |  Evaluation Time: 3.64 [s]
[2024-09-26 09:44:16,698][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 09:44:19,780][root][INFO] - Step: 765/1035  |  Loss: 0.3956  |  Score: 87.52 [%]  |  Seq Length: 256.0
[2024-09-26 09:44:26,656][root][INFO] - Step: 780/1035  |  Loss: 0.3680  |  Score: 89.83 [%]  |  Seq Length: 256.0
[2024-09-26 09:44:33,443][root][INFO] - Step: 795/1035  |  Loss: 0.3481  |  Score: 89.84 [%]  |  Seq Length: 256.0
[2024-09-26 09:44:40,340][root][INFO] - Step: 810/1035  |  Loss: 0.3741  |  Score: 89.40 [%]  |  Seq Length: 256.0
[2024-09-26 09:44:47,233][root][INFO] - Step: 825/1035  |  Loss: 0.3849  |  Score: 88.21 [%]  |  Seq Length: 256.0
[2024-09-26 09:44:48,642][root][INFO] - Step: 828/1035  |  Loss: 0.3943  |  Score: 88.47 [%]  |  Seq Length: 256.0
[2024-09-26 09:44:52,336][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 09:44:52,336][root][INFO] - Score: 77.07 [%]  |  Evaluation Time: 3.69 [s]
[2024-09-26 09:44:55,882][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 09:44:55,882][root][INFO] - Score: 71.16 [%]  |  Evaluation Time: 3.54 [s]
[2024-09-26 09:44:55,884][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 09:45:01,840][root][INFO] - Step: 840/1035  |  Loss: 0.3461  |  Score: 89.28 [%]  |  Seq Length: 256.0
[2024-09-26 09:45:08,733][root][INFO] - Step: 855/1035  |  Loss: 0.3513  |  Score: 89.09 [%]  |  Seq Length: 256.0
[2024-09-26 09:45:15,526][root][INFO] - Step: 870/1035  |  Loss: 0.3614  |  Score: 88.82 [%]  |  Seq Length: 256.0
[2024-09-26 09:45:22,416][root][INFO] - Step: 885/1035  |  Loss: 0.3509  |  Score: 89.06 [%]  |  Seq Length: 256.0
[2024-09-26 09:45:27,936][root][INFO] - Step: 897/1035  |  Loss: 0.3868  |  Score: 88.56 [%]  |  Seq Length: 256.0
[2024-09-26 09:45:31,634][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 09:45:31,634][root][INFO] - Score: 77.29 [%]  |  Evaluation Time: 3.70 [s]
[2024-09-26 09:45:35,191][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 09:45:35,191][root][INFO] - Score: 70.25 [%]  |  Evaluation Time: 3.55 [s]
[2024-09-26 09:45:35,193][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 09:45:36,918][root][INFO] - Step: 900/1035  |  Loss: 0.3321  |  Score: 86.62 [%]  |  Seq Length: 256.0
[2024-09-26 09:45:43,806][root][INFO] - Step: 915/1035  |  Loss: 0.3885  |  Score: 88.86 [%]  |  Seq Length: 256.0
[2024-09-26 09:45:50,692][root][INFO] - Step: 930/1035  |  Loss: 0.3572  |  Score: 88.54 [%]  |  Seq Length: 256.0
[2024-09-26 09:45:57,514][root][INFO] - Step: 945/1035  |  Loss: 0.3320  |  Score: 90.08 [%]  |  Seq Length: 256.0
[2024-09-26 09:46:04,403][root][INFO] - Step: 960/1035  |  Loss: 0.3611  |  Score: 88.79 [%]  |  Seq Length: 256.0
[2024-09-26 09:46:07,180][root][INFO] - Step: 966/1035  |  Loss: 0.3521  |  Score: 89.59 [%]  |  Seq Length: 256.0
[2024-09-26 09:46:10,989][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 09:46:10,990][root][INFO] - Score: 76.14 [%]  |  Evaluation Time: 3.81 [s]
[2024-09-26 09:46:14,612][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 09:46:14,612][root][INFO] - Score: 71.23 [%]  |  Evaluation Time: 3.62 [s]
[2024-09-26 09:46:14,614][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 09:46:19,113][root][INFO] - Step: 975/1035  |  Loss: 0.3068  |  Score: 90.22 [%]  |  Seq Length: 256.0
[2024-09-26 09:46:26,009][root][INFO] - Step: 990/1035  |  Loss: 0.3133  |  Score: 91.24 [%]  |  Seq Length: 256.0
[2024-09-26 09:46:32,826][root][INFO] - Step: 1005/1035  |  Loss: 0.3653  |  Score: 89.05 [%]  |  Seq Length: 256.0
[2024-09-26 09:46:39,722][root][INFO] - Step: 1020/1035  |  Loss: 0.3365  |  Score: 89.84 [%]  |  Seq Length: 256.0
[2024-09-26 09:46:46,608][root][INFO] - Step: 1035/1035  |  Loss: 0.3417  |  Score: 88.94 [%]  |  Seq Length: 256.0
[2024-09-26 09:46:50,316][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 09:46:50,316][root][INFO] - Score: 76.79 [%]  |  Evaluation Time: 3.70 [s]
[2024-09-26 09:46:53,919][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 09:46:53,919][root][INFO] - Score: 70.00 [%]  |  Evaluation Time: 3.60 [s]
[2024-09-26 09:46:53,920][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 09:46:53,920][root][INFO] - - Epoch: 6
[2024-09-26 09:46:53,920][root][INFO] - - DEV score: 77.29 [%]
[2024-09-26 09:46:53,920][root][INFO] - - TEST score: 72.14 [%]
[2024-09-26 09:46:53,921][root][INFO] - Fine-tuning is done!
[2024-09-26 10:40:33,052][root][INFO] - 

[2024-09-26 10:40:33,052][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 10:40:33,052][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_2s_0.01lr_42rs
[2024-09-26 10:40:33,052][root][INFO] - 

[2024-09-26 10:40:33,052][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 2, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_2s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_2s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_2s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 10:40:37,505][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 10:40:37,506][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 10:40:37,506][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 10:40:37,507][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 10:40:37,507][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 10:40:37,508][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 10:40:37,508][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 10:40:37,508][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 10:40:37,509][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 10:40:37,509][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 10:40:37,510][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 10:40:37,511][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 10:40:37,511][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 10:40:37,512][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 10:40:37,512][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 10:40:37,513][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 10:40:37,513][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 10:40:37,514][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 10:40:37,514][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 10:40:37,514][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 10:40:37,515][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 10:40:37,515][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 10:40:37,516][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 10:40:37,516][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 10:40:37,519][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 10:40:37,708][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 10:40:42,032][root][INFO] - 

[2024-09-26 10:40:42,033][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 10:40:42,033][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 10:40:42,041][root][INFO] - vocab size              : 51200
[2024-09-26 10:40:42,041][root][INFO] - device                  : gpu
[2024-09-26 10:40:42,041][root][INFO] - random seed             : 42
[2024-09-26 10:40:42,041][root][INFO] - train data size         : 2208
[2024-09-26 10:40:42,041][root][INFO] - max epochs              : 15
[2024-09-26 10:40:42,041][root][INFO] - total steps             : 1035
[2024-09-26 10:40:42,041][root][INFO] - warmup steps            : 104
[2024-09-26 10:40:42,041][root][INFO] - batch size              : 64
[2024-09-26 10:40:42,042][root][INFO] - accumulation steps      : 2
[2024-09-26 10:40:42,042][root][INFO] - optimizer               : adamwscale
[2024-09-26 10:40:42,042][root][INFO] - lr_scheduler            : cosine
[2024-09-26 10:40:42,042][root][INFO] - learning rate           : 0.01
[2024-09-26 10:40:42,042][root][INFO] - max length              : 256

[2024-09-26 10:40:42,042][root][INFO] - LoRA Configuration
[2024-09-26 10:40:42,042][root][INFO] - ㄴ r                    : 32
[2024-09-26 10:40:42,042][root][INFO] - ㄴ alpha                : 128
[2024-09-26 10:40:42,042][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 10:40:42,042][root][INFO] - 

[2024-09-26 10:40:42,042][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_2s_0.01lr_42rs
[2024-09-26 10:40:42,042][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_2s_0.01lr_42rs/ckpt
[2024-09-26 10:40:42,043][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_2s_0.01lr_42rs/tb
[2024-09-26 10:40:42,043][root][INFO] - * tb interval   : 15

[2024-09-26 10:40:42,043][root][INFO] - 

[2024-09-26 10:40:42,043][root][INFO] - Start the Training !
[2024-09-26 10:40:42,046][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 10:40:50,797][root][INFO] - Step: 15/1035  |  Loss: 3.3363  |  Score: 5.61 [%]  |  Seq Length: 256.0
[2024-09-26 10:40:56,528][root][INFO] - Step: 30/1035  |  Loss: 2.2877  |  Score: 19.93 [%]  |  Seq Length: 256.0
[2024-09-26 10:41:02,280][root][INFO] - Step: 45/1035  |  Loss: 2.0050  |  Score: 38.49 [%]  |  Seq Length: 256.0
[2024-09-26 10:41:08,385][root][INFO] - Step: 60/1035  |  Loss: 1.6025  |  Score: 54.56 [%]  |  Seq Length: 256.0
[2024-09-26 10:41:12,431][root][INFO] - Step: 69/1035  |  Loss: 1.3922  |  Score: 64.35 [%]  |  Seq Length: 256.0
[2024-09-26 10:41:16,097][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 10:41:16,097][root][INFO] - Score: 72.79 [%]  |  Evaluation Time: 3.66 [s]
[2024-09-26 10:41:19,730][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 10:41:19,730][root][INFO] - Score: 64.63 [%]  |  Evaluation Time: 3.63 [s]
[2024-09-26 10:41:19,731][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 10:41:19,733][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 10:41:22,752][root][INFO] - Step: 75/1035  |  Loss: 1.4606  |  Score: 60.51 [%]  |  Seq Length: 256.0
[2024-09-26 10:41:29,616][root][INFO] - Step: 90/1035  |  Loss: 1.3517  |  Score: 64.73 [%]  |  Seq Length: 256.0
[2024-09-26 10:41:36,477][root][INFO] - Step: 105/1035  |  Loss: 1.2640  |  Score: 62.39 [%]  |  Seq Length: 256.0
[2024-09-26 10:41:43,339][root][INFO] - Step: 120/1035  |  Loss: 1.2665  |  Score: 66.27 [%]  |  Seq Length: 256.0
[2024-09-26 10:41:50,198][root][INFO] - Step: 135/1035  |  Loss: 1.2764  |  Score: 65.04 [%]  |  Seq Length: 256.0
[2024-09-26 10:41:51,590][root][INFO] - Step: 138/1035  |  Loss: 1.2290  |  Score: 70.11 [%]  |  Seq Length: 256.0
[2024-09-26 10:41:55,232][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 10:41:55,233][root][INFO] - Score: 75.20 [%]  |  Evaluation Time: 3.64 [s]
[2024-09-26 10:41:58,825][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 10:41:58,825][root][INFO] - Score: 68.87 [%]  |  Evaluation Time: 3.59 [s]
[2024-09-26 10:41:58,826][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 10:41:58,827][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 10:42:04,621][root][INFO] - Step: 150/1035  |  Loss: 1.1366  |  Score: 67.11 [%]  |  Seq Length: 256.0
[2024-09-26 10:42:11,481][root][INFO] - Step: 165/1035  |  Loss: 0.9896  |  Score: 70.96 [%]  |  Seq Length: 256.0
[2024-09-26 10:42:18,353][root][INFO] - Step: 180/1035  |  Loss: 1.0075  |  Score: 72.55 [%]  |  Seq Length: 256.0
[2024-09-26 10:42:25,235][root][INFO] - Step: 195/1035  |  Loss: 1.2036  |  Score: 70.76 [%]  |  Seq Length: 256.0
[2024-09-26 10:42:30,738][root][INFO] - Step: 207/1035  |  Loss: 1.0615  |  Score: 69.35 [%]  |  Seq Length: 256.0
[2024-09-26 10:42:34,409][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 10:42:34,409][root][INFO] - Score: 77.99 [%]  |  Evaluation Time: 3.67 [s]
[2024-09-26 10:42:38,004][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 10:42:38,004][root][INFO] - Score: 68.67 [%]  |  Evaluation Time: 3.59 [s]
[2024-09-26 10:42:38,006][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 10:42:38,008][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 10:42:39,753][root][INFO] - Step: 210/1035  |  Loss: 1.0008  |  Score: 68.36 [%]  |  Seq Length: 256.0
[2024-09-26 10:42:46,635][root][INFO] - Step: 225/1035  |  Loss: 0.8821  |  Score: 75.41 [%]  |  Seq Length: 256.0
[2024-09-26 10:42:53,516][root][INFO] - Step: 240/1035  |  Loss: 0.8443  |  Score: 74.64 [%]  |  Seq Length: 256.0
[2024-09-26 10:43:00,396][root][INFO] - Step: 255/1035  |  Loss: 0.9798  |  Score: 72.92 [%]  |  Seq Length: 256.0
[2024-09-26 10:43:07,272][root][INFO] - Step: 270/1035  |  Loss: 0.9414  |  Score: 73.51 [%]  |  Seq Length: 256.0
[2024-09-26 10:43:10,049][root][INFO] - Step: 276/1035  |  Loss: 1.1301  |  Score: 63.54 [%]  |  Seq Length: 256.0
[2024-09-26 10:43:13,736][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 10:43:13,736][root][INFO] - Score: 75.52 [%]  |  Evaluation Time: 3.68 [s]
[2024-09-26 10:43:17,290][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 10:43:17,290][root][INFO] - Score: 69.76 [%]  |  Evaluation Time: 3.55 [s]
[2024-09-26 10:43:17,292][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 10:43:21,716][root][INFO] - Step: 285/1035  |  Loss: 0.8003  |  Score: 78.33 [%]  |  Seq Length: 256.0
[2024-09-26 10:43:28,599][root][INFO] - Step: 300/1035  |  Loss: 1.0116  |  Score: 75.71 [%]  |  Seq Length: 256.0
[2024-09-26 10:43:35,480][root][INFO] - Step: 315/1035  |  Loss: 0.9072  |  Score: 76.11 [%]  |  Seq Length: 256.0
[2024-09-26 10:43:42,358][root][INFO] - Step: 330/1035  |  Loss: 0.7546  |  Score: 79.15 [%]  |  Seq Length: 256.0
[2024-09-26 10:43:49,231][root][INFO] - Step: 345/1035  |  Loss: 0.9021  |  Score: 75.59 [%]  |  Seq Length: 256.0
[2024-09-26 10:43:52,902][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 10:43:52,902][root][INFO] - Score: 77.47 [%]  |  Evaluation Time: 3.67 [s]
[2024-09-26 10:43:56,438][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 10:43:56,438][root][INFO] - Score: 71.23 [%]  |  Evaluation Time: 3.53 [s]
[2024-09-26 10:43:56,439][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 10:43:56,440][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 10:43:57,292][root][INFO] - Step: 346/1035  |  Loss: 0.7336  |  Score: 75.37 [%]  |  Seq Length: 256.0
[2024-09-26 10:44:03,635][root][INFO] - Step: 360/1035  |  Loss: 0.7129  |  Score: 79.24 [%]  |  Seq Length: 256.0
[2024-09-26 10:44:10,520][root][INFO] - Step: 375/1035  |  Loss: 0.6870  |  Score: 81.73 [%]  |  Seq Length: 256.0
[2024-09-26 10:44:17,389][root][INFO] - Step: 390/1035  |  Loss: 0.7153  |  Score: 79.47 [%]  |  Seq Length: 256.0
[2024-09-26 10:44:24,250][root][INFO] - Step: 405/1035  |  Loss: 0.6654  |  Score: 79.18 [%]  |  Seq Length: 256.0
[2024-09-26 10:44:28,387][root][INFO] - Step: 414/1035  |  Loss: 0.6974  |  Score: 81.67 [%]  |  Seq Length: 256.0
[2024-09-26 10:44:32,108][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 10:44:32,108][root][INFO] - Score: 77.29 [%]  |  Evaluation Time: 3.72 [s]
[2024-09-26 10:44:35,752][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 10:44:35,752][root][INFO] - Score: 72.14 [%]  |  Evaluation Time: 3.64 [s]
[2024-09-26 10:44:35,753][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 10:44:35,754][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 10:44:38,554][root][INFO] - Step: 420/1035  |  Loss: 0.6532  |  Score: 79.19 [%]  |  Seq Length: 256.0
[2024-09-26 10:44:45,011][root][INFO] - Step: 435/1035  |  Loss: 0.6255  |  Score: 84.14 [%]  |  Seq Length: 256.0
[2024-09-26 10:44:51,312][root][INFO] - Step: 450/1035  |  Loss: 0.6226  |  Score: 81.20 [%]  |  Seq Length: 256.0
[2024-09-26 10:44:57,104][root][INFO] - Step: 465/1035  |  Loss: 0.6307  |  Score: 82.00 [%]  |  Seq Length: 256.0
[2024-09-26 10:45:02,903][root][INFO] - Step: 480/1035  |  Loss: 0.6531  |  Score: 79.63 [%]  |  Seq Length: 256.0
[2024-09-26 10:45:04,102][root][INFO] - Step: 483/1035  |  Loss: 0.6380  |  Score: 81.71 [%]  |  Seq Length: 256.0
[2024-09-26 10:45:07,349][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 10:45:07,349][root][INFO] - Score: 76.37 [%]  |  Evaluation Time: 3.24 [s]
[2024-09-26 10:45:10,569][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 10:45:10,569][root][INFO] - Score: 70.55 [%]  |  Evaluation Time: 3.22 [s]
[2024-09-26 10:45:10,571][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 10:45:15,496][root][INFO] - Step: 495/1035  |  Loss: 0.5421  |  Score: 83.01 [%]  |  Seq Length: 256.0
[2024-09-26 10:45:21,286][root][INFO] - Step: 510/1035  |  Loss: 0.5717  |  Score: 82.91 [%]  |  Seq Length: 256.0
[2024-09-26 10:45:27,076][root][INFO] - Step: 525/1035  |  Loss: 0.6044  |  Score: 82.17 [%]  |  Seq Length: 256.0
[2024-09-26 10:45:32,871][root][INFO] - Step: 540/1035  |  Loss: 0.5302  |  Score: 85.15 [%]  |  Seq Length: 256.0
[2024-09-26 10:45:37,529][root][INFO] - Step: 552/1035  |  Loss: 0.5487  |  Score: 83.34 [%]  |  Seq Length: 256.0
[2024-09-26 10:45:40,862][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 10:45:40,862][root][INFO] - Score: 76.64 [%]  |  Evaluation Time: 3.33 [s]
[2024-09-26 10:45:44,067][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 10:45:44,068][root][INFO] - Score: 71.82 [%]  |  Evaluation Time: 3.20 [s]
[2024-09-26 10:45:44,070][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 10:45:45,510][root][INFO] - Step: 555/1035  |  Loss: 0.4136  |  Score: 87.15 [%]  |  Seq Length: 256.0
[2024-09-26 10:45:51,306][root][INFO] - Step: 570/1035  |  Loss: 0.4625  |  Score: 86.05 [%]  |  Seq Length: 256.0
[2024-09-26 10:45:57,119][root][INFO] - Step: 585/1035  |  Loss: 0.4961  |  Score: 86.38 [%]  |  Seq Length: 256.0
[2024-09-26 10:46:02,913][root][INFO] - Step: 600/1035  |  Loss: 0.5264  |  Score: 85.60 [%]  |  Seq Length: 256.0
[2024-09-26 10:46:08,710][root][INFO] - Step: 615/1035  |  Loss: 0.5248  |  Score: 84.88 [%]  |  Seq Length: 256.0
[2024-09-26 10:46:11,050][root][INFO] - Step: 621/1035  |  Loss: 0.4986  |  Score: 84.84 [%]  |  Seq Length: 256.0
[2024-09-26 10:46:14,424][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 10:46:14,424][root][INFO] - Score: 75.67 [%]  |  Evaluation Time: 3.37 [s]
[2024-09-26 10:46:17,617][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 10:46:17,617][root][INFO] - Score: 70.38 [%]  |  Evaluation Time: 3.19 [s]
[2024-09-26 10:46:17,619][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 10:46:21,565][root][INFO] - Step: 630/1035  |  Loss: 0.4267  |  Score: 88.26 [%]  |  Seq Length: 256.0
[2024-09-26 10:46:27,381][root][INFO] - Step: 645/1035  |  Loss: 0.4484  |  Score: 87.76 [%]  |  Seq Length: 256.0
[2024-09-26 10:46:33,192][root][INFO] - Step: 660/1035  |  Loss: 0.4311  |  Score: 86.63 [%]  |  Seq Length: 256.0
[2024-09-26 10:46:38,999][root][INFO] - Step: 675/1035  |  Loss: 0.4780  |  Score: 84.76 [%]  |  Seq Length: 256.0
[2024-09-26 10:46:44,841][root][INFO] - Step: 690/1035  |  Loss: 0.4493  |  Score: 86.99 [%]  |  Seq Length: 256.0
[2024-09-26 10:46:47,992][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 10:46:47,992][root][INFO] - Score: 75.83 [%]  |  Evaluation Time: 3.15 [s]
[2024-09-26 10:46:51,166][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 10:46:51,166][root][INFO] - Score: 71.12 [%]  |  Evaluation Time: 3.17 [s]
[2024-09-26 10:46:51,168][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 10:46:51,849][root][INFO] - Step: 691/1035  |  Loss: 0.3451  |  Score: 90.18 [%]  |  Seq Length: 256.0
[2024-09-26 10:46:57,261][root][INFO] - Step: 705/1035  |  Loss: 0.3841  |  Score: 88.50 [%]  |  Seq Length: 256.0
[2024-09-26 10:47:03,061][root][INFO] - Step: 720/1035  |  Loss: 0.4025  |  Score: 87.18 [%]  |  Seq Length: 256.0
[2024-09-26 10:47:10,652][root][INFO] - Step: 735/1035  |  Loss: 0.4149  |  Score: 87.16 [%]  |  Seq Length: 256.0
[2024-09-26 10:47:20,070][root][INFO] - Step: 750/1035  |  Loss: 0.4184  |  Score: 88.07 [%]  |  Seq Length: 256.0
[2024-09-26 10:47:25,815][root][INFO] - Step: 759/1035  |  Loss: 0.3988  |  Score: 89.00 [%]  |  Seq Length: 256.0
[2024-09-26 10:47:30,479][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 10:47:30,479][root][INFO] - Score: 76.93 [%]  |  Evaluation Time: 4.66 [s]
[2024-09-26 10:47:35,043][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 10:47:35,043][root][INFO] - Score: 70.18 [%]  |  Evaluation Time: 4.56 [s]
[2024-09-26 10:47:35,045][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 10:47:39,083][root][INFO] - Step: 765/1035  |  Loss: 0.3956  |  Score: 87.52 [%]  |  Seq Length: 256.0
[2024-09-26 10:47:48,672][root][INFO] - Step: 780/1035  |  Loss: 0.3680  |  Score: 89.83 [%]  |  Seq Length: 256.0
[2024-09-26 10:47:58,259][root][INFO] - Step: 795/1035  |  Loss: 0.3481  |  Score: 89.84 [%]  |  Seq Length: 256.0
[2024-09-26 10:48:07,610][root][INFO] - Step: 810/1035  |  Loss: 0.3741  |  Score: 89.40 [%]  |  Seq Length: 256.0
[2024-09-26 10:48:17,192][root][INFO] - Step: 825/1035  |  Loss: 0.3849  |  Score: 88.21 [%]  |  Seq Length: 256.0
[2024-09-26 10:48:19,133][root][INFO] - Step: 828/1035  |  Loss: 0.3943  |  Score: 88.47 [%]  |  Seq Length: 256.0
[2024-09-26 10:48:23,883][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 10:48:23,883][root][INFO] - Score: 77.07 [%]  |  Evaluation Time: 4.75 [s]
[2024-09-26 10:48:28,515][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 10:48:28,515][root][INFO] - Score: 71.16 [%]  |  Evaluation Time: 4.63 [s]
[2024-09-26 10:48:28,517][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 10:48:36,286][root][INFO] - Step: 840/1035  |  Loss: 0.3461  |  Score: 89.28 [%]  |  Seq Length: 256.0
[2024-09-26 10:48:45,723][root][INFO] - Step: 855/1035  |  Loss: 0.3513  |  Score: 89.09 [%]  |  Seq Length: 256.0
[2024-09-26 10:48:55,200][root][INFO] - Step: 870/1035  |  Loss: 0.3614  |  Score: 88.82 [%]  |  Seq Length: 256.0
[2024-09-26 10:49:04,750][root][INFO] - Step: 885/1035  |  Loss: 0.3509  |  Score: 89.06 [%]  |  Seq Length: 256.0
[2024-09-26 10:49:12,335][root][INFO] - Step: 897/1035  |  Loss: 0.3868  |  Score: 88.56 [%]  |  Seq Length: 256.0
[2024-09-26 10:49:17,172][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 10:49:17,172][root][INFO] - Score: 77.29 [%]  |  Evaluation Time: 4.83 [s]
[2024-09-26 10:49:21,729][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 10:49:21,729][root][INFO] - Score: 70.25 [%]  |  Evaluation Time: 4.55 [s]
[2024-09-26 10:49:21,731][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 10:49:24,011][root][INFO] - Step: 900/1035  |  Loss: 0.3321  |  Score: 86.62 [%]  |  Seq Length: 256.0
[2024-09-26 10:49:33,459][root][INFO] - Step: 915/1035  |  Loss: 0.3885  |  Score: 88.86 [%]  |  Seq Length: 256.0
[2024-09-26 10:49:43,065][root][INFO] - Step: 930/1035  |  Loss: 0.3572  |  Score: 88.54 [%]  |  Seq Length: 256.0
[2024-09-26 10:49:52,424][root][INFO] - Step: 945/1035  |  Loss: 0.3320  |  Score: 90.08 [%]  |  Seq Length: 256.0
[2024-09-26 10:50:01,951][root][INFO] - Step: 960/1035  |  Loss: 0.3611  |  Score: 88.79 [%]  |  Seq Length: 256.0
[2024-09-26 10:50:05,702][root][INFO] - Step: 966/1035  |  Loss: 0.3521  |  Score: 89.59 [%]  |  Seq Length: 256.0
[2024-09-26 10:50:09,588][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 10:50:09,589][root][INFO] - Score: 76.14 [%]  |  Evaluation Time: 3.88 [s]
[2024-09-26 10:50:13,072][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 10:50:13,073][root][INFO] - Score: 71.23 [%]  |  Evaluation Time: 3.48 [s]
[2024-09-26 10:50:13,077][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 10:50:17,637][root][INFO] - Step: 975/1035  |  Loss: 0.3068  |  Score: 90.22 [%]  |  Seq Length: 256.0
[2024-09-26 10:50:24,551][root][INFO] - Step: 990/1035  |  Loss: 0.3133  |  Score: 91.24 [%]  |  Seq Length: 256.0
[2024-09-26 10:50:31,468][root][INFO] - Step: 1005/1035  |  Loss: 0.3653  |  Score: 89.05 [%]  |  Seq Length: 256.0
[2024-09-26 10:50:38,373][root][INFO] - Step: 1020/1035  |  Loss: 0.3365  |  Score: 89.84 [%]  |  Seq Length: 256.0
[2024-09-26 10:50:45,277][root][INFO] - Step: 1035/1035  |  Loss: 0.3417  |  Score: 88.94 [%]  |  Seq Length: 256.0
[2024-09-26 10:50:48,962][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 10:50:48,962][root][INFO] - Score: 76.79 [%]  |  Evaluation Time: 3.68 [s]
[2024-09-26 10:50:52,556][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 10:50:52,556][root][INFO] - Score: 70.00 [%]  |  Evaluation Time: 3.59 [s]
[2024-09-26 10:50:52,557][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 10:50:52,557][root][INFO] - - Epoch: 6
[2024-09-26 10:50:52,557][root][INFO] - - DEV score: 77.29 [%]
[2024-09-26 10:50:52,558][root][INFO] - - TEST score: 72.14 [%]
[2024-09-26 10:50:52,558][root][INFO] - Fine-tuning is done!
[2024-09-26 11:26:30,640][root][INFO] - 

[2024-09-26 11:26:30,640][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 11:26:30,640][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_2s_0.01lr_42rs
[2024-09-26 11:26:30,640][root][INFO] - 

[2024-09-26 11:26:30,641][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 128, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 2, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_2s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_2s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_2s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 11:26:34,894][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 11:26:34,895][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 11:26:34,896][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 11:26:34,896][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 11:26:34,897][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 11:26:34,897][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 11:26:34,898][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 11:26:34,898][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 11:26:34,899][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 11:26:34,899][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 11:26:34,900][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 11:26:34,901][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 11:26:34,901][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 11:26:34,902][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 11:26:34,902][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 11:26:34,903][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 11:26:34,903][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 11:26:34,904][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 11:26:34,905][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 11:26:34,905][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 11:26:34,906][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 11:26:34,906][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 11:26:34,907][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 11:26:34,908][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 11:26:34,909][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 11:26:44,998][root][INFO] - 

[2024-09-26 11:26:44,998][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 11:26:44,998][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_1s_0.01lr_42rs
[2024-09-26 11:26:44,998][root][INFO] - 

[2024-09-26 11:26:44,999][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 128, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 11:26:49,551][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 11:26:49,552][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 11:26:49,552][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 11:26:49,553][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 11:26:49,553][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 11:26:49,553][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 11:26:49,554][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 11:26:49,554][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 11:26:49,555][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 11:26:49,555][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 11:26:49,556][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 11:26:49,556][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 11:26:49,557][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 11:26:49,557][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 11:26:49,557][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 11:26:49,558][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 11:26:49,558][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 11:26:49,559][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 11:26:49,559][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 11:26:49,560][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 11:26:49,560][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 11:26:49,560][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 11:26:49,561][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 11:26:49,561][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 11:26:49,563][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 11:26:49,994][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 11:26:53,879][root][INFO] - 

[2024-09-26 11:26:53,879][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 11:26:53,879][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 11:26:53,887][root][INFO] - vocab size              : 51200
[2024-09-26 11:26:53,887][root][INFO] - device                  : gpu
[2024-09-26 11:26:53,887][root][INFO] - random seed             : 42
[2024-09-26 11:26:53,888][root][INFO] - train data size         : 4416
[2024-09-26 11:26:53,888][root][INFO] - max epochs              : 15
[2024-09-26 11:26:53,888][root][INFO] - total steps             : 1035
[2024-09-26 11:26:53,888][root][INFO] - warmup steps            : 104
[2024-09-26 11:26:53,888][root][INFO] - batch size              : 64
[2024-09-26 11:26:53,888][root][INFO] - accumulation steps      : 1
[2024-09-26 11:26:53,888][root][INFO] - optimizer               : adamwscale
[2024-09-26 11:26:53,888][root][INFO] - lr_scheduler            : cosine
[2024-09-26 11:26:53,888][root][INFO] - learning rate           : 0.01
[2024-09-26 11:26:53,888][root][INFO] - max length              : 128

[2024-09-26 11:26:53,888][root][INFO] - LoRA Configuration
[2024-09-26 11:26:53,888][root][INFO] - ㄴ r                    : 32
[2024-09-26 11:26:53,889][root][INFO] - ㄴ alpha                : 128
[2024-09-26 11:26:53,889][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 11:26:53,889][root][INFO] - 

[2024-09-26 11:26:53,889][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_1s_0.01lr_42rs
[2024-09-26 11:26:53,889][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 11:26:53,889][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_1s_0.01lr_42rs/tb
[2024-09-26 11:26:53,889][root][INFO] - * tb interval   : 15

[2024-09-26 11:26:53,889][root][INFO] - 

[2024-09-26 11:26:53,889][root][INFO] - Start the Training !
[2024-09-26 11:26:53,892][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 11:26:59,310][root][INFO] - Step: 15/1035  |  Loss: 3.2679  |  Score: 5.38 [%]  |  Seq Length: 128.0
[2024-09-26 11:27:01,960][root][INFO] - Step: 30/1035  |  Loss: 2.3142  |  Score: 19.85 [%]  |  Seq Length: 128.0
[2024-09-26 11:27:04,605][root][INFO] - Step: 45/1035  |  Loss: 1.9709  |  Score: 39.07 [%]  |  Seq Length: 128.0
[2024-09-26 11:27:07,243][root][INFO] - Step: 60/1035  |  Loss: 1.6406  |  Score: 55.13 [%]  |  Seq Length: 128.0
[2024-09-26 11:27:08,894][root][INFO] - Step: 69/1035  |  Loss: 1.4035  |  Score: 63.23 [%]  |  Seq Length: 128.0
[2024-09-26 11:27:10,726][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 11:27:10,726][root][INFO] - Score: 74.07 [%]  |  Evaluation Time: 1.83 [s]
[2024-09-26 11:27:12,345][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 11:27:12,346][root][INFO] - Score: 65.69 [%]  |  Evaluation Time: 1.62 [s]
[2024-09-26 11:27:12,346][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 11:27:12,348][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 11:27:13,792][root][INFO] - Step: 75/1035  |  Loss: 1.2955  |  Score: 65.45 [%]  |  Seq Length: 128.0
[2024-09-26 11:27:16,432][root][INFO] - Step: 90/1035  |  Loss: 1.3435  |  Score: 64.20 [%]  |  Seq Length: 128.0
[2024-09-26 11:27:19,073][root][INFO] - Step: 105/1035  |  Loss: 1.3460  |  Score: 62.37 [%]  |  Seq Length: 128.0
[2024-09-26 11:27:21,715][root][INFO] - Step: 120/1035  |  Loss: 1.4284  |  Score: 65.64 [%]  |  Seq Length: 128.0
[2024-09-26 11:27:24,357][root][INFO] - Step: 135/1035  |  Loss: 1.3037  |  Score: 68.09 [%]  |  Seq Length: 128.0
[2024-09-26 11:27:24,978][root][INFO] - Step: 138/1035  |  Loss: 1.3565  |  Score: 67.25 [%]  |  Seq Length: 128.0
[2024-09-26 11:27:26,838][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 11:27:26,838][root][INFO] - Score: 74.90 [%]  |  Evaluation Time: 1.86 [s]
[2024-09-26 11:27:28,549][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 11:27:28,550][root][INFO] - Score: 67.66 [%]  |  Evaluation Time: 1.71 [s]
[2024-09-26 11:27:28,551][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 11:27:28,552][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 11:27:31,007][root][INFO] - Step: 150/1035  |  Loss: 1.2015  |  Score: 65.65 [%]  |  Seq Length: 128.0
[2024-09-26 11:27:33,656][root][INFO] - Step: 165/1035  |  Loss: 1.0444  |  Score: 70.73 [%]  |  Seq Length: 128.0
[2024-09-26 11:27:36,309][root][INFO] - Step: 180/1035  |  Loss: 0.9929  |  Score: 71.90 [%]  |  Seq Length: 128.0
[2024-09-26 11:27:38,971][root][INFO] - Step: 195/1035  |  Loss: 1.1398  |  Score: 72.24 [%]  |  Seq Length: 128.0
[2024-09-26 11:27:41,178][root][INFO] - Step: 207/1035  |  Loss: 1.0311  |  Score: 71.20 [%]  |  Seq Length: 128.0
[2024-09-26 11:27:42,931][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 11:27:42,931][root][INFO] - Score: 78.01 [%]  |  Evaluation Time: 1.75 [s]
[2024-09-26 11:27:44,800][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 11:27:44,800][root][INFO] - Score: 69.48 [%]  |  Evaluation Time: 1.87 [s]
[2024-09-26 11:27:44,802][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 11:27:44,803][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 11:27:45,649][root][INFO] - Step: 210/1035  |  Loss: 0.9842  |  Score: 74.56 [%]  |  Seq Length: 128.0
[2024-09-26 11:27:48,336][root][INFO] - Step: 225/1035  |  Loss: 0.9329  |  Score: 74.41 [%]  |  Seq Length: 128.0
[2024-09-26 11:27:51,041][root][INFO] - Step: 240/1035  |  Loss: 0.8423  |  Score: 75.56 [%]  |  Seq Length: 128.0
[2024-09-26 11:27:53,695][root][INFO] - Step: 255/1035  |  Loss: 0.8624  |  Score: 76.33 [%]  |  Seq Length: 128.0
[2024-09-26 11:27:56,344][root][INFO] - Step: 270/1035  |  Loss: 0.9850  |  Score: 75.71 [%]  |  Seq Length: 128.0
[2024-09-26 11:27:57,486][root][INFO] - Step: 276/1035  |  Loss: 1.1556  |  Score: 67.19 [%]  |  Seq Length: 128.0
[2024-09-26 11:27:59,158][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 11:27:59,158][root][INFO] - Score: 77.37 [%]  |  Evaluation Time: 1.67 [s]
[2024-09-26 11:28:00,845][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 11:28:00,845][root][INFO] - Score: 69.33 [%]  |  Evaluation Time: 1.69 [s]
[2024-09-26 11:28:00,847][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 11:28:02,733][root][INFO] - Step: 285/1035  |  Loss: 0.9137  |  Score: 79.00 [%]  |  Seq Length: 128.0
[2024-09-26 11:28:05,389][root][INFO] - Step: 300/1035  |  Loss: 0.7958  |  Score: 79.47 [%]  |  Seq Length: 128.0
[2024-09-26 11:28:08,033][root][INFO] - Step: 315/1035  |  Loss: 0.7785  |  Score: 77.22 [%]  |  Seq Length: 128.0
[2024-09-26 11:28:10,680][root][INFO] - Step: 330/1035  |  Loss: 0.8104  |  Score: 76.80 [%]  |  Seq Length: 128.0
[2024-09-26 11:28:13,396][root][INFO] - Step: 345/1035  |  Loss: 0.9338  |  Score: 75.69 [%]  |  Seq Length: 128.0
[2024-09-26 11:28:15,216][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 11:28:15,216][root][INFO] - Score: 77.65 [%]  |  Evaluation Time: 1.82 [s]
[2024-09-26 11:28:16,920][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 11:28:16,920][root][INFO] - Score: 70.79 [%]  |  Evaluation Time: 1.70 [s]
[2024-09-26 11:28:16,921][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 11:28:16,922][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 11:28:17,431][root][INFO] - Step: 346/1035  |  Loss: 0.7610  |  Score: 75.93 [%]  |  Seq Length: 128.0
[2024-09-26 11:28:19,905][root][INFO] - Step: 360/1035  |  Loss: 0.7215  |  Score: 79.76 [%]  |  Seq Length: 128.0
[2024-09-26 11:28:22,550][root][INFO] - Step: 375/1035  |  Loss: 0.6527  |  Score: 83.02 [%]  |  Seq Length: 128.0
[2024-09-26 11:28:25,197][root][INFO] - Step: 390/1035  |  Loss: 0.7442  |  Score: 79.99 [%]  |  Seq Length: 128.0
[2024-09-26 11:28:27,847][root][INFO] - Step: 405/1035  |  Loss: 0.6759  |  Score: 79.63 [%]  |  Seq Length: 128.0
[2024-09-26 11:28:29,483][root][INFO] - Step: 414/1035  |  Loss: 0.6774  |  Score: 82.88 [%]  |  Seq Length: 128.0
[2024-09-26 11:28:31,244][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 11:28:31,244][root][INFO] - Score: 78.41 [%]  |  Evaluation Time: 1.76 [s]
[2024-09-26 11:28:32,979][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 11:28:32,979][root][INFO] - Score: 72.05 [%]  |  Evaluation Time: 1.73 [s]
[2024-09-26 11:28:32,980][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 11:28:32,981][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 11:28:34,371][root][INFO] - Step: 420/1035  |  Loss: 0.6094  |  Score: 82.90 [%]  |  Seq Length: 128.0
[2024-09-26 11:28:37,021][root][INFO] - Step: 435/1035  |  Loss: 0.5700  |  Score: 85.58 [%]  |  Seq Length: 128.0
[2024-09-26 11:28:39,673][root][INFO] - Step: 450/1035  |  Loss: 0.6031  |  Score: 82.21 [%]  |  Seq Length: 128.0
[2024-09-26 11:28:42,328][root][INFO] - Step: 465/1035  |  Loss: 0.6419  |  Score: 83.75 [%]  |  Seq Length: 128.0
[2024-09-26 11:28:44,983][root][INFO] - Step: 480/1035  |  Loss: 0.6355  |  Score: 81.49 [%]  |  Seq Length: 128.0
[2024-09-26 11:28:45,589][root][INFO] - Step: 483/1035  |  Loss: 0.7224  |  Score: 78.94 [%]  |  Seq Length: 128.0
[2024-09-26 11:28:47,309][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 11:28:47,309][root][INFO] - Score: 77.09 [%]  |  Evaluation Time: 1.72 [s]
[2024-09-26 11:28:49,110][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 11:28:49,111][root][INFO] - Score: 70.22 [%]  |  Evaluation Time: 1.80 [s]
[2024-09-26 11:28:49,113][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 11:28:51,584][root][INFO] - Step: 495/1035  |  Loss: 0.5495  |  Score: 84.20 [%]  |  Seq Length: 128.0
[2024-09-26 11:28:54,236][root][INFO] - Step: 510/1035  |  Loss: 0.5567  |  Score: 84.61 [%]  |  Seq Length: 128.0
[2024-09-26 11:28:56,887][root][INFO] - Step: 525/1035  |  Loss: 0.5468  |  Score: 85.23 [%]  |  Seq Length: 128.0
[2024-09-26 11:28:59,535][root][INFO] - Step: 540/1035  |  Loss: 0.5612  |  Score: 85.00 [%]  |  Seq Length: 128.0
[2024-09-26 11:29:01,739][root][INFO] - Step: 552/1035  |  Loss: 0.5557  |  Score: 84.58 [%]  |  Seq Length: 128.0
[2024-09-26 11:29:03,399][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 11:29:03,400][root][INFO] - Score: 76.97 [%]  |  Evaluation Time: 1.66 [s]
[2024-09-26 11:29:05,094][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 11:29:05,094][root][INFO] - Score: 69.93 [%]  |  Evaluation Time: 1.69 [s]
[2024-09-26 11:29:05,096][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 11:29:06,020][root][INFO] - Step: 555/1035  |  Loss: 0.5489  |  Score: 84.21 [%]  |  Seq Length: 128.0
[2024-09-26 11:29:08,669][root][INFO] - Step: 570/1035  |  Loss: 0.4728  |  Score: 86.81 [%]  |  Seq Length: 128.0
[2024-09-26 11:29:11,322][root][INFO] - Step: 585/1035  |  Loss: 0.5626  |  Score: 86.59 [%]  |  Seq Length: 128.0
[2024-09-26 11:29:13,976][root][INFO] - Step: 600/1035  |  Loss: 0.5407  |  Score: 85.73 [%]  |  Seq Length: 128.0
[2024-09-26 11:29:16,623][root][INFO] - Step: 615/1035  |  Loss: 0.4948  |  Score: 86.33 [%]  |  Seq Length: 128.0
[2024-09-26 11:29:17,750][root][INFO] - Step: 621/1035  |  Loss: 0.4859  |  Score: 86.04 [%]  |  Seq Length: 128.0
[2024-09-26 11:29:19,607][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 11:29:19,607][root][INFO] - Score: 77.42 [%]  |  Evaluation Time: 1.85 [s]
[2024-09-26 11:29:21,288][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 11:29:21,288][root][INFO] - Score: 70.08 [%]  |  Evaluation Time: 1.68 [s]
[2024-09-26 11:29:21,290][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 11:29:23,239][root][INFO] - Step: 630/1035  |  Loss: 0.4558  |  Score: 88.06 [%]  |  Seq Length: 128.0
[2024-09-26 11:29:25,896][root][INFO] - Step: 645/1035  |  Loss: 0.4468  |  Score: 88.26 [%]  |  Seq Length: 128.0
[2024-09-26 11:29:28,550][root][INFO] - Step: 660/1035  |  Loss: 0.4486  |  Score: 86.97 [%]  |  Seq Length: 128.0
[2024-09-26 11:29:31,202][root][INFO] - Step: 675/1035  |  Loss: 0.5080  |  Score: 85.51 [%]  |  Seq Length: 128.0
[2024-09-26 11:29:33,909][root][INFO] - Step: 690/1035  |  Loss: 0.4491  |  Score: 87.89 [%]  |  Seq Length: 128.0
[2024-09-26 11:29:35,615][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 11:29:35,616][root][INFO] - Score: 77.95 [%]  |  Evaluation Time: 1.70 [s]
[2024-09-26 11:29:37,187][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 11:29:37,187][root][INFO] - Score: 70.77 [%]  |  Evaluation Time: 1.57 [s]
[2024-09-26 11:29:37,189][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 11:29:37,836][root][INFO] - Step: 691/1035  |  Loss: 0.5432  |  Score: 84.55 [%]  |  Seq Length: 128.0
[2024-09-26 11:29:40,313][root][INFO] - Step: 705/1035  |  Loss: 0.4081  |  Score: 88.51 [%]  |  Seq Length: 128.0
[2024-09-26 11:29:42,961][root][INFO] - Step: 720/1035  |  Loss: 0.4291  |  Score: 87.29 [%]  |  Seq Length: 128.0
[2024-09-26 11:29:45,613][root][INFO] - Step: 735/1035  |  Loss: 0.4251  |  Score: 87.77 [%]  |  Seq Length: 128.0
[2024-09-26 11:29:48,262][root][INFO] - Step: 750/1035  |  Loss: 0.4383  |  Score: 88.61 [%]  |  Seq Length: 128.0
[2024-09-26 11:29:49,941][root][INFO] - Step: 759/1035  |  Loss: 0.4567  |  Score: 88.21 [%]  |  Seq Length: 128.0
[2024-09-26 11:29:51,695][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 11:29:51,695][root][INFO] - Score: 76.78 [%]  |  Evaluation Time: 1.75 [s]
[2024-09-26 11:29:53,400][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 11:29:53,400][root][INFO] - Score: 69.99 [%]  |  Evaluation Time: 1.70 [s]
[2024-09-26 11:29:53,402][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 11:29:54,773][root][INFO] - Step: 765/1035  |  Loss: 0.3575  |  Score: 88.03 [%]  |  Seq Length: 128.0
[2024-09-26 11:29:57,425][root][INFO] - Step: 780/1035  |  Loss: 0.3915  |  Score: 88.50 [%]  |  Seq Length: 128.0
[2024-09-26 11:30:00,074][root][INFO] - Step: 795/1035  |  Loss: 0.3863  |  Score: 89.47 [%]  |  Seq Length: 128.0
[2024-09-26 11:30:02,722][root][INFO] - Step: 810/1035  |  Loss: 0.3688  |  Score: 89.45 [%]  |  Seq Length: 128.0
[2024-09-26 11:30:05,372][root][INFO] - Step: 825/1035  |  Loss: 0.4066  |  Score: 88.20 [%]  |  Seq Length: 128.0
[2024-09-26 11:30:05,993][root][INFO] - Step: 828/1035  |  Loss: 0.3533  |  Score: 89.62 [%]  |  Seq Length: 128.0
[2024-09-26 11:30:07,749][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 11:30:07,750][root][INFO] - Score: 77.40 [%]  |  Evaluation Time: 1.75 [s]
[2024-09-26 11:30:09,564][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 11:30:09,564][root][INFO] - Score: 70.73 [%]  |  Evaluation Time: 1.81 [s]
[2024-09-26 11:30:09,566][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 11:30:12,013][root][INFO] - Step: 840/1035  |  Loss: 0.3717  |  Score: 90.13 [%]  |  Seq Length: 128.0
[2024-09-26 11:30:14,665][root][INFO] - Step: 855/1035  |  Loss: 0.3628  |  Score: 89.66 [%]  |  Seq Length: 128.0
[2024-09-26 11:30:17,322][root][INFO] - Step: 870/1035  |  Loss: 0.3485  |  Score: 89.58 [%]  |  Seq Length: 128.0
[2024-09-26 11:30:19,974][root][INFO] - Step: 885/1035  |  Loss: 0.3899  |  Score: 89.60 [%]  |  Seq Length: 128.0
[2024-09-26 11:30:22,169][root][INFO] - Step: 897/1035  |  Loss: 0.3967  |  Score: 88.83 [%]  |  Seq Length: 128.0
[2024-09-26 11:30:23,824][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 11:30:23,824][root][INFO] - Score: 77.36 [%]  |  Evaluation Time: 1.65 [s]
[2024-09-26 11:30:25,501][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 11:30:25,501][root][INFO] - Score: 70.02 [%]  |  Evaluation Time: 1.68 [s]
[2024-09-26 11:30:25,503][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 11:30:26,387][root][INFO] - Step: 900/1035  |  Loss: 0.4288  |  Score: 84.61 [%]  |  Seq Length: 128.0
[2024-09-26 11:30:29,039][root][INFO] - Step: 915/1035  |  Loss: 0.3791  |  Score: 89.26 [%]  |  Seq Length: 128.0
[2024-09-26 11:30:31,691][root][INFO] - Step: 930/1035  |  Loss: 0.3373  |  Score: 91.15 [%]  |  Seq Length: 128.0
[2024-09-26 11:30:34,357][root][INFO] - Step: 945/1035  |  Loss: 0.3299  |  Score: 90.74 [%]  |  Seq Length: 128.0
[2024-09-26 11:30:37,008][root][INFO] - Step: 960/1035  |  Loss: 0.3533  |  Score: 89.20 [%]  |  Seq Length: 128.0
[2024-09-26 11:30:38,159][root][INFO] - Step: 966/1035  |  Loss: 0.4061  |  Score: 88.44 [%]  |  Seq Length: 128.0
[2024-09-26 11:30:39,823][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 11:30:39,823][root][INFO] - Score: 76.51 [%]  |  Evaluation Time: 1.66 [s]
[2024-09-26 11:30:41,553][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 11:30:41,553][root][INFO] - Score: 70.78 [%]  |  Evaluation Time: 1.73 [s]
[2024-09-26 11:30:41,555][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 11:30:43,460][root][INFO] - Step: 975/1035  |  Loss: 0.3665  |  Score: 89.05 [%]  |  Seq Length: 128.0
[2024-09-26 11:30:46,117][root][INFO] - Step: 990/1035  |  Loss: 0.3242  |  Score: 91.90 [%]  |  Seq Length: 128.0
[2024-09-26 11:30:48,774][root][INFO] - Step: 1005/1035  |  Loss: 0.3726  |  Score: 89.04 [%]  |  Seq Length: 128.0
[2024-09-26 11:30:51,424][root][INFO] - Step: 1020/1035  |  Loss: 0.3442  |  Score: 90.47 [%]  |  Seq Length: 128.0
[2024-09-26 11:30:54,118][root][INFO] - Step: 1035/1035  |  Loss: 0.3468  |  Score: 89.29 [%]  |  Seq Length: 128.0
[2024-09-26 11:30:55,889][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 11:30:55,889][root][INFO] - Score: 77.72 [%]  |  Evaluation Time: 1.77 [s]
[2024-09-26 11:30:57,659][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 11:30:57,659][root][INFO] - Score: 70.39 [%]  |  Evaluation Time: 1.77 [s]
[2024-09-26 11:30:57,660][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 11:30:57,660][root][INFO] - - Epoch: 6
[2024-09-26 11:30:57,660][root][INFO] - - DEV score: 78.41 [%]
[2024-09-26 11:30:57,660][root][INFO] - - TEST score: 72.05 [%]
[2024-09-26 11:30:57,661][root][INFO] - Fine-tuning is done!
[2024-09-26 11:36:39,715][root][INFO] - 

[2024-09-26 11:36:39,715][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 11:36:39,715][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_1s_0.01lr_42rs
[2024-09-26 11:36:39,715][root][INFO] - 

[2024-09-26 11:36:39,716][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 128, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 11:36:43,811][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 11:36:43,812][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 11:36:43,813][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 11:36:43,813][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 11:36:43,814][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 11:36:43,814][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 11:36:43,815][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 11:36:43,815][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 11:36:43,816][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 11:36:43,817][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 11:36:43,817][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 11:36:43,818][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 11:36:43,818][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 11:36:43,819][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 11:36:43,819][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 11:36:43,820][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 11:36:43,820][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 11:36:43,821][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 11:36:43,822][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 11:36:43,822][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 11:36:43,823][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 11:36:43,823][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 11:36:43,824][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 11:36:43,825][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 11:36:43,826][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 11:36:44,191][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 11:36:48,012][root][INFO] - 

[2024-09-26 11:36:48,012][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 11:36:48,012][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 11:36:48,020][root][INFO] - vocab size              : 51200
[2024-09-26 11:36:48,020][root][INFO] - device                  : gpu
[2024-09-26 11:36:48,020][root][INFO] - random seed             : 42
[2024-09-26 11:36:48,020][root][INFO] - train data size         : 4416
[2024-09-26 11:36:48,020][root][INFO] - max epochs              : 15
[2024-09-26 11:36:48,021][root][INFO] - total steps             : 1035
[2024-09-26 11:36:48,021][root][INFO] - warmup steps            : 104
[2024-09-26 11:36:48,021][root][INFO] - batch size              : 64
[2024-09-26 11:36:48,021][root][INFO] - accumulation steps      : 1
[2024-09-26 11:36:48,021][root][INFO] - optimizer               : adamwscale
[2024-09-26 11:36:48,021][root][INFO] - lr_scheduler            : cosine
[2024-09-26 11:36:48,021][root][INFO] - learning rate           : 0.01
[2024-09-26 11:36:48,021][root][INFO] - max length              : 128

[2024-09-26 11:36:48,021][root][INFO] - LoRA Configuration
[2024-09-26 11:36:48,021][root][INFO] - ㄴ r                    : 32
[2024-09-26 11:36:48,021][root][INFO] - ㄴ alpha                : 128
[2024-09-26 11:36:48,021][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 11:36:48,022][root][INFO] - 

[2024-09-26 11:36:48,022][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_1s_0.01lr_42rs
[2024-09-26 11:36:48,022][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 11:36:48,022][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_1s_0.01lr_42rs/tb
[2024-09-26 11:36:48,022][root][INFO] - * tb interval   : 15

[2024-09-26 11:36:48,022][root][INFO] - 

[2024-09-26 11:36:48,022][root][INFO] - Start the Training !
[2024-09-26 11:36:48,024][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 11:36:53,394][root][INFO] - Step: 15/1035  |  Loss: 3.0977  |  Score: 7.51 [%]  |  Seq Length: 128.0
[2024-09-26 11:36:56,036][root][INFO] - Step: 30/1035  |  Loss: 2.3334  |  Score: 17.84 [%]  |  Seq Length: 128.0
[2024-09-26 11:36:58,718][root][INFO] - Step: 45/1035  |  Loss: 1.7999  |  Score: 45.08 [%]  |  Seq Length: 128.0
[2024-09-26 11:37:01,396][root][INFO] - Step: 60/1035  |  Loss: 1.6338  |  Score: 55.36 [%]  |  Seq Length: 128.0
[2024-09-26 11:37:03,042][root][INFO] - Step: 69/1035  |  Loss: 1.7536  |  Score: 61.46 [%]  |  Seq Length: 128.0
[2024-09-26 11:37:04,730][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 11:37:04,731][root][INFO] - Score: 72.95 [%]  |  Evaluation Time: 1.69 [s]
[2024-09-26 11:37:06,442][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 11:37:06,442][root][INFO] - Score: 65.59 [%]  |  Evaluation Time: 1.71 [s]
[2024-09-26 11:37:06,443][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 11:37:06,444][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 11:37:07,824][root][INFO] - Step: 75/1035  |  Loss: 1.4520  |  Score: 60.61 [%]  |  Seq Length: 128.0
[2024-09-26 11:37:10,503][root][INFO] - Step: 90/1035  |  Loss: 1.5210  |  Score: 61.79 [%]  |  Seq Length: 128.0
[2024-09-26 11:37:13,182][root][INFO] - Step: 105/1035  |  Loss: 1.2792  |  Score: 67.73 [%]  |  Seq Length: 128.0
[2024-09-26 11:37:15,827][root][INFO] - Step: 120/1035  |  Loss: 1.2557  |  Score: 65.11 [%]  |  Seq Length: 128.0
[2024-09-26 11:37:18,468][root][INFO] - Step: 135/1035  |  Loss: 1.2059  |  Score: 64.47 [%]  |  Seq Length: 128.0
[2024-09-26 11:37:19,053][root][INFO] - Step: 138/1035  |  Loss: 1.2457  |  Score: 63.90 [%]  |  Seq Length: 128.0
[2024-09-26 11:37:20,776][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 11:37:20,776][root][INFO] - Score: 75.69 [%]  |  Evaluation Time: 1.72 [s]
[2024-09-26 11:37:22,510][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 11:37:22,510][root][INFO] - Score: 67.29 [%]  |  Evaluation Time: 1.73 [s]
[2024-09-26 11:37:22,511][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 11:37:22,512][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 11:37:24,917][root][INFO] - Step: 150/1035  |  Loss: 1.0764  |  Score: 71.18 [%]  |  Seq Length: 128.0
[2024-09-26 11:37:27,559][root][INFO] - Step: 165/1035  |  Loss: 1.1462  |  Score: 69.93 [%]  |  Seq Length: 128.0
[2024-09-26 11:37:30,204][root][INFO] - Step: 180/1035  |  Loss: 1.0738  |  Score: 67.14 [%]  |  Seq Length: 128.0
[2024-09-26 11:37:32,849][root][INFO] - Step: 195/1035  |  Loss: 1.1227  |  Score: 69.47 [%]  |  Seq Length: 128.0
[2024-09-26 11:37:35,054][root][INFO] - Step: 207/1035  |  Loss: 1.1905  |  Score: 71.09 [%]  |  Seq Length: 128.0
[2024-09-26 11:37:36,811][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 11:37:36,811][root][INFO] - Score: 77.59 [%]  |  Evaluation Time: 1.75 [s]
[2024-09-26 11:37:38,446][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 11:37:38,447][root][INFO] - Score: 69.51 [%]  |  Evaluation Time: 1.63 [s]
[2024-09-26 11:37:38,447][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 11:37:38,449][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 11:37:39,392][root][INFO] - Step: 210/1035  |  Loss: 0.8834  |  Score: 74.64 [%]  |  Seq Length: 128.0
[2024-09-26 11:37:42,046][root][INFO] - Step: 225/1035  |  Loss: 1.0361  |  Score: 73.47 [%]  |  Seq Length: 128.0
[2024-09-26 11:37:44,694][root][INFO] - Step: 240/1035  |  Loss: 0.9430  |  Score: 77.18 [%]  |  Seq Length: 128.0
[2024-09-26 11:37:47,343][root][INFO] - Step: 255/1035  |  Loss: 0.9485  |  Score: 74.79 [%]  |  Seq Length: 128.0
[2024-09-26 11:37:49,991][root][INFO] - Step: 270/1035  |  Loss: 0.9632  |  Score: 74.23 [%]  |  Seq Length: 128.0
[2024-09-26 11:37:51,100][root][INFO] - Step: 276/1035  |  Loss: 1.0153  |  Score: 73.77 [%]  |  Seq Length: 128.0
[2024-09-26 11:37:53,003][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 11:37:53,004][root][INFO] - Score: 77.43 [%]  |  Evaluation Time: 1.90 [s]
[2024-09-26 11:37:54,780][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 11:37:54,781][root][INFO] - Score: 70.29 [%]  |  Evaluation Time: 1.77 [s]
[2024-09-26 11:37:54,782][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-26 11:37:54,785][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 11:37:56,685][root][INFO] - Step: 285/1035  |  Loss: 0.8730  |  Score: 76.51 [%]  |  Seq Length: 128.0
[2024-09-26 11:37:59,334][root][INFO] - Step: 300/1035  |  Loss: 0.8614  |  Score: 78.01 [%]  |  Seq Length: 128.0
[2024-09-26 11:38:01,985][root][INFO] - Step: 315/1035  |  Loss: 0.7995  |  Score: 78.22 [%]  |  Seq Length: 128.0
[2024-09-26 11:38:04,636][root][INFO] - Step: 330/1035  |  Loss: 0.7781  |  Score: 78.55 [%]  |  Seq Length: 128.0
[2024-09-26 11:38:07,364][root][INFO] - Step: 345/1035  |  Loss: 0.8369  |  Score: 78.14 [%]  |  Seq Length: 128.0
[2024-09-26 11:38:09,153][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 11:38:09,154][root][INFO] - Score: 77.94 [%]  |  Evaluation Time: 1.79 [s]
[2024-09-26 11:38:10,974][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 11:38:10,974][root][INFO] - Score: 70.45 [%]  |  Evaluation Time: 1.82 [s]
[2024-09-26 11:38:10,975][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 11:38:10,976][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 11:38:11,476][root][INFO] - Step: 346/1035  |  Loss: 0.6625  |  Score: 76.31 [%]  |  Seq Length: 128.0
[2024-09-26 11:38:13,950][root][INFO] - Step: 360/1035  |  Loss: 0.7169  |  Score: 79.38 [%]  |  Seq Length: 128.0
[2024-09-26 11:38:16,597][root][INFO] - Step: 375/1035  |  Loss: 0.7585  |  Score: 81.25 [%]  |  Seq Length: 128.0
[2024-09-26 11:38:19,241][root][INFO] - Step: 390/1035  |  Loss: 0.6862  |  Score: 81.36 [%]  |  Seq Length: 128.0
[2024-09-26 11:38:21,886][root][INFO] - Step: 405/1035  |  Loss: 0.7095  |  Score: 79.44 [%]  |  Seq Length: 128.0
[2024-09-26 11:38:23,530][root][INFO] - Step: 414/1035  |  Loss: 0.6468  |  Score: 80.87 [%]  |  Seq Length: 128.0
[2024-09-26 11:38:25,282][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 11:38:25,282][root][INFO] - Score: 78.74 [%]  |  Evaluation Time: 1.75 [s]
[2024-09-26 11:38:26,982][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 11:38:26,982][root][INFO] - Score: 71.05 [%]  |  Evaluation Time: 1.70 [s]
[2024-09-26 11:38:26,983][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 11:38:26,984][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 11:38:28,367][root][INFO] - Step: 420/1035  |  Loss: 0.6115  |  Score: 81.57 [%]  |  Seq Length: 128.0
[2024-09-26 11:38:31,016][root][INFO] - Step: 435/1035  |  Loss: 0.6042  |  Score: 84.26 [%]  |  Seq Length: 128.0
[2024-09-26 11:38:33,662][root][INFO] - Step: 450/1035  |  Loss: 0.5969  |  Score: 85.04 [%]  |  Seq Length: 128.0
[2024-09-26 11:38:36,307][root][INFO] - Step: 465/1035  |  Loss: 0.6813  |  Score: 81.56 [%]  |  Seq Length: 128.0
[2024-09-26 11:38:38,950][root][INFO] - Step: 480/1035  |  Loss: 0.6400  |  Score: 82.92 [%]  |  Seq Length: 128.0
[2024-09-26 11:38:39,566][root][INFO] - Step: 483/1035  |  Loss: 0.7374  |  Score: 79.34 [%]  |  Seq Length: 128.0
[2024-09-26 11:38:41,379][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 11:38:41,379][root][INFO] - Score: 78.38 [%]  |  Evaluation Time: 1.81 [s]
[2024-09-26 11:38:43,004][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 11:38:43,004][root][INFO] - Score: 71.48 [%]  |  Evaluation Time: 1.62 [s]
[2024-09-26 11:38:43,005][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-26 11:38:43,006][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 11:38:45,532][root][INFO] - Step: 495/1035  |  Loss: 0.5612  |  Score: 84.61 [%]  |  Seq Length: 128.0
[2024-09-26 11:38:48,184][root][INFO] - Step: 510/1035  |  Loss: 0.5708  |  Score: 84.56 [%]  |  Seq Length: 128.0
[2024-09-26 11:38:50,832][root][INFO] - Step: 525/1035  |  Loss: 0.5808  |  Score: 83.52 [%]  |  Seq Length: 128.0
[2024-09-26 11:38:53,478][root][INFO] - Step: 540/1035  |  Loss: 0.5354  |  Score: 85.99 [%]  |  Seq Length: 128.0
[2024-09-26 11:38:55,638][root][INFO] - Step: 552/1035  |  Loss: 0.5531  |  Score: 84.28 [%]  |  Seq Length: 128.0
[2024-09-26 11:38:57,364][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 11:38:57,364][root][INFO] - Score: 78.69 [%]  |  Evaluation Time: 1.72 [s]
[2024-09-26 11:38:59,053][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 11:38:59,053][root][INFO] - Score: 71.11 [%]  |  Evaluation Time: 1.69 [s]
[2024-09-26 11:38:59,055][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 11:38:59,918][root][INFO] - Step: 555/1035  |  Loss: 0.3867  |  Score: 89.16 [%]  |  Seq Length: 128.0
[2024-09-26 11:39:02,570][root][INFO] - Step: 570/1035  |  Loss: 0.4516  |  Score: 87.08 [%]  |  Seq Length: 128.0
[2024-09-26 11:39:05,214][root][INFO] - Step: 585/1035  |  Loss: 0.4834  |  Score: 86.62 [%]  |  Seq Length: 128.0
[2024-09-26 11:39:07,870][root][INFO] - Step: 600/1035  |  Loss: 0.6034  |  Score: 86.36 [%]  |  Seq Length: 128.0
[2024-09-26 11:39:10,528][root][INFO] - Step: 615/1035  |  Loss: 0.5356  |  Score: 85.97 [%]  |  Seq Length: 128.0
[2024-09-26 11:39:11,632][root][INFO] - Step: 621/1035  |  Loss: 0.5660  |  Score: 84.52 [%]  |  Seq Length: 128.0
[2024-09-26 11:39:13,362][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 11:39:13,362][root][INFO] - Score: 78.20 [%]  |  Evaluation Time: 1.73 [s]
[2024-09-26 11:39:14,944][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 11:39:14,944][root][INFO] - Score: 71.04 [%]  |  Evaluation Time: 1.58 [s]
[2024-09-26 11:39:14,946][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 11:39:16,886][root][INFO] - Step: 630/1035  |  Loss: 0.4185  |  Score: 88.71 [%]  |  Seq Length: 128.0
[2024-09-26 11:39:19,542][root][INFO] - Step: 645/1035  |  Loss: 0.4322  |  Score: 88.52 [%]  |  Seq Length: 128.0
[2024-09-26 11:39:22,193][root][INFO] - Step: 660/1035  |  Loss: 0.4117  |  Score: 88.85 [%]  |  Seq Length: 128.0
[2024-09-26 11:39:24,845][root][INFO] - Step: 675/1035  |  Loss: 0.4689  |  Score: 86.94 [%]  |  Seq Length: 128.0
[2024-09-26 11:39:27,540][root][INFO] - Step: 690/1035  |  Loss: 0.4508  |  Score: 87.13 [%]  |  Seq Length: 128.0
[2024-09-26 11:39:29,203][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 11:39:29,203][root][INFO] - Score: 78.39 [%]  |  Evaluation Time: 1.66 [s]
[2024-09-26 11:39:30,766][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 11:39:30,766][root][INFO] - Score: 70.97 [%]  |  Evaluation Time: 1.56 [s]
[2024-09-26 11:39:30,768][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 11:39:31,328][root][INFO] - Step: 691/1035  |  Loss: 0.4713  |  Score: 90.50 [%]  |  Seq Length: 128.0
[2024-09-26 11:39:33,804][root][INFO] - Step: 705/1035  |  Loss: 0.3947  |  Score: 89.26 [%]  |  Seq Length: 128.0
[2024-09-26 11:39:36,454][root][INFO] - Step: 720/1035  |  Loss: 0.4114  |  Score: 88.47 [%]  |  Seq Length: 128.0
[2024-09-26 11:39:39,106][root][INFO] - Step: 735/1035  |  Loss: 0.4168  |  Score: 88.09 [%]  |  Seq Length: 128.0
[2024-09-26 11:39:41,757][root][INFO] - Step: 750/1035  |  Loss: 0.4343  |  Score: 87.64 [%]  |  Seq Length: 128.0
[2024-09-26 11:39:43,396][root][INFO] - Step: 759/1035  |  Loss: 0.4224  |  Score: 88.64 [%]  |  Seq Length: 128.0
[2024-09-26 11:39:45,059][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 11:39:45,059][root][INFO] - Score: 78.12 [%]  |  Evaluation Time: 1.66 [s]
[2024-09-26 11:39:46,735][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 11:39:46,735][root][INFO] - Score: 71.42 [%]  |  Evaluation Time: 1.67 [s]
[2024-09-26 11:39:46,738][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 11:39:48,126][root][INFO] - Step: 765/1035  |  Loss: 0.3655  |  Score: 89.40 [%]  |  Seq Length: 128.0
[2024-09-26 11:39:50,780][root][INFO] - Step: 780/1035  |  Loss: 0.3715  |  Score: 89.94 [%]  |  Seq Length: 128.0
[2024-09-26 11:39:53,436][root][INFO] - Step: 795/1035  |  Loss: 0.3547  |  Score: 89.90 [%]  |  Seq Length: 128.0
[2024-09-26 11:39:56,084][root][INFO] - Step: 810/1035  |  Loss: 0.3800  |  Score: 89.93 [%]  |  Seq Length: 128.0
[2024-09-26 11:39:58,736][root][INFO] - Step: 825/1035  |  Loss: 0.4124  |  Score: 88.37 [%]  |  Seq Length: 128.0
[2024-09-26 11:39:59,344][root][INFO] - Step: 828/1035  |  Loss: 0.3689  |  Score: 88.23 [%]  |  Seq Length: 128.0
[2024-09-26 11:40:01,060][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 11:40:01,060][root][INFO] - Score: 78.02 [%]  |  Evaluation Time: 1.71 [s]
[2024-09-26 11:40:02,667][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 11:40:02,668][root][INFO] - Score: 70.53 [%]  |  Evaluation Time: 1.61 [s]
[2024-09-26 11:40:02,670][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 11:40:05,245][root][INFO] - Step: 840/1035  |  Loss: 0.3806  |  Score: 89.52 [%]  |  Seq Length: 128.0
[2024-09-26 11:40:07,942][root][INFO] - Step: 855/1035  |  Loss: 0.3350  |  Score: 90.31 [%]  |  Seq Length: 128.0
[2024-09-26 11:40:10,641][root][INFO] - Step: 870/1035  |  Loss: 0.3675  |  Score: 90.29 [%]  |  Seq Length: 128.0
[2024-09-26 11:40:13,342][root][INFO] - Step: 885/1035  |  Loss: 0.3302  |  Score: 90.63 [%]  |  Seq Length: 128.0
[2024-09-26 11:40:15,543][root][INFO] - Step: 897/1035  |  Loss: 0.3789  |  Score: 88.10 [%]  |  Seq Length: 128.0
[2024-09-26 11:40:17,229][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 11:40:17,229][root][INFO] - Score: 78.12 [%]  |  Evaluation Time: 1.68 [s]
[2024-09-26 11:40:19,035][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 11:40:19,035][root][INFO] - Score: 70.91 [%]  |  Evaluation Time: 1.80 [s]
[2024-09-26 11:40:19,037][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 11:40:19,911][root][INFO] - Step: 900/1035  |  Loss: 0.3570  |  Score: 90.11 [%]  |  Seq Length: 128.0
[2024-09-26 11:40:22,556][root][INFO] - Step: 915/1035  |  Loss: 0.3602  |  Score: 90.08 [%]  |  Seq Length: 128.0
[2024-09-26 11:40:25,199][root][INFO] - Step: 930/1035  |  Loss: 0.3524  |  Score: 90.07 [%]  |  Seq Length: 128.0
[2024-09-26 11:40:27,843][root][INFO] - Step: 945/1035  |  Loss: 0.3621  |  Score: 89.24 [%]  |  Seq Length: 128.0
[2024-09-26 11:40:30,497][root][INFO] - Step: 960/1035  |  Loss: 0.3223  |  Score: 89.72 [%]  |  Seq Length: 128.0
[2024-09-26 11:40:31,606][root][INFO] - Step: 966/1035  |  Loss: 0.3781  |  Score: 88.24 [%]  |  Seq Length: 128.0
[2024-09-26 11:40:33,364][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 11:40:33,364][root][INFO] - Score: 77.10 [%]  |  Evaluation Time: 1.76 [s]
[2024-09-26 11:40:34,987][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 11:40:34,987][root][INFO] - Score: 70.93 [%]  |  Evaluation Time: 1.62 [s]
[2024-09-26 11:40:34,989][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 11:40:36,980][root][INFO] - Step: 975/1035  |  Loss: 0.3673  |  Score: 88.99 [%]  |  Seq Length: 128.0
[2024-09-26 11:40:39,632][root][INFO] - Step: 990/1035  |  Loss: 0.3321  |  Score: 90.16 [%]  |  Seq Length: 128.0
[2024-09-26 11:40:42,280][root][INFO] - Step: 1005/1035  |  Loss: 0.3492  |  Score: 90.60 [%]  |  Seq Length: 128.0
[2024-09-26 11:40:44,929][root][INFO] - Step: 1020/1035  |  Loss: 0.3532  |  Score: 89.75 [%]  |  Seq Length: 128.0
[2024-09-26 11:40:47,656][root][INFO] - Step: 1035/1035  |  Loss: 0.3135  |  Score: 90.71 [%]  |  Seq Length: 128.0
[2024-09-26 11:40:49,423][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 11:40:49,423][root][INFO] - Score: 78.08 [%]  |  Evaluation Time: 1.76 [s]
[2024-09-26 11:40:51,031][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 11:40:51,031][root][INFO] - Score: 70.79 [%]  |  Evaluation Time: 1.61 [s]
[2024-09-26 11:40:51,032][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 11:40:51,033][root][INFO] - - Epoch: 7
[2024-09-26 11:40:51,033][root][INFO] - - DEV score: 78.38 [%]
[2024-09-26 11:40:51,033][root][INFO] - - TEST score: 71.48 [%]
[2024-09-26 11:40:51,034][root][INFO] - Fine-tuning is done!
[2024-09-26 11:42:20,406][root][INFO] - 

[2024-09-26 11:42:20,406][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 11:42:20,406][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 11:42:20,406][root][INFO] - 

[2024-09-26 11:42:20,406][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 11:42:24,773][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 11:42:24,773][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 11:42:24,774][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 11:42:24,774][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 11:42:24,774][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 11:42:24,775][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 11:42:24,775][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 11:42:24,776][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 11:42:24,776][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 11:42:24,776][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 11:42:24,777][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 11:42:24,777][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 11:42:24,778][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 11:42:24,778][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 11:42:24,778][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 11:42:24,779][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 11:42:24,779][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 11:42:24,780][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 11:42:24,780][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 11:42:24,780][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 11:42:24,781][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 11:42:24,781][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 11:42:24,782][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 11:42:24,782][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 11:42:24,784][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 11:42:25,024][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 11:42:28,830][root][INFO] - 

[2024-09-26 11:42:28,831][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 11:42:28,831][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 11:42:28,839][root][INFO] - vocab size              : 51200
[2024-09-26 11:42:28,839][root][INFO] - device                  : gpu
[2024-09-26 11:42:28,839][root][INFO] - random seed             : 42
[2024-09-26 11:42:28,839][root][INFO] - train data size         : 4416
[2024-09-26 11:42:28,839][root][INFO] - max epochs              : 15
[2024-09-26 11:42:28,840][root][INFO] - total steps             : 1035
[2024-09-26 11:42:28,840][root][INFO] - warmup steps            : 104
[2024-09-26 11:42:28,840][root][INFO] - batch size              : 64
[2024-09-26 11:42:28,840][root][INFO] - accumulation steps      : 1
[2024-09-26 11:42:28,840][root][INFO] - optimizer               : adamwscale
[2024-09-26 11:42:28,840][root][INFO] - lr_scheduler            : cosine
[2024-09-26 11:42:28,840][root][INFO] - learning rate           : 0.01
[2024-09-26 11:42:28,840][root][INFO] - max length              : 256

[2024-09-26 11:42:28,840][root][INFO] - LoRA Configuration
[2024-09-26 11:42:28,840][root][INFO] - ㄴ r                    : 32
[2024-09-26 11:42:28,840][root][INFO] - ㄴ alpha                : 128
[2024-09-26 11:42:28,840][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 11:42:28,841][root][INFO] - 

[2024-09-26 11:42:28,841][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 11:42:28,841][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 11:42:28,841][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 11:42:28,841][root][INFO] - * tb interval   : 15

[2024-09-26 11:42:28,841][root][INFO] - 

[2024-09-26 11:42:28,841][root][INFO] - Start the Training !
[2024-09-26 11:42:28,844][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 11:42:36,937][root][INFO] - Step: 15/1035  |  Loss: 3.0615  |  Score: 8.86 [%]  |  Seq Length: 256.0
[2024-09-26 11:42:42,386][root][INFO] - Step: 30/1035  |  Loss: 2.2877  |  Score: 18.91 [%]  |  Seq Length: 256.0
[2024-09-26 11:42:47,844][root][INFO] - Step: 45/1035  |  Loss: 1.8296  |  Score: 45.82 [%]  |  Seq Length: 256.0
[2024-09-26 11:42:53,307][root][INFO] - Step: 60/1035  |  Loss: 1.5838  |  Score: 55.50 [%]  |  Seq Length: 256.0
[2024-09-26 11:42:56,612][root][INFO] - Step: 69/1035  |  Loss: 1.5424  |  Score: 62.61 [%]  |  Seq Length: 256.0
[2024-09-26 11:42:59,708][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 11:42:59,708][root][INFO] - Score: 74.83 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-26 11:43:02,737][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 11:43:02,738][root][INFO] - Score: 68.16 [%]  |  Evaluation Time: 3.03 [s]
[2024-09-26 11:43:02,738][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 11:43:02,740][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 11:43:05,257][root][INFO] - Step: 75/1035  |  Loss: 1.4052  |  Score: 62.73 [%]  |  Seq Length: 256.0
[2024-09-26 11:43:10,743][root][INFO] - Step: 90/1035  |  Loss: 1.4104  |  Score: 63.27 [%]  |  Seq Length: 256.0
[2024-09-26 11:43:16,235][root][INFO] - Step: 105/1035  |  Loss: 1.2544  |  Score: 68.20 [%]  |  Seq Length: 256.0
[2024-09-26 11:43:21,732][root][INFO] - Step: 120/1035  |  Loss: 1.1951  |  Score: 65.65 [%]  |  Seq Length: 256.0
[2024-09-26 11:43:27,228][root][INFO] - Step: 135/1035  |  Loss: 1.1749  |  Score: 68.69 [%]  |  Seq Length: 256.0
[2024-09-26 11:43:28,392][root][INFO] - Step: 138/1035  |  Loss: 1.2602  |  Score: 66.31 [%]  |  Seq Length: 256.0
[2024-09-26 11:43:31,481][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 11:43:31,481][root][INFO] - Score: 74.97 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-26 11:43:34,465][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 11:43:34,465][root][INFO] - Score: 68.42 [%]  |  Evaluation Time: 2.98 [s]
[2024-09-26 11:43:34,466][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 11:43:34,467][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 11:43:39,223][root][INFO] - Step: 150/1035  |  Loss: 1.0717  |  Score: 72.33 [%]  |  Seq Length: 256.0
[2024-09-26 11:43:44,721][root][INFO] - Step: 165/1035  |  Loss: 1.0935  |  Score: 71.33 [%]  |  Seq Length: 256.0
[2024-09-26 11:43:50,221][root][INFO] - Step: 180/1035  |  Loss: 1.0674  |  Score: 67.72 [%]  |  Seq Length: 256.0
[2024-09-26 11:43:55,715][root][INFO] - Step: 195/1035  |  Loss: 1.2696  |  Score: 69.61 [%]  |  Seq Length: 256.0
[2024-09-26 11:44:00,163][root][INFO] - Step: 207/1035  |  Loss: 1.1982  |  Score: 69.70 [%]  |  Seq Length: 256.0
[2024-09-26 11:44:03,330][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 11:44:03,330][root][INFO] - Score: 77.27 [%]  |  Evaluation Time: 3.16 [s]
[2024-09-26 11:44:06,322][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 11:44:06,322][root][INFO] - Score: 69.77 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-26 11:44:06,324][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 11:44:06,325][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 11:44:07,801][root][INFO] - Step: 210/1035  |  Loss: 0.8241  |  Score: 76.21 [%]  |  Seq Length: 256.0
[2024-09-26 11:44:13,300][root][INFO] - Step: 225/1035  |  Loss: 0.9559  |  Score: 74.76 [%]  |  Seq Length: 256.0
[2024-09-26 11:44:18,804][root][INFO] - Step: 240/1035  |  Loss: 1.0658  |  Score: 75.05 [%]  |  Seq Length: 256.0
[2024-09-26 11:44:24,300][root][INFO] - Step: 255/1035  |  Loss: 0.9135  |  Score: 75.00 [%]  |  Seq Length: 256.0
[2024-09-26 11:44:29,800][root][INFO] - Step: 270/1035  |  Loss: 1.0416  |  Score: 71.43 [%]  |  Seq Length: 256.0
[2024-09-26 11:44:32,020][root][INFO] - Step: 276/1035  |  Loss: 1.2676  |  Score: 74.35 [%]  |  Seq Length: 256.0
[2024-09-26 11:44:35,118][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 11:44:35,118][root][INFO] - Score: 76.73 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-26 11:44:38,250][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 11:44:38,250][root][INFO] - Score: 69.08 [%]  |  Evaluation Time: 3.13 [s]
[2024-09-26 11:44:38,252][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 11:44:41,891][root][INFO] - Step: 285/1035  |  Loss: 0.8962  |  Score: 75.18 [%]  |  Seq Length: 256.0
[2024-09-26 11:44:47,391][root][INFO] - Step: 300/1035  |  Loss: 0.8845  |  Score: 76.62 [%]  |  Seq Length: 256.0
[2024-09-26 11:44:52,891][root][INFO] - Step: 315/1035  |  Loss: 0.8503  |  Score: 76.11 [%]  |  Seq Length: 256.0
[2024-09-26 11:44:58,391][root][INFO] - Step: 330/1035  |  Loss: 0.7617  |  Score: 77.88 [%]  |  Seq Length: 256.0
[2024-09-26 11:45:03,928][root][INFO] - Step: 345/1035  |  Loss: 0.8694  |  Score: 76.35 [%]  |  Seq Length: 256.0
[2024-09-26 11:45:07,040][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 11:45:07,040][root][INFO] - Score: 76.51 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-26 11:45:10,142][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 11:45:10,142][root][INFO] - Score: 70.58 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-26 11:45:10,143][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 11:45:10,144][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 11:45:10,854][root][INFO] - Step: 346/1035  |  Loss: 0.7626  |  Score: 74.18 [%]  |  Seq Length: 256.0
[2024-09-26 11:45:15,983][root][INFO] - Step: 360/1035  |  Loss: 0.7384  |  Score: 80.61 [%]  |  Seq Length: 256.0
[2024-09-26 11:45:21,477][root][INFO] - Step: 375/1035  |  Loss: 0.7258  |  Score: 81.98 [%]  |  Seq Length: 256.0
[2024-09-26 11:45:26,981][root][INFO] - Step: 390/1035  |  Loss: 0.7790  |  Score: 79.58 [%]  |  Seq Length: 256.0
[2024-09-26 11:45:32,486][root][INFO] - Step: 405/1035  |  Loss: 0.7788  |  Score: 78.34 [%]  |  Seq Length: 256.0
[2024-09-26 11:45:35,816][root][INFO] - Step: 414/1035  |  Loss: 0.7009  |  Score: 78.80 [%]  |  Seq Length: 256.0
[2024-09-26 11:45:38,928][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 11:45:38,928][root][INFO] - Score: 77.71 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-26 11:45:41,961][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 11:45:41,962][root][INFO] - Score: 70.72 [%]  |  Evaluation Time: 3.03 [s]
[2024-09-26 11:45:41,963][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 11:45:41,964][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 11:45:44,532][root][INFO] - Step: 420/1035  |  Loss: 0.5606  |  Score: 81.85 [%]  |  Seq Length: 256.0
[2024-09-26 11:45:50,043][root][INFO] - Step: 435/1035  |  Loss: 0.5952  |  Score: 84.20 [%]  |  Seq Length: 256.0
[2024-09-26 11:45:55,554][root][INFO] - Step: 450/1035  |  Loss: 0.5789  |  Score: 84.65 [%]  |  Seq Length: 256.0
[2024-09-26 11:46:01,066][root][INFO] - Step: 465/1035  |  Loss: 0.6970  |  Score: 81.42 [%]  |  Seq Length: 256.0
[2024-09-26 11:46:06,571][root][INFO] - Step: 480/1035  |  Loss: 0.6009  |  Score: 83.49 [%]  |  Seq Length: 256.0
[2024-09-26 11:46:07,748][root][INFO] - Step: 483/1035  |  Loss: 0.7244  |  Score: 77.71 [%]  |  Seq Length: 256.0
[2024-09-26 11:46:10,877][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 11:46:10,877][root][INFO] - Score: 77.22 [%]  |  Evaluation Time: 3.13 [s]
[2024-09-26 11:46:13,933][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 11:46:13,933][root][INFO] - Score: 70.25 [%]  |  Evaluation Time: 3.05 [s]
[2024-09-26 11:46:13,935][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 11:46:18,728][root][INFO] - Step: 495/1035  |  Loss: 0.5385  |  Score: 84.51 [%]  |  Seq Length: 256.0
[2024-09-26 11:46:24,280][root][INFO] - Step: 510/1035  |  Loss: 0.5684  |  Score: 84.82 [%]  |  Seq Length: 256.0
[2024-09-26 11:46:29,833][root][INFO] - Step: 525/1035  |  Loss: 0.5855  |  Score: 82.64 [%]  |  Seq Length: 256.0
[2024-09-26 11:46:35,376][root][INFO] - Step: 540/1035  |  Loss: 0.5521  |  Score: 85.38 [%]  |  Seq Length: 256.0
[2024-09-26 11:46:39,867][root][INFO] - Step: 552/1035  |  Loss: 0.5853  |  Score: 83.88 [%]  |  Seq Length: 256.0
[2024-09-26 11:46:42,921][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 11:46:42,921][root][INFO] - Score: 77.45 [%]  |  Evaluation Time: 3.05 [s]
[2024-09-26 11:46:45,977][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 11:46:45,978][root][INFO] - Score: 69.41 [%]  |  Evaluation Time: 3.05 [s]
[2024-09-26 11:46:45,980][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 11:46:47,417][root][INFO] - Step: 555/1035  |  Loss: 0.4736  |  Score: 85.91 [%]  |  Seq Length: 256.0
[2024-09-26 11:46:52,928][root][INFO] - Step: 570/1035  |  Loss: 0.4530  |  Score: 86.81 [%]  |  Seq Length: 256.0
[2024-09-26 11:46:58,434][root][INFO] - Step: 585/1035  |  Loss: 0.4946  |  Score: 86.31 [%]  |  Seq Length: 256.0
[2024-09-26 11:47:03,942][root][INFO] - Step: 600/1035  |  Loss: 0.5424  |  Score: 85.89 [%]  |  Seq Length: 256.0
[2024-09-26 11:47:09,446][root][INFO] - Step: 615/1035  |  Loss: 0.5300  |  Score: 85.94 [%]  |  Seq Length: 256.0
[2024-09-26 11:47:11,707][root][INFO] - Step: 621/1035  |  Loss: 0.5623  |  Score: 87.60 [%]  |  Seq Length: 256.0
[2024-09-26 11:47:14,781][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 11:47:14,781][root][INFO] - Score: 77.18 [%]  |  Evaluation Time: 3.07 [s]
[2024-09-26 11:47:17,859][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 11:47:17,859][root][INFO] - Score: 69.80 [%]  |  Evaluation Time: 3.08 [s]
[2024-09-26 11:47:17,861][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 11:47:21,563][root][INFO] - Step: 630/1035  |  Loss: 0.4764  |  Score: 87.67 [%]  |  Seq Length: 256.0
[2024-09-26 11:47:27,064][root][INFO] - Step: 645/1035  |  Loss: 0.4654  |  Score: 87.51 [%]  |  Seq Length: 256.0
[2024-09-26 11:47:32,566][root][INFO] - Step: 660/1035  |  Loss: 0.4337  |  Score: 88.13 [%]  |  Seq Length: 256.0
[2024-09-26 11:47:38,076][root][INFO] - Step: 675/1035  |  Loss: 0.4667  |  Score: 87.19 [%]  |  Seq Length: 256.0
[2024-09-26 11:47:43,629][root][INFO] - Step: 690/1035  |  Loss: 0.5049  |  Score: 85.78 [%]  |  Seq Length: 256.0
[2024-09-26 11:47:46,736][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 11:47:46,736][root][INFO] - Score: 77.74 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-26 11:47:49,846][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 11:47:49,846][root][INFO] - Score: 70.41 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-26 11:47:49,848][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 11:47:50,529][root][INFO] - Step: 691/1035  |  Loss: 0.4437  |  Score: 93.45 [%]  |  Seq Length: 256.0
[2024-09-26 11:47:55,679][root][INFO] - Step: 705/1035  |  Loss: 0.3837  |  Score: 89.33 [%]  |  Seq Length: 256.0
[2024-09-26 11:48:01,193][root][INFO] - Step: 720/1035  |  Loss: 0.4183  |  Score: 88.28 [%]  |  Seq Length: 256.0
[2024-09-26 11:48:01,522][root][INFO] - 

[2024-09-26 11:48:01,522][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 11:48:01,522][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 11:48:01,522][root][INFO] - 

[2024-09-26 11:48:01,522][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 11:48:05,895][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 11:48:05,896][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 11:48:05,896][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 11:48:05,896][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 11:48:05,897][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 11:48:05,897][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 11:48:05,898][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 11:48:05,898][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 11:48:05,899][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 11:48:05,899][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 11:48:05,899][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 11:48:05,900][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 11:48:05,900][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 11:48:05,901][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 11:48:05,901][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 11:48:05,902][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 11:48:05,902][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 11:48:05,902][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 11:48:05,903][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 11:48:05,903][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 11:48:05,904][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 11:48:05,904][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 11:48:05,905][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 11:48:05,905][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 11:48:05,907][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 11:48:06,116][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 11:48:06,735][root][INFO] - Step: 735/1035  |  Loss: 0.4145  |  Score: 88.55 [%]  |  Seq Length: 256.0
[2024-09-26 11:48:12,378][root][INFO] - 

[2024-09-26 11:48:12,378][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 11:48:12,378][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 11:48:12,386][root][INFO] - vocab size              : 51200
[2024-09-26 11:48:12,386][root][INFO] - device                  : gpu
[2024-09-26 11:48:12,386][root][INFO] - random seed             : 42
[2024-09-26 11:48:12,386][root][INFO] - train data size         : 4416
[2024-09-26 11:48:12,386][root][INFO] - max epochs              : 15
[2024-09-26 11:48:12,386][root][INFO] - total steps             : 1035
[2024-09-26 11:48:12,386][root][INFO] - warmup steps            : 104
[2024-09-26 11:48:12,387][root][INFO] - batch size              : 64
[2024-09-26 11:48:12,387][root][INFO] - accumulation steps      : 1
[2024-09-26 11:48:12,387][root][INFO] - optimizer               : adamwscale
[2024-09-26 11:48:12,387][root][INFO] - lr_scheduler            : cosine
[2024-09-26 11:48:12,387][root][INFO] - learning rate           : 0.01
[2024-09-26 11:48:12,387][root][INFO] - max length              : 256

[2024-09-26 11:48:12,387][root][INFO] - LoRA Configuration
[2024-09-26 11:48:12,387][root][INFO] - ㄴ r                    : 32
[2024-09-26 11:48:12,387][root][INFO] - ㄴ alpha                : 128
[2024-09-26 11:48:12,387][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 11:48:12,387][root][INFO] - 

[2024-09-26 11:48:12,388][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 11:48:12,388][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 11:48:12,388][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 11:48:12,388][root][INFO] - * tb interval   : 15

[2024-09-26 11:48:12,388][root][INFO] - 

[2024-09-26 11:48:12,388][root][INFO] - Start the Training !
[2024-09-26 11:48:12,391][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 11:48:12,463][root][INFO] - Step: 750/1035  |  Loss: 0.3937  |  Score: 88.34 [%]  |  Seq Length: 256.0
[2024-09-26 11:48:15,944][root][INFO] - Step: 759/1035  |  Loss: 0.4204  |  Score: 88.53 [%]  |  Seq Length: 256.0
[2024-09-26 11:48:19,169][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 11:48:19,169][root][INFO] - Score: 77.02 [%]  |  Evaluation Time: 3.22 [s]
[2024-09-26 11:48:22,347][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 11:48:22,347][root][INFO] - Score: 70.35 [%]  |  Evaluation Time: 3.18 [s]
[2024-09-26 11:48:22,349][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 11:48:24,877][root][INFO] - Step: 765/1035  |  Loss: 0.3979  |  Score: 88.01 [%]  |  Seq Length: 256.0
[2024-09-26 11:48:30,387][root][INFO] - Step: 780/1035  |  Loss: 0.3804  |  Score: 89.82 [%]  |  Seq Length: 256.0
[2024-09-26 11:48:35,890][root][INFO] - Step: 795/1035  |  Loss: 0.3690  |  Score: 90.09 [%]  |  Seq Length: 256.0
[2024-09-26 11:48:40,157][root][INFO] - 

[2024-09-26 11:48:40,157][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 11:48:40,157][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 11:48:40,157][root][INFO] - 

[2024-09-26 11:48:40,157][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 11:48:41,403][root][INFO] - Step: 810/1035  |  Loss: 0.4325  |  Score: 89.28 [%]  |  Seq Length: 256.0
[2024-09-26 11:48:44,877][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 11:48:44,878][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 11:48:44,878][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 11:48:44,879][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 11:48:44,879][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 11:48:44,880][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 11:48:44,880][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 11:48:44,880][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 11:48:44,881][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 11:48:44,881][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 11:48:44,882][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 11:48:44,882][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 11:48:44,883][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 11:48:44,883][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 11:48:44,884][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 11:48:44,884][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 11:48:44,884][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 11:48:44,885][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 11:48:44,885][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 11:48:44,886][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 11:48:44,886][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 11:48:44,887][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 11:48:44,887][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 11:48:44,888][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 11:48:44,889][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 11:48:45,295][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 11:48:46,916][root][INFO] - Step: 825/1035  |  Loss: 0.3807  |  Score: 88.69 [%]  |  Seq Length: 256.0
[2024-09-26 11:48:48,078][root][INFO] - Step: 828/1035  |  Loss: 0.4403  |  Score: 85.03 [%]  |  Seq Length: 256.0
[2024-09-26 11:48:49,090][root][INFO] - 

[2024-09-26 11:48:49,090][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 11:48:49,090][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 11:48:49,098][root][INFO] - vocab size              : 51200
[2024-09-26 11:48:49,098][root][INFO] - device                  : gpu
[2024-09-26 11:48:49,098][root][INFO] - random seed             : 42
[2024-09-26 11:48:49,098][root][INFO] - train data size         : 4416
[2024-09-26 11:48:49,099][root][INFO] - max epochs              : 15
[2024-09-26 11:48:49,099][root][INFO] - total steps             : 1035
[2024-09-26 11:48:49,099][root][INFO] - warmup steps            : 104
[2024-09-26 11:48:49,099][root][INFO] - batch size              : 64
[2024-09-26 11:48:49,099][root][INFO] - accumulation steps      : 1
[2024-09-26 11:48:49,099][root][INFO] - optimizer               : adamwscale
[2024-09-26 11:48:49,099][root][INFO] - lr_scheduler            : cosine
[2024-09-26 11:48:49,099][root][INFO] - learning rate           : 0.01
[2024-09-26 11:48:49,099][root][INFO] - max length              : 256

[2024-09-26 11:48:49,099][root][INFO] - LoRA Configuration
[2024-09-26 11:48:49,100][root][INFO] - ㄴ r                    : 32
[2024-09-26 11:48:49,100][root][INFO] - ㄴ alpha                : 128
[2024-09-26 11:48:49,100][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 11:48:49,100][root][INFO] - 

[2024-09-26 11:48:49,100][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 11:48:49,100][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 11:48:49,100][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 11:48:49,100][root][INFO] - * tb interval   : 15

[2024-09-26 11:48:49,100][root][INFO] - 

[2024-09-26 11:48:49,100][root][INFO] - Start the Training !
[2024-09-26 11:48:49,103][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 11:48:51,305][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 11:48:51,305][root][INFO] - Score: 77.97 [%]  |  Evaluation Time: 3.22 [s]
[2024-09-26 11:48:54,363][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 11:48:54,363][root][INFO] - Score: 70.27 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-26 11:48:54,365][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 11:48:57,410][root][INFO] - Step: 15/1035  |  Loss: 3.3881  |  Score: 0.92 [%]  |  Seq Length: 256.0
[2024-09-26 11:48:59,132][root][INFO] - Step: 840/1035  |  Loss: 0.4057  |  Score: 89.66 [%]  |  Seq Length: 256.0
[2024-09-26 11:49:02,880][root][INFO] - Step: 30/1035  |  Loss: 2.3165  |  Score: 18.38 [%]  |  Seq Length: 256.0
[2024-09-26 11:49:04,641][root][INFO] - Step: 855/1035  |  Loss: 0.3497  |  Score: 90.46 [%]  |  Seq Length: 256.0
[2024-09-26 11:49:08,356][root][INFO] - Step: 45/1035  |  Loss: 2.0702  |  Score: 33.89 [%]  |  Seq Length: 256.0
[2024-09-26 11:49:10,141][root][INFO] - Step: 870/1035  |  Loss: 0.3489  |  Score: 90.11 [%]  |  Seq Length: 256.0
[2024-09-26 11:49:13,833][root][INFO] - Step: 60/1035  |  Loss: 1.6511  |  Score: 53.22 [%]  |  Seq Length: 256.0
[2024-09-26 11:49:15,642][root][INFO] - Step: 885/1035  |  Loss: 0.3494  |  Score: 90.22 [%]  |  Seq Length: 256.0
[2024-09-26 11:49:17,171][root][INFO] - Step: 69/1035  |  Loss: 1.4205  |  Score: 64.34 [%]  |  Seq Length: 256.0
[2024-09-26 11:49:20,063][root][INFO] - Step: 897/1035  |  Loss: 0.3626  |  Score: 88.74 [%]  |  Seq Length: 256.0
[2024-09-26 11:49:20,417][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 11:49:20,417][root][INFO] - Score: 73.02 [%]  |  Evaluation Time: 3.24 [s]
[2024-09-26 11:49:23,286][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 11:49:23,286][root][INFO] - Score: 77.60 [%]  |  Evaluation Time: 3.22 [s]
[2024-09-26 11:49:23,392][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 11:49:23,393][root][INFO] - Score: 65.20 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-26 11:49:23,394][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 11:49:23,395][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 11:49:26,101][root][INFO] - Step: 75/1035  |  Loss: 1.3487  |  Score: 64.08 [%]  |  Seq Length: 256.0
[2024-09-26 11:49:26,423][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 11:49:26,423][root][INFO] - Score: 70.44 [%]  |  Evaluation Time: 3.14 [s]
[2024-09-26 11:49:26,425][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 11:49:27,883][root][INFO] - Step: 900/1035  |  Loss: 0.3303  |  Score: 90.76 [%]  |  Seq Length: 256.0
[2024-09-26 11:49:31,635][root][INFO] - Step: 90/1035  |  Loss: 1.4792  |  Score: 62.77 [%]  |  Seq Length: 256.0
[2024-09-26 11:49:33,389][root][INFO] - Step: 915/1035  |  Loss: 0.3337  |  Score: 90.98 [%]  |  Seq Length: 256.0
[2024-09-26 11:49:37,168][root][INFO] - Step: 105/1035  |  Loss: 1.3648  |  Score: 60.90 [%]  |  Seq Length: 256.0
[2024-09-26 11:49:38,893][root][INFO] - Step: 930/1035  |  Loss: 0.3600  |  Score: 89.44 [%]  |  Seq Length: 256.0
[2024-09-26 11:49:42,697][root][INFO] - Step: 120/1035  |  Loss: 1.2505  |  Score: 68.07 [%]  |  Seq Length: 256.0
[2024-09-26 11:49:44,400][root][INFO] - Step: 945/1035  |  Loss: 0.3697  |  Score: 88.50 [%]  |  Seq Length: 256.0
[2024-09-26 11:49:48,236][root][INFO] - Step: 135/1035  |  Loss: 1.2024  |  Score: 68.13 [%]  |  Seq Length: 256.0
[2024-09-26 11:49:49,415][root][INFO] - Step: 138/1035  |  Loss: 1.1858  |  Score: 73.19 [%]  |  Seq Length: 256.0
[2024-09-26 11:49:49,910][root][INFO] - Step: 960/1035  |  Loss: 0.3720  |  Score: 87.95 [%]  |  Seq Length: 256.0
[2024-09-26 11:49:52,163][root][INFO] - Step: 966/1035  |  Loss: 0.4003  |  Score: 88.01 [%]  |  Seq Length: 256.0
[2024-09-26 11:49:52,559][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 11:49:52,559][root][INFO] - Score: 74.14 [%]  |  Evaluation Time: 3.14 [s]
[2024-09-26 11:49:55,244][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 11:49:55,245][root][INFO] - Score: 76.98 [%]  |  Evaluation Time: 3.08 [s]
[2024-09-26 11:49:55,500][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 11:49:55,500][root][INFO] - Score: 67.78 [%]  |  Evaluation Time: 2.94 [s]
[2024-09-26 11:49:55,501][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 11:49:55,502][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 11:49:58,386][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 11:49:58,386][root][INFO] - Score: 70.65 [%]  |  Evaluation Time: 3.14 [s]
[2024-09-26 11:49:58,388][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 11:50:00,239][root][INFO] - Step: 150/1035  |  Loss: 1.2068  |  Score: 66.87 [%]  |  Seq Length: 256.0
[2024-09-26 11:50:02,037][root][INFO] - Step: 975/1035  |  Loss: 0.3697  |  Score: 89.32 [%]  |  Seq Length: 256.0
[2024-09-26 11:50:05,738][root][INFO] - Step: 165/1035  |  Loss: 1.0650  |  Score: 69.80 [%]  |  Seq Length: 256.0
[2024-09-26 11:50:07,546][root][INFO] - Step: 990/1035  |  Loss: 0.3408  |  Score: 90.49 [%]  |  Seq Length: 256.0
[2024-09-26 11:50:11,243][root][INFO] - Step: 180/1035  |  Loss: 0.9787  |  Score: 71.08 [%]  |  Seq Length: 256.0
[2024-09-26 11:50:13,055][root][INFO] - Step: 1005/1035  |  Loss: 0.3818  |  Score: 89.79 [%]  |  Seq Length: 256.0
[2024-09-26 11:50:16,748][root][INFO] - Step: 195/1035  |  Loss: 1.1842  |  Score: 72.03 [%]  |  Seq Length: 256.0
[2024-09-26 11:50:18,564][root][INFO] - Step: 1020/1035  |  Loss: 0.3482  |  Score: 90.10 [%]  |  Seq Length: 256.0
[2024-09-26 11:50:21,200][root][INFO] - Step: 207/1035  |  Loss: 1.0907  |  Score: 72.14 [%]  |  Seq Length: 256.0
[2024-09-26 11:50:24,138][root][INFO] - Step: 1035/1035  |  Loss: 0.3151  |  Score: 91.17 [%]  |  Seq Length: 256.0
[2024-09-26 11:50:24,305][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 11:50:24,306][root][INFO] - Score: 77.63 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-26 11:50:27,310][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 11:50:27,310][root][INFO] - Score: 70.10 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-26 11:50:27,311][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 11:50:27,312][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 11:50:27,426][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 11:50:27,426][root][INFO] - Score: 77.80 [%]  |  Evaluation Time: 3.28 [s]
[2024-09-26 11:50:28,771][root][INFO] - Step: 210/1035  |  Loss: 1.0733  |  Score: 74.18 [%]  |  Seq Length: 256.0
[2024-09-26 11:50:30,596][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 11:50:30,597][root][INFO] - Score: 70.37 [%]  |  Evaluation Time: 3.17 [s]
[2024-09-26 11:50:30,598][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 11:50:30,598][root][INFO] - - Epoch: 6
[2024-09-26 11:50:30,598][root][INFO] - - DEV score: 77.71 [%]
[2024-09-26 11:50:30,598][root][INFO] - - TEST score: 70.72 [%]
[2024-09-26 11:50:30,599][root][INFO] - Fine-tuning is done!
[2024-09-26 11:50:34,282][root][INFO] - Step: 225/1035  |  Loss: 0.9538  |  Score: 75.82 [%]  |  Seq Length: 256.0
[2024-09-26 11:50:39,786][root][INFO] - Step: 240/1035  |  Loss: 0.8554  |  Score: 75.50 [%]  |  Seq Length: 256.0
[2024-09-26 11:50:45,289][root][INFO] - Step: 255/1035  |  Loss: 0.9215  |  Score: 76.65 [%]  |  Seq Length: 256.0
[2024-09-26 11:50:50,795][root][INFO] - Step: 270/1035  |  Loss: 0.9457  |  Score: 75.43 [%]  |  Seq Length: 256.0
[2024-09-26 11:50:53,027][root][INFO] - Step: 276/1035  |  Loss: 1.0580  |  Score: 68.92 [%]  |  Seq Length: 256.0
[2024-09-26 11:50:56,126][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 11:50:56,126][root][INFO] - Score: 77.79 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-26 11:50:59,237][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 11:50:59,238][root][INFO] - Score: 70.62 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-26 11:50:59,239][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-26 11:50:59,240][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 11:51:02,851][root][INFO] - Step: 285/1035  |  Loss: 0.8031  |  Score: 79.93 [%]  |  Seq Length: 256.0
[2024-09-26 11:51:08,361][root][INFO] - Step: 300/1035  |  Loss: 0.8312  |  Score: 78.14 [%]  |  Seq Length: 256.0
[2024-09-26 11:51:13,865][root][INFO] - Step: 315/1035  |  Loss: 0.7614  |  Score: 77.96 [%]  |  Seq Length: 256.0
[2024-09-26 11:51:19,368][root][INFO] - Step: 330/1035  |  Loss: 0.7443  |  Score: 79.61 [%]  |  Seq Length: 256.0
[2024-09-26 11:51:24,890][root][INFO] - Step: 345/1035  |  Loss: 0.8749  |  Score: 76.48 [%]  |  Seq Length: 256.0
[2024-09-26 11:51:28,087][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 11:51:28,087][root][INFO] - Score: 74.46 [%]  |  Evaluation Time: 3.19 [s]
[2024-09-26 11:51:31,081][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 11:51:31,081][root][INFO] - Score: 70.54 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-26 11:51:31,083][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 11:51:31,871][root][INFO] - Step: 346/1035  |  Loss: 0.7237  |  Score: 82.22 [%]  |  Seq Length: 256.0
[2024-09-26 11:51:37,014][root][INFO] - Step: 360/1035  |  Loss: 0.7485  |  Score: 79.44 [%]  |  Seq Length: 256.0
[2024-09-26 11:51:42,520][root][INFO] - Step: 375/1035  |  Loss: 0.7012  |  Score: 82.63 [%]  |  Seq Length: 256.0
[2024-09-26 11:51:48,028][root][INFO] - Step: 390/1035  |  Loss: 0.7539  |  Score: 79.16 [%]  |  Seq Length: 256.0
[2024-09-26 11:51:53,534][root][INFO] - Step: 405/1035  |  Loss: 0.6871  |  Score: 80.66 [%]  |  Seq Length: 256.0
[2024-09-26 11:51:56,868][root][INFO] - Step: 414/1035  |  Loss: 0.7319  |  Score: 80.29 [%]  |  Seq Length: 256.0
[2024-09-26 11:51:59,990][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 11:51:59,990][root][INFO] - Score: 77.97 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-26 11:52:02,951][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 11:52:02,951][root][INFO] - Score: 72.64 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-26 11:52:02,952][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 11:52:02,953][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 11:52:05,528][root][INFO] - Step: 420/1035  |  Loss: 0.6564  |  Score: 81.01 [%]  |  Seq Length: 256.0
[2024-09-26 11:52:11,038][root][INFO] - Step: 435/1035  |  Loss: 0.5719  |  Score: 85.82 [%]  |  Seq Length: 256.0
[2024-09-26 11:52:16,549][root][INFO] - Step: 450/1035  |  Loss: 0.6278  |  Score: 82.72 [%]  |  Seq Length: 256.0
[2024-09-26 11:52:22,057][root][INFO] - Step: 465/1035  |  Loss: 0.6191  |  Score: 82.97 [%]  |  Seq Length: 256.0
[2024-09-26 11:52:27,570][root][INFO] - Step: 480/1035  |  Loss: 0.6866  |  Score: 81.67 [%]  |  Seq Length: 256.0
[2024-09-26 11:52:28,704][root][INFO] - Step: 483/1035  |  Loss: 0.6383  |  Score: 82.09 [%]  |  Seq Length: 256.0
[2024-09-26 11:52:31,763][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 11:52:31,763][root][INFO] - Score: 77.80 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-26 11:52:34,794][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 11:52:34,794][root][INFO] - Score: 71.58 [%]  |  Evaluation Time: 3.03 [s]
[2024-09-26 11:52:34,796][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 11:52:39,613][root][INFO] - Step: 495/1035  |  Loss: 0.5490  |  Score: 84.10 [%]  |  Seq Length: 256.0
[2024-09-26 11:52:45,118][root][INFO] - Step: 510/1035  |  Loss: 0.5319  |  Score: 85.85 [%]  |  Seq Length: 256.0
[2024-09-26 11:52:50,623][root][INFO] - Step: 525/1035  |  Loss: 0.6062  |  Score: 84.35 [%]  |  Seq Length: 256.0
[2024-09-26 11:52:56,126][root][INFO] - Step: 540/1035  |  Loss: 0.5132  |  Score: 85.79 [%]  |  Seq Length: 256.0
[2024-09-26 11:53:00,557][root][INFO] - Step: 552/1035  |  Loss: 0.5103  |  Score: 84.42 [%]  |  Seq Length: 256.0
[2024-09-26 11:53:03,736][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 11:53:03,736][root][INFO] - Score: 78.21 [%]  |  Evaluation Time: 3.18 [s]
[2024-09-26 11:53:06,694][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 11:53:06,694][root][INFO] - Score: 72.03 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-26 11:53:06,696][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 11:53:08,220][root][INFO] - Step: 555/1035  |  Loss: 0.5939  |  Score: 84.14 [%]  |  Seq Length: 256.0
[2024-09-26 11:53:13,724][root][INFO] - Step: 570/1035  |  Loss: 0.5033  |  Score: 86.89 [%]  |  Seq Length: 256.0
[2024-09-26 11:53:19,226][root][INFO] - Step: 585/1035  |  Loss: 0.5322  |  Score: 86.52 [%]  |  Seq Length: 256.0
[2024-09-26 11:53:24,729][root][INFO] - Step: 600/1035  |  Loss: 0.5015  |  Score: 86.66 [%]  |  Seq Length: 256.0
[2024-09-26 11:53:30,235][root][INFO] - Step: 615/1035  |  Loss: 0.4757  |  Score: 86.40 [%]  |  Seq Length: 256.0
[2024-09-26 11:53:32,471][root][INFO] - Step: 621/1035  |  Loss: 0.4920  |  Score: 85.61 [%]  |  Seq Length: 256.0
[2024-09-26 11:53:35,574][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 11:53:35,574][root][INFO] - Score: 77.05 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-26 11:53:38,633][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 11:53:38,634][root][INFO] - Score: 71.47 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-26 11:53:38,636][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 11:53:42,269][root][INFO] - Step: 630/1035  |  Loss: 0.4708  |  Score: 88.01 [%]  |  Seq Length: 256.0
[2024-09-26 11:53:47,772][root][INFO] - Step: 645/1035  |  Loss: 0.4341  |  Score: 88.53 [%]  |  Seq Length: 256.0
[2024-09-26 11:53:53,274][root][INFO] - Step: 660/1035  |  Loss: 0.4126  |  Score: 87.92 [%]  |  Seq Length: 256.0
[2024-09-26 11:53:58,776][root][INFO] - Step: 675/1035  |  Loss: 0.4452  |  Score: 87.00 [%]  |  Seq Length: 256.0
[2024-09-26 11:54:04,328][root][INFO] - Step: 690/1035  |  Loss: 0.4415  |  Score: 87.96 [%]  |  Seq Length: 256.0
[2024-09-26 11:54:07,591][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 11:54:07,591][root][INFO] - Score: 77.82 [%]  |  Evaluation Time: 3.26 [s]
[2024-09-26 11:54:10,768][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 11:54:10,768][root][INFO] - Score: 72.47 [%]  |  Evaluation Time: 3.17 [s]
[2024-09-26 11:54:10,770][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 11:54:11,454][root][INFO] - Step: 691/1035  |  Loss: 0.4966  |  Score: 86.36 [%]  |  Seq Length: 256.0
[2024-09-26 11:54:16,591][root][INFO] - Step: 705/1035  |  Loss: 0.4137  |  Score: 88.48 [%]  |  Seq Length: 256.0
[2024-09-26 11:54:22,084][root][INFO] - Step: 720/1035  |  Loss: 0.4251  |  Score: 87.06 [%]  |  Seq Length: 256.0
[2024-09-26 11:54:27,581][root][INFO] - Step: 735/1035  |  Loss: 0.4029  |  Score: 88.93 [%]  |  Seq Length: 256.0
[2024-09-26 11:54:33,085][root][INFO] - Step: 750/1035  |  Loss: 0.4198  |  Score: 88.41 [%]  |  Seq Length: 256.0
[2024-09-26 11:54:36,442][root][INFO] - Step: 759/1035  |  Loss: 0.4147  |  Score: 89.79 [%]  |  Seq Length: 256.0
[2024-09-26 11:54:39,729][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 11:54:39,729][root][INFO] - Score: 78.02 [%]  |  Evaluation Time: 3.28 [s]
[2024-09-26 11:54:42,724][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 11:54:42,725][root][INFO] - Score: 71.83 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-26 11:54:42,729][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 11:54:45,406][root][INFO] - Step: 765/1035  |  Loss: 0.3492  |  Score: 88.73 [%]  |  Seq Length: 256.0
[2024-09-26 11:54:50,959][root][INFO] - Step: 780/1035  |  Loss: 0.3795  |  Score: 89.31 [%]  |  Seq Length: 256.0
[2024-09-26 11:54:56,515][root][INFO] - Step: 795/1035  |  Loss: 0.3844  |  Score: 89.73 [%]  |  Seq Length: 256.0
[2024-09-26 11:55:02,068][root][INFO] - Step: 810/1035  |  Loss: 0.3584  |  Score: 90.26 [%]  |  Seq Length: 256.0
[2024-09-26 11:55:07,619][root][INFO] - Step: 825/1035  |  Loss: 0.4050  |  Score: 88.11 [%]  |  Seq Length: 256.0
[2024-09-26 11:55:08,765][root][INFO] - Step: 828/1035  |  Loss: 0.3388  |  Score: 90.68 [%]  |  Seq Length: 256.0
[2024-09-26 11:55:11,924][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 11:55:11,924][root][INFO] - Score: 78.31 [%]  |  Evaluation Time: 3.16 [s]
[2024-09-26 11:55:14,956][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 11:55:14,957][root][INFO] - Score: 72.03 [%]  |  Evaluation Time: 3.03 [s]
[2024-09-26 11:55:14,961][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 11:55:19,789][root][INFO] - Step: 840/1035  |  Loss: 0.3353  |  Score: 90.41 [%]  |  Seq Length: 256.0
[2024-09-26 11:55:25,343][root][INFO] - Step: 855/1035  |  Loss: 0.3523  |  Score: 90.01 [%]  |  Seq Length: 256.0
[2024-09-26 11:55:30,892][root][INFO] - Step: 870/1035  |  Loss: 0.3577  |  Score: 90.13 [%]  |  Seq Length: 256.0
[2024-09-26 11:55:36,443][root][INFO] - Step: 885/1035  |  Loss: 0.3347  |  Score: 90.60 [%]  |  Seq Length: 256.0
[2024-09-26 11:55:40,909][root][INFO] - Step: 897/1035  |  Loss: 0.3900  |  Score: 88.94 [%]  |  Seq Length: 256.0
[2024-09-26 11:55:44,214][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 11:55:44,214][root][INFO] - Score: 77.66 [%]  |  Evaluation Time: 3.30 [s]
[2024-09-26 11:55:47,178][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 11:55:47,178][root][INFO] - Score: 71.02 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-26 11:55:47,180][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 11:55:48,699][root][INFO] - Step: 900/1035  |  Loss: 0.3828  |  Score: 87.38 [%]  |  Seq Length: 256.0
[2024-09-26 11:55:54,248][root][INFO] - Step: 915/1035  |  Loss: 0.3964  |  Score: 89.03 [%]  |  Seq Length: 256.0
[2024-09-26 11:55:59,793][root][INFO] - Step: 930/1035  |  Loss: 0.3293  |  Score: 90.71 [%]  |  Seq Length: 256.0
[2024-09-26 11:56:05,335][root][INFO] - Step: 945/1035  |  Loss: 0.3427  |  Score: 90.51 [%]  |  Seq Length: 256.0
[2024-09-26 11:56:10,878][root][INFO] - Step: 960/1035  |  Loss: 0.3117  |  Score: 90.83 [%]  |  Seq Length: 256.0
[2024-09-26 11:56:13,129][root][INFO] - Step: 966/1035  |  Loss: 0.3724  |  Score: 89.52 [%]  |  Seq Length: 256.0
[2024-09-26 11:56:16,194][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 11:56:16,194][root][INFO] - Score: 77.26 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-26 11:56:19,233][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 11:56:19,233][root][INFO] - Score: 71.62 [%]  |  Evaluation Time: 3.04 [s]
[2024-09-26 11:56:19,235][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 11:56:22,844][root][INFO] - Step: 975/1035  |  Loss: 0.3609  |  Score: 89.42 [%]  |  Seq Length: 256.0
[2024-09-26 11:56:28,339][root][INFO] - Step: 990/1035  |  Loss: 0.3308  |  Score: 91.49 [%]  |  Seq Length: 256.0
[2024-09-26 11:56:33,840][root][INFO] - Step: 1005/1035  |  Loss: 0.3568  |  Score: 89.84 [%]  |  Seq Length: 256.0
[2024-09-26 11:56:39,339][root][INFO] - Step: 1020/1035  |  Loss: 0.3325  |  Score: 89.93 [%]  |  Seq Length: 256.0
[2024-09-26 11:56:44,859][root][INFO] - Step: 1035/1035  |  Loss: 0.3641  |  Score: 88.96 [%]  |  Seq Length: 256.0
[2024-09-26 11:56:47,904][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 11:56:47,905][root][INFO] - Score: 78.10 [%]  |  Evaluation Time: 3.04 [s]
[2024-09-26 11:56:50,973][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 11:56:50,973][root][INFO] - Score: 71.31 [%]  |  Evaluation Time: 3.07 [s]
[2024-09-26 11:56:50,974][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 11:56:50,974][root][INFO] - - Epoch: 6
[2024-09-26 11:56:50,974][root][INFO] - - DEV score: 77.97 [%]
[2024-09-26 11:56:50,974][root][INFO] - - TEST score: 72.64 [%]
[2024-09-26 11:56:50,975][root][INFO] - Fine-tuning is done!
[2024-09-26 12:15:13,233][root][INFO] - 

[2024-09-26 12:15:13,233][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 12:15:13,233][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 12:15:13,233][root][INFO] - 

[2024-09-26 12:15:13,234][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 12:16:01,477][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 12:16:01,477][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 12:16:01,478][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 12:16:01,478][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 12:16:01,478][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 12:16:01,479][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 12:16:01,479][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 12:16:01,480][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 12:16:01,480][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 12:16:01,480][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 12:16:01,481][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 12:16:01,481][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 12:16:01,482][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 12:16:01,482][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 12:16:01,483][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 12:16:01,483][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 12:16:01,484][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 12:16:01,484][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 12:16:01,484][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 12:16:01,485][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 12:16:01,485][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 12:16:01,486][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 12:16:01,486][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 12:16:01,487][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 12:16:01,488][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 12:16:01,674][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 12:16:05,546][root][INFO] - 

[2024-09-26 12:16:05,546][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 12:16:05,546][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 12:16:05,554][root][INFO] - vocab size              : 51200
[2024-09-26 12:16:05,554][root][INFO] - device                  : gpu
[2024-09-26 12:16:05,555][root][INFO] - random seed             : 42
[2024-09-26 12:16:05,555][root][INFO] - train data size         : 4416
[2024-09-26 12:16:05,555][root][INFO] - max epochs              : 15
[2024-09-26 12:16:05,555][root][INFO] - total steps             : 1035
[2024-09-26 12:16:05,555][root][INFO] - warmup steps            : 104
[2024-09-26 12:16:05,555][root][INFO] - batch size              : 64
[2024-09-26 12:16:05,555][root][INFO] - accumulation steps      : 1
[2024-09-26 12:16:05,555][root][INFO] - optimizer               : adamwscale
[2024-09-26 12:16:05,555][root][INFO] - lr_scheduler            : cosine
[2024-09-26 12:16:05,555][root][INFO] - learning rate           : 0.01
[2024-09-26 12:16:05,555][root][INFO] - max length              : 256

[2024-09-26 12:16:05,556][root][INFO] - LoRA Configuration
[2024-09-26 12:16:05,556][root][INFO] - ㄴ r                    : 32
[2024-09-26 12:16:05,556][root][INFO] - ㄴ alpha                : 128
[2024-09-26 12:16:05,556][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 12:16:05,556][root][INFO] - 

[2024-09-26 12:16:05,556][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 12:16:05,556][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 12:16:05,556][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 12:16:05,556][root][INFO] - * tb interval   : 15

[2024-09-26 12:16:05,556][root][INFO] - 

[2024-09-26 12:16:05,556][root][INFO] - Start the Training !
[2024-09-26 12:16:05,559][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 12:16:13,829][root][INFO] - Step: 15/1035  |  Loss: 3.3881  |  Score: 0.92 [%]  |  Seq Length: 256.0
[2024-09-26 12:16:19,291][root][INFO] - Step: 30/1035  |  Loss: 2.3165  |  Score: 18.38 [%]  |  Seq Length: 256.0
[2024-09-26 12:16:24,768][root][INFO] - Step: 45/1035  |  Loss: 2.0702  |  Score: 33.89 [%]  |  Seq Length: 256.0
[2024-09-26 12:16:30,244][root][INFO] - Step: 60/1035  |  Loss: 1.6511  |  Score: 53.22 [%]  |  Seq Length: 256.0
[2024-09-26 12:16:33,568][root][INFO] - Step: 69/1035  |  Loss: 1.4205  |  Score: 64.34 [%]  |  Seq Length: 256.0
[2024-09-26 12:16:36,645][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 12:16:36,646][root][INFO] - Score: 73.02 [%]  |  Evaluation Time: 3.08 [s]
[2024-09-26 12:16:39,668][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 12:16:39,668][root][INFO] - Score: 65.20 [%]  |  Evaluation Time: 3.02 [s]
[2024-09-26 12:16:39,669][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 12:16:39,670][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 12:16:42,190][root][INFO] - Step: 75/1035  |  Loss: 1.3487  |  Score: 64.08 [%]  |  Seq Length: 256.0
[2024-09-26 12:16:47,690][root][INFO] - Step: 90/1035  |  Loss: 1.4792  |  Score: 62.77 [%]  |  Seq Length: 256.0
[2024-09-26 12:16:53,193][root][INFO] - Step: 105/1035  |  Loss: 1.3648  |  Score: 60.90 [%]  |  Seq Length: 256.0
[2024-09-26 12:16:58,709][root][INFO] - Step: 120/1035  |  Loss: 1.2505  |  Score: 68.07 [%]  |  Seq Length: 256.0
[2024-09-26 12:17:04,227][root][INFO] - Step: 135/1035  |  Loss: 1.2024  |  Score: 68.13 [%]  |  Seq Length: 256.0
[2024-09-26 12:17:05,392][root][INFO] - Step: 138/1035  |  Loss: 1.1858  |  Score: 73.19 [%]  |  Seq Length: 256.0
[2024-09-26 12:17:08,611][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 12:17:08,611][root][INFO] - Score: 74.14 [%]  |  Evaluation Time: 3.22 [s]
[2024-09-26 12:17:11,685][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 12:17:11,685][root][INFO] - Score: 67.78 [%]  |  Evaluation Time: 3.07 [s]
[2024-09-26 12:17:11,686][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 12:17:11,687][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 12:17:16,466][root][INFO] - Step: 150/1035  |  Loss: 1.2068  |  Score: 66.87 [%]  |  Seq Length: 256.0
[2024-09-26 12:17:21,992][root][INFO] - Step: 165/1035  |  Loss: 1.0650  |  Score: 69.80 [%]  |  Seq Length: 256.0
[2024-09-26 12:17:27,517][root][INFO] - Step: 180/1035  |  Loss: 0.9787  |  Score: 71.08 [%]  |  Seq Length: 256.0
[2024-09-26 12:17:33,053][root][INFO] - Step: 195/1035  |  Loss: 1.1842  |  Score: 72.03 [%]  |  Seq Length: 256.0
[2024-09-26 12:17:37,569][root][INFO] - Step: 207/1035  |  Loss: 1.0907  |  Score: 72.14 [%]  |  Seq Length: 256.0
[2024-09-26 12:17:40,734][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 12:17:40,734][root][INFO] - Score: 77.63 [%]  |  Evaluation Time: 3.16 [s]
[2024-09-26 12:17:43,841][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 12:17:43,841][root][INFO] - Score: 70.10 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-26 12:17:43,842][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 12:17:43,843][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 12:17:45,305][root][INFO] - Step: 210/1035  |  Loss: 1.0733  |  Score: 74.18 [%]  |  Seq Length: 256.0
[2024-09-26 12:17:50,865][root][INFO] - Step: 225/1035  |  Loss: 0.9538  |  Score: 75.82 [%]  |  Seq Length: 256.0
[2024-09-26 12:17:56,406][root][INFO] - Step: 240/1035  |  Loss: 0.8554  |  Score: 75.50 [%]  |  Seq Length: 256.0
[2024-09-26 12:18:01,958][root][INFO] - Step: 255/1035  |  Loss: 0.9215  |  Score: 76.65 [%]  |  Seq Length: 256.0
[2024-09-26 12:18:07,530][root][INFO] - Step: 270/1035  |  Loss: 0.9457  |  Score: 75.43 [%]  |  Seq Length: 256.0
[2024-09-26 12:18:09,822][root][INFO] - Step: 276/1035  |  Loss: 1.0580  |  Score: 68.92 [%]  |  Seq Length: 256.0
[2024-09-26 12:18:12,958][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 12:18:12,958][root][INFO] - Score: 77.79 [%]  |  Evaluation Time: 3.13 [s]
[2024-09-26 12:18:15,943][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 12:18:15,943][root][INFO] - Score: 70.62 [%]  |  Evaluation Time: 2.98 [s]
[2024-09-26 12:18:15,945][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-26 12:18:15,946][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 12:18:19,840][root][INFO] - Step: 285/1035  |  Loss: 0.8031  |  Score: 79.93 [%]  |  Seq Length: 256.0
[2024-09-26 12:18:25,437][root][INFO] - Step: 300/1035  |  Loss: 0.8312  |  Score: 78.14 [%]  |  Seq Length: 256.0
[2024-09-26 12:18:31,039][root][INFO] - Step: 315/1035  |  Loss: 0.7614  |  Score: 77.96 [%]  |  Seq Length: 256.0
[2024-09-26 12:18:36,639][root][INFO] - Step: 330/1035  |  Loss: 0.7443  |  Score: 79.61 [%]  |  Seq Length: 256.0
[2024-09-26 12:18:42,283][root][INFO] - Step: 345/1035  |  Loss: 0.8749  |  Score: 76.48 [%]  |  Seq Length: 256.0
[2024-09-26 12:18:45,466][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 12:18:45,466][root][INFO] - Score: 74.46 [%]  |  Evaluation Time: 3.18 [s]
[2024-09-26 12:18:48,537][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 12:18:48,538][root][INFO] - Score: 70.54 [%]  |  Evaluation Time: 3.07 [s]
[2024-09-26 12:18:48,540][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 12:18:49,258][root][INFO] - Step: 346/1035  |  Loss: 0.7237  |  Score: 82.22 [%]  |  Seq Length: 256.0
[2024-09-26 12:18:54,479][root][INFO] - Step: 360/1035  |  Loss: 0.7485  |  Score: 79.44 [%]  |  Seq Length: 256.0
[2024-09-26 12:19:00,070][root][INFO] - Step: 375/1035  |  Loss: 0.7012  |  Score: 82.63 [%]  |  Seq Length: 256.0
[2024-09-26 12:19:05,658][root][INFO] - Step: 390/1035  |  Loss: 0.7539  |  Score: 79.16 [%]  |  Seq Length: 256.0
[2024-09-26 12:19:11,210][root][INFO] - Step: 405/1035  |  Loss: 0.6871  |  Score: 80.66 [%]  |  Seq Length: 256.0
[2024-09-26 12:19:14,570][root][INFO] - Step: 414/1035  |  Loss: 0.7319  |  Score: 80.29 [%]  |  Seq Length: 256.0
[2024-09-26 12:19:17,831][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 12:19:17,831][root][INFO] - Score: 77.97 [%]  |  Evaluation Time: 3.26 [s]
[2024-09-26 12:19:20,883][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 12:19:20,884][root][INFO] - Score: 72.64 [%]  |  Evaluation Time: 3.05 [s]
[2024-09-26 12:19:20,885][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 12:19:20,886][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 12:19:23,463][root][INFO] - Step: 420/1035  |  Loss: 0.6564  |  Score: 81.01 [%]  |  Seq Length: 256.0
[2024-09-26 12:19:29,058][root][INFO] - Step: 435/1035  |  Loss: 0.5719  |  Score: 85.82 [%]  |  Seq Length: 256.0
[2024-09-26 12:19:34,656][root][INFO] - Step: 450/1035  |  Loss: 0.6278  |  Score: 82.72 [%]  |  Seq Length: 256.0
[2024-09-26 12:19:40,217][root][INFO] - Step: 465/1035  |  Loss: 0.6191  |  Score: 82.97 [%]  |  Seq Length: 256.0
[2024-09-26 12:19:45,762][root][INFO] - Step: 480/1035  |  Loss: 0.6866  |  Score: 81.67 [%]  |  Seq Length: 256.0
[2024-09-26 12:19:46,901][root][INFO] - Step: 483/1035  |  Loss: 0.6383  |  Score: 82.09 [%]  |  Seq Length: 256.0
[2024-09-26 12:19:50,149][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 12:19:50,149][root][INFO] - Score: 77.80 [%]  |  Evaluation Time: 3.25 [s]
[2024-09-26 12:19:53,294][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 12:19:53,294][root][INFO] - Score: 71.58 [%]  |  Evaluation Time: 3.14 [s]
[2024-09-26 12:19:53,296][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 12:19:58,064][root][INFO] - Step: 495/1035  |  Loss: 0.5490  |  Score: 84.10 [%]  |  Seq Length: 256.0
[2024-09-26 12:20:03,614][root][INFO] - Step: 510/1035  |  Loss: 0.5319  |  Score: 85.85 [%]  |  Seq Length: 256.0
[2024-09-26 12:20:09,163][root][INFO] - Step: 525/1035  |  Loss: 0.6062  |  Score: 84.35 [%]  |  Seq Length: 256.0
[2024-09-26 12:20:14,718][root][INFO] - Step: 540/1035  |  Loss: 0.5132  |  Score: 85.79 [%]  |  Seq Length: 256.0
[2024-09-26 12:20:19,177][root][INFO] - Step: 552/1035  |  Loss: 0.5103  |  Score: 84.42 [%]  |  Seq Length: 256.0
[2024-09-26 12:20:22,271][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 12:20:22,271][root][INFO] - Score: 78.21 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-26 12:20:25,275][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 12:20:25,275][root][INFO] - Score: 72.03 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-26 12:20:25,277][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 12:20:26,797][root][INFO] - Step: 555/1035  |  Loss: 0.5939  |  Score: 84.14 [%]  |  Seq Length: 256.0
[2024-09-26 12:20:32,388][root][INFO] - Step: 570/1035  |  Loss: 0.5033  |  Score: 86.89 [%]  |  Seq Length: 256.0
[2024-09-26 12:20:38,028][root][INFO] - Step: 585/1035  |  Loss: 0.5322  |  Score: 86.52 [%]  |  Seq Length: 256.0
[2024-09-26 12:20:43,620][root][INFO] - Step: 600/1035  |  Loss: 0.5015  |  Score: 86.66 [%]  |  Seq Length: 256.0
[2024-09-26 12:20:49,211][root][INFO] - Step: 615/1035  |  Loss: 0.4757  |  Score: 86.40 [%]  |  Seq Length: 256.0
[2024-09-26 12:20:51,477][root][INFO] - Step: 621/1035  |  Loss: 0.4920  |  Score: 85.61 [%]  |  Seq Length: 256.0
[2024-09-26 12:20:54,759][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 12:20:54,759][root][INFO] - Score: 77.05 [%]  |  Evaluation Time: 3.28 [s]
[2024-09-26 12:20:57,723][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 12:20:57,723][root][INFO] - Score: 71.47 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-26 12:20:57,725][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 12:21:01,465][root][INFO] - Step: 630/1035  |  Loss: 0.4708  |  Score: 88.01 [%]  |  Seq Length: 256.0
[2024-09-26 12:21:07,005][root][INFO] - Step: 645/1035  |  Loss: 0.4341  |  Score: 88.53 [%]  |  Seq Length: 256.0
[2024-09-26 12:21:12,546][root][INFO] - Step: 660/1035  |  Loss: 0.4126  |  Score: 87.92 [%]  |  Seq Length: 256.0
[2024-09-26 12:21:18,090][root][INFO] - Step: 675/1035  |  Loss: 0.4452  |  Score: 87.00 [%]  |  Seq Length: 256.0
[2024-09-26 12:21:23,675][root][INFO] - Step: 690/1035  |  Loss: 0.4415  |  Score: 87.96 [%]  |  Seq Length: 256.0
[2024-09-26 12:21:26,751][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 12:21:26,751][root][INFO] - Score: 77.82 [%]  |  Evaluation Time: 3.07 [s]
[2024-09-26 12:21:29,775][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 12:21:29,775][root][INFO] - Score: 72.47 [%]  |  Evaluation Time: 3.02 [s]
[2024-09-26 12:21:29,777][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 12:21:30,484][root][INFO] - Step: 691/1035  |  Loss: 0.4966  |  Score: 86.36 [%]  |  Seq Length: 256.0
[2024-09-26 12:21:35,698][root][INFO] - Step: 705/1035  |  Loss: 0.4137  |  Score: 88.48 [%]  |  Seq Length: 256.0
[2024-09-26 12:21:41,263][root][INFO] - Step: 720/1035  |  Loss: 0.4251  |  Score: 87.06 [%]  |  Seq Length: 256.0
[2024-09-26 12:21:46,811][root][INFO] - Step: 735/1035  |  Loss: 0.4029  |  Score: 88.93 [%]  |  Seq Length: 256.0
[2024-09-26 12:21:52,359][root][INFO] - Step: 750/1035  |  Loss: 0.4198  |  Score: 88.41 [%]  |  Seq Length: 256.0
[2024-09-26 12:21:55,740][root][INFO] - Step: 759/1035  |  Loss: 0.4147  |  Score: 89.79 [%]  |  Seq Length: 256.0
[2024-09-26 12:21:58,899][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 12:21:58,899][root][INFO] - Score: 78.02 [%]  |  Evaluation Time: 3.16 [s]
[2024-09-26 12:22:01,838][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 12:22:01,838][root][INFO] - Score: 71.83 [%]  |  Evaluation Time: 2.94 [s]
[2024-09-26 12:22:01,840][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 12:22:04,578][root][INFO] - Step: 765/1035  |  Loss: 0.3492  |  Score: 88.73 [%]  |  Seq Length: 256.0
[2024-09-26 12:22:10,135][root][INFO] - Step: 780/1035  |  Loss: 0.3795  |  Score: 89.31 [%]  |  Seq Length: 256.0
[2024-09-26 12:22:15,684][root][INFO] - Step: 795/1035  |  Loss: 0.3844  |  Score: 89.73 [%]  |  Seq Length: 256.0
[2024-09-26 12:22:21,228][root][INFO] - Step: 810/1035  |  Loss: 0.3584  |  Score: 90.26 [%]  |  Seq Length: 256.0
[2024-09-26 12:22:26,772][root][INFO] - Step: 825/1035  |  Loss: 0.4050  |  Score: 88.11 [%]  |  Seq Length: 256.0
[2024-09-26 12:22:27,945][root][INFO] - Step: 828/1035  |  Loss: 0.3388  |  Score: 90.68 [%]  |  Seq Length: 256.0
[2024-09-26 12:22:31,057][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 12:22:31,057][root][INFO] - Score: 78.31 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-26 12:22:34,150][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 12:22:34,151][root][INFO] - Score: 72.03 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-26 12:22:34,153][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 12:22:38,890][root][INFO] - Step: 840/1035  |  Loss: 0.3353  |  Score: 90.41 [%]  |  Seq Length: 256.0
[2024-09-26 12:22:44,445][root][INFO] - Step: 855/1035  |  Loss: 0.3523  |  Score: 90.01 [%]  |  Seq Length: 256.0
[2024-09-26 12:22:50,116][root][INFO] - Step: 870/1035  |  Loss: 0.3577  |  Score: 90.13 [%]  |  Seq Length: 256.0
[2024-09-26 12:22:55,663][root][INFO] - Step: 885/1035  |  Loss: 0.3347  |  Score: 90.60 [%]  |  Seq Length: 256.0
[2024-09-26 12:23:00,165][root][INFO] - Step: 897/1035  |  Loss: 0.3900  |  Score: 88.94 [%]  |  Seq Length: 256.0
[2024-09-26 12:23:03,393][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 12:23:03,393][root][INFO] - Score: 77.66 [%]  |  Evaluation Time: 3.22 [s]
[2024-09-26 12:23:06,478][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 12:23:06,479][root][INFO] - Score: 71.02 [%]  |  Evaluation Time: 3.08 [s]
[2024-09-26 12:23:06,481][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 12:23:07,925][root][INFO] - Step: 900/1035  |  Loss: 0.3828  |  Score: 87.38 [%]  |  Seq Length: 256.0
[2024-09-26 12:23:13,478][root][INFO] - Step: 915/1035  |  Loss: 0.3964  |  Score: 89.03 [%]  |  Seq Length: 256.0
[2024-09-26 12:23:19,031][root][INFO] - Step: 930/1035  |  Loss: 0.3293  |  Score: 90.71 [%]  |  Seq Length: 256.0
[2024-09-26 12:23:24,586][root][INFO] - Step: 945/1035  |  Loss: 0.3427  |  Score: 90.51 [%]  |  Seq Length: 256.0
[2024-09-26 12:23:30,136][root][INFO] - Step: 960/1035  |  Loss: 0.3117  |  Score: 90.83 [%]  |  Seq Length: 256.0
[2024-09-26 12:23:32,428][root][INFO] - Step: 966/1035  |  Loss: 0.3724  |  Score: 89.52 [%]  |  Seq Length: 256.0
[2024-09-26 12:23:35,543][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 12:23:35,543][root][INFO] - Score: 77.26 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-26 12:23:38,636][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 12:23:38,636][root][INFO] - Score: 71.62 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-26 12:23:38,638][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 12:23:42,295][root][INFO] - Step: 975/1035  |  Loss: 0.3609  |  Score: 89.42 [%]  |  Seq Length: 256.0
[2024-09-26 12:23:47,850][root][INFO] - Step: 990/1035  |  Loss: 0.3308  |  Score: 91.49 [%]  |  Seq Length: 256.0
[2024-09-26 12:23:53,404][root][INFO] - Step: 1005/1035  |  Loss: 0.3568  |  Score: 89.84 [%]  |  Seq Length: 256.0
[2024-09-26 12:23:58,959][root][INFO] - Step: 1020/1035  |  Loss: 0.3325  |  Score: 89.93 [%]  |  Seq Length: 256.0
[2024-09-26 12:24:04,566][root][INFO] - Step: 1035/1035  |  Loss: 0.3641  |  Score: 88.96 [%]  |  Seq Length: 256.0
[2024-09-26 12:24:07,698][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 12:24:07,698][root][INFO] - Score: 78.10 [%]  |  Evaluation Time: 3.13 [s]
[2024-09-26 12:24:10,724][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 12:24:10,724][root][INFO] - Score: 71.31 [%]  |  Evaluation Time: 3.02 [s]
[2024-09-26 12:24:10,726][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 12:24:10,726][root][INFO] - - Epoch: 6
[2024-09-26 12:24:10,727][root][INFO] - - DEV score: 77.97 [%]
[2024-09-26 12:24:10,727][root][INFO] - - TEST score: 72.64 [%]
[2024-09-26 12:24:10,729][root][INFO] - Fine-tuning is done!
[2024-09-26 13:23:25,776][root][INFO] - 

[2024-09-26 13:23:25,776][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 13:23:25,776][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 13:23:25,776][root][INFO] - 

[2024-09-26 13:23:25,776][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 13:23:55,263][root][INFO] - 

[2024-09-26 13:23:55,263][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 13:23:55,263][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 13:23:55,263][root][INFO] - 

[2024-09-26 13:23:55,263][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 13:23:59,686][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 13:23:59,687][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 13:23:59,687][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 13:23:59,688][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 13:23:59,688][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 13:23:59,689][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 13:23:59,689][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 13:23:59,690][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 13:23:59,690][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 13:23:59,691][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 13:23:59,691][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 13:23:59,692][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 13:23:59,692][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 13:23:59,693][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 13:23:59,694][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 13:23:59,694][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 13:23:59,695][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 13:23:59,695][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 13:23:59,696][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 13:23:59,696][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 13:23:59,697][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 13:23:59,697][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 13:23:59,698][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 13:23:59,698][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 13:23:59,701][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 13:23:59,705][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-26 13:23:59,809][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-26 13:23:59,811][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-26 13:24:00,137][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 13:24:06,727][root][INFO] - 

[2024-09-26 13:24:06,728][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 13:24:06,728][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 13:24:06,737][root][INFO] - vocab size              : 51200
[2024-09-26 13:24:06,737][root][INFO] - device                  : gpu
[2024-09-26 13:24:06,737][root][INFO] - random seed             : 42
[2024-09-26 13:24:06,737][root][INFO] - train data size         : 4416
[2024-09-26 13:24:06,737][root][INFO] - max epochs              : 15
[2024-09-26 13:24:06,737][root][INFO] - total steps             : 1035
[2024-09-26 13:24:06,737][root][INFO] - warmup steps            : 104
[2024-09-26 13:24:06,738][root][INFO] - batch size              : 64
[2024-09-26 13:24:06,738][root][INFO] - accumulation steps      : 1
[2024-09-26 13:24:06,738][root][INFO] - optimizer               : adamwscale
[2024-09-26 13:24:06,738][root][INFO] - lr_scheduler            : cosine
[2024-09-26 13:24:06,738][root][INFO] - learning rate           : 0.01
[2024-09-26 13:24:06,738][root][INFO] - max length              : 256

[2024-09-26 13:24:06,738][root][INFO] - LoRA Configuration
[2024-09-26 13:24:06,738][root][INFO] - ㄴ r                    : 32
[2024-09-26 13:24:06,738][root][INFO] - ㄴ alpha                : 128
[2024-09-26 13:24:06,738][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 13:24:06,738][root][INFO] - KOMBO Configuration
[2024-09-26 13:24:06,739][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-26 13:24:06,739][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-26 13:24:06,739][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-26 13:24:06,739][root][INFO] - ㄴ do_combination       : True
[2024-09-26 13:24:06,739][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-26 13:24:06,739][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-26 13:24:06,739][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-26 13:24:06,739][root][INFO] -   ㄴ add_lora           : True

[2024-09-26 13:24:06,739][root][INFO] - LoRA in KOMBO Configuration
[2024-09-26 13:24:06,739][root][INFO] - ㄴ r                : 32
[2024-09-26 13:24:06,740][root][INFO] - ㄴ alpha            : 128
[2024-09-26 13:24:06,740][root][INFO] - ㄴ dropout          : 0.03

[2024-09-26 13:24:06,740][root][INFO] - 

[2024-09-26 13:24:06,740][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 13:24:06,740][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 13:24:06,740][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 13:24:06,740][root][INFO] - * tb interval   : 15

[2024-09-26 13:24:06,740][root][INFO] - 

[2024-09-26 13:24:06,740][root][INFO] - Start the Training !
[2024-09-26 13:24:06,743][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 13:24:16,196][root][INFO] - Step: 15/1035  |  Loss: 3.3856  |  Score: -1.96 [%]  |  Seq Length: 256.0
[2024-09-26 13:24:23,830][root][INFO] - Step: 30/1035  |  Loss: 2.1969  |  Score: 24.69 [%]  |  Seq Length: 256.0
[2024-09-26 13:24:31,443][root][INFO] - Step: 45/1035  |  Loss: 1.8412  |  Score: 47.33 [%]  |  Seq Length: 256.0
[2024-09-26 13:24:38,646][root][INFO] - 

[2024-09-26 13:24:38,646][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 13:24:38,646][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 13:24:38,646][root][INFO] - 

[2024-09-26 13:24:38,646][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 13:24:39,347][root][INFO] - Step: 60/1035  |  Loss: 1.6613  |  Score: 59.57 [%]  |  Seq Length: 256.0
[2024-09-26 13:24:43,280][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 13:24:43,281][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 13:24:43,281][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 13:24:43,281][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 13:24:43,282][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 13:24:43,282][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 13:24:43,283][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 13:24:43,283][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 13:24:43,284][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 13:24:43,284][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 13:24:43,285][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 13:24:43,285][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 13:24:43,286][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 13:24:43,286][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 13:24:43,287][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 13:24:43,287][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 13:24:43,288][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 13:24:43,288][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 13:24:43,289][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 13:24:43,289][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 13:24:43,290][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 13:24:43,290][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 13:24:43,291][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 13:24:43,291][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 13:24:43,293][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 13:24:43,296][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-26 13:24:43,306][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-26 13:24:43,308][root][INFO] - Trainable params: 2471424 || all params: 127636224 || trainable: 1.94 %
[2024-09-26 13:24:43,484][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 13:24:43,962][root][INFO] - Step: 69/1035  |  Loss: 1.5947  |  Score: 51.78 [%]  |  Seq Length: 256.0
[2024-09-26 13:24:47,318][root][INFO] - 

[2024-09-26 13:24:47,319][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 13:24:47,319][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 13:24:47,326][root][INFO] - vocab size              : 51200
[2024-09-26 13:24:47,326][root][INFO] - device                  : gpu
[2024-09-26 13:24:47,327][root][INFO] - random seed             : 42
[2024-09-26 13:24:47,327][root][INFO] - train data size         : 4416
[2024-09-26 13:24:47,327][root][INFO] - max epochs              : 15
[2024-09-26 13:24:47,327][root][INFO] - total steps             : 1035
[2024-09-26 13:24:47,327][root][INFO] - warmup steps            : 104
[2024-09-26 13:24:47,327][root][INFO] - batch size              : 64
[2024-09-26 13:24:47,327][root][INFO] - accumulation steps      : 1
[2024-09-26 13:24:47,327][root][INFO] - optimizer               : adamwscale
[2024-09-26 13:24:47,327][root][INFO] - lr_scheduler            : cosine
[2024-09-26 13:24:47,327][root][INFO] - learning rate           : 0.01
[2024-09-26 13:24:47,327][root][INFO] - max length              : 256

[2024-09-26 13:24:47,328][root][INFO] - LoRA Configuration
[2024-09-26 13:24:47,328][root][INFO] - ㄴ r                    : 32
[2024-09-26 13:24:47,328][root][INFO] - ㄴ alpha                : 128
[2024-09-26 13:24:47,328][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 13:24:47,328][root][INFO] - KOMBO Configuration
[2024-09-26 13:24:47,328][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-26 13:24:47,328][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-26 13:24:47,328][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-26 13:24:47,328][root][INFO] - ㄴ do_combination       : False
[2024-09-26 13:24:47,328][root][INFO] - ㄴ reducer              : linear

[2024-09-26 13:24:47,328][root][INFO] - LoRA in KOMBO Configuration
[2024-09-26 13:24:47,329][root][INFO] - ㄴ r                : 32
[2024-09-26 13:24:47,329][root][INFO] - ㄴ alpha            : 128
[2024-09-26 13:24:47,329][root][INFO] - ㄴ dropout          : 0.03

[2024-09-26 13:24:47,329][root][INFO] - 

[2024-09-26 13:24:47,329][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 13:24:47,329][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 13:24:47,329][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 13:24:47,329][root][INFO] - * tb interval   : 15

[2024-09-26 13:24:47,329][root][INFO] - 

[2024-09-26 13:24:47,329][root][INFO] - Start the Training !
[2024-09-26 13:24:47,332][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 13:24:48,922][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 13:24:48,922][root][INFO] - Score: 70.42 [%]  |  Evaluation Time: 4.96 [s]
[2024-09-26 13:24:53,531][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 13:24:53,532][root][INFO] - Score: 64.66 [%]  |  Evaluation Time: 4.61 [s]
[2024-09-26 13:24:53,533][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 13:24:53,534][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 13:24:56,995][root][INFO] - Step: 75/1035  |  Loss: 1.2224  |  Score: 69.56 [%]  |  Seq Length: 256.0
[2024-09-26 13:24:57,041][root][INFO] - Step: 15/1035  |  Loss: 3.4593  |  Score: 3.18 [%]  |  Seq Length: 256.0
[2024-09-26 13:25:03,984][root][INFO] - Step: 30/1035  |  Loss: 2.3275  |  Score: 18.58 [%]  |  Seq Length: 256.0
[2024-09-26 13:25:04,677][root][INFO] - Step: 90/1035  |  Loss: 1.3008  |  Score: 64.42 [%]  |  Seq Length: 256.0
[2024-09-26 13:25:10,927][root][INFO] - Step: 45/1035  |  Loss: 1.9236  |  Score: 37.64 [%]  |  Seq Length: 256.0
[2024-09-26 13:25:12,404][root][INFO] - Step: 105/1035  |  Loss: 1.2851  |  Score: 61.06 [%]  |  Seq Length: 256.0
[2024-09-26 13:25:17,953][root][INFO] - Step: 60/1035  |  Loss: 1.6016  |  Score: 59.08 [%]  |  Seq Length: 256.0
[2024-09-26 13:25:20,062][root][INFO] - Step: 120/1035  |  Loss: 1.3046  |  Score: 65.26 [%]  |  Seq Length: 256.0
[2024-09-26 13:25:22,193][root][INFO] - Step: 69/1035  |  Loss: 1.5479  |  Score: 59.59 [%]  |  Seq Length: 256.0
[2024-09-26 13:25:26,747][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 13:25:26,747][root][INFO] - Score: 70.68 [%]  |  Evaluation Time: 4.55 [s]
[2024-09-26 13:25:27,710][root][INFO] - Step: 135/1035  |  Loss: 1.2586  |  Score: 65.44 [%]  |  Seq Length: 256.0
[2024-09-26 13:25:29,265][root][INFO] - Step: 138/1035  |  Loss: 1.1120  |  Score: 67.89 [%]  |  Seq Length: 256.0
[2024-09-26 13:25:30,975][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 13:25:30,975][root][INFO] - Score: 63.93 [%]  |  Evaluation Time: 4.23 [s]
[2024-09-26 13:25:30,976][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 13:25:30,978][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 13:25:34,051][root][INFO] - Step: 75/1035  |  Loss: 1.3397  |  Score: 63.76 [%]  |  Seq Length: 256.0
[2024-09-26 13:25:34,188][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 13:25:34,188][root][INFO] - Score: 75.11 [%]  |  Evaluation Time: 4.92 [s]
[2024-09-26 13:25:38,849][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 13:25:38,849][root][INFO] - Score: 69.41 [%]  |  Evaluation Time: 4.66 [s]
[2024-09-26 13:25:38,850][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 13:25:38,851][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 13:25:41,004][root][INFO] - Step: 90/1035  |  Loss: 1.2591  |  Score: 64.92 [%]  |  Seq Length: 256.0
[2024-09-26 13:25:45,302][root][INFO] - Step: 150/1035  |  Loss: 1.2671  |  Score: 69.49 [%]  |  Seq Length: 256.0
[2024-09-26 13:25:47,974][root][INFO] - Step: 105/1035  |  Loss: 1.2608  |  Score: 62.73 [%]  |  Seq Length: 256.0
[2024-09-26 13:25:52,991][root][INFO] - Step: 165/1035  |  Loss: 1.1232  |  Score: 71.85 [%]  |  Seq Length: 256.0
[2024-09-26 13:25:54,921][root][INFO] - Step: 120/1035  |  Loss: 1.2869  |  Score: 66.46 [%]  |  Seq Length: 256.0
[2024-09-26 13:26:00,686][root][INFO] - Step: 180/1035  |  Loss: 1.0549  |  Score: 70.63 [%]  |  Seq Length: 256.0
[2024-09-26 13:26:01,881][root][INFO] - Step: 135/1035  |  Loss: 1.2600  |  Score: 63.71 [%]  |  Seq Length: 256.0
[2024-09-26 13:26:03,299][root][INFO] - Step: 138/1035  |  Loss: 1.3759  |  Score: 61.31 [%]  |  Seq Length: 256.0
[2024-09-26 13:26:07,752][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 13:26:07,752][root][INFO] - Score: 73.10 [%]  |  Evaluation Time: 4.45 [s]
[2024-09-26 13:26:08,435][root][INFO] - Step: 195/1035  |  Loss: 1.0351  |  Score: 69.80 [%]  |  Seq Length: 256.0
[2024-09-26 13:26:12,125][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 13:26:12,125][root][INFO] - Score: 63.06 [%]  |  Evaluation Time: 4.37 [s]
[2024-09-26 13:26:12,126][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 13:26:12,127][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 13:26:14,617][root][INFO] - Step: 207/1035  |  Loss: 1.0530  |  Score: 68.92 [%]  |  Seq Length: 256.0
[2024-09-26 13:26:18,139][root][INFO] - Step: 150/1035  |  Loss: 1.1078  |  Score: 67.69 [%]  |  Seq Length: 256.0
[2024-09-26 13:26:19,518][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 13:26:19,518][root][INFO] - Score: 77.40 [%]  |  Evaluation Time: 4.90 [s]
[2024-09-26 13:26:24,282][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 13:26:24,282][root][INFO] - Score: 71.40 [%]  |  Evaluation Time: 4.76 [s]
[2024-09-26 13:26:24,283][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 13:26:24,284][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 13:26:25,188][root][INFO] - Step: 165/1035  |  Loss: 1.0149  |  Score: 72.54 [%]  |  Seq Length: 256.0
[2024-09-26 13:26:26,275][root][INFO] - Step: 210/1035  |  Loss: 1.0227  |  Score: 72.25 [%]  |  Seq Length: 256.0
[2024-09-26 13:26:32,144][root][INFO] - Step: 180/1035  |  Loss: 1.1496  |  Score: 68.98 [%]  |  Seq Length: 256.0
[2024-09-26 13:26:34,012][root][INFO] - Step: 225/1035  |  Loss: 0.9600  |  Score: 73.70 [%]  |  Seq Length: 256.0
[2024-09-26 13:26:39,110][root][INFO] - Step: 195/1035  |  Loss: 1.1136  |  Score: 69.13 [%]  |  Seq Length: 256.0
[2024-09-26 13:26:41,735][root][INFO] - Step: 240/1035  |  Loss: 0.9905  |  Score: 73.66 [%]  |  Seq Length: 256.0
[2024-09-26 13:26:44,773][root][INFO] - Step: 207/1035  |  Loss: 1.0314  |  Score: 73.88 [%]  |  Seq Length: 256.0
[2024-09-26 13:26:49,284][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 13:26:49,285][root][INFO] - Score: 77.77 [%]  |  Evaluation Time: 4.51 [s]
[2024-09-26 13:26:49,434][root][INFO] - Step: 255/1035  |  Loss: 0.9398  |  Score: 74.91 [%]  |  Seq Length: 256.0
[2024-09-26 13:26:53,508][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 13:26:53,509][root][INFO] - Score: 69.15 [%]  |  Evaluation Time: 4.22 [s]
[2024-09-26 13:26:53,510][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 13:26:53,511][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 13:26:55,219][root][INFO] - Step: 210/1035  |  Loss: 0.7489  |  Score: 77.78 [%]  |  Seq Length: 256.0
[2024-09-26 13:26:57,168][root][INFO] - Step: 270/1035  |  Loss: 0.8866  |  Score: 73.25 [%]  |  Seq Length: 256.0
[2024-09-26 13:27:00,240][root][INFO] - Step: 276/1035  |  Loss: 0.8458  |  Score: 77.29 [%]  |  Seq Length: 256.0
[2024-09-26 13:27:02,171][root][INFO] - Step: 225/1035  |  Loss: 0.8530  |  Score: 79.09 [%]  |  Seq Length: 256.0
[2024-09-26 13:27:05,297][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 13:27:05,297][root][INFO] - Score: 77.65 [%]  |  Evaluation Time: 5.05 [s]
[2024-09-26 13:27:09,139][root][INFO] - Step: 240/1035  |  Loss: 1.1183  |  Score: 71.73 [%]  |  Seq Length: 256.0
[2024-09-26 13:27:09,920][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 13:27:09,921][root][INFO] - Score: 71.01 [%]  |  Evaluation Time: 4.62 [s]
[2024-09-26 13:27:09,923][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 13:27:14,938][root][INFO] - Step: 285/1035  |  Loss: 0.8161  |  Score: 78.86 [%]  |  Seq Length: 256.0
[2024-09-26 13:27:16,086][root][INFO] - Step: 255/1035  |  Loss: 0.9435  |  Score: 73.07 [%]  |  Seq Length: 256.0
[2024-09-26 13:27:22,689][root][INFO] - Step: 300/1035  |  Loss: 0.8012  |  Score: 78.96 [%]  |  Seq Length: 256.0
[2024-09-26 13:27:23,032][root][INFO] - Step: 270/1035  |  Loss: 0.9312  |  Score: 74.67 [%]  |  Seq Length: 256.0
[2024-09-26 13:27:25,870][root][INFO] - Step: 276/1035  |  Loss: 0.9581  |  Score: 72.70 [%]  |  Seq Length: 256.0
[2024-09-26 13:27:30,380][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 13:27:30,381][root][INFO] - Score: 78.18 [%]  |  Evaluation Time: 4.51 [s]
[2024-09-26 13:27:30,468][root][INFO] - Step: 315/1035  |  Loss: 0.8084  |  Score: 79.58 [%]  |  Seq Length: 256.0
[2024-09-26 13:27:34,754][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 13:27:34,755][root][INFO] - Score: 69.50 [%]  |  Evaluation Time: 4.37 [s]
[2024-09-26 13:27:34,756][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-26 13:27:34,757][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 13:27:38,269][root][INFO] - Step: 330/1035  |  Loss: 0.8107  |  Score: 75.45 [%]  |  Seq Length: 256.0
[2024-09-26 13:27:39,359][root][INFO] - Step: 285/1035  |  Loss: 0.8133  |  Score: 76.45 [%]  |  Seq Length: 256.0
[2024-09-26 13:27:46,000][root][INFO] - Step: 345/1035  |  Loss: 0.8349  |  Score: 75.64 [%]  |  Seq Length: 256.0
[2024-09-26 13:27:46,320][root][INFO] - Step: 300/1035  |  Loss: 0.9869  |  Score: 72.85 [%]  |  Seq Length: 256.0
[2024-09-26 13:27:50,922][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 13:27:50,922][root][INFO] - Score: 78.14 [%]  |  Evaluation Time: 4.92 [s]
[2024-09-26 13:27:53,270][root][INFO] - Step: 315/1035  |  Loss: 0.8455  |  Score: 78.64 [%]  |  Seq Length: 256.0
[2024-09-26 13:27:55,528][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 13:27:55,528][root][INFO] - Score: 70.17 [%]  |  Evaluation Time: 4.60 [s]
[2024-09-26 13:27:55,530][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 13:27:56,429][root][INFO] - Step: 346/1035  |  Loss: 0.4873  |  Score: 86.12 [%]  |  Seq Length: 256.0
[2024-09-26 13:28:00,252][root][INFO] - Step: 330/1035  |  Loss: 0.8301  |  Score: 77.08 [%]  |  Seq Length: 256.0
[2024-09-26 13:28:03,604][root][INFO] - Step: 360/1035  |  Loss: 0.6315  |  Score: 83.78 [%]  |  Seq Length: 256.0
[2024-09-26 13:28:07,216][root][INFO] - Step: 345/1035  |  Loss: 0.7948  |  Score: 78.10 [%]  |  Seq Length: 256.0
[2024-09-26 13:28:11,319][root][INFO] - Step: 375/1035  |  Loss: 0.7183  |  Score: 81.37 [%]  |  Seq Length: 256.0
[2024-09-26 13:28:11,688][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 13:28:11,688][root][INFO] - Score: 76.79 [%]  |  Evaluation Time: 4.47 [s]
[2024-09-26 13:28:15,969][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 13:28:15,969][root][INFO] - Score: 72.09 [%]  |  Evaluation Time: 4.28 [s]
[2024-09-26 13:28:15,970][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 13:28:15,972][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 13:28:16,864][root][INFO] - Step: 346/1035  |  Loss: 0.5245  |  Score: 83.37 [%]  |  Seq Length: 256.0
[2024-09-26 13:28:19,147][root][INFO] - Step: 390/1035  |  Loss: 0.7015  |  Score: 81.27 [%]  |  Seq Length: 256.0
[2024-09-26 13:28:23,400][root][INFO] - Step: 360/1035  |  Loss: 0.7868  |  Score: 79.25 [%]  |  Seq Length: 256.0
[2024-09-26 13:28:26,941][root][INFO] - Step: 405/1035  |  Loss: 0.7973  |  Score: 77.47 [%]  |  Seq Length: 256.0
[2024-09-26 13:28:30,340][root][INFO] - Step: 375/1035  |  Loss: 0.7794  |  Score: 78.25 [%]  |  Seq Length: 256.0
[2024-09-26 13:28:31,649][root][INFO] - Step: 414/1035  |  Loss: 0.7427  |  Score: 79.15 [%]  |  Seq Length: 256.0
[2024-09-26 13:28:36,768][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 13:28:36,768][root][INFO] - Score: 79.11 [%]  |  Evaluation Time: 5.12 [s]
[2024-09-26 13:28:37,292][root][INFO] - Step: 390/1035  |  Loss: 0.7409  |  Score: 79.98 [%]  |  Seq Length: 256.0
[2024-09-26 13:28:41,582][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 13:28:41,582][root][INFO] - Score: 72.14 [%]  |  Evaluation Time: 4.81 [s]
[2024-09-26 13:28:41,583][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 13:28:41,584][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 13:28:44,251][root][INFO] - Step: 405/1035  |  Loss: 0.7010  |  Score: 81.20 [%]  |  Seq Length: 256.0
[2024-09-26 13:28:45,107][root][INFO] - Step: 420/1035  |  Loss: 0.5648  |  Score: 83.66 [%]  |  Seq Length: 256.0
[2024-09-26 13:28:48,445][root][INFO] - Step: 414/1035  |  Loss: 0.7319  |  Score: 79.85 [%]  |  Seq Length: 256.0
[2024-09-26 13:28:52,892][root][INFO] - Step: 435/1035  |  Loss: 0.6557  |  Score: 82.83 [%]  |  Seq Length: 256.0
[2024-09-26 13:28:52,914][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 13:28:52,914][root][INFO] - Score: 77.88 [%]  |  Evaluation Time: 4.47 [s]
[2024-09-26 13:28:57,255][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 13:28:57,255][root][INFO] - Score: 71.48 [%]  |  Evaluation Time: 4.34 [s]
[2024-09-26 13:28:57,257][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 13:28:57,258][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 13:29:00,338][root][INFO] - Step: 420/1035  |  Loss: 0.6668  |  Score: 81.12 [%]  |  Seq Length: 256.0
[2024-09-26 13:29:00,618][root][INFO] - Step: 450/1035  |  Loss: 0.6205  |  Score: 84.33 [%]  |  Seq Length: 256.0
[2024-09-26 13:29:07,373][root][INFO] - Step: 435/1035  |  Loss: 0.6528  |  Score: 82.38 [%]  |  Seq Length: 256.0
[2024-09-26 13:29:08,324][root][INFO] - Step: 465/1035  |  Loss: 0.6604  |  Score: 81.83 [%]  |  Seq Length: 256.0
[2024-09-26 13:29:14,415][root][INFO] - Step: 450/1035  |  Loss: 0.6784  |  Score: 83.83 [%]  |  Seq Length: 256.0
[2024-09-26 13:29:16,008][root][INFO] - Step: 480/1035  |  Loss: 0.6625  |  Score: 81.27 [%]  |  Seq Length: 256.0
[2024-09-26 13:29:17,571][root][INFO] - Step: 483/1035  |  Loss: 0.4958  |  Score: 88.86 [%]  |  Seq Length: 256.0
[2024-09-26 13:29:21,469][root][INFO] - Step: 465/1035  |  Loss: 0.7350  |  Score: 80.31 [%]  |  Seq Length: 256.0
[2024-09-26 13:29:22,478][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 13:29:22,478][root][INFO] - Score: 77.38 [%]  |  Evaluation Time: 4.90 [s]
[2024-09-26 13:29:27,146][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 13:29:27,146][root][INFO] - Score: 71.32 [%]  |  Evaluation Time: 4.67 [s]
[2024-09-26 13:29:27,149][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 13:29:28,531][root][INFO] - Step: 480/1035  |  Loss: 0.7076  |  Score: 80.61 [%]  |  Seq Length: 256.0
[2024-09-26 13:29:30,000][root][INFO] - Step: 483/1035  |  Loss: 0.6359  |  Score: 84.61 [%]  |  Seq Length: 256.0
[2024-09-26 13:29:33,983][root][INFO] - Step: 495/1035  |  Loss: 0.4998  |  Score: 85.55 [%]  |  Seq Length: 256.0
[2024-09-26 13:29:34,642][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 13:29:34,642][root][INFO] - Score: 77.00 [%]  |  Evaluation Time: 4.64 [s]
[2024-09-26 13:29:38,837][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 13:29:38,837][root][INFO] - Score: 69.31 [%]  |  Evaluation Time: 4.19 [s]
[2024-09-26 13:29:38,840][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 13:29:41,893][root][INFO] - Step: 510/1035  |  Loss: 0.6210  |  Score: 83.80 [%]  |  Seq Length: 256.0
[2024-09-26 13:29:44,739][root][INFO] - Step: 495/1035  |  Loss: 0.5542  |  Score: 84.52 [%]  |  Seq Length: 256.0
[2024-09-26 13:29:49,703][root][INFO] - Step: 525/1035  |  Loss: 0.5482  |  Score: 84.95 [%]  |  Seq Length: 256.0
[2024-09-26 13:29:51,698][root][INFO] - Step: 510/1035  |  Loss: 0.6191  |  Score: 83.74 [%]  |  Seq Length: 256.0
[2024-09-26 13:29:57,570][root][INFO] - Step: 540/1035  |  Loss: 0.5213  |  Score: 86.00 [%]  |  Seq Length: 256.0
[2024-09-26 13:29:58,659][root][INFO] - Step: 525/1035  |  Loss: 0.5913  |  Score: 83.27 [%]  |  Seq Length: 256.0
[2024-09-26 13:30:03,823][root][INFO] - Step: 552/1035  |  Loss: 0.6675  |  Score: 83.93 [%]  |  Seq Length: 256.0
[2024-09-26 13:30:05,620][root][INFO] - Step: 540/1035  |  Loss: 0.6140  |  Score: 84.58 [%]  |  Seq Length: 256.0
[2024-09-26 13:30:08,739][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 13:30:08,739][root][INFO] - Score: 77.98 [%]  |  Evaluation Time: 4.91 [s]
[2024-09-26 13:30:11,196][root][INFO] - Step: 552/1035  |  Loss: 0.6078  |  Score: 82.21 [%]  |  Seq Length: 256.0
[2024-09-26 13:30:13,470][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 13:30:13,471][root][INFO] - Score: 70.72 [%]  |  Evaluation Time: 4.73 [s]
[2024-09-26 13:30:13,475][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 13:30:15,523][root][INFO] - Step: 555/1035  |  Loss: 0.7172  |  Score: 85.09 [%]  |  Seq Length: 256.0
[2024-09-26 13:30:15,782][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 13:30:15,782][root][INFO] - Score: 77.99 [%]  |  Evaluation Time: 4.58 [s]
[2024-09-26 13:30:19,944][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 13:30:19,945][root][INFO] - Score: 72.23 [%]  |  Evaluation Time: 4.16 [s]
[2024-09-26 13:30:19,946][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-26 13:30:19,947][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 13:30:21,644][root][INFO] - Step: 555/1035  |  Loss: 0.5338  |  Score: 87.87 [%]  |  Seq Length: 256.0
[2024-09-26 13:30:23,326][root][INFO] - Step: 570/1035  |  Loss: 0.5123  |  Score: 87.48 [%]  |  Seq Length: 256.0
[2024-09-26 13:30:28,606][root][INFO] - Step: 570/1035  |  Loss: 0.5319  |  Score: 86.32 [%]  |  Seq Length: 256.0
[2024-09-26 13:30:31,059][root][INFO] - Step: 585/1035  |  Loss: 0.4568  |  Score: 86.20 [%]  |  Seq Length: 256.0
[2024-09-26 13:30:35,557][root][INFO] - Step: 585/1035  |  Loss: 0.5402  |  Score: 85.20 [%]  |  Seq Length: 256.0
[2024-09-26 13:30:38,796][root][INFO] - Step: 600/1035  |  Loss: 0.4904  |  Score: 86.64 [%]  |  Seq Length: 256.0
[2024-09-26 13:30:42,502][root][INFO] - Step: 600/1035  |  Loss: 0.5424  |  Score: 84.39 [%]  |  Seq Length: 256.0
[2024-09-26 13:30:46,509][root][INFO] - Step: 615/1035  |  Loss: 0.5467  |  Score: 85.86 [%]  |  Seq Length: 256.0
[2024-09-26 13:30:49,443][root][INFO] - Step: 615/1035  |  Loss: 0.5351  |  Score: 86.55 [%]  |  Seq Length: 256.0
[2024-09-26 13:30:49,661][root][INFO] - Step: 621/1035  |  Loss: 0.4896  |  Score: 86.77 [%]  |  Seq Length: 256.0
[2024-09-26 13:30:52,266][root][INFO] - Step: 621/1035  |  Loss: 0.5559  |  Score: 82.48 [%]  |  Seq Length: 256.0
[2024-09-26 13:30:54,795][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 13:30:54,795][root][INFO] - Score: 77.24 [%]  |  Evaluation Time: 5.13 [s]
[2024-09-26 13:30:56,793][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 13:30:56,794][root][INFO] - Score: 77.26 [%]  |  Evaluation Time: 4.52 [s]
[2024-09-26 13:30:59,446][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 13:30:59,447][root][INFO] - Score: 71.98 [%]  |  Evaluation Time: 4.65 [s]
[2024-09-26 13:30:59,449][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 13:31:01,114][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 13:31:01,114][root][INFO] - Score: 71.36 [%]  |  Evaluation Time: 4.32 [s]
[2024-09-26 13:31:01,116][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 13:31:04,466][root][INFO] - Step: 630/1035  |  Loss: 0.4956  |  Score: 85.48 [%]  |  Seq Length: 256.0
[2024-09-26 13:31:05,744][root][INFO] - Step: 630/1035  |  Loss: 0.4510  |  Score: 86.59 [%]  |  Seq Length: 256.0
[2024-09-26 13:31:12,144][root][INFO] - Step: 645/1035  |  Loss: 0.4492  |  Score: 88.19 [%]  |  Seq Length: 256.0
[2024-09-26 13:31:12,714][root][INFO] - Step: 645/1035  |  Loss: 0.4798  |  Score: 87.51 [%]  |  Seq Length: 256.0
[2024-09-26 13:31:19,667][root][INFO] - Step: 660/1035  |  Loss: 0.4906  |  Score: 86.33 [%]  |  Seq Length: 256.0
[2024-09-26 13:31:19,843][root][INFO] - Step: 660/1035  |  Loss: 0.4297  |  Score: 88.04 [%]  |  Seq Length: 256.0
[2024-09-26 13:31:26,631][root][INFO] - Step: 675/1035  |  Loss: 0.4196  |  Score: 88.57 [%]  |  Seq Length: 256.0
[2024-09-26 13:31:27,613][root][INFO] - Step: 675/1035  |  Loss: 0.4644  |  Score: 86.82 [%]  |  Seq Length: 256.0
[2024-09-26 13:31:33,639][root][INFO] - Step: 690/1035  |  Loss: 0.4578  |  Score: 86.69 [%]  |  Seq Length: 256.0
[2024-09-26 13:31:35,361][root][INFO] - Step: 690/1035  |  Loss: 0.4339  |  Score: 88.27 [%]  |  Seq Length: 256.0
[2024-09-26 13:31:38,187][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 13:31:38,187][root][INFO] - Score: 77.58 [%]  |  Evaluation Time: 4.54 [s]
[2024-09-26 13:31:40,448][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 13:31:40,448][root][INFO] - Score: 77.84 [%]  |  Evaluation Time: 5.08 [s]
[2024-09-26 13:31:42,500][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 13:31:42,500][root][INFO] - Score: 70.87 [%]  |  Evaluation Time: 4.31 [s]
[2024-09-26 13:31:42,502][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 13:31:43,423][root][INFO] - Step: 691/1035  |  Loss: 0.4815  |  Score: 88.03 [%]  |  Seq Length: 256.0
[2024-09-26 13:31:45,074][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 13:31:45,075][root][INFO] - Score: 72.73 [%]  |  Evaluation Time: 4.62 [s]
[2024-09-26 13:31:45,079][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 13:31:46,007][root][INFO] - Step: 691/1035  |  Loss: 0.2767  |  Score: 92.24 [%]  |  Seq Length: 256.0
[2024-09-26 13:31:49,913][root][INFO] - Step: 705/1035  |  Loss: 0.4318  |  Score: 88.23 [%]  |  Seq Length: 256.0
[2024-09-26 13:31:53,196][root][INFO] - Step: 705/1035  |  Loss: 0.3898  |  Score: 90.16 [%]  |  Seq Length: 256.0
[2024-09-26 13:31:56,855][root][INFO] - Step: 720/1035  |  Loss: 0.4553  |  Score: 88.35 [%]  |  Seq Length: 256.0
[2024-09-26 13:32:00,916][root][INFO] - Step: 720/1035  |  Loss: 0.4152  |  Score: 89.08 [%]  |  Seq Length: 256.0
[2024-09-26 13:32:03,804][root][INFO] - Step: 735/1035  |  Loss: 0.4148  |  Score: 89.05 [%]  |  Seq Length: 256.0
[2024-09-26 13:32:08,698][root][INFO] - Step: 735/1035  |  Loss: 0.4333  |  Score: 87.23 [%]  |  Seq Length: 256.0
[2024-09-26 13:32:10,795][root][INFO] - Step: 750/1035  |  Loss: 0.4218  |  Score: 88.11 [%]  |  Seq Length: 256.0
[2024-09-26 13:32:14,997][root][INFO] - Step: 759/1035  |  Loss: 0.3832  |  Score: 89.50 [%]  |  Seq Length: 256.0
[2024-09-26 13:32:16,416][root][INFO] - Step: 750/1035  |  Loss: 0.4414  |  Score: 87.63 [%]  |  Seq Length: 256.0
[2024-09-26 13:32:19,508][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 13:32:19,508][root][INFO] - Score: 77.17 [%]  |  Evaluation Time: 4.51 [s]
[2024-09-26 13:32:21,129][root][INFO] - Step: 759/1035  |  Loss: 0.3660  |  Score: 89.38 [%]  |  Seq Length: 256.0
[2024-09-26 13:32:23,721][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 13:32:23,721][root][INFO] - Score: 71.17 [%]  |  Evaluation Time: 4.21 [s]
[2024-09-26 13:32:23,723][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 13:32:26,183][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 13:32:26,183][root][INFO] - Score: 77.77 [%]  |  Evaluation Time: 5.05 [s]
[2024-09-26 13:32:26,875][root][INFO] - Step: 765/1035  |  Loss: 0.3438  |  Score: 89.39 [%]  |  Seq Length: 256.0
[2024-09-26 13:32:30,903][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 13:32:30,903][root][INFO] - Score: 71.75 [%]  |  Evaluation Time: 4.72 [s]
[2024-09-26 13:32:30,905][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 13:32:33,953][root][INFO] - Step: 780/1035  |  Loss: 0.4219  |  Score: 88.10 [%]  |  Seq Length: 256.0
[2024-09-26 13:32:34,581][root][INFO] - Step: 765/1035  |  Loss: 0.4035  |  Score: 89.68 [%]  |  Seq Length: 256.0
[2024-09-26 13:32:41,016][root][INFO] - Step: 795/1035  |  Loss: 0.3962  |  Score: 88.51 [%]  |  Seq Length: 256.0
[2024-09-26 13:32:42,338][root][INFO] - Step: 780/1035  |  Loss: 0.3981  |  Score: 88.77 [%]  |  Seq Length: 256.0
[2024-09-26 13:32:48,048][root][INFO] - Step: 810/1035  |  Loss: 0.3938  |  Score: 88.97 [%]  |  Seq Length: 256.0
[2024-09-26 13:32:50,040][root][INFO] - Step: 795/1035  |  Loss: 0.4055  |  Score: 88.79 [%]  |  Seq Length: 256.0
[2024-09-26 13:32:55,097][root][INFO] - Step: 825/1035  |  Loss: 0.3827  |  Score: 89.88 [%]  |  Seq Length: 256.0
[2024-09-26 13:32:56,535][root][INFO] - Step: 828/1035  |  Loss: 0.3665  |  Score: 90.03 [%]  |  Seq Length: 256.0
[2024-09-26 13:32:57,746][root][INFO] - Step: 810/1035  |  Loss: 0.4001  |  Score: 88.50 [%]  |  Seq Length: 256.0
[2024-09-26 13:33:01,164][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 13:33:01,164][root][INFO] - Score: 77.98 [%]  |  Evaluation Time: 4.63 [s]
[2024-09-26 13:33:05,434][root][INFO] - Step: 825/1035  |  Loss: 0.4043  |  Score: 88.73 [%]  |  Seq Length: 256.0
[2024-09-26 13:33:05,471][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 13:33:05,471][root][INFO] - Score: 70.45 [%]  |  Evaluation Time: 4.30 [s]
[2024-09-26 13:33:05,474][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 13:33:06,988][root][INFO] - Step: 828/1035  |  Loss: 0.3785  |  Score: 86.59 [%]  |  Seq Length: 256.0
[2024-09-26 13:33:11,445][root][INFO] - Step: 840/1035  |  Loss: 0.3359  |  Score: 90.55 [%]  |  Seq Length: 256.0
[2024-09-26 13:33:11,898][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 13:33:11,899][root][INFO] - Score: 77.81 [%]  |  Evaluation Time: 4.91 [s]
[2024-09-26 13:33:16,545][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 13:33:16,545][root][INFO] - Score: 71.40 [%]  |  Evaluation Time: 4.64 [s]
[2024-09-26 13:33:16,547][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 13:33:18,405][root][INFO] - Step: 855/1035  |  Loss: 0.3333  |  Score: 91.17 [%]  |  Seq Length: 256.0
[2024-09-26 13:33:23,096][root][INFO] - Step: 840/1035  |  Loss: 0.3536  |  Score: 90.34 [%]  |  Seq Length: 256.0
[2024-09-26 13:33:25,451][root][INFO] - Step: 870/1035  |  Loss: 0.3541  |  Score: 89.87 [%]  |  Seq Length: 256.0
[2024-09-26 13:33:30,851][root][INFO] - Step: 855/1035  |  Loss: 0.3686  |  Score: 89.94 [%]  |  Seq Length: 256.0
[2024-09-26 13:33:32,501][root][INFO] - Step: 885/1035  |  Loss: 0.3900  |  Score: 89.29 [%]  |  Seq Length: 256.0
[2024-09-26 13:33:38,157][root][INFO] - Step: 897/1035  |  Loss: 0.4147  |  Score: 89.60 [%]  |  Seq Length: 256.0
[2024-09-26 13:33:38,542][root][INFO] - Step: 870/1035  |  Loss: 0.3649  |  Score: 89.93 [%]  |  Seq Length: 256.0
[2024-09-26 13:33:42,592][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 13:33:42,593][root][INFO] - Score: 78.15 [%]  |  Evaluation Time: 4.43 [s]
[2024-09-26 13:33:46,296][root][INFO] - Step: 885/1035  |  Loss: 0.3502  |  Score: 90.89 [%]  |  Seq Length: 256.0
[2024-09-26 13:33:46,973][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 13:33:46,973][root][INFO] - Score: 70.13 [%]  |  Evaluation Time: 4.38 [s]
[2024-09-26 13:33:46,976][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 13:33:48,750][root][INFO] - Step: 900/1035  |  Loss: 0.3624  |  Score: 89.20 [%]  |  Seq Length: 256.0
[2024-09-26 13:33:52,509][root][INFO] - Step: 897/1035  |  Loss: 0.3590  |  Score: 89.19 [%]  |  Seq Length: 256.0
[2024-09-26 13:33:55,702][root][INFO] - Step: 915/1035  |  Loss: 0.3365  |  Score: 90.30 [%]  |  Seq Length: 256.0
[2024-09-26 13:33:57,552][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 13:33:57,552][root][INFO] - Score: 77.02 [%]  |  Evaluation Time: 5.04 [s]
[2024-09-26 13:34:02,244][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 13:34:02,244][root][INFO] - Score: 71.11 [%]  |  Evaluation Time: 4.69 [s]
[2024-09-26 13:34:02,247][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 13:34:02,655][root][INFO] - Step: 930/1035  |  Loss: 0.3492  |  Score: 89.93 [%]  |  Seq Length: 256.0
[2024-09-26 13:34:04,200][root][INFO] - Step: 900/1035  |  Loss: 0.3381  |  Score: 92.32 [%]  |  Seq Length: 256.0
[2024-09-26 13:34:09,774][root][INFO] - Step: 945/1035  |  Loss: 0.3127  |  Score: 91.24 [%]  |  Seq Length: 256.0
[2024-09-26 13:34:11,870][root][INFO] - Step: 915/1035  |  Loss: 0.3494  |  Score: 90.36 [%]  |  Seq Length: 256.0
[2024-09-26 13:34:16,717][root][INFO] - Step: 960/1035  |  Loss: 0.3537  |  Score: 89.39 [%]  |  Seq Length: 256.0
[2024-09-26 13:34:19,350][root][INFO] - Step: 930/1035  |  Loss: 0.3290  |  Score: 90.22 [%]  |  Seq Length: 256.0
[2024-09-26 13:34:19,523][root][INFO] - Step: 966/1035  |  Loss: 0.3743  |  Score: 89.08 [%]  |  Seq Length: 256.0
[2024-09-26 13:34:24,166][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 13:34:24,167][root][INFO] - Score: 78.57 [%]  |  Evaluation Time: 4.64 [s]
[2024-09-26 13:34:26,900][root][INFO] - Step: 945/1035  |  Loss: 0.3466  |  Score: 89.53 [%]  |  Seq Length: 256.0
[2024-09-26 13:34:28,412][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 13:34:28,412][root][INFO] - Score: 70.05 [%]  |  Evaluation Time: 4.24 [s]
[2024-09-26 13:34:28,414][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 13:34:32,860][root][INFO] - Step: 975/1035  |  Loss: 0.3532  |  Score: 88.97 [%]  |  Seq Length: 256.0
[2024-09-26 13:34:34,370][root][INFO] - Step: 960/1035  |  Loss: 0.3527  |  Score: 90.13 [%]  |  Seq Length: 256.0
[2024-09-26 13:34:37,379][root][INFO] - Step: 966/1035  |  Loss: 0.3617  |  Score: 90.61 [%]  |  Seq Length: 256.0
[2024-09-26 13:34:39,826][root][INFO] - Step: 990/1035  |  Loss: 0.3136  |  Score: 91.36 [%]  |  Seq Length: 256.0
[2024-09-26 13:34:42,250][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 13:34:42,250][root][INFO] - Score: 77.20 [%]  |  Evaluation Time: 4.87 [s]
[2024-09-26 13:34:46,778][root][INFO] - Step: 1005/1035  |  Loss: 0.3503  |  Score: 89.98 [%]  |  Seq Length: 256.0
[2024-09-26 13:34:46,964][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 13:34:46,964][root][INFO] - Score: 71.44 [%]  |  Evaluation Time: 4.71 [s]
[2024-09-26 13:34:46,967][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 13:34:52,044][root][INFO] - Step: 975/1035  |  Loss: 0.3750  |  Score: 88.72 [%]  |  Seq Length: 256.0
[2024-09-26 13:34:53,729][root][INFO] - Step: 1020/1035  |  Loss: 0.3515  |  Score: 90.92 [%]  |  Seq Length: 256.0
[2024-09-26 13:34:59,829][root][INFO] - Step: 990/1035  |  Loss: 0.3671  |  Score: 90.35 [%]  |  Seq Length: 256.0
[2024-09-26 13:35:00,738][root][INFO] - Step: 1035/1035  |  Loss: 0.3511  |  Score: 90.49 [%]  |  Seq Length: 256.0
[2024-09-26 13:35:05,184][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 13:35:05,185][root][INFO] - Score: 78.32 [%]  |  Evaluation Time: 4.44 [s]
[2024-09-26 13:35:07,581][root][INFO] - Step: 1005/1035  |  Loss: 0.3143  |  Score: 90.33 [%]  |  Seq Length: 256.0
[2024-09-26 13:35:09,452][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 13:35:09,453][root][INFO] - Score: 70.61 [%]  |  Evaluation Time: 4.27 [s]
[2024-09-26 13:35:09,454][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 13:35:09,454][root][INFO] - - Epoch: 8
[2024-09-26 13:35:09,454][root][INFO] - - DEV score: 77.99 [%]
[2024-09-26 13:35:09,454][root][INFO] - - TEST score: 72.23 [%]
[2024-09-26 13:35:09,455][root][INFO] - Fine-tuning is done!
[2024-09-26 13:35:15,291][root][INFO] - Step: 1020/1035  |  Loss: 0.3216  |  Score: 90.74 [%]  |  Seq Length: 256.0
[2024-09-26 13:35:22,993][root][INFO] - Step: 1035/1035  |  Loss: 0.3454  |  Score: 90.05 [%]  |  Seq Length: 256.0
[2024-09-26 13:35:28,057][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 13:35:28,057][root][INFO] - Score: 77.65 [%]  |  Evaluation Time: 5.06 [s]
[2024-09-26 13:35:32,638][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 13:35:32,638][root][INFO] - Score: 72.58 [%]  |  Evaluation Time: 4.58 [s]
[2024-09-26 13:35:32,639][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 13:35:32,639][root][INFO] - - Epoch: 6
[2024-09-26 13:35:32,639][root][INFO] - - DEV score: 79.11 [%]
[2024-09-26 13:35:32,639][root][INFO] - - TEST score: 72.14 [%]
[2024-09-26 13:35:32,640][root][INFO] - Fine-tuning is done!
[2024-09-26 18:30:21,170][root][INFO] - 

[2024-09-26 18:30:21,170][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 18:30:21,171][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:30:21,171][root][INFO] - 

[2024-09-26 18:30:21,171][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 18:30:25,484][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 18:30:25,485][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 18:30:25,485][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 18:30:25,486][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 18:30:25,486][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 18:30:25,487][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 18:30:25,487][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 18:30:25,488][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 18:30:25,488][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 18:30:25,489][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 18:30:25,489][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 18:30:25,490][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 18:30:25,490][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 18:30:25,491][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 18:30:25,491][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 18:30:25,492][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 18:30:25,492][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 18:30:25,493][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 18:30:25,493][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 18:30:25,494][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 18:30:25,494][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 18:30:25,495][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 18:30:25,495][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 18:30:25,495][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 18:30:25,497][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 18:30:25,822][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 18:31:16,646][root][INFO] - 

[2024-09-26 18:31:16,646][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 18:31:16,646][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:31:16,646][root][INFO] - 

[2024-09-26 18:31:16,646][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 18:31:35,125][root][INFO] - 

[2024-09-26 18:31:35,125][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 18:31:35,125][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:31:35,125][root][INFO] - 

[2024-09-26 18:31:35,125][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 18:31:39,871][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 18:31:39,871][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 18:31:39,872][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 18:31:39,872][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 18:31:39,873][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 18:31:39,873][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 18:31:39,873][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 18:31:39,874][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 18:31:39,874][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 18:31:39,875][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 18:31:39,876][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 18:31:39,876][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 18:31:39,877][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 18:31:39,877][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 18:31:39,878][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 18:31:39,878][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 18:31:39,879][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 18:31:39,879][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 18:31:39,880][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 18:31:39,880][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 18:31:39,881][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 18:31:39,881][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 18:31:39,882][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 18:31:39,882][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 18:31:39,884][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 18:31:40,117][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 18:31:43,922][root][INFO] - 

[2024-09-26 18:31:43,923][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 18:31:43,923][root][INFO] - Data Preprocessing
[2024-09-26 18:31:43,923][root][INFO] - ㄴ remain_lang                ko_punc
[2024-09-26 18:31:43,923][root][INFO] - ㄴ do_hangeulize              True
[2024-09-26 18:31:43,923][root][INFO] - ㄴ data_remove                True

[2024-09-26 18:31:43,923][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 18:31:43,931][root][INFO] - vocab size              : 51200
[2024-09-26 18:31:43,931][root][INFO] - device                  : gpu
[2024-09-26 18:31:43,931][root][INFO] - random seed             : 42
[2024-09-26 18:31:43,932][root][INFO] - train data size         : 4096
[2024-09-26 18:31:43,932][root][INFO] - max epochs              : 15
[2024-09-26 18:31:43,932][root][INFO] - total steps             : 960
[2024-09-26 18:31:43,932][root][INFO] - warmup steps            : 96
[2024-09-26 18:31:43,932][root][INFO] - batch size              : 64
[2024-09-26 18:31:43,932][root][INFO] - accumulation steps      : 1
[2024-09-26 18:31:43,932][root][INFO] - optimizer               : adamwscale
[2024-09-26 18:31:43,932][root][INFO] - lr_scheduler            : cosine
[2024-09-26 18:31:43,932][root][INFO] - learning rate           : 0.01
[2024-09-26 18:31:43,932][root][INFO] - max length              : 256

[2024-09-26 18:31:43,932][root][INFO] - LoRA Configuration
[2024-09-26 18:31:43,932][root][INFO] - ㄴ r                    : 32
[2024-09-26 18:31:43,933][root][INFO] - ㄴ alpha                : 128
[2024-09-26 18:31:43,933][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 18:31:43,933][root][INFO] - 

[2024-09-26 18:31:43,933][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:31:43,933][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 18:31:43,933][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 18:31:43,933][root][INFO] - * tb interval   : 15

[2024-09-26 18:31:43,933][root][INFO] - 

[2024-09-26 18:31:43,933][root][INFO] - Start the Training !
[2024-09-26 18:31:43,936][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 18:31:52,368][root][INFO] - Step: 15/960  |  Loss: 3.2171  |  Score: 3.58 [%]  |  Seq Length: 256.0
[2024-09-26 18:31:57,816][root][INFO] - 

[2024-09-26 18:31:57,817][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 18:31:57,817][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:31:57,817][root][INFO] - 

[2024-09-26 18:31:57,817][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 18:31:57,866][root][INFO] - Step: 30/960  |  Loss: 2.4091  |  Score: 21.72 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:01,712][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 18:32:01,713][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 18:32:01,714][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 18:32:01,715][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 18:32:01,716][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 18:32:01,717][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 18:32:01,718][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 18:32:01,719][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 18:32:01,720][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 18:32:01,721][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 18:32:01,722][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 18:32:01,723][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 18:32:01,723][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 18:32:01,725][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 18:32:01,725][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 18:32:01,726][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 18:32:01,727][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 18:32:01,728][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 18:32:01,729][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 18:32:01,730][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 18:32:01,731][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 18:32:01,731][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 18:32:01,732][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 18:32:01,733][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 18:32:01,735][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 18:32:02,086][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 18:32:03,365][root][INFO] - Step: 45/960  |  Loss: 2.0137  |  Score: 42.06 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:05,859][root][INFO] - 

[2024-09-26 18:32:05,859][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 18:32:05,859][root][INFO] - Data Preprocessing
[2024-09-26 18:32:05,859][root][INFO] - ㄴ remain_lang                ko
[2024-09-26 18:32:05,859][root][INFO] - ㄴ do_hangeulize              True
[2024-09-26 18:32:05,859][root][INFO] - ㄴ data_remove                True

[2024-09-26 18:32:05,859][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 18:32:05,868][root][INFO] - vocab size              : 51200
[2024-09-26 18:32:05,868][root][INFO] - device                  : gpu
[2024-09-26 18:32:05,868][root][INFO] - random seed             : 42
[2024-09-26 18:32:05,868][root][INFO] - train data size         : 448
[2024-09-26 18:32:05,868][root][INFO] - max epochs              : 15
[2024-09-26 18:32:05,868][root][INFO] - total steps             : 105
[2024-09-26 18:32:05,869][root][INFO] - warmup steps            : 10
[2024-09-26 18:32:05,869][root][INFO] - batch size              : 64
[2024-09-26 18:32:05,869][root][INFO] - accumulation steps      : 1
[2024-09-26 18:32:05,869][root][INFO] - optimizer               : adamwscale
[2024-09-26 18:32:05,869][root][INFO] - lr_scheduler            : cosine
[2024-09-26 18:32:05,869][root][INFO] - learning rate           : 0.01
[2024-09-26 18:32:05,869][root][INFO] - max length              : 256

[2024-09-26 18:32:05,869][root][INFO] - LoRA Configuration
[2024-09-26 18:32:05,869][root][INFO] - ㄴ r                    : 32
[2024-09-26 18:32:05,869][root][INFO] - ㄴ alpha                : 128
[2024-09-26 18:32:05,869][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 18:32:05,870][root][INFO] - 

[2024-09-26 18:32:05,870][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:32:05,870][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 18:32:05,870][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 18:32:05,870][root][INFO] - * tb interval   : 15

[2024-09-26 18:32:05,870][root][INFO] - 

[2024-09-26 18:32:05,870][root][INFO] - Start the Training !
[2024-09-26 18:32:05,873][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 18:32:06,550][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 18:32:06,551][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 18:32:06,551][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 18:32:06,552][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 18:32:06,552][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 18:32:06,553][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 18:32:06,553][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 18:32:06,554][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 18:32:06,554][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 18:32:06,555][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 18:32:06,555][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 18:32:06,555][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 18:32:06,556][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 18:32:06,556][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 18:32:06,557][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 18:32:06,557][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 18:32:06,558][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 18:32:06,558][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 18:32:06,559][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 18:32:06,559][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 18:32:06,560][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 18:32:06,560][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 18:32:06,560][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 18:32:06,561][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 18:32:06,562][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 18:32:06,887][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 18:32:08,885][root][INFO] - Step: 60/960  |  Loss: 1.7086  |  Score: 52.16 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:10,388][root][INFO] - Step: 64/960  |  Loss: 1.5735  |  Score: 59.58 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:11,280][root][INFO] - Step: 7/105  |  Loss: 5.0383  |  Score: -4.30 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:11,700][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 18:32:11,700][root][INFO] - Score: 1.78 [%]  |  Evaluation Time: 0.42 [s]
[2024-09-26 18:32:11,896][root][INFO] - 

[2024-09-26 18:32:11,896][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 18:32:11,896][root][INFO] - Data Preprocessing
[2024-09-26 18:32:11,896][root][INFO] - ㄴ remain_lang                ko_en_punc
[2024-09-26 18:32:11,896][root][INFO] - ㄴ do_hangeulize              True
[2024-09-26 18:32:11,896][root][INFO] - ㄴ data_remove                True

[2024-09-26 18:32:11,897][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 18:32:11,905][root][INFO] - vocab size              : 51200
[2024-09-26 18:32:11,905][root][INFO] - device                  : gpu
[2024-09-26 18:32:11,905][root][INFO] - random seed             : 42
[2024-09-26 18:32:11,905][root][INFO] - train data size         : 4416
[2024-09-26 18:32:11,905][root][INFO] - max epochs              : 15
[2024-09-26 18:32:11,906][root][INFO] - total steps             : 1035
[2024-09-26 18:32:11,906][root][INFO] - warmup steps            : 104
[2024-09-26 18:32:11,906][root][INFO] - batch size              : 64
[2024-09-26 18:32:11,906][root][INFO] - accumulation steps      : 1
[2024-09-26 18:32:11,906][root][INFO] - optimizer               : adamwscale
[2024-09-26 18:32:11,906][root][INFO] - lr_scheduler            : cosine
[2024-09-26 18:32:11,906][root][INFO] - learning rate           : 0.01
[2024-09-26 18:32:11,906][root][INFO] - max length              : 256

[2024-09-26 18:32:11,906][root][INFO] - LoRA Configuration
[2024-09-26 18:32:11,906][root][INFO] - ㄴ r                    : 32
[2024-09-26 18:32:11,906][root][INFO] - ㄴ alpha                : 128
[2024-09-26 18:32:11,907][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 18:32:11,907][root][INFO] - 

[2024-09-26 18:32:11,907][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:32:11,907][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 18:32:11,907][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 18:32:11,907][root][INFO] - * tb interval   : 15

[2024-09-26 18:32:11,907][root][INFO] - 

[2024-09-26 18:32:11,907][root][INFO] - Start the Training !
[2024-09-26 18:32:11,910][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 18:32:12,094][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 18:32:12,094][root][INFO] - Score: -13.68 [%]  |  Evaluation Time: 0.39 [s]
[2024-09-26 18:32:12,096][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 18:32:13,282][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 18:32:13,283][root][INFO] - Score: 71.92 [%]  |  Evaluation Time: 2.89 [s]
[2024-09-26 18:32:14,872][root][INFO] - Step: 14/105  |  Loss: 2.8932  |  Score: 9.80 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:15,266][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 18:32:15,267][root][INFO] - Score: 0.01 [%]  |  Evaluation Time: 0.39 [s]
[2024-09-26 18:32:15,635][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 18:32:15,635][root][INFO] - Score: -1.39 [%]  |  Evaluation Time: 0.37 [s]
[2024-09-26 18:32:15,638][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 18:32:16,142][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 18:32:16,143][root][INFO] - Score: 61.92 [%]  |  Evaluation Time: 2.86 [s]
[2024-09-26 18:32:16,144][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 18:32:16,145][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 18:32:16,413][root][INFO] - Step: 15/105  |  Loss: 2.1525  |  Score: 26.63 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:18,478][root][INFO] - Step: 21/105  |  Loss: 2.0978  |  Score: 34.06 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:18,876][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 18:32:18,876][root][INFO] - Score: 12.49 [%]  |  Evaluation Time: 0.39 [s]
[2024-09-26 18:32:19,286][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 18:32:19,286][root][INFO] - Score: 5.61 [%]  |  Evaluation Time: 0.41 [s]
[2024-09-26 18:32:19,287][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 18:32:19,288][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 18:32:20,544][root][INFO] - Step: 75/960  |  Loss: 1.4354  |  Score: 62.03 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:20,796][root][INFO] - Step: 15/1035  |  Loss: 3.2320  |  Score: 8.30 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:22,086][root][INFO] - Step: 28/105  |  Loss: 1.7231  |  Score: 54.79 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:22,517][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 18:32:22,517][root][INFO] - Score: 21.36 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-26 18:32:22,920][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 18:32:22,920][root][INFO] - Score: 17.17 [%]  |  Evaluation Time: 0.40 [s]
[2024-09-26 18:32:22,921][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-26 18:32:22,922][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 18:32:23,992][root][INFO] - Step: 30/105  |  Loss: 1.5142  |  Score: 70.43 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:25,683][root][INFO] - Step: 35/105  |  Loss: 1.4010  |  Score: 63.34 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:26,063][root][INFO] - Step: 90/960  |  Loss: 1.4031  |  Score: 63.32 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:26,083][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 18:32:26,083][root][INFO] - Score: 29.03 [%]  |  Evaluation Time: 0.40 [s]
[2024-09-26 18:32:26,481][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 18:32:26,481][root][INFO] - Score: 28.72 [%]  |  Evaluation Time: 0.40 [s]
[2024-09-26 18:32:26,482][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 18:32:26,483][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 18:32:26,526][root][INFO] - Step: 30/1035  |  Loss: 2.2783  |  Score: 19.95 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:29,179][root][INFO] - Step: 42/105  |  Loss: 1.0899  |  Score: 74.52 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:29,576][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 18:32:29,576][root][INFO] - Score: 34.90 [%]  |  Evaluation Time: 0.39 [s]
[2024-09-26 18:32:29,944][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 18:32:29,944][root][INFO] - Score: 30.82 [%]  |  Evaluation Time: 0.37 [s]
[2024-09-26 18:32:29,945][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 18:32:29,946][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 18:32:31,381][root][INFO] - Step: 45/105  |  Loss: 0.9675  |  Score: 77.42 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:31,592][root][INFO] - Step: 105/960  |  Loss: 1.2867  |  Score: 65.80 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:32,256][root][INFO] - Step: 45/1035  |  Loss: 1.9845  |  Score: 37.75 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:32,697][root][INFO] - Step: 49/105  |  Loss: 0.8794  |  Score: 80.23 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:33,144][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 18:32:33,145][root][INFO] - Score: 36.90 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-26 18:32:33,512][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 18:32:33,513][root][INFO] - Score: 31.79 [%]  |  Evaluation Time: 0.37 [s]
[2024-09-26 18:32:33,514][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-26 18:32:33,516][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 18:32:36,251][root][INFO] - Step: 56/105  |  Loss: 0.7995  |  Score: 79.29 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:36,645][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 18:32:36,645][root][INFO] - Score: 39.79 [%]  |  Evaluation Time: 0.39 [s]
[2024-09-26 18:32:37,018][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 18:32:37,018][root][INFO] - Score: 33.71 [%]  |  Evaluation Time: 0.37 [s]
[2024-09-26 18:32:37,019][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-26 18:32:37,021][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 18:32:37,118][root][INFO] - Step: 120/960  |  Loss: 1.3070  |  Score: 67.76 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:37,975][root][INFO] - Step: 60/1035  |  Loss: 1.6977  |  Score: 55.19 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:38,881][root][INFO] - Step: 60/105  |  Loss: 0.6678  |  Score: 86.26 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:39,819][root][INFO] - Step: 63/105  |  Loss: 0.7053  |  Score: 81.76 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:40,110][root][INFO] - Step: 128/960  |  Loss: 1.2106  |  Score: 66.70 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:40,239][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 18:32:40,239][root][INFO] - Score: 39.81 [%]  |  Evaluation Time: 0.42 [s]
[2024-09-26 18:32:40,642][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 18:32:40,643][root][INFO] - Score: 33.50 [%]  |  Evaluation Time: 0.40 [s]
[2024-09-26 18:32:40,645][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 18:32:41,422][root][INFO] - Step: 69/1035  |  Loss: 1.5733  |  Score: 59.65 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:43,037][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 18:32:43,037][root][INFO] - Score: 76.57 [%]  |  Evaluation Time: 2.92 [s]
[2024-09-26 18:32:43,440][root][INFO] - Step: 70/105  |  Loss: 0.6832  |  Score: 85.57 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:43,881][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 18:32:43,882][root][INFO] - Score: 41.25 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-26 18:32:44,274][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 18:32:44,274][root][INFO] - Score: 32.54 [%]  |  Evaluation Time: 0.39 [s]
[2024-09-26 18:32:44,275][root][INFO] - 
Save new Best Score (Epoch: 10)
[2024-09-26 18:32:44,276][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 18:32:44,503][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 18:32:44,503][root][INFO] - Score: 73.07 [%]  |  Evaluation Time: 3.08 [s]
[2024-09-26 18:32:46,078][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 18:32:46,078][root][INFO] - Score: 68.05 [%]  |  Evaluation Time: 3.04 [s]
[2024-09-26 18:32:46,080][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 18:32:46,081][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 18:32:46,540][root][INFO] - Step: 75/105  |  Loss: 0.5427  |  Score: 87.48 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:47,116][root][INFO] - Step: 77/105  |  Loss: 0.4340  |  Score: 82.38 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:47,458][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 18:32:47,458][root][INFO] - Score: 61.76 [%]  |  Evaluation Time: 2.95 [s]
[2024-09-26 18:32:47,459][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 18:32:47,461][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 18:32:47,504][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 18:32:47,504][root][INFO] - Score: 40.19 [%]  |  Evaluation Time: 0.38 [s]
[2024-09-26 18:32:47,863][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 18:32:47,863][root][INFO] - Score: 32.94 [%]  |  Evaluation Time: 0.36 [s]
[2024-09-26 18:32:47,865][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 18:32:49,101][root][INFO] - Step: 135/960  |  Loss: 1.2149  |  Score: 70.49 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:50,107][root][INFO] - Step: 75/1035  |  Loss: 1.3812  |  Score: 63.28 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:50,592][root][INFO] - Step: 84/105  |  Loss: 0.5878  |  Score: 86.74 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:50,991][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 18:32:50,991][root][INFO] - Score: 41.22 [%]  |  Evaluation Time: 0.40 [s]
[2024-09-26 18:32:51,374][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 18:32:51,374][root][INFO] - Score: 32.28 [%]  |  Evaluation Time: 0.38 [s]
[2024-09-26 18:32:51,376][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 18:32:53,902][root][INFO] - Step: 90/105  |  Loss: 0.4688  |  Score: 89.75 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:54,107][root][INFO] - Step: 91/105  |  Loss: 0.4254  |  Score: 90.65 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:54,549][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 18:32:54,550][root][INFO] - Score: 40.92 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-26 18:32:54,635][root][INFO] - Step: 150/960  |  Loss: 1.1305  |  Score: 71.82 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:54,981][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 18:32:54,981][root][INFO] - Score: 32.61 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-26 18:32:54,983][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 18:32:55,830][root][INFO] - Step: 90/1035  |  Loss: 1.3100  |  Score: 63.54 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:57,760][root][INFO] - Step: 98/105  |  Loss: 0.5460  |  Score: 87.88 [%]  |  Seq Length: 256.0
[2024-09-26 18:32:58,220][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 18:32:58,220][root][INFO] - Score: 40.28 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-26 18:32:58,622][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 18:32:58,623][root][INFO] - Score: 33.47 [%]  |  Evaluation Time: 0.40 [s]
[2024-09-26 18:32:58,625][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 18:33:00,187][root][INFO] - Step: 165/960  |  Loss: 1.0650  |  Score: 70.36 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:01,382][root][INFO] - Step: 105/105  |  Loss: 0.5006  |  Score: 87.54 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:01,554][root][INFO] - Step: 105/1035  |  Loss: 1.2323  |  Score: 63.34 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:01,784][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 18:33:01,784][root][INFO] - Score: 40.41 [%]  |  Evaluation Time: 0.40 [s]
[2024-09-26 18:33:02,161][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 18:33:02,161][root][INFO] - Score: 33.27 [%]  |  Evaluation Time: 0.37 [s]
[2024-09-26 18:33:02,162][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 18:33:02,162][root][INFO] - - Epoch: 10
[2024-09-26 18:33:02,162][root][INFO] - - DEV score: 41.25 [%]
[2024-09-26 18:33:02,162][root][INFO] - - TEST score: 32.54 [%]
[2024-09-26 18:33:02,164][root][INFO] - Fine-tuning is done!
[2024-09-26 18:33:05,734][root][INFO] - Step: 180/960  |  Loss: 1.0930  |  Score: 70.61 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:07,264][root][INFO] - Step: 120/1035  |  Loss: 1.2890  |  Score: 65.41 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:08,398][root][INFO] - 

[2024-09-26 18:33:08,398][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 18:33:08,399][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:33:08,399][root][INFO] - 

[2024-09-26 18:33:08,399][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 18:33:10,220][root][INFO] - Step: 192/960  |  Loss: 1.1802  |  Score: 69.90 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:12,045][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 18:33:12,046][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 18:33:12,046][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 18:33:12,047][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 18:33:12,047][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 18:33:12,047][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 18:33:12,048][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 18:33:12,048][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 18:33:12,049][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 18:33:12,049][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 18:33:12,049][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 18:33:12,050][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 18:33:12,050][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 18:33:12,051][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 18:33:12,051][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 18:33:12,052][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 18:33:12,052][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 18:33:12,052][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 18:33:12,053][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 18:33:12,053][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 18:33:12,054][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 18:33:12,054][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 18:33:12,055][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 18:33:12,055][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 18:33:12,057][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 18:33:12,060][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-26 18:33:12,166][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-26 18:33:12,169][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-26 18:33:12,500][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 18:33:12,973][root][INFO] - Step: 135/1035  |  Loss: 1.2640  |  Score: 66.19 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:13,211][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 18:33:13,212][root][INFO] - Score: 73.10 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-26 18:33:14,148][root][INFO] - Step: 138/1035  |  Loss: 1.2267  |  Score: 72.78 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:16,086][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 18:33:16,086][root][INFO] - Score: 68.79 [%]  |  Evaluation Time: 2.87 [s]
[2024-09-26 18:33:16,088][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 18:33:17,228][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 18:33:17,228][root][INFO] - Score: 75.34 [%]  |  Evaluation Time: 3.08 [s]
[2024-09-26 18:33:17,603][root][INFO] - Step: 195/960  |  Loss: 0.9357  |  Score: 76.49 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:19,448][root][INFO] - 

[2024-09-26 18:33:19,448][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 18:33:19,448][root][INFO] - Data Preprocessing
[2024-09-26 18:33:19,449][root][INFO] - ㄴ remain_lang                ko
[2024-09-26 18:33:19,449][root][INFO] - ㄴ do_hangeulize              True
[2024-09-26 18:33:19,449][root][INFO] - ㄴ data_remove                True

[2024-09-26 18:33:19,449][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 18:33:19,457][root][INFO] - vocab size              : 51200
[2024-09-26 18:33:19,457][root][INFO] - device                  : gpu
[2024-09-26 18:33:19,457][root][INFO] - random seed             : 42
[2024-09-26 18:33:19,457][root][INFO] - train data size         : 448
[2024-09-26 18:33:19,458][root][INFO] - max epochs              : 15
[2024-09-26 18:33:19,458][root][INFO] - total steps             : 105
[2024-09-26 18:33:19,458][root][INFO] - warmup steps            : 10
[2024-09-26 18:33:19,458][root][INFO] - batch size              : 64
[2024-09-26 18:33:19,458][root][INFO] - accumulation steps      : 1
[2024-09-26 18:33:19,458][root][INFO] - optimizer               : adamwscale
[2024-09-26 18:33:19,458][root][INFO] - lr_scheduler            : cosine
[2024-09-26 18:33:19,458][root][INFO] - learning rate           : 0.01
[2024-09-26 18:33:19,458][root][INFO] - max length              : 256

[2024-09-26 18:33:19,458][root][INFO] - LoRA Configuration
[2024-09-26 18:33:19,458][root][INFO] - ㄴ r                    : 32
[2024-09-26 18:33:19,459][root][INFO] - ㄴ alpha                : 128
[2024-09-26 18:33:19,459][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 18:33:19,459][root][INFO] - KOMBO Configuration
[2024-09-26 18:33:19,459][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-26 18:33:19,459][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-26 18:33:19,459][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-26 18:33:19,459][root][INFO] - ㄴ do_combination       : True
[2024-09-26 18:33:19,459][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-26 18:33:19,459][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-26 18:33:19,459][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-26 18:33:19,460][root][INFO] -   ㄴ add_lora           : True

[2024-09-26 18:33:19,460][root][INFO] - LoRA in KOMBO Configuration
[2024-09-26 18:33:19,460][root][INFO] - ㄴ r                : 32
[2024-09-26 18:33:19,460][root][INFO] - ㄴ alpha            : 128
[2024-09-26 18:33:19,460][root][INFO] - ㄴ dropout          : 0.03

[2024-09-26 18:33:19,460][root][INFO] - 

[2024-09-26 18:33:19,460][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:33:19,460][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 18:33:19,460][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 18:33:19,460][root][INFO] - * tb interval   : 15

[2024-09-26 18:33:19,460][root][INFO] - 

[2024-09-26 18:33:19,460][root][INFO] - Start the Training !
[2024-09-26 18:33:19,464][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 18:33:20,172][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 18:33:20,173][root][INFO] - Score: 68.21 [%]  |  Evaluation Time: 2.94 [s]
[2024-09-26 18:33:20,174][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 18:33:20,175][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 18:33:23,153][root][INFO] - Step: 210/960  |  Loss: 0.9256  |  Score: 75.83 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:23,902][root][INFO] - Step: 7/105  |  Loss: 4.9633  |  Score: 5.87 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:24,492][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 18:33:24,492][root][INFO] - Score: 1.11 [%]  |  Evaluation Time: 0.59 [s]
[2024-09-26 18:33:25,025][root][INFO] - Step: 150/1035  |  Loss: 1.1503  |  Score: 68.61 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:25,047][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 18:33:25,047][root][INFO] - Score: -8.62 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-26 18:33:25,049][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 18:33:28,711][root][INFO] - Step: 225/960  |  Loss: 0.9693  |  Score: 75.37 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:28,740][root][INFO] - Step: 14/105  |  Loss: 2.7988  |  Score: 16.63 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:29,333][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 18:33:29,333][root][INFO] - Score: 1.65 [%]  |  Evaluation Time: 0.59 [s]
[2024-09-26 18:33:29,882][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 18:33:29,882][root][INFO] - Score: 4.59 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-26 18:33:29,883][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 18:33:29,884][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 18:33:30,792][root][INFO] - Step: 165/1035  |  Loss: 1.0443  |  Score: 72.30 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:30,910][root][INFO] - Step: 15/105  |  Loss: 2.4317  |  Score: 25.30 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:33,627][root][INFO] - Step: 21/105  |  Loss: 2.4729  |  Score: 30.74 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:34,265][root][INFO] - Step: 240/960  |  Loss: 1.0091  |  Score: 73.43 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:34,292][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 18:33:34,292][root][INFO] - Score: 19.24 [%]  |  Evaluation Time: 0.66 [s]
[2024-09-26 18:33:34,892][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 18:33:34,893][root][INFO] - Score: 8.82 [%]  |  Evaluation Time: 0.60 [s]
[2024-09-26 18:33:34,894][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 18:33:34,895][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 18:33:36,560][root][INFO] - Step: 180/1035  |  Loss: 1.0556  |  Score: 72.01 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:38,645][root][INFO] - Step: 28/105  |  Loss: 1.9696  |  Score: 48.20 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:39,279][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 18:33:39,279][root][INFO] - Score: 19.44 [%]  |  Evaluation Time: 0.63 [s]
[2024-09-26 18:33:39,807][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 18:33:39,808][root][INFO] - Score: 11.98 [%]  |  Evaluation Time: 0.53 [s]
[2024-09-26 18:33:39,808][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-26 18:33:39,810][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 18:33:39,818][root][INFO] - Step: 255/960  |  Loss: 0.9563  |  Score: 73.23 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:40,258][root][INFO] - Step: 256/960  |  Loss: 0.8809  |  Score: 72.32 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:41,279][root][INFO] - Step: 30/105  |  Loss: 1.5686  |  Score: 56.27 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:42,328][root][INFO] - Step: 195/1035  |  Loss: 1.2044  |  Score: 70.78 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:43,150][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 18:33:43,150][root][INFO] - Score: 78.48 [%]  |  Evaluation Time: 2.89 [s]
[2024-09-26 18:33:43,513][root][INFO] - Step: 35/105  |  Loss: 1.5425  |  Score: 59.92 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:44,086][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 18:33:44,086][root][INFO] - Score: 32.62 [%]  |  Evaluation Time: 0.57 [s]
[2024-09-26 18:33:44,669][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 18:33:44,669][root][INFO] - Score: 19.09 [%]  |  Evaluation Time: 0.58 [s]
[2024-09-26 18:33:44,670][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 18:33:44,672][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 18:33:46,011][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 18:33:46,011][root][INFO] - Score: 70.83 [%]  |  Evaluation Time: 2.86 [s]
[2024-09-26 18:33:46,013][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-26 18:33:46,014][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 18:33:46,936][root][INFO] - Step: 207/1035  |  Loss: 1.0119  |  Score: 70.82 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:48,268][root][INFO] - Step: 42/105  |  Loss: 1.2697  |  Score: 68.58 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:48,864][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 18:33:48,864][root][INFO] - Score: 33.11 [%]  |  Evaluation Time: 0.59 [s]
[2024-09-26 18:33:49,411][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 18:33:49,411][root][INFO] - Score: 24.59 [%]  |  Evaluation Time: 0.54 [s]
[2024-09-26 18:33:49,412][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 18:33:49,413][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 18:33:50,124][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 18:33:50,125][root][INFO] - Score: 77.68 [%]  |  Evaluation Time: 3.19 [s]
[2024-09-26 18:33:51,388][root][INFO] - Step: 45/105  |  Loss: 1.3163  |  Score: 67.03 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:51,551][root][INFO] - Step: 270/960  |  Loss: 0.7967  |  Score: 76.87 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:53,063][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 18:33:53,063][root][INFO] - Score: 69.24 [%]  |  Evaluation Time: 2.94 [s]
[2024-09-26 18:33:53,064][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 18:33:53,065][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 18:33:53,132][root][INFO] - Step: 49/105  |  Loss: 1.0308  |  Score: 76.43 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:53,736][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 18:33:53,736][root][INFO] - Score: 42.57 [%]  |  Evaluation Time: 0.60 [s]
[2024-09-26 18:33:54,280][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 18:33:54,281][root][INFO] - Score: 29.53 [%]  |  Evaluation Time: 0.54 [s]
[2024-09-26 18:33:54,282][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-26 18:33:54,283][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 18:33:54,595][root][INFO] - Step: 210/1035  |  Loss: 1.0744  |  Score: 69.67 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:57,112][root][INFO] - Step: 285/960  |  Loss: 0.8600  |  Score: 77.59 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:58,046][root][INFO] - Step: 56/105  |  Loss: 0.8798  |  Score: 78.22 [%]  |  Seq Length: 256.0
[2024-09-26 18:33:58,663][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 18:33:58,663][root][INFO] - Score: 44.83 [%]  |  Evaluation Time: 0.61 [s]
[2024-09-26 18:33:59,292][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 18:33:59,293][root][INFO] - Score: 31.74 [%]  |  Evaluation Time: 0.63 [s]
[2024-09-26 18:33:59,294][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-26 18:33:59,295][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 18:34:00,317][root][INFO] - Step: 225/1035  |  Loss: 0.9189  |  Score: 75.95 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:01,759][root][INFO] - Step: 60/105  |  Loss: 0.8011  |  Score: 83.25 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:02,673][root][INFO] - Step: 300/960  |  Loss: 0.8252  |  Score: 80.20 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:03,020][root][INFO] - Step: 63/105  |  Loss: 0.7272  |  Score: 82.80 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:03,671][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 18:34:03,671][root][INFO] - Score: 48.26 [%]  |  Evaluation Time: 0.65 [s]
[2024-09-26 18:34:04,292][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 18:34:04,293][root][INFO] - Score: 34.06 [%]  |  Evaluation Time: 0.62 [s]
[2024-09-26 18:34:04,294][root][INFO] - 
Save new Best Score (Epoch: 9)
[2024-09-26 18:34:04,296][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 18:34:06,040][root][INFO] - Step: 240/1035  |  Loss: 0.8683  |  Score: 75.81 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:07,977][root][INFO] - Step: 70/105  |  Loss: 0.6515  |  Score: 85.48 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:08,233][root][INFO] - Step: 315/960  |  Loss: 0.8432  |  Score: 80.50 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:08,571][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 18:34:08,571][root][INFO] - Score: 49.11 [%]  |  Evaluation Time: 0.59 [s]
[2024-09-26 18:34:09,098][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 18:34:09,099][root][INFO] - Score: 34.46 [%]  |  Evaluation Time: 0.52 [s]
[2024-09-26 18:34:09,099][root][INFO] - 
Save new Best Score (Epoch: 10)
[2024-09-26 18:34:09,101][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 18:34:10,134][root][INFO] - Step: 320/960  |  Loss: 0.6968  |  Score: 81.26 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:11,761][root][INFO] - Step: 255/1035  |  Loss: 1.0046  |  Score: 73.87 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:12,097][root][INFO] - Step: 75/105  |  Loss: 0.5578  |  Score: 87.52 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:12,861][root][INFO] - Step: 77/105  |  Loss: 0.6099  |  Score: 83.07 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:13,160][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 18:34:13,160][root][INFO] - Score: 78.17 [%]  |  Evaluation Time: 3.02 [s]
[2024-09-26 18:34:13,497][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 18:34:13,498][root][INFO] - Score: 51.45 [%]  |  Evaluation Time: 0.63 [s]
[2024-09-26 18:34:14,048][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 18:34:14,049][root][INFO] - Score: 34.10 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-26 18:34:14,050][root][INFO] - 
Save new Best Score (Epoch: 11)
[2024-09-26 18:34:14,052][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 18:34:16,241][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 18:34:16,241][root][INFO] - Score: 71.15 [%]  |  Evaluation Time: 3.08 [s]
[2024-09-26 18:34:16,242][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 18:34:16,243][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 18:34:17,481][root][INFO] - Step: 270/1035  |  Loss: 0.9021  |  Score: 75.73 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:17,795][root][INFO] - Step: 84/105  |  Loss: 0.5482  |  Score: 86.47 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:18,393][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 18:34:18,393][root][INFO] - Score: 50.74 [%]  |  Evaluation Time: 0.59 [s]
[2024-09-26 18:34:18,982][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 18:34:18,982][root][INFO] - Score: 34.79 [%]  |  Evaluation Time: 0.59 [s]
[2024-09-26 18:34:18,984][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 18:34:19,787][root][INFO] - Step: 276/1035  |  Loss: 0.9975  |  Score: 67.36 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:20,400][root][INFO] - Step: 330/960  |  Loss: 0.7357  |  Score: 80.33 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:22,511][root][INFO] - Step: 90/105  |  Loss: 0.5294  |  Score: 87.94 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:22,803][root][INFO] - Step: 91/105  |  Loss: 0.1926  |  Score: 91.51 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:22,873][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 18:34:22,873][root][INFO] - Score: 77.50 [%]  |  Evaluation Time: 3.08 [s]
[2024-09-26 18:34:23,451][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 18:34:23,451][root][INFO] - Score: 49.68 [%]  |  Evaluation Time: 0.64 [s]
[2024-09-26 18:34:24,064][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 18:34:24,064][root][INFO] - Score: 35.19 [%]  |  Evaluation Time: 0.61 [s]
[2024-09-26 18:34:24,067][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 18:34:25,865][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 18:34:25,865][root][INFO] - Score: 70.09 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-26 18:34:25,866][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-26 18:34:25,867][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 18:34:26,034][root][INFO] - Step: 345/960  |  Loss: 0.7053  |  Score: 81.72 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:27,841][root][INFO] - Step: 98/105  |  Loss: 0.5661  |  Score: 87.33 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:28,467][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 18:34:28,467][root][INFO] - Score: 49.45 [%]  |  Evaluation Time: 0.62 [s]
[2024-09-26 18:34:29,095][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 18:34:29,095][root][INFO] - Score: 35.51 [%]  |  Evaluation Time: 0.63 [s]
[2024-09-26 18:34:29,098][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 18:34:29,630][root][INFO] - Step: 285/1035  |  Loss: 0.8253  |  Score: 79.03 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:31,657][root][INFO] - Step: 360/960  |  Loss: 0.7415  |  Score: 80.13 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:32,847][root][INFO] - Step: 105/105  |  Loss: 0.5620  |  Score: 88.42 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:33,503][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 18:34:33,503][root][INFO] - Score: 49.59 [%]  |  Evaluation Time: 0.65 [s]
[2024-09-26 18:34:34,055][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 18:34:34,055][root][INFO] - Score: 35.29 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-26 18:34:34,056][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 18:34:34,057][root][INFO] - - Epoch: 11
[2024-09-26 18:34:34,057][root][INFO] - - DEV score: 51.45 [%]
[2024-09-26 18:34:34,057][root][INFO] - - TEST score: 34.10 [%]
[2024-09-26 18:34:34,058][root][INFO] - Fine-tuning is done!
[2024-09-26 18:34:35,361][root][INFO] - Step: 300/1035  |  Loss: 0.8934  |  Score: 77.59 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:37,284][root][INFO] - Step: 375/960  |  Loss: 0.7196  |  Score: 80.91 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:40,691][root][INFO] - Step: 384/960  |  Loss: 0.6828  |  Score: 83.88 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:40,850][root][INFO] - 

[2024-09-26 18:34:40,850][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 18:34:40,850][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:34:40,850][root][INFO] - 

[2024-09-26 18:34:40,851][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko', 'do_hangeulize': True, 'data_remove': False, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 18:34:41,088][root][INFO] - Step: 315/1035  |  Loss: 0.8234  |  Score: 77.08 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:43,602][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 18:34:43,602][root][INFO] - Score: 77.90 [%]  |  Evaluation Time: 2.91 [s]
[2024-09-26 18:34:46,525][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 18:34:46,525][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 18:34:46,526][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 18:34:46,526][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 18:34:46,527][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 18:34:46,527][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 18:34:46,528][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 18:34:46,528][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 18:34:46,529][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 18:34:46,529][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 18:34:46,530][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 18:34:46,530][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 18:34:46,530][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 18:34:46,531][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 18:34:46,531][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 18:34:46,532][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 18:34:46,532][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 18:34:46,533][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 18:34:46,533][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 18:34:46,534][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 18:34:46,534][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 18:34:46,535][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 18:34:46,535][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 18:34:46,536][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 18:34:46,537][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 18:34:46,689][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 18:34:46,689][root][INFO] - Score: 71.83 [%]  |  Evaluation Time: 3.08 [s]
[2024-09-26 18:34:46,690][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 18:34:46,691][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 18:34:46,748][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 18:34:46,820][root][INFO] - Step: 330/1035  |  Loss: 0.7648  |  Score: 78.42 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:49,339][root][INFO] - Step: 390/960  |  Loss: 0.5743  |  Score: 83.08 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:51,198][root][INFO] - 

[2024-09-26 18:34:51,199][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 18:34:51,199][root][INFO] - Data Preprocessing
[2024-09-26 18:34:51,199][root][INFO] - ㄴ remain_lang                ko
[2024-09-26 18:34:51,199][root][INFO] - ㄴ do_hangeulize              True
[2024-09-26 18:34:51,199][root][INFO] - ㄴ data_remove                False

[2024-09-26 18:34:51,199][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 18:34:51,208][root][INFO] - vocab size              : 51200
[2024-09-26 18:34:51,208][root][INFO] - device                  : gpu
[2024-09-26 18:34:51,208][root][INFO] - random seed             : 42
[2024-09-26 18:34:51,208][root][INFO] - train data size         : 5760
[2024-09-26 18:34:51,208][root][INFO] - max epochs              : 15
[2024-09-26 18:34:51,208][root][INFO] - total steps             : 1350
[2024-09-26 18:34:51,208][root][INFO] - warmup steps            : 135
[2024-09-26 18:34:51,208][root][INFO] - batch size              : 64
[2024-09-26 18:34:51,209][root][INFO] - accumulation steps      : 1
[2024-09-26 18:34:51,209][root][INFO] - optimizer               : adamwscale
[2024-09-26 18:34:51,209][root][INFO] - lr_scheduler            : cosine
[2024-09-26 18:34:51,209][root][INFO] - learning rate           : 0.01
[2024-09-26 18:34:51,209][root][INFO] - max length              : 256

[2024-09-26 18:34:51,209][root][INFO] - LoRA Configuration
[2024-09-26 18:34:51,209][root][INFO] - ㄴ r                    : 32
[2024-09-26 18:34:51,209][root][INFO] - ㄴ alpha                : 128
[2024-09-26 18:34:51,209][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 18:34:51,209][root][INFO] - 

[2024-09-26 18:34:51,209][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:34:51,210][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 18:34:51,210][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 18:34:51,210][root][INFO] - * tb interval   : 15

[2024-09-26 18:34:51,210][root][INFO] - 

[2024-09-26 18:34:51,210][root][INFO] - Start the Training !
[2024-09-26 18:34:51,213][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 18:34:52,586][root][INFO] - Step: 345/1035  |  Loss: 0.9360  |  Score: 74.90 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:54,925][root][INFO] - Step: 405/960  |  Loss: 0.6534  |  Score: 81.69 [%]  |  Seq Length: 256.0
[2024-09-26 18:34:55,686][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 18:34:55,687][root][INFO] - Score: 76.57 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-26 18:34:58,812][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 18:34:58,813][root][INFO] - Score: 70.48 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-26 18:34:58,814][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 18:34:59,577][root][INFO] - Step: 346/1035  |  Loss: 0.7622  |  Score: 78.76 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:00,007][root][INFO] - Step: 15/1350  |  Loss: 3.6309  |  Score: 0.81 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:00,502][root][INFO] - Step: 420/960  |  Loss: 0.6482  |  Score: 84.15 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:04,915][root][INFO] - Step: 360/1035  |  Loss: 0.7149  |  Score: 80.53 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:05,500][root][INFO] - Step: 30/1350  |  Loss: 2.2845  |  Score: 12.59 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:06,079][root][INFO] - Step: 435/960  |  Loss: 0.6794  |  Score: 83.57 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:10,638][root][INFO] - Step: 375/1035  |  Loss: 0.6979  |  Score: 82.91 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:10,941][root][INFO] - Step: 448/960  |  Loss: 0.6761  |  Score: 81.52 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:10,987][root][INFO] - Step: 45/1350  |  Loss: 2.0803  |  Score: 30.16 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:13,902][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 18:35:13,902][root][INFO] - Score: 78.39 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-26 18:35:16,362][root][INFO] - Step: 390/1035  |  Loss: 0.7403  |  Score: 79.27 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:16,482][root][INFO] - Step: 60/1350  |  Loss: 1.9855  |  Score: 39.01 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:16,886][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 18:35:16,887][root][INFO] - Score: 71.52 [%]  |  Evaluation Time: 2.98 [s]
[2024-09-26 18:35:16,888][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-26 18:35:16,889][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 18:35:17,967][root][INFO] - Step: 450/960  |  Loss: 0.6189  |  Score: 84.84 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:21,989][root][INFO] - Step: 75/1350  |  Loss: 1.5942  |  Score: 56.79 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:22,086][root][INFO] - Step: 405/1035  |  Loss: 0.6694  |  Score: 79.43 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:23,541][root][INFO] - Step: 465/960  |  Loss: 0.5304  |  Score: 85.24 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:25,552][root][INFO] - Step: 414/1035  |  Loss: 0.6930  |  Score: 81.45 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:27,553][root][INFO] - Step: 90/1350  |  Loss: 1.4760  |  Score: 53.31 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:28,635][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 18:35:28,635][root][INFO] - Score: 77.96 [%]  |  Evaluation Time: 3.08 [s]
[2024-09-26 18:35:29,118][root][INFO] - Step: 480/960  |  Loss: 0.5722  |  Score: 84.96 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:31,386][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 18:35:31,386][root][INFO] - Score: 71.12 [%]  |  Evaluation Time: 3.83 [s]
[2024-09-26 18:35:31,714][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 18:35:31,715][root][INFO] - Score: 71.93 [%]  |  Evaluation Time: 3.08 [s]
[2024-09-26 18:35:31,716][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 18:35:31,717][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 18:35:34,434][root][INFO] - Step: 420/1035  |  Loss: 0.5806  |  Score: 83.52 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:34,695][root][INFO] - Step: 495/960  |  Loss: 0.5840  |  Score: 84.39 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:34,922][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 18:35:34,922][root][INFO] - Score: 63.76 [%]  |  Evaluation Time: 3.53 [s]
[2024-09-26 18:35:34,924][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 18:35:34,925][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 18:35:35,632][root][INFO] - Step: 91/1350  |  Loss: 1.6897  |  Score: 50.19 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:40,159][root][INFO] - Step: 435/1035  |  Loss: 0.5785  |  Score: 85.11 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:40,273][root][INFO] - Step: 510/960  |  Loss: 0.5741  |  Score: 86.44 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:40,778][root][INFO] - Step: 105/1350  |  Loss: 1.2771  |  Score: 60.79 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:41,068][root][INFO] - Step: 512/960  |  Loss: 0.5352  |  Score: 82.81 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:44,122][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 18:35:44,123][root][INFO] - Score: 78.56 [%]  |  Evaluation Time: 3.05 [s]
[2024-09-26 18:35:45,882][root][INFO] - Step: 450/1035  |  Loss: 0.6901  |  Score: 81.37 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:46,288][root][INFO] - Step: 120/1350  |  Loss: 1.3038  |  Score: 58.93 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:47,024][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 18:35:47,024][root][INFO] - Score: 71.10 [%]  |  Evaluation Time: 2.90 [s]
[2024-09-26 18:35:47,027][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 18:35:51,603][root][INFO] - Step: 465/1035  |  Loss: 0.7268  |  Score: 82.57 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:51,808][root][INFO] - Step: 135/1350  |  Loss: 1.3654  |  Score: 61.15 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:52,280][root][INFO] - Step: 525/960  |  Loss: 0.4759  |  Score: 88.02 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:57,322][root][INFO] - Step: 480/1035  |  Loss: 0.6923  |  Score: 80.86 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:57,325][root][INFO] - Step: 150/1350  |  Loss: 1.2398  |  Score: 67.61 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:57,862][root][INFO] - Step: 540/960  |  Loss: 0.4988  |  Score: 86.64 [%]  |  Seq Length: 256.0
[2024-09-26 18:35:58,510][root][INFO] - Step: 483/1035  |  Loss: 0.6940  |  Score: 81.25 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:01,787][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 18:36:01,787][root][INFO] - Score: 77.96 [%]  |  Evaluation Time: 3.27 [s]
[2024-09-26 18:36:02,847][root][INFO] - Step: 165/1350  |  Loss: 1.1477  |  Score: 62.69 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:03,442][root][INFO] - Step: 555/960  |  Loss: 0.5106  |  Score: 86.21 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:04,765][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 18:36:04,765][root][INFO] - Score: 70.73 [%]  |  Evaluation Time: 2.98 [s]
[2024-09-26 18:36:04,768][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 18:36:08,392][root][INFO] - Step: 180/1350  |  Loss: 1.1647  |  Score: 62.95 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:09,019][root][INFO] - Step: 570/960  |  Loss: 0.5042  |  Score: 87.08 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:09,627][root][INFO] - Step: 495/1035  |  Loss: 0.5298  |  Score: 84.19 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:11,312][root][INFO] - Step: 576/960  |  Loss: 0.4521  |  Score: 86.39 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:12,332][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 18:36:12,332][root][INFO] - Score: 76.31 [%]  |  Evaluation Time: 3.94 [s]
[2024-09-26 18:36:14,226][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 18:36:14,226][root][INFO] - Score: 76.93 [%]  |  Evaluation Time: 2.91 [s]
[2024-09-26 18:36:15,353][root][INFO] - Step: 510/1035  |  Loss: 0.5620  |  Score: 84.98 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:16,053][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 18:36:16,053][root][INFO] - Score: 67.29 [%]  |  Evaluation Time: 3.72 [s]
[2024-09-26 18:36:16,054][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 18:36:16,056][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 18:36:16,800][root][INFO] - Step: 181/1350  |  Loss: 0.9823  |  Score: 66.56 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:17,110][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 18:36:17,111][root][INFO] - Score: 70.58 [%]  |  Evaluation Time: 2.88 [s]
[2024-09-26 18:36:17,113][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 18:36:20,823][root][INFO] - Step: 585/960  |  Loss: 0.4546  |  Score: 86.78 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:21,079][root][INFO] - Step: 525/1035  |  Loss: 0.6064  |  Score: 83.34 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:21,955][root][INFO] - Step: 195/1350  |  Loss: 1.0976  |  Score: 67.08 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:26,458][root][INFO] - Step: 600/960  |  Loss: 0.4242  |  Score: 88.25 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:26,803][root][INFO] - Step: 540/1035  |  Loss: 0.5484  |  Score: 85.29 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:27,476][root][INFO] - Step: 210/1350  |  Loss: 1.0825  |  Score: 68.61 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:31,422][root][INFO] - Step: 552/1035  |  Loss: 0.5562  |  Score: 84.19 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:32,092][root][INFO] - Step: 615/960  |  Loss: 0.4534  |  Score: 88.42 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:32,998][root][INFO] - Step: 225/1350  |  Loss: 1.1633  |  Score: 69.36 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:34,514][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 18:36:34,514][root][INFO] - Score: 77.68 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-26 18:36:37,467][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 18:36:37,467][root][INFO] - Score: 71.51 [%]  |  Evaluation Time: 2.95 [s]
[2024-09-26 18:36:37,469][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 18:36:37,723][root][INFO] - Step: 630/960  |  Loss: 0.4097  |  Score: 89.52 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:38,522][root][INFO] - Step: 240/1350  |  Loss: 1.1194  |  Score: 68.63 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:39,010][root][INFO] - Step: 555/1035  |  Loss: 0.5178  |  Score: 84.05 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:41,523][root][INFO] - Step: 640/960  |  Loss: 0.5117  |  Score: 85.68 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:44,044][root][INFO] - Step: 255/1350  |  Loss: 1.0066  |  Score: 69.15 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:44,533][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 18:36:44,534][root][INFO] - Score: 76.97 [%]  |  Evaluation Time: 3.01 [s]
[2024-09-26 18:36:44,736][root][INFO] - Step: 570/1035  |  Loss: 0.4731  |  Score: 86.18 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:47,483][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 18:36:47,484][root][INFO] - Score: 71.34 [%]  |  Evaluation Time: 2.95 [s]
[2024-09-26 18:36:47,486][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 18:36:49,608][root][INFO] - Step: 270/1350  |  Loss: 1.0761  |  Score: 70.29 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:49,778][root][INFO] - Step: 645/960  |  Loss: 0.4038  |  Score: 89.18 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:50,463][root][INFO] - Step: 585/1035  |  Loss: 0.4880  |  Score: 87.07 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:53,449][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 18:36:53,449][root][INFO] - Score: 75.60 [%]  |  Evaluation Time: 3.84 [s]
[2024-09-26 18:36:55,360][root][INFO] - Step: 660/960  |  Loss: 0.4201  |  Score: 89.98 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:56,207][root][INFO] - Step: 600/1035  |  Loss: 0.5069  |  Score: 85.71 [%]  |  Seq Length: 256.0
[2024-09-26 18:36:57,154][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 18:36:57,154][root][INFO] - Score: 67.89 [%]  |  Evaluation Time: 3.70 [s]
[2024-09-26 18:36:57,156][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 18:36:57,870][root][INFO] - Step: 271/1350  |  Loss: 1.0072  |  Score: 61.58 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:00,942][root][INFO] - Step: 675/960  |  Loss: 0.4360  |  Score: 89.01 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:01,950][root][INFO] - Step: 615/1035  |  Loss: 0.5021  |  Score: 86.20 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:03,029][root][INFO] - Step: 285/1350  |  Loss: 0.9370  |  Score: 72.45 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:04,295][root][INFO] - Step: 621/1035  |  Loss: 0.4864  |  Score: 86.00 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:06,523][root][INFO] - Step: 690/960  |  Loss: 0.4248  |  Score: 88.74 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:07,555][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 18:37:07,555][root][INFO] - Score: 77.53 [%]  |  Evaluation Time: 3.26 [s]
[2024-09-26 18:37:08,552][root][INFO] - Step: 300/1350  |  Loss: 0.9142  |  Score: 74.94 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:10,498][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 18:37:10,498][root][INFO] - Score: 71.23 [%]  |  Evaluation Time: 2.94 [s]
[2024-09-26 18:37:10,502][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 18:37:11,774][root][INFO] - Step: 704/960  |  Loss: 0.4527  |  Score: 87.66 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:14,083][root][INFO] - Step: 315/1350  |  Loss: 1.1009  |  Score: 73.08 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:14,243][root][INFO] - Step: 630/1035  |  Loss: 0.4179  |  Score: 87.96 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:14,826][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 18:37:14,826][root][INFO] - Score: 76.50 [%]  |  Evaluation Time: 3.05 [s]
[2024-09-26 18:37:17,808][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 18:37:17,809][root][INFO] - Score: 70.90 [%]  |  Evaluation Time: 2.98 [s]
[2024-09-26 18:37:17,811][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 18:37:18,627][root][INFO] - Step: 705/960  |  Loss: 0.3051  |  Score: 92.69 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:19,608][root][INFO] - Step: 330/1350  |  Loss: 0.9780  |  Score: 70.61 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:20,017][root][INFO] - Step: 645/1035  |  Loss: 0.4993  |  Score: 87.00 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:24,215][root][INFO] - Step: 720/960  |  Loss: 0.4155  |  Score: 88.32 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:25,132][root][INFO] - Step: 345/1350  |  Loss: 0.9299  |  Score: 72.13 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:25,789][root][INFO] - Step: 660/1035  |  Loss: 0.4187  |  Score: 87.72 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:29,798][root][INFO] - Step: 735/960  |  Loss: 0.3763  |  Score: 88.91 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:30,650][root][INFO] - Step: 360/1350  |  Loss: 0.8542  |  Score: 74.80 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:31,513][root][INFO] - Step: 675/1035  |  Loss: 0.5031  |  Score: 86.26 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:34,523][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 18:37:34,523][root][INFO] - Score: 77.09 [%]  |  Evaluation Time: 3.87 [s]
[2024-09-26 18:37:35,385][root][INFO] - Step: 750/960  |  Loss: 0.3556  |  Score: 90.71 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:37,273][root][INFO] - Step: 690/1035  |  Loss: 0.5282  |  Score: 86.61 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:38,253][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 18:37:38,253][root][INFO] - Score: 70.46 [%]  |  Evaluation Time: 3.73 [s]
[2024-09-26 18:37:38,254][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-26 18:37:38,255][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 18:37:38,973][root][INFO] - Step: 361/1350  |  Loss: 0.8027  |  Score: 74.67 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:40,322][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 18:37:40,322][root][INFO] - Score: 76.74 [%]  |  Evaluation Time: 3.05 [s]
[2024-09-26 18:37:40,966][root][INFO] - Step: 765/960  |  Loss: 0.3856  |  Score: 88.80 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:42,139][root][INFO] - Step: 768/960  |  Loss: 0.3687  |  Score: 92.24 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:43,294][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 18:37:43,294][root][INFO] - Score: 70.56 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-26 18:37:43,296][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 18:37:43,953][root][INFO] - Step: 691/1035  |  Loss: 0.5624  |  Score: 81.59 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:44,165][root][INFO] - Step: 375/1350  |  Loss: 0.8274  |  Score: 75.04 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:45,097][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 18:37:45,097][root][INFO] - Score: 72.74 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-26 18:37:48,026][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 18:37:48,026][root][INFO] - Score: 70.20 [%]  |  Evaluation Time: 2.93 [s]
[2024-09-26 18:37:48,029][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 18:37:49,294][root][INFO] - Step: 705/1035  |  Loss: 0.4131  |  Score: 89.01 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:49,742][root][INFO] - Step: 390/1350  |  Loss: 0.8612  |  Score: 75.12 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:52,869][root][INFO] - Step: 780/960  |  Loss: 0.3608  |  Score: 90.07 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:55,014][root][INFO] - Step: 720/1035  |  Loss: 0.4177  |  Score: 86.98 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:55,288][root][INFO] - Step: 405/1350  |  Loss: 0.8296  |  Score: 72.90 [%]  |  Seq Length: 256.0
[2024-09-26 18:37:58,452][root][INFO] - Step: 795/960  |  Loss: 0.3740  |  Score: 90.61 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:00,733][root][INFO] - Step: 735/1035  |  Loss: 0.4474  |  Score: 87.23 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:00,824][root][INFO] - Step: 420/1350  |  Loss: 0.9384  |  Score: 77.38 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:04,034][root][INFO] - Step: 810/960  |  Loss: 0.3559  |  Score: 90.16 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:06,367][root][INFO] - Step: 435/1350  |  Loss: 0.7664  |  Score: 77.50 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:06,451][root][INFO] - Step: 750/1035  |  Loss: 0.4256  |  Score: 88.46 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:09,617][root][INFO] - Step: 825/960  |  Loss: 0.3662  |  Score: 90.21 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:09,909][root][INFO] - Step: 759/1035  |  Loss: 0.4049  |  Score: 89.29 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:11,952][root][INFO] - Step: 450/1350  |  Loss: 0.8761  |  Score: 74.83 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:12,266][root][INFO] - Step: 832/960  |  Loss: 0.3831  |  Score: 87.85 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:13,015][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 18:38:13,015][root][INFO] - Score: 77.36 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-26 18:38:15,305][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 18:38:15,305][root][INFO] - Score: 77.41 [%]  |  Evaluation Time: 3.03 [s]
[2024-09-26 18:38:15,787][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 18:38:15,787][root][INFO] - Score: 78.34 [%]  |  Evaluation Time: 3.83 [s]
[2024-09-26 18:38:15,974][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 18:38:15,975][root][INFO] - Score: 70.58 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-26 18:38:15,976][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 18:38:18,305][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 18:38:18,305][root][INFO] - Score: 70.28 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-26 18:38:18,307][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 18:38:18,573][root][INFO] - Step: 765/1035  |  Loss: 0.3910  |  Score: 87.85 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:19,388][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 18:38:19,388][root][INFO] - Score: 69.71 [%]  |  Evaluation Time: 3.60 [s]
[2024-09-26 18:38:19,389][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 18:38:19,390][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 18:38:20,134][root][INFO] - Step: 451/1350  |  Loss: 0.7223  |  Score: 80.62 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:21,668][root][INFO] - Step: 840/960  |  Loss: 0.3299  |  Score: 91.50 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:24,328][root][INFO] - Step: 780/1035  |  Loss: 0.3618  |  Score: 89.82 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:25,310][root][INFO] - Step: 465/1350  |  Loss: 0.6832  |  Score: 78.65 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:27,244][root][INFO] - Step: 855/960  |  Loss: 0.3506  |  Score: 90.54 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:30,054][root][INFO] - Step: 795/1035  |  Loss: 0.3725  |  Score: 89.99 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:30,897][root][INFO] - Step: 480/1350  |  Loss: 0.7386  |  Score: 78.14 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:32,823][root][INFO] - Step: 870/960  |  Loss: 0.3688  |  Score: 89.45 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:35,777][root][INFO] - Step: 810/1035  |  Loss: 0.4104  |  Score: 89.21 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:36,479][root][INFO] - Step: 495/1350  |  Loss: 0.7966  |  Score: 76.89 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:38,402][root][INFO] - Step: 885/960  |  Loss: 0.3526  |  Score: 89.98 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:41,503][root][INFO] - Step: 825/1035  |  Loss: 0.4208  |  Score: 88.11 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:42,063][root][INFO] - Step: 510/1350  |  Loss: 0.7593  |  Score: 78.17 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:42,537][root][INFO] - Step: 896/960  |  Loss: 0.4046  |  Score: 89.24 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:42,680][root][INFO] - Step: 828/1035  |  Loss: 0.3871  |  Score: 89.16 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:45,445][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 18:38:45,445][root][INFO] - Score: 76.89 [%]  |  Evaluation Time: 2.91 [s]
[2024-09-26 18:38:45,748][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 18:38:45,748][root][INFO] - Score: 77.34 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-26 18:38:47,645][root][INFO] - Step: 525/1350  |  Loss: 0.7539  |  Score: 77.79 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:48,533][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 18:38:48,533][root][INFO] - Score: 70.71 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-26 18:38:48,535][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 18:38:48,751][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 18:38:48,751][root][INFO] - Score: 70.78 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-26 18:38:48,753][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 18:38:50,440][root][INFO] - Step: 900/960  |  Loss: 0.3693  |  Score: 90.47 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:53,276][root][INFO] - Step: 540/1350  |  Loss: 0.7554  |  Score: 80.34 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:53,803][root][INFO] - Step: 840/1035  |  Loss: 0.3849  |  Score: 89.43 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:56,019][root][INFO] - Step: 915/960  |  Loss: 0.3512  |  Score: 90.42 [%]  |  Seq Length: 256.0
[2024-09-26 18:38:57,138][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 18:38:57,138][root][INFO] - Score: 76.80 [%]  |  Evaluation Time: 3.86 [s]
[2024-09-26 18:38:59,528][root][INFO] - Step: 855/1035  |  Loss: 0.3909  |  Score: 88.97 [%]  |  Seq Length: 256.0
[2024-09-26 18:39:00,847][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 18:39:00,847][root][INFO] - Score: 68.74 [%]  |  Evaluation Time: 3.71 [s]
[2024-09-26 18:39:00,849][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 18:39:01,606][root][INFO] - Step: 930/960  |  Loss: 0.3382  |  Score: 90.60 [%]  |  Seq Length: 256.0
[2024-09-26 18:39:01,629][root][INFO] - Step: 541/1350  |  Loss: 0.7287  |  Score: 83.83 [%]  |  Seq Length: 256.0
[2024-09-26 18:39:05,275][root][INFO] - Step: 870/1035  |  Loss: 0.3805  |  Score: 88.97 [%]  |  Seq Length: 256.0
[2024-09-26 18:39:06,807][root][INFO] - Step: 555/1350  |  Loss: 0.5719  |  Score: 82.81 [%]  |  Seq Length: 256.0
[2024-09-26 18:39:07,197][root][INFO] - Step: 945/960  |  Loss: 0.3505  |  Score: 89.46 [%]  |  Seq Length: 256.0
[2024-09-26 18:39:11,004][root][INFO] - Step: 885/1035  |  Loss: 0.3627  |  Score: 89.37 [%]  |  Seq Length: 256.0
[2024-09-26 18:39:12,373][root][INFO] - Step: 570/1350  |  Loss: 0.6226  |  Score: 80.52 [%]  |  Seq Length: 256.0
[2024-09-26 18:39:12,825][root][INFO] - Step: 960/960  |  Loss: 0.3579  |  Score: 90.15 [%]  |  Seq Length: 256.0
[2024-09-26 18:39:15,607][root][INFO] - Step: 897/1035  |  Loss: 0.3698  |  Score: 89.62 [%]  |  Seq Length: 256.0
[2024-09-26 18:39:15,901][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 18:39:15,901][root][INFO] - Score: 78.49 [%]  |  Evaluation Time: 3.07 [s]
[2024-09-26 18:39:17,960][root][INFO] - Step: 585/1350  |  Loss: 0.5940  |  Score: 80.52 [%]  |  Seq Length: 256.0
[2024-09-26 18:39:18,715][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 18:39:18,715][root][INFO] - Score: 77.09 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-26 18:39:18,842][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 18:39:18,842][root][INFO] - Score: 70.99 [%]  |  Evaluation Time: 2.94 [s]
[2024-09-26 18:39:18,843][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 18:39:18,843][root][INFO] - - Epoch: 7
[2024-09-26 18:39:18,843][root][INFO] - - DEV score: 78.39 [%]
[2024-09-26 18:39:18,843][root][INFO] - - TEST score: 71.52 [%]
[2024-09-26 18:39:18,844][root][INFO] - Fine-tuning is done!
[2024-09-26 18:39:21,840][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 18:39:21,840][root][INFO] - Score: 70.48 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-26 18:39:21,842][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 18:39:23,317][root][INFO] - Step: 900/1035  |  Loss: 0.3377  |  Score: 86.81 [%]  |  Seq Length: 256.0
[2024-09-26 18:39:23,554][root][INFO] - Step: 600/1350  |  Loss: 0.6286  |  Score: 81.67 [%]  |  Seq Length: 256.0
[2024-09-26 18:39:24,844][root][INFO] - 

[2024-09-26 18:39:24,844][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 18:39:24,844][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:39:24,844][root][INFO] - 

[2024-09-26 18:39:24,844][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 18:39:29,045][root][INFO] - Step: 915/1035  |  Loss: 0.3861  |  Score: 88.65 [%]  |  Seq Length: 256.0
[2024-09-26 18:39:29,141][root][INFO] - Step: 615/1350  |  Loss: 0.6838  |  Score: 81.71 [%]  |  Seq Length: 256.0
[2024-09-26 18:39:29,354][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 18:39:29,354][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 18:39:29,355][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 18:39:29,355][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 18:39:29,356][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 18:39:29,356][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 18:39:29,356][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 18:39:29,357][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 18:39:29,357][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 18:39:29,358][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 18:39:29,358][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 18:39:29,359][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 18:39:29,359][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 18:39:29,360][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 18:39:29,360][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 18:39:29,361][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 18:39:29,361][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 18:39:29,362][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 18:39:29,362][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 18:39:29,363][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 18:39:29,363][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 18:39:29,364][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 18:39:29,364][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 18:39:29,364][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 18:39:29,366][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 18:39:29,370][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-26 18:39:29,490][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-26 18:39:29,492][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-26 18:39:29,700][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 18:39:34,772][root][INFO] - Step: 630/1350  |  Loss: 0.6169  |  Score: 82.85 [%]  |  Seq Length: 256.0
[2024-09-26 18:39:34,774][root][INFO] - Step: 930/1035  |  Loss: 0.3663  |  Score: 90.28 [%]  |  Seq Length: 256.0
[2024-09-26 18:39:35,832][root][INFO] - 

[2024-09-26 18:39:35,832][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 18:39:35,832][root][INFO] - Data Preprocessing
[2024-09-26 18:39:35,832][root][INFO] - ㄴ remain_lang                ko_punc
[2024-09-26 18:39:35,832][root][INFO] - ㄴ do_hangeulize              True
[2024-09-26 18:39:35,832][root][INFO] - ㄴ data_remove                True

[2024-09-26 18:39:35,832][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 18:39:35,840][root][INFO] - vocab size              : 51200
[2024-09-26 18:39:35,841][root][INFO] - device                  : gpu
[2024-09-26 18:39:35,841][root][INFO] - random seed             : 42
[2024-09-26 18:39:35,841][root][INFO] - train data size         : 4096
[2024-09-26 18:39:35,841][root][INFO] - max epochs              : 15
[2024-09-26 18:39:35,841][root][INFO] - total steps             : 960
[2024-09-26 18:39:35,841][root][INFO] - warmup steps            : 96
[2024-09-26 18:39:35,841][root][INFO] - batch size              : 64
[2024-09-26 18:39:35,841][root][INFO] - accumulation steps      : 1
[2024-09-26 18:39:35,841][root][INFO] - optimizer               : adamwscale
[2024-09-26 18:39:35,841][root][INFO] - lr_scheduler            : cosine
[2024-09-26 18:39:35,841][root][INFO] - learning rate           : 0.01
[2024-09-26 18:39:35,841][root][INFO] - max length              : 256

[2024-09-26 18:39:35,842][root][INFO] - LoRA Configuration
[2024-09-26 18:39:35,842][root][INFO] - ㄴ r                    : 32
[2024-09-26 18:39:35,842][root][INFO] - ㄴ alpha                : 128
[2024-09-26 18:39:35,842][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 18:39:35,842][root][INFO] - KOMBO Configuration
[2024-09-26 18:39:35,842][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-26 18:39:35,842][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-26 18:39:35,842][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-26 18:39:35,842][root][INFO] - ㄴ do_combination       : True
[2024-09-26 18:39:35,842][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-26 18:39:35,843][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-26 18:39:35,843][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-26 18:39:35,843][root][INFO] -   ㄴ add_lora           : True

[2024-09-26 18:39:35,843][root][INFO] - LoRA in KOMBO Configuration
[2024-09-26 18:39:35,843][root][INFO] - ㄴ r                : 32
[2024-09-26 18:39:35,843][root][INFO] - ㄴ alpha            : 128
[2024-09-26 18:39:35,843][root][INFO] - ㄴ dropout          : 0.03

[2024-09-26 18:39:35,843][root][INFO] - 

[2024-09-26 18:39:35,843][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:39:35,843][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 18:39:35,844][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 18:39:35,844][root][INFO] - * tb interval   : 15

[2024-09-26 18:39:35,844][root][INFO] - 

[2024-09-26 18:39:35,844][root][INFO] - Start the Training !
[2024-09-26 18:39:35,847][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 18:39:38,644][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 18:39:38,644][root][INFO] - Score: 76.72 [%]  |  Evaluation Time: 3.87 [s]
[2024-09-26 18:39:40,536][root][INFO] - Step: 945/1035  |  Loss: 0.3826  |  Score: 89.38 [%]  |  Seq Length: 256.0
[2024-09-26 18:39:42,388][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 18:39:42,388][root][INFO] - Score: 71.26 [%]  |  Evaluation Time: 3.74 [s]
[2024-09-26 18:39:42,390][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 18:39:43,095][root][INFO] - Step: 631/1350  |  Loss: 0.6611  |  Score: 79.84 [%]  |  Seq Length: 256.0
[2024-09-26 18:39:45,184][root][INFO] - Step: 15/960  |  Loss: 3.3677  |  Score: 2.54 [%]  |  Seq Length: 256.0
[2024-09-26 18:39:46,259][root][INFO] - Step: 960/1035  |  Loss: 0.3328  |  Score: 90.49 [%]  |  Seq Length: 256.0
[2024-09-26 18:39:48,253][root][INFO] - Step: 645/1350  |  Loss: 0.5533  |  Score: 84.09 [%]  |  Seq Length: 256.0
[2024-09-26 18:39:48,586][root][INFO] - Step: 966/1035  |  Loss: 0.3702  |  Score: 89.96 [%]  |  Seq Length: 256.0
[2024-09-26 18:39:51,730][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 18:39:51,730][root][INFO] - Score: 76.72 [%]  |  Evaluation Time: 3.14 [s]
[2024-09-26 18:39:53,011][root][INFO] - Step: 30/960  |  Loss: 2.2256  |  Score: 28.40 [%]  |  Seq Length: 256.0
[2024-09-26 18:39:53,777][root][INFO] - Step: 660/1350  |  Loss: 0.5824  |  Score: 83.38 [%]  |  Seq Length: 256.0
[2024-09-26 18:39:54,682][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 18:39:54,683][root][INFO] - Score: 70.90 [%]  |  Evaluation Time: 2.95 [s]
[2024-09-26 18:39:54,685][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 18:39:58,400][root][INFO] - Step: 975/1035  |  Loss: 0.3575  |  Score: 89.69 [%]  |  Seq Length: 256.0
[2024-09-26 18:39:59,300][root][INFO] - Step: 675/1350  |  Loss: 0.6039  |  Score: 82.97 [%]  |  Seq Length: 256.0
[2024-09-26 18:40:00,876][root][INFO] - Step: 45/960  |  Loss: 1.8916  |  Score: 43.74 [%]  |  Seq Length: 256.0
[2024-09-26 18:40:04,124][root][INFO] - Step: 990/1035  |  Loss: 0.3298  |  Score: 91.45 [%]  |  Seq Length: 256.0
[2024-09-26 18:40:04,826][root][INFO] - Step: 690/1350  |  Loss: 0.5583  |  Score: 84.60 [%]  |  Seq Length: 256.0
[2024-09-26 18:40:08,436][root][INFO] - Step: 60/960  |  Loss: 1.6867  |  Score: 50.29 [%]  |  Seq Length: 256.0
[2024-09-26 18:40:09,900][root][INFO] - Step: 1005/1035  |  Loss: 0.3295  |  Score: 90.68 [%]  |  Seq Length: 256.0
[2024-09-26 18:40:10,355][root][INFO] - Step: 705/1350  |  Loss: 0.5835  |  Score: 81.94 [%]  |  Seq Length: 256.0
[2024-09-26 18:40:10,505][root][INFO] - Step: 64/960  |  Loss: 1.4681  |  Score: 61.63 [%]  |  Seq Length: 256.0
[2024-09-26 18:40:15,173][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 18:40:15,174][root][INFO] - Score: 67.80 [%]  |  Evaluation Time: 4.67 [s]
[2024-09-26 18:40:15,673][root][INFO] - Step: 1020/1035  |  Loss: 0.3249  |  Score: 91.14 [%]  |  Seq Length: 256.0
[2024-09-26 18:40:15,919][root][INFO] - Step: 720/1350  |  Loss: 0.5216  |  Score: 82.92 [%]  |  Seq Length: 256.0
[2024-09-26 18:40:19,726][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 18:40:19,726][root][INFO] - Score: 65.23 [%]  |  Evaluation Time: 4.55 [s]
[2024-09-26 18:40:19,728][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 18:40:19,729][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 18:40:19,790][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 18:40:19,790][root][INFO] - Score: 77.44 [%]  |  Evaluation Time: 3.87 [s]
[2024-09-26 18:40:21,417][root][INFO] - Step: 1035/1035  |  Loss: 0.3152  |  Score: 90.50 [%]  |  Seq Length: 256.0
[2024-09-26 18:40:23,516][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 18:40:23,517][root][INFO] - Score: 69.85 [%]  |  Evaluation Time: 3.72 [s]
[2024-09-26 18:40:23,519][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 18:40:24,353][root][INFO] - Step: 721/1350  |  Loss: 0.2903  |  Score: 90.15 [%]  |  Seq Length: 256.0
[2024-09-26 18:40:24,593][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 18:40:24,593][root][INFO] - Score: 77.52 [%]  |  Evaluation Time: 3.17 [s]
[2024-09-26 18:40:25,896][root][INFO] - Step: 75/960  |  Loss: 1.2989  |  Score: 68.16 [%]  |  Seq Length: 256.0
[2024-09-26 18:40:27,587][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 18:40:27,588][root][INFO] - Score: 70.78 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-26 18:40:27,589][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 18:40:27,589][root][INFO] - - Epoch: 6
[2024-09-26 18:40:27,589][root][INFO] - - DEV score: 77.96 [%]
[2024-09-26 18:40:27,589][root][INFO] - - TEST score: 71.93 [%]
[2024-09-26 18:40:27,590][root][INFO] - Fine-tuning is done!
[2024-09-26 18:40:29,545][root][INFO] - Step: 735/1350  |  Loss: 0.4833  |  Score: 85.83 [%]  |  Seq Length: 256.0
[2024-09-26 18:40:33,368][root][INFO] - 

[2024-09-26 18:40:33,368][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 18:40:33,368][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:40:33,368][root][INFO] - 

[2024-09-26 18:40:33,369][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 18:40:33,707][root][INFO] - Step: 90/960  |  Loss: 1.3709  |  Score: 69.50 [%]  |  Seq Length: 256.0
[2024-09-26 18:40:35,087][root][INFO] - Step: 750/1350  |  Loss: 0.4833  |  Score: 86.06 [%]  |  Seq Length: 256.0
[2024-09-26 18:40:37,720][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 18:40:37,720][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 18:40:37,721][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 18:40:37,721][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 18:40:37,722][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 18:40:37,722][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 18:40:37,723][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 18:40:37,723][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 18:40:37,723][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 18:40:37,724][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 18:40:37,724][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 18:40:37,725][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 18:40:37,725][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 18:40:37,726][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 18:40:37,726][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 18:40:37,727][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 18:40:37,727][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 18:40:37,728][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 18:40:37,728][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 18:40:37,728][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 18:40:37,729][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 18:40:37,729][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 18:40:37,730][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 18:40:37,730][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 18:40:37,732][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 18:40:37,736][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-26 18:40:37,842][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-26 18:40:37,844][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-26 18:40:38,286][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 18:40:40,657][root][INFO] - Step: 765/1350  |  Loss: 0.4737  |  Score: 85.38 [%]  |  Seq Length: 256.0
[2024-09-26 18:40:41,409][root][INFO] - Step: 105/960  |  Loss: 1.2573  |  Score: 68.91 [%]  |  Seq Length: 256.0
[2024-09-26 18:40:45,059][root][INFO] - 

[2024-09-26 18:40:45,059][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 18:40:45,059][root][INFO] - Data Preprocessing
[2024-09-26 18:40:45,059][root][INFO] - ㄴ remain_lang                ko_en_punc
[2024-09-26 18:40:45,059][root][INFO] - ㄴ do_hangeulize              True
[2024-09-26 18:40:45,060][root][INFO] - ㄴ data_remove                True

[2024-09-26 18:40:45,060][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 18:40:45,069][root][INFO] - vocab size              : 51200
[2024-09-26 18:40:45,069][root][INFO] - device                  : gpu
[2024-09-26 18:40:45,069][root][INFO] - random seed             : 42
[2024-09-26 18:40:45,069][root][INFO] - train data size         : 4416
[2024-09-26 18:40:45,069][root][INFO] - max epochs              : 15
[2024-09-26 18:40:45,069][root][INFO] - total steps             : 1035
[2024-09-26 18:40:45,070][root][INFO] - warmup steps            : 104
[2024-09-26 18:40:45,070][root][INFO] - batch size              : 64
[2024-09-26 18:40:45,070][root][INFO] - accumulation steps      : 1
[2024-09-26 18:40:45,070][root][INFO] - optimizer               : adamwscale
[2024-09-26 18:40:45,070][root][INFO] - lr_scheduler            : cosine
[2024-09-26 18:40:45,070][root][INFO] - learning rate           : 0.01
[2024-09-26 18:40:45,070][root][INFO] - max length              : 256

[2024-09-26 18:40:45,070][root][INFO] - LoRA Configuration
[2024-09-26 18:40:45,070][root][INFO] - ㄴ r                    : 32
[2024-09-26 18:40:45,070][root][INFO] - ㄴ alpha                : 128
[2024-09-26 18:40:45,070][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 18:40:45,070][root][INFO] - KOMBO Configuration
[2024-09-26 18:40:45,071][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-26 18:40:45,071][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-26 18:40:45,071][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-26 18:40:45,071][root][INFO] - ㄴ do_combination       : True
[2024-09-26 18:40:45,071][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-26 18:40:45,071][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-26 18:40:45,071][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-26 18:40:45,071][root][INFO] -   ㄴ add_lora           : True

[2024-09-26 18:40:45,071][root][INFO] - LoRA in KOMBO Configuration
[2024-09-26 18:40:45,072][root][INFO] - ㄴ r                : 32
[2024-09-26 18:40:45,072][root][INFO] - ㄴ alpha            : 128
[2024-09-26 18:40:45,072][root][INFO] - ㄴ dropout          : 0.03

[2024-09-26 18:40:45,072][root][INFO] - 

[2024-09-26 18:40:45,072][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:40:45,072][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 18:40:45,072][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 18:40:45,072][root][INFO] - * tb interval   : 15

[2024-09-26 18:40:45,072][root][INFO] - 

[2024-09-26 18:40:45,072][root][INFO] - Start the Training !
[2024-09-26 18:40:45,075][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 18:40:46,196][root][INFO] - Step: 780/1350  |  Loss: 0.5204  |  Score: 84.93 [%]  |  Seq Length: 256.0
[2024-09-26 18:40:49,142][root][INFO] - Step: 120/960  |  Loss: 1.3040  |  Score: 62.12 [%]  |  Seq Length: 256.0
[2024-09-26 18:40:51,733][root][INFO] - Step: 795/1350  |  Loss: 0.5140  |  Score: 85.56 [%]  |  Seq Length: 256.0
[2024-09-26 18:40:53,367][root][INFO] - Step: 128/960  |  Loss: 1.3166  |  Score: 63.93 [%]  |  Seq Length: 256.0
[2024-09-26 18:40:54,580][root][INFO] - Step: 15/1035  |  Loss: 3.1513  |  Score: 9.14 [%]  |  Seq Length: 256.0
[2024-09-26 18:40:57,315][root][INFO] - Step: 810/1350  |  Loss: 0.4980  |  Score: 85.66 [%]  |  Seq Length: 256.0
[2024-09-26 18:40:58,149][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 18:40:58,149][root][INFO] - Score: 70.44 [%]  |  Evaluation Time: 4.78 [s]
[2024-09-26 18:41:01,232][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 18:41:01,232][root][INFO] - Score: 77.05 [%]  |  Evaluation Time: 3.91 [s]
[2024-09-26 18:41:02,570][root][INFO] - Step: 30/1035  |  Loss: 2.2335  |  Score: 16.94 [%]  |  Seq Length: 256.0
[2024-09-26 18:41:02,650][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 18:41:02,651][root][INFO] - Score: 65.88 [%]  |  Evaluation Time: 4.50 [s]
[2024-09-26 18:41:02,652][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 18:41:02,653][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 18:41:04,792][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 18:41:04,792][root][INFO] - Score: 70.96 [%]  |  Evaluation Time: 3.56 [s]
[2024-09-26 18:41:04,794][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 18:41:05,609][root][INFO] - Step: 811/1350  |  Loss: 0.3629  |  Score: 85.66 [%]  |  Seq Length: 256.0
[2024-09-26 18:41:06,829][root][INFO] - Step: 135/960  |  Loss: 1.1590  |  Score: 67.35 [%]  |  Seq Length: 256.0
[2024-09-26 18:41:10,597][root][INFO] - Step: 45/1035  |  Loss: 1.9802  |  Score: 42.49 [%]  |  Seq Length: 256.0
[2024-09-26 18:41:10,786][root][INFO] - Step: 825/1350  |  Loss: 0.4237  |  Score: 88.56 [%]  |  Seq Length: 256.0
[2024-09-26 18:41:14,606][root][INFO] - Step: 150/960  |  Loss: 1.1536  |  Score: 69.64 [%]  |  Seq Length: 256.0
[2024-09-26 18:41:16,324][root][INFO] - Step: 840/1350  |  Loss: 0.4759  |  Score: 86.16 [%]  |  Seq Length: 256.0
[2024-09-26 18:41:18,557][root][INFO] - Step: 60/1035  |  Loss: 1.6428  |  Score: 55.77 [%]  |  Seq Length: 256.0
[2024-09-26 18:41:21,860][root][INFO] - Step: 855/1350  |  Loss: 0.4531  |  Score: 86.15 [%]  |  Seq Length: 256.0
[2024-09-26 18:41:22,364][root][INFO] - Step: 165/960  |  Loss: 1.0561  |  Score: 71.11 [%]  |  Seq Length: 256.0
[2024-09-26 18:41:23,368][root][INFO] - Step: 69/1035  |  Loss: 1.4453  |  Score: 58.69 [%]  |  Seq Length: 256.0
[2024-09-26 18:41:27,397][root][INFO] - Step: 870/1350  |  Loss: 0.5112  |  Score: 85.69 [%]  |  Seq Length: 256.0
[2024-09-26 18:41:28,628][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 18:41:28,628][root][INFO] - Score: 70.59 [%]  |  Evaluation Time: 5.26 [s]
[2024-09-26 18:41:30,069][root][INFO] - Step: 180/960  |  Loss: 1.0026  |  Score: 71.50 [%]  |  Seq Length: 256.0
[2024-09-26 18:41:32,934][root][INFO] - Step: 885/1350  |  Loss: 0.4552  |  Score: 87.26 [%]  |  Seq Length: 256.0
[2024-09-26 18:41:33,375][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 18:41:33,375][root][INFO] - Score: 65.73 [%]  |  Evaluation Time: 4.74 [s]
[2024-09-26 18:41:33,377][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 18:41:33,378][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 18:41:36,350][root][INFO] - Step: 192/960  |  Loss: 1.1689  |  Score: 71.09 [%]  |  Seq Length: 256.0
[2024-09-26 18:41:36,973][root][INFO] - Step: 75/1035  |  Loss: 1.3404  |  Score: 65.13 [%]  |  Seq Length: 256.0
[2024-09-26 18:41:38,502][root][INFO] - Step: 900/1350  |  Loss: 0.4386  |  Score: 86.95 [%]  |  Seq Length: 256.0
[2024-09-26 18:41:40,932][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 18:41:40,932][root][INFO] - Score: 78.68 [%]  |  Evaluation Time: 4.58 [s]
[2024-09-26 18:41:42,381][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 18:41:42,382][root][INFO] - Score: 77.72 [%]  |  Evaluation Time: 3.88 [s]
[2024-09-26 18:41:44,899][root][INFO] - Step: 90/1035  |  Loss: 1.2999  |  Score: 61.44 [%]  |  Seq Length: 256.0
[2024-09-26 18:41:45,478][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 18:41:45,478][root][INFO] - Score: 68.74 [%]  |  Evaluation Time: 4.54 [s]
[2024-09-26 18:41:45,480][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 18:41:45,481][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 18:41:45,899][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 18:41:45,899][root][INFO] - Score: 70.89 [%]  |  Evaluation Time: 3.52 [s]
[2024-09-26 18:41:45,900][root][INFO] - 
Save new Best Score (Epoch: 10)
[2024-09-26 18:41:45,901][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 18:41:46,722][root][INFO] - Step: 901/1350  |  Loss: 0.3500  |  Score: 89.67 [%]  |  Seq Length: 256.0
[2024-09-26 18:41:47,533][root][INFO] - Step: 195/960  |  Loss: 0.8890  |  Score: 73.59 [%]  |  Seq Length: 256.0
[2024-09-26 18:41:51,893][root][INFO] - Step: 915/1350  |  Loss: 0.4259  |  Score: 87.90 [%]  |  Seq Length: 256.0
[2024-09-26 18:41:52,901][root][INFO] - Step: 105/1035  |  Loss: 1.3325  |  Score: 64.91 [%]  |  Seq Length: 256.0
[2024-09-26 18:41:55,311][root][INFO] - Step: 210/960  |  Loss: 0.9878  |  Score: 72.75 [%]  |  Seq Length: 256.0
[2024-09-26 18:41:57,431][root][INFO] - Step: 930/1350  |  Loss: 0.3847  |  Score: 88.37 [%]  |  Seq Length: 256.0
[2024-09-26 18:42:01,024][root][INFO] - Step: 120/1035  |  Loss: 1.4389  |  Score: 65.59 [%]  |  Seq Length: 256.0
[2024-09-26 18:42:02,971][root][INFO] - Step: 945/1350  |  Loss: 0.4150  |  Score: 88.22 [%]  |  Seq Length: 256.0
[2024-09-26 18:42:03,029][root][INFO] - Step: 225/960  |  Loss: 0.8677  |  Score: 78.30 [%]  |  Seq Length: 256.0
[2024-09-26 18:42:08,515][root][INFO] - Step: 960/1350  |  Loss: 0.3754  |  Score: 87.97 [%]  |  Seq Length: 256.0
[2024-09-26 18:42:09,093][root][INFO] - Step: 135/1035  |  Loss: 1.2834  |  Score: 66.50 [%]  |  Seq Length: 256.0
[2024-09-26 18:42:10,784][root][INFO] - Step: 138/1035  |  Loss: 1.1234  |  Score: 67.51 [%]  |  Seq Length: 256.0
[2024-09-26 18:42:10,785][root][INFO] - Step: 240/960  |  Loss: 0.8759  |  Score: 74.49 [%]  |  Seq Length: 256.0
[2024-09-26 18:42:14,055][root][INFO] - Step: 975/1350  |  Loss: 0.4159  |  Score: 86.45 [%]  |  Seq Length: 256.0
[2024-09-26 18:42:15,819][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 18:42:15,820][root][INFO] - Score: 75.62 [%]  |  Evaluation Time: 5.03 [s]
[2024-09-26 18:42:18,596][root][INFO] - Step: 255/960  |  Loss: 1.0116  |  Score: 74.93 [%]  |  Seq Length: 256.0
[2024-09-26 18:42:19,166][root][INFO] - Step: 256/960  |  Loss: 0.8147  |  Score: 81.40 [%]  |  Seq Length: 256.0
[2024-09-26 18:42:19,635][root][INFO] - Step: 990/1350  |  Loss: 0.4167  |  Score: 88.02 [%]  |  Seq Length: 256.0
[2024-09-26 18:42:20,752][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 18:42:20,752][root][INFO] - Score: 68.28 [%]  |  Evaluation Time: 4.93 [s]
[2024-09-26 18:42:20,753][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 18:42:20,754][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 18:42:23,460][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 18:42:23,461][root][INFO] - Score: 77.30 [%]  |  Evaluation Time: 3.82 [s]
[2024-09-26 18:42:23,726][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 18:42:23,726][root][INFO] - Score: 77.61 [%]  |  Evaluation Time: 4.56 [s]
[2024-09-26 18:42:27,156][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 18:42:27,157][root][INFO] - Score: 70.96 [%]  |  Evaluation Time: 3.69 [s]
[2024-09-26 18:42:27,159][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 18:42:27,582][root][INFO] - Step: 150/1035  |  Loss: 1.0785  |  Score: 70.37 [%]  |  Seq Length: 256.0
[2024-09-26 18:42:28,009][root][INFO] - Step: 991/1350  |  Loss: 0.3441  |  Score: 86.98 [%]  |  Seq Length: 256.0
[2024-09-26 18:42:28,302][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 18:42:28,303][root][INFO] - Score: 69.35 [%]  |  Evaluation Time: 4.57 [s]
[2024-09-26 18:42:28,305][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 18:42:33,195][root][INFO] - Step: 1005/1350  |  Loss: 0.4150  |  Score: 88.09 [%]  |  Seq Length: 256.0
[2024-09-26 18:42:35,568][root][INFO] - Step: 165/1035  |  Loss: 1.1102  |  Score: 72.10 [%]  |  Seq Length: 256.0
[2024-09-26 18:42:35,989][root][INFO] - Step: 270/960  |  Loss: 0.8255  |  Score: 80.61 [%]  |  Seq Length: 256.0
[2024-09-26 18:42:38,746][root][INFO] - Step: 1020/1350  |  Loss: 0.3890  |  Score: 88.67 [%]  |  Seq Length: 256.0
[2024-09-26 18:42:43,464][root][INFO] - Step: 180/1035  |  Loss: 1.1233  |  Score: 69.48 [%]  |  Seq Length: 256.0
[2024-09-26 18:42:43,740][root][INFO] - Step: 285/960  |  Loss: 0.7631  |  Score: 79.41 [%]  |  Seq Length: 256.0
[2024-09-26 18:42:44,290][root][INFO] - Step: 1035/1350  |  Loss: 0.3867  |  Score: 87.85 [%]  |  Seq Length: 256.0
[2024-09-26 18:42:49,831][root][INFO] - Step: 1050/1350  |  Loss: 0.3921  |  Score: 88.78 [%]  |  Seq Length: 256.0
[2024-09-26 18:42:51,421][root][INFO] - Step: 195/1035  |  Loss: 1.0814  |  Score: 69.92 [%]  |  Seq Length: 256.0
[2024-09-26 18:42:51,598][root][INFO] - Step: 300/960  |  Loss: 0.7885  |  Score: 78.50 [%]  |  Seq Length: 256.0
[2024-09-26 18:42:55,374][root][INFO] - Step: 1065/1350  |  Loss: 0.3763  |  Score: 88.74 [%]  |  Seq Length: 256.0
[2024-09-26 18:42:57,832][root][INFO] - Step: 207/1035  |  Loss: 1.1119  |  Score: 68.40 [%]  |  Seq Length: 256.0
[2024-09-26 18:42:59,447][root][INFO] - Step: 315/960  |  Loss: 0.9201  |  Score: 76.32 [%]  |  Seq Length: 256.0
[2024-09-26 18:43:00,982][root][INFO] - Step: 1080/1350  |  Loss: 0.3997  |  Score: 87.61 [%]  |  Seq Length: 256.0
[2024-09-26 18:43:02,045][root][INFO] - Step: 320/960  |  Loss: 0.8664  |  Score: 75.64 [%]  |  Seq Length: 256.0
[2024-09-26 18:43:02,910][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 18:43:02,911][root][INFO] - Score: 76.92 [%]  |  Evaluation Time: 5.08 [s]
[2024-09-26 18:43:04,841][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 18:43:04,842][root][INFO] - Score: 77.28 [%]  |  Evaluation Time: 3.86 [s]
[2024-09-26 18:43:06,636][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 18:43:06,636][root][INFO] - Score: 76.20 [%]  |  Evaluation Time: 4.59 [s]
[2024-09-26 18:43:07,653][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 18:43:07,653][root][INFO] - Score: 69.30 [%]  |  Evaluation Time: 4.74 [s]
[2024-09-26 18:43:07,654][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 18:43:07,655][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 18:43:08,413][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 18:43:08,414][root][INFO] - Score: 70.77 [%]  |  Evaluation Time: 3.57 [s]
[2024-09-26 18:43:08,416][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 18:43:09,143][root][INFO] - Step: 1081/1350  |  Loss: 0.4213  |  Score: 85.57 [%]  |  Seq Length: 256.0
[2024-09-26 18:43:09,699][root][INFO] - Step: 210/1035  |  Loss: 0.8865  |  Score: 82.19 [%]  |  Seq Length: 256.0
[2024-09-26 18:43:11,192][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 18:43:11,193][root][INFO] - Score: 71.91 [%]  |  Evaluation Time: 4.55 [s]
[2024-09-26 18:43:11,194][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 18:43:11,195][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 18:43:14,321][root][INFO] - Step: 1095/1350  |  Loss: 0.3354  |  Score: 89.36 [%]  |  Seq Length: 256.0
[2024-09-26 18:44:36,361][root][INFO] - 

[2024-09-26 18:44:36,361][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 18:44:36,361][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:44:36,361][root][INFO] - 

[2024-09-26 18:44:36,361][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 18:44:38,763][root][INFO] - 

[2024-09-26 18:44:38,763][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 18:44:38,763][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:44:38,763][root][INFO] - 

[2024-09-26 18:44:38,763][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 18:44:39,971][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:39,971][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:39,972][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:39,972][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:39,973][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:39,973][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:39,974][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:39,974][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:39,975][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:39,976][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:39,977][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:39,978][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:39,978][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:39,979][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:39,980][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:39,980][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:39,981][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:39,982][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:39,982][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:39,983][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:39,984][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:39,984][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:39,985][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:39,986][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:39,989][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 18:44:40,427][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 18:44:41,131][root][INFO] - 

[2024-09-26 18:44:41,131][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 18:44:41,132][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:44:41,132][root][INFO] - 

[2024-09-26 18:44:41,132][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 18:44:43,091][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:43,091][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:43,092][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:43,092][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:43,093][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:43,093][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:43,094][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:43,094][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:43,095][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:43,095][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:43,095][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:43,096][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:43,096][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:43,097][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:43,097][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:43,098][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:43,098][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:43,099][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:43,099][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:43,100][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:43,100][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:43,101][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:43,101][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:43,102][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:43,103][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 18:44:43,327][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 18:44:44,451][root][INFO] - 

[2024-09-26 18:44:44,451][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 18:44:44,451][root][INFO] - Data Preprocessing
[2024-09-26 18:44:44,451][root][INFO] - ㄴ remain_lang                ko
[2024-09-26 18:44:44,451][root][INFO] - ㄴ do_hangeulize              True
[2024-09-26 18:44:44,451][root][INFO] - ㄴ data_remove                True

[2024-09-26 18:44:44,451][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 18:44:44,459][root][INFO] - vocab size              : 51200
[2024-09-26 18:44:44,460][root][INFO] - device                  : gpu
[2024-09-26 18:44:44,460][root][INFO] - random seed             : 42
[2024-09-26 18:44:44,460][root][INFO] - train data size         : 448
[2024-09-26 18:44:44,460][root][INFO] - max epochs              : 15
[2024-09-26 18:44:44,460][root][INFO] - total steps             : 105
[2024-09-26 18:44:44,460][root][INFO] - warmup steps            : 10
[2024-09-26 18:44:44,460][root][INFO] - batch size              : 64
[2024-09-26 18:44:44,460][root][INFO] - accumulation steps      : 1
[2024-09-26 18:44:44,460][root][INFO] - optimizer               : adamwscale
[2024-09-26 18:44:44,461][root][INFO] - lr_scheduler            : cosine
[2024-09-26 18:44:44,461][root][INFO] - learning rate           : 0.01
[2024-09-26 18:44:44,461][root][INFO] - max length              : 256

[2024-09-26 18:44:44,461][root][INFO] - LoRA Configuration
[2024-09-26 18:44:44,461][root][INFO] - ㄴ r                    : 32
[2024-09-26 18:44:44,461][root][INFO] - ㄴ alpha                : 128
[2024-09-26 18:44:44,461][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 18:44:44,461][root][INFO] - 

[2024-09-26 18:44:44,461][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:44:44,461][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 18:44:44,462][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 18:44:44,462][root][INFO] - * tb interval   : 15

[2024-09-26 18:44:44,462][root][INFO] - 

[2024-09-26 18:44:44,462][root][INFO] - Start the Training !
[2024-09-26 18:44:44,465][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 18:44:45,725][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:45,726][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:45,727][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:45,728][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:45,729][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:45,729][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:45,730][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:45,731][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:45,732][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:45,732][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:45,733][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:45,734][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:45,735][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:45,735][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:45,736][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:45,737][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:45,737][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:45,738][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:45,739][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:45,740][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:45,741][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:45,741][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:45,742][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 18:44:45,743][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 18:44:45,747][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 18:44:46,198][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 18:44:47,692][root][INFO] - 

[2024-09-26 18:44:47,692][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 18:44:47,692][root][INFO] - Data Preprocessing
[2024-09-26 18:44:47,692][root][INFO] - ㄴ remain_lang                ko_en_punc
[2024-09-26 18:44:47,692][root][INFO] - ㄴ do_hangeulize              True
[2024-09-26 18:44:47,692][root][INFO] - ㄴ data_remove                True

[2024-09-26 18:44:47,692][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 18:44:47,701][root][INFO] - vocab size              : 51200
[2024-09-26 18:44:47,701][root][INFO] - device                  : gpu
[2024-09-26 18:44:47,701][root][INFO] - random seed             : 42
[2024-09-26 18:44:47,701][root][INFO] - train data size         : 4416
[2024-09-26 18:44:47,701][root][INFO] - max epochs              : 15
[2024-09-26 18:44:47,701][root][INFO] - total steps             : 1035
[2024-09-26 18:44:47,701][root][INFO] - warmup steps            : 104
[2024-09-26 18:44:47,701][root][INFO] - batch size              : 64
[2024-09-26 18:44:47,702][root][INFO] - accumulation steps      : 1
[2024-09-26 18:44:47,702][root][INFO] - optimizer               : adamwscale
[2024-09-26 18:44:47,702][root][INFO] - lr_scheduler            : cosine
[2024-09-26 18:44:47,702][root][INFO] - learning rate           : 0.01
[2024-09-26 18:44:47,702][root][INFO] - max length              : 256

[2024-09-26 18:44:47,702][root][INFO] - LoRA Configuration
[2024-09-26 18:44:47,702][root][INFO] - ㄴ r                    : 32
[2024-09-26 18:44:47,702][root][INFO] - ㄴ alpha                : 128
[2024-09-26 18:44:47,702][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 18:44:47,702][root][INFO] - 

[2024-09-26 18:44:47,702][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:44:47,703][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 18:44:47,703][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 18:44:47,703][root][INFO] - * tb interval   : 15

[2024-09-26 18:44:47,703][root][INFO] - 

[2024-09-26 18:44:47,703][root][INFO] - Start the Training !
[2024-09-26 18:44:47,706][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 18:44:50,155][root][INFO] - 

[2024-09-26 18:44:50,156][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 18:44:50,156][root][INFO] - Data Preprocessing
[2024-09-26 18:44:50,156][root][INFO] - ㄴ remain_lang                ko_punc
[2024-09-26 18:44:50,156][root][INFO] - ㄴ do_hangeulize              True
[2024-09-26 18:44:50,156][root][INFO] - ㄴ data_remove                True

[2024-09-26 18:44:50,156][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 18:44:50,165][root][INFO] - vocab size              : 51200
[2024-09-26 18:44:50,165][root][INFO] - device                  : gpu
[2024-09-26 18:44:50,165][root][INFO] - random seed             : 42
[2024-09-26 18:44:50,165][root][INFO] - train data size         : 4096
[2024-09-26 18:44:50,165][root][INFO] - max epochs              : 15
[2024-09-26 18:44:50,165][root][INFO] - total steps             : 960
[2024-09-26 18:44:50,165][root][INFO] - warmup steps            : 96
[2024-09-26 18:44:50,166][root][INFO] - batch size              : 64
[2024-09-26 18:44:50,166][root][INFO] - accumulation steps      : 1
[2024-09-26 18:44:50,166][root][INFO] - optimizer               : adamwscale
[2024-09-26 18:44:50,166][root][INFO] - lr_scheduler            : cosine
[2024-09-26 18:44:50,166][root][INFO] - learning rate           : 0.01
[2024-09-26 18:44:50,166][root][INFO] - max length              : 256

[2024-09-26 18:44:50,166][root][INFO] - LoRA Configuration
[2024-09-26 18:44:50,166][root][INFO] - ㄴ r                    : 32
[2024-09-26 18:44:50,166][root][INFO] - ㄴ alpha                : 128
[2024-09-26 18:44:50,166][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 18:44:50,166][root][INFO] - 

[2024-09-26 18:44:50,166][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:44:50,167][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 18:44:50,167][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 18:44:50,167][root][INFO] - * tb interval   : 15

[2024-09-26 18:44:50,167][root][INFO] - 

[2024-09-26 18:44:50,167][root][INFO] - Start the Training !
[2024-09-26 18:44:50,170][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 18:44:50,189][root][INFO] - Step: 7/105  |  Loss: 5.0383  |  Score: -4.30 [%]  |  Seq Length: 256.0
[2024-09-26 18:44:50,650][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 18:44:50,650][root][INFO] - Score: 1.78 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-26 18:44:51,069][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 18:44:51,069][root][INFO] - Score: -13.68 [%]  |  Evaluation Time: 0.42 [s]
[2024-09-26 18:44:51,071][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 18:44:53,754][root][INFO] - Step: 14/105  |  Loss: 2.8932  |  Score: 9.80 [%]  |  Seq Length: 256.0
[2024-09-26 18:44:54,192][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 18:44:54,192][root][INFO] - Score: 0.01 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-26 18:44:54,603][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 18:44:54,603][root][INFO] - Score: -1.39 [%]  |  Evaluation Time: 0.41 [s]
[2024-09-26 18:44:54,605][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 18:44:55,400][root][INFO] - Step: 15/105  |  Loss: 2.1525  |  Score: 26.63 [%]  |  Seq Length: 256.0
[2024-09-26 18:44:56,488][root][INFO] - Step: 15/1035  |  Loss: 3.2320  |  Score: 8.30 [%]  |  Seq Length: 256.0
[2024-09-26 18:44:57,454][root][INFO] - Step: 21/105  |  Loss: 2.0978  |  Score: 34.06 [%]  |  Seq Length: 256.0
[2024-09-26 18:44:57,887][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 18:44:57,887][root][INFO] - Score: 12.49 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-26 18:44:58,303][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 18:44:58,303][root][INFO] - Score: 5.61 [%]  |  Evaluation Time: 0.41 [s]
[2024-09-26 18:44:58,304][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 18:44:58,306][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 18:44:58,813][root][INFO] - Step: 15/960  |  Loss: 3.2171  |  Score: 3.58 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:01,082][root][INFO] - Step: 28/105  |  Loss: 1.7231  |  Score: 54.79 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:01,524][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 18:45:01,524][root][INFO] - Score: 21.36 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-26 18:45:01,941][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 18:45:01,941][root][INFO] - Score: 17.17 [%]  |  Evaluation Time: 0.41 [s]
[2024-09-26 18:45:01,942][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-26 18:45:01,943][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 18:45:02,230][root][INFO] - Step: 30/1035  |  Loss: 2.2783  |  Score: 19.95 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:02,988][root][INFO] - Step: 30/105  |  Loss: 1.5142  |  Score: 70.43 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:04,350][root][INFO] - Step: 30/960  |  Loss: 2.4091  |  Score: 21.72 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:04,661][root][INFO] - Step: 35/105  |  Loss: 1.4010  |  Score: 63.34 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:05,093][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 18:45:05,093][root][INFO] - Score: 29.03 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-26 18:45:05,510][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 18:45:05,510][root][INFO] - Score: 28.72 [%]  |  Evaluation Time: 0.41 [s]
[2024-09-26 18:45:05,511][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 18:45:05,512][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 18:45:07,977][root][INFO] - Step: 45/1035  |  Loss: 1.9845  |  Score: 37.75 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:08,343][root][INFO] - Step: 42/105  |  Loss: 1.0899  |  Score: 74.52 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:08,770][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 18:45:08,770][root][INFO] - Score: 34.90 [%]  |  Evaluation Time: 0.42 [s]
[2024-09-26 18:45:09,189][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 18:45:09,190][root][INFO] - Score: 30.82 [%]  |  Evaluation Time: 0.42 [s]
[2024-09-26 18:45:09,191][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 18:45:09,192][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 18:45:09,927][root][INFO] - Step: 45/960  |  Loss: 2.0137  |  Score: 42.06 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:10,686][root][INFO] - Step: 45/105  |  Loss: 0.9675  |  Score: 77.42 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:12,007][root][INFO] - Step: 49/105  |  Loss: 0.8794  |  Score: 80.23 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:12,446][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 18:45:12,446][root][INFO] - Score: 36.90 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-26 18:45:12,863][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 18:45:12,863][root][INFO] - Score: 31.79 [%]  |  Evaluation Time: 0.41 [s]
[2024-09-26 18:45:12,864][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-26 18:45:12,865][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 18:45:13,706][root][INFO] - Step: 60/1035  |  Loss: 1.6977  |  Score: 55.19 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:15,519][root][INFO] - Step: 60/960  |  Loss: 1.7086  |  Score: 52.16 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:15,580][root][INFO] - Step: 56/105  |  Loss: 0.7995  |  Score: 79.29 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:16,017][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 18:45:16,018][root][INFO] - Score: 39.79 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-26 18:45:16,441][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 18:45:16,441][root][INFO] - Score: 33.71 [%]  |  Evaluation Time: 0.42 [s]
[2024-09-26 18:45:16,442][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-26 18:45:16,443][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 18:45:17,058][root][INFO] - Step: 64/960  |  Loss: 1.5735  |  Score: 59.58 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:17,156][root][INFO] - Step: 69/1035  |  Loss: 1.5733  |  Score: 59.65 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:18,361][root][INFO] - Step: 60/105  |  Loss: 0.6678  |  Score: 86.26 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:19,314][root][INFO] - Step: 63/105  |  Loss: 0.7053  |  Score: 81.76 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:19,787][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 18:45:19,787][root][INFO] - Score: 39.81 [%]  |  Evaluation Time: 0.47 [s]
[2024-09-26 18:45:20,080][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 18:45:20,081][root][INFO] - Score: 71.92 [%]  |  Evaluation Time: 3.02 [s]
[2024-09-26 18:45:20,235][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 18:45:20,235][root][INFO] - Score: 33.50 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-26 18:45:20,237][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 18:45:20,375][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 18:45:20,375][root][INFO] - Score: 73.07 [%]  |  Evaluation Time: 3.21 [s]
[2024-09-26 18:45:22,987][root][INFO] - Step: 70/105  |  Loss: 0.6832  |  Score: 85.57 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:23,007][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 18:45:23,008][root][INFO] - Score: 61.92 [%]  |  Evaluation Time: 2.92 [s]
[2024-09-26 18:45:23,009][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 18:45:23,011][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 18:45:23,382][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 18:45:23,382][root][INFO] - Score: 61.76 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-26 18:45:23,384][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 18:45:23,385][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 18:45:23,409][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 18:45:23,409][root][INFO] - Score: 41.25 [%]  |  Evaluation Time: 0.42 [s]
[2024-09-26 18:45:23,811][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 18:45:23,811][root][INFO] - Score: 32.54 [%]  |  Evaluation Time: 0.40 [s]
[2024-09-26 18:45:23,812][root][INFO] - 
Save new Best Score (Epoch: 10)
[2024-09-26 18:45:23,815][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 18:45:25,954][root][INFO] - Step: 75/105  |  Loss: 0.5427  |  Score: 87.48 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:26,140][root][INFO] - Step: 75/1035  |  Loss: 1.3812  |  Score: 63.28 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:26,553][root][INFO] - Step: 77/105  |  Loss: 0.4340  |  Score: 82.38 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:27,050][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 18:45:27,050][root][INFO] - Score: 40.19 [%]  |  Evaluation Time: 0.49 [s]
[2024-09-26 18:45:27,467][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 18:45:27,467][root][INFO] - Score: 32.94 [%]  |  Evaluation Time: 0.41 [s]
[2024-09-26 18:45:27,470][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 18:45:27,533][root][INFO] - Step: 75/960  |  Loss: 1.4354  |  Score: 62.03 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:30,349][root][INFO] - Step: 84/105  |  Loss: 0.5878  |  Score: 86.74 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:30,786][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 18:45:30,786][root][INFO] - Score: 41.22 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-26 18:45:31,200][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 18:45:31,200][root][INFO] - Score: 32.28 [%]  |  Evaluation Time: 0.41 [s]
[2024-09-26 18:45:31,202][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 18:45:31,877][root][INFO] - Step: 90/1035  |  Loss: 1.3100  |  Score: 63.54 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:33,081][root][INFO] - Step: 90/960  |  Loss: 1.4031  |  Score: 63.32 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:33,712][root][INFO] - Step: 90/105  |  Loss: 0.4688  |  Score: 89.75 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:33,924][root][INFO] - Step: 91/105  |  Loss: 0.4254  |  Score: 90.65 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:34,367][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 18:45:34,367][root][INFO] - Score: 40.92 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-26 18:45:34,777][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 18:45:34,777][root][INFO] - Score: 32.61 [%]  |  Evaluation Time: 0.41 [s]
[2024-09-26 18:45:34,780][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 18:45:37,528][root][INFO] - Step: 98/105  |  Loss: 0.5460  |  Score: 87.88 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:37,610][root][INFO] - Step: 105/1035  |  Loss: 1.2323  |  Score: 63.34 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:37,971][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 18:45:37,972][root][INFO] - Score: 40.28 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-26 18:45:38,371][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 18:45:38,371][root][INFO] - Score: 33.47 [%]  |  Evaluation Time: 0.40 [s]
[2024-09-26 18:45:38,374][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 18:45:38,638][root][INFO] - Step: 105/960  |  Loss: 1.2867  |  Score: 65.80 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:41,285][root][INFO] - Step: 105/105  |  Loss: 0.5006  |  Score: 87.54 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:41,786][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 18:45:41,787][root][INFO] - Score: 40.41 [%]  |  Evaluation Time: 0.50 [s]
[2024-09-26 18:45:42,210][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 18:45:42,210][root][INFO] - Score: 33.27 [%]  |  Evaluation Time: 0.42 [s]
[2024-09-26 18:45:42,211][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 18:45:42,211][root][INFO] - - Epoch: 10
[2024-09-26 18:45:42,211][root][INFO] - - DEV score: 41.25 [%]
[2024-09-26 18:45:42,211][root][INFO] - - TEST score: 32.54 [%]
[2024-09-26 18:45:42,212][root][INFO] - Fine-tuning is done!
[2024-09-26 18:45:43,340][root][INFO] - Step: 120/1035  |  Loss: 1.2890  |  Score: 65.41 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:44,206][root][INFO] - Step: 120/960  |  Loss: 1.3070  |  Score: 67.76 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:47,224][root][INFO] - Step: 128/960  |  Loss: 1.2106  |  Score: 66.70 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:48,532][root][INFO] - 

[2024-09-26 18:45:48,533][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 18:45:48,533][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:45:48,533][root][INFO] - 

[2024-09-26 18:45:48,533][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 18:45:49,067][root][INFO] - Step: 135/1035  |  Loss: 1.2640  |  Score: 66.19 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:50,230][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 18:45:50,231][root][INFO] - Score: 76.57 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-26 18:45:50,268][root][INFO] - Step: 138/1035  |  Loss: 1.2267  |  Score: 72.78 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:52,199][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 18:45:52,199][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 18:45:52,200][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 18:45:52,200][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 18:45:52,201][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 18:45:52,201][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 18:45:52,201][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 18:45:52,202][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 18:45:52,202][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 18:45:52,203][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 18:45:52,203][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 18:45:52,203][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 18:45:52,204][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 18:45:52,204][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 18:45:52,205][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 18:45:52,205][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 18:45:52,206][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 18:45:52,206][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 18:45:52,206][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 18:45:52,207][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 18:45:52,207][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 18:45:52,208][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 18:45:52,208][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 18:45:52,209][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 18:45:52,210][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 18:45:52,214][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-26 18:45:52,321][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-26 18:45:52,323][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-26 18:45:52,781][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 18:45:53,180][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 18:45:53,180][root][INFO] - Score: 68.05 [%]  |  Evaluation Time: 2.95 [s]
[2024-09-26 18:45:53,181][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 18:45:53,182][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 18:45:53,575][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 18:45:53,575][root][INFO] - Score: 75.34 [%]  |  Evaluation Time: 3.30 [s]
[2024-09-26 18:45:56,254][root][INFO] - Step: 135/960  |  Loss: 1.2149  |  Score: 70.49 [%]  |  Seq Length: 256.0
[2024-09-26 18:45:56,585][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 18:45:56,586][root][INFO] - Score: 68.21 [%]  |  Evaluation Time: 3.01 [s]
[2024-09-26 18:45:56,587][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 18:45:56,594][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 18:45:59,364][root][INFO] - 

[2024-09-26 18:45:59,365][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 18:45:59,365][root][INFO] - Data Preprocessing
[2024-09-26 18:45:59,365][root][INFO] - ㄴ remain_lang                ko
[2024-09-26 18:45:59,365][root][INFO] - ㄴ do_hangeulize              True
[2024-09-26 18:45:59,365][root][INFO] - ㄴ data_remove                True

[2024-09-26 18:45:59,365][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 18:45:59,373][root][INFO] - vocab size              : 51200
[2024-09-26 18:45:59,373][root][INFO] - device                  : gpu
[2024-09-26 18:45:59,374][root][INFO] - random seed             : 42
[2024-09-26 18:45:59,374][root][INFO] - train data size         : 448
[2024-09-26 18:45:59,374][root][INFO] - max epochs              : 15
[2024-09-26 18:45:59,374][root][INFO] - total steps             : 105
[2024-09-26 18:45:59,374][root][INFO] - warmup steps            : 10
[2024-09-26 18:45:59,374][root][INFO] - batch size              : 64
[2024-09-26 18:45:59,374][root][INFO] - accumulation steps      : 1
[2024-09-26 18:45:59,374][root][INFO] - optimizer               : adamwscale
[2024-09-26 18:45:59,374][root][INFO] - lr_scheduler            : cosine
[2024-09-26 18:45:59,374][root][INFO] - learning rate           : 0.01
[2024-09-26 18:45:59,374][root][INFO] - max length              : 256

[2024-09-26 18:45:59,375][root][INFO] - LoRA Configuration
[2024-09-26 18:45:59,375][root][INFO] - ㄴ r                    : 32
[2024-09-26 18:45:59,375][root][INFO] - ㄴ alpha                : 128
[2024-09-26 18:45:59,375][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 18:45:59,375][root][INFO] - KOMBO Configuration
[2024-09-26 18:45:59,375][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-26 18:45:59,375][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-26 18:45:59,375][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-26 18:45:59,375][root][INFO] - ㄴ do_combination       : True
[2024-09-26 18:45:59,375][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-26 18:45:59,376][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-26 18:45:59,376][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-26 18:45:59,376][root][INFO] -   ㄴ add_lora           : True

[2024-09-26 18:45:59,376][root][INFO] - LoRA in KOMBO Configuration
[2024-09-26 18:45:59,376][root][INFO] - ㄴ r                : 32
[2024-09-26 18:45:59,376][root][INFO] - ㄴ alpha            : 128
[2024-09-26 18:45:59,376][root][INFO] - ㄴ dropout          : 0.03

[2024-09-26 18:45:59,376][root][INFO] - 

[2024-09-26 18:45:59,376][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:45:59,376][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 18:45:59,376][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 18:45:59,377][root][INFO] - * tb interval   : 15

[2024-09-26 18:45:59,377][root][INFO] - 

[2024-09-26 18:45:59,377][root][INFO] - Start the Training !
[2024-09-26 18:45:59,380][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 18:46:01,512][root][INFO] - Step: 150/1035  |  Loss: 1.1503  |  Score: 68.61 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:01,828][root][INFO] - Step: 150/960  |  Loss: 1.1305  |  Score: 71.82 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:04,119][root][INFO] - Step: 7/105  |  Loss: 4.9633  |  Score: 5.87 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:04,684][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 18:46:04,684][root][INFO] - Score: 1.11 [%]  |  Evaluation Time: 0.56 [s]
[2024-09-26 18:46:05,211][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 18:46:05,211][root][INFO] - Score: -8.62 [%]  |  Evaluation Time: 0.52 [s]
[2024-09-26 18:46:05,213][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 18:46:07,236][root][INFO] - Step: 165/1035  |  Loss: 1.0443  |  Score: 72.30 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:07,401][root][INFO] - Step: 165/960  |  Loss: 1.0650  |  Score: 70.36 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:08,925][root][INFO] - Step: 14/105  |  Loss: 2.7988  |  Score: 16.63 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:09,490][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 18:46:09,490][root][INFO] - Score: 1.65 [%]  |  Evaluation Time: 0.56 [s]
[2024-09-26 18:46:10,010][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 18:46:10,010][root][INFO] - Score: 4.59 [%]  |  Evaluation Time: 0.52 [s]
[2024-09-26 18:46:10,011][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 18:46:10,012][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 18:46:10,893][root][INFO] - Step: 15/105  |  Loss: 2.4317  |  Score: 25.30 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:12,958][root][INFO] - Step: 180/1035  |  Loss: 1.0556  |  Score: 72.01 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:12,978][root][INFO] - Step: 180/960  |  Loss: 1.0930  |  Score: 70.61 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:13,504][root][INFO] - Step: 21/105  |  Loss: 2.4729  |  Score: 30.74 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:14,071][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 18:46:14,071][root][INFO] - Score: 19.24 [%]  |  Evaluation Time: 0.56 [s]
[2024-09-26 18:46:14,567][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 18:46:14,568][root][INFO] - Score: 8.82 [%]  |  Evaluation Time: 0.49 [s]
[2024-09-26 18:46:14,569][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 18:46:14,570][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 18:46:17,533][root][INFO] - Step: 192/960  |  Loss: 1.1802  |  Score: 69.90 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:18,286][root][INFO] - Step: 28/105  |  Loss: 1.9696  |  Score: 48.20 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:18,688][root][INFO] - Step: 195/1035  |  Loss: 1.2044  |  Score: 70.78 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:18,848][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 18:46:18,848][root][INFO] - Score: 19.44 [%]  |  Evaluation Time: 0.56 [s]
[2024-09-26 18:46:19,361][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 18:46:19,362][root][INFO] - Score: 11.98 [%]  |  Evaluation Time: 0.51 [s]
[2024-09-26 18:46:19,362][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-26 18:46:19,364][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 18:46:20,510][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 18:46:20,510][root][INFO] - Score: 73.10 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-26 18:46:20,750][root][INFO] - Step: 30/105  |  Loss: 1.5686  |  Score: 56.27 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:23,006][root][INFO] - Step: 35/105  |  Loss: 1.5425  |  Score: 59.92 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:23,326][root][INFO] - Step: 207/1035  |  Loss: 1.0119  |  Score: 70.82 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:23,477][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 18:46:23,477][root][INFO] - Score: 68.79 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-26 18:46:23,479][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 18:46:23,603][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 18:46:23,604][root][INFO] - Score: 32.62 [%]  |  Evaluation Time: 0.59 [s]
[2024-09-26 18:46:24,116][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 18:46:24,117][root][INFO] - Score: 19.09 [%]  |  Evaluation Time: 0.51 [s]
[2024-09-26 18:46:24,117][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 18:46:24,118][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 18:46:25,030][root][INFO] - Step: 195/960  |  Loss: 0.9357  |  Score: 76.49 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:26,612][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 18:46:26,612][root][INFO] - Score: 77.68 [%]  |  Evaluation Time: 3.28 [s]
[2024-09-26 18:46:27,758][root][INFO] - Step: 42/105  |  Loss: 1.2697  |  Score: 68.58 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:28,317][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 18:46:28,317][root][INFO] - Score: 33.11 [%]  |  Evaluation Time: 0.56 [s]
[2024-09-26 18:46:28,843][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 18:46:28,843][root][INFO] - Score: 24.59 [%]  |  Evaluation Time: 0.52 [s]
[2024-09-26 18:46:28,844][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 18:46:28,845][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 18:46:29,713][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 18:46:29,714][root][INFO] - Score: 69.24 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-26 18:46:29,715][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 18:46:29,716][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 18:46:30,600][root][INFO] - Step: 210/960  |  Loss: 0.9256  |  Score: 75.83 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:30,824][root][INFO] - Step: 45/105  |  Loss: 1.3163  |  Score: 67.03 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:31,186][root][INFO] - Step: 210/1035  |  Loss: 1.0744  |  Score: 69.67 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:32,579][root][INFO] - Step: 49/105  |  Loss: 1.0308  |  Score: 76.43 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:33,142][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 18:46:33,142][root][INFO] - Score: 42.57 [%]  |  Evaluation Time: 0.56 [s]
[2024-09-26 18:46:33,646][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 18:46:33,646][root][INFO] - Score: 29.53 [%]  |  Evaluation Time: 0.50 [s]
[2024-09-26 18:46:33,647][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-26 18:46:33,649][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 18:46:36,166][root][INFO] - Step: 225/960  |  Loss: 0.9693  |  Score: 75.37 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:36,944][root][INFO] - Step: 225/1035  |  Loss: 0.9189  |  Score: 75.95 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:37,192][root][INFO] - Step: 56/105  |  Loss: 0.8798  |  Score: 78.22 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:37,802][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 18:46:37,803][root][INFO] - Score: 44.83 [%]  |  Evaluation Time: 0.61 [s]
[2024-09-26 18:46:38,343][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 18:46:38,343][root][INFO] - Score: 31.74 [%]  |  Evaluation Time: 0.54 [s]
[2024-09-26 18:46:38,344][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-26 18:46:38,345][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 18:46:40,693][root][INFO] - Step: 60/105  |  Loss: 0.8011  |  Score: 83.25 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:41,739][root][INFO] - Step: 240/960  |  Loss: 1.0091  |  Score: 73.43 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:41,951][root][INFO] - Step: 63/105  |  Loss: 0.7272  |  Score: 82.80 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:42,534][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 18:46:42,535][root][INFO] - Score: 48.26 [%]  |  Evaluation Time: 0.58 [s]
[2024-09-26 18:46:42,723][root][INFO] - Step: 240/1035  |  Loss: 0.8683  |  Score: 75.81 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:43,062][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 18:46:43,062][root][INFO] - Score: 34.06 [%]  |  Evaluation Time: 0.53 [s]
[2024-09-26 18:46:43,063][root][INFO] - 
Save new Best Score (Epoch: 9)
[2024-09-26 18:46:43,065][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 18:46:46,769][root][INFO] - Step: 70/105  |  Loss: 0.6515  |  Score: 85.48 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:47,308][root][INFO] - Step: 255/960  |  Loss: 0.9563  |  Score: 73.23 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:47,318][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 18:46:47,318][root][INFO] - Score: 49.11 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-26 18:46:47,748][root][INFO] - Step: 256/960  |  Loss: 0.8809  |  Score: 72.32 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:47,836][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 18:46:47,837][root][INFO] - Score: 34.46 [%]  |  Evaluation Time: 0.52 [s]
[2024-09-26 18:46:47,838][root][INFO] - 
Save new Best Score (Epoch: 10)
[2024-09-26 18:46:47,839][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 18:46:48,485][root][INFO] - Step: 255/1035  |  Loss: 1.0046  |  Score: 73.87 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:50,709][root][INFO] - Step: 75/105  |  Loss: 0.5578  |  Score: 87.52 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:50,711][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 18:46:50,711][root][INFO] - Score: 78.48 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-26 18:46:51,459][root][INFO] - Step: 77/105  |  Loss: 0.6099  |  Score: 83.07 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:52,018][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 18:46:52,018][root][INFO] - Score: 51.45 [%]  |  Evaluation Time: 0.56 [s]
[2024-09-26 18:46:52,556][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 18:46:52,557][root][INFO] - Score: 34.10 [%]  |  Evaluation Time: 0.54 [s]
[2024-09-26 18:46:52,558][root][INFO] - 
Save new Best Score (Epoch: 11)
[2024-09-26 18:46:52,559][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 18:46:53,574][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 18:46:53,574][root][INFO] - Score: 70.83 [%]  |  Evaluation Time: 2.86 [s]
[2024-09-26 18:46:53,576][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-26 18:46:53,577][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 18:46:54,244][root][INFO] - Step: 270/1035  |  Loss: 0.9021  |  Score: 75.73 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:56,185][root][INFO] - Step: 84/105  |  Loss: 0.5482  |  Score: 86.47 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:56,593][root][INFO] - Step: 276/1035  |  Loss: 0.9975  |  Score: 67.36 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:56,765][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 18:46:56,765][root][INFO] - Score: 50.74 [%]  |  Evaluation Time: 0.58 [s]
[2024-09-26 18:46:57,292][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 18:46:57,293][root][INFO] - Score: 34.79 [%]  |  Evaluation Time: 0.53 [s]
[2024-09-26 18:46:57,295][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 18:46:59,177][root][INFO] - Step: 270/960  |  Loss: 0.7967  |  Score: 76.87 [%]  |  Seq Length: 256.0
[2024-09-26 18:46:59,908][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 18:46:59,909][root][INFO] - Score: 77.50 [%]  |  Evaluation Time: 3.31 [s]
[2024-09-26 18:47:00,606][root][INFO] - Step: 90/105  |  Loss: 0.5294  |  Score: 87.94 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:00,895][root][INFO] - Step: 91/105  |  Loss: 0.1926  |  Score: 91.51 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:01,459][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 18:47:01,459][root][INFO] - Score: 49.68 [%]  |  Evaluation Time: 0.56 [s]
[2024-09-26 18:47:01,961][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 18:47:01,961][root][INFO] - Score: 35.19 [%]  |  Evaluation Time: 0.50 [s]
[2024-09-26 18:47:01,964][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 18:47:02,927][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 18:47:02,928][root][INFO] - Score: 70.09 [%]  |  Evaluation Time: 3.02 [s]
[2024-09-26 18:47:02,929][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-26 18:47:02,932][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 18:47:04,756][root][INFO] - Step: 285/960  |  Loss: 0.8600  |  Score: 77.59 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:05,687][root][INFO] - Step: 98/105  |  Loss: 0.5661  |  Score: 87.33 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:06,235][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 18:47:06,235][root][INFO] - Score: 49.45 [%]  |  Evaluation Time: 0.54 [s]
[2024-09-26 18:47:06,762][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 18:47:06,762][root][INFO] - Score: 35.51 [%]  |  Evaluation Time: 0.53 [s]
[2024-09-26 18:47:06,765][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 18:47:06,776][root][INFO] - Step: 285/1035  |  Loss: 0.8253  |  Score: 79.03 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:10,340][root][INFO] - Step: 300/960  |  Loss: 0.8252  |  Score: 80.20 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:10,352][root][INFO] - Step: 105/105  |  Loss: 0.5620  |  Score: 88.42 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:10,921][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 18:47:10,922][root][INFO] - Score: 49.59 [%]  |  Evaluation Time: 0.57 [s]
[2024-09-26 18:47:11,450][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 18:47:11,450][root][INFO] - Score: 35.29 [%]  |  Evaluation Time: 0.53 [s]
[2024-09-26 18:47:11,451][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 18:47:11,451][root][INFO] - - Epoch: 11
[2024-09-26 18:47:11,451][root][INFO] - - DEV score: 51.45 [%]
[2024-09-26 18:47:11,451][root][INFO] - - TEST score: 34.10 [%]
[2024-09-26 18:47:11,452][root][INFO] - Fine-tuning is done!
[2024-09-26 18:47:12,509][root][INFO] - Step: 300/1035  |  Loss: 0.8934  |  Score: 77.59 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:15,923][root][INFO] - Step: 315/960  |  Loss: 0.8432  |  Score: 80.50 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:17,763][root][INFO] - 

[2024-09-26 18:47:17,763][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 18:47:17,764][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:47:17,764][root][INFO] - 

[2024-09-26 18:47:17,764][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko', 'do_hangeulize': True, 'data_remove': False, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 18:47:17,832][root][INFO] - Step: 320/960  |  Loss: 0.6968  |  Score: 81.26 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:18,244][root][INFO] - Step: 315/1035  |  Loss: 0.8234  |  Score: 77.08 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:20,742][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 18:47:20,742][root][INFO] - Score: 78.17 [%]  |  Evaluation Time: 2.91 [s]
[2024-09-26 18:47:22,668][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 18:47:22,669][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 18:47:22,670][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 18:47:22,670][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 18:47:22,670][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 18:47:22,671][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 18:47:22,671][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 18:47:22,672][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 18:47:22,672][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 18:47:22,673][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 18:47:22,673][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 18:47:22,674][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 18:47:22,674][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 18:47:22,674][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 18:47:22,675][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 18:47:22,675][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 18:47:22,676][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 18:47:22,676][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 18:47:22,677][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 18:47:22,677][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 18:47:22,678][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 18:47:22,678][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 18:47:22,678][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 18:47:22,679][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 18:47:22,680][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 18:47:23,079][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 18:47:23,648][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 18:47:23,648][root][INFO] - Score: 71.15 [%]  |  Evaluation Time: 2.90 [s]
[2024-09-26 18:47:23,650][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 18:47:23,651][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 18:47:23,970][root][INFO] - Step: 330/1035  |  Loss: 0.7648  |  Score: 78.42 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:27,085][root][INFO] - 

[2024-09-26 18:47:27,085][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 18:47:27,085][root][INFO] - Data Preprocessing
[2024-09-26 18:47:27,086][root][INFO] - ㄴ remain_lang                ko
[2024-09-26 18:47:27,086][root][INFO] - ㄴ do_hangeulize              True
[2024-09-26 18:47:27,086][root][INFO] - ㄴ data_remove                False

[2024-09-26 18:47:27,086][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 18:47:27,096][root][INFO] - vocab size              : 51200
[2024-09-26 18:47:27,096][root][INFO] - device                  : gpu
[2024-09-26 18:47:27,096][root][INFO] - random seed             : 42
[2024-09-26 18:47:27,096][root][INFO] - train data size         : 5760
[2024-09-26 18:47:27,096][root][INFO] - max epochs              : 15
[2024-09-26 18:47:27,096][root][INFO] - total steps             : 1350
[2024-09-26 18:47:27,096][root][INFO] - warmup steps            : 135
[2024-09-26 18:47:27,096][root][INFO] - batch size              : 64
[2024-09-26 18:47:27,097][root][INFO] - accumulation steps      : 1
[2024-09-26 18:47:27,097][root][INFO] - optimizer               : adamwscale
[2024-09-26 18:47:27,097][root][INFO] - lr_scheduler            : cosine
[2024-09-26 18:47:27,097][root][INFO] - learning rate           : 0.01
[2024-09-26 18:47:27,097][root][INFO] - max length              : 256

[2024-09-26 18:47:27,097][root][INFO] - LoRA Configuration
[2024-09-26 18:47:27,097][root][INFO] - ㄴ r                    : 32
[2024-09-26 18:47:27,097][root][INFO] - ㄴ alpha                : 128
[2024-09-26 18:47:27,097][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 18:47:27,097][root][INFO] - 

[2024-09-26 18:47:27,097][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:47:27,097][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 18:47:27,098][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 18:47:27,098][root][INFO] - * tb interval   : 15

[2024-09-26 18:47:27,098][root][INFO] - 

[2024-09-26 18:47:27,098][root][INFO] - Start the Training !
[2024-09-26 18:47:27,101][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 18:47:27,783][root][INFO] - Step: 330/960  |  Loss: 0.7357  |  Score: 80.33 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:29,743][root][INFO] - Step: 345/1035  |  Loss: 0.9360  |  Score: 74.90 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:32,893][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 18:47:32,893][root][INFO] - Score: 76.57 [%]  |  Evaluation Time: 3.15 [s]
[2024-09-26 18:47:33,370][root][INFO] - Step: 345/960  |  Loss: 0.7053  |  Score: 81.72 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:35,614][root][INFO] - Step: 15/1350  |  Loss: 3.6309  |  Score: 0.81 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:35,974][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 18:47:35,975][root][INFO] - Score: 70.48 [%]  |  Evaluation Time: 3.08 [s]
[2024-09-26 18:47:35,977][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 18:47:36,818][root][INFO] - Step: 346/1035  |  Loss: 0.7622  |  Score: 78.76 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:38,948][root][INFO] - Step: 360/960  |  Loss: 0.7415  |  Score: 80.13 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:41,122][root][INFO] - Step: 30/1350  |  Loss: 2.2845  |  Score: 12.59 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:42,167][root][INFO] - Step: 360/1035  |  Loss: 0.7149  |  Score: 80.53 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:44,527][root][INFO] - Step: 375/960  |  Loss: 0.7196  |  Score: 80.91 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:46,630][root][INFO] - Step: 45/1350  |  Loss: 2.0803  |  Score: 30.16 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:47,903][root][INFO] - Step: 375/1035  |  Loss: 0.6979  |  Score: 82.91 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:47,927][root][INFO] - Step: 384/960  |  Loss: 0.6828  |  Score: 83.88 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:50,919][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 18:47:50,919][root][INFO] - Score: 77.90 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-26 18:47:52,137][root][INFO] - Step: 60/1350  |  Loss: 1.9855  |  Score: 39.01 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:53,638][root][INFO] - Step: 390/1035  |  Loss: 0.7403  |  Score: 79.27 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:53,835][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 18:47:53,835][root][INFO] - Score: 71.83 [%]  |  Evaluation Time: 2.91 [s]
[2024-09-26 18:47:53,837][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 18:47:53,838][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 18:47:56,510][root][INFO] - Step: 390/960  |  Loss: 0.5743  |  Score: 83.08 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:57,649][root][INFO] - Step: 75/1350  |  Loss: 1.5942  |  Score: 56.79 [%]  |  Seq Length: 256.0
[2024-09-26 18:47:59,368][root][INFO] - Step: 405/1035  |  Loss: 0.6694  |  Score: 79.43 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:02,094][root][INFO] - Step: 405/960  |  Loss: 0.6534  |  Score: 81.69 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:02,865][root][INFO] - Step: 414/1035  |  Loss: 0.6930  |  Score: 81.45 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:03,180][root][INFO] - Step: 90/1350  |  Loss: 1.4760  |  Score: 53.31 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:05,961][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 18:48:05,961][root][INFO] - Score: 77.96 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-26 18:48:07,075][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 18:48:07,075][root][INFO] - Score: 71.12 [%]  |  Evaluation Time: 3.89 [s]
[2024-09-26 18:48:07,677][root][INFO] - Step: 420/960  |  Loss: 0.6482  |  Score: 84.15 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:08,947][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 18:48:08,947][root][INFO] - Score: 71.93 [%]  |  Evaluation Time: 2.98 [s]
[2024-09-26 18:48:08,948][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 18:48:08,950][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 18:48:10,799][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 18:48:10,799][root][INFO] - Score: 63.76 [%]  |  Evaluation Time: 3.72 [s]
[2024-09-26 18:48:10,800][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 18:48:10,801][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 18:48:11,544][root][INFO] - Step: 91/1350  |  Loss: 1.6897  |  Score: 50.19 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:11,569][root][INFO] - Step: 420/1035  |  Loss: 0.5806  |  Score: 83.52 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:13,257][root][INFO] - Step: 435/960  |  Loss: 0.6794  |  Score: 83.57 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:16,706][root][INFO] - Step: 105/1350  |  Loss: 1.2771  |  Score: 60.79 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:17,294][root][INFO] - Step: 435/1035  |  Loss: 0.5785  |  Score: 85.11 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:18,131][root][INFO] - Step: 448/960  |  Loss: 0.6761  |  Score: 81.52 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:21,036][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 18:48:21,036][root][INFO] - Score: 78.39 [%]  |  Evaluation Time: 2.90 [s]
[2024-09-26 18:48:22,236][root][INFO] - Step: 120/1350  |  Loss: 1.3038  |  Score: 58.93 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:23,030][root][INFO] - Step: 450/1035  |  Loss: 0.6901  |  Score: 81.37 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:23,974][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 18:48:23,975][root][INFO] - Score: 71.52 [%]  |  Evaluation Time: 2.94 [s]
[2024-09-26 18:48:23,976][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-26 18:48:23,977][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 18:48:25,145][root][INFO] - Step: 450/960  |  Loss: 0.6189  |  Score: 84.84 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:27,766][root][INFO] - Step: 135/1350  |  Loss: 1.3654  |  Score: 61.15 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:28,757][root][INFO] - Step: 465/1035  |  Loss: 0.7268  |  Score: 82.57 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:30,772][root][INFO] - Step: 465/960  |  Loss: 0.5304  |  Score: 85.24 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:33,300][root][INFO] - Step: 150/1350  |  Loss: 1.2398  |  Score: 67.61 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:34,475][root][INFO] - Step: 480/1035  |  Loss: 0.6923  |  Score: 80.86 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:35,676][root][INFO] - Step: 483/1035  |  Loss: 0.6940  |  Score: 81.25 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:36,403][root][INFO] - Step: 480/960  |  Loss: 0.5722  |  Score: 84.96 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:38,835][root][INFO] - Step: 165/1350  |  Loss: 1.1477  |  Score: 62.69 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:38,840][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 18:48:38,840][root][INFO] - Score: 77.96 [%]  |  Evaluation Time: 3.16 [s]
[2024-09-26 18:48:41,865][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 18:48:41,865][root][INFO] - Score: 70.73 [%]  |  Evaluation Time: 3.02 [s]
[2024-09-26 18:48:41,867][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 18:48:42,044][root][INFO] - Step: 495/960  |  Loss: 0.5840  |  Score: 84.39 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:44,428][root][INFO] - Step: 180/1350  |  Loss: 1.1647  |  Score: 62.95 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:46,796][root][INFO] - Step: 495/1035  |  Loss: 0.5298  |  Score: 84.19 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:47,679][root][INFO] - Step: 510/960  |  Loss: 0.5741  |  Score: 86.44 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:48,471][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 18:48:48,472][root][INFO] - Score: 76.31 [%]  |  Evaluation Time: 4.04 [s]
[2024-09-26 18:48:48,487][root][INFO] - Step: 512/960  |  Loss: 0.5352  |  Score: 82.81 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:51,569][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 18:48:51,569][root][INFO] - Score: 78.56 [%]  |  Evaluation Time: 3.08 [s]
[2024-09-26 18:48:52,201][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 18:48:52,201][root][INFO] - Score: 67.29 [%]  |  Evaluation Time: 3.73 [s]
[2024-09-26 18:48:52,202][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 18:48:52,203][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 18:48:52,527][root][INFO] - Step: 510/1035  |  Loss: 0.5620  |  Score: 84.98 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:52,933][root][INFO] - Step: 181/1350  |  Loss: 0.9823  |  Score: 66.56 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:54,548][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 18:48:54,548][root][INFO] - Score: 71.10 [%]  |  Evaluation Time: 2.98 [s]
[2024-09-26 18:48:54,551][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 18:48:58,107][root][INFO] - Step: 195/1350  |  Loss: 1.0976  |  Score: 67.08 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:58,259][root][INFO] - Step: 525/1035  |  Loss: 0.6064  |  Score: 83.34 [%]  |  Seq Length: 256.0
[2024-09-26 18:48:59,801][root][INFO] - Step: 525/960  |  Loss: 0.4759  |  Score: 88.02 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:03,648][root][INFO] - Step: 210/1350  |  Loss: 1.0825  |  Score: 68.61 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:03,988][root][INFO] - Step: 540/1035  |  Loss: 0.5484  |  Score: 85.29 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:05,389][root][INFO] - Step: 540/960  |  Loss: 0.4988  |  Score: 86.64 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:08,602][root][INFO] - Step: 552/1035  |  Loss: 0.5562  |  Score: 84.19 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:09,188][root][INFO] - Step: 225/1350  |  Loss: 1.1633  |  Score: 69.36 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:10,976][root][INFO] - Step: 555/960  |  Loss: 0.5106  |  Score: 86.21 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:11,716][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 18:49:11,716][root][INFO] - Score: 77.68 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-26 18:49:14,729][root][INFO] - Step: 240/1350  |  Loss: 1.1194  |  Score: 68.63 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:14,891][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 18:49:14,891][root][INFO] - Score: 71.51 [%]  |  Evaluation Time: 3.17 [s]
[2024-09-26 18:49:14,893][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 18:49:16,377][root][INFO] - Step: 555/1035  |  Loss: 0.5178  |  Score: 84.05 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:16,562][root][INFO] - Step: 570/960  |  Loss: 0.5042  |  Score: 87.08 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:18,844][root][INFO] - Step: 576/960  |  Loss: 0.4521  |  Score: 86.39 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:20,276][root][INFO] - Step: 255/1350  |  Loss: 1.0066  |  Score: 69.15 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:21,760][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 18:49:21,761][root][INFO] - Score: 76.93 [%]  |  Evaluation Time: 2.91 [s]
[2024-09-26 18:49:22,102][root][INFO] - Step: 570/1035  |  Loss: 0.4731  |  Score: 86.18 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:24,627][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 18:49:24,627][root][INFO] - Score: 70.58 [%]  |  Evaluation Time: 2.86 [s]
[2024-09-26 18:49:24,629][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 18:49:25,880][root][INFO] - Step: 270/1350  |  Loss: 1.0761  |  Score: 70.29 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:27,828][root][INFO] - Step: 585/1035  |  Loss: 0.4880  |  Score: 87.07 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:28,403][root][INFO] - Step: 585/960  |  Loss: 0.4546  |  Score: 86.78 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:29,708][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 18:49:29,708][root][INFO] - Score: 75.60 [%]  |  Evaluation Time: 3.82 [s]
[2024-09-26 18:49:33,304][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 18:49:33,305][root][INFO] - Score: 67.89 [%]  |  Evaluation Time: 3.59 [s]
[2024-09-26 18:49:33,309][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 18:49:33,565][root][INFO] - Step: 600/1035  |  Loss: 0.5069  |  Score: 85.71 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:34,005][root][INFO] - Step: 600/960  |  Loss: 0.4242  |  Score: 88.25 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:34,072][root][INFO] - Step: 271/1350  |  Loss: 1.0072  |  Score: 61.58 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:39,269][root][INFO] - Step: 285/1350  |  Loss: 0.9370  |  Score: 72.45 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:39,297][root][INFO] - Step: 615/1035  |  Loss: 0.5021  |  Score: 86.20 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:39,603][root][INFO] - Step: 615/960  |  Loss: 0.4534  |  Score: 88.42 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:41,632][root][INFO] - Step: 621/1035  |  Loss: 0.4864  |  Score: 86.00 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:44,783][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 18:49:44,783][root][INFO] - Score: 77.53 [%]  |  Evaluation Time: 3.15 [s]
[2024-09-26 18:49:44,818][root][INFO] - Step: 300/1350  |  Loss: 0.9142  |  Score: 74.94 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:45,189][root][INFO] - Step: 630/960  |  Loss: 0.4097  |  Score: 89.52 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:47,975][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 18:49:47,975][root][INFO] - Score: 71.23 [%]  |  Evaluation Time: 3.19 [s]
[2024-09-26 18:49:47,977][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 18:49:48,949][root][INFO] - Step: 640/960  |  Loss: 0.5117  |  Score: 85.68 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:50,366][root][INFO] - Step: 315/1350  |  Loss: 1.1009  |  Score: 73.08 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:51,755][root][INFO] - Step: 630/1035  |  Loss: 0.4179  |  Score: 87.96 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:51,874][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 18:49:51,874][root][INFO] - Score: 76.97 [%]  |  Evaluation Time: 2.92 [s]
[2024-09-26 18:49:54,874][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 18:49:54,874][root][INFO] - Score: 71.34 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-26 18:49:54,877][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 18:49:55,914][root][INFO] - Step: 330/1350  |  Loss: 0.9780  |  Score: 70.61 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:57,139][root][INFO] - Step: 645/960  |  Loss: 0.4038  |  Score: 89.18 [%]  |  Seq Length: 256.0
[2024-09-26 18:49:57,481][root][INFO] - Step: 645/1035  |  Loss: 0.4993  |  Score: 87.00 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:01,459][root][INFO] - Step: 345/1350  |  Loss: 0.9299  |  Score: 72.13 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:02,732][root][INFO] - Step: 660/960  |  Loss: 0.4201  |  Score: 89.98 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:03,203][root][INFO] - Step: 660/1035  |  Loss: 0.4187  |  Score: 87.72 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:07,043][root][INFO] - Step: 360/1350  |  Loss: 0.8542  |  Score: 74.80 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:08,320][root][INFO] - Step: 675/960  |  Loss: 0.4360  |  Score: 89.01 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:08,928][root][INFO] - Step: 675/1035  |  Loss: 0.5031  |  Score: 86.26 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:11,062][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 18:50:11,062][root][INFO] - Score: 77.09 [%]  |  Evaluation Time: 4.02 [s]
[2024-09-26 18:50:13,903][root][INFO] - Step: 690/960  |  Loss: 0.4248  |  Score: 88.74 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:14,678][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 18:50:14,679][root][INFO] - Score: 70.46 [%]  |  Evaluation Time: 3.61 [s]
[2024-09-26 18:50:14,679][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-26 18:50:14,681][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 18:50:14,707][root][INFO] - Step: 690/1035  |  Loss: 0.5282  |  Score: 86.61 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:15,384][root][INFO] - Step: 361/1350  |  Loss: 0.8027  |  Score: 74.67 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:17,841][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 18:50:17,841][root][INFO] - Score: 76.74 [%]  |  Evaluation Time: 3.13 [s]
[2024-09-26 18:50:19,161][root][INFO] - Step: 704/960  |  Loss: 0.4527  |  Score: 87.66 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:20,549][root][INFO] - Step: 375/1350  |  Loss: 0.8274  |  Score: 75.04 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:20,878][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 18:50:20,878][root][INFO] - Score: 70.56 [%]  |  Evaluation Time: 3.03 [s]
[2024-09-26 18:50:20,880][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 18:50:21,768][root][INFO] - Step: 691/1035  |  Loss: 0.5624  |  Score: 81.59 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:22,082][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 18:50:22,083][root][INFO] - Score: 76.50 [%]  |  Evaluation Time: 2.92 [s]
[2024-09-26 18:50:25,003][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 18:50:25,003][root][INFO] - Score: 70.90 [%]  |  Evaluation Time: 2.92 [s]
[2024-09-26 18:50:25,005][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 18:50:25,798][root][INFO] - Step: 705/960  |  Loss: 0.3051  |  Score: 92.69 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:26,101][root][INFO] - Step: 390/1350  |  Loss: 0.8612  |  Score: 75.12 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:27,114][root][INFO] - Step: 705/1035  |  Loss: 0.4131  |  Score: 89.01 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:31,384][root][INFO] - Step: 720/960  |  Loss: 0.4155  |  Score: 88.32 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:31,634][root][INFO] - Step: 405/1350  |  Loss: 0.8296  |  Score: 72.90 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:32,851][root][INFO] - Step: 720/1035  |  Loss: 0.4177  |  Score: 86.98 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:36,972][root][INFO] - Step: 735/960  |  Loss: 0.3763  |  Score: 88.91 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:37,166][root][INFO] - Step: 420/1350  |  Loss: 0.9384  |  Score: 77.38 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:38,581][root][INFO] - Step: 735/1035  |  Loss: 0.4474  |  Score: 87.23 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:42,554][root][INFO] - Step: 750/960  |  Loss: 0.3556  |  Score: 90.71 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:42,702][root][INFO] - Step: 435/1350  |  Loss: 0.7664  |  Score: 77.50 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:44,310][root][INFO] - Step: 750/1035  |  Loss: 0.4256  |  Score: 88.46 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:47,804][root][INFO] - Step: 759/1035  |  Loss: 0.4049  |  Score: 89.29 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:48,134][root][INFO] - Step: 765/960  |  Loss: 0.3856  |  Score: 88.80 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:48,342][root][INFO] - Step: 450/1350  |  Loss: 0.8761  |  Score: 74.83 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:49,302][root][INFO] - Step: 768/960  |  Loss: 0.3687  |  Score: 92.24 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:50,983][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 18:50:50,983][root][INFO] - Score: 77.36 [%]  |  Evaluation Time: 3.18 [s]
[2024-09-26 18:50:52,191][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 18:50:52,191][root][INFO] - Score: 78.34 [%]  |  Evaluation Time: 3.84 [s]
[2024-09-26 18:50:52,305][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 18:50:52,306][root][INFO] - Score: 72.74 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-26 18:50:53,982][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 18:50:53,983][root][INFO] - Score: 70.58 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-26 18:50:53,985][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 18:50:55,217][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 18:50:55,217][root][INFO] - Score: 70.20 [%]  |  Evaluation Time: 2.91 [s]
[2024-09-26 18:50:55,220][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 18:50:55,841][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 18:50:55,841][root][INFO] - Score: 69.71 [%]  |  Evaluation Time: 3.65 [s]
[2024-09-26 18:50:55,842][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 18:50:55,843][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 18:50:56,606][root][INFO] - Step: 451/1350  |  Loss: 0.7223  |  Score: 80.62 [%]  |  Seq Length: 256.0
[2024-09-26 18:50:56,672][root][INFO] - Step: 765/1035  |  Loss: 0.3910  |  Score: 87.85 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:00,088][root][INFO] - Step: 780/960  |  Loss: 0.3608  |  Score: 90.07 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:01,792][root][INFO] - Step: 465/1350  |  Loss: 0.6832  |  Score: 78.65 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:02,440][root][INFO] - Step: 780/1035  |  Loss: 0.3618  |  Score: 89.82 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:05,674][root][INFO] - Step: 795/960  |  Loss: 0.3740  |  Score: 90.61 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:07,341][root][INFO] - Step: 480/1350  |  Loss: 0.7386  |  Score: 78.14 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:08,168][root][INFO] - Step: 795/1035  |  Loss: 0.3725  |  Score: 89.99 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:11,255][root][INFO] - Step: 810/960  |  Loss: 0.3559  |  Score: 90.16 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:12,894][root][INFO] - Step: 495/1350  |  Loss: 0.7966  |  Score: 76.89 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:13,896][root][INFO] - Step: 810/1035  |  Loss: 0.4104  |  Score: 89.21 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:16,837][root][INFO] - Step: 825/960  |  Loss: 0.3662  |  Score: 90.21 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:18,453][root][INFO] - Step: 510/1350  |  Loss: 0.7593  |  Score: 78.17 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:19,507][root][INFO] - Step: 832/960  |  Loss: 0.3831  |  Score: 87.85 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:19,621][root][INFO] - Step: 825/1035  |  Loss: 0.4208  |  Score: 88.11 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:20,822][root][INFO] - Step: 828/1035  |  Loss: 0.3871  |  Score: 89.16 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:22,524][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 18:51:22,525][root][INFO] - Score: 77.41 [%]  |  Evaluation Time: 3.01 [s]
[2024-09-26 18:51:23,943][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 18:51:23,944][root][INFO] - Score: 77.34 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-26 18:51:24,005][root][INFO] - Step: 525/1350  |  Loss: 0.7539  |  Score: 77.79 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:25,477][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 18:51:25,478][root][INFO] - Score: 70.28 [%]  |  Evaluation Time: 2.95 [s]
[2024-09-26 18:51:25,480][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 18:51:27,016][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 18:51:27,016][root][INFO] - Score: 70.78 [%]  |  Evaluation Time: 3.07 [s]
[2024-09-26 18:51:27,018][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 18:51:28,900][root][INFO] - Step: 840/960  |  Loss: 0.3299  |  Score: 91.50 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:29,590][root][INFO] - Step: 540/1350  |  Loss: 0.7554  |  Score: 80.34 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:32,001][root][INFO] - Step: 840/1035  |  Loss: 0.3849  |  Score: 89.43 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:33,428][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 18:51:33,428][root][INFO] - Score: 76.80 [%]  |  Evaluation Time: 3.83 [s]
[2024-09-26 18:51:34,482][root][INFO] - Step: 855/960  |  Loss: 0.3506  |  Score: 90.54 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:37,027][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 18:51:37,027][root][INFO] - Score: 68.74 [%]  |  Evaluation Time: 3.60 [s]
[2024-09-26 18:51:37,029][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 18:51:37,724][root][INFO] - Step: 855/1035  |  Loss: 0.3909  |  Score: 88.97 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:37,733][root][INFO] - Step: 541/1350  |  Loss: 0.7287  |  Score: 83.83 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:40,063][root][INFO] - Step: 870/960  |  Loss: 0.3688  |  Score: 89.45 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:42,893][root][INFO] - Step: 555/1350  |  Loss: 0.5719  |  Score: 82.81 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:43,448][root][INFO] - Step: 870/1035  |  Loss: 0.3805  |  Score: 88.97 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:45,647][root][INFO] - Step: 885/960  |  Loss: 0.3526  |  Score: 89.98 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:48,428][root][INFO] - Step: 570/1350  |  Loss: 0.6226  |  Score: 80.52 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:49,169][root][INFO] - Step: 885/1035  |  Loss: 0.3627  |  Score: 89.37 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:49,784][root][INFO] - Step: 896/960  |  Loss: 0.4046  |  Score: 89.24 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:52,789][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 18:51:52,790][root][INFO] - Score: 76.89 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-26 18:51:53,792][root][INFO] - Step: 897/1035  |  Loss: 0.3698  |  Score: 89.62 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:53,969][root][INFO] - Step: 585/1350  |  Loss: 0.5940  |  Score: 80.52 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:55,737][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 18:51:55,737][root][INFO] - Score: 70.71 [%]  |  Evaluation Time: 2.94 [s]
[2024-09-26 18:51:55,739][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 18:51:56,923][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 18:51:56,924][root][INFO] - Score: 77.09 [%]  |  Evaluation Time: 3.13 [s]
[2024-09-26 18:51:57,651][root][INFO] - Step: 900/960  |  Loss: 0.3693  |  Score: 90.47 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:59,515][root][INFO] - Step: 600/1350  |  Loss: 0.6286  |  Score: 81.67 [%]  |  Seq Length: 256.0
[2024-09-26 18:51:59,974][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 18:51:59,974][root][INFO] - Score: 70.48 [%]  |  Evaluation Time: 3.05 [s]
[2024-09-26 18:51:59,976][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 18:52:01,524][root][INFO] - Step: 900/1035  |  Loss: 0.3377  |  Score: 86.81 [%]  |  Seq Length: 256.0
[2024-09-26 18:52:03,249][root][INFO] - Step: 915/960  |  Loss: 0.3512  |  Score: 90.42 [%]  |  Seq Length: 256.0
[2024-09-26 18:52:05,051][root][INFO] - Step: 615/1350  |  Loss: 0.6838  |  Score: 81.71 [%]  |  Seq Length: 256.0
[2024-09-26 18:52:07,249][root][INFO] - Step: 915/1035  |  Loss: 0.3861  |  Score: 88.65 [%]  |  Seq Length: 256.0
[2024-09-26 18:52:08,829][root][INFO] - Step: 930/960  |  Loss: 0.3382  |  Score: 90.60 [%]  |  Seq Length: 256.0
[2024-09-26 18:52:10,641][root][INFO] - Step: 630/1350  |  Loss: 0.6169  |  Score: 82.85 [%]  |  Seq Length: 256.0
[2024-09-26 18:52:12,972][root][INFO] - Step: 930/1035  |  Loss: 0.3663  |  Score: 90.28 [%]  |  Seq Length: 256.0
[2024-09-26 18:52:14,408][root][INFO] - Step: 945/960  |  Loss: 0.3505  |  Score: 89.46 [%]  |  Seq Length: 256.0
[2024-09-26 18:52:14,479][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 18:52:14,479][root][INFO] - Score: 76.72 [%]  |  Evaluation Time: 3.83 [s]
[2024-09-26 18:52:18,053][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 18:52:18,053][root][INFO] - Score: 71.26 [%]  |  Evaluation Time: 3.57 [s]
[2024-09-26 18:52:18,056][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 18:52:18,722][root][INFO] - Step: 945/1035  |  Loss: 0.3826  |  Score: 89.38 [%]  |  Seq Length: 256.0
[2024-09-26 18:52:18,822][root][INFO] - Step: 631/1350  |  Loss: 0.6611  |  Score: 79.84 [%]  |  Seq Length: 256.0
[2024-09-26 18:52:20,026][root][INFO] - Step: 960/960  |  Loss: 0.3579  |  Score: 90.15 [%]  |  Seq Length: 256.0
[2024-09-26 18:52:22,987][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 18:52:22,987][root][INFO] - Score: 78.49 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-26 18:52:23,998][root][INFO] - Step: 645/1350  |  Loss: 0.5533  |  Score: 84.09 [%]  |  Seq Length: 256.0
[2024-09-26 18:52:24,493][root][INFO] - Step: 960/1035  |  Loss: 0.3328  |  Score: 90.49 [%]  |  Seq Length: 256.0
[2024-09-26 18:52:25,868][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 18:52:25,868][root][INFO] - Score: 70.99 [%]  |  Evaluation Time: 2.88 [s]
[2024-09-26 18:52:25,869][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 18:52:25,869][root][INFO] - - Epoch: 7
[2024-09-26 18:52:25,869][root][INFO] - - DEV score: 78.39 [%]
[2024-09-26 18:52:25,869][root][INFO] - - TEST score: 71.52 [%]
[2024-09-26 18:52:25,870][root][INFO] - Fine-tuning is done!
[2024-09-26 18:52:26,833][root][INFO] - Step: 966/1035  |  Loss: 0.3702  |  Score: 89.96 [%]  |  Seq Length: 256.0
[2024-09-26 18:52:29,552][root][INFO] - Step: 660/1350  |  Loss: 0.5824  |  Score: 83.38 [%]  |  Seq Length: 256.0
[2024-09-26 18:52:30,025][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 18:52:30,025][root][INFO] - Score: 76.72 [%]  |  Evaluation Time: 3.19 [s]
[2024-09-26 18:52:32,006][root][INFO] - 

[2024-09-26 18:52:32,006][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 18:52:32,006][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:52:32,006][root][INFO] - 

[2024-09-26 18:52:32,007][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 18:52:33,036][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 18:52:33,036][root][INFO] - Score: 70.90 [%]  |  Evaluation Time: 3.01 [s]
[2024-09-26 18:52:33,038][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 18:52:35,102][root][INFO] - Step: 675/1350  |  Loss: 0.6039  |  Score: 82.97 [%]  |  Seq Length: 256.0
[2024-09-26 18:52:36,330][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 18:52:36,330][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 18:52:36,331][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 18:52:36,331][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 18:52:36,332][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 18:52:36,332][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 18:52:36,333][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 18:52:36,333][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 18:52:36,334][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 18:52:36,334][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 18:52:36,335][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 18:52:36,335][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 18:52:36,336][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 18:52:36,336][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 18:52:36,337][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 18:52:36,337][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 18:52:36,338][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 18:52:36,338][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 18:52:36,339][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 18:52:36,339][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 18:52:36,340][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 18:52:36,340][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 18:52:36,341][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 18:52:36,341][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 18:52:36,343][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 18:52:36,347][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-26 18:52:36,453][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-26 18:52:36,455][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-26 18:52:36,769][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 18:52:36,796][root][INFO] - Step: 975/1035  |  Loss: 0.3575  |  Score: 89.69 [%]  |  Seq Length: 256.0
[2024-09-26 18:52:40,650][root][INFO] - Step: 690/1350  |  Loss: 0.5583  |  Score: 84.60 [%]  |  Seq Length: 256.0
[2024-09-26 18:52:42,524][root][INFO] - Step: 990/1035  |  Loss: 0.3298  |  Score: 91.45 [%]  |  Seq Length: 256.0
[2024-09-26 18:52:43,447][root][INFO] - 

[2024-09-26 18:52:43,448][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 18:52:43,448][root][INFO] - Data Preprocessing
[2024-09-26 18:52:43,448][root][INFO] - ㄴ remain_lang                ko_punc
[2024-09-26 18:52:43,448][root][INFO] - ㄴ do_hangeulize              True
[2024-09-26 18:52:43,448][root][INFO] - ㄴ data_remove                True

[2024-09-26 18:52:43,448][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 18:52:43,456][root][INFO] - vocab size              : 51200
[2024-09-26 18:52:43,456][root][INFO] - device                  : gpu
[2024-09-26 18:52:43,456][root][INFO] - random seed             : 42
[2024-09-26 18:52:43,456][root][INFO] - train data size         : 4096
[2024-09-26 18:52:43,457][root][INFO] - max epochs              : 15
[2024-09-26 18:52:43,457][root][INFO] - total steps             : 960
[2024-09-26 18:52:43,457][root][INFO] - warmup steps            : 96
[2024-09-26 18:52:43,457][root][INFO] - batch size              : 64
[2024-09-26 18:52:43,457][root][INFO] - accumulation steps      : 1
[2024-09-26 18:52:43,457][root][INFO] - optimizer               : adamwscale
[2024-09-26 18:52:43,457][root][INFO] - lr_scheduler            : cosine
[2024-09-26 18:52:43,457][root][INFO] - learning rate           : 0.01
[2024-09-26 18:52:43,457][root][INFO] - max length              : 256

[2024-09-26 18:52:43,457][root][INFO] - LoRA Configuration
[2024-09-26 18:52:43,457][root][INFO] - ㄴ r                    : 32
[2024-09-26 18:52:43,457][root][INFO] - ㄴ alpha                : 128
[2024-09-26 18:52:43,458][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 18:52:43,458][root][INFO] - KOMBO Configuration
[2024-09-26 18:52:43,458][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-26 18:52:43,458][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-26 18:52:43,458][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-26 18:52:43,458][root][INFO] - ㄴ do_combination       : True
[2024-09-26 18:52:43,458][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-26 18:52:43,458][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-26 18:52:43,458][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-26 18:52:43,458][root][INFO] -   ㄴ add_lora           : True

[2024-09-26 18:52:43,459][root][INFO] - LoRA in KOMBO Configuration
[2024-09-26 18:52:43,459][root][INFO] - ㄴ r                : 32
[2024-09-26 18:52:43,459][root][INFO] - ㄴ alpha            : 128
[2024-09-26 18:52:43,459][root][INFO] - ㄴ dropout          : 0.03

[2024-09-26 18:52:43,459][root][INFO] - 

[2024-09-26 18:52:43,459][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:52:43,459][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 18:52:43,459][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 18:52:43,459][root][INFO] - * tb interval   : 15

[2024-09-26 18:52:43,459][root][INFO] - 

[2024-09-26 18:52:43,459][root][INFO] - Start the Training !
[2024-09-26 18:52:43,462][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 18:52:46,198][root][INFO] - Step: 705/1350  |  Loss: 0.5835  |  Score: 81.94 [%]  |  Seq Length: 256.0
[2024-09-26 18:52:48,262][root][INFO] - Step: 1005/1035  |  Loss: 0.3295  |  Score: 90.68 [%]  |  Seq Length: 256.0
[2024-09-26 18:52:51,768][root][INFO] - Step: 720/1350  |  Loss: 0.5216  |  Score: 82.92 [%]  |  Seq Length: 256.0
[2024-09-26 18:52:52,713][root][INFO] - Step: 15/960  |  Loss: 3.3677  |  Score: 2.54 [%]  |  Seq Length: 256.0
[2024-09-26 18:52:53,989][root][INFO] - Step: 1020/1035  |  Loss: 0.3249  |  Score: 91.14 [%]  |  Seq Length: 256.0
[2024-09-26 18:52:55,658][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 18:52:55,658][root][INFO] - Score: 77.44 [%]  |  Evaluation Time: 3.89 [s]
[2024-09-26 18:52:59,239][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 18:52:59,239][root][INFO] - Score: 69.85 [%]  |  Evaluation Time: 3.58 [s]
[2024-09-26 18:52:59,241][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 18:52:59,768][root][INFO] - Step: 1035/1035  |  Loss: 0.3152  |  Score: 90.50 [%]  |  Seq Length: 256.0
[2024-09-26 18:53:00,030][root][INFO] - Step: 721/1350  |  Loss: 0.2903  |  Score: 90.15 [%]  |  Seq Length: 256.0
[2024-09-26 18:53:00,491][root][INFO] - Step: 30/960  |  Loss: 2.2256  |  Score: 28.40 [%]  |  Seq Length: 256.0
[2024-09-26 18:53:02,999][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 18:53:02,999][root][INFO] - Score: 77.52 [%]  |  Evaluation Time: 3.23 [s]
[2024-09-26 18:53:05,225][root][INFO] - Step: 735/1350  |  Loss: 0.4833  |  Score: 85.83 [%]  |  Seq Length: 256.0
[2024-09-26 18:53:05,997][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 18:53:05,997][root][INFO] - Score: 70.78 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-26 18:53:05,998][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 18:53:05,998][root][INFO] - - Epoch: 6
[2024-09-26 18:53:05,999][root][INFO] - - DEV score: 77.96 [%]
[2024-09-26 18:53:05,999][root][INFO] - - TEST score: 71.93 [%]
[2024-09-26 18:53:06,000][root][INFO] - Fine-tuning is done!
[2024-09-26 18:53:08,271][root][INFO] - Step: 45/960  |  Loss: 1.8916  |  Score: 43.74 [%]  |  Seq Length: 256.0
[2024-09-26 18:53:10,781][root][INFO] - Step: 750/1350  |  Loss: 0.4833  |  Score: 86.06 [%]  |  Seq Length: 256.0
[2024-09-26 18:53:12,206][root][INFO] - 

[2024-09-26 18:53:12,206][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 18:53:12,206][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:53:12,206][root][INFO] - 

[2024-09-26 18:53:12,206][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 18:53:16,136][root][INFO] - Step: 60/960  |  Loss: 1.6867  |  Score: 50.29 [%]  |  Seq Length: 256.0
[2024-09-26 18:53:16,330][root][INFO] - Step: 765/1350  |  Loss: 0.4737  |  Score: 85.38 [%]  |  Seq Length: 256.0
[2024-09-26 18:53:16,420][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 18:53:16,421][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 18:53:16,421][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 18:53:16,422][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 18:53:16,422][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 18:53:16,423][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 18:53:16,423][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 18:53:16,424][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 18:53:16,424][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 18:53:16,424][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 18:53:16,425][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 18:53:16,425][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 18:53:16,426][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 18:53:16,426][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 18:53:16,427][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 18:53:16,427][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 18:53:16,427][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 18:53:16,428][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 18:53:16,428][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 18:53:16,429][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 18:53:16,429][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 18:53:16,430][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 18:53:16,430][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 18:53:16,430][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 18:53:16,432][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 18:53:16,435][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-26 18:53:16,541][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-26 18:53:16,543][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-26 18:53:16,757][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 18:53:18,245][root][INFO] - Step: 64/960  |  Loss: 1.4681  |  Score: 61.63 [%]  |  Seq Length: 256.0
[2024-09-26 18:53:21,882][root][INFO] - Step: 780/1350  |  Loss: 0.5204  |  Score: 84.93 [%]  |  Seq Length: 256.0
[2024-09-26 18:53:22,988][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 18:53:22,988][root][INFO] - Score: 67.80 [%]  |  Evaluation Time: 4.74 [s]
[2024-09-26 18:53:23,500][root][INFO] - 

[2024-09-26 18:53:23,500][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 18:53:23,501][root][INFO] - Data Preprocessing
[2024-09-26 18:53:23,501][root][INFO] - ㄴ remain_lang                ko_en_punc
[2024-09-26 18:53:23,501][root][INFO] - ㄴ do_hangeulize              True
[2024-09-26 18:53:23,501][root][INFO] - ㄴ data_remove                True

[2024-09-26 18:53:23,501][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 18:53:23,512][root][INFO] - vocab size              : 51200
[2024-09-26 18:53:23,512][root][INFO] - device                  : gpu
[2024-09-26 18:53:23,512][root][INFO] - random seed             : 42
[2024-09-26 18:53:23,513][root][INFO] - train data size         : 4416
[2024-09-26 18:53:23,513][root][INFO] - max epochs              : 15
[2024-09-26 18:53:23,513][root][INFO] - total steps             : 1035
[2024-09-26 18:53:23,513][root][INFO] - warmup steps            : 104
[2024-09-26 18:53:23,513][root][INFO] - batch size              : 64
[2024-09-26 18:53:23,513][root][INFO] - accumulation steps      : 1
[2024-09-26 18:53:23,513][root][INFO] - optimizer               : adamwscale
[2024-09-26 18:53:23,513][root][INFO] - lr_scheduler            : cosine
[2024-09-26 18:53:23,514][root][INFO] - learning rate           : 0.01
[2024-09-26 18:53:23,514][root][INFO] - max length              : 256

[2024-09-26 18:53:23,514][root][INFO] - LoRA Configuration
[2024-09-26 18:53:23,514][root][INFO] - ㄴ r                    : 32
[2024-09-26 18:53:23,514][root][INFO] - ㄴ alpha                : 128
[2024-09-26 18:53:23,514][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 18:53:23,514][root][INFO] - KOMBO Configuration
[2024-09-26 18:53:23,514][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-26 18:53:23,514][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-26 18:53:23,515][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-26 18:53:23,515][root][INFO] - ㄴ do_combination       : True
[2024-09-26 18:53:23,515][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-26 18:53:23,515][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-26 18:53:23,515][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-26 18:53:23,515][root][INFO] -   ㄴ add_lora           : True

[2024-09-26 18:53:23,515][root][INFO] - LoRA in KOMBO Configuration
[2024-09-26 18:53:23,516][root][INFO] - ㄴ r                : 32
[2024-09-26 18:53:23,516][root][INFO] - ㄴ alpha            : 128
[2024-09-26 18:53:23,516][root][INFO] - ㄴ dropout          : 0.03

[2024-09-26 18:53:23,516][root][INFO] - 

[2024-09-26 18:53:23,516][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:53:23,516][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 18:53:23,516][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 18:53:23,516][root][INFO] - * tb interval   : 15

[2024-09-26 18:53:23,516][root][INFO] - 

[2024-09-26 18:53:23,517][root][INFO] - Start the Training !
[2024-09-26 18:53:23,520][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 18:53:27,434][root][INFO] - Step: 795/1350  |  Loss: 0.5140  |  Score: 85.56 [%]  |  Seq Length: 256.0
[2024-09-26 18:53:27,572][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 18:53:27,572][root][INFO] - Score: 65.23 [%]  |  Evaluation Time: 4.58 [s]
[2024-09-26 18:53:27,574][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 18:53:27,575][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 18:53:33,021][root][INFO] - Step: 810/1350  |  Loss: 0.4980  |  Score: 85.66 [%]  |  Seq Length: 256.0
[2024-09-26 18:53:33,127][root][INFO] - Step: 15/1035  |  Loss: 3.1513  |  Score: 9.14 [%]  |  Seq Length: 256.0
[2024-09-26 18:53:33,684][root][INFO] - Step: 75/960  |  Loss: 1.2989  |  Score: 68.16 [%]  |  Seq Length: 256.0
[2024-09-26 18:53:36,878][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 18:53:36,879][root][INFO] - Score: 77.05 [%]  |  Evaluation Time: 3.85 [s]
[2024-09-26 18:53:40,416][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 18:53:40,416][root][INFO] - Score: 70.96 [%]  |  Evaluation Time: 3.53 [s]
[2024-09-26 18:53:40,418][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 18:53:40,921][root][INFO] - Step: 30/1035  |  Loss: 2.2335  |  Score: 16.94 [%]  |  Seq Length: 256.0
[2024-09-26 18:53:41,188][root][INFO] - Step: 811/1350  |  Loss: 0.3629  |  Score: 85.66 [%]  |  Seq Length: 256.0
[2024-09-26 18:53:41,525][root][INFO] - Step: 90/960  |  Loss: 1.3709  |  Score: 69.50 [%]  |  Seq Length: 256.0
[2024-09-26 18:53:46,376][root][INFO] - Step: 825/1350  |  Loss: 0.4237  |  Score: 88.56 [%]  |  Seq Length: 256.0
[2024-09-26 18:53:48,874][root][INFO] - Step: 45/1035  |  Loss: 1.9802  |  Score: 42.49 [%]  |  Seq Length: 256.0
[2024-09-26 18:53:49,239][root][INFO] - Step: 105/960  |  Loss: 1.2573  |  Score: 68.91 [%]  |  Seq Length: 256.0
[2024-09-26 18:53:51,927][root][INFO] - Step: 840/1350  |  Loss: 0.4759  |  Score: 86.16 [%]  |  Seq Length: 256.0
[2024-09-26 18:53:56,886][root][INFO] - Step: 60/1035  |  Loss: 1.6428  |  Score: 55.77 [%]  |  Seq Length: 256.0
[2024-09-26 18:53:57,017][root][INFO] - Step: 120/960  |  Loss: 1.3040  |  Score: 62.12 [%]  |  Seq Length: 256.0
[2024-09-26 18:53:57,487][root][INFO] - Step: 855/1350  |  Loss: 0.4531  |  Score: 86.15 [%]  |  Seq Length: 256.0
[2024-09-26 18:54:01,230][root][INFO] - Step: 128/960  |  Loss: 1.3166  |  Score: 63.93 [%]  |  Seq Length: 256.0
[2024-09-26 18:54:01,571][root][INFO] - Step: 69/1035  |  Loss: 1.4453  |  Score: 58.69 [%]  |  Seq Length: 256.0
[2024-09-26 18:54:03,032][root][INFO] - Step: 870/1350  |  Loss: 0.5112  |  Score: 85.69 [%]  |  Seq Length: 256.0
[2024-09-26 18:54:05,797][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 18:54:05,797][root][INFO] - Score: 70.44 [%]  |  Evaluation Time: 4.56 [s]
[2024-09-26 18:54:06,665][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 18:54:06,665][root][INFO] - Score: 70.59 [%]  |  Evaluation Time: 5.09 [s]
[2024-09-26 18:54:08,589][root][INFO] - Step: 885/1350  |  Loss: 0.4552  |  Score: 87.26 [%]  |  Seq Length: 256.0
[2024-09-26 18:54:10,308][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 18:54:10,309][root][INFO] - Score: 65.88 [%]  |  Evaluation Time: 4.51 [s]
[2024-09-26 18:54:10,310][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 18:54:10,312][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 18:54:11,380][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 18:54:11,380][root][INFO] - Score: 65.73 [%]  |  Evaluation Time: 4.71 [s]
[2024-09-26 18:54:11,381][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 18:54:11,383][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 18:54:14,175][root][INFO] - Step: 900/1350  |  Loss: 0.4386  |  Score: 86.95 [%]  |  Seq Length: 256.0
[2024-09-26 18:54:14,353][root][INFO] - Step: 135/960  |  Loss: 1.1590  |  Score: 67.35 [%]  |  Seq Length: 256.0
[2024-09-26 18:54:15,016][root][INFO] - Step: 75/1035  |  Loss: 1.3404  |  Score: 65.13 [%]  |  Seq Length: 256.0
[2024-09-26 18:54:18,043][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 18:54:18,043][root][INFO] - Score: 77.72 [%]  |  Evaluation Time: 3.86 [s]
[2024-09-26 18:54:21,760][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 18:54:21,761][root][INFO] - Score: 70.89 [%]  |  Evaluation Time: 3.72 [s]
[2024-09-26 18:54:21,762][root][INFO] - 
Save new Best Score (Epoch: 10)
[2024-09-26 18:54:21,763][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 18:54:22,101][root][INFO] - Step: 150/960  |  Loss: 1.1536  |  Score: 69.64 [%]  |  Seq Length: 256.0
[2024-09-26 18:54:22,499][root][INFO] - Step: 901/1350  |  Loss: 0.3500  |  Score: 89.67 [%]  |  Seq Length: 256.0
[2024-09-26 18:54:22,976][root][INFO] - Step: 90/1035  |  Loss: 1.2999  |  Score: 61.44 [%]  |  Seq Length: 256.0
[2024-09-26 18:54:27,679][root][INFO] - Step: 915/1350  |  Loss: 0.4259  |  Score: 87.90 [%]  |  Seq Length: 256.0
[2024-09-26 18:54:29,860][root][INFO] - Step: 165/960  |  Loss: 1.0561  |  Score: 71.11 [%]  |  Seq Length: 256.0
[2024-09-26 18:54:30,933][root][INFO] - Step: 105/1035  |  Loss: 1.3325  |  Score: 64.91 [%]  |  Seq Length: 256.0
[2024-09-26 18:54:33,234][root][INFO] - Step: 930/1350  |  Loss: 0.3847  |  Score: 88.37 [%]  |  Seq Length: 256.0
[2024-09-26 18:54:37,555][root][INFO] - Step: 180/960  |  Loss: 1.0026  |  Score: 71.50 [%]  |  Seq Length: 256.0
[2024-09-26 18:54:38,782][root][INFO] - Step: 945/1350  |  Loss: 0.4150  |  Score: 88.22 [%]  |  Seq Length: 256.0
[2024-09-26 18:54:38,885][root][INFO] - Step: 120/1035  |  Loss: 1.4389  |  Score: 65.59 [%]  |  Seq Length: 256.0
[2024-09-26 18:54:43,831][root][INFO] - Step: 192/960  |  Loss: 1.1689  |  Score: 71.09 [%]  |  Seq Length: 256.0
[2024-09-26 18:54:44,329][root][INFO] - Step: 960/1350  |  Loss: 0.3754  |  Score: 87.97 [%]  |  Seq Length: 256.0
[2024-09-26 18:54:46,871][root][INFO] - Step: 135/1035  |  Loss: 1.2834  |  Score: 66.50 [%]  |  Seq Length: 256.0
[2024-09-26 18:54:48,488][root][INFO] - Step: 138/1035  |  Loss: 1.1234  |  Score: 67.51 [%]  |  Seq Length: 256.0
[2024-09-26 18:54:48,548][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 18:54:48,548][root][INFO] - Score: 78.68 [%]  |  Evaluation Time: 4.71 [s]
[2024-09-26 18:54:49,876][root][INFO] - Step: 975/1350  |  Loss: 0.4159  |  Score: 86.45 [%]  |  Seq Length: 256.0
[2024-09-26 18:54:53,088][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 18:54:53,088][root][INFO] - Score: 68.74 [%]  |  Evaluation Time: 4.54 [s]
[2024-09-26 18:54:53,089][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 18:54:53,091][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 18:54:53,563][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 18:54:53,563][root][INFO] - Score: 75.62 [%]  |  Evaluation Time: 5.07 [s]
[2024-09-26 18:54:55,095][root][INFO] - Step: 195/960  |  Loss: 0.8890  |  Score: 73.59 [%]  |  Seq Length: 256.0
[2024-09-26 18:54:55,457][root][INFO] - Step: 990/1350  |  Loss: 0.4167  |  Score: 88.02 [%]  |  Seq Length: 256.0
[2024-09-26 18:54:58,283][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 18:54:58,283][root][INFO] - Score: 68.28 [%]  |  Evaluation Time: 4.72 [s]
[2024-09-26 18:54:58,284][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 18:54:58,286][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 18:54:59,269][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 18:54:59,269][root][INFO] - Score: 77.30 [%]  |  Evaluation Time: 3.81 [s]
[2024-09-26 18:55:02,950][root][INFO] - Step: 210/960  |  Loss: 0.9878  |  Score: 72.75 [%]  |  Seq Length: 256.0
[2024-09-26 18:55:02,998][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 18:55:02,998][root][INFO] - Score: 70.96 [%]  |  Evaluation Time: 3.73 [s]
[2024-09-26 18:55:03,000][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 18:55:03,725][root][INFO] - Step: 991/1350  |  Loss: 0.3441  |  Score: 86.98 [%]  |  Seq Length: 256.0
[2024-09-26 18:55:05,165][root][INFO] - Step: 150/1035  |  Loss: 1.0785  |  Score: 70.37 [%]  |  Seq Length: 256.0
[2024-09-26 18:55:08,907][root][INFO] - Step: 1005/1350  |  Loss: 0.4150  |  Score: 88.09 [%]  |  Seq Length: 256.0
[2024-09-26 18:55:10,681][root][INFO] - Step: 225/960  |  Loss: 0.8677  |  Score: 78.30 [%]  |  Seq Length: 256.0
[2024-09-26 18:55:13,124][root][INFO] - Step: 165/1035  |  Loss: 1.1102  |  Score: 72.10 [%]  |  Seq Length: 256.0
[2024-09-26 18:55:14,462][root][INFO] - Step: 1020/1350  |  Loss: 0.3890  |  Score: 88.67 [%]  |  Seq Length: 256.0
[2024-09-26 18:55:18,474][root][INFO] - Step: 240/960  |  Loss: 0.8759  |  Score: 74.49 [%]  |  Seq Length: 256.0
[2024-09-26 18:55:20,010][root][INFO] - Step: 1035/1350  |  Loss: 0.3867  |  Score: 87.85 [%]  |  Seq Length: 256.0
[2024-09-26 18:55:21,143][root][INFO] - Step: 180/1035  |  Loss: 1.1233  |  Score: 69.48 [%]  |  Seq Length: 256.0
[2024-09-26 18:55:25,557][root][INFO] - Step: 1050/1350  |  Loss: 0.3921  |  Score: 88.78 [%]  |  Seq Length: 256.0
[2024-09-26 18:55:26,222][root][INFO] - Step: 255/960  |  Loss: 1.0116  |  Score: 74.93 [%]  |  Seq Length: 256.0
[2024-09-26 18:55:26,793][root][INFO] - Step: 256/960  |  Loss: 0.8147  |  Score: 81.40 [%]  |  Seq Length: 256.0
[2024-09-26 18:55:29,090][root][INFO] - Step: 195/1035  |  Loss: 1.0814  |  Score: 69.92 [%]  |  Seq Length: 256.0
[2024-09-26 18:55:31,101][root][INFO] - Step: 1065/1350  |  Loss: 0.3763  |  Score: 88.74 [%]  |  Seq Length: 256.0
[2024-09-26 18:55:31,411][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 18:55:31,411][root][INFO] - Score: 77.61 [%]  |  Evaluation Time: 4.62 [s]
[2024-09-26 18:55:35,522][root][INFO] - Step: 207/1035  |  Loss: 1.1119  |  Score: 68.40 [%]  |  Seq Length: 256.0
[2024-09-26 18:55:35,827][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 18:55:35,827][root][INFO] - Score: 69.35 [%]  |  Evaluation Time: 4.41 [s]
[2024-09-26 18:55:35,830][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 18:55:36,679][root][INFO] - Step: 1080/1350  |  Loss: 0.3997  |  Score: 87.61 [%]  |  Seq Length: 256.0
[2024-09-26 18:55:40,522][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 18:55:40,522][root][INFO] - Score: 77.28 [%]  |  Evaluation Time: 3.84 [s]
[2024-09-26 18:55:40,767][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 18:55:40,767][root][INFO] - Score: 76.92 [%]  |  Evaluation Time: 5.24 [s]
[2024-09-26 18:55:43,543][root][INFO] - Step: 270/960  |  Loss: 0.8255  |  Score: 80.61 [%]  |  Seq Length: 256.0
[2024-09-26 18:55:44,135][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 18:55:44,135][root][INFO] - Score: 70.77 [%]  |  Evaluation Time: 3.61 [s]
[2024-09-26 18:55:44,137][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 18:55:44,887][root][INFO] - Step: 1081/1350  |  Loss: 0.4213  |  Score: 85.57 [%]  |  Seq Length: 256.0
[2024-09-26 18:55:45,555][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 18:55:45,555][root][INFO] - Score: 69.30 [%]  |  Evaluation Time: 4.78 [s]
[2024-09-26 18:55:45,556][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 18:55:45,558][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 18:55:47,758][root][INFO] - Step: 210/1035  |  Loss: 0.8865  |  Score: 82.19 [%]  |  Seq Length: 256.0
[2024-09-26 18:55:50,067][root][INFO] - Step: 1095/1350  |  Loss: 0.3354  |  Score: 89.36 [%]  |  Seq Length: 256.0
[2024-09-26 18:55:51,289][root][INFO] - Step: 285/960  |  Loss: 0.7631  |  Score: 79.41 [%]  |  Seq Length: 256.0
[2024-09-26 18:55:55,611][root][INFO] - Step: 1110/1350  |  Loss: 0.3622  |  Score: 88.87 [%]  |  Seq Length: 256.0
[2024-09-26 18:55:55,789][root][INFO] - Step: 225/1035  |  Loss: 0.9665  |  Score: 74.62 [%]  |  Seq Length: 256.0
[2024-09-26 18:55:59,020][root][INFO] - Step: 300/960  |  Loss: 0.7885  |  Score: 78.50 [%]  |  Seq Length: 256.0
[2024-09-26 18:56:01,155][root][INFO] - Step: 1125/1350  |  Loss: 0.3442  |  Score: 89.84 [%]  |  Seq Length: 256.0
[2024-09-26 18:56:03,782][root][INFO] - Step: 240/1035  |  Loss: 0.9496  |  Score: 74.56 [%]  |  Seq Length: 256.0
[2024-09-26 18:56:06,699][root][INFO] - Step: 1140/1350  |  Loss: 0.3820  |  Score: 87.74 [%]  |  Seq Length: 256.0
[2024-09-26 18:56:06,778][root][INFO] - Step: 315/960  |  Loss: 0.9201  |  Score: 76.32 [%]  |  Seq Length: 256.0
[2024-09-26 18:56:09,400][root][INFO] - Step: 320/960  |  Loss: 0.8664  |  Score: 75.64 [%]  |  Seq Length: 256.0
[2024-09-26 18:56:11,731][root][INFO] - Step: 255/1035  |  Loss: 0.9193  |  Score: 72.91 [%]  |  Seq Length: 256.0
[2024-09-26 18:56:12,253][root][INFO] - Step: 1155/1350  |  Loss: 0.3670  |  Score: 88.37 [%]  |  Seq Length: 256.0
[2024-09-26 18:56:14,042][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 18:56:14,042][root][INFO] - Score: 76.20 [%]  |  Evaluation Time: 4.64 [s]
[2024-09-26 18:56:17,828][root][INFO] - Step: 1170/1350  |  Loss: 0.4104  |  Score: 88.03 [%]  |  Seq Length: 256.0
[2024-09-26 18:56:18,658][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 18:56:18,658][root][INFO] - Score: 71.91 [%]  |  Evaluation Time: 4.61 [s]
[2024-09-26 18:56:18,659][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 18:56:18,661][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 18:56:19,647][root][INFO] - Step: 270/1035  |  Loss: 0.9721  |  Score: 75.14 [%]  |  Seq Length: 256.0
[2024-09-26 18:56:21,664][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 18:56:21,664][root][INFO] - Score: 77.93 [%]  |  Evaluation Time: 3.83 [s]
[2024-09-26 18:56:22,908][root][INFO] - Step: 276/1035  |  Loss: 0.9047  |  Score: 75.73 [%]  |  Seq Length: 256.0
[2024-09-26 18:56:24,264][root][INFO] - Step: 330/960  |  Loss: 0.6984  |  Score: 81.51 [%]  |  Seq Length: 256.0
[2024-09-26 18:56:25,261][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 18:56:25,261][root][INFO] - Score: 71.22 [%]  |  Evaluation Time: 3.60 [s]
[2024-09-26 18:56:25,262][root][INFO] - 
Save new Best Score (Epoch: 13)
[2024-09-26 18:56:25,264][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 18:56:25,980][root][INFO] - Step: 1171/1350  |  Loss: 0.4130  |  Score: 85.50 [%]  |  Seq Length: 256.0
[2024-09-26 18:56:28,028][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 18:56:28,029][root][INFO] - Score: 76.88 [%]  |  Evaluation Time: 5.12 [s]
[2024-09-26 18:56:31,166][root][INFO] - Step: 1185/1350  |  Loss: 0.3705  |  Score: 88.84 [%]  |  Seq Length: 256.0
[2024-09-26 18:56:32,012][root][INFO] - Step: 345/960  |  Loss: 0.6841  |  Score: 82.57 [%]  |  Seq Length: 256.0
[2024-09-26 18:56:32,853][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 18:56:32,853][root][INFO] - Score: 70.69 [%]  |  Evaluation Time: 4.82 [s]
[2024-09-26 18:56:32,854][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-26 18:56:32,856][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 18:56:36,719][root][INFO] - Step: 1200/1350  |  Loss: 0.3907  |  Score: 87.95 [%]  |  Seq Length: 256.0
[2024-09-26 18:56:38,126][root][INFO] - Step: 285/1035  |  Loss: 0.7905  |  Score: 80.92 [%]  |  Seq Length: 256.0
[2024-09-26 18:56:39,901][root][INFO] - Step: 360/960  |  Loss: 0.6684  |  Score: 81.62 [%]  |  Seq Length: 256.0
[2024-09-26 18:56:42,271][root][INFO] - Step: 1215/1350  |  Loss: 0.3731  |  Score: 88.42 [%]  |  Seq Length: 256.0
[2024-09-26 18:56:46,222][root][INFO] - Step: 300/1035  |  Loss: 0.8088  |  Score: 78.89 [%]  |  Seq Length: 256.0
[2024-09-26 18:56:47,637][root][INFO] - Step: 375/960  |  Loss: 0.7983  |  Score: 79.29 [%]  |  Seq Length: 256.0
[2024-09-26 18:56:47,815][root][INFO] - Step: 1230/1350  |  Loss: 0.3637  |  Score: 89.17 [%]  |  Seq Length: 256.0
[2024-09-26 18:56:52,360][root][INFO] - Step: 384/960  |  Loss: 0.7340  |  Score: 80.15 [%]  |  Seq Length: 256.0
[2024-09-26 18:56:53,359][root][INFO] - Step: 1245/1350  |  Loss: 0.3497  |  Score: 90.08 [%]  |  Seq Length: 256.0
[2024-09-26 18:56:54,116][root][INFO] - Step: 315/1035  |  Loss: 0.8030  |  Score: 77.56 [%]  |  Seq Length: 256.0
[2024-09-26 18:56:57,176][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 18:56:57,176][root][INFO] - Score: 78.72 [%]  |  Evaluation Time: 4.81 [s]
[2024-09-26 18:56:58,944][root][INFO] - Step: 1260/1350  |  Loss: 0.3482  |  Score: 90.12 [%]  |  Seq Length: 256.0
[2024-09-26 18:57:01,781][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 18:57:01,781][root][INFO] - Score: 71.06 [%]  |  Evaluation Time: 4.60 [s]
[2024-09-26 18:57:01,783][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 18:57:01,784][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 18:57:02,042][root][INFO] - Step: 330/1035  |  Loss: 0.7894  |  Score: 79.02 [%]  |  Seq Length: 256.0
[2024-09-26 18:57:02,760][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 18:57:02,761][root][INFO] - Score: 77.53 [%]  |  Evaluation Time: 3.81 [s]
[2024-09-26 18:57:05,273][root][INFO] - Step: 390/960  |  Loss: 0.5026  |  Score: 86.50 [%]  |  Seq Length: 256.0
[2024-09-26 18:57:06,317][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 18:57:06,318][root][INFO] - Score: 70.67 [%]  |  Evaluation Time: 3.55 [s]
[2024-09-26 18:57:06,320][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 18:57:07,021][root][INFO] - Step: 1261/1350  |  Loss: 0.4019  |  Score: 85.63 [%]  |  Seq Length: 256.0
[2024-09-26 18:57:10,072][root][INFO] - Step: 345/1035  |  Loss: 0.8018  |  Score: 76.14 [%]  |  Seq Length: 256.0
[2024-09-26 18:57:12,193][root][INFO] - Step: 1275/1350  |  Loss: 0.3289  |  Score: 90.94 [%]  |  Seq Length: 256.0
[2024-09-26 18:57:13,055][root][INFO] - Step: 405/960  |  Loss: 0.6585  |  Score: 82.78 [%]  |  Seq Length: 256.0
[2024-09-26 18:57:15,130][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 18:57:15,130][root][INFO] - Score: 77.24 [%]  |  Evaluation Time: 5.05 [s]
[2024-09-26 18:57:17,729][root][INFO] - Step: 1290/1350  |  Loss: 0.3367  |  Score: 89.69 [%]  |  Seq Length: 256.0
[2024-09-26 18:57:19,831][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 18:57:19,831][root][INFO] - Score: 70.39 [%]  |  Evaluation Time: 4.70 [s]
[2024-09-26 18:57:19,832][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 18:57:19,833][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 18:57:20,792][root][INFO] - Step: 420/960  |  Loss: 0.6327  |  Score: 83.03 [%]  |  Seq Length: 256.0
[2024-09-26 18:57:20,906][root][INFO] - Step: 346/1035  |  Loss: 0.7717  |  Score: 79.88 [%]  |  Seq Length: 256.0
[2024-09-26 18:57:23,260][root][INFO] - Step: 1305/1350  |  Loss: 0.3631  |  Score: 90.06 [%]  |  Seq Length: 256.0
[2024-09-26 18:57:28,338][root][INFO] - Step: 360/1035  |  Loss: 0.7239  |  Score: 80.95 [%]  |  Seq Length: 256.0
[2024-09-26 18:57:28,578][root][INFO] - Step: 435/960  |  Loss: 0.6375  |  Score: 81.54 [%]  |  Seq Length: 256.0
[2024-09-26 18:57:28,794][root][INFO] - Step: 1320/1350  |  Loss: 0.3659  |  Score: 88.85 [%]  |  Seq Length: 256.0
[2024-09-26 18:57:34,322][root][INFO] - Step: 1335/1350  |  Loss: 0.3576  |  Score: 88.92 [%]  |  Seq Length: 256.0
[2024-09-26 18:57:35,432][root][INFO] - Step: 448/960  |  Loss: 0.6967  |  Score: 82.51 [%]  |  Seq Length: 256.0
[2024-09-26 18:57:36,278][root][INFO] - Step: 375/1035  |  Loss: 0.6619  |  Score: 81.02 [%]  |  Seq Length: 256.0
[2024-09-26 18:57:39,885][root][INFO] - Step: 1350/1350  |  Loss: 0.3190  |  Score: 90.28 [%]  |  Seq Length: 256.0
[2024-09-26 18:57:40,007][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 18:57:40,008][root][INFO] - Score: 79.45 [%]  |  Evaluation Time: 4.57 [s]
[2024-09-26 18:57:43,840][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 18:57:43,840][root][INFO] - Score: 77.58 [%]  |  Evaluation Time: 3.95 [s]
[2024-09-26 18:57:44,225][root][INFO] - Step: 390/1035  |  Loss: 0.7186  |  Score: 78.97 [%]  |  Seq Length: 256.0
[2024-09-26 18:57:44,493][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 18:57:44,493][root][INFO] - Score: 69.43 [%]  |  Evaluation Time: 4.48 [s]
[2024-09-26 18:57:44,496][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 18:57:46,053][root][INFO] - Step: 450/960  |  Loss: 0.4526  |  Score: 87.50 [%]  |  Seq Length: 256.0
[2024-09-26 18:57:47,579][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 18:57:47,579][root][INFO] - Score: 71.29 [%]  |  Evaluation Time: 3.74 [s]
[2024-09-26 18:57:47,580][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 18:57:47,580][root][INFO] - - Epoch: 13
[2024-09-26 18:57:47,580][root][INFO] - - DEV score: 77.93 [%]
[2024-09-26 18:57:47,580][root][INFO] - - TEST score: 71.22 [%]
[2024-09-26 18:57:47,581][root][INFO] - Fine-tuning is done!
[2024-09-26 18:57:52,201][root][INFO] - Step: 405/1035  |  Loss: 0.7934  |  Score: 80.37 [%]  |  Seq Length: 256.0
[2024-09-26 18:57:53,842][root][INFO] - 

[2024-09-26 18:57:53,842][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 18:57:53,842][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:57:53,842][root][INFO] - 

[2024-09-26 18:57:53,842][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko', 'do_hangeulize': True, 'data_remove': False, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 18:57:53,927][root][INFO] - Step: 465/960  |  Loss: 0.5489  |  Score: 85.64 [%]  |  Seq Length: 256.0
[2024-09-26 18:57:57,041][root][INFO] - Step: 414/1035  |  Loss: 0.7225  |  Score: 81.69 [%]  |  Seq Length: 256.0
[2024-09-26 18:57:58,759][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 18:57:58,759][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 18:57:58,760][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 18:57:58,760][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 18:57:58,761][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 18:57:58,761][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 18:57:58,762][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 18:57:58,762][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 18:57:58,763][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 18:57:58,763][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 18:57:58,764][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 18:57:58,764][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 18:57:58,764][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 18:57:58,765][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 18:57:58,765][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 18:57:58,766][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 18:57:58,766][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 18:57:58,767][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 18:57:58,767][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 18:57:58,767][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 18:57:58,768][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 18:57:58,768][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 18:57:58,769][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 18:57:58,769][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 18:57:58,771][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 18:57:58,774][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-26 18:57:58,881][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-26 18:57:58,883][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-26 18:57:59,282][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 18:58:01,698][root][INFO] - Step: 480/960  |  Loss: 0.6382  |  Score: 84.06 [%]  |  Seq Length: 256.0
[2024-09-26 18:58:02,026][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 18:58:02,027][root][INFO] - Score: 78.59 [%]  |  Evaluation Time: 4.98 [s]
[2024-09-26 18:58:06,305][root][INFO] - 

[2024-09-26 18:58:06,306][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 18:58:06,306][root][INFO] - Data Preprocessing
[2024-09-26 18:58:06,306][root][INFO] - ㄴ remain_lang                ko
[2024-09-26 18:58:06,306][root][INFO] - ㄴ do_hangeulize              True
[2024-09-26 18:58:06,306][root][INFO] - ㄴ data_remove                False

[2024-09-26 18:58:06,306][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 18:58:06,315][root][INFO] - vocab size              : 51200
[2024-09-26 18:58:06,315][root][INFO] - device                  : gpu
[2024-09-26 18:58:06,315][root][INFO] - random seed             : 42
[2024-09-26 18:58:06,315][root][INFO] - train data size         : 5760
[2024-09-26 18:58:06,315][root][INFO] - max epochs              : 15
[2024-09-26 18:58:06,316][root][INFO] - total steps             : 1350
[2024-09-26 18:58:06,316][root][INFO] - warmup steps            : 135
[2024-09-26 18:58:06,316][root][INFO] - batch size              : 64
[2024-09-26 18:58:06,316][root][INFO] - accumulation steps      : 1
[2024-09-26 18:58:06,316][root][INFO] - optimizer               : adamwscale
[2024-09-26 18:58:06,316][root][INFO] - lr_scheduler            : cosine
[2024-09-26 18:58:06,316][root][INFO] - learning rate           : 0.01
[2024-09-26 18:58:06,316][root][INFO] - max length              : 256

[2024-09-26 18:58:06,316][root][INFO] - LoRA Configuration
[2024-09-26 18:58:06,316][root][INFO] - ㄴ r                    : 32
[2024-09-26 18:58:06,316][root][INFO] - ㄴ alpha                : 128
[2024-09-26 18:58:06,317][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 18:58:06,317][root][INFO] - KOMBO Configuration
[2024-09-26 18:58:06,317][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-26 18:58:06,317][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-26 18:58:06,317][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-26 18:58:06,317][root][INFO] - ㄴ do_combination       : True
[2024-09-26 18:58:06,317][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-26 18:58:06,317][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-26 18:58:06,317][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-26 18:58:06,318][root][INFO] -   ㄴ add_lora           : True

[2024-09-26 18:58:06,318][root][INFO] - LoRA in KOMBO Configuration
[2024-09-26 18:58:06,318][root][INFO] - ㄴ r                : 32
[2024-09-26 18:58:06,318][root][INFO] - ㄴ alpha            : 128
[2024-09-26 18:58:06,318][root][INFO] - ㄴ dropout          : 0.03

[2024-09-26 18:58:06,318][root][INFO] - 

[2024-09-26 18:58:06,318][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs
[2024-09-26 18:58:06,318][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 18:58:06,318][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 18:58:06,318][root][INFO] - * tb interval   : 15

[2024-09-26 18:58:06,318][root][INFO] - 

[2024-09-26 18:58:06,318][root][INFO] - Start the Training !
[2024-09-26 18:58:06,321][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 18:58:06,770][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 18:58:06,771][root][INFO] - Score: 71.75 [%]  |  Evaluation Time: 4.74 [s]
[2024-09-26 18:58:06,772][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 18:58:06,773][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 18:58:09,577][root][INFO] - Step: 495/960  |  Loss: 0.6705  |  Score: 84.57 [%]  |  Seq Length: 256.0
[2024-09-26 18:58:10,544][root][INFO] - Step: 420/1035  |  Loss: 0.6350  |  Score: 83.12 [%]  |  Seq Length: 256.0
[2024-09-26 18:58:15,962][root][INFO] - Step: 15/1350  |  Loss: 3.7600  |  Score: -3.33 [%]  |  Seq Length: 256.0
[2024-09-26 18:58:17,289][root][INFO] - Step: 510/960  |  Loss: 0.6290  |  Score: 83.93 [%]  |  Seq Length: 256.0
[2024-09-26 18:58:18,384][root][INFO] - Step: 512/960  |  Loss: 0.4276  |  Score: 91.03 [%]  |  Seq Length: 256.0
[2024-09-26 18:58:18,577][root][INFO] - Step: 435/1035  |  Loss: 0.6093  |  Score: 83.80 [%]  |  Seq Length: 256.0
[2024-09-26 18:58:22,978][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 18:58:22,979][root][INFO] - Score: 78.60 [%]  |  Evaluation Time: 4.59 [s]
[2024-09-26 18:58:23,637][root][INFO] - Step: 30/1350  |  Loss: 2.2436  |  Score: 17.34 [%]  |  Seq Length: 256.0
[2024-09-26 18:58:26,533][root][INFO] - Step: 450/1035  |  Loss: 0.6528  |  Score: 81.23 [%]  |  Seq Length: 256.0
[2024-09-26 18:58:27,508][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 18:58:27,509][root][INFO] - Score: 71.15 [%]  |  Evaluation Time: 4.53 [s]
[2024-09-26 18:58:27,511][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 18:58:31,426][root][INFO] - Step: 45/1350  |  Loss: 1.8063  |  Score: 34.56 [%]  |  Seq Length: 256.0
[2024-09-26 18:58:34,491][root][INFO] - Step: 465/1035  |  Loss: 0.6854  |  Score: 81.36 [%]  |  Seq Length: 256.0
[2024-09-26 18:58:34,800][root][INFO] - Step: 525/960  |  Loss: 0.5228  |  Score: 86.20 [%]  |  Seq Length: 256.0
[2024-09-26 18:58:39,172][root][INFO] - Step: 60/1350  |  Loss: 1.7750  |  Score: 50.56 [%]  |  Seq Length: 256.0
[2024-09-26 18:58:42,445][root][INFO] - Step: 480/1035  |  Loss: 0.6039  |  Score: 84.48 [%]  |  Seq Length: 256.0
[2024-09-26 18:58:42,594][root][INFO] - Step: 540/960  |  Loss: 0.5016  |  Score: 87.94 [%]  |  Seq Length: 256.0
[2024-09-26 18:58:44,092][root][INFO] - Step: 483/1035  |  Loss: 0.6696  |  Score: 83.86 [%]  |  Seq Length: 256.0
[2024-09-26 18:58:46,891][root][INFO] - Step: 75/1350  |  Loss: 1.6069  |  Score: 55.14 [%]  |  Seq Length: 256.0
[2024-09-26 18:58:49,261][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 18:58:49,262][root][INFO] - Score: 77.28 [%]  |  Evaluation Time: 5.17 [s]
[2024-09-26 18:58:50,322][root][INFO] - Step: 555/960  |  Loss: 0.4819  |  Score: 87.55 [%]  |  Seq Length: 256.0
[2024-09-26 18:58:53,996][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 18:58:53,996][root][INFO] - Score: 70.58 [%]  |  Evaluation Time: 4.73 [s]
[2024-09-26 18:58:53,999][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 18:58:54,703][root][INFO] - Step: 90/1350  |  Loss: 1.5137  |  Score: 54.97 [%]  |  Seq Length: 256.0
[2024-09-26 18:58:58,077][root][INFO] - Step: 570/960  |  Loss: 0.5441  |  Score: 84.65 [%]  |  Seq Length: 256.0
[2024-09-26 18:59:00,843][root][INFO] - Step: 495/1035  |  Loss: 0.5304  |  Score: 85.89 [%]  |  Seq Length: 256.0
[2024-09-26 18:59:00,870][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 18:59:00,870][root][INFO] - Score: 70.01 [%]  |  Evaluation Time: 6.16 [s]
[2024-09-26 18:59:01,229][root][INFO] - Step: 576/960  |  Loss: 0.5389  |  Score: 87.57 [%]  |  Seq Length: 256.0
[2024-09-26 18:59:05,994][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 18:59:05,994][root][INFO] - Score: 79.33 [%]  |  Evaluation Time: 4.76 [s]
[2024-09-26 18:59:06,466][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 18:59:06,466][root][INFO] - Score: 62.46 [%]  |  Evaluation Time: 5.59 [s]
[2024-09-26 18:59:06,467][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 18:59:06,469][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 18:59:07,355][root][INFO] - Step: 91/1350  |  Loss: 1.7827  |  Score: 64.91 [%]  |  Seq Length: 256.0
[2024-09-26 18:59:08,792][root][INFO] - Step: 510/1035  |  Loss: 0.5560  |  Score: 84.40 [%]  |  Seq Length: 256.0
[2024-09-26 18:59:10,476][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 18:59:10,476][root][INFO] - Score: 71.02 [%]  |  Evaluation Time: 4.48 [s]
[2024-09-26 18:59:10,477][root][INFO] - 
Save new Best Score (Epoch: 9)
[2024-09-26 18:59:10,478][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 18:59:14,582][root][INFO] - Step: 105/1350  |  Loss: 1.4442  |  Score: 59.01 [%]  |  Seq Length: 256.0
[2024-09-26 18:59:15,756][root][INFO] - Step: 585/960  |  Loss: 0.4771  |  Score: 88.55 [%]  |  Seq Length: 256.0
[2024-09-26 18:59:16,757][root][INFO] - Step: 525/1035  |  Loss: 0.6597  |  Score: 84.53 [%]  |  Seq Length: 256.0
[2024-09-26 18:59:22,307][root][INFO] - Step: 120/1350  |  Loss: 1.1770  |  Score: 63.33 [%]  |  Seq Length: 256.0
[2024-09-26 18:59:23,531][root][INFO] - Step: 600/960  |  Loss: 0.4623  |  Score: 88.70 [%]  |  Seq Length: 256.0
[2024-09-26 18:59:24,768][root][INFO] - Step: 540/1035  |  Loss: 0.5645  |  Score: 84.94 [%]  |  Seq Length: 256.0
[2024-09-26 18:59:30,033][root][INFO] - Step: 135/1350  |  Loss: 1.2198  |  Score: 63.71 [%]  |  Seq Length: 256.0
[2024-09-26 18:59:31,184][root][INFO] - Step: 552/1035  |  Loss: 0.6117  |  Score: 83.20 [%]  |  Seq Length: 256.0
[2024-09-26 18:59:31,279][root][INFO] - Step: 615/960  |  Loss: 0.4352  |  Score: 88.11 [%]  |  Seq Length: 256.0
[2024-09-26 18:59:36,379][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 18:59:36,380][root][INFO] - Score: 77.99 [%]  |  Evaluation Time: 5.19 [s]
[2024-09-26 18:59:37,778][root][INFO] - Step: 150/1350  |  Loss: 1.1481  |  Score: 63.92 [%]  |  Seq Length: 256.0
[2024-09-26 18:59:39,033][root][INFO] - Step: 630/960  |  Loss: 0.4455  |  Score: 87.88 [%]  |  Seq Length: 256.0
[2024-09-26 18:59:41,168][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 18:59:41,168][root][INFO] - Score: 69.73 [%]  |  Evaluation Time: 4.79 [s]
[2024-09-26 18:59:41,171][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 18:59:43,169][root][INFO] - Step: 555/1035  |  Loss: 0.4681  |  Score: 87.68 [%]  |  Seq Length: 256.0
[2024-09-26 18:59:44,250][root][INFO] - Step: 640/960  |  Loss: 0.5056  |  Score: 85.75 [%]  |  Seq Length: 256.0
[2024-09-26 18:59:45,513][root][INFO] - Step: 165/1350  |  Loss: 1.1921  |  Score: 65.79 [%]  |  Seq Length: 256.0
[2024-09-26 18:59:49,024][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 18:59:49,025][root][INFO] - Score: 76.88 [%]  |  Evaluation Time: 4.77 [s]
[2024-09-26 18:59:51,295][root][INFO] - Step: 570/1035  |  Loss: 0.4622  |  Score: 87.44 [%]  |  Seq Length: 256.0
[2024-09-26 18:59:53,228][root][INFO] - Step: 180/1350  |  Loss: 1.2176  |  Score: 66.16 [%]  |  Seq Length: 256.0
[2024-09-26 18:59:53,471][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 18:59:53,471][root][INFO] - Score: 71.02 [%]  |  Evaluation Time: 4.44 [s]
[2024-09-26 18:59:53,474][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 18:59:56,404][root][INFO] - Step: 645/960  |  Loss: 0.3830  |  Score: 88.75 [%]  |  Seq Length: 256.0
[2024-09-26 18:59:59,308][root][INFO] - Step: 585/1035  |  Loss: 0.5269  |  Score: 86.84 [%]  |  Seq Length: 256.0
[2024-09-26 18:59:59,561][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 18:59:59,561][root][INFO] - Score: 74.56 [%]  |  Evaluation Time: 6.33 [s]
[2024-09-26 19:00:04,169][root][INFO] - Step: 660/960  |  Loss: 0.4046  |  Score: 88.31 [%]  |  Seq Length: 256.0
[2024-09-26 19:00:05,309][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 19:00:05,309][root][INFO] - Score: 68.30 [%]  |  Evaluation Time: 5.75 [s]
[2024-09-26 19:00:05,310][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 19:00:05,312][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 19:00:06,363][root][INFO] - Step: 181/1350  |  Loss: 1.2716  |  Score: 76.94 [%]  |  Seq Length: 256.0
[2024-09-26 19:00:07,235][root][INFO] - Step: 600/1035  |  Loss: 0.5148  |  Score: 84.86 [%]  |  Seq Length: 256.0
[2024-09-26 19:00:11,897][root][INFO] - Step: 675/960  |  Loss: 0.4273  |  Score: 89.87 [%]  |  Seq Length: 256.0
[2024-09-26 19:00:13,389][root][INFO] - Step: 195/1350  |  Loss: 1.3925  |  Score: 64.35 [%]  |  Seq Length: 256.0
[2024-09-26 19:00:15,131][root][INFO] - Step: 615/1035  |  Loss: 0.4717  |  Score: 86.42 [%]  |  Seq Length: 256.0
[2024-09-26 19:00:18,349][root][INFO] - Step: 621/1035  |  Loss: 0.5526  |  Score: 84.96 [%]  |  Seq Length: 256.0
[2024-09-26 19:00:19,640][root][INFO] - Step: 690/960  |  Loss: 0.4154  |  Score: 88.73 [%]  |  Seq Length: 256.0
[2024-09-26 19:00:20,870][root][INFO] - Step: 210/1350  |  Loss: 1.3985  |  Score: 65.71 [%]  |  Seq Length: 256.0
[2024-09-26 19:00:23,373][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 19:00:23,373][root][INFO] - Score: 77.32 [%]  |  Evaluation Time: 5.02 [s]
[2024-09-26 19:00:26,955][root][INFO] - Step: 704/960  |  Loss: 0.4096  |  Score: 89.03 [%]  |  Seq Length: 256.0
[2024-09-26 19:00:28,185][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 19:00:28,185][root][INFO] - Score: 70.33 [%]  |  Evaluation Time: 4.81 [s]
[2024-09-26 19:00:28,187][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 19:00:28,357][root][INFO] - Step: 225/1350  |  Loss: 1.1628  |  Score: 67.03 [%]  |  Seq Length: 256.0
[2024-09-26 19:00:31,642][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 19:00:31,643][root][INFO] - Score: 78.24 [%]  |  Evaluation Time: 4.68 [s]
[2024-09-26 19:00:33,291][root][INFO] - Step: 630/1035  |  Loss: 0.4623  |  Score: 86.34 [%]  |  Seq Length: 256.0
[2024-09-26 19:00:36,009][root][INFO] - Step: 240/1350  |  Loss: 1.0360  |  Score: 66.57 [%]  |  Seq Length: 256.0
[2024-09-26 19:00:36,035][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 19:00:36,035][root][INFO] - Score: 71.27 [%]  |  Evaluation Time: 4.39 [s]
[2024-09-26 19:00:36,038][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 19:00:37,002][root][INFO] - Step: 705/960  |  Loss: 0.3585  |  Score: 89.40 [%]  |  Seq Length: 256.0
[2024-09-26 19:00:41,283][root][INFO] - Step: 645/1035  |  Loss: 0.4129  |  Score: 89.57 [%]  |  Seq Length: 256.0
[2024-09-26 19:00:43,652][root][INFO] - Step: 255/1350  |  Loss: 1.1118  |  Score: 68.66 [%]  |  Seq Length: 256.0
[2024-09-26 19:00:44,876][root][INFO] - Step: 720/960  |  Loss: 0.3998  |  Score: 90.00 [%]  |  Seq Length: 256.0
[2024-09-26 19:00:49,217][root][INFO] - Step: 660/1035  |  Loss: 0.4478  |  Score: 87.17 [%]  |  Seq Length: 256.0
[2024-09-26 19:00:51,453][root][INFO] - Step: 270/1350  |  Loss: 0.9560  |  Score: 72.63 [%]  |  Seq Length: 256.0
[2024-09-26 19:00:52,737][root][INFO] - Step: 735/960  |  Loss: 0.4156  |  Score: 89.08 [%]  |  Seq Length: 256.0
[2024-09-26 19:00:57,260][root][INFO] - Step: 675/1035  |  Loss: 0.4291  |  Score: 88.09 [%]  |  Seq Length: 256.0
[2024-09-26 19:00:57,653][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 19:00:57,654][root][INFO] - Score: 76.18 [%]  |  Evaluation Time: 6.20 [s]
[2024-09-26 19:01:00,476][root][INFO] - Step: 750/960  |  Loss: 0.3770  |  Score: 89.79 [%]  |  Seq Length: 256.0
[2024-09-26 19:01:03,302][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 19:01:03,302][root][INFO] - Score: 68.44 [%]  |  Evaluation Time: 5.65 [s]
[2024-09-26 19:01:03,303][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 19:01:03,304][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 19:01:04,371][root][INFO] - Step: 271/1350  |  Loss: 0.9152  |  Score: 61.71 [%]  |  Seq Length: 256.0
[2024-09-26 19:01:05,267][root][INFO] - Step: 690/1035  |  Loss: 0.4480  |  Score: 86.47 [%]  |  Seq Length: 256.0
[2024-09-26 19:01:08,206][root][INFO] - Step: 765/960  |  Loss: 0.3912  |  Score: 90.05 [%]  |  Seq Length: 256.0
[2024-09-26 19:01:09,817][root][INFO] - Step: 768/960  |  Loss: 0.4425  |  Score: 88.35 [%]  |  Seq Length: 256.0
[2024-09-26 19:01:10,479][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 19:01:10,480][root][INFO] - Score: 78.02 [%]  |  Evaluation Time: 5.21 [s]
[2024-09-26 19:01:11,668][root][INFO] - Step: 285/1350  |  Loss: 0.8898  |  Score: 72.99 [%]  |  Seq Length: 256.0
[2024-09-26 19:01:14,482][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 19:01:14,482][root][INFO] - Score: 78.79 [%]  |  Evaluation Time: 4.66 [s]
[2024-09-26 19:01:15,254][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 19:01:15,254][root][INFO] - Score: 71.83 [%]  |  Evaluation Time: 4.77 [s]
[2024-09-26 19:01:15,257][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 19:01:16,295][root][INFO] - Step: 691/1035  |  Loss: 0.4648  |  Score: 87.72 [%]  |  Seq Length: 256.0
[2024-09-26 19:01:19,029][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 19:01:19,029][root][INFO] - Score: 71.10 [%]  |  Evaluation Time: 4.54 [s]
[2024-09-26 19:01:19,031][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 19:01:19,452][root][INFO] - Step: 300/1350  |  Loss: 1.1003  |  Score: 72.82 [%]  |  Seq Length: 256.0
[2024-09-26 19:01:23,748][root][INFO] - Step: 705/1035  |  Loss: 0.3642  |  Score: 89.47 [%]  |  Seq Length: 256.0
[2024-09-26 19:01:26,014][root][INFO] - Step: 780/960  |  Loss: 0.3497  |  Score: 90.12 [%]  |  Seq Length: 256.0
[2024-09-26 19:01:27,187][root][INFO] - Step: 315/1350  |  Loss: 0.9192  |  Score: 73.64 [%]  |  Seq Length: 256.0
[2024-09-26 19:01:31,705][root][INFO] - Step: 720/1035  |  Loss: 0.4082  |  Score: 89.20 [%]  |  Seq Length: 256.0
[2024-09-26 19:01:33,817][root][INFO] - Step: 795/960  |  Loss: 0.3525  |  Score: 90.54 [%]  |  Seq Length: 256.0
[2024-09-26 19:01:34,697][root][INFO] - Step: 330/1350  |  Loss: 0.8564  |  Score: 72.07 [%]  |  Seq Length: 256.0
[2024-09-26 19:01:39,659][root][INFO] - Step: 735/1035  |  Loss: 0.3812  |  Score: 89.07 [%]  |  Seq Length: 256.0
[2024-09-26 19:01:41,548][root][INFO] - Step: 810/960  |  Loss: 0.3309  |  Score: 90.34 [%]  |  Seq Length: 256.0
[2024-09-26 19:01:42,150][root][INFO] - Step: 345/1350  |  Loss: 1.0178  |  Score: 69.89 [%]  |  Seq Length: 256.0
[2024-09-26 19:01:47,586][root][INFO] - Step: 750/1035  |  Loss: 0.4110  |  Score: 89.18 [%]  |  Seq Length: 256.0
[2024-09-26 19:01:49,285][root][INFO] - Step: 825/960  |  Loss: 0.3831  |  Score: 88.97 [%]  |  Seq Length: 256.0
[2024-09-26 19:01:49,702][root][INFO] - Step: 360/1350  |  Loss: 0.9900  |  Score: 71.54 [%]  |  Seq Length: 256.0
[2024-09-26 19:01:52,427][root][INFO] - Step: 759/1035  |  Loss: 0.3996  |  Score: 89.35 [%]  |  Seq Length: 256.0
[2024-09-26 19:01:53,003][root][INFO] - Step: 832/960  |  Loss: 0.3638  |  Score: 90.95 [%]  |  Seq Length: 256.0
[2024-09-26 19:01:55,950][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 19:01:55,950][root][INFO] - Score: 76.48 [%]  |  Evaluation Time: 6.24 [s]
[2024-09-26 19:01:57,709][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 19:01:57,709][root][INFO] - Score: 77.01 [%]  |  Evaluation Time: 5.28 [s]
[2024-09-26 19:01:57,784][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 19:01:57,784][root][INFO] - Score: 76.23 [%]  |  Evaluation Time: 4.78 [s]
[2024-09-26 19:02:01,697][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 19:02:01,697][root][INFO] - Score: 69.17 [%]  |  Evaluation Time: 5.74 [s]
[2024-09-26 19:02:01,698][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-26 19:02:01,699][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 19:02:02,292][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 19:02:02,292][root][INFO] - Score: 70.76 [%]  |  Evaluation Time: 4.51 [s]
[2024-09-26 19:02:02,296][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 19:02:02,561][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 19:02:02,562][root][INFO] - Score: 69.93 [%]  |  Evaluation Time: 4.85 [s]
[2024-09-26 19:02:02,564][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 19:02:02,863][root][INFO] - Step: 361/1350  |  Loss: 0.8158  |  Score: 71.62 [%]  |  Seq Length: 256.0
[2024-09-26 19:02:06,111][root][INFO] - Step: 765/1035  |  Loss: 0.3655  |  Score: 87.23 [%]  |  Seq Length: 256.0
[2024-09-26 19:02:06,959][root][INFO] - Step: 840/960  |  Loss: 0.3477  |  Score: 91.74 [%]  |  Seq Length: 256.0
[2024-09-26 19:02:10,102][root][INFO] - Step: 375/1350  |  Loss: 0.8305  |  Score: 76.54 [%]  |  Seq Length: 256.0
[2024-09-26 19:02:14,103][root][INFO] - Step: 780/1035  |  Loss: 0.3792  |  Score: 89.37 [%]  |  Seq Length: 256.0
[2024-09-26 19:02:14,711][root][INFO] - Step: 855/960  |  Loss: 0.3548  |  Score: 89.64 [%]  |  Seq Length: 256.0
[2024-09-26 19:02:17,799][root][INFO] - Step: 390/1350  |  Loss: 0.9278  |  Score: 79.22 [%]  |  Seq Length: 256.0
[2024-09-26 19:02:22,066][root][INFO] - Step: 795/1035  |  Loss: 0.3796  |  Score: 89.57 [%]  |  Seq Length: 256.0
[2024-09-26 19:02:22,469][root][INFO] - Step: 870/960  |  Loss: 0.3620  |  Score: 90.30 [%]  |  Seq Length: 256.0
[2024-09-26 19:02:25,544][root][INFO] - Step: 405/1350  |  Loss: 0.8437  |  Score: 74.12 [%]  |  Seq Length: 256.0
[2024-09-26 19:02:29,997][root][INFO] - Step: 810/1035  |  Loss: 0.3793  |  Score: 90.09 [%]  |  Seq Length: 256.0
[2024-09-26 19:02:30,184][root][INFO] - Step: 885/960  |  Loss: 0.3735  |  Score: 89.04 [%]  |  Seq Length: 256.0
[2024-09-26 19:02:33,251][root][INFO] - Step: 420/1350  |  Loss: 0.8843  |  Score: 73.26 [%]  |  Seq Length: 256.0
[2024-09-26 19:02:35,892][root][INFO] - Step: 896/960  |  Loss: 0.3354  |  Score: 89.41 [%]  |  Seq Length: 256.0
[2024-09-26 19:02:37,913][root][INFO] - Step: 825/1035  |  Loss: 0.4010  |  Score: 88.90 [%]  |  Seq Length: 256.0
[2024-09-26 19:02:39,558][root][INFO] - Step: 828/1035  |  Loss: 0.3051  |  Score: 91.56 [%]  |  Seq Length: 256.0
[2024-09-26 19:02:40,519][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 19:02:40,520][root][INFO] - Score: 76.59 [%]  |  Evaluation Time: 4.62 [s]
[2024-09-26 19:02:40,970][root][INFO] - Step: 435/1350  |  Loss: 0.8286  |  Score: 76.40 [%]  |  Seq Length: 256.0
[2024-09-26 19:02:44,693][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 19:02:44,694][root][INFO] - Score: 78.66 [%]  |  Evaluation Time: 5.13 [s]
[2024-09-26 19:02:45,160][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 19:02:45,161][root][INFO] - Score: 71.47 [%]  |  Evaluation Time: 4.64 [s]
[2024-09-26 19:02:45,163][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 19:02:47,715][root][INFO] - Step: 900/960  |  Loss: 0.3238  |  Score: 91.54 [%]  |  Seq Length: 256.0
[2024-09-26 19:02:48,733][root][INFO] - Step: 450/1350  |  Loss: 0.8079  |  Score: 75.47 [%]  |  Seq Length: 256.0
[2024-09-26 19:02:49,431][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 19:02:49,431][root][INFO] - Score: 71.28 [%]  |  Evaluation Time: 4.74 [s]
[2024-09-26 19:02:49,433][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 19:02:54,900][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 19:02:54,901][root][INFO] - Score: 78.15 [%]  |  Evaluation Time: 6.16 [s]
[2024-09-26 19:02:55,459][root][INFO] - Step: 915/960  |  Loss: 0.3720  |  Score: 89.58 [%]  |  Seq Length: 256.0
[2024-09-26 19:02:56,318][root][INFO] - Step: 840/1035  |  Loss: 0.3662  |  Score: 89.71 [%]  |  Seq Length: 256.0
[2024-09-26 19:03:00,736][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 19:03:00,736][root][INFO] - Score: 70.07 [%]  |  Evaluation Time: 5.83 [s]
[2024-09-26 19:03:00,738][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 19:03:00,739][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 19:03:01,871][root][INFO] - Step: 451/1350  |  Loss: 0.8680  |  Score: 81.89 [%]  |  Seq Length: 256.0
[2024-09-26 19:03:03,189][root][INFO] - Step: 930/960  |  Loss: 0.3286  |  Score: 90.45 [%]  |  Seq Length: 256.0
[2024-09-26 19:03:04,254][root][INFO] - Step: 855/1035  |  Loss: 0.3483  |  Score: 90.45 [%]  |  Seq Length: 256.0
[2024-09-26 19:03:09,053][root][INFO] - Step: 465/1350  |  Loss: 0.7798  |  Score: 78.58 [%]  |  Seq Length: 256.0
[2024-09-26 19:03:10,933][root][INFO] - Step: 945/960  |  Loss: 0.3524  |  Score: 89.63 [%]  |  Seq Length: 256.0
[2024-09-26 19:03:12,192][root][INFO] - Step: 870/1035  |  Loss: 0.3761  |  Score: 88.49 [%]  |  Seq Length: 256.0
[2024-09-26 19:03:16,782][root][INFO] - Step: 480/1350  |  Loss: 0.6896  |  Score: 81.40 [%]  |  Seq Length: 256.0
[2024-09-26 19:03:18,760][root][INFO] - Step: 960/960  |  Loss: 0.3465  |  Score: 89.70 [%]  |  Seq Length: 256.0
[2024-09-26 19:03:20,123][root][INFO] - Step: 885/1035  |  Loss: 0.3359  |  Score: 90.46 [%]  |  Seq Length: 256.0
[2024-09-26 19:03:23,387][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 19:03:23,387][root][INFO] - Score: 77.92 [%]  |  Evaluation Time: 4.62 [s]
[2024-09-26 19:03:24,538][root][INFO] - Step: 495/1350  |  Loss: 0.8109  |  Score: 78.06 [%]  |  Seq Length: 256.0
[2024-09-26 19:03:26,478][root][INFO] - Step: 897/1035  |  Loss: 0.3452  |  Score: 89.89 [%]  |  Seq Length: 256.0
[2024-09-26 19:03:27,892][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 19:03:27,893][root][INFO] - Score: 71.12 [%]  |  Evaluation Time: 4.50 [s]
[2024-09-26 19:03:27,894][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 19:03:27,894][root][INFO] - - Epoch: 9
[2024-09-26 19:03:27,894][root][INFO] - - DEV score: 79.33 [%]
[2024-09-26 19:03:27,894][root][INFO] - - TEST score: 71.02 [%]
[2024-09-26 19:03:27,895][root][INFO] - Fine-tuning is done!
[2024-09-26 19:03:31,838][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 19:03:31,838][root][INFO] - Score: 76.90 [%]  |  Evaluation Time: 5.36 [s]
[2024-09-26 19:03:32,353][root][INFO] - Step: 510/1350  |  Loss: 0.7996  |  Score: 76.63 [%]  |  Seq Length: 256.0
[2024-09-26 19:03:34,754][root][INFO] - 

[2024-09-26 19:03:34,754][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 19:03:34,754][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:03:34,754][root][INFO] - 

[2024-09-26 19:03:34,754][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_punc', 'do_hangeulize': True, 'data_remove': False, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 19:03:36,751][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 19:03:36,752][root][INFO] - Score: 70.53 [%]  |  Evaluation Time: 4.91 [s]
[2024-09-26 19:03:36,754][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 19:03:38,836][root][INFO] - Step: 900/1035  |  Loss: 0.3494  |  Score: 90.69 [%]  |  Seq Length: 256.0
[2024-09-26 19:03:39,688][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 19:03:39,688][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 19:03:39,689][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 19:03:39,689][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 19:03:39,690][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 19:03:39,690][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 19:03:39,691][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 19:03:39,691][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 19:03:39,692][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 19:03:39,692][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 19:03:39,693][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 19:03:39,693][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 19:03:39,693][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 19:03:39,694][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 19:03:39,694][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 19:03:39,695][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 19:03:39,695][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 19:03:39,695][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 19:03:39,696][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 19:03:39,696][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 19:03:39,697][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 19:03:39,697][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 19:03:39,698][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 19:03:39,698][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 19:03:39,700][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 19:03:39,872][root][INFO] - Step: 525/1350  |  Loss: 0.7560  |  Score: 78.14 [%]  |  Seq Length: 256.0
[2024-09-26 19:03:39,877][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 19:03:44,259][root][INFO] - 

[2024-09-26 19:03:44,259][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 19:03:44,259][root][INFO] - Data Preprocessing
[2024-09-26 19:03:44,259][root][INFO] - ㄴ remain_lang                ko_punc
[2024-09-26 19:03:44,259][root][INFO] - ㄴ do_hangeulize              True
[2024-09-26 19:03:44,260][root][INFO] - ㄴ data_remove                False

[2024-09-26 19:03:44,260][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 19:03:44,269][root][INFO] - vocab size              : 51200
[2024-09-26 19:03:44,269][root][INFO] - device                  : gpu
[2024-09-26 19:03:44,270][root][INFO] - random seed             : 42
[2024-09-26 19:03:44,270][root][INFO] - train data size         : 5760
[2024-09-26 19:03:44,270][root][INFO] - max epochs              : 15
[2024-09-26 19:03:44,270][root][INFO] - total steps             : 1350
[2024-09-26 19:03:44,270][root][INFO] - warmup steps            : 135
[2024-09-26 19:03:44,270][root][INFO] - batch size              : 64
[2024-09-26 19:03:44,270][root][INFO] - accumulation steps      : 1
[2024-09-26 19:03:44,270][root][INFO] - optimizer               : adamwscale
[2024-09-26 19:03:44,270][root][INFO] - lr_scheduler            : cosine
[2024-09-26 19:03:44,270][root][INFO] - learning rate           : 0.01
[2024-09-26 19:03:44,270][root][INFO] - max length              : 256

[2024-09-26 19:03:44,270][root][INFO] - LoRA Configuration
[2024-09-26 19:03:44,271][root][INFO] - ㄴ r                    : 32
[2024-09-26 19:03:44,271][root][INFO] - ㄴ alpha                : 128
[2024-09-26 19:03:44,271][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 19:03:44,271][root][INFO] - 

[2024-09-26 19:03:44,271][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:03:44,271][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 19:03:44,271][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 19:03:44,271][root][INFO] - * tb interval   : 15

[2024-09-26 19:03:44,271][root][INFO] - 

[2024-09-26 19:03:44,271][root][INFO] - Start the Training !
[2024-09-26 19:03:44,274][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 19:03:46,792][root][INFO] - Step: 915/1035  |  Loss: 0.3324  |  Score: 90.21 [%]  |  Seq Length: 256.0
[2024-09-26 19:03:47,451][root][INFO] - Step: 540/1350  |  Loss: 0.7418  |  Score: 78.84 [%]  |  Seq Length: 256.0
[2024-09-26 19:03:52,774][root][INFO] - Step: 15/1350  |  Loss: 3.2456  |  Score: 2.57 [%]  |  Seq Length: 256.0
[2024-09-26 19:03:53,706][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 19:03:53,706][root][INFO] - Score: 77.85 [%]  |  Evaluation Time: 6.25 [s]
[2024-09-26 19:03:54,709][root][INFO] - Step: 930/1035  |  Loss: 0.3501  |  Score: 90.62 [%]  |  Seq Length: 256.0
[2024-09-26 19:03:58,318][root][INFO] - Step: 30/1350  |  Loss: 2.2874  |  Score: 18.61 [%]  |  Seq Length: 256.0
[2024-09-26 19:03:59,274][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 19:03:59,274][root][INFO] - Score: 69.46 [%]  |  Evaluation Time: 5.57 [s]
[2024-09-26 19:03:59,276][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 19:04:00,186][root][INFO] - Step: 541/1350  |  Loss: 0.7914  |  Score: 80.83 [%]  |  Seq Length: 256.0
[2024-09-26 19:04:02,676][root][INFO] - Step: 945/1035  |  Loss: 0.3169  |  Score: 90.93 [%]  |  Seq Length: 256.0
[2024-09-26 19:04:03,920][root][INFO] - Step: 45/1350  |  Loss: 2.0279  |  Score: 28.88 [%]  |  Seq Length: 256.0
[2024-09-26 19:04:07,398][root][INFO] - Step: 555/1350  |  Loss: 0.5957  |  Score: 80.45 [%]  |  Seq Length: 256.0
[2024-09-26 19:04:09,511][root][INFO] - Step: 60/1350  |  Loss: 1.6951  |  Score: 48.47 [%]  |  Seq Length: 256.0
[2024-09-26 19:04:10,564][root][INFO] - Step: 960/1035  |  Loss: 0.3625  |  Score: 89.78 [%]  |  Seq Length: 256.0
[2024-09-26 19:04:13,809][root][INFO] - Step: 966/1035  |  Loss: 0.3216  |  Score: 91.37 [%]  |  Seq Length: 256.0
[2024-09-26 19:04:15,063][root][INFO] - Step: 75/1350  |  Loss: 1.4593  |  Score: 57.70 [%]  |  Seq Length: 256.0
[2024-09-26 19:04:15,185][root][INFO] - Step: 570/1350  |  Loss: 0.6734  |  Score: 79.46 [%]  |  Seq Length: 256.0
[2024-09-26 19:04:18,891][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 19:04:18,892][root][INFO] - Score: 77.65 [%]  |  Evaluation Time: 5.08 [s]
[2024-09-26 19:04:20,641][root][INFO] - Step: 90/1350  |  Loss: 1.4670  |  Score: 55.73 [%]  |  Seq Length: 256.0
[2024-09-26 19:04:22,880][root][INFO] - Step: 585/1350  |  Loss: 0.6027  |  Score: 81.97 [%]  |  Seq Length: 256.0
[2024-09-26 19:04:23,654][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 19:04:23,654][root][INFO] - Score: 70.59 [%]  |  Evaluation Time: 4.76 [s]
[2024-09-26 19:04:23,656][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 19:04:24,614][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 19:04:24,615][root][INFO] - Score: 70.99 [%]  |  Evaluation Time: 3.97 [s]
[2024-09-26 19:04:28,274][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 19:04:28,274][root][INFO] - Score: 65.09 [%]  |  Evaluation Time: 3.66 [s]
[2024-09-26 19:04:28,275][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 19:04:28,277][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 19:04:28,888][root][INFO] - Step: 975/1035  |  Loss: 0.3310  |  Score: 90.70 [%]  |  Seq Length: 256.0
[2024-09-26 19:04:29,022][root][INFO] - Step: 91/1350  |  Loss: 1.1761  |  Score: 69.50 [%]  |  Seq Length: 256.0
[2024-09-26 19:04:30,570][root][INFO] - Step: 600/1350  |  Loss: 0.6229  |  Score: 81.29 [%]  |  Seq Length: 256.0
[2024-09-26 19:04:34,211][root][INFO] - Step: 105/1350  |  Loss: 1.4204  |  Score: 61.76 [%]  |  Seq Length: 256.0
[2024-09-26 19:04:36,835][root][INFO] - Step: 990/1035  |  Loss: 0.3157  |  Score: 90.96 [%]  |  Seq Length: 256.0
[2024-09-26 19:04:38,362][root][INFO] - Step: 615/1350  |  Loss: 0.6788  |  Score: 81.02 [%]  |  Seq Length: 256.0
[2024-09-26 19:04:39,770][root][INFO] - Step: 120/1350  |  Loss: 1.3433  |  Score: 63.48 [%]  |  Seq Length: 256.0
[2024-09-26 19:04:44,837][root][INFO] - Step: 1005/1035  |  Loss: 0.3225  |  Score: 90.92 [%]  |  Seq Length: 256.0
[2024-09-26 19:04:45,331][root][INFO] - Step: 135/1350  |  Loss: 1.2215  |  Score: 64.05 [%]  |  Seq Length: 256.0
[2024-09-26 19:04:46,151][root][INFO] - Step: 630/1350  |  Loss: 0.6759  |  Score: 78.69 [%]  |  Seq Length: 256.0
[2024-09-26 19:04:50,894][root][INFO] - Step: 150/1350  |  Loss: 1.1742  |  Score: 67.06 [%]  |  Seq Length: 256.0
[2024-09-26 19:04:52,577][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 19:04:52,578][root][INFO] - Score: 77.94 [%]  |  Evaluation Time: 6.42 [s]
[2024-09-26 19:04:52,647][root][INFO] - Step: 1020/1035  |  Loss: 0.3343  |  Score: 89.04 [%]  |  Seq Length: 256.0
[2024-09-26 19:04:56,464][root][INFO] - Step: 165/1350  |  Loss: 1.2849  |  Score: 64.00 [%]  |  Seq Length: 256.0
[2024-09-26 19:04:58,408][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 19:04:58,408][root][INFO] - Score: 71.70 [%]  |  Evaluation Time: 5.83 [s]
[2024-09-26 19:04:58,409][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-26 19:04:58,410][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 19:04:59,385][root][INFO] - Step: 631/1350  |  Loss: 0.4717  |  Score: 87.95 [%]  |  Seq Length: 256.0
[2024-09-26 19:05:00,426][root][INFO] - Step: 1035/1035  |  Loss: 0.3596  |  Score: 90.36 [%]  |  Seq Length: 256.0
[2024-09-26 19:05:02,075][root][INFO] - Step: 180/1350  |  Loss: 1.4557  |  Score: 62.28 [%]  |  Seq Length: 256.0
[2024-09-26 19:05:05,616][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 19:05:05,617][root][INFO] - Score: 77.65 [%]  |  Evaluation Time: 5.19 [s]
[2024-09-26 19:05:05,971][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 19:05:05,972][root][INFO] - Score: 74.76 [%]  |  Evaluation Time: 3.89 [s]
[2024-09-26 19:05:06,532][root][INFO] - Step: 645/1350  |  Loss: 0.5273  |  Score: 84.84 [%]  |  Seq Length: 256.0
[2024-09-26 19:05:09,616][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 19:05:09,616][root][INFO] - Score: 65.20 [%]  |  Evaluation Time: 3.64 [s]
[2024-09-26 19:05:09,617][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 19:05:09,619][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 19:05:10,400][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 19:05:10,400][root][INFO] - Score: 71.30 [%]  |  Evaluation Time: 4.78 [s]
[2024-09-26 19:05:10,401][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 19:05:10,401][root][INFO] - - Epoch: 6
[2024-09-26 19:05:10,401][root][INFO] - - DEV score: 78.59 [%]
[2024-09-26 19:05:10,401][root][INFO] - - TEST score: 71.75 [%]
[2024-09-26 19:05:10,402][root][INFO] - Fine-tuning is done!
[2024-09-26 19:05:10,419][root][INFO] - Step: 181/1350  |  Loss: 1.2122  |  Score: 71.13 [%]  |  Seq Length: 256.0
[2024-09-26 19:05:14,277][root][INFO] - Step: 660/1350  |  Loss: 0.5733  |  Score: 84.84 [%]  |  Seq Length: 256.0
[2024-09-26 19:05:15,635][root][INFO] - Step: 195/1350  |  Loss: 1.0990  |  Score: 67.84 [%]  |  Seq Length: 256.0
[2024-09-26 19:05:16,945][root][INFO] - 

[2024-09-26 19:05:16,945][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 19:05:16,945][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:05:16,945][root][INFO] - 

[2024-09-26 19:05:16,945][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': False, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 19:05:21,214][root][INFO] - Step: 210/1350  |  Loss: 1.0977  |  Score: 69.60 [%]  |  Seq Length: 256.0
[2024-09-26 19:05:21,965][root][INFO] - Step: 675/1350  |  Loss: 0.6012  |  Score: 82.37 [%]  |  Seq Length: 256.0
[2024-09-26 19:05:26,781][root][INFO] - Step: 225/1350  |  Loss: 1.0844  |  Score: 69.40 [%]  |  Seq Length: 256.0
[2024-09-26 19:05:29,696][root][INFO] - Step: 690/1350  |  Loss: 0.6267  |  Score: 82.83 [%]  |  Seq Length: 256.0
[2024-09-26 19:05:32,357][root][INFO] - Step: 240/1350  |  Loss: 1.0003  |  Score: 68.36 [%]  |  Seq Length: 256.0
[2024-09-26 19:05:37,420][root][INFO] - Step: 705/1350  |  Loss: 0.5639  |  Score: 82.52 [%]  |  Seq Length: 256.0
[2024-09-26 19:05:37,936][root][INFO] - Step: 255/1350  |  Loss: 1.0146  |  Score: 68.06 [%]  |  Seq Length: 256.0
[2024-09-26 19:05:43,548][root][INFO] - Step: 270/1350  |  Loss: 1.0180  |  Score: 69.16 [%]  |  Seq Length: 256.0
[2024-09-26 19:05:45,141][root][INFO] - Step: 720/1350  |  Loss: 0.5548  |  Score: 83.55 [%]  |  Seq Length: 256.0
[2024-09-26 19:05:47,472][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 19:05:47,472][root][INFO] - Score: 77.08 [%]  |  Evaluation Time: 3.92 [s]
[2024-09-26 19:05:51,035][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 19:05:51,035][root][INFO] - Score: 68.63 [%]  |  Evaluation Time: 3.56 [s]
[2024-09-26 19:05:51,036][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 19:05:51,038][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 19:05:51,260][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 19:05:51,260][root][INFO] - Score: 77.44 [%]  |  Evaluation Time: 6.12 [s]
[2024-09-26 19:05:51,761][root][INFO] - Step: 271/1350  |  Loss: 0.8114  |  Score: 80.52 [%]  |  Seq Length: 256.0
[2024-09-26 19:05:56,971][root][INFO] - Step: 285/1350  |  Loss: 0.7957  |  Score: 75.71 [%]  |  Seq Length: 256.0
[2024-09-26 19:05:56,997][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 19:05:56,998][root][INFO] - Score: 70.93 [%]  |  Evaluation Time: 5.73 [s]
[2024-09-26 19:05:57,000][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 19:05:57,915][root][INFO] - Step: 721/1350  |  Loss: 0.3039  |  Score: 89.96 [%]  |  Seq Length: 256.0
[2024-09-26 19:06:02,552][root][INFO] - Step: 300/1350  |  Loss: 0.9643  |  Score: 73.40 [%]  |  Seq Length: 256.0
[2024-09-26 19:06:05,211][root][INFO] - Step: 735/1350  |  Loss: 0.5477  |  Score: 83.68 [%]  |  Seq Length: 256.0
[2024-09-26 19:06:08,133][root][INFO] - Step: 315/1350  |  Loss: 1.0452  |  Score: 74.07 [%]  |  Seq Length: 256.0
[2024-09-26 19:06:12,968][root][INFO] - Step: 750/1350  |  Loss: 0.4939  |  Score: 83.94 [%]  |  Seq Length: 256.0
[2024-09-26 19:06:13,709][root][INFO] - Step: 330/1350  |  Loss: 0.9139  |  Score: 72.99 [%]  |  Seq Length: 256.0
[2024-09-26 19:06:19,283][root][INFO] - Step: 345/1350  |  Loss: 0.9349  |  Score: 72.19 [%]  |  Seq Length: 256.0
[2024-09-26 19:06:20,672][root][INFO] - Step: 765/1350  |  Loss: 0.5173  |  Score: 85.17 [%]  |  Seq Length: 256.0
[2024-09-26 19:06:24,877][root][INFO] - Step: 360/1350  |  Loss: 0.9420  |  Score: 74.30 [%]  |  Seq Length: 256.0
[2024-09-26 19:06:28,346][root][INFO] - Step: 780/1350  |  Loss: 0.5133  |  Score: 84.72 [%]  |  Seq Length: 256.0
[2024-09-26 19:06:28,744][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 19:06:28,744][root][INFO] - Score: 75.39 [%]  |  Evaluation Time: 3.86 [s]
[2024-09-26 19:06:32,303][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 19:06:32,303][root][INFO] - Score: 68.49 [%]  |  Evaluation Time: 3.56 [s]
[2024-09-26 19:06:32,308][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 19:06:33,029][root][INFO] - Step: 361/1350  |  Loss: 0.9227  |  Score: 81.97 [%]  |  Seq Length: 256.0
[2024-09-26 19:06:36,119][root][INFO] - Step: 795/1350  |  Loss: 0.4668  |  Score: 86.40 [%]  |  Seq Length: 256.0
[2024-09-26 19:06:38,240][root][INFO] - Step: 375/1350  |  Loss: 0.7491  |  Score: 76.22 [%]  |  Seq Length: 256.0
[2024-09-26 19:06:38,896][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 19:06:38,897][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 19:06:38,898][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 19:06:38,898][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 19:06:38,898][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 19:06:38,899][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 19:06:38,899][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 19:06:38,900][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 19:06:38,900][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 19:06:38,901][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 19:06:38,901][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 19:06:38,902][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 19:06:38,902][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 19:06:38,902][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 19:06:38,903][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 19:06:38,903][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 19:06:38,904][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 19:06:38,904][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 19:06:38,905][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 19:06:38,905][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 19:06:38,906][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 19:06:38,906][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 19:06:38,906][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 19:06:38,907][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 19:06:38,908][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 19:06:39,325][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 19:06:43,299][root][INFO] - 

[2024-09-26 19:06:43,299][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 19:06:43,299][root][INFO] - Data Preprocessing
[2024-09-26 19:06:43,299][root][INFO] - ㄴ remain_lang                ko_en_punc
[2024-09-26 19:06:43,299][root][INFO] - ㄴ do_hangeulize              True
[2024-09-26 19:06:43,299][root][INFO] - ㄴ data_remove                False

[2024-09-26 19:06:43,299][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 19:06:43,307][root][INFO] - vocab size              : 51200
[2024-09-26 19:06:43,308][root][INFO] - device                  : gpu
[2024-09-26 19:06:43,308][root][INFO] - random seed             : 42
[2024-09-26 19:06:43,308][root][INFO] - train data size         : 5760
[2024-09-26 19:06:43,308][root][INFO] - max epochs              : 15
[2024-09-26 19:06:43,308][root][INFO] - total steps             : 1350
[2024-09-26 19:06:43,308][root][INFO] - warmup steps            : 135
[2024-09-26 19:06:43,308][root][INFO] - batch size              : 64
[2024-09-26 19:06:43,308][root][INFO] - accumulation steps      : 1
[2024-09-26 19:06:43,308][root][INFO] - optimizer               : adamwscale
[2024-09-26 19:06:43,308][root][INFO] - lr_scheduler            : cosine
[2024-09-26 19:06:43,308][root][INFO] - learning rate           : 0.01
[2024-09-26 19:06:43,309][root][INFO] - max length              : 256

[2024-09-26 19:06:43,309][root][INFO] - LoRA Configuration
[2024-09-26 19:06:43,309][root][INFO] - ㄴ r                    : 32
[2024-09-26 19:06:43,309][root][INFO] - ㄴ alpha                : 128
[2024-09-26 19:06:43,309][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 19:06:43,309][root][INFO] - 

[2024-09-26 19:06:43,309][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:06:43,309][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 19:06:43,309][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 19:06:43,309][root][INFO] - * tb interval   : 15

[2024-09-26 19:06:43,309][root][INFO] - 

[2024-09-26 19:06:43,309][root][INFO] - Start the Training !
[2024-09-26 19:06:43,312][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 19:06:43,828][root][INFO] - Step: 390/1350  |  Loss: 0.8273  |  Score: 77.30 [%]  |  Seq Length: 256.0
[2024-09-26 19:06:43,921][root][INFO] - Step: 810/1350  |  Loss: 0.5129  |  Score: 84.76 [%]  |  Seq Length: 256.0
[2024-09-26 19:06:49,408][root][INFO] - Step: 405/1350  |  Loss: 0.8758  |  Score: 75.08 [%]  |  Seq Length: 256.0
[2024-09-26 19:06:50,197][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 19:06:50,198][root][INFO] - Score: 77.23 [%]  |  Evaluation Time: 6.27 [s]
[2024-09-26 19:06:51,929][root][INFO] - Step: 15/1350  |  Loss: 3.2458  |  Score: 5.23 [%]  |  Seq Length: 256.0
[2024-09-26 19:06:54,984][root][INFO] - Step: 420/1350  |  Loss: 0.8432  |  Score: 77.59 [%]  |  Seq Length: 256.0
[2024-09-26 19:06:55,870][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 19:06:55,870][root][INFO] - Score: 70.74 [%]  |  Evaluation Time: 5.67 [s]
[2024-09-26 19:06:55,873][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 19:06:56,851][root][INFO] - Step: 811/1350  |  Loss: 0.5419  |  Score: 84.23 [%]  |  Seq Length: 256.0
[2024-09-26 19:06:57,656][root][INFO] - Step: 30/1350  |  Loss: 2.3310  |  Score: 18.26 [%]  |  Seq Length: 256.0
[2024-09-26 19:07:00,564][root][INFO] - Step: 435/1350  |  Loss: 0.8259  |  Score: 77.23 [%]  |  Seq Length: 256.0
[2024-09-26 19:07:03,374][root][INFO] - Step: 45/1350  |  Loss: 2.0610  |  Score: 28.53 [%]  |  Seq Length: 256.0
[2024-09-26 19:07:04,132][root][INFO] - Step: 825/1350  |  Loss: 0.4299  |  Score: 86.65 [%]  |  Seq Length: 256.0
[2024-09-26 19:07:06,169][root][INFO] - Step: 450/1350  |  Loss: 0.8177  |  Score: 76.88 [%]  |  Seq Length: 256.0
[2024-09-26 19:07:09,100][root][INFO] - Step: 60/1350  |  Loss: 1.7100  |  Score: 48.36 [%]  |  Seq Length: 256.0
[2024-09-26 19:07:09,994][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 19:07:09,994][root][INFO] - Score: 78.44 [%]  |  Evaluation Time: 3.82 [s]
[2024-09-26 19:07:11,941][root][INFO] - Step: 840/1350  |  Loss: 0.4423  |  Score: 87.30 [%]  |  Seq Length: 256.0
[2024-09-26 19:07:13,581][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 19:07:13,581][root][INFO] - Score: 69.49 [%]  |  Evaluation Time: 3.58 [s]
[2024-09-26 19:07:13,582][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 19:07:13,583][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 19:07:14,379][root][INFO] - Step: 451/1350  |  Loss: 0.8094  |  Score: 73.32 [%]  |  Seq Length: 256.0
[2024-09-26 19:07:14,824][root][INFO] - Step: 75/1350  |  Loss: 1.4580  |  Score: 57.35 [%]  |  Seq Length: 256.0
[2024-09-26 19:07:19,591][root][INFO] - Step: 465/1350  |  Loss: 0.7237  |  Score: 77.71 [%]  |  Seq Length: 256.0
[2024-09-26 19:07:19,699][root][INFO] - Step: 855/1350  |  Loss: 0.4376  |  Score: 87.71 [%]  |  Seq Length: 256.0
[2024-09-26 19:07:20,565][root][INFO] - Step: 90/1350  |  Loss: 1.4140  |  Score: 56.81 [%]  |  Seq Length: 256.0
[2024-09-26 19:07:24,533][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 19:07:24,533][root][INFO] - Score: 71.20 [%]  |  Evaluation Time: 3.96 [s]
[2024-09-26 19:07:25,173][root][INFO] - Step: 480/1350  |  Loss: 0.7220  |  Score: 78.60 [%]  |  Seq Length: 256.0
[2024-09-26 19:07:27,405][root][INFO] - Step: 870/1350  |  Loss: 0.4738  |  Score: 87.07 [%]  |  Seq Length: 256.0
[2024-09-26 19:07:28,247][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 19:07:28,247][root][INFO] - Score: 65.33 [%]  |  Evaluation Time: 3.71 [s]
[2024-09-26 19:07:28,248][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 19:07:28,249][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 19:07:28,946][root][INFO] - Step: 91/1350  |  Loss: 1.3134  |  Score: 62.14 [%]  |  Seq Length: 256.0
[2024-09-26 19:07:30,755][root][INFO] - Step: 495/1350  |  Loss: 0.7135  |  Score: 79.65 [%]  |  Seq Length: 256.0
[2024-09-26 19:07:34,286][root][INFO] - Step: 105/1350  |  Loss: 1.2724  |  Score: 63.42 [%]  |  Seq Length: 256.0
[2024-09-26 19:07:35,120][root][INFO] - Step: 885/1350  |  Loss: 0.4522  |  Score: 85.53 [%]  |  Seq Length: 256.0
[2024-09-26 19:07:36,334][root][INFO] - Step: 510/1350  |  Loss: 0.7538  |  Score: 78.58 [%]  |  Seq Length: 256.0
[2024-09-26 19:07:40,010][root][INFO] - Step: 120/1350  |  Loss: 1.3405  |  Score: 62.30 [%]  |  Seq Length: 256.0
[2024-09-26 19:07:41,914][root][INFO] - Step: 525/1350  |  Loss: 0.7503  |  Score: 81.53 [%]  |  Seq Length: 256.0
[2024-09-26 19:07:42,855][root][INFO] - Step: 900/1350  |  Loss: 0.4631  |  Score: 84.54 [%]  |  Seq Length: 256.0
[2024-09-26 19:07:45,742][root][INFO] - Step: 135/1350  |  Loss: 1.2444  |  Score: 64.50 [%]  |  Seq Length: 256.0
[2024-09-26 19:07:47,527][root][INFO] - Step: 540/1350  |  Loss: 0.7068  |  Score: 80.45 [%]  |  Seq Length: 256.0
[2024-09-26 19:07:49,063][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 19:07:49,063][root][INFO] - Score: 76.58 [%]  |  Evaluation Time: 6.20 [s]
[2024-09-26 19:07:51,452][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 19:07:51,453][root][INFO] - Score: 76.42 [%]  |  Evaluation Time: 3.92 [s]
[2024-09-26 19:07:51,468][root][INFO] - Step: 150/1350  |  Loss: 1.4544  |  Score: 66.02 [%]  |  Seq Length: 256.0
[2024-09-26 19:07:54,749][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 19:07:54,749][root][INFO] - Score: 71.13 [%]  |  Evaluation Time: 5.68 [s]
[2024-09-26 19:07:54,751][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 19:07:55,025][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 19:07:55,025][root][INFO] - Score: 69.19 [%]  |  Evaluation Time: 3.57 [s]
[2024-09-26 19:07:55,028][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 19:07:55,815][root][INFO] - Step: 901/1350  |  Loss: 0.5590  |  Score: 79.79 [%]  |  Seq Length: 256.0
[2024-09-26 19:07:55,923][root][INFO] - Step: 541/1350  |  Loss: 0.4861  |  Score: 88.50 [%]  |  Seq Length: 256.0
[2024-09-26 19:07:57,200][root][INFO] - Step: 165/1350  |  Loss: 1.4737  |  Score: 63.11 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:01,131][root][INFO] - Step: 555/1350  |  Loss: 0.6292  |  Score: 82.33 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:02,983][root][INFO] - Step: 180/1350  |  Loss: 1.3024  |  Score: 61.87 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:03,087][root][INFO] - Step: 915/1350  |  Loss: 0.4564  |  Score: 86.33 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:06,708][root][INFO] - Step: 570/1350  |  Loss: 0.6226  |  Score: 82.16 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:07,014][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 19:08:07,014][root][INFO] - Score: 74.50 [%]  |  Evaluation Time: 4.03 [s]
[2024-09-26 19:08:10,699][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 19:08:10,699][root][INFO] - Score: 65.81 [%]  |  Evaluation Time: 3.68 [s]
[2024-09-26 19:08:10,701][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 19:08:10,702][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 19:08:10,823][root][INFO] - Step: 930/1350  |  Loss: 0.4065  |  Score: 87.89 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:11,431][root][INFO] - Step: 181/1350  |  Loss: 0.9734  |  Score: 80.74 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:12,288][root][INFO] - Step: 585/1350  |  Loss: 0.6778  |  Score: 81.75 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:16,781][root][INFO] - Step: 195/1350  |  Loss: 1.0760  |  Score: 68.66 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:17,868][root][INFO] - Step: 600/1350  |  Loss: 0.6486  |  Score: 81.19 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:18,641][root][INFO] - Step: 945/1350  |  Loss: 0.4305  |  Score: 86.39 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:22,513][root][INFO] - Step: 210/1350  |  Loss: 1.1727  |  Score: 67.34 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:23,457][root][INFO] - Step: 615/1350  |  Loss: 0.6327  |  Score: 81.54 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:26,394][root][INFO] - Step: 960/1350  |  Loss: 0.4202  |  Score: 88.73 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:28,242][root][INFO] - Step: 225/1350  |  Loss: 1.0536  |  Score: 68.58 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:29,083][root][INFO] - Step: 630/1350  |  Loss: 0.6814  |  Score: 80.43 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:33,070][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 19:08:33,070][root][INFO] - Score: 76.52 [%]  |  Evaluation Time: 3.98 [s]
[2024-09-26 19:08:33,971][root][INFO] - Step: 240/1350  |  Loss: 1.0049  |  Score: 69.04 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:34,171][root][INFO] - Step: 975/1350  |  Loss: 0.4155  |  Score: 86.88 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:36,741][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 19:08:36,741][root][INFO] - Score: 70.86 [%]  |  Evaluation Time: 3.67 [s]
[2024-09-26 19:08:36,743][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 19:08:37,475][root][INFO] - Step: 631/1350  |  Loss: 0.4985  |  Score: 88.89 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:39,694][root][INFO] - Step: 255/1350  |  Loss: 1.0565  |  Score: 66.29 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:41,912][root][INFO] - Step: 990/1350  |  Loss: 0.3758  |  Score: 88.80 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:42,685][root][INFO] - Step: 645/1350  |  Loss: 0.5488  |  Score: 84.17 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:45,444][root][INFO] - Step: 270/1350  |  Loss: 1.1073  |  Score: 67.78 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:48,279][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 19:08:48,280][root][INFO] - Score: 77.45 [%]  |  Evaluation Time: 6.36 [s]
[2024-09-26 19:08:48,289][root][INFO] - Step: 660/1350  |  Loss: 0.5793  |  Score: 82.19 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:49,444][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 19:08:49,445][root][INFO] - Score: 77.15 [%]  |  Evaluation Time: 4.00 [s]
[2024-09-26 19:08:53,094][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 19:08:53,094][root][INFO] - Score: 68.88 [%]  |  Evaluation Time: 3.65 [s]
[2024-09-26 19:08:53,096][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 19:08:53,097][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 19:08:53,827][root][INFO] - Step: 271/1350  |  Loss: 0.6148  |  Score: 84.13 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:53,920][root][INFO] - Step: 675/1350  |  Loss: 0.5751  |  Score: 84.25 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:54,036][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 19:08:54,036][root][INFO] - Score: 69.76 [%]  |  Evaluation Time: 5.75 [s]
[2024-09-26 19:08:54,039][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 19:08:54,937][root][INFO] - Step: 991/1350  |  Loss: 0.4370  |  Score: 87.21 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:59,176][root][INFO] - Step: 285/1350  |  Loss: 0.9988  |  Score: 73.65 [%]  |  Seq Length: 256.0
[2024-09-26 19:08:59,552][root][INFO] - Step: 690/1350  |  Loss: 0.5801  |  Score: 84.14 [%]  |  Seq Length: 256.0
[2024-09-26 19:09:02,175][root][INFO] - Step: 1005/1350  |  Loss: 0.4078  |  Score: 89.25 [%]  |  Seq Length: 256.0
[2024-09-26 19:09:04,900][root][INFO] - Step: 300/1350  |  Loss: 1.0059  |  Score: 72.08 [%]  |  Seq Length: 256.0
[2024-09-26 19:09:05,181][root][INFO] - Step: 705/1350  |  Loss: 0.5775  |  Score: 83.87 [%]  |  Seq Length: 256.0
[2024-09-26 19:09:09,942][root][INFO] - Step: 1020/1350  |  Loss: 0.3904  |  Score: 88.95 [%]  |  Seq Length: 256.0
[2024-09-26 19:09:10,628][root][INFO] - Step: 315/1350  |  Loss: 0.9273  |  Score: 73.83 [%]  |  Seq Length: 256.0
[2024-09-26 19:09:10,842][root][INFO] - Step: 720/1350  |  Loss: 0.6062  |  Score: 83.58 [%]  |  Seq Length: 256.0
[2024-09-26 19:09:14,742][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 19:09:14,743][root][INFO] - Score: 77.33 [%]  |  Evaluation Time: 3.90 [s]
[2024-09-26 19:09:16,355][root][INFO] - Step: 330/1350  |  Loss: 0.8683  |  Score: 72.66 [%]  |  Seq Length: 256.0
[2024-09-26 19:09:17,649][root][INFO] - Step: 1035/1350  |  Loss: 0.3843  |  Score: 87.93 [%]  |  Seq Length: 256.0
[2024-09-26 19:09:18,356][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 19:09:18,357][root][INFO] - Score: 70.23 [%]  |  Evaluation Time: 3.61 [s]
[2024-09-26 19:09:18,359][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 19:09:19,078][root][INFO] - Step: 721/1350  |  Loss: 0.4983  |  Score: 84.73 [%]  |  Seq Length: 256.0
[2024-09-26 19:09:22,082][root][INFO] - Step: 345/1350  |  Loss: 0.8759  |  Score: 73.64 [%]  |  Seq Length: 256.0
[2024-09-26 19:09:24,287][root][INFO] - Step: 735/1350  |  Loss: 0.4879  |  Score: 85.54 [%]  |  Seq Length: 256.0
[2024-09-26 19:09:25,395][root][INFO] - Step: 1050/1350  |  Loss: 0.3945  |  Score: 87.02 [%]  |  Seq Length: 256.0
[2024-09-26 19:09:27,845][root][INFO] - Step: 360/1350  |  Loss: 0.9955  |  Score: 73.80 [%]  |  Seq Length: 256.0
[2024-09-26 19:09:29,872][root][INFO] - Step: 750/1350  |  Loss: 0.5057  |  Score: 84.66 [%]  |  Seq Length: 256.0
[2024-09-26 19:09:31,793][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 19:09:31,793][root][INFO] - Score: 75.33 [%]  |  Evaluation Time: 3.94 [s]
[2024-09-26 19:09:33,101][root][INFO] - Step: 1065/1350  |  Loss: 0.3757  |  Score: 88.05 [%]  |  Seq Length: 256.0
[2024-09-26 19:09:35,435][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 19:09:35,435][root][INFO] - Score: 69.17 [%]  |  Evaluation Time: 3.64 [s]
[2024-09-26 19:09:35,438][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 19:09:35,455][root][INFO] - Step: 765/1350  |  Loss: 0.4907  |  Score: 85.65 [%]  |  Seq Length: 256.0
[2024-09-26 19:09:36,289][root][INFO] - Step: 361/1350  |  Loss: 0.8948  |  Score: 81.99 [%]  |  Seq Length: 256.0
[2024-09-26 19:09:40,871][root][INFO] - Step: 1080/1350  |  Loss: 0.3678  |  Score: 88.58 [%]  |  Seq Length: 256.0
[2024-09-26 19:09:41,036][root][INFO] - Step: 780/1350  |  Loss: 0.4754  |  Score: 86.03 [%]  |  Seq Length: 256.0
[2024-09-26 19:09:41,639][root][INFO] - Step: 375/1350  |  Loss: 0.7629  |  Score: 75.75 [%]  |  Seq Length: 256.0
[2024-09-26 19:09:46,614][root][INFO] - Step: 795/1350  |  Loss: 0.4839  |  Score: 86.38 [%]  |  Seq Length: 256.0
[2024-09-26 19:09:47,041][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 19:09:47,041][root][INFO] - Score: 78.70 [%]  |  Evaluation Time: 6.17 [s]
[2024-09-26 19:09:47,367][root][INFO] - Step: 390/1350  |  Loss: 0.8046  |  Score: 77.98 [%]  |  Seq Length: 256.0
[2024-09-26 19:09:52,225][root][INFO] - Step: 810/1350  |  Loss: 0.5188  |  Score: 85.99 [%]  |  Seq Length: 256.0
[2024-09-26 19:09:52,636][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 19:09:52,636][root][INFO] - Score: 71.19 [%]  |  Evaluation Time: 5.59 [s]
[2024-09-26 19:09:52,637][root][INFO] - 
Save new Best Score (Epoch: 12)
[2024-09-26 19:09:52,638][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 19:09:53,099][root][INFO] - Step: 405/1350  |  Loss: 0.8974  |  Score: 73.45 [%]  |  Seq Length: 256.0
[2024-09-26 19:09:53,718][root][INFO] - Step: 1081/1350  |  Loss: 0.3478  |  Score: 89.95 [%]  |  Seq Length: 256.0
[2024-09-26 19:09:56,138][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 19:09:56,138][root][INFO] - Score: 77.54 [%]  |  Evaluation Time: 3.91 [s]
[2024-09-26 19:09:58,826][root][INFO] - Step: 420/1350  |  Loss: 0.9054  |  Score: 74.51 [%]  |  Seq Length: 256.0
[2024-09-26 19:09:59,844][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 19:09:59,844][root][INFO] - Score: 70.58 [%]  |  Evaluation Time: 3.70 [s]
[2024-09-26 19:09:59,845][root][INFO] - 
Save new Best Score (Epoch: 9)
[2024-09-26 19:09:59,846][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 19:10:00,551][root][INFO] - Step: 811/1350  |  Loss: 0.3212  |  Score: 92.53 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:00,938][root][INFO] - Step: 1095/1350  |  Loss: 0.3324  |  Score: 89.81 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:04,552][root][INFO] - Step: 435/1350  |  Loss: 0.8497  |  Score: 76.59 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:05,758][root][INFO] - Step: 825/1350  |  Loss: 0.4145  |  Score: 87.27 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:08,639][root][INFO] - Step: 1110/1350  |  Loss: 0.3714  |  Score: 87.78 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:10,302][root][INFO] - Step: 450/1350  |  Loss: 0.8096  |  Score: 77.29 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:11,336][root][INFO] - Step: 840/1350  |  Loss: 0.4371  |  Score: 86.07 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:14,167][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 19:10:14,167][root][INFO] - Score: 79.40 [%]  |  Evaluation Time: 3.86 [s]
[2024-09-26 19:10:16,385][root][INFO] - Step: 1125/1350  |  Loss: 0.3546  |  Score: 89.48 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:16,914][root][INFO] - Step: 855/1350  |  Loss: 0.4462  |  Score: 86.76 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:17,722][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 19:10:17,722][root][INFO] - Score: 70.74 [%]  |  Evaluation Time: 3.55 [s]
[2024-09-26 19:10:17,723][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 19:10:17,724][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 19:10:18,415][root][INFO] - Step: 451/1350  |  Loss: 0.9731  |  Score: 69.43 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:22,492][root][INFO] - Step: 870/1350  |  Loss: 0.4875  |  Score: 87.71 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:23,758][root][INFO] - Step: 465/1350  |  Loss: 0.6745  |  Score: 78.91 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:24,152][root][INFO] - Step: 1140/1350  |  Loss: 0.3606  |  Score: 88.74 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:28,077][root][INFO] - Step: 885/1350  |  Loss: 0.4074  |  Score: 88.10 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:29,529][root][INFO] - Step: 480/1350  |  Loss: 0.6526  |  Score: 80.03 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:31,900][root][INFO] - Step: 1155/1350  |  Loss: 0.3779  |  Score: 89.42 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:33,718][root][INFO] - Step: 900/1350  |  Loss: 0.4790  |  Score: 86.79 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:35,268][root][INFO] - Step: 495/1350  |  Loss: 0.7215  |  Score: 80.14 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:37,562][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 19:10:37,563][root][INFO] - Score: 78.12 [%]  |  Evaluation Time: 3.84 [s]
[2024-09-26 19:10:39,751][root][INFO] - Step: 1170/1350  |  Loss: 0.3607  |  Score: 89.05 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:40,993][root][INFO] - Step: 510/1350  |  Loss: 0.7769  |  Score: 78.83 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:41,229][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 19:10:41,230][root][INFO] - Score: 69.97 [%]  |  Evaluation Time: 3.66 [s]
[2024-09-26 19:10:41,232][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 19:10:41,953][root][INFO] - Step: 901/1350  |  Loss: 0.3789  |  Score: 87.41 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:45,979][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 19:10:45,979][root][INFO] - Score: 77.25 [%]  |  Evaluation Time: 6.22 [s]
[2024-09-26 19:10:46,719][root][INFO] - Step: 525/1350  |  Loss: 0.7055  |  Score: 82.66 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:47,158][root][INFO] - Step: 915/1350  |  Loss: 0.3909  |  Score: 88.26 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:51,590][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 19:10:51,591][root][INFO] - Score: 71.75 [%]  |  Evaluation Time: 5.61 [s]
[2024-09-26 19:10:51,593][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 19:10:52,499][root][INFO] - Step: 540/1350  |  Loss: 0.7044  |  Score: 80.37 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:52,605][root][INFO] - Step: 1171/1350  |  Loss: 0.3724  |  Score: 91.72 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:52,740][root][INFO] - Step: 930/1350  |  Loss: 0.4047  |  Score: 87.61 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:56,307][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 19:10:56,307][root][INFO] - Score: 77.32 [%]  |  Evaluation Time: 3.80 [s]
[2024-09-26 19:10:58,329][root][INFO] - Step: 945/1350  |  Loss: 0.4147  |  Score: 88.46 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:59,778][root][INFO] - Step: 1185/1350  |  Loss: 0.3708  |  Score: 89.34 [%]  |  Seq Length: 256.0
[2024-09-26 19:10:59,888][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 19:10:59,889][root][INFO] - Score: 69.47 [%]  |  Evaluation Time: 3.58 [s]
[2024-09-26 19:10:59,891][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 19:11:00,583][root][INFO] - Step: 541/1350  |  Loss: 0.6965  |  Score: 80.56 [%]  |  Seq Length: 256.0
[2024-09-26 19:11:03,913][root][INFO] - Step: 960/1350  |  Loss: 0.4076  |  Score: 87.64 [%]  |  Seq Length: 256.0
[2024-09-26 19:11:05,938][root][INFO] - Step: 555/1350  |  Loss: 0.5729  |  Score: 82.90 [%]  |  Seq Length: 256.0
[2024-09-26 19:11:07,503][root][INFO] - Step: 1200/1350  |  Loss: 0.3402  |  Score: 90.11 [%]  |  Seq Length: 256.0
[2024-09-26 19:11:09,540][root][INFO] - Step: 975/1350  |  Loss: 0.3973  |  Score: 88.08 [%]  |  Seq Length: 256.0
[2024-09-26 19:11:11,669][root][INFO] - Step: 570/1350  |  Loss: 0.5982  |  Score: 81.70 [%]  |  Seq Length: 256.0
[2024-09-26 19:11:15,200][root][INFO] - Step: 1215/1350  |  Loss: 0.3537  |  Score: 89.77 [%]  |  Seq Length: 256.0
[2024-09-26 19:11:15,223][root][INFO] - Step: 990/1350  |  Loss: 0.3970  |  Score: 87.97 [%]  |  Seq Length: 256.0
[2024-09-26 19:11:17,403][root][INFO] - Step: 585/1350  |  Loss: 0.6011  |  Score: 82.06 [%]  |  Seq Length: 256.0
[2024-09-26 19:11:19,279][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 19:11:19,279][root][INFO] - Score: 77.97 [%]  |  Evaluation Time: 4.05 [s]
[2024-09-26 19:11:22,934][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 19:11:22,934][root][INFO] - Score: 70.23 [%]  |  Evaluation Time: 3.65 [s]
[2024-09-26 19:11:22,935][root][INFO] - 
Save new Best Score (Epoch: 11)
[2024-09-26 19:11:22,936][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 19:11:22,947][root][INFO] - Step: 1230/1350  |  Loss: 0.3949  |  Score: 87.69 [%]  |  Seq Length: 256.0
[2024-09-26 19:11:23,132][root][INFO] - Step: 600/1350  |  Loss: 0.6112  |  Score: 80.99 [%]  |  Seq Length: 256.0
[2024-09-26 19:11:23,649][root][INFO] - Step: 991/1350  |  Loss: 0.3087  |  Score: 89.26 [%]  |  Seq Length: 256.0
[2024-09-26 19:11:28,859][root][INFO] - Step: 1005/1350  |  Loss: 0.3916  |  Score: 88.56 [%]  |  Seq Length: 256.0
[2024-09-26 19:11:28,870][root][INFO] - Step: 615/1350  |  Loss: 0.5829  |  Score: 81.40 [%]  |  Seq Length: 256.0
[2024-09-26 19:11:30,661][root][INFO] - Step: 1245/1350  |  Loss: 0.3588  |  Score: 88.98 [%]  |  Seq Length: 256.0
[2024-09-26 19:11:34,437][root][INFO] - Step: 1020/1350  |  Loss: 0.3929  |  Score: 88.76 [%]  |  Seq Length: 256.0
[2024-09-26 19:11:34,675][root][INFO] - Step: 630/1350  |  Loss: 0.6138  |  Score: 80.44 [%]  |  Seq Length: 256.0
[2024-09-26 19:11:38,408][root][INFO] - Step: 1260/1350  |  Loss: 0.3245  |  Score: 89.75 [%]  |  Seq Length: 256.0
[2024-09-26 19:11:38,566][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 19:11:38,566][root][INFO] - Score: 76.55 [%]  |  Evaluation Time: 3.89 [s]
[2024-09-26 19:11:40,020][root][INFO] - Step: 1035/1350  |  Loss: 0.3679  |  Score: 87.85 [%]  |  Seq Length: 256.0
[2024-09-26 19:11:42,212][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 19:11:42,212][root][INFO] - Score: 70.99 [%]  |  Evaluation Time: 3.64 [s]
[2024-09-26 19:11:42,214][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 19:11:42,909][root][INFO] - Step: 631/1350  |  Loss: 0.4619  |  Score: 88.33 [%]  |  Seq Length: 256.0
[2024-09-26 19:11:44,693][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 19:11:44,693][root][INFO] - Score: 77.60 [%]  |  Evaluation Time: 6.28 [s]
[2024-09-26 19:11:45,598][root][INFO] - Step: 1050/1350  |  Loss: 0.3746  |  Score: 88.85 [%]  |  Seq Length: 256.0
[2024-09-26 19:11:48,265][root][INFO] - Step: 645/1350  |  Loss: 0.5498  |  Score: 84.81 [%]  |  Seq Length: 256.0
[2024-09-26 19:11:50,463][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 19:11:50,464][root][INFO] - Score: 70.90 [%]  |  Evaluation Time: 5.77 [s]
[2024-09-26 19:11:50,466][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 19:11:51,208][root][INFO] - Step: 1065/1350  |  Loss: 0.3522  |  Score: 89.96 [%]  |  Seq Length: 256.0
[2024-09-26 19:11:51,368][root][INFO] - Step: 1261/1350  |  Loss: 0.3628  |  Score: 91.21 [%]  |  Seq Length: 256.0
[2024-09-26 19:11:54,000][root][INFO] - Step: 660/1350  |  Loss: 0.5285  |  Score: 83.99 [%]  |  Seq Length: 256.0
[2024-09-26 19:11:56,881][root][INFO] - Step: 1080/1350  |  Loss: 0.3446  |  Score: 88.54 [%]  |  Seq Length: 256.0
[2024-09-26 19:11:58,554][root][INFO] - Step: 1275/1350  |  Loss: 0.4036  |  Score: 89.22 [%]  |  Seq Length: 256.0
[2024-09-26 19:11:59,734][root][INFO] - Step: 675/1350  |  Loss: 0.5073  |  Score: 86.43 [%]  |  Seq Length: 256.0
[2024-09-26 19:12:00,734][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 19:12:00,734][root][INFO] - Score: 77.87 [%]  |  Evaluation Time: 3.85 [s]
[2024-09-26 19:12:04,321][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 19:12:04,321][root][INFO] - Score: 69.70 [%]  |  Evaluation Time: 3.59 [s]
[2024-09-26 19:12:04,324][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 19:12:05,132][root][INFO] - Step: 1081/1350  |  Loss: 0.3935  |  Score: 88.38 [%]  |  Seq Length: 256.0
[2024-09-26 19:12:05,498][root][INFO] - Step: 690/1350  |  Loss: 0.5349  |  Score: 83.78 [%]  |  Seq Length: 256.0
[2024-09-26 19:12:06,255][root][INFO] - Step: 1290/1350  |  Loss: 0.3375  |  Score: 88.82 [%]  |  Seq Length: 256.0
[2024-09-26 19:12:10,340][root][INFO] - Step: 1095/1350  |  Loss: 0.3528  |  Score: 89.37 [%]  |  Seq Length: 256.0
[2024-09-26 19:12:11,282][root][INFO] - Step: 705/1350  |  Loss: 0.5352  |  Score: 83.38 [%]  |  Seq Length: 256.0
[2024-09-26 19:12:14,017][root][INFO] - Step: 1305/1350  |  Loss: 0.3535  |  Score: 89.08 [%]  |  Seq Length: 256.0
[2024-09-26 19:12:15,924][root][INFO] - Step: 1110/1350  |  Loss: 0.3649  |  Score: 90.31 [%]  |  Seq Length: 256.0
[2024-09-26 19:12:17,093][root][INFO] - Step: 720/1350  |  Loss: 0.5463  |  Score: 85.15 [%]  |  Seq Length: 256.0
[2024-09-26 19:12:21,024][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 19:12:21,024][root][INFO] - Score: 77.19 [%]  |  Evaluation Time: 3.93 [s]
[2024-09-26 19:12:21,505][root][INFO] - Step: 1125/1350  |  Loss: 0.3702  |  Score: 88.60 [%]  |  Seq Length: 256.0
[2024-09-26 19:12:21,713][root][INFO] - Step: 1320/1350  |  Loss: 0.3599  |  Score: 88.91 [%]  |  Seq Length: 256.0
[2024-09-26 19:12:24,659][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 19:12:24,660][root][INFO] - Score: 69.89 [%]  |  Evaluation Time: 3.63 [s]
[2024-09-26 19:12:24,662][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 19:12:25,419][root][INFO] - Step: 721/1350  |  Loss: 0.4660  |  Score: 86.93 [%]  |  Seq Length: 256.0
[2024-09-26 19:12:27,104][root][INFO] - Step: 1140/1350  |  Loss: 0.3323  |  Score: 89.50 [%]  |  Seq Length: 256.0
[2024-09-26 19:12:29,401][root][INFO] - Step: 1335/1350  |  Loss: 0.3387  |  Score: 89.58 [%]  |  Seq Length: 256.0
[2024-09-26 19:12:30,772][root][INFO] - Step: 735/1350  |  Loss: 0.4627  |  Score: 85.25 [%]  |  Seq Length: 256.0
[2024-09-26 19:12:32,681][root][INFO] - Step: 1155/1350  |  Loss: 0.3181  |  Score: 90.37 [%]  |  Seq Length: 256.0
[2024-09-26 19:12:36,500][root][INFO] - Step: 750/1350  |  Loss: 0.4531  |  Score: 86.44 [%]  |  Seq Length: 256.0
[2024-09-26 19:12:37,122][root][INFO] - Step: 1350/1350  |  Loss: 0.3815  |  Score: 90.03 [%]  |  Seq Length: 256.0
[2024-09-26 19:12:38,289][root][INFO] - Step: 1170/1350  |  Loss: 0.3889  |  Score: 87.53 [%]  |  Seq Length: 256.0
[2024-09-26 19:12:42,209][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 19:12:42,209][root][INFO] - Score: 78.35 [%]  |  Evaluation Time: 3.92 [s]
[2024-09-26 19:12:42,233][root][INFO] - Step: 765/1350  |  Loss: 0.4978  |  Score: 85.22 [%]  |  Seq Length: 256.0
[2024-09-26 19:12:43,436][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 19:12:43,436][root][INFO] - Score: 77.56 [%]  |  Evaluation Time: 6.31 [s]
[2024-09-26 19:12:45,845][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 19:12:45,846][root][INFO] - Score: 70.64 [%]  |  Evaluation Time: 3.63 [s]
[2024-09-26 19:12:45,847][root][INFO] - 
Save new Best Score (Epoch: 13)
[2024-09-26 19:12:45,848][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 19:12:46,584][root][INFO] - Step: 1171/1350  |  Loss: 0.4011  |  Score: 82.83 [%]  |  Seq Length: 256.0
[2024-09-26 19:12:47,991][root][INFO] - Step: 780/1350  |  Loss: 0.4917  |  Score: 86.19 [%]  |  Seq Length: 256.0
[2024-09-26 19:12:49,117][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 19:12:49,118][root][INFO] - Score: 70.52 [%]  |  Evaluation Time: 5.68 [s]
[2024-09-26 19:12:49,119][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 19:12:49,119][root][INFO] - - Epoch: 12
[2024-09-26 19:12:49,119][root][INFO] - - DEV score: 78.70 [%]
[2024-09-26 19:12:49,119][root][INFO] - - TEST score: 71.19 [%]
[2024-09-26 19:12:49,120][root][INFO] - Fine-tuning is done!
[2024-09-26 19:12:51,797][root][INFO] - Step: 1185/1350  |  Loss: 0.3664  |  Score: 90.06 [%]  |  Seq Length: 256.0
[2024-09-26 19:12:53,762][root][INFO] - Step: 795/1350  |  Loss: 0.4659  |  Score: 86.49 [%]  |  Seq Length: 256.0
[2024-09-26 19:12:55,727][root][INFO] - 

[2024-09-26 19:12:55,727][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 19:12:55,727][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:12:55,727][root][INFO] - 

[2024-09-26 19:12:55,727][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko', 'do_hangeulize': False, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 19:12:57,381][root][INFO] - Step: 1200/1350  |  Loss: 0.3393  |  Score: 89.54 [%]  |  Seq Length: 256.0
[2024-09-26 19:12:59,563][root][INFO] - Step: 810/1350  |  Loss: 0.4960  |  Score: 86.77 [%]  |  Seq Length: 256.0
[2024-09-26 19:12:59,707][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 19:12:59,707][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 19:12:59,708][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 19:12:59,708][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 19:12:59,709][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 19:12:59,709][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 19:12:59,709][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 19:12:59,710][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 19:12:59,710][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 19:12:59,711][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 19:12:59,711][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 19:12:59,711][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 19:12:59,712][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 19:12:59,712][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 19:12:59,713][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 19:12:59,713][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 19:12:59,713][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 19:12:59,714][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 19:12:59,714][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 19:12:59,715][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 19:12:59,715][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 19:12:59,716][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 19:12:59,716][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 19:12:59,716][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 19:12:59,718][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 19:12:59,989][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 19:13:02,964][root][INFO] - Step: 1215/1350  |  Loss: 0.3183  |  Score: 91.30 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:03,408][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 19:13:03,408][root][INFO] - Score: 77.20 [%]  |  Evaluation Time: 3.84 [s]
[2024-09-26 19:13:04,090][root][INFO] - 

[2024-09-26 19:13:04,090][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 19:13:04,090][root][INFO] - Data Preprocessing
[2024-09-26 19:13:04,090][root][INFO] - ㄴ remain_lang                ko
[2024-09-26 19:13:04,090][root][INFO] - ㄴ do_hangeulize              False
[2024-09-26 19:13:04,090][root][INFO] - ㄴ data_remove                True

[2024-09-26 19:13:04,090][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 19:13:04,099][root][INFO] - vocab size              : 51200
[2024-09-26 19:13:04,099][root][INFO] - device                  : gpu
[2024-09-26 19:13:04,099][root][INFO] - random seed             : 42
[2024-09-26 19:13:04,099][root][INFO] - train data size         : 448
[2024-09-26 19:13:04,099][root][INFO] - max epochs              : 15
[2024-09-26 19:13:04,099][root][INFO] - total steps             : 105
[2024-09-26 19:13:04,099][root][INFO] - warmup steps            : 10
[2024-09-26 19:13:04,099][root][INFO] - batch size              : 64
[2024-09-26 19:13:04,099][root][INFO] - accumulation steps      : 1
[2024-09-26 19:13:04,100][root][INFO] - optimizer               : adamwscale
[2024-09-26 19:13:04,100][root][INFO] - lr_scheduler            : cosine
[2024-09-26 19:13:04,100][root][INFO] - learning rate           : 0.01
[2024-09-26 19:13:04,100][root][INFO] - max length              : 256

[2024-09-26 19:13:04,100][root][INFO] - LoRA Configuration
[2024-09-26 19:13:04,100][root][INFO] - ㄴ r                    : 32
[2024-09-26 19:13:04,100][root][INFO] - ㄴ alpha                : 128
[2024-09-26 19:13:04,100][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 19:13:04,100][root][INFO] - 

[2024-09-26 19:13:04,100][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:13:04,100][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 19:13:04,101][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 19:13:04,101][root][INFO] - * tb interval   : 15

[2024-09-26 19:13:04,101][root][INFO] - 

[2024-09-26 19:13:04,101][root][INFO] - Start the Training !
[2024-09-26 19:13:04,103][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 19:13:07,149][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 19:13:07,149][root][INFO] - Score: 70.47 [%]  |  Evaluation Time: 3.74 [s]
[2024-09-26 19:13:07,151][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 19:13:07,888][root][INFO] - Step: 811/1350  |  Loss: 0.3422  |  Score: 91.50 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:08,546][root][INFO] - Step: 1230/1350  |  Loss: 0.3503  |  Score: 89.91 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:09,454][root][INFO] - Step: 7/105  |  Loss: 5.0383  |  Score: -4.30 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:09,919][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 19:13:09,919][root][INFO] - Score: 1.78 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-26 19:13:10,362][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 19:13:10,362][root][INFO] - Score: -13.68 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-26 19:13:10,364][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 19:13:13,235][root][INFO] - Step: 825/1350  |  Loss: 0.4429  |  Score: 87.13 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:13,287][root][INFO] - Step: 14/105  |  Loss: 2.8932  |  Score: 9.80 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:13,752][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 19:13:13,752][root][INFO] - Score: 0.01 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-26 19:13:14,125][root][INFO] - Step: 1245/1350  |  Loss: 0.3407  |  Score: 87.86 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:14,202][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 19:13:14,202][root][INFO] - Score: -1.39 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-26 19:13:14,204][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 19:13:14,909][root][INFO] - Step: 15/105  |  Loss: 2.1525  |  Score: 26.63 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:16,973][root][INFO] - Step: 21/105  |  Loss: 2.0978  |  Score: 34.06 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:17,496][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 19:13:17,496][root][INFO] - Score: 12.49 [%]  |  Evaluation Time: 0.52 [s]
[2024-09-26 19:13:17,923][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 19:13:17,923][root][INFO] - Score: 5.61 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-26 19:13:17,924][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 19:13:17,926][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 19:13:18,963][root][INFO] - Step: 840/1350  |  Loss: 0.4033  |  Score: 87.84 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:19,734][root][INFO] - Step: 1260/1350  |  Loss: 0.3514  |  Score: 90.76 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:20,758][root][INFO] - Step: 28/105  |  Loss: 1.7231  |  Score: 54.79 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:21,230][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 19:13:21,230][root][INFO] - Score: 21.36 [%]  |  Evaluation Time: 0.47 [s]
[2024-09-26 19:13:21,664][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 19:13:21,664][root][INFO] - Score: 17.17 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-26 19:13:21,665][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-26 19:13:21,666][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 19:13:22,819][root][INFO] - Step: 30/105  |  Loss: 1.5142  |  Score: 70.43 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:23,724][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 19:13:23,724][root][INFO] - Score: 77.65 [%]  |  Evaluation Time: 3.99 [s]
[2024-09-26 19:13:24,531][root][INFO] - Step: 35/105  |  Loss: 1.4010  |  Score: 63.34 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:24,691][root][INFO] - Step: 855/1350  |  Loss: 0.4393  |  Score: 87.55 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:25,006][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 19:13:25,006][root][INFO] - Score: 29.03 [%]  |  Evaluation Time: 0.47 [s]
[2024-09-26 19:13:25,448][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 19:13:25,449][root][INFO] - Score: 28.72 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-26 19:13:25,450][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 19:13:25,451][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 19:13:27,431][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 19:13:27,431][root][INFO] - Score: 69.71 [%]  |  Evaluation Time: 3.70 [s]
[2024-09-26 19:13:27,433][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 19:13:28,170][root][INFO] - Step: 1261/1350  |  Loss: 0.3412  |  Score: 90.64 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:28,226][root][INFO] - Step: 42/105  |  Loss: 1.0899  |  Score: 74.52 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:28,686][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 19:13:28,686][root][INFO] - Score: 34.90 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-26 19:13:29,116][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 19:13:29,117][root][INFO] - Score: 30.82 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-26 19:13:29,118][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 19:13:29,119][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 19:13:30,421][root][INFO] - Step: 870/1350  |  Loss: 0.4764  |  Score: 87.88 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:30,646][root][INFO] - Step: 45/105  |  Loss: 0.9675  |  Score: 77.42 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:31,970][root][INFO] - Step: 49/105  |  Loss: 0.8794  |  Score: 80.23 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:32,435][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 19:13:32,435][root][INFO] - Score: 36.90 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-26 19:13:32,868][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 19:13:32,868][root][INFO] - Score: 31.79 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-26 19:13:32,869][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-26 19:13:32,871][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 19:13:33,379][root][INFO] - Step: 1275/1350  |  Loss: 0.3372  |  Score: 90.29 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:35,661][root][INFO] - Step: 56/105  |  Loss: 0.7995  |  Score: 79.29 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:36,143][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 19:13:36,143][root][INFO] - Score: 39.79 [%]  |  Evaluation Time: 0.48 [s]
[2024-09-26 19:13:36,147][root][INFO] - Step: 885/1350  |  Loss: 0.3791  |  Score: 88.65 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:36,586][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 19:13:36,586][root][INFO] - Score: 33.71 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-26 19:13:36,587][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-26 19:13:36,588][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 19:13:38,529][root][INFO] - Step: 60/105  |  Loss: 0.6678  |  Score: 86.26 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:38,971][root][INFO] - Step: 1290/1350  |  Loss: 0.3442  |  Score: 89.54 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:39,497][root][INFO] - Step: 63/105  |  Loss: 0.7053  |  Score: 81.76 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:39,960][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 19:13:39,960][root][INFO] - Score: 39.81 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-26 19:13:40,387][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 19:13:40,387][root][INFO] - Score: 33.50 [%]  |  Evaluation Time: 0.42 [s]
[2024-09-26 19:13:40,389][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 19:13:41,898][root][INFO] - Step: 900/1350  |  Loss: 0.4228  |  Score: 88.72 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:43,135][root][INFO] - Step: 70/105  |  Loss: 0.6832  |  Score: 85.57 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:43,646][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 19:13:43,646][root][INFO] - Score: 41.25 [%]  |  Evaluation Time: 0.51 [s]
[2024-09-26 19:13:44,092][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 19:13:44,092][root][INFO] - Score: 32.54 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-26 19:13:44,093][root][INFO] - 
Save new Best Score (Epoch: 10)
[2024-09-26 19:13:44,094][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 19:13:44,554][root][INFO] - Step: 1305/1350  |  Loss: 0.3344  |  Score: 90.03 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:45,737][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 19:13:45,738][root][INFO] - Score: 77.59 [%]  |  Evaluation Time: 3.84 [s]
[2024-09-26 19:13:46,417][root][INFO] - Step: 75/105  |  Loss: 0.5427  |  Score: 87.48 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:47,013][root][INFO] - Step: 77/105  |  Loss: 0.4340  |  Score: 82.38 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:47,466][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 19:13:47,466][root][INFO] - Score: 40.19 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-26 19:13:47,890][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 19:13:47,891][root][INFO] - Score: 32.94 [%]  |  Evaluation Time: 0.42 [s]
[2024-09-26 19:13:47,893][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 19:13:49,344][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 19:13:49,344][root][INFO] - Score: 69.87 [%]  |  Evaluation Time: 3.60 [s]
[2024-09-26 19:13:49,348][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 19:13:50,082][root][INFO] - Step: 901/1350  |  Loss: 0.3480  |  Score: 89.62 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:50,129][root][INFO] - Step: 1320/1350  |  Loss: 0.3217  |  Score: 90.94 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:50,590][root][INFO] - Step: 84/105  |  Loss: 0.5878  |  Score: 86.74 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:51,040][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 19:13:51,040][root][INFO] - Score: 41.22 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-26 19:13:51,472][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 19:13:51,472][root][INFO] - Score: 32.28 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-26 19:13:51,474][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 19:13:54,109][root][INFO] - Step: 90/105  |  Loss: 0.4688  |  Score: 89.75 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:54,346][root][INFO] - Step: 91/105  |  Loss: 0.4254  |  Score: 90.65 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:54,802][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 19:13:54,802][root][INFO] - Score: 40.92 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-26 19:13:55,231][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 19:13:55,231][root][INFO] - Score: 32.61 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-26 19:13:55,233][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 19:13:55,432][root][INFO] - Step: 915/1350  |  Loss: 0.3872  |  Score: 89.30 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:55,703][root][INFO] - Step: 1335/1350  |  Loss: 0.3565  |  Score: 89.28 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:57,976][root][INFO] - Step: 98/105  |  Loss: 0.5460  |  Score: 87.88 [%]  |  Seq Length: 256.0
[2024-09-26 19:13:58,426][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 19:13:58,426][root][INFO] - Score: 40.28 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-26 19:13:58,859][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 19:13:58,859][root][INFO] - Score: 33.47 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-26 19:13:58,862][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 19:14:01,158][root][INFO] - Step: 930/1350  |  Loss: 0.3958  |  Score: 88.00 [%]  |  Seq Length: 256.0
[2024-09-26 19:14:01,326][root][INFO] - Step: 1350/1350  |  Loss: 0.3391  |  Score: 89.78 [%]  |  Seq Length: 256.0
[2024-09-26 19:14:01,783][root][INFO] - Step: 105/105  |  Loss: 0.5006  |  Score: 87.54 [%]  |  Seq Length: 256.0
[2024-09-26 19:14:02,234][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 19:14:02,234][root][INFO] - Score: 40.41 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-26 19:14:02,672][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 19:14:02,672][root][INFO] - Score: 33.27 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-26 19:14:02,673][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 19:14:02,673][root][INFO] - - Epoch: 10
[2024-09-26 19:14:02,673][root][INFO] - - DEV score: 41.25 [%]
[2024-09-26 19:14:02,673][root][INFO] - - TEST score: 32.54 [%]
[2024-09-26 19:14:02,674][root][INFO] - Fine-tuning is done!
[2024-09-26 19:14:05,336][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 19:14:05,336][root][INFO] - Score: 77.58 [%]  |  Evaluation Time: 4.01 [s]
[2024-09-26 19:14:06,891][root][INFO] - Step: 945/1350  |  Loss: 0.3760  |  Score: 88.65 [%]  |  Seq Length: 256.0
[2024-09-26 19:14:08,980][root][INFO] - 

[2024-09-26 19:14:08,980][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 19:14:08,981][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:14:08,981][root][INFO] - 

[2024-09-26 19:14:08,981][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko', 'do_hangeulize': False, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 19:14:08,998][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 19:14:08,998][root][INFO] - Score: 70.53 [%]  |  Evaluation Time: 3.66 [s]
[2024-09-26 19:14:08,999][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 19:14:08,999][root][INFO] - - Epoch: 13
[2024-09-26 19:14:08,999][root][INFO] - - DEV score: 78.35 [%]
[2024-09-26 19:14:08,999][root][INFO] - - TEST score: 70.64 [%]
[2024-09-26 19:14:09,000][root][INFO] - Fine-tuning is done!
[2024-09-26 19:14:12,605][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 19:14:12,605][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 19:14:12,606][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 19:14:12,606][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 19:14:12,607][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 19:14:12,607][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 19:14:12,608][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 19:14:12,608][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 19:14:12,608][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 19:14:12,609][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 19:14:12,609][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 19:14:12,610][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 19:14:12,610][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 19:14:12,610][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 19:14:12,611][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 19:14:12,611][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 19:14:12,612][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 19:14:12,612][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 19:14:12,613][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 19:14:12,613][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 19:14:12,614][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 19:14:12,614][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 19:14:12,614][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 19:14:12,615][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 19:14:12,616][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 19:14:12,618][root][INFO] - Step: 960/1350  |  Loss: 0.3978  |  Score: 88.79 [%]  |  Seq Length: 256.0
[2024-09-26 19:14:12,620][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-26 19:14:12,726][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-26 19:14:12,728][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-26 19:14:13,185][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 19:14:15,457][root][INFO] - 

[2024-09-26 19:14:15,457][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 19:14:15,457][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:14:15,457][root][INFO] - 

[2024-09-26 19:14:15,457][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_punc', 'do_hangeulize': True, 'data_remove': False, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 19:14:18,349][root][INFO] - Step: 975/1350  |  Loss: 0.4184  |  Score: 87.94 [%]  |  Seq Length: 256.0
[2024-09-26 19:14:20,306][root][INFO] - 

[2024-09-26 19:14:20,306][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 19:14:20,306][root][INFO] - Data Preprocessing
[2024-09-26 19:14:20,306][root][INFO] - ㄴ remain_lang                ko
[2024-09-26 19:14:20,306][root][INFO] - ㄴ do_hangeulize              False
[2024-09-26 19:14:20,306][root][INFO] - ㄴ data_remove                True

[2024-09-26 19:14:20,307][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 19:14:20,315][root][INFO] - vocab size              : 51200
[2024-09-26 19:14:20,315][root][INFO] - device                  : gpu
[2024-09-26 19:14:20,315][root][INFO] - random seed             : 42
[2024-09-26 19:14:20,316][root][INFO] - train data size         : 448
[2024-09-26 19:14:20,316][root][INFO] - max epochs              : 15
[2024-09-26 19:14:20,316][root][INFO] - total steps             : 105
[2024-09-26 19:14:20,316][root][INFO] - warmup steps            : 10
[2024-09-26 19:14:20,316][root][INFO] - batch size              : 64
[2024-09-26 19:14:20,316][root][INFO] - accumulation steps      : 1
[2024-09-26 19:14:20,316][root][INFO] - optimizer               : adamwscale
[2024-09-26 19:14:20,316][root][INFO] - lr_scheduler            : cosine
[2024-09-26 19:14:20,316][root][INFO] - learning rate           : 0.01
[2024-09-26 19:14:20,317][root][INFO] - max length              : 256

[2024-09-26 19:14:20,317][root][INFO] - LoRA Configuration
[2024-09-26 19:14:20,317][root][INFO] - ㄴ r                    : 32
[2024-09-26 19:14:20,317][root][INFO] - ㄴ alpha                : 128
[2024-09-26 19:14:20,317][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 19:14:20,317][root][INFO] - KOMBO Configuration
[2024-09-26 19:14:20,317][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-26 19:14:20,317][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-26 19:14:20,317][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-26 19:14:20,317][root][INFO] - ㄴ do_combination       : True
[2024-09-26 19:14:20,318][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-26 19:14:20,318][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-26 19:14:20,318][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-26 19:14:20,318][root][INFO] -   ㄴ add_lora           : True

[2024-09-26 19:14:20,318][root][INFO] - LoRA in KOMBO Configuration
[2024-09-26 19:14:20,318][root][INFO] - ㄴ r                : 32
[2024-09-26 19:14:20,318][root][INFO] - ㄴ alpha            : 128
[2024-09-26 19:14:20,318][root][INFO] - ㄴ dropout          : 0.03

[2024-09-26 19:14:20,318][root][INFO] - 

[2024-09-26 19:14:20,319][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:14:20,319][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 19:14:20,319][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 19:14:20,319][root][INFO] - * tb interval   : 15

[2024-09-26 19:14:20,319][root][INFO] - 

[2024-09-26 19:14:20,319][root][INFO] - Start the Training !
[2024-09-26 19:14:20,322][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 19:14:20,345][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 19:14:20,346][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 19:14:20,347][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 19:14:20,347][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 19:14:20,348][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 19:14:20,348][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 19:14:20,349][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 19:14:20,349][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 19:14:20,350][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 19:14:20,350][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 19:14:20,351][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 19:14:20,351][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 19:14:20,352][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 19:14:20,352][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 19:14:20,353][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 19:14:20,353][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 19:14:20,354][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 19:14:20,354][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 19:14:20,355][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 19:14:20,355][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 19:14:20,356][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 19:14:20,356][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 19:14:20,357][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 19:14:20,357][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 19:14:20,359][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 19:14:20,366][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-26 19:14:20,487][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-26 19:14:20,489][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-26 19:14:20,704][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 19:14:24,109][root][INFO] - Step: 990/1350  |  Loss: 0.3718  |  Score: 89.56 [%]  |  Seq Length: 256.0
[2024-09-26 19:14:25,185][root][INFO] - Step: 7/105  |  Loss: 4.9633  |  Score: 5.87 [%]  |  Seq Length: 256.0
[2024-09-26 19:14:25,776][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 19:14:25,777][root][INFO] - Score: 1.11 [%]  |  Evaluation Time: 0.59 [s]
[2024-09-26 19:14:26,334][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 19:14:26,334][root][INFO] - Score: -8.62 [%]  |  Evaluation Time: 0.56 [s]
[2024-09-26 19:14:26,336][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 19:14:27,410][root][INFO] - 

[2024-09-26 19:14:27,411][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 19:14:27,411][root][INFO] - Data Preprocessing
[2024-09-26 19:14:27,411][root][INFO] - ㄴ remain_lang                ko_punc
[2024-09-26 19:14:27,411][root][INFO] - ㄴ do_hangeulize              True
[2024-09-26 19:14:27,411][root][INFO] - ㄴ data_remove                False

[2024-09-26 19:14:27,411][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 19:14:27,419][root][INFO] - vocab size              : 51200
[2024-09-26 19:14:27,420][root][INFO] - device                  : gpu
[2024-09-26 19:14:27,420][root][INFO] - random seed             : 42
[2024-09-26 19:14:27,420][root][INFO] - train data size         : 5760
[2024-09-26 19:14:27,420][root][INFO] - max epochs              : 15
[2024-09-26 19:14:27,420][root][INFO] - total steps             : 1350
[2024-09-26 19:14:27,420][root][INFO] - warmup steps            : 135
[2024-09-26 19:14:27,420][root][INFO] - batch size              : 64
[2024-09-26 19:14:27,420][root][INFO] - accumulation steps      : 1
[2024-09-26 19:14:27,420][root][INFO] - optimizer               : adamwscale
[2024-09-26 19:14:27,421][root][INFO] - lr_scheduler            : cosine
[2024-09-26 19:14:27,421][root][INFO] - learning rate           : 0.01
[2024-09-26 19:14:27,421][root][INFO] - max length              : 256

[2024-09-26 19:14:27,421][root][INFO] - LoRA Configuration
[2024-09-26 19:14:27,421][root][INFO] - ㄴ r                    : 32
[2024-09-26 19:14:27,421][root][INFO] - ㄴ alpha                : 128
[2024-09-26 19:14:27,421][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 19:14:27,421][root][INFO] - KOMBO Configuration
[2024-09-26 19:14:27,421][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-26 19:14:27,421][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-26 19:14:27,421][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-26 19:14:27,422][root][INFO] - ㄴ do_combination       : True
[2024-09-26 19:14:27,422][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-26 19:14:27,422][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-26 19:14:27,422][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-26 19:14:27,422][root][INFO] -   ㄴ add_lora           : True

[2024-09-26 19:14:27,422][root][INFO] - LoRA in KOMBO Configuration
[2024-09-26 19:14:27,422][root][INFO] - ㄴ r                : 32
[2024-09-26 19:14:27,422][root][INFO] - ㄴ alpha            : 128
[2024-09-26 19:14:27,422][root][INFO] - ㄴ dropout          : 0.03

[2024-09-26 19:14:27,423][root][INFO] - 

[2024-09-26 19:14:27,423][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:14:27,423][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 19:14:27,423][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 19:14:27,423][root][INFO] - * tb interval   : 15

[2024-09-26 19:14:27,423][root][INFO] - 

[2024-09-26 19:14:27,423][root][INFO] - Start the Training !
[2024-09-26 19:14:27,426][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 19:14:27,983][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 19:14:27,984][root][INFO] - Score: 78.33 [%]  |  Evaluation Time: 3.87 [s]
[2024-09-26 19:14:30,080][root][INFO] - Step: 14/105  |  Loss: 2.7988  |  Score: 16.63 [%]  |  Seq Length: 256.0
[2024-09-26 19:14:30,647][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 19:14:30,647][root][INFO] - Score: 1.65 [%]  |  Evaluation Time: 0.56 [s]
[2024-09-26 19:14:31,144][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 19:14:31,145][root][INFO] - Score: 4.59 [%]  |  Evaluation Time: 0.49 [s]
[2024-09-26 19:14:31,146][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 19:14:31,147][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 19:14:31,528][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 19:14:31,529][root][INFO] - Score: 70.33 [%]  |  Evaluation Time: 3.54 [s]
[2024-09-26 19:14:31,531][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 19:14:32,217][root][INFO] - Step: 15/105  |  Loss: 2.4317  |  Score: 25.30 [%]  |  Seq Length: 256.0
[2024-09-26 19:14:32,255][root][INFO] - Step: 991/1350  |  Loss: 0.2744  |  Score: 92.54 [%]  |  Seq Length: 256.0
[2024-09-26 19:14:34,946][root][INFO] - Step: 21/105  |  Loss: 2.4729  |  Score: 30.74 [%]  |  Seq Length: 256.0
[2024-09-26 19:14:35,520][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 19:14:35,520][root][INFO] - Score: 19.24 [%]  |  Evaluation Time: 0.57 [s]
[2024-09-26 19:14:36,055][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 19:14:36,056][root][INFO] - Score: 8.82 [%]  |  Evaluation Time: 0.53 [s]
[2024-09-26 19:14:36,057][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 19:14:36,058][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 19:14:36,925][root][INFO] - Step: 15/1350  |  Loss: 3.3463  |  Score: 5.49 [%]  |  Seq Length: 256.0
[2024-09-26 19:14:37,608][root][INFO] - Step: 1005/1350  |  Loss: 0.3560  |  Score: 88.80 [%]  |  Seq Length: 256.0
[2024-09-26 19:14:39,605][root][INFO] - Step: 28/105  |  Loss: 1.9696  |  Score: 48.20 [%]  |  Seq Length: 256.0
[2024-09-26 19:14:40,140][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 19:14:40,140][root][INFO] - Score: 19.44 [%]  |  Evaluation Time: 0.53 [s]
[2024-09-26 19:14:40,678][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 19:14:40,678][root][INFO] - Score: 11.98 [%]  |  Evaluation Time: 0.54 [s]
[2024-09-26 19:14:40,679][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-26 19:14:40,680][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 19:14:42,137][root][INFO] - Step: 30/105  |  Loss: 1.5686  |  Score: 56.27 [%]  |  Seq Length: 256.0
[2024-09-26 19:14:43,340][root][INFO] - Step: 1020/1350  |  Loss: 0.3711  |  Score: 89.01 [%]  |  Seq Length: 256.0
[2024-09-26 19:14:44,287][root][INFO] - Step: 35/105  |  Loss: 1.5425  |  Score: 59.92 [%]  |  Seq Length: 256.0
[2024-09-26 19:14:44,732][root][INFO] - Step: 30/1350  |  Loss: 2.1354  |  Score: 24.63 [%]  |  Seq Length: 256.0
[2024-09-26 19:14:44,864][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 19:14:44,864][root][INFO] - Score: 32.62 [%]  |  Evaluation Time: 0.57 [s]
[2024-09-26 19:14:45,371][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 19:14:45,371][root][INFO] - Score: 19.09 [%]  |  Evaluation Time: 0.50 [s]
[2024-09-26 19:14:45,372][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 19:14:45,373][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 19:14:48,836][root][INFO] - Step: 42/105  |  Loss: 1.2697  |  Score: 68.58 [%]  |  Seq Length: 256.0
[2024-09-26 19:14:49,107][root][INFO] - Step: 1035/1350  |  Loss: 0.3594  |  Score: 88.71 [%]  |  Seq Length: 256.0
[2024-09-26 19:14:49,407][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 19:14:49,408][root][INFO] - Score: 33.11 [%]  |  Evaluation Time: 0.57 [s]
[2024-09-26 19:14:49,972][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 19:14:49,972][root][INFO] - Score: 24.59 [%]  |  Evaluation Time: 0.56 [s]
[2024-09-26 19:14:49,973][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 19:14:49,974][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 19:14:51,983][root][INFO] - Step: 45/105  |  Loss: 1.3163  |  Score: 67.03 [%]  |  Seq Length: 256.0
[2024-09-26 19:14:52,550][root][INFO] - Step: 45/1350  |  Loss: 2.0055  |  Score: 31.05 [%]  |  Seq Length: 256.0
[2024-09-26 19:14:53,698][root][INFO] - Step: 49/105  |  Loss: 1.0308  |  Score: 76.43 [%]  |  Seq Length: 256.0
[2024-09-26 19:14:54,238][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 19:14:54,238][root][INFO] - Score: 42.57 [%]  |  Evaluation Time: 0.54 [s]
[2024-09-26 19:14:54,771][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 19:14:54,772][root][INFO] - Score: 29.53 [%]  |  Evaluation Time: 0.53 [s]
[2024-09-26 19:14:54,773][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-26 19:14:54,774][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 19:14:54,897][root][INFO] - Step: 1050/1350  |  Loss: 0.3647  |  Score: 89.17 [%]  |  Seq Length: 256.0
[2024-09-26 19:14:58,402][root][INFO] - Step: 56/105  |  Loss: 0.8798  |  Score: 78.22 [%]  |  Seq Length: 256.0
[2024-09-26 19:14:58,981][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 19:14:58,981][root][INFO] - Score: 44.83 [%]  |  Evaluation Time: 0.58 [s]
[2024-09-26 19:14:59,536][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 19:14:59,536][root][INFO] - Score: 31.74 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-26 19:14:59,537][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-26 19:14:59,538][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 19:15:00,343][root][INFO] - Step: 60/1350  |  Loss: 1.7076  |  Score: 46.00 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:00,648][root][INFO] - Step: 1065/1350  |  Loss: 0.3357  |  Score: 90.24 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:01,957][root][INFO] - Step: 60/105  |  Loss: 0.8011  |  Score: 83.25 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:03,201][root][INFO] - Step: 63/105  |  Loss: 0.7272  |  Score: 82.80 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:03,778][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 19:15:03,778][root][INFO] - Score: 48.26 [%]  |  Evaluation Time: 0.57 [s]
[2024-09-26 19:15:04,328][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 19:15:04,328][root][INFO] - Score: 34.06 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-26 19:15:04,329][root][INFO] - 
Save new Best Score (Epoch: 9)
[2024-09-26 19:15:04,330][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 19:15:06,420][root][INFO] - Step: 1080/1350  |  Loss: 0.3591  |  Score: 88.90 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:08,143][root][INFO] - Step: 70/105  |  Loss: 0.6515  |  Score: 85.48 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:08,228][root][INFO] - Step: 75/1350  |  Loss: 1.7771  |  Score: 48.57 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:08,735][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 19:15:08,735][root][INFO] - Score: 49.11 [%]  |  Evaluation Time: 0.59 [s]
[2024-09-26 19:15:09,252][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 19:15:09,252][root][INFO] - Score: 34.46 [%]  |  Evaluation Time: 0.51 [s]
[2024-09-26 19:15:09,253][root][INFO] - 
Save new Best Score (Epoch: 10)
[2024-09-26 19:15:09,254][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 19:15:10,353][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 19:15:10,353][root][INFO] - Score: 78.18 [%]  |  Evaluation Time: 3.93 [s]
[2024-09-26 19:15:12,150][root][INFO] - Step: 75/105  |  Loss: 0.5578  |  Score: 87.52 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:12,938][root][INFO] - Step: 77/105  |  Loss: 0.6099  |  Score: 83.07 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:13,516][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 19:15:13,516][root][INFO] - Score: 51.45 [%]  |  Evaluation Time: 0.57 [s]
[2024-09-26 19:15:14,056][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 19:15:14,056][root][INFO] - Score: 34.10 [%]  |  Evaluation Time: 0.54 [s]
[2024-09-26 19:15:14,057][root][INFO] - 
Save new Best Score (Epoch: 11)
[2024-09-26 19:15:14,058][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 19:15:14,077][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 19:15:14,077][root][INFO] - Score: 69.60 [%]  |  Evaluation Time: 3.72 [s]
[2024-09-26 19:15:14,080][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 19:15:14,781][root][INFO] - Step: 1081/1350  |  Loss: 0.3147  |  Score: 90.39 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:16,035][root][INFO] - Step: 90/1350  |  Loss: 1.5274  |  Score: 59.38 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:17,618][root][INFO] - Step: 84/105  |  Loss: 0.5482  |  Score: 86.47 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:18,205][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 19:15:18,205][root][INFO] - Score: 50.74 [%]  |  Evaluation Time: 0.58 [s]
[2024-09-26 19:15:18,744][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 19:15:18,744][root][INFO] - Score: 34.79 [%]  |  Evaluation Time: 0.54 [s]
[2024-09-26 19:15:18,746][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 19:15:20,129][root][INFO] - Step: 1095/1350  |  Loss: 0.3275  |  Score: 90.69 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:22,140][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 19:15:22,140][root][INFO] - Score: 70.39 [%]  |  Evaluation Time: 6.10 [s]
[2024-09-26 19:15:22,149][root][INFO] - Step: 90/105  |  Loss: 0.5294  |  Score: 87.94 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:22,432][root][INFO] - Step: 91/105  |  Loss: 0.1926  |  Score: 91.51 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:22,991][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 19:15:22,991][root][INFO] - Score: 49.68 [%]  |  Evaluation Time: 0.56 [s]
[2024-09-26 19:15:23,538][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 19:15:23,538][root][INFO] - Score: 35.19 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-26 19:15:23,541][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 19:15:25,854][root][INFO] - Step: 1110/1350  |  Loss: 0.3412  |  Score: 90.89 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:27,278][root][INFO] - Step: 98/105  |  Loss: 0.5661  |  Score: 87.33 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:27,855][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 19:15:27,855][root][INFO] - Score: 49.45 [%]  |  Evaluation Time: 0.57 [s]
[2024-09-26 19:15:27,909][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 19:15:27,910][root][INFO] - Score: 63.34 [%]  |  Evaluation Time: 5.77 [s]
[2024-09-26 19:15:27,910][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 19:15:27,912][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 19:15:28,415][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 19:15:28,415][root][INFO] - Score: 35.51 [%]  |  Evaluation Time: 0.56 [s]
[2024-09-26 19:15:28,417][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 19:15:28,988][root][INFO] - Step: 91/1350  |  Loss: 1.5417  |  Score: 54.62 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:31,578][root][INFO] - Step: 1125/1350  |  Loss: 0.3459  |  Score: 88.91 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:32,224][root][INFO] - Step: 105/105  |  Loss: 0.5620  |  Score: 88.42 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:32,797][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 19:15:32,797][root][INFO] - Score: 49.59 [%]  |  Evaluation Time: 0.57 [s]
[2024-09-26 19:15:33,344][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 19:15:33,345][root][INFO] - Score: 35.29 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-26 19:15:33,346][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 19:15:33,346][root][INFO] - - Epoch: 11
[2024-09-26 19:15:33,346][root][INFO] - - DEV score: 51.45 [%]
[2024-09-26 19:15:33,346][root][INFO] - - TEST score: 34.10 [%]
[2024-09-26 19:15:33,347][root][INFO] - Fine-tuning is done!
[2024-09-26 19:15:36,319][root][INFO] - Step: 105/1350  |  Loss: 1.3443  |  Score: 58.01 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:37,298][root][INFO] - Step: 1140/1350  |  Loss: 0.3141  |  Score: 90.59 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:40,115][root][INFO] - 

[2024-09-26 19:15:40,115][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 19:15:40,115][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:15:40,115][root][INFO] - 

[2024-09-26 19:15:40,116][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko', 'do_hangeulize': False, 'data_remove': False, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 19:15:43,021][root][INFO] - Step: 1155/1350  |  Loss: 0.3530  |  Score: 89.36 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:44,138][root][INFO] - Step: 120/1350  |  Loss: 1.1961  |  Score: 64.87 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:44,967][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 19:15:44,967][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 19:15:44,967][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 19:15:44,968][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 19:15:44,968][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 19:15:44,969][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 19:15:44,969][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 19:15:44,970][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 19:15:44,970][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 19:15:44,970][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 19:15:44,971][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 19:15:44,971][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 19:15:44,972][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 19:15:44,972][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 19:15:44,973][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 19:15:44,973][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 19:15:44,973][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 19:15:44,974][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 19:15:44,974][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 19:15:44,975][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 19:15:44,975][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 19:15:44,976][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 19:15:44,976][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 19:15:44,976][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 19:15:44,978][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 19:15:45,376][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 19:15:48,781][root][INFO] - Step: 1170/1350  |  Loss: 0.3460  |  Score: 89.01 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:49,360][root][INFO] - 

[2024-09-26 19:15:49,360][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 19:15:49,361][root][INFO] - Data Preprocessing
[2024-09-26 19:15:49,361][root][INFO] - ㄴ remain_lang                ko
[2024-09-26 19:15:49,361][root][INFO] - ㄴ do_hangeulize              False
[2024-09-26 19:15:49,361][root][INFO] - ㄴ data_remove                False

[2024-09-26 19:15:49,361][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 19:15:49,369][root][INFO] - vocab size              : 51200
[2024-09-26 19:15:49,369][root][INFO] - device                  : gpu
[2024-09-26 19:15:49,369][root][INFO] - random seed             : 42
[2024-09-26 19:15:49,369][root][INFO] - train data size         : 5760
[2024-09-26 19:15:49,369][root][INFO] - max epochs              : 15
[2024-09-26 19:15:49,369][root][INFO] - total steps             : 1350
[2024-09-26 19:15:49,369][root][INFO] - warmup steps            : 135
[2024-09-26 19:15:49,369][root][INFO] - batch size              : 64
[2024-09-26 19:15:49,369][root][INFO] - accumulation steps      : 1
[2024-09-26 19:15:49,369][root][INFO] - optimizer               : adamwscale
[2024-09-26 19:15:49,370][root][INFO] - lr_scheduler            : cosine
[2024-09-26 19:15:49,370][root][INFO] - learning rate           : 0.01
[2024-09-26 19:15:49,370][root][INFO] - max length              : 256

[2024-09-26 19:15:49,370][root][INFO] - LoRA Configuration
[2024-09-26 19:15:49,370][root][INFO] - ㄴ r                    : 32
[2024-09-26 19:15:49,370][root][INFO] - ㄴ alpha                : 128
[2024-09-26 19:15:49,370][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 19:15:49,370][root][INFO] - 

[2024-09-26 19:15:49,370][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:15:49,370][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 19:15:49,370][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 19:15:49,371][root][INFO] - * tb interval   : 15

[2024-09-26 19:15:49,371][root][INFO] - 

[2024-09-26 19:15:49,371][root][INFO] - Start the Training !
[2024-09-26 19:15:49,373][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 19:15:51,740][root][INFO] - Step: 135/1350  |  Loss: 1.3501  |  Score: 63.05 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:52,707][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 19:15:52,707][root][INFO] - Score: 78.02 [%]  |  Evaluation Time: 3.92 [s]
[2024-09-26 19:15:56,211][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 19:15:56,211][root][INFO] - Score: 70.60 [%]  |  Evaluation Time: 3.50 [s]
[2024-09-26 19:15:56,213][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 19:15:57,070][root][INFO] - Step: 1171/1350  |  Loss: 0.4364  |  Score: 81.05 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:57,880][root][INFO] - Step: 15/1350  |  Loss: 3.2422  |  Score: 4.00 [%]  |  Seq Length: 256.0
[2024-09-26 19:15:59,322][root][INFO] - Step: 150/1350  |  Loss: 1.2757  |  Score: 59.45 [%]  |  Seq Length: 256.0
[2024-09-26 19:16:02,412][root][INFO] - Step: 1185/1350  |  Loss: 0.3672  |  Score: 89.94 [%]  |  Seq Length: 256.0
[2024-09-26 19:16:03,375][root][INFO] - Step: 30/1350  |  Loss: 2.2856  |  Score: 19.47 [%]  |  Seq Length: 256.0
[2024-09-26 19:16:06,934][root][INFO] - Step: 165/1350  |  Loss: 1.1385  |  Score: 65.11 [%]  |  Seq Length: 256.0
[2024-09-26 19:16:08,138][root][INFO] - Step: 1200/1350  |  Loss: 0.3312  |  Score: 89.31 [%]  |  Seq Length: 256.0
[2024-09-26 19:16:08,869][root][INFO] - Step: 45/1350  |  Loss: 2.0151  |  Score: 31.23 [%]  |  Seq Length: 256.0
[2024-09-26 19:16:13,859][root][INFO] - Step: 1215/1350  |  Loss: 0.3186  |  Score: 90.60 [%]  |  Seq Length: 256.0
[2024-09-26 19:16:14,370][root][INFO] - Step: 60/1350  |  Loss: 1.6495  |  Score: 51.14 [%]  |  Seq Length: 256.0
[2024-09-26 19:16:14,529][root][INFO] - Step: 180/1350  |  Loss: 1.2561  |  Score: 66.29 [%]  |  Seq Length: 256.0
[2024-09-26 19:16:19,582][root][INFO] - Step: 1230/1350  |  Loss: 0.3177  |  Score: 90.51 [%]  |  Seq Length: 256.0
[2024-09-26 19:16:19,871][root][INFO] - Step: 75/1350  |  Loss: 1.4615  |  Score: 58.95 [%]  |  Seq Length: 256.0
[2024-09-26 19:16:20,760][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 19:16:20,760][root][INFO] - Score: 75.20 [%]  |  Evaluation Time: 6.23 [s]
[2024-09-26 19:16:25,306][root][INFO] - Step: 1245/1350  |  Loss: 0.3292  |  Score: 88.74 [%]  |  Seq Length: 256.0
[2024-09-26 19:16:25,374][root][INFO] - Step: 90/1350  |  Loss: 1.4239  |  Score: 57.16 [%]  |  Seq Length: 256.0
[2024-09-26 19:16:26,581][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 19:16:26,581][root][INFO] - Score: 69.38 [%]  |  Evaluation Time: 5.82 [s]
[2024-09-26 19:16:26,582][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 19:16:26,584][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 19:16:27,453][root][INFO] - Step: 181/1350  |  Loss: 1.0339  |  Score: 76.05 [%]  |  Seq Length: 256.0
[2024-09-26 19:16:29,314][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 19:16:29,314][root][INFO] - Score: 71.81 [%]  |  Evaluation Time: 3.94 [s]
[2024-09-26 19:16:31,049][root][INFO] - Step: 1260/1350  |  Loss: 0.3259  |  Score: 91.16 [%]  |  Seq Length: 256.0
[2024-09-26 19:16:32,890][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 19:16:32,890][root][INFO] - Score: 65.52 [%]  |  Evaluation Time: 3.57 [s]
[2024-09-26 19:16:32,891][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 19:16:32,892][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 19:16:33,630][root][INFO] - Step: 91/1350  |  Loss: 1.0584  |  Score: 72.61 [%]  |  Seq Length: 256.0
[2024-09-26 19:16:34,769][root][INFO] - Step: 195/1350  |  Loss: 0.9548  |  Score: 69.82 [%]  |  Seq Length: 256.0
[2024-09-26 19:16:34,936][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 19:16:34,936][root][INFO] - Score: 77.86 [%]  |  Evaluation Time: 3.88 [s]
[2024-09-26 19:16:38,477][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 19:16:38,477][root][INFO] - Score: 69.86 [%]  |  Evaluation Time: 3.54 [s]
[2024-09-26 19:16:38,479][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 19:16:38,815][root][INFO] - Step: 105/1350  |  Loss: 1.3413  |  Score: 64.48 [%]  |  Seq Length: 256.0
[2024-09-26 19:16:39,198][root][INFO] - Step: 1261/1350  |  Loss: 0.4024  |  Score: 87.63 [%]  |  Seq Length: 256.0
[2024-09-26 19:16:42,676][root][INFO] - Step: 210/1350  |  Loss: 1.0120  |  Score: 69.82 [%]  |  Seq Length: 256.0
[2024-09-26 19:16:44,369][root][INFO] - Step: 120/1350  |  Loss: 1.3422  |  Score: 63.97 [%]  |  Seq Length: 256.0
[2024-09-26 19:16:44,537][root][INFO] - Step: 1275/1350  |  Loss: 0.3348  |  Score: 90.50 [%]  |  Seq Length: 256.0
[2024-09-26 19:16:49,927][root][INFO] - Step: 135/1350  |  Loss: 1.2283  |  Score: 64.07 [%]  |  Seq Length: 256.0
[2024-09-26 19:16:50,257][root][INFO] - Step: 1290/1350  |  Loss: 0.3462  |  Score: 89.23 [%]  |  Seq Length: 256.0
[2024-09-26 19:16:50,583][root][INFO] - Step: 225/1350  |  Loss: 1.1145  |  Score: 67.19 [%]  |  Seq Length: 256.0
[2024-09-26 19:16:55,491][root][INFO] - Step: 150/1350  |  Loss: 1.1478  |  Score: 66.92 [%]  |  Seq Length: 256.0
[2024-09-26 19:16:55,976][root][INFO] - Step: 1305/1350  |  Loss: 0.3340  |  Score: 89.34 [%]  |  Seq Length: 256.0
[2024-09-26 19:16:58,382][root][INFO] - Step: 240/1350  |  Loss: 1.0503  |  Score: 70.86 [%]  |  Seq Length: 256.0
[2024-09-26 19:17:01,056][root][INFO] - Step: 165/1350  |  Loss: 1.1800  |  Score: 64.74 [%]  |  Seq Length: 256.0
[2024-09-26 19:17:01,697][root][INFO] - Step: 1320/1350  |  Loss: 0.3239  |  Score: 90.52 [%]  |  Seq Length: 256.0
[2024-09-26 19:17:06,144][root][INFO] - Step: 255/1350  |  Loss: 1.0437  |  Score: 67.22 [%]  |  Seq Length: 256.0
[2024-09-26 19:17:06,651][root][INFO] - Step: 180/1350  |  Loss: 1.0836  |  Score: 63.98 [%]  |  Seq Length: 256.0
[2024-09-26 19:17:07,419][root][INFO] - Step: 1335/1350  |  Loss: 0.3343  |  Score: 90.40 [%]  |  Seq Length: 256.0
[2024-09-26 19:17:10,586][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 19:17:10,586][root][INFO] - Score: 76.16 [%]  |  Evaluation Time: 3.93 [s]
[2024-09-26 19:17:13,155][root][INFO] - Step: 1350/1350  |  Loss: 0.3132  |  Score: 90.16 [%]  |  Seq Length: 256.0
[2024-09-26 19:17:13,981][root][INFO] - Step: 270/1350  |  Loss: 1.0467  |  Score: 69.16 [%]  |  Seq Length: 256.0
[2024-09-26 19:17:14,287][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 19:17:14,288][root][INFO] - Score: 68.48 [%]  |  Evaluation Time: 3.70 [s]
[2024-09-26 19:17:14,289][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 19:17:14,290][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 19:17:15,036][root][INFO] - Step: 181/1350  |  Loss: 0.8556  |  Score: 75.15 [%]  |  Seq Length: 256.0
[2024-09-26 19:17:17,074][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 19:17:17,074][root][INFO] - Score: 77.71 [%]  |  Evaluation Time: 3.92 [s]
[2024-09-26 19:17:20,229][root][INFO] - Step: 195/1350  |  Loss: 1.0277  |  Score: 69.42 [%]  |  Seq Length: 256.0
[2024-09-26 19:17:20,321][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 19:17:20,321][root][INFO] - Score: 76.04 [%]  |  Evaluation Time: 6.34 [s]
[2024-09-26 19:17:20,782][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 19:17:20,782][root][INFO] - Score: 70.64 [%]  |  Evaluation Time: 3.71 [s]
[2024-09-26 19:17:20,783][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 19:17:20,783][root][INFO] - - Epoch: 5
[2024-09-26 19:17:20,784][root][INFO] - - DEV score: 79.40 [%]
[2024-09-26 19:17:20,784][root][INFO] - - TEST score: 70.74 [%]
[2024-09-26 19:17:20,785][root][INFO] - Fine-tuning is done!
[2024-09-26 19:17:25,760][root][INFO] - Step: 210/1350  |  Loss: 1.0556  |  Score: 69.49 [%]  |  Seq Length: 256.0
[2024-09-26 19:17:26,264][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 19:17:26,265][root][INFO] - Score: 69.62 [%]  |  Evaluation Time: 5.94 [s]
[2024-09-26 19:17:26,266][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 19:17:26,267][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 19:17:26,959][root][INFO] - 

[2024-09-26 19:17:26,959][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 19:17:26,959][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:17:26,959][root][INFO] - 

[2024-09-26 19:17:26,959][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': False, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 19:17:27,224][root][INFO] - Step: 271/1350  |  Loss: 0.7795  |  Score: 79.57 [%]  |  Seq Length: 256.0
[2024-09-26 19:17:31,284][root][INFO] - Step: 225/1350  |  Loss: 1.0132  |  Score: 71.54 [%]  |  Seq Length: 256.0
[2024-09-26 19:17:31,470][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 19:17:31,471][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 19:17:31,471][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 19:17:31,472][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 19:17:31,472][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 19:17:31,473][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 19:17:31,473][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 19:17:31,473][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 19:17:31,474][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 19:17:31,474][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 19:17:31,475][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 19:17:31,475][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 19:17:31,476][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 19:17:31,476][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 19:17:31,476][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 19:17:31,477][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 19:17:31,477][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 19:17:31,478][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 19:17:31,478][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 19:17:31,478][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 19:17:31,479][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 19:17:31,479][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 19:17:31,480][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 19:17:31,480][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 19:17:31,482][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 19:17:31,485][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-26 19:17:31,589][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-26 19:17:31,592][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-26 19:17:32,015][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 19:17:34,487][root][INFO] - Step: 285/1350  |  Loss: 0.9423  |  Score: 74.37 [%]  |  Seq Length: 256.0
[2024-09-26 19:17:36,810][root][INFO] - Step: 240/1350  |  Loss: 1.0809  |  Score: 68.82 [%]  |  Seq Length: 256.0
[2024-09-26 19:17:38,735][root][INFO] - 

[2024-09-26 19:17:38,736][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 19:17:38,736][root][INFO] - Data Preprocessing
[2024-09-26 19:17:38,736][root][INFO] - ㄴ remain_lang                ko_en_punc
[2024-09-26 19:17:38,736][root][INFO] - ㄴ do_hangeulize              True
[2024-09-26 19:17:38,737][root][INFO] - ㄴ data_remove                False

[2024-09-26 19:17:38,737][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 19:17:38,748][root][INFO] - vocab size              : 51200
[2024-09-26 19:17:38,749][root][INFO] - device                  : gpu
[2024-09-26 19:17:38,749][root][INFO] - random seed             : 42
[2024-09-26 19:17:38,749][root][INFO] - train data size         : 5760
[2024-09-26 19:17:38,749][root][INFO] - max epochs              : 15
[2024-09-26 19:17:38,749][root][INFO] - total steps             : 1350
[2024-09-26 19:17:38,749][root][INFO] - warmup steps            : 135
[2024-09-26 19:17:38,749][root][INFO] - batch size              : 64
[2024-09-26 19:17:38,749][root][INFO] - accumulation steps      : 1
[2024-09-26 19:17:38,750][root][INFO] - optimizer               : adamwscale
[2024-09-26 19:17:38,750][root][INFO] - lr_scheduler            : cosine
[2024-09-26 19:17:38,750][root][INFO] - learning rate           : 0.01
[2024-09-26 19:17:38,750][root][INFO] - max length              : 256

[2024-09-26 19:17:38,750][root][INFO] - LoRA Configuration
[2024-09-26 19:17:38,750][root][INFO] - ㄴ r                    : 32
[2024-09-26 19:17:38,750][root][INFO] - ㄴ alpha                : 128
[2024-09-26 19:17:38,751][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 19:17:38,751][root][INFO] - KOMBO Configuration
[2024-09-26 19:17:38,751][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-26 19:17:38,751][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-26 19:17:38,751][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-26 19:17:38,751][root][INFO] - ㄴ do_combination       : True
[2024-09-26 19:17:38,751][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-26 19:17:38,752][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-26 19:17:38,752][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-26 19:17:38,752][root][INFO] -   ㄴ add_lora           : True

[2024-09-26 19:17:38,752][root][INFO] - LoRA in KOMBO Configuration
[2024-09-26 19:17:38,752][root][INFO] - ㄴ r                : 32
[2024-09-26 19:17:38,752][root][INFO] - ㄴ alpha            : 128
[2024-09-26 19:17:38,752][root][INFO] - ㄴ dropout          : 0.03

[2024-09-26 19:17:38,753][root][INFO] - 

[2024-09-26 19:17:38,753][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:17:38,753][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 19:17:38,753][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 19:17:38,753][root][INFO] - * tb interval   : 15

[2024-09-26 19:17:38,753][root][INFO] - 

[2024-09-26 19:17:38,753][root][INFO] - Start the Training !
[2024-09-26 19:17:38,757][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 19:17:42,309][root][INFO] - Step: 300/1350  |  Loss: 1.2870  |  Score: 71.69 [%]  |  Seq Length: 256.0
[2024-09-26 19:17:42,335][root][INFO] - Step: 255/1350  |  Loss: 1.0621  |  Score: 69.37 [%]  |  Seq Length: 256.0
[2024-09-26 19:17:47,890][root][INFO] - Step: 270/1350  |  Loss: 1.0043  |  Score: 70.11 [%]  |  Seq Length: 256.0
[2024-09-26 19:17:48,059][root][INFO] - Step: 15/1350  |  Loss: 3.3258  |  Score: 5.30 [%]  |  Seq Length: 256.0
[2024-09-26 19:17:50,055][root][INFO] - Step: 315/1350  |  Loss: 0.9794  |  Score: 72.35 [%]  |  Seq Length: 256.0
[2024-09-26 19:17:51,681][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 19:17:51,681][root][INFO] - Score: 77.89 [%]  |  Evaluation Time: 3.79 [s]
[2024-09-26 19:17:55,224][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 19:17:55,224][root][INFO] - Score: 69.11 [%]  |  Evaluation Time: 3.54 [s]
[2024-09-26 19:17:55,225][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 19:17:55,226][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 19:17:55,933][root][INFO] - Step: 271/1350  |  Loss: 0.8061  |  Score: 84.48 [%]  |  Seq Length: 256.0
[2024-09-26 19:17:56,041][root][INFO] - Step: 30/1350  |  Loss: 2.1102  |  Score: 25.15 [%]  |  Seq Length: 256.0
[2024-09-26 19:17:57,884][root][INFO] - Step: 330/1350  |  Loss: 0.9444  |  Score: 75.01 [%]  |  Seq Length: 256.0
[2024-09-26 19:18:01,072][root][INFO] - Step: 285/1350  |  Loss: 0.8382  |  Score: 75.00 [%]  |  Seq Length: 256.0
[2024-09-26 19:18:03,994][root][INFO] - Step: 45/1350  |  Loss: 2.0126  |  Score: 30.02 [%]  |  Seq Length: 256.0
[2024-09-26 19:18:05,751][root][INFO] - Step: 345/1350  |  Loss: 0.8692  |  Score: 76.15 [%]  |  Seq Length: 256.0
[2024-09-26 19:18:06,584][root][INFO] - Step: 300/1350  |  Loss: 0.9521  |  Score: 73.63 [%]  |  Seq Length: 256.0
[2024-09-26 19:18:12,102][root][INFO] - Step: 315/1350  |  Loss: 0.9803  |  Score: 74.79 [%]  |  Seq Length: 256.0
[2024-09-26 19:18:12,139][root][INFO] - Step: 60/1350  |  Loss: 1.6854  |  Score: 49.29 [%]  |  Seq Length: 256.0
[2024-09-26 19:18:13,614][root][INFO] - Step: 360/1350  |  Loss: 0.8872  |  Score: 74.68 [%]  |  Seq Length: 256.0
[2024-09-26 19:18:17,620][root][INFO] - Step: 330/1350  |  Loss: 0.8840  |  Score: 73.09 [%]  |  Seq Length: 256.0
[2024-09-26 19:18:19,898][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 19:18:19,898][root][INFO] - Score: 73.43 [%]  |  Evaluation Time: 6.28 [s]
[2024-09-26 19:18:20,111][root][INFO] - Step: 75/1350  |  Loss: 1.5074  |  Score: 51.36 [%]  |  Seq Length: 256.0
[2024-09-26 19:18:23,137][root][INFO] - Step: 345/1350  |  Loss: 0.8729  |  Score: 73.90 [%]  |  Seq Length: 256.0
[2024-09-26 19:18:25,724][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 19:18:25,724][root][INFO] - Score: 68.89 [%]  |  Evaluation Time: 5.82 [s]
[2024-09-26 19:18:25,726][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 19:18:26,596][root][INFO] - Step: 361/1350  |  Loss: 0.7428  |  Score: 78.24 [%]  |  Seq Length: 256.0
[2024-09-26 19:18:28,152][root][INFO] - Step: 90/1350  |  Loss: 1.4207  |  Score: 61.58 [%]  |  Seq Length: 256.0
[2024-09-26 19:18:28,681][root][INFO] - Step: 360/1350  |  Loss: 0.8353  |  Score: 75.59 [%]  |  Seq Length: 256.0
[2024-09-26 19:18:32,489][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 19:18:32,490][root][INFO] - Score: 77.63 [%]  |  Evaluation Time: 3.81 [s]
[2024-09-26 19:18:33,878][root][INFO] - Step: 375/1350  |  Loss: 0.7300  |  Score: 79.80 [%]  |  Seq Length: 256.0
[2024-09-26 19:18:34,408][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 19:18:34,408][root][INFO] - Score: 71.58 [%]  |  Evaluation Time: 6.25 [s]
[2024-09-26 19:18:36,006][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 19:18:36,006][root][INFO] - Score: 70.05 [%]  |  Evaluation Time: 3.51 [s]
[2024-09-26 19:18:36,007][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-26 19:18:36,008][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 19:18:36,750][root][INFO] - Step: 361/1350  |  Loss: 0.9335  |  Score: 83.70 [%]  |  Seq Length: 256.0
[2024-09-26 19:18:40,095][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 19:18:40,096][root][INFO] - Score: 64.93 [%]  |  Evaluation Time: 5.68 [s]
[2024-09-26 19:18:40,097][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 19:18:40,098][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 19:18:41,202][root][INFO] - Step: 91/1350  |  Loss: 1.4876  |  Score: 60.41 [%]  |  Seq Length: 256.0
[2024-09-26 19:18:41,747][root][INFO] - Step: 390/1350  |  Loss: 0.8632  |  Score: 74.55 [%]  |  Seq Length: 256.0
[2024-09-26 19:18:41,905][root][INFO] - Step: 375/1350  |  Loss: 0.7194  |  Score: 77.17 [%]  |  Seq Length: 256.0
[2024-09-26 19:18:47,421][root][INFO] - Step: 390/1350  |  Loss: 0.7745  |  Score: 78.90 [%]  |  Seq Length: 256.0
[2024-09-26 19:18:48,670][root][INFO] - Step: 105/1350  |  Loss: 1.3265  |  Score: 59.78 [%]  |  Seq Length: 256.0
[2024-09-26 19:18:49,515][root][INFO] - Step: 405/1350  |  Loss: 0.8278  |  Score: 76.89 [%]  |  Seq Length: 256.0
[2024-09-26 19:18:52,981][root][INFO] - Step: 405/1350  |  Loss: 0.7926  |  Score: 77.30 [%]  |  Seq Length: 256.0
[2024-09-26 19:18:56,667][root][INFO] - Step: 120/1350  |  Loss: 1.2460  |  Score: 63.20 [%]  |  Seq Length: 256.0
[2024-09-26 19:18:57,299][root][INFO] - Step: 420/1350  |  Loss: 0.7502  |  Score: 77.48 [%]  |  Seq Length: 256.0
[2024-09-26 19:18:58,497][root][INFO] - Step: 420/1350  |  Loss: 0.7567  |  Score: 78.38 [%]  |  Seq Length: 256.0
[2024-09-26 19:19:04,010][root][INFO] - Step: 435/1350  |  Loss: 0.8490  |  Score: 77.84 [%]  |  Seq Length: 256.0
[2024-09-26 19:19:04,641][root][INFO] - Step: 135/1350  |  Loss: 1.3414  |  Score: 64.12 [%]  |  Seq Length: 256.0
[2024-09-26 19:19:05,110][root][INFO] - Step: 435/1350  |  Loss: 0.7909  |  Score: 76.99 [%]  |  Seq Length: 256.0
[2024-09-26 19:19:09,566][root][INFO] - Step: 450/1350  |  Loss: 0.7937  |  Score: 77.42 [%]  |  Seq Length: 256.0
[2024-09-26 19:19:12,665][root][INFO] - Step: 150/1350  |  Loss: 1.2251  |  Score: 64.09 [%]  |  Seq Length: 256.0
[2024-09-26 19:19:12,928][root][INFO] - Step: 450/1350  |  Loss: 0.8513  |  Score: 73.89 [%]  |  Seq Length: 256.0
[2024-09-26 19:19:13,460][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 19:19:13,461][root][INFO] - Score: 78.71 [%]  |  Evaluation Time: 3.89 [s]
[2024-09-26 19:19:17,119][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 19:19:17,119][root][INFO] - Score: 70.39 [%]  |  Evaluation Time: 3.66 [s]
[2024-09-26 19:19:17,120][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 19:19:17,121][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 19:19:17,867][root][INFO] - Step: 451/1350  |  Loss: 0.7436  |  Score: 77.68 [%]  |  Seq Length: 256.0
[2024-09-26 19:19:19,235][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 19:19:19,236][root][INFO] - Score: 77.68 [%]  |  Evaluation Time: 6.30 [s]
[2024-09-26 19:19:20,726][root][INFO] - Step: 165/1350  |  Loss: 1.1337  |  Score: 65.55 [%]  |  Seq Length: 256.0
[2024-09-26 19:19:23,018][root][INFO] - Step: 465/1350  |  Loss: 0.6585  |  Score: 79.53 [%]  |  Seq Length: 256.0
[2024-09-26 19:19:25,010][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 19:19:25,010][root][INFO] - Score: 71.51 [%]  |  Evaluation Time: 5.77 [s]
[2024-09-26 19:19:25,011][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 19:19:25,012][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 19:19:25,870][root][INFO] - Step: 451/1350  |  Loss: 0.7345  |  Score: 85.72 [%]  |  Seq Length: 256.0
[2024-09-26 19:19:28,539][root][INFO] - Step: 480/1350  |  Loss: 0.6612  |  Score: 80.96 [%]  |  Seq Length: 256.0
[2024-09-26 19:19:28,769][root][INFO] - Step: 180/1350  |  Loss: 1.0584  |  Score: 68.23 [%]  |  Seq Length: 256.0
[2024-09-26 19:19:33,157][root][INFO] - Step: 465/1350  |  Loss: 0.7074  |  Score: 79.66 [%]  |  Seq Length: 256.0
[2024-09-26 19:19:34,055][root][INFO] - Step: 495/1350  |  Loss: 0.6882  |  Score: 81.25 [%]  |  Seq Length: 256.0
[2024-09-26 19:19:35,124][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 19:19:35,124][root][INFO] - Score: 75.99 [%]  |  Evaluation Time: 6.35 [s]
[2024-09-26 19:19:39,571][root][INFO] - Step: 510/1350  |  Loss: 0.7674  |  Score: 79.62 [%]  |  Seq Length: 256.0
[2024-09-26 19:19:40,741][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 19:19:40,741][root][INFO] - Score: 69.46 [%]  |  Evaluation Time: 5.61 [s]
[2024-09-26 19:19:40,742][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 19:19:40,743][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 19:19:40,966][root][INFO] - Step: 480/1350  |  Loss: 0.7295  |  Score: 81.75 [%]  |  Seq Length: 256.0
[2024-09-26 19:19:41,637][root][INFO] - Step: 181/1350  |  Loss: 0.8602  |  Score: 80.20 [%]  |  Seq Length: 256.0
[2024-09-26 19:19:45,085][root][INFO] - Step: 525/1350  |  Loss: 0.7616  |  Score: 81.63 [%]  |  Seq Length: 256.0
[2024-09-26 19:19:48,766][root][INFO] - Step: 495/1350  |  Loss: 0.6575  |  Score: 80.63 [%]  |  Seq Length: 256.0
[2024-09-26 19:19:49,087][root][INFO] - Step: 195/1350  |  Loss: 1.0091  |  Score: 69.63 [%]  |  Seq Length: 256.0
[2024-09-26 19:19:50,653][root][INFO] - Step: 540/1350  |  Loss: 0.6719  |  Score: 81.64 [%]  |  Seq Length: 256.0
[2024-09-26 19:19:54,439][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 19:19:54,439][root][INFO] - Score: 78.09 [%]  |  Evaluation Time: 3.78 [s]
[2024-09-26 19:19:56,584][root][INFO] - Step: 510/1350  |  Loss: 0.7393  |  Score: 80.37 [%]  |  Seq Length: 256.0
[2024-09-26 19:19:57,103][root][INFO] - Step: 210/1350  |  Loss: 0.9973  |  Score: 69.89 [%]  |  Seq Length: 256.0
[2024-09-26 19:19:57,958][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 19:19:57,958][root][INFO] - Score: 69.67 [%]  |  Evaluation Time: 3.52 [s]
[2024-09-26 19:19:57,960][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 19:19:58,686][root][INFO] - Step: 541/1350  |  Loss: 0.5039  |  Score: 88.68 [%]  |  Seq Length: 256.0
[2024-09-26 19:20:03,839][root][INFO] - Step: 555/1350  |  Loss: 0.6022  |  Score: 83.34 [%]  |  Seq Length: 256.0
[2024-09-26 19:20:04,330][root][INFO] - Step: 525/1350  |  Loss: 0.7664  |  Score: 76.02 [%]  |  Seq Length: 256.0
[2024-09-26 19:20:05,090][root][INFO] - Step: 225/1350  |  Loss: 1.0472  |  Score: 67.49 [%]  |  Seq Length: 256.0
[2024-09-26 19:20:09,368][root][INFO] - Step: 570/1350  |  Loss: 0.5826  |  Score: 82.61 [%]  |  Seq Length: 256.0
[2024-09-26 19:20:12,195][root][INFO] - Step: 540/1350  |  Loss: 0.7019  |  Score: 78.99 [%]  |  Seq Length: 256.0
[2024-09-26 19:20:13,056][root][INFO] - Step: 240/1350  |  Loss: 1.0141  |  Score: 71.02 [%]  |  Seq Length: 256.0
[2024-09-26 19:20:14,882][root][INFO] - Step: 585/1350  |  Loss: 0.6392  |  Score: 82.24 [%]  |  Seq Length: 256.0
[2024-09-26 19:20:18,445][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 19:20:18,445][root][INFO] - Score: 76.57 [%]  |  Evaluation Time: 6.25 [s]
[2024-09-26 19:20:20,398][root][INFO] - Step: 600/1350  |  Loss: 0.5817  |  Score: 83.03 [%]  |  Seq Length: 256.0
[2024-09-26 19:20:20,986][root][INFO] - Step: 255/1350  |  Loss: 1.0588  |  Score: 66.87 [%]  |  Seq Length: 256.0
[2024-09-26 19:20:24,244][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 19:20:24,244][root][INFO] - Score: 71.31 [%]  |  Evaluation Time: 5.80 [s]
[2024-09-26 19:20:24,246][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 19:20:25,190][root][INFO] - Step: 541/1350  |  Loss: 0.7111  |  Score: 80.47 [%]  |  Seq Length: 256.0
[2024-09-26 19:20:25,911][root][INFO] - Step: 615/1350  |  Loss: 0.5947  |  Score: 82.00 [%]  |  Seq Length: 256.0
[2024-09-26 19:20:29,048][root][INFO] - Step: 270/1350  |  Loss: 1.0805  |  Score: 68.15 [%]  |  Seq Length: 256.0
[2024-09-26 19:20:31,487][root][INFO] - Step: 630/1350  |  Loss: 0.6533  |  Score: 80.23 [%]  |  Seq Length: 256.0
[2024-09-26 19:20:32,478][root][INFO] - Step: 555/1350  |  Loss: 0.7230  |  Score: 83.06 [%]  |  Seq Length: 256.0
[2024-09-26 19:20:35,405][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 19:20:35,405][root][INFO] - Score: 77.36 [%]  |  Evaluation Time: 3.91 [s]
[2024-09-26 19:20:35,446][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 19:20:35,446][root][INFO] - Score: 77.21 [%]  |  Evaluation Time: 6.39 [s]
[2024-09-26 19:20:39,034][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 19:20:39,034][root][INFO] - Score: 71.94 [%]  |  Evaluation Time: 3.63 [s]
[2024-09-26 19:20:39,035][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-26 19:20:39,036][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 19:20:39,815][root][INFO] - Step: 631/1350  |  Loss: 0.5920  |  Score: 89.49 [%]  |  Seq Length: 256.0
[2024-09-26 19:20:40,265][root][INFO] - Step: 570/1350  |  Loss: 0.6069  |  Score: 84.29 [%]  |  Seq Length: 256.0
[2024-09-26 19:20:41,313][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 19:20:41,314][root][INFO] - Score: 69.54 [%]  |  Evaluation Time: 5.87 [s]
[2024-09-26 19:20:41,315][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 19:20:41,316][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 19:20:42,388][root][INFO] - Step: 271/1350  |  Loss: 0.7978  |  Score: 79.68 [%]  |  Seq Length: 256.0
[2024-09-26 19:20:45,016][root][INFO] - Step: 645/1350  |  Loss: 0.5190  |  Score: 85.53 [%]  |  Seq Length: 256.0
[2024-09-26 19:20:48,152][root][INFO] - Step: 585/1350  |  Loss: 0.5870  |  Score: 81.92 [%]  |  Seq Length: 256.0
[2024-09-26 19:20:49,884][root][INFO] - Step: 285/1350  |  Loss: 0.9204  |  Score: 74.77 [%]  |  Seq Length: 256.0
[2024-09-26 19:20:50,543][root][INFO] - Step: 660/1350  |  Loss: 0.5563  |  Score: 83.79 [%]  |  Seq Length: 256.0
[2024-09-26 19:20:55,981][root][INFO] - Step: 600/1350  |  Loss: 0.5580  |  Score: 82.40 [%]  |  Seq Length: 256.0
[2024-09-26 19:20:56,065][root][INFO] - Step: 675/1350  |  Loss: 0.5296  |  Score: 85.37 [%]  |  Seq Length: 256.0
[2024-09-26 19:20:58,002][root][INFO] - Step: 300/1350  |  Loss: 1.0639  |  Score: 71.82 [%]  |  Seq Length: 256.0
[2024-09-26 19:21:01,588][root][INFO] - Step: 690/1350  |  Loss: 0.5480  |  Score: 84.04 [%]  |  Seq Length: 256.0
[2024-09-26 19:21:03,841][root][INFO] - Step: 615/1350  |  Loss: 0.6111  |  Score: 82.49 [%]  |  Seq Length: 256.0
[2024-09-26 19:21:06,107][root][INFO] - Step: 315/1350  |  Loss: 0.8747  |  Score: 74.09 [%]  |  Seq Length: 256.0
[2024-09-26 19:21:07,113][root][INFO] - Step: 705/1350  |  Loss: 0.5784  |  Score: 84.44 [%]  |  Seq Length: 256.0
[2024-09-26 19:21:11,674][root][INFO] - Step: 630/1350  |  Loss: 0.6720  |  Score: 80.49 [%]  |  Seq Length: 256.0
[2024-09-26 19:21:12,686][root][INFO] - Step: 720/1350  |  Loss: 0.6043  |  Score: 83.63 [%]  |  Seq Length: 256.0
[2024-09-26 19:21:14,138][root][INFO] - Step: 330/1350  |  Loss: 0.8828  |  Score: 75.84 [%]  |  Seq Length: 256.0
[2024-09-26 19:21:16,490][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 19:21:16,490][root][INFO] - Score: 78.35 [%]  |  Evaluation Time: 3.80 [s]
[2024-09-26 19:21:17,812][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 19:21:17,812][root][INFO] - Score: 78.15 [%]  |  Evaluation Time: 6.13 [s]
[2024-09-26 19:21:20,059][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 19:21:20,059][root][INFO] - Score: 71.35 [%]  |  Evaluation Time: 3.57 [s]
[2024-09-26 19:21:20,060][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-26 19:21:20,061][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 19:21:20,917][root][INFO] - Step: 721/1350  |  Loss: 0.4556  |  Score: 88.61 [%]  |  Seq Length: 256.0
[2024-09-26 19:21:22,173][root][INFO] - Step: 345/1350  |  Loss: 0.8404  |  Score: 75.01 [%]  |  Seq Length: 256.0
[2024-09-26 19:21:23,436][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 19:21:23,436][root][INFO] - Score: 71.86 [%]  |  Evaluation Time: 5.62 [s]
[2024-09-26 19:21:23,437][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-26 19:21:23,438][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 19:21:24,506][root][INFO] - Step: 631/1350  |  Loss: 0.4163  |  Score: 90.97 [%]  |  Seq Length: 256.0
[2024-09-26 19:21:26,075][root][INFO] - Step: 735/1350  |  Loss: 0.4585  |  Score: 86.19 [%]  |  Seq Length: 256.0
[2024-09-26 19:21:30,256][root][INFO] - Step: 360/1350  |  Loss: 0.9129  |  Score: 74.69 [%]  |  Seq Length: 256.0
[2024-09-26 19:21:31,598][root][INFO] - Step: 750/1350  |  Loss: 0.4820  |  Score: 85.72 [%]  |  Seq Length: 256.0
[2024-09-26 19:21:31,807][root][INFO] - Step: 645/1350  |  Loss: 0.5589  |  Score: 84.36 [%]  |  Seq Length: 256.0
[2024-09-26 19:21:36,762][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 19:21:36,762][root][INFO] - Score: 75.91 [%]  |  Evaluation Time: 6.50 [s]
[2024-09-26 19:21:37,118][root][INFO] - Step: 765/1350  |  Loss: 0.4845  |  Score: 85.83 [%]  |  Seq Length: 256.0
[2024-09-26 19:21:39,668][root][INFO] - Step: 660/1350  |  Loss: 0.5291  |  Score: 85.44 [%]  |  Seq Length: 256.0
[2024-09-26 19:21:42,545][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 19:21:42,545][root][INFO] - Score: 70.06 [%]  |  Evaluation Time: 5.78 [s]
[2024-09-26 19:21:42,547][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 19:21:42,637][root][INFO] - Step: 780/1350  |  Loss: 0.4652  |  Score: 85.80 [%]  |  Seq Length: 256.0
[2024-09-26 19:21:43,749][root][INFO] - Step: 361/1350  |  Loss: 0.7296  |  Score: 79.24 [%]  |  Seq Length: 256.0
[2024-09-26 19:21:47,514][root][INFO] - Step: 675/1350  |  Loss: 0.5353  |  Score: 84.65 [%]  |  Seq Length: 256.0
[2024-09-26 19:21:48,181][root][INFO] - Step: 795/1350  |  Loss: 0.4731  |  Score: 86.22 [%]  |  Seq Length: 256.0
[2024-09-26 19:21:51,357][root][INFO] - Step: 375/1350  |  Loss: 0.7319  |  Score: 79.35 [%]  |  Seq Length: 256.0
[2024-09-26 19:21:53,782][root][INFO] - Step: 810/1350  |  Loss: 0.4747  |  Score: 86.64 [%]  |  Seq Length: 256.0
[2024-09-26 19:21:55,408][root][INFO] - Step: 690/1350  |  Loss: 0.5198  |  Score: 83.85 [%]  |  Seq Length: 256.0
[2024-09-26 19:21:57,634][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 19:21:57,634][root][INFO] - Score: 78.47 [%]  |  Evaluation Time: 3.85 [s]
[2024-09-26 19:21:59,374][root][INFO] - Step: 390/1350  |  Loss: 0.8186  |  Score: 74.83 [%]  |  Seq Length: 256.0
[2024-09-26 19:22:01,147][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 19:22:01,148][root][INFO] - Score: 71.77 [%]  |  Evaluation Time: 3.51 [s]
[2024-09-26 19:22:01,148][root][INFO] - 
Save new Best Score (Epoch: 9)
[2024-09-26 19:22:01,149][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 19:22:01,995][root][INFO] - Step: 811/1350  |  Loss: 0.3932  |  Score: 90.53 [%]  |  Seq Length: 256.0
[2024-09-26 19:22:03,328][root][INFO] - Step: 705/1350  |  Loss: 0.5672  |  Score: 83.75 [%]  |  Seq Length: 256.0
[2024-09-26 19:22:07,149][root][INFO] - Step: 825/1350  |  Loss: 0.3904  |  Score: 88.24 [%]  |  Seq Length: 256.0
[2024-09-26 19:22:07,360][root][INFO] - Step: 405/1350  |  Loss: 0.8193  |  Score: 76.72 [%]  |  Seq Length: 256.0
[2024-09-26 19:22:11,154][root][INFO] - Step: 720/1350  |  Loss: 0.5703  |  Score: 84.48 [%]  |  Seq Length: 256.0
[2024-09-26 19:22:12,672][root][INFO] - Step: 840/1350  |  Loss: 0.3949  |  Score: 87.31 [%]  |  Seq Length: 256.0
[2024-09-26 19:22:15,377][root][INFO] - Step: 420/1350  |  Loss: 0.7872  |  Score: 77.68 [%]  |  Seq Length: 256.0
[2024-09-26 19:22:17,284][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 19:22:17,285][root][INFO] - Score: 77.51 [%]  |  Evaluation Time: 6.13 [s]
[2024-09-26 19:22:18,193][root][INFO] - Step: 855/1350  |  Loss: 0.4121  |  Score: 87.04 [%]  |  Seq Length: 256.0
[2024-09-26 19:22:23,098][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 19:22:23,099][root][INFO] - Score: 70.61 [%]  |  Evaluation Time: 5.81 [s]
[2024-09-26 19:22:23,101][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 19:22:23,409][root][INFO] - Step: 435/1350  |  Loss: 0.7805  |  Score: 78.16 [%]  |  Seq Length: 256.0
[2024-09-26 19:22:23,716][root][INFO] - Step: 870/1350  |  Loss: 0.4468  |  Score: 88.29 [%]  |  Seq Length: 256.0
[2024-09-26 19:22:23,994][root][INFO] - Step: 721/1350  |  Loss: 0.4210  |  Score: 84.63 [%]  |  Seq Length: 256.0
[2024-09-26 19:22:29,238][root][INFO] - Step: 885/1350  |  Loss: 0.4052  |  Score: 88.31 [%]  |  Seq Length: 256.0
[2024-09-26 19:22:31,339][root][INFO] - Step: 735/1350  |  Loss: 0.4796  |  Score: 86.95 [%]  |  Seq Length: 256.0
[2024-09-26 19:22:31,400][root][INFO] - Step: 450/1350  |  Loss: 0.7903  |  Score: 73.82 [%]  |  Seq Length: 256.0
[2024-09-26 19:22:34,802][root][INFO] - Step: 900/1350  |  Loss: 0.4528  |  Score: 87.49 [%]  |  Seq Length: 256.0
[2024-09-26 19:22:37,884][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 19:22:37,884][root][INFO] - Score: 76.84 [%]  |  Evaluation Time: 6.48 [s]
[2024-09-26 19:22:38,631][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 19:22:38,632][root][INFO] - Score: 78.80 [%]  |  Evaluation Time: 3.83 [s]
[2024-09-26 19:22:39,206][root][INFO] - Step: 750/1350  |  Loss: 0.4572  |  Score: 86.76 [%]  |  Seq Length: 256.0
[2024-09-26 19:22:42,196][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 19:22:42,199][root][INFO] - Score: 71.26 [%]  |  Evaluation Time: 3.56 [s]
[2024-09-26 19:22:42,204][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 19:22:43,017][root][INFO] - Step: 901/1350  |  Loss: 0.4352  |  Score: 85.88 [%]  |  Seq Length: 256.0
[2024-09-26 19:22:43,743][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 19:22:43,743][root][INFO] - Score: 70.60 [%]  |  Evaluation Time: 5.86 [s]
[2024-09-26 19:22:43,744][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 19:22:43,745][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 19:22:44,788][root][INFO] - Step: 451/1350  |  Loss: 0.6466  |  Score: 88.22 [%]  |  Seq Length: 256.0
[2024-09-26 19:22:47,012][root][INFO] - Step: 765/1350  |  Loss: 0.4914  |  Score: 85.52 [%]  |  Seq Length: 256.0
[2024-09-26 19:22:48,178][root][INFO] - Step: 915/1350  |  Loss: 0.3676  |  Score: 88.68 [%]  |  Seq Length: 256.0
[2024-09-26 19:22:52,316][root][INFO] - Step: 465/1350  |  Loss: 0.6575  |  Score: 80.29 [%]  |  Seq Length: 256.0
[2024-09-26 19:22:53,713][root][INFO] - Step: 930/1350  |  Loss: 0.3754  |  Score: 88.70 [%]  |  Seq Length: 256.0
[2024-09-26 19:22:54,840][root][INFO] - Step: 780/1350  |  Loss: 0.4825  |  Score: 86.62 [%]  |  Seq Length: 256.0
[2024-09-26 19:22:59,245][root][INFO] - Step: 945/1350  |  Loss: 0.3804  |  Score: 89.38 [%]  |  Seq Length: 256.0
[2024-09-26 19:23:00,299][root][INFO] - Step: 480/1350  |  Loss: 0.7925  |  Score: 79.88 [%]  |  Seq Length: 256.0
[2024-09-26 19:23:02,690][root][INFO] - Step: 795/1350  |  Loss: 0.4849  |  Score: 86.81 [%]  |  Seq Length: 256.0
[2024-09-26 19:23:04,778][root][INFO] - Step: 960/1350  |  Loss: 0.3899  |  Score: 88.89 [%]  |  Seq Length: 256.0
[2024-09-26 19:23:08,305][root][INFO] - Step: 495/1350  |  Loss: 0.6386  |  Score: 81.12 [%]  |  Seq Length: 256.0
[2024-09-26 19:23:10,308][root][INFO] - Step: 975/1350  |  Loss: 0.3907  |  Score: 88.24 [%]  |  Seq Length: 256.0
[2024-09-26 19:23:10,520][root][INFO] - Step: 810/1350  |  Loss: 0.4405  |  Score: 86.58 [%]  |  Seq Length: 256.0
[2024-09-26 19:23:15,883][root][INFO] - Step: 990/1350  |  Loss: 0.3702  |  Score: 88.67 [%]  |  Seq Length: 256.0
[2024-09-26 19:23:16,295][root][INFO] - Step: 510/1350  |  Loss: 0.7724  |  Score: 80.06 [%]  |  Seq Length: 256.0
[2024-09-26 19:23:16,702][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 19:23:16,702][root][INFO] - Score: 76.83 [%]  |  Evaluation Time: 6.18 [s]
[2024-09-26 19:23:19,716][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 19:23:19,716][root][INFO] - Score: 79.10 [%]  |  Evaluation Time: 3.83 [s]
[2024-09-26 19:23:22,298][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 19:23:22,298][root][INFO] - Score: 70.15 [%]  |  Evaluation Time: 5.59 [s]
[2024-09-26 19:23:22,300][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 19:23:23,228][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 19:23:23,228][root][INFO] - Score: 71.55 [%]  |  Evaluation Time: 3.51 [s]
[2024-09-26 19:23:23,229][root][INFO] - 
Save new Best Score (Epoch: 11)
[2024-09-26 19:23:23,230][root][INFO] - Step: 811/1350  |  Loss: 0.3086  |  Score: 91.95 [%]  |  Seq Length: 256.0
[2024-09-26 19:23:23,230][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 19:23:23,954][root][INFO] - Step: 991/1350  |  Loss: 0.2823  |  Score: 90.79 [%]  |  Seq Length: 256.0
[2024-09-26 19:23:24,226][root][INFO] - Step: 525/1350  |  Loss: 0.7016  |  Score: 77.87 [%]  |  Seq Length: 256.0
[2024-09-26 19:23:29,118][root][INFO] - Step: 1005/1350  |  Loss: 0.3769  |  Score: 89.02 [%]  |  Seq Length: 256.0
[2024-09-26 19:23:30,511][root][INFO] - Step: 825/1350  |  Loss: 0.4267  |  Score: 88.02 [%]  |  Seq Length: 256.0
[2024-09-26 19:23:32,314][root][INFO] - Step: 540/1350  |  Loss: 0.6282  |  Score: 80.15 [%]  |  Seq Length: 256.0
[2024-09-26 19:23:34,649][root][INFO] - Step: 1020/1350  |  Loss: 0.3620  |  Score: 89.52 [%]  |  Seq Length: 256.0
[2024-09-26 19:23:38,369][root][INFO] - Step: 840/1350  |  Loss: 0.4684  |  Score: 86.39 [%]  |  Seq Length: 256.0
[2024-09-26 19:23:38,635][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 19:23:38,635][root][INFO] - Score: 76.87 [%]  |  Evaluation Time: 6.32 [s]
[2024-09-26 19:23:40,181][root][INFO] - Step: 1035/1350  |  Loss: 0.3666  |  Score: 88.30 [%]  |  Seq Length: 256.0
[2024-09-26 19:23:44,679][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 19:23:44,679][root][INFO] - Score: 71.52 [%]  |  Evaluation Time: 6.04 [s]
[2024-09-26 19:23:44,680][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 19:23:44,681][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 19:23:45,584][root][INFO] - Step: 541/1350  |  Loss: 0.5423  |  Score: 85.51 [%]  |  Seq Length: 256.0
[2024-09-26 19:23:45,708][root][INFO] - Step: 1050/1350  |  Loss: 0.3399  |  Score: 90.19 [%]  |  Seq Length: 256.0
[2024-09-26 19:23:46,224][root][INFO] - Step: 855/1350  |  Loss: 0.4294  |  Score: 88.51 [%]  |  Seq Length: 256.0
[2024-09-26 19:23:51,235][root][INFO] - Step: 1065/1350  |  Loss: 0.3219  |  Score: 90.59 [%]  |  Seq Length: 256.0
[2024-09-26 19:23:53,069][root][INFO] - Step: 555/1350  |  Loss: 0.6291  |  Score: 82.88 [%]  |  Seq Length: 256.0
[2024-09-26 19:23:54,048][root][INFO] - Step: 870/1350  |  Loss: 0.4404  |  Score: 87.10 [%]  |  Seq Length: 256.0
[2024-09-26 19:23:56,809][root][INFO] - Step: 1080/1350  |  Loss: 0.3168  |  Score: 89.90 [%]  |  Seq Length: 256.0
[2024-09-26 19:24:00,724][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 19:24:00,724][root][INFO] - Score: 78.29 [%]  |  Evaluation Time: 3.91 [s]
[2024-09-26 19:24:01,027][root][INFO] - Step: 570/1350  |  Loss: 0.6195  |  Score: 85.17 [%]  |  Seq Length: 256.0
[2024-09-26 19:24:01,865][root][INFO] - Step: 885/1350  |  Loss: 0.4510  |  Score: 86.77 [%]  |  Seq Length: 256.0
[2024-09-26 19:24:04,388][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 19:24:04,388][root][INFO] - Score: 70.30 [%]  |  Evaluation Time: 3.66 [s]
[2024-09-26 19:24:04,391][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 19:24:05,130][root][INFO] - Step: 1081/1350  |  Loss: 0.3557  |  Score: 87.79 [%]  |  Seq Length: 256.0
[2024-09-26 19:24:09,131][root][INFO] - Step: 585/1350  |  Loss: 0.6318  |  Score: 82.07 [%]  |  Seq Length: 256.0
[2024-09-26 19:24:09,681][root][INFO] - Step: 900/1350  |  Loss: 0.4424  |  Score: 86.45 [%]  |  Seq Length: 256.0
[2024-09-26 19:24:10,343][root][INFO] - Step: 1095/1350  |  Loss: 0.3406  |  Score: 90.47 [%]  |  Seq Length: 256.0
[2024-09-26 19:24:15,894][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 19:24:15,895][root][INFO] - Score: 76.91 [%]  |  Evaluation Time: 6.21 [s]
[2024-09-26 19:24:15,924][root][INFO] - Step: 1110/1350  |  Loss: 0.3409  |  Score: 90.88 [%]  |  Seq Length: 256.0
[2024-09-26 19:24:17,170][root][INFO] - Step: 600/1350  |  Loss: 0.5399  |  Score: 81.91 [%]  |  Seq Length: 256.0
[2024-09-26 19:24:21,486][root][INFO] - Step: 1125/1350  |  Loss: 0.3537  |  Score: 89.27 [%]  |  Seq Length: 256.0
[2024-09-26 19:24:21,639][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 19:24:21,640][root][INFO] - Score: 71.23 [%]  |  Evaluation Time: 5.74 [s]
[2024-09-26 19:24:21,642][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 19:24:22,662][root][INFO] - Step: 901/1350  |  Loss: 0.3985  |  Score: 91.49 [%]  |  Seq Length: 256.0
[2024-09-26 19:24:25,200][root][INFO] - Step: 615/1350  |  Loss: 0.5939  |  Score: 83.09 [%]  |  Seq Length: 256.0
[2024-09-26 19:24:27,023][root][INFO] - Step: 1140/1350  |  Loss: 0.3080  |  Score: 90.31 [%]  |  Seq Length: 256.0
[2024-09-26 19:24:29,906][root][INFO] - Step: 915/1350  |  Loss: 0.3809  |  Score: 88.15 [%]  |  Seq Length: 256.0
[2024-09-26 19:24:32,555][root][INFO] - Step: 1155/1350  |  Loss: 0.2965  |  Score: 90.99 [%]  |  Seq Length: 256.0
[2024-09-26 19:24:33,265][root][INFO] - Step: 630/1350  |  Loss: 0.6724  |  Score: 80.07 [%]  |  Seq Length: 256.0
[2024-09-26 19:24:37,609][root][INFO] - Step: 930/1350  |  Loss: 0.3794  |  Score: 88.20 [%]  |  Seq Length: 256.0
[2024-09-26 19:24:38,143][root][INFO] - Step: 1170/1350  |  Loss: 0.3594  |  Score: 88.51 [%]  |  Seq Length: 256.0
[2024-09-26 19:24:39,563][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 19:24:39,563][root][INFO] - Score: 77.90 [%]  |  Evaluation Time: 6.29 [s]
[2024-09-26 19:24:42,000][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 19:24:42,001][root][INFO] - Score: 79.24 [%]  |  Evaluation Time: 3.85 [s]
[2024-09-26 19:24:45,239][root][INFO] - Step: 945/1350  |  Loss: 0.3787  |  Score: 87.79 [%]  |  Seq Length: 256.0
[2024-09-26 19:24:45,308][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 19:24:45,308][root][INFO] - Score: 71.04 [%]  |  Evaluation Time: 5.74 [s]
[2024-09-26 19:24:45,309][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-26 19:24:45,311][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 19:24:45,559][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 19:24:45,560][root][INFO] - Score: 71.17 [%]  |  Evaluation Time: 3.56 [s]
[2024-09-26 19:24:45,563][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 19:24:46,285][root][INFO] - Step: 631/1350  |  Loss: 0.5242  |  Score: 84.01 [%]  |  Seq Length: 256.0
[2024-09-26 19:24:46,304][root][INFO] - Step: 1171/1350  |  Loss: 0.4284  |  Score: 82.46 [%]  |  Seq Length: 256.0
[2024-09-26 19:24:51,473][root][INFO] - Step: 1185/1350  |  Loss: 0.3370  |  Score: 90.64 [%]  |  Seq Length: 256.0
[2024-09-26 19:24:52,808][root][INFO] - Step: 960/1350  |  Loss: 0.3871  |  Score: 88.96 [%]  |  Seq Length: 256.0
[2024-09-26 19:24:53,799][root][INFO] - Step: 645/1350  |  Loss: 0.5344  |  Score: 83.84 [%]  |  Seq Length: 256.0
[2024-09-26 19:24:57,007][root][INFO] - Step: 1200/1350  |  Loss: 0.3277  |  Score: 89.61 [%]  |  Seq Length: 256.0
[2024-09-26 19:25:00,404][root][INFO] - Step: 975/1350  |  Loss: 0.3810  |  Score: 87.80 [%]  |  Seq Length: 256.0
[2024-09-26 19:25:01,867][root][INFO] - Step: 660/1350  |  Loss: 0.5093  |  Score: 85.19 [%]  |  Seq Length: 256.0
[2024-09-26 19:25:02,549][root][INFO] - Step: 1215/1350  |  Loss: 0.3034  |  Score: 91.80 [%]  |  Seq Length: 256.0
[2024-09-26 19:25:08,035][root][INFO] - Step: 990/1350  |  Loss: 0.4260  |  Score: 87.67 [%]  |  Seq Length: 256.0
[2024-09-26 19:25:08,084][root][INFO] - Step: 1230/1350  |  Loss: 0.3232  |  Score: 89.83 [%]  |  Seq Length: 256.0
[2024-09-26 19:25:09,901][root][INFO] - Step: 675/1350  |  Loss: 0.5985  |  Score: 82.82 [%]  |  Seq Length: 256.0
[2024-09-26 19:25:13,619][root][INFO] - Step: 1245/1350  |  Loss: 0.3235  |  Score: 88.75 [%]  |  Seq Length: 256.0
[2024-09-26 19:25:14,224][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 19:25:14,225][root][INFO] - Score: 77.16 [%]  |  Evaluation Time: 6.19 [s]
[2024-09-26 19:25:17,929][root][INFO] - Step: 690/1350  |  Loss: 0.5993  |  Score: 82.35 [%]  |  Seq Length: 256.0
[2024-09-26 19:25:19,183][root][INFO] - Step: 1260/1350  |  Loss: 0.3280  |  Score: 91.58 [%]  |  Seq Length: 256.0
[2024-09-26 19:25:19,910][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 19:25:19,910][root][INFO] - Score: 70.05 [%]  |  Evaluation Time: 5.68 [s]
[2024-09-26 19:25:19,912][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 19:25:20,825][root][INFO] - Step: 991/1350  |  Loss: 0.3392  |  Score: 90.80 [%]  |  Seq Length: 256.0
[2024-09-26 19:25:23,075][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 19:25:23,075][root][INFO] - Score: 78.63 [%]  |  Evaluation Time: 3.89 [s]
[2024-09-26 19:25:26,139][root][INFO] - Step: 705/1350  |  Loss: 0.5846  |  Score: 83.56 [%]  |  Seq Length: 256.0
[2024-09-26 19:25:26,782][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 19:25:26,782][root][INFO] - Score: 70.63 [%]  |  Evaluation Time: 3.70 [s]
[2024-09-26 19:25:26,785][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 19:25:27,574][root][INFO] - Step: 1261/1350  |  Loss: 0.2411  |  Score: 93.59 [%]  |  Seq Length: 256.0
[2024-09-26 19:25:28,116][root][INFO] - Step: 1005/1350  |  Loss: 0.3544  |  Score: 89.30 [%]  |  Seq Length: 256.0
[2024-09-26 19:25:32,749][root][INFO] - Step: 1275/1350  |  Loss: 0.3199  |  Score: 90.89 [%]  |  Seq Length: 256.0
[2024-09-26 19:25:34,104][root][INFO] - Step: 720/1350  |  Loss: 0.5687  |  Score: 84.10 [%]  |  Seq Length: 256.0
[2024-09-26 19:25:35,921][root][INFO] - Step: 1020/1350  |  Loss: 0.3414  |  Score: 89.40 [%]  |  Seq Length: 256.0
[2024-09-26 19:25:38,288][root][INFO] - Step: 1290/1350  |  Loss: 0.3214  |  Score: 90.37 [%]  |  Seq Length: 256.0
[2024-09-26 19:25:40,347][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 19:25:40,347][root][INFO] - Score: 77.57 [%]  |  Evaluation Time: 6.24 [s]
[2024-09-26 19:25:43,786][root][INFO] - Step: 1035/1350  |  Loss: 0.3351  |  Score: 90.70 [%]  |  Seq Length: 256.0
[2024-09-26 19:25:43,824][root][INFO] - Step: 1305/1350  |  Loss: 0.3169  |  Score: 90.24 [%]  |  Seq Length: 256.0
[2024-09-26 19:25:46,202][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 19:25:46,202][root][INFO] - Score: 70.75 [%]  |  Evaluation Time: 5.85 [s]
[2024-09-26 19:25:46,204][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 19:25:47,259][root][INFO] - Step: 721/1350  |  Loss: 0.4228  |  Score: 83.10 [%]  |  Seq Length: 256.0
[2024-09-26 19:25:49,357][root][INFO] - Step: 1320/1350  |  Loss: 0.3018  |  Score: 91.15 [%]  |  Seq Length: 256.0
[2024-09-26 19:25:51,663][root][INFO] - Step: 1050/1350  |  Loss: 0.3436  |  Score: 90.18 [%]  |  Seq Length: 256.0
[2024-09-26 19:25:54,890][root][INFO] - Step: 1335/1350  |  Loss: 0.3285  |  Score: 90.23 [%]  |  Seq Length: 256.0
[2024-09-26 19:25:54,907][root][INFO] - Step: 735/1350  |  Loss: 0.4887  |  Score: 86.31 [%]  |  Seq Length: 256.0
[2024-09-26 19:25:59,571][root][INFO] - Step: 1065/1350  |  Loss: 0.3554  |  Score: 89.63 [%]  |  Seq Length: 256.0
[2024-09-26 19:26:00,458][root][INFO] - Step: 1350/1350  |  Loss: 0.3202  |  Score: 90.68 [%]  |  Seq Length: 256.0
[2024-09-26 19:26:02,981][root][INFO] - Step: 750/1350  |  Loss: 0.5192  |  Score: 85.18 [%]  |  Seq Length: 256.0
[2024-09-26 19:26:04,464][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 19:26:04,465][root][INFO] - Score: 78.21 [%]  |  Evaluation Time: 4.00 [s]
[2024-09-26 19:26:07,415][root][INFO] - Step: 1080/1350  |  Loss: 0.3682  |  Score: 88.32 [%]  |  Seq Length: 256.0
[2024-09-26 19:26:08,078][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 19:26:08,079][root][INFO] - Score: 71.54 [%]  |  Evaluation Time: 3.61 [s]
[2024-09-26 19:26:08,080][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 19:26:08,080][root][INFO] - - Epoch: 11
[2024-09-26 19:26:08,080][root][INFO] - - DEV score: 79.10 [%]
[2024-09-26 19:26:08,080][root][INFO] - - TEST score: 71.55 [%]
[2024-09-26 19:26:08,081][root][INFO] - Fine-tuning is done!
[2024-09-26 19:26:11,002][root][INFO] - Step: 765/1350  |  Loss: 0.4951  |  Score: 85.34 [%]  |  Seq Length: 256.0
[2024-09-26 19:26:13,794][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 19:26:13,794][root][INFO] - Score: 77.73 [%]  |  Evaluation Time: 6.38 [s]
[2024-09-26 19:26:14,167][root][INFO] - 

[2024-09-26 19:26:14,167][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 19:26:14,167][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:26:14,167][root][INFO] - 

[2024-09-26 19:26:14,167][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko', 'do_hangeulize': False, 'data_remove': False, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 19:26:19,008][root][INFO] - Step: 780/1350  |  Loss: 0.4846  |  Score: 87.03 [%]  |  Seq Length: 256.0
[2024-09-26 19:26:19,417][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 19:26:19,417][root][INFO] - Score: 70.41 [%]  |  Evaluation Time: 5.62 [s]
[2024-09-26 19:26:19,422][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 19:26:19,446][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 19:26:19,447][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 19:26:19,447][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 19:26:19,448][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 19:26:19,449][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 19:26:19,449][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 19:26:19,450][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 19:26:19,450][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 19:26:19,451][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 19:26:19,451][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 19:26:19,452][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 19:26:19,452][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 19:26:19,453][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 19:26:19,453][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 19:26:19,454][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 19:26:19,454][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 19:26:19,455][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 19:26:19,455][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 19:26:19,456][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 19:26:19,456][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 19:26:19,457][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 19:26:19,457][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 19:26:19,458][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 19:26:19,458][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 19:26:19,460][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 19:26:19,464][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-26 19:26:19,572][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-26 19:26:19,574][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-26 19:26:20,028][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 19:26:20,465][root][INFO] - Step: 1081/1350  |  Loss: 0.3057  |  Score: 91.31 [%]  |  Seq Length: 256.0
[2024-09-26 19:26:26,935][root][INFO] - 

[2024-09-26 19:26:26,935][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 19:26:26,936][root][INFO] - Data Preprocessing
[2024-09-26 19:26:26,936][root][INFO] - ㄴ remain_lang                ko
[2024-09-26 19:26:26,936][root][INFO] - ㄴ do_hangeulize              False
[2024-09-26 19:26:26,936][root][INFO] - ㄴ data_remove                False

[2024-09-26 19:26:26,936][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 19:26:26,944][root][INFO] - vocab size              : 51200
[2024-09-26 19:26:26,944][root][INFO] - device                  : gpu
[2024-09-26 19:26:26,944][root][INFO] - random seed             : 42
[2024-09-26 19:26:26,944][root][INFO] - train data size         : 5760
[2024-09-26 19:26:26,945][root][INFO] - max epochs              : 15
[2024-09-26 19:26:26,945][root][INFO] - total steps             : 1350
[2024-09-26 19:26:26,945][root][INFO] - warmup steps            : 135
[2024-09-26 19:26:26,945][root][INFO] - batch size              : 64
[2024-09-26 19:26:26,945][root][INFO] - accumulation steps      : 1
[2024-09-26 19:26:26,945][root][INFO] - optimizer               : adamwscale
[2024-09-26 19:26:26,945][root][INFO] - lr_scheduler            : cosine
[2024-09-26 19:26:26,945][root][INFO] - learning rate           : 0.01
[2024-09-26 19:26:26,945][root][INFO] - max length              : 256

[2024-09-26 19:26:26,945][root][INFO] - LoRA Configuration
[2024-09-26 19:26:26,945][root][INFO] - ㄴ r                    : 32
[2024-09-26 19:26:26,945][root][INFO] - ㄴ alpha                : 128
[2024-09-26 19:26:26,946][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 19:26:26,946][root][INFO] - KOMBO Configuration
[2024-09-26 19:26:26,946][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-26 19:26:26,946][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-26 19:26:26,946][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-26 19:26:26,946][root][INFO] - ㄴ do_combination       : True
[2024-09-26 19:26:26,946][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-26 19:26:26,946][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-26 19:26:26,946][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-26 19:26:26,946][root][INFO] -   ㄴ add_lora           : True

[2024-09-26 19:26:26,947][root][INFO] - LoRA in KOMBO Configuration
[2024-09-26 19:26:26,947][root][INFO] - ㄴ r                : 32
[2024-09-26 19:26:26,947][root][INFO] - ㄴ alpha            : 128
[2024-09-26 19:26:26,947][root][INFO] - ㄴ dropout          : 0.03

[2024-09-26 19:26:26,947][root][INFO] - 

[2024-09-26 19:26:26,947][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:26:26,947][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 19:26:26,947][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 19:26:26,947][root][INFO] - * tb interval   : 15

[2024-09-26 19:26:26,947][root][INFO] - 

[2024-09-26 19:26:26,947][root][INFO] - Start the Training !
[2024-09-26 19:26:26,950][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 19:26:27,054][root][INFO] - Step: 795/1350  |  Loss: 0.4414  |  Score: 87.07 [%]  |  Seq Length: 256.0
[2024-09-26 19:26:27,785][root][INFO] - Step: 1095/1350  |  Loss: 0.3400  |  Score: 90.71 [%]  |  Seq Length: 256.0
[2024-09-26 19:26:35,190][root][INFO] - Step: 810/1350  |  Loss: 0.4861  |  Score: 85.24 [%]  |  Seq Length: 256.0
[2024-09-26 19:26:35,604][root][INFO] - Step: 1110/1350  |  Loss: 0.3473  |  Score: 89.89 [%]  |  Seq Length: 256.0
[2024-09-26 19:26:36,645][root][INFO] - Step: 15/1350  |  Loss: 3.3191  |  Score: 6.00 [%]  |  Seq Length: 256.0
[2024-09-26 19:26:41,620][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 19:26:41,621][root][INFO] - Score: 76.72 [%]  |  Evaluation Time: 6.43 [s]
[2024-09-26 19:26:43,422][root][INFO] - Step: 1125/1350  |  Loss: 0.3430  |  Score: 90.23 [%]  |  Seq Length: 256.0
[2024-09-26 19:26:44,524][root][INFO] - Step: 30/1350  |  Loss: 2.1255  |  Score: 24.65 [%]  |  Seq Length: 256.0
[2024-09-26 19:26:47,484][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 19:26:47,484][root][INFO] - Score: 70.09 [%]  |  Evaluation Time: 5.86 [s]
[2024-09-26 19:26:47,486][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 19:26:48,584][root][INFO] - Step: 811/1350  |  Loss: 0.3505  |  Score: 91.43 [%]  |  Seq Length: 256.0
[2024-09-26 19:26:51,269][root][INFO] - Step: 1140/1350  |  Loss: 0.3159  |  Score: 90.93 [%]  |  Seq Length: 256.0
[2024-09-26 19:26:52,323][root][INFO] - Step: 45/1350  |  Loss: 2.0225  |  Score: 30.50 [%]  |  Seq Length: 256.0
[2024-09-26 19:26:55,893][root][INFO] - Step: 825/1350  |  Loss: 0.4124  |  Score: 88.33 [%]  |  Seq Length: 256.0
[2024-09-26 19:26:59,107][root][INFO] - Step: 1155/1350  |  Loss: 0.3388  |  Score: 89.85 [%]  |  Seq Length: 256.0
[2024-09-26 19:27:00,208][root][INFO] - Step: 60/1350  |  Loss: 1.6694  |  Score: 48.11 [%]  |  Seq Length: 256.0
[2024-09-26 19:27:03,650][root][INFO] - Step: 840/1350  |  Loss: 0.4494  |  Score: 86.51 [%]  |  Seq Length: 256.0
[2024-09-26 19:27:06,975][root][INFO] - Step: 1170/1350  |  Loss: 0.3342  |  Score: 89.10 [%]  |  Seq Length: 256.0
[2024-09-26 19:27:08,066][root][INFO] - Step: 75/1350  |  Loss: 1.6414  |  Score: 50.80 [%]  |  Seq Length: 256.0
[2024-09-26 19:27:11,551][root][INFO] - Step: 855/1350  |  Loss: 0.4606  |  Score: 88.03 [%]  |  Seq Length: 256.0
[2024-09-26 19:27:13,122][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 19:27:13,122][root][INFO] - Score: 76.52 [%]  |  Evaluation Time: 6.14 [s]
[2024-09-26 19:27:15,943][root][INFO] - Step: 90/1350  |  Loss: 1.3530  |  Score: 61.34 [%]  |  Seq Length: 256.0
[2024-09-26 19:27:18,730][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 19:27:18,730][root][INFO] - Score: 71.62 [%]  |  Evaluation Time: 5.61 [s]
[2024-09-26 19:27:18,732][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 19:27:19,619][root][INFO] - Step: 1171/1350  |  Loss: 0.2772  |  Score: 94.15 [%]  |  Seq Length: 256.0
[2024-09-26 19:27:19,633][root][INFO] - Step: 870/1350  |  Loss: 0.4552  |  Score: 86.99 [%]  |  Seq Length: 256.0
[2024-09-26 19:27:22,224][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 19:27:22,224][root][INFO] - Score: 73.00 [%]  |  Evaluation Time: 6.28 [s]
[2024-09-26 19:27:26,928][root][INFO] - Step: 1185/1350  |  Loss: 0.3101  |  Score: 90.25 [%]  |  Seq Length: 256.0
[2024-09-26 19:27:27,620][root][INFO] - Step: 885/1350  |  Loss: 0.4542  |  Score: 86.88 [%]  |  Seq Length: 256.0
[2024-09-26 19:27:28,042][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 19:27:28,042][root][INFO] - Score: 65.43 [%]  |  Evaluation Time: 5.82 [s]
[2024-09-26 19:27:28,043][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 19:27:28,045][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 19:27:29,141][root][INFO] - Step: 91/1350  |  Loss: 1.2007  |  Score: 66.82 [%]  |  Seq Length: 256.0
[2024-09-26 19:27:34,780][root][INFO] - Step: 1200/1350  |  Loss: 0.3225  |  Score: 90.61 [%]  |  Seq Length: 256.0
[2024-09-26 19:27:35,618][root][INFO] - Step: 900/1350  |  Loss: 0.4722  |  Score: 85.92 [%]  |  Seq Length: 256.0
[2024-09-26 19:27:36,446][root][INFO] - Step: 105/1350  |  Loss: 1.2557  |  Score: 60.14 [%]  |  Seq Length: 256.0
[2024-09-26 19:27:41,865][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 19:27:41,865][root][INFO] - Score: 77.18 [%]  |  Evaluation Time: 6.24 [s]
[2024-09-26 19:27:42,624][root][INFO] - Step: 1215/1350  |  Loss: 0.3470  |  Score: 90.12 [%]  |  Seq Length: 256.0
[2024-09-26 19:27:44,291][root][INFO] - Step: 120/1350  |  Loss: 1.1452  |  Score: 66.75 [%]  |  Seq Length: 256.0
[2024-09-26 19:27:47,570][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 19:27:47,570][root][INFO] - Score: 71.31 [%]  |  Evaluation Time: 5.70 [s]
[2024-09-26 19:27:47,572][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 19:27:48,671][root][INFO] - Step: 901/1350  |  Loss: 0.3396  |  Score: 92.44 [%]  |  Seq Length: 256.0
[2024-09-26 19:27:50,429][root][INFO] - Step: 1230/1350  |  Loss: 0.3394  |  Score: 89.81 [%]  |  Seq Length: 256.0
[2024-09-26 19:27:52,138][root][INFO] - Step: 135/1350  |  Loss: 1.2420  |  Score: 67.24 [%]  |  Seq Length: 256.0
[2024-09-26 19:27:56,088][root][INFO] - Step: 915/1350  |  Loss: 0.4036  |  Score: 88.14 [%]  |  Seq Length: 256.0
[2024-09-26 19:27:58,235][root][INFO] - Step: 1245/1350  |  Loss: 0.3191  |  Score: 90.26 [%]  |  Seq Length: 256.0
[2024-09-26 19:27:59,984][root][INFO] - Step: 150/1350  |  Loss: 1.2823  |  Score: 61.97 [%]  |  Seq Length: 256.0
[2024-09-26 19:28:04,061][root][INFO] - Step: 930/1350  |  Loss: 0.3983  |  Score: 87.27 [%]  |  Seq Length: 256.0
[2024-09-26 19:28:06,103][root][INFO] - Step: 1260/1350  |  Loss: 0.3176  |  Score: 90.66 [%]  |  Seq Length: 256.0
[2024-09-26 19:28:07,843][root][INFO] - Step: 165/1350  |  Loss: 1.1282  |  Score: 66.70 [%]  |  Seq Length: 256.0
[2024-09-26 19:28:12,095][root][INFO] - Step: 945/1350  |  Loss: 0.4140  |  Score: 87.31 [%]  |  Seq Length: 256.0
[2024-09-26 19:28:12,361][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 19:28:12,361][root][INFO] - Score: 77.32 [%]  |  Evaluation Time: 6.25 [s]
[2024-09-26 19:28:15,783][root][INFO] - Step: 180/1350  |  Loss: 1.1777  |  Score: 67.60 [%]  |  Seq Length: 256.0
[2024-09-26 19:28:17,897][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 19:28:17,897][root][INFO] - Score: 70.50 [%]  |  Evaluation Time: 5.53 [s]
[2024-09-26 19:28:17,899][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 19:28:18,964][root][INFO] - Step: 1261/1350  |  Loss: 0.2798  |  Score: 91.06 [%]  |  Seq Length: 256.0
[2024-09-26 19:28:20,202][root][INFO] - Step: 960/1350  |  Loss: 0.3681  |  Score: 89.57 [%]  |  Seq Length: 256.0
[2024-09-26 19:28:22,068][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 19:28:22,068][root][INFO] - Score: 75.57 [%]  |  Evaluation Time: 6.28 [s]
[2024-09-26 19:28:26,274][root][INFO] - Step: 1275/1350  |  Loss: 0.3292  |  Score: 89.80 [%]  |  Seq Length: 256.0
[2024-09-26 19:28:27,708][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 19:28:27,708][root][INFO] - Score: 69.98 [%]  |  Evaluation Time: 5.64 [s]
[2024-09-26 19:28:27,709][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 19:28:27,710][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 19:28:28,445][root][INFO] - Step: 975/1350  |  Loss: 0.3819  |  Score: 88.30 [%]  |  Seq Length: 256.0
[2024-09-26 19:28:28,757][root][INFO] - Step: 181/1350  |  Loss: 0.9774  |  Score: 78.68 [%]  |  Seq Length: 256.0
[2024-09-26 19:28:34,286][root][INFO] - Step: 1290/1350  |  Loss: 0.3465  |  Score: 89.44 [%]  |  Seq Length: 256.0
[2024-09-26 19:28:36,034][root][INFO] - Step: 195/1350  |  Loss: 0.9672  |  Score: 71.70 [%]  |  Seq Length: 256.0
[2024-09-26 19:28:36,629][root][INFO] - Step: 990/1350  |  Loss: 0.4069  |  Score: 87.92 [%]  |  Seq Length: 256.0
[2024-09-26 19:28:42,162][root][INFO] - Step: 1305/1350  |  Loss: 0.3133  |  Score: 90.60 [%]  |  Seq Length: 256.0
[2024-09-26 19:28:43,013][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 19:28:43,013][root][INFO] - Score: 77.43 [%]  |  Evaluation Time: 6.38 [s]
[2024-09-26 19:28:43,961][root][INFO] - Step: 210/1350  |  Loss: 1.0994  |  Score: 70.49 [%]  |  Seq Length: 256.0
[2024-09-26 19:28:48,764][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 19:28:48,764][root][INFO] - Score: 70.47 [%]  |  Evaluation Time: 5.75 [s]
[2024-09-26 19:28:48,766][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 19:28:49,848][root][INFO] - Step: 991/1350  |  Loss: 0.3282  |  Score: 91.49 [%]  |  Seq Length: 256.0
[2024-09-26 19:28:50,038][root][INFO] - Step: 1320/1350  |  Loss: 0.3547  |  Score: 89.31 [%]  |  Seq Length: 256.0
[2024-09-26 19:28:51,835][root][INFO] - Step: 225/1350  |  Loss: 1.0821  |  Score: 69.22 [%]  |  Seq Length: 256.0
[2024-09-26 19:28:57,393][root][INFO] - Step: 1005/1350  |  Loss: 0.3904  |  Score: 88.55 [%]  |  Seq Length: 256.0
[2024-09-26 19:28:57,830][root][INFO] - Step: 1335/1350  |  Loss: 0.3147  |  Score: 90.61 [%]  |  Seq Length: 256.0
[2024-09-26 19:28:59,641][root][INFO] - Step: 240/1350  |  Loss: 1.0054  |  Score: 72.32 [%]  |  Seq Length: 256.0
[2024-09-26 19:29:05,485][root][INFO] - Step: 1020/1350  |  Loss: 0.3578  |  Score: 89.50 [%]  |  Seq Length: 256.0
[2024-09-26 19:29:05,667][root][INFO] - Step: 1350/1350  |  Loss: 0.3409  |  Score: 89.44 [%]  |  Seq Length: 256.0
[2024-09-26 19:29:07,475][root][INFO] - Step: 255/1350  |  Loss: 0.9884  |  Score: 69.02 [%]  |  Seq Length: 256.0
[2024-09-26 19:29:11,759][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 19:29:11,759][root][INFO] - Score: 77.49 [%]  |  Evaluation Time: 6.09 [s]
[2024-09-26 19:29:13,543][root][INFO] - Step: 1035/1350  |  Loss: 0.3624  |  Score: 89.70 [%]  |  Seq Length: 256.0
[2024-09-26 19:29:15,380][root][INFO] - Step: 270/1350  |  Loss: 0.9818  |  Score: 71.12 [%]  |  Seq Length: 256.0
[2024-09-26 19:29:17,511][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 19:29:17,511][root][INFO] - Score: 70.48 [%]  |  Evaluation Time: 5.75 [s]
[2024-09-26 19:29:17,512][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 19:29:17,512][root][INFO] - - Epoch: 7
[2024-09-26 19:29:17,512][root][INFO] - - DEV score: 78.15 [%]
[2024-09-26 19:29:17,512][root][INFO] - - TEST score: 71.86 [%]
[2024-09-26 19:29:17,513][root][INFO] - Fine-tuning is done!
[2024-09-26 19:29:21,561][root][INFO] - Step: 1050/1350  |  Loss: 0.3602  |  Score: 89.36 [%]  |  Seq Length: 256.0
[2024-09-26 19:29:21,639][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 19:29:21,639][root][INFO] - Score: 77.45 [%]  |  Evaluation Time: 6.25 [s]
[2024-09-26 19:29:24,067][root][INFO] - 

[2024-09-26 19:29:24,067][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 19:29:24,067][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:29:24,068][root][INFO] - 

[2024-09-26 19:29:24,068][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_punc', 'do_hangeulize': False, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 19:29:27,339][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 19:29:27,339][root][INFO] - Score: 70.63 [%]  |  Evaluation Time: 5.70 [s]
[2024-09-26 19:29:27,340][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 19:29:27,342][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 19:29:28,318][root][INFO] - Step: 271/1350  |  Loss: 0.8958  |  Score: 76.94 [%]  |  Seq Length: 256.0
[2024-09-26 19:29:28,727][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 19:29:28,727][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 19:29:28,728][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 19:29:28,728][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 19:29:28,728][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 19:29:28,729][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 19:29:28,729][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 19:29:28,730][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 19:29:28,730][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 19:29:28,731][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 19:29:28,731][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 19:29:28,732][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 19:29:28,732][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 19:29:28,733][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 19:29:28,733][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 19:29:28,734][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 19:29:28,734][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 19:29:28,734][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 19:29:28,735][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 19:29:28,735][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 19:29:28,736][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 19:29:28,737][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 19:29:28,737][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 19:29:28,738][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 19:29:28,739][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 19:29:28,922][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 19:29:29,581][root][INFO] - Step: 1065/1350  |  Loss: 0.3594  |  Score: 89.58 [%]  |  Seq Length: 256.0
[2024-09-26 19:29:32,943][root][INFO] - 

[2024-09-26 19:29:32,943][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 19:29:32,943][root][INFO] - Data Preprocessing
[2024-09-26 19:29:32,943][root][INFO] - ㄴ remain_lang                ko_punc
[2024-09-26 19:29:32,943][root][INFO] - ㄴ do_hangeulize              False
[2024-09-26 19:29:32,943][root][INFO] - ㄴ data_remove                True

[2024-09-26 19:29:32,943][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 19:29:32,951][root][INFO] - vocab size              : 51200
[2024-09-26 19:29:32,952][root][INFO] - device                  : gpu
[2024-09-26 19:29:32,952][root][INFO] - random seed             : 42
[2024-09-26 19:29:32,952][root][INFO] - train data size         : 4096
[2024-09-26 19:29:32,952][root][INFO] - max epochs              : 15
[2024-09-26 19:29:32,952][root][INFO] - total steps             : 960
[2024-09-26 19:29:32,952][root][INFO] - warmup steps            : 96
[2024-09-26 19:29:32,952][root][INFO] - batch size              : 64
[2024-09-26 19:29:32,952][root][INFO] - accumulation steps      : 1
[2024-09-26 19:29:32,952][root][INFO] - optimizer               : adamwscale
[2024-09-26 19:29:32,952][root][INFO] - lr_scheduler            : cosine
[2024-09-26 19:29:32,953][root][INFO] - learning rate           : 0.01
[2024-09-26 19:29:32,953][root][INFO] - max length              : 256

[2024-09-26 19:29:32,953][root][INFO] - LoRA Configuration
[2024-09-26 19:29:32,953][root][INFO] - ㄴ r                    : 32
[2024-09-26 19:29:32,953][root][INFO] - ㄴ alpha                : 128
[2024-09-26 19:29:32,953][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 19:29:32,953][root][INFO] - 

[2024-09-26 19:29:32,953][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:29:32,953][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 19:29:32,953][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 19:29:32,953][root][INFO] - * tb interval   : 15

[2024-09-26 19:29:32,953][root][INFO] - 

[2024-09-26 19:29:32,954][root][INFO] - Start the Training !
[2024-09-26 19:29:32,956][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 19:29:35,588][root][INFO] - Step: 285/1350  |  Loss: 0.8819  |  Score: 77.06 [%]  |  Seq Length: 256.0
[2024-09-26 19:29:37,515][root][INFO] - Step: 1080/1350  |  Loss: 0.3805  |  Score: 88.28 [%]  |  Seq Length: 256.0
[2024-09-26 19:29:41,360][root][INFO] - Step: 15/960  |  Loss: 3.2171  |  Score: 3.58 [%]  |  Seq Length: 256.0
[2024-09-26 19:29:43,563][root][INFO] - Step: 300/1350  |  Loss: 1.1605  |  Score: 73.52 [%]  |  Seq Length: 256.0
[2024-09-26 19:29:43,678][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 19:29:43,678][root][INFO] - Score: 77.32 [%]  |  Evaluation Time: 6.16 [s]
[2024-09-26 19:29:46,901][root][INFO] - Step: 30/960  |  Loss: 2.4091  |  Score: 21.72 [%]  |  Seq Length: 256.0
[2024-09-26 19:29:49,318][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 19:29:49,319][root][INFO] - Score: 70.76 [%]  |  Evaluation Time: 5.64 [s]
[2024-09-26 19:29:49,321][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 19:29:50,388][root][INFO] - Step: 1081/1350  |  Loss: 0.2600  |  Score: 93.81 [%]  |  Seq Length: 256.0
[2024-09-26 19:29:51,472][root][INFO] - Step: 315/1350  |  Loss: 0.9402  |  Score: 74.66 [%]  |  Seq Length: 256.0
[2024-09-26 19:29:52,448][root][INFO] - Step: 45/960  |  Loss: 2.0137  |  Score: 42.06 [%]  |  Seq Length: 256.0
[2024-09-26 19:29:57,884][root][INFO] - Step: 1095/1350  |  Loss: 0.3623  |  Score: 89.56 [%]  |  Seq Length: 256.0
[2024-09-26 19:29:57,998][root][INFO] - Step: 60/960  |  Loss: 1.7086  |  Score: 52.16 [%]  |  Seq Length: 256.0
[2024-09-26 19:29:59,251][root][INFO] - Step: 330/1350  |  Loss: 0.9329  |  Score: 74.09 [%]  |  Seq Length: 256.0
[2024-09-26 19:29:59,492][root][INFO] - Step: 64/960  |  Loss: 1.5735  |  Score: 59.58 [%]  |  Seq Length: 256.0
[2024-09-26 19:30:02,405][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 19:30:02,406][root][INFO] - Score: 71.92 [%]  |  Evaluation Time: 2.91 [s]
[2024-09-26 19:30:05,320][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 19:30:05,321][root][INFO] - Score: 61.92 [%]  |  Evaluation Time: 2.91 [s]
[2024-09-26 19:30:05,322][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 19:30:05,323][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 19:30:05,831][root][INFO] - Step: 1110/1350  |  Loss: 0.3601  |  Score: 89.63 [%]  |  Seq Length: 256.0
[2024-09-26 19:30:07,048][root][INFO] - Step: 345/1350  |  Loss: 0.8104  |  Score: 77.70 [%]  |  Seq Length: 256.0
[2024-09-26 19:30:09,716][root][INFO] - Step: 75/960  |  Loss: 1.4354  |  Score: 62.03 [%]  |  Seq Length: 256.0
[2024-09-26 19:30:13,802][root][INFO] - Step: 1125/1350  |  Loss: 0.3501  |  Score: 89.97 [%]  |  Seq Length: 256.0
[2024-09-26 19:30:14,900][root][INFO] - Step: 360/1350  |  Loss: 0.8821  |  Score: 75.06 [%]  |  Seq Length: 256.0
[2024-09-26 19:30:15,277][root][INFO] - Step: 90/960  |  Loss: 1.4031  |  Score: 63.32 [%]  |  Seq Length: 256.0
[2024-09-26 19:30:20,847][root][INFO] - Step: 105/960  |  Loss: 1.2867  |  Score: 65.80 [%]  |  Seq Length: 256.0
[2024-09-26 19:30:21,513][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 19:30:21,513][root][INFO] - Score: 75.32 [%]  |  Evaluation Time: 6.61 [s]
[2024-09-26 19:30:21,834][root][INFO] - Step: 1140/1350  |  Loss: 0.3485  |  Score: 89.69 [%]  |  Seq Length: 256.0
[2024-09-26 19:30:26,416][root][INFO] - Step: 120/960  |  Loss: 1.3070  |  Score: 67.76 [%]  |  Seq Length: 256.0
[2024-09-26 19:30:27,247][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 19:30:27,247][root][INFO] - Score: 70.45 [%]  |  Evaluation Time: 5.73 [s]
[2024-09-26 19:30:27,249][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 19:30:28,340][root][INFO] - Step: 361/1350  |  Loss: 0.7386  |  Score: 77.66 [%]  |  Seq Length: 256.0
[2024-09-26 19:30:29,406][root][INFO] - Step: 128/960  |  Loss: 1.2106  |  Score: 66.70 [%]  |  Seq Length: 256.0
[2024-09-26 19:30:29,799][root][INFO] - Step: 1155/1350  |  Loss: 0.3378  |  Score: 90.06 [%]  |  Seq Length: 256.0
[2024-09-26 19:30:32,373][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 19:30:32,373][root][INFO] - Score: 76.57 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-26 19:30:35,268][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 19:30:35,268][root][INFO] - Score: 68.05 [%]  |  Evaluation Time: 2.89 [s]
[2024-09-26 19:30:35,269][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 19:30:35,270][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 19:30:35,637][root][INFO] - Step: 375/1350  |  Loss: 0.7559  |  Score: 79.91 [%]  |  Seq Length: 256.0
[2024-09-26 19:30:37,807][root][INFO] - Step: 1170/1350  |  Loss: 0.3345  |  Score: 89.01 [%]  |  Seq Length: 256.0
[2024-09-26 19:30:38,335][root][INFO] - Step: 135/960  |  Loss: 1.2149  |  Score: 70.49 [%]  |  Seq Length: 256.0
[2024-09-26 19:30:43,486][root][INFO] - Step: 390/1350  |  Loss: 0.8460  |  Score: 74.78 [%]  |  Seq Length: 256.0
[2024-09-26 19:30:43,917][root][INFO] - Step: 150/960  |  Loss: 1.1305  |  Score: 71.82 [%]  |  Seq Length: 256.0
[2024-09-26 19:30:44,191][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 19:30:44,191][root][INFO] - Score: 76.67 [%]  |  Evaluation Time: 6.38 [s]
[2024-09-26 19:30:49,490][root][INFO] - Step: 165/960  |  Loss: 1.0650  |  Score: 70.36 [%]  |  Seq Length: 256.0
[2024-09-26 19:30:50,011][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 19:30:50,011][root][INFO] - Score: 71.85 [%]  |  Evaluation Time: 5.82 [s]
[2024-09-26 19:30:50,013][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 19:30:51,110][root][INFO] - Step: 1171/1350  |  Loss: 0.4033  |  Score: 90.04 [%]  |  Seq Length: 256.0
[2024-09-26 19:30:51,396][root][INFO] - Step: 405/1350  |  Loss: 0.7934  |  Score: 78.25 [%]  |  Seq Length: 256.0
[2024-09-26 19:30:55,066][root][INFO] - Step: 180/960  |  Loss: 1.0930  |  Score: 70.61 [%]  |  Seq Length: 256.0
[2024-09-26 19:30:58,740][root][INFO] - Step: 1185/1350  |  Loss: 0.3252  |  Score: 89.72 [%]  |  Seq Length: 256.0
[2024-09-26 19:30:59,233][root][INFO] - Step: 420/1350  |  Loss: 0.7239  |  Score: 78.49 [%]  |  Seq Length: 256.0
[2024-09-26 19:30:59,583][root][INFO] - Step: 192/960  |  Loss: 1.1802  |  Score: 69.90 [%]  |  Seq Length: 256.0
[2024-09-26 19:31:02,476][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 19:31:02,476][root][INFO] - Score: 73.10 [%]  |  Evaluation Time: 2.89 [s]
[2024-09-26 19:31:05,376][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 19:31:05,376][root][INFO] - Score: 68.79 [%]  |  Evaluation Time: 2.90 [s]
[2024-09-26 19:31:05,378][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 19:31:06,844][root][INFO] - Step: 1200/1350  |  Loss: 0.3465  |  Score: 89.99 [%]  |  Seq Length: 256.0
[2024-09-26 19:31:06,889][root][INFO] - Step: 195/960  |  Loss: 0.9357  |  Score: 76.49 [%]  |  Seq Length: 256.0
[2024-09-26 19:31:07,166][root][INFO] - Step: 435/1350  |  Loss: 0.7172  |  Score: 78.88 [%]  |  Seq Length: 256.0
[2024-09-26 19:31:12,473][root][INFO] - Step: 210/960  |  Loss: 0.9256  |  Score: 75.83 [%]  |  Seq Length: 256.0
[2024-09-26 19:31:14,877][root][INFO] - Step: 1215/1350  |  Loss: 0.3232  |  Score: 90.72 [%]  |  Seq Length: 256.0
[2024-09-26 19:31:15,068][root][INFO] - Step: 450/1350  |  Loss: 0.7617  |  Score: 75.93 [%]  |  Seq Length: 256.0
[2024-09-26 19:31:18,056][root][INFO] - Step: 225/960  |  Loss: 0.9693  |  Score: 75.37 [%]  |  Seq Length: 256.0
[2024-09-26 19:31:21,420][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 19:31:21,420][root][INFO] - Score: 79.37 [%]  |  Evaluation Time: 6.35 [s]
[2024-09-26 19:31:22,896][root][INFO] - Step: 1230/1350  |  Loss: 0.3533  |  Score: 89.44 [%]  |  Seq Length: 256.0
[2024-09-26 19:31:23,640][root][INFO] - Step: 240/960  |  Loss: 1.0091  |  Score: 73.43 [%]  |  Seq Length: 256.0
[2024-09-26 19:31:27,137][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 19:31:27,137][root][INFO] - Score: 73.20 [%]  |  Evaluation Time: 5.72 [s]
[2024-09-26 19:31:27,139][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 19:31:27,140][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 19:31:28,202][root][INFO] - Step: 451/1350  |  Loss: 0.7178  |  Score: 84.95 [%]  |  Seq Length: 256.0
[2024-09-26 19:31:29,219][root][INFO] - Step: 255/960  |  Loss: 0.9563  |  Score: 73.23 [%]  |  Seq Length: 256.0
[2024-09-26 19:31:29,649][root][INFO] - Step: 256/960  |  Loss: 0.8809  |  Score: 72.32 [%]  |  Seq Length: 256.0
[2024-09-26 19:31:30,906][root][INFO] - Step: 1245/1350  |  Loss: 0.3552  |  Score: 89.47 [%]  |  Seq Length: 256.0
[2024-09-26 19:31:32,647][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 19:31:32,647][root][INFO] - Score: 78.48 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-26 19:31:35,568][root][INFO] - Step: 465/1350  |  Loss: 0.6248  |  Score: 81.17 [%]  |  Seq Length: 256.0
[2024-09-26 19:31:35,641][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 19:31:35,641][root][INFO] - Score: 70.83 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-26 19:31:35,642][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-26 19:31:35,644][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 19:31:39,011][root][INFO] - Step: 1260/1350  |  Loss: 0.3286  |  Score: 90.47 [%]  |  Seq Length: 256.0
[2024-09-26 19:31:41,338][root][INFO] - Step: 270/960  |  Loss: 0.7967  |  Score: 76.87 [%]  |  Seq Length: 256.0
[2024-09-26 19:31:43,520][root][INFO] - Step: 480/1350  |  Loss: 0.7290  |  Score: 81.74 [%]  |  Seq Length: 256.0
[2024-09-26 19:31:45,546][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 19:31:45,546][root][INFO] - Score: 77.02 [%]  |  Evaluation Time: 6.53 [s]
[2024-09-26 19:31:46,927][root][INFO] - Step: 285/960  |  Loss: 0.8600  |  Score: 77.59 [%]  |  Seq Length: 256.0
[2024-09-26 19:31:51,318][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 19:31:51,318][root][INFO] - Score: 71.19 [%]  |  Evaluation Time: 5.77 [s]
[2024-09-26 19:31:51,321][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 19:31:51,372][root][INFO] - Step: 495/1350  |  Loss: 0.6703  |  Score: 81.83 [%]  |  Seq Length: 256.0
[2024-09-26 19:31:52,392][root][INFO] - Step: 1261/1350  |  Loss: 0.2625  |  Score: 91.97 [%]  |  Seq Length: 256.0
[2024-09-26 19:31:52,509][root][INFO] - Step: 300/960  |  Loss: 0.8252  |  Score: 80.20 [%]  |  Seq Length: 256.0
[2024-09-26 19:31:58,097][root][INFO] - Step: 315/960  |  Loss: 0.8432  |  Score: 80.50 [%]  |  Seq Length: 256.0
[2024-09-26 19:31:59,188][root][INFO] - Step: 510/1350  |  Loss: 0.7126  |  Score: 81.64 [%]  |  Seq Length: 256.0
[2024-09-26 19:31:59,884][root][INFO] - Step: 1275/1350  |  Loss: 0.3244  |  Score: 90.02 [%]  |  Seq Length: 256.0
[2024-09-26 19:31:59,979][root][INFO] - Step: 320/960  |  Loss: 0.6968  |  Score: 81.26 [%]  |  Seq Length: 256.0
[2024-09-26 19:32:02,895][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 19:32:02,895][root][INFO] - Score: 78.17 [%]  |  Evaluation Time: 2.91 [s]
[2024-09-26 19:32:05,736][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 19:32:05,736][root][INFO] - Score: 71.15 [%]  |  Evaluation Time: 2.84 [s]
[2024-09-26 19:32:05,737][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 19:32:05,739][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 19:32:06,947][root][INFO] - Step: 525/1350  |  Loss: 0.7420  |  Score: 76.53 [%]  |  Seq Length: 256.0
[2024-09-26 19:32:07,933][root][INFO] - Step: 1290/1350  |  Loss: 0.3516  |  Score: 89.66 [%]  |  Seq Length: 256.0
[2024-09-26 19:32:09,791][root][INFO] - Step: 330/960  |  Loss: 0.7357  |  Score: 80.33 [%]  |  Seq Length: 256.0
[2024-09-26 19:32:14,852][root][INFO] - Step: 540/1350  |  Loss: 0.7360  |  Score: 79.76 [%]  |  Seq Length: 256.0
[2024-09-26 19:32:15,370][root][INFO] - Step: 345/960  |  Loss: 0.7053  |  Score: 81.72 [%]  |  Seq Length: 256.0
[2024-09-26 19:32:16,021][root][INFO] - Step: 1305/1350  |  Loss: 0.3309  |  Score: 90.31 [%]  |  Seq Length: 256.0
[2024-09-26 19:32:20,956][root][INFO] - Step: 360/960  |  Loss: 0.7415  |  Score: 80.13 [%]  |  Seq Length: 256.0
[2024-09-26 19:32:21,291][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 19:32:21,292][root][INFO] - Score: 78.36 [%]  |  Evaluation Time: 6.44 [s]
[2024-09-26 19:32:24,100][root][INFO] - Step: 1320/1350  |  Loss: 0.3294  |  Score: 90.31 [%]  |  Seq Length: 256.0
[2024-09-26 19:32:26,544][root][INFO] - Step: 375/960  |  Loss: 0.7196  |  Score: 80.91 [%]  |  Seq Length: 256.0
[2024-09-26 19:32:27,043][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 19:32:27,043][root][INFO] - Score: 71.77 [%]  |  Evaluation Time: 5.75 [s]
[2024-09-26 19:32:27,045][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 19:32:28,088][root][INFO] - Step: 541/1350  |  Loss: 0.5282  |  Score: 87.68 [%]  |  Seq Length: 256.0
[2024-09-26 19:32:29,921][root][INFO] - Step: 384/960  |  Loss: 0.6828  |  Score: 83.88 [%]  |  Seq Length: 256.0
[2024-09-26 19:32:32,146][root][INFO] - Step: 1335/1350  |  Loss: 0.3238  |  Score: 90.29 [%]  |  Seq Length: 256.0
[2024-09-26 19:32:32,762][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 19:32:32,762][root][INFO] - Score: 77.90 [%]  |  Evaluation Time: 2.84 [s]
[2024-09-26 19:32:35,412][root][INFO] - Step: 555/1350  |  Loss: 0.6389  |  Score: 84.60 [%]  |  Seq Length: 256.0
[2024-09-26 19:32:35,606][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 19:32:35,606][root][INFO] - Score: 71.83 [%]  |  Evaluation Time: 2.84 [s]
[2024-09-26 19:32:35,607][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 19:32:35,608][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 19:32:38,188][root][INFO] - Step: 390/960  |  Loss: 0.5743  |  Score: 83.08 [%]  |  Seq Length: 256.0
[2024-09-26 19:32:40,157][root][INFO] - Step: 1350/1350  |  Loss: 0.3507  |  Score: 88.85 [%]  |  Seq Length: 256.0
[2024-09-26 19:32:43,200][root][INFO] - Step: 570/1350  |  Loss: 0.5790  |  Score: 85.18 [%]  |  Seq Length: 256.0
[2024-09-26 19:32:43,771][root][INFO] - Step: 405/960  |  Loss: 0.6534  |  Score: 81.69 [%]  |  Seq Length: 256.0
[2024-09-26 19:32:46,625][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 19:32:46,625][root][INFO] - Score: 77.16 [%]  |  Evaluation Time: 6.46 [s]
[2024-09-26 19:32:49,355][root][INFO] - Step: 420/960  |  Loss: 0.6482  |  Score: 84.15 [%]  |  Seq Length: 256.0
[2024-09-26 19:32:51,139][root][INFO] - Step: 585/1350  |  Loss: 0.6027  |  Score: 81.98 [%]  |  Seq Length: 256.0
[2024-09-26 19:32:52,678][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 19:32:52,678][root][INFO] - Score: 70.71 [%]  |  Evaluation Time: 6.05 [s]
[2024-09-26 19:32:52,679][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 19:32:52,679][root][INFO] - - Epoch: 7
[2024-09-26 19:32:52,679][root][INFO] - - DEV score: 77.90 [%]
[2024-09-26 19:32:52,679][root][INFO] - - TEST score: 71.04 [%]
[2024-09-26 19:32:52,680][root][INFO] - Fine-tuning is done!
[2024-09-26 19:32:54,942][root][INFO] - Step: 435/960  |  Loss: 0.6794  |  Score: 83.57 [%]  |  Seq Length: 256.0
[2024-09-26 19:32:59,147][root][INFO] - Step: 600/1350  |  Loss: 0.5296  |  Score: 83.67 [%]  |  Seq Length: 256.0
[2024-09-26 19:32:59,161][root][INFO] - 

[2024-09-26 19:32:59,162][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 19:32:59,162][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:32:59,162][root][INFO] - 

[2024-09-26 19:32:59,162][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': False, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 19:32:59,808][root][INFO] - Step: 448/960  |  Loss: 0.6761  |  Score: 81.52 [%]  |  Seq Length: 256.0
[2024-09-26 19:33:02,878][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 19:33:02,878][root][INFO] - Score: 78.39 [%]  |  Evaluation Time: 3.07 [s]
[2024-09-26 19:33:03,656][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 19:33:03,657][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 19:33:03,657][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 19:33:03,658][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 19:33:03,658][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 19:33:03,658][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 19:33:03,659][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 19:33:03,659][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 19:33:03,660][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 19:33:03,660][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 19:33:03,661][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 19:33:03,661][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 19:33:03,662][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 19:33:03,662][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 19:33:03,663][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 19:33:03,663][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 19:33:03,664][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 19:33:03,664][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 19:33:03,664][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 19:33:03,665][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 19:33:03,665][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 19:33:03,666][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 19:33:03,666][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 19:33:03,667][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 19:33:03,668][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 19:33:04,097][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 19:33:05,742][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 19:33:05,742][root][INFO] - Score: 71.52 [%]  |  Evaluation Time: 2.86 [s]
[2024-09-26 19:33:05,743][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-26 19:33:05,744][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 19:33:06,839][root][INFO] - Step: 450/960  |  Loss: 0.6189  |  Score: 84.84 [%]  |  Seq Length: 256.0
[2024-09-26 19:33:07,036][root][INFO] - Step: 615/1350  |  Loss: 0.5716  |  Score: 82.71 [%]  |  Seq Length: 256.0
[2024-09-26 19:33:08,154][root][INFO] - 

[2024-09-26 19:33:08,154][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 19:33:08,154][root][INFO] - Data Preprocessing
[2024-09-26 19:33:08,154][root][INFO] - ㄴ remain_lang                ko_en_punc
[2024-09-26 19:33:08,154][root][INFO] - ㄴ do_hangeulize              False
[2024-09-26 19:33:08,154][root][INFO] - ㄴ data_remove                True

[2024-09-26 19:33:08,154][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 19:33:08,163][root][INFO] - vocab size              : 51200
[2024-09-26 19:33:08,163][root][INFO] - device                  : gpu
[2024-09-26 19:33:08,163][root][INFO] - random seed             : 42
[2024-09-26 19:33:08,163][root][INFO] - train data size         : 4416
[2024-09-26 19:33:08,163][root][INFO] - max epochs              : 15
[2024-09-26 19:33:08,163][root][INFO] - total steps             : 1035
[2024-09-26 19:33:08,163][root][INFO] - warmup steps            : 104
[2024-09-26 19:33:08,163][root][INFO] - batch size              : 64
[2024-09-26 19:33:08,164][root][INFO] - accumulation steps      : 1
[2024-09-26 19:33:08,164][root][INFO] - optimizer               : adamwscale
[2024-09-26 19:33:08,164][root][INFO] - lr_scheduler            : cosine
[2024-09-26 19:33:08,164][root][INFO] - learning rate           : 0.01
[2024-09-26 19:33:08,164][root][INFO] - max length              : 256

[2024-09-26 19:33:08,164][root][INFO] - LoRA Configuration
[2024-09-26 19:33:08,164][root][INFO] - ㄴ r                    : 32
[2024-09-26 19:33:08,164][root][INFO] - ㄴ alpha                : 128
[2024-09-26 19:33:08,164][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 19:33:08,164][root][INFO] - 

[2024-09-26 19:33:08,164][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:33:08,165][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 19:33:08,165][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 19:33:08,165][root][INFO] - * tb interval   : 15

[2024-09-26 19:33:08,165][root][INFO] - 

[2024-09-26 19:33:08,165][root][INFO] - Start the Training !
[2024-09-26 19:33:08,168][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 19:33:12,431][root][INFO] - Step: 465/960  |  Loss: 0.5304  |  Score: 85.24 [%]  |  Seq Length: 256.0
[2024-09-26 19:33:14,922][root][INFO] - Step: 630/1350  |  Loss: 0.6732  |  Score: 79.95 [%]  |  Seq Length: 256.0
[2024-09-26 19:33:16,746][root][INFO] - Step: 15/1035  |  Loss: 3.2324  |  Score: 8.56 [%]  |  Seq Length: 256.0
[2024-09-26 19:33:18,020][root][INFO] - Step: 480/960  |  Loss: 0.5722  |  Score: 84.96 [%]  |  Seq Length: 256.0
[2024-09-26 19:33:21,252][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 19:33:21,252][root][INFO] - Score: 79.28 [%]  |  Evaluation Time: 6.33 [s]
[2024-09-26 19:33:22,461][root][INFO] - Step: 30/1035  |  Loss: 2.2879  |  Score: 19.57 [%]  |  Seq Length: 256.0
[2024-09-26 19:33:23,604][root][INFO] - Step: 495/960  |  Loss: 0.5840  |  Score: 84.39 [%]  |  Seq Length: 256.0
[2024-09-26 19:33:27,128][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 19:33:27,128][root][INFO] - Score: 72.84 [%]  |  Evaluation Time: 5.87 [s]
[2024-09-26 19:33:27,130][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 19:33:28,186][root][INFO] - Step: 45/1035  |  Loss: 1.9877  |  Score: 37.67 [%]  |  Seq Length: 256.0
[2024-09-26 19:33:28,257][root][INFO] - Step: 631/1350  |  Loss: 0.4452  |  Score: 89.15 [%]  |  Seq Length: 256.0
[2024-09-26 19:33:29,192][root][INFO] - Step: 510/960  |  Loss: 0.5741  |  Score: 86.44 [%]  |  Seq Length: 256.0
[2024-09-26 19:33:29,987][root][INFO] - Step: 512/960  |  Loss: 0.5352  |  Score: 82.81 [%]  |  Seq Length: 256.0
[2024-09-26 19:33:32,878][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 19:33:32,878][root][INFO] - Score: 78.56 [%]  |  Evaluation Time: 2.89 [s]
[2024-09-26 19:33:33,929][root][INFO] - Step: 60/1035  |  Loss: 1.7373  |  Score: 54.44 [%]  |  Seq Length: 256.0
[2024-09-26 19:33:35,602][root][INFO] - Step: 645/1350  |  Loss: 0.5398  |  Score: 84.30 [%]  |  Seq Length: 256.0
[2024-09-26 19:33:35,705][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 19:33:35,706][root][INFO] - Score: 71.10 [%]  |  Evaluation Time: 2.83 [s]
[2024-09-26 19:33:35,708][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 19:33:37,430][root][INFO] - Step: 69/1035  |  Loss: 1.5794  |  Score: 60.05 [%]  |  Seq Length: 256.0
[2024-09-26 19:33:40,585][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 19:33:40,585][root][INFO] - Score: 72.78 [%]  |  Evaluation Time: 3.15 [s]
[2024-09-26 19:33:40,980][root][INFO] - Step: 525/960  |  Loss: 0.4759  |  Score: 88.02 [%]  |  Seq Length: 256.0
[2024-09-26 19:33:43,507][root][INFO] - Step: 660/1350  |  Loss: 0.5132  |  Score: 85.80 [%]  |  Seq Length: 256.0
[2024-09-26 19:33:43,719][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 19:33:43,719][root][INFO] - Score: 61.68 [%]  |  Evaluation Time: 3.13 [s]
[2024-09-26 19:33:43,720][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 19:33:43,721][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 19:33:46,315][root][INFO] - Step: 75/1035  |  Loss: 1.4305  |  Score: 63.45 [%]  |  Seq Length: 256.0
[2024-09-26 19:33:46,565][root][INFO] - Step: 540/960  |  Loss: 0.4988  |  Score: 86.64 [%]  |  Seq Length: 256.0
[2024-09-26 19:33:51,334][root][INFO] - Step: 675/1350  |  Loss: 0.5167  |  Score: 85.16 [%]  |  Seq Length: 256.0
[2024-09-26 19:33:52,043][root][INFO] - Step: 90/1035  |  Loss: 1.3116  |  Score: 64.56 [%]  |  Seq Length: 256.0
[2024-09-26 19:33:52,151][root][INFO] - Step: 555/960  |  Loss: 0.5106  |  Score: 86.21 [%]  |  Seq Length: 256.0
[2024-09-26 19:33:57,730][root][INFO] - Step: 570/960  |  Loss: 0.5042  |  Score: 87.08 [%]  |  Seq Length: 256.0
[2024-09-26 19:33:57,766][root][INFO] - Step: 105/1035  |  Loss: 1.2280  |  Score: 62.90 [%]  |  Seq Length: 256.0
[2024-09-26 19:33:59,143][root][INFO] - Step: 690/1350  |  Loss: 0.5203  |  Score: 84.53 [%]  |  Seq Length: 256.0
[2024-09-26 19:33:59,993][root][INFO] - Step: 576/960  |  Loss: 0.4521  |  Score: 86.39 [%]  |  Seq Length: 256.0
[2024-09-26 19:34:03,005][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 19:34:03,005][root][INFO] - Score: 76.93 [%]  |  Evaluation Time: 3.01 [s]
[2024-09-26 19:34:03,484][root][INFO] - Step: 120/1035  |  Loss: 1.2935  |  Score: 65.47 [%]  |  Seq Length: 256.0
[2024-09-26 19:34:05,863][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 19:34:05,863][root][INFO] - Score: 70.58 [%]  |  Evaluation Time: 2.86 [s]
[2024-09-26 19:34:05,865][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 19:34:07,016][root][INFO] - Step: 705/1350  |  Loss: 0.5551  |  Score: 84.24 [%]  |  Seq Length: 256.0
[2024-09-26 19:34:09,208][root][INFO] - Step: 135/1035  |  Loss: 1.4303  |  Score: 66.24 [%]  |  Seq Length: 256.0
[2024-09-26 19:34:09,544][root][INFO] - Step: 585/960  |  Loss: 0.4546  |  Score: 86.78 [%]  |  Seq Length: 256.0
[2024-09-26 19:34:10,371][root][INFO] - Step: 138/1035  |  Loss: 1.3554  |  Score: 71.67 [%]  |  Seq Length: 256.0
[2024-09-26 19:34:13,461][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 19:34:13,461][root][INFO] - Score: 75.45 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-26 19:34:14,934][root][INFO] - Step: 720/1350  |  Loss: 0.5621  |  Score: 85.04 [%]  |  Seq Length: 256.0
[2024-09-26 19:34:15,132][root][INFO] - Step: 600/960  |  Loss: 0.4242  |  Score: 88.25 [%]  |  Seq Length: 256.0
[2024-09-26 19:34:16,433][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 19:34:16,433][root][INFO] - Score: 68.61 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-26 19:34:16,434][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 19:34:16,435][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 19:34:20,713][root][INFO] - Step: 615/960  |  Loss: 0.4534  |  Score: 88.42 [%]  |  Seq Length: 256.0
[2024-09-26 19:34:21,252][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 19:34:21,252][root][INFO] - Score: 78.44 [%]  |  Evaluation Time: 6.32 [s]
[2024-09-26 19:34:21,510][root][INFO] - Step: 150/1035  |  Loss: 1.1164  |  Score: 68.03 [%]  |  Seq Length: 256.0
[2024-09-26 19:34:26,300][root][INFO] - Step: 630/960  |  Loss: 0.4097  |  Score: 89.52 [%]  |  Seq Length: 256.0
[2024-09-26 19:34:27,084][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 19:34:27,085][root][INFO] - Score: 71.49 [%]  |  Evaluation Time: 5.83 [s]
[2024-09-26 19:34:27,087][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 19:34:27,233][root][INFO] - Step: 165/1035  |  Loss: 1.0304  |  Score: 72.04 [%]  |  Seq Length: 256.0
[2024-09-26 19:34:28,047][root][INFO] - Step: 721/1350  |  Loss: 0.4140  |  Score: 83.87 [%]  |  Seq Length: 256.0
[2024-09-26 19:34:30,070][root][INFO] - Step: 640/960  |  Loss: 0.5117  |  Score: 85.68 [%]  |  Seq Length: 256.0
[2024-09-26 19:34:32,957][root][INFO] - Step: 180/1035  |  Loss: 1.0626  |  Score: 71.69 [%]  |  Seq Length: 256.0
[2024-09-26 19:34:32,957][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 19:34:32,958][root][INFO] - Score: 76.97 [%]  |  Evaluation Time: 2.88 [s]
[2024-09-26 19:34:35,303][root][INFO] - Step: 735/1350  |  Loss: 0.4799  |  Score: 86.30 [%]  |  Seq Length: 256.0
[2024-09-26 19:34:35,815][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 19:34:35,815][root][INFO] - Score: 71.34 [%]  |  Evaluation Time: 2.86 [s]
[2024-09-26 19:34:35,817][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 19:34:38,018][root][INFO] - Step: 645/960  |  Loss: 0.4038  |  Score: 89.18 [%]  |  Seq Length: 256.0
[2024-09-26 19:34:38,679][root][INFO] - Step: 195/1035  |  Loss: 1.2186  |  Score: 70.20 [%]  |  Seq Length: 256.0
[2024-09-26 19:34:43,077][root][INFO] - Step: 750/1350  |  Loss: 0.4476  |  Score: 86.81 [%]  |  Seq Length: 256.0
[2024-09-26 19:34:43,317][root][INFO] - Step: 207/1035  |  Loss: 1.0228  |  Score: 70.66 [%]  |  Seq Length: 256.0
[2024-09-26 19:34:43,601][root][INFO] - Step: 660/960  |  Loss: 0.4201  |  Score: 89.98 [%]  |  Seq Length: 256.0
[2024-09-26 19:34:46,494][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 19:34:46,495][root][INFO] - Score: 77.84 [%]  |  Evaluation Time: 3.17 [s]
[2024-09-26 19:34:49,182][root][INFO] - Step: 675/960  |  Loss: 0.4360  |  Score: 89.01 [%]  |  Seq Length: 256.0
[2024-09-26 19:34:49,598][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 19:34:49,599][root][INFO] - Score: 68.99 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-26 19:34:49,600][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 19:34:49,601][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 19:34:50,989][root][INFO] - Step: 765/1350  |  Loss: 0.4890  |  Score: 85.28 [%]  |  Seq Length: 256.0
[2024-09-26 19:34:51,109][root][INFO] - Step: 210/1035  |  Loss: 1.0131  |  Score: 71.08 [%]  |  Seq Length: 256.0
[2024-09-26 19:34:54,762][root][INFO] - Step: 690/960  |  Loss: 0.4248  |  Score: 88.74 [%]  |  Seq Length: 256.0
[2024-09-26 19:34:56,833][root][INFO] - Step: 225/1035  |  Loss: 0.9242  |  Score: 75.98 [%]  |  Seq Length: 256.0
[2024-09-26 19:34:58,818][root][INFO] - Step: 780/1350  |  Loss: 0.4827  |  Score: 87.23 [%]  |  Seq Length: 256.0
[2024-09-26 19:34:59,987][root][INFO] - Step: 704/960  |  Loss: 0.4527  |  Score: 87.66 [%]  |  Seq Length: 256.0
[2024-09-26 19:35:02,568][root][INFO] - Step: 240/1035  |  Loss: 0.8761  |  Score: 75.57 [%]  |  Seq Length: 256.0
[2024-09-26 19:35:02,878][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 19:35:02,878][root][INFO] - Score: 76.50 [%]  |  Evaluation Time: 2.89 [s]
[2024-09-26 19:35:05,787][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 19:35:05,787][root][INFO] - Score: 70.90 [%]  |  Evaluation Time: 2.91 [s]
[2024-09-26 19:35:05,789][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 19:35:06,574][root][INFO] - Step: 705/960  |  Loss: 0.3051  |  Score: 92.69 [%]  |  Seq Length: 256.0
[2024-09-26 19:35:06,675][root][INFO] - Step: 795/1350  |  Loss: 0.4471  |  Score: 87.52 [%]  |  Seq Length: 256.0
[2024-09-26 19:35:08,328][root][INFO] - Step: 255/1035  |  Loss: 1.0157  |  Score: 73.42 [%]  |  Seq Length: 256.0
[2024-09-26 19:35:12,156][root][INFO] - Step: 720/960  |  Loss: 0.4155  |  Score: 88.32 [%]  |  Seq Length: 256.0
[2024-09-26 19:35:14,050][root][INFO] - Step: 270/1035  |  Loss: 0.9008  |  Score: 75.53 [%]  |  Seq Length: 256.0
[2024-09-26 19:35:14,618][root][INFO] - Step: 810/1350  |  Loss: 0.4221  |  Score: 88.04 [%]  |  Seq Length: 256.0
[2024-09-26 19:35:16,402][root][INFO] - Step: 276/1035  |  Loss: 1.0020  |  Score: 67.28 [%]  |  Seq Length: 256.0
[2024-09-26 19:35:17,738][root][INFO] - Step: 735/960  |  Loss: 0.3763  |  Score: 88.91 [%]  |  Seq Length: 256.0
[2024-09-26 19:35:19,550][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 19:35:19,550][root][INFO] - Score: 77.15 [%]  |  Evaluation Time: 3.15 [s]
[2024-09-26 19:35:21,003][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 19:35:21,003][root][INFO] - Score: 77.74 [%]  |  Evaluation Time: 6.38 [s]
[2024-09-26 19:35:22,654][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 19:35:22,654][root][INFO] - Score: 69.39 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-26 19:35:22,656][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 19:35:23,336][root][INFO] - Step: 750/960  |  Loss: 0.3556  |  Score: 90.71 [%]  |  Seq Length: 256.0
[2024-09-26 19:35:26,523][root][INFO] - Step: 285/1035  |  Loss: 0.8308  |  Score: 78.44 [%]  |  Seq Length: 256.0
[2024-09-26 19:35:26,915][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 19:35:26,916][root][INFO] - Score: 70.44 [%]  |  Evaluation Time: 5.91 [s]
[2024-09-26 19:35:26,918][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 19:35:28,053][root][INFO] - Step: 811/1350  |  Loss: 0.3782  |  Score: 90.75 [%]  |  Seq Length: 256.0
[2024-09-26 19:35:28,919][root][INFO] - Step: 765/960  |  Loss: 0.3856  |  Score: 88.80 [%]  |  Seq Length: 256.0
[2024-09-26 19:35:30,090][root][INFO] - Step: 768/960  |  Loss: 0.3687  |  Score: 92.24 [%]  |  Seq Length: 256.0
[2024-09-26 19:35:32,254][root][INFO] - Step: 300/1035  |  Loss: 0.8757  |  Score: 77.96 [%]  |  Seq Length: 256.0
[2024-09-26 19:35:33,068][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 19:35:33,069][root][INFO] - Score: 72.74 [%]  |  Evaluation Time: 2.98 [s]
[2024-09-26 19:35:35,374][root][INFO] - Step: 825/1350  |  Loss: 0.4039  |  Score: 88.64 [%]  |  Seq Length: 256.0
[2024-09-26 19:35:35,990][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 19:35:35,990][root][INFO] - Score: 70.20 [%]  |  Evaluation Time: 2.92 [s]
[2024-09-26 19:35:35,992][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 19:35:37,993][root][INFO] - Step: 315/1035  |  Loss: 0.8043  |  Score: 77.57 [%]  |  Seq Length: 256.0
[2024-09-26 19:35:40,838][root][INFO] - Step: 780/960  |  Loss: 0.3608  |  Score: 90.07 [%]  |  Seq Length: 256.0
[2024-09-26 19:35:43,311][root][INFO] - Step: 840/1350  |  Loss: 0.4367  |  Score: 87.96 [%]  |  Seq Length: 256.0
[2024-09-26 19:35:43,723][root][INFO] - Step: 330/1035  |  Loss: 0.7602  |  Score: 78.49 [%]  |  Seq Length: 256.0
[2024-09-26 19:35:46,419][root][INFO] - Step: 795/960  |  Loss: 0.3740  |  Score: 90.61 [%]  |  Seq Length: 256.0
[2024-09-26 19:35:49,504][root][INFO] - Step: 345/1035  |  Loss: 0.9165  |  Score: 75.46 [%]  |  Seq Length: 256.0
[2024-09-26 19:35:51,129][root][INFO] - Step: 855/1350  |  Loss: 0.4096  |  Score: 88.52 [%]  |  Seq Length: 256.0
[2024-09-26 19:35:51,999][root][INFO] - Step: 810/960  |  Loss: 0.3559  |  Score: 90.16 [%]  |  Seq Length: 256.0
[2024-09-26 19:35:52,756][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 19:35:52,756][root][INFO] - Score: 76.74 [%]  |  Evaluation Time: 3.25 [s]
[2024-09-26 19:35:55,879][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 19:35:55,879][root][INFO] - Score: 70.44 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-26 19:35:55,881][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 19:35:55,882][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 19:35:56,736][root][INFO] - Step: 346/1035  |  Loss: 0.9167  |  Score: 74.52 [%]  |  Seq Length: 256.0
[2024-09-26 19:35:57,582][root][INFO] - Step: 825/960  |  Loss: 0.3662  |  Score: 90.21 [%]  |  Seq Length: 256.0
[2024-09-26 19:35:58,926][root][INFO] - Step: 870/1350  |  Loss: 0.4338  |  Score: 87.62 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:00,205][root][INFO] - Step: 832/960  |  Loss: 0.3831  |  Score: 87.85 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:02,085][root][INFO] - Step: 360/1035  |  Loss: 0.7067  |  Score: 80.48 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:03,116][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 19:36:03,116][root][INFO] - Score: 77.41 [%]  |  Evaluation Time: 2.91 [s]
[2024-09-26 19:36:05,978][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 19:36:05,978][root][INFO] - Score: 70.28 [%]  |  Evaluation Time: 2.86 [s]
[2024-09-26 19:36:05,980][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 19:36:06,735][root][INFO] - Step: 885/1350  |  Loss: 0.4367  |  Score: 87.73 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:07,814][root][INFO] - Step: 375/1035  |  Loss: 0.6867  |  Score: 82.14 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:09,300][root][INFO] - Step: 840/960  |  Loss: 0.3299  |  Score: 91.50 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:13,541][root][INFO] - Step: 390/1035  |  Loss: 0.7253  |  Score: 79.68 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:14,648][root][INFO] - Step: 900/1350  |  Loss: 0.4474  |  Score: 87.74 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:14,886][root][INFO] - Step: 855/960  |  Loss: 0.3506  |  Score: 90.54 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:19,268][root][INFO] - Step: 405/1035  |  Loss: 0.6841  |  Score: 79.19 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:20,472][root][INFO] - Step: 870/960  |  Loss: 0.3688  |  Score: 89.45 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:21,008][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 19:36:21,008][root][INFO] - Score: 77.50 [%]  |  Evaluation Time: 6.36 [s]
[2024-09-26 19:36:22,735][root][INFO] - Step: 414/1035  |  Loss: 0.6930  |  Score: 81.33 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:25,934][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 19:36:25,934][root][INFO] - Score: 78.06 [%]  |  Evaluation Time: 3.20 [s]
[2024-09-26 19:36:26,057][root][INFO] - Step: 885/960  |  Loss: 0.3526  |  Score: 89.98 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:26,811][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 19:36:26,811][root][INFO] - Score: 72.11 [%]  |  Evaluation Time: 5.80 [s]
[2024-09-26 19:36:26,814][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 19:36:27,733][root][INFO] - Step: 901/1350  |  Loss: 0.3205  |  Score: 92.90 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:28,983][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 19:36:28,983][root][INFO] - Score: 71.92 [%]  |  Evaluation Time: 3.05 [s]
[2024-09-26 19:36:28,984][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 19:36:28,985][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 19:36:30,196][root][INFO] - Step: 896/960  |  Loss: 0.4046  |  Score: 89.24 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:31,757][root][INFO] - Step: 420/1035  |  Loss: 0.5974  |  Score: 83.26 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:33,136][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 19:36:33,136][root][INFO] - Score: 76.89 [%]  |  Evaluation Time: 2.94 [s]
[2024-09-26 19:36:35,023][root][INFO] - Step: 915/1350  |  Loss: 0.3992  |  Score: 88.15 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:36,015][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 19:36:36,015][root][INFO] - Score: 70.71 [%]  |  Evaluation Time: 2.88 [s]
[2024-09-26 19:36:36,017][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 19:36:37,481][root][INFO] - Step: 435/1035  |  Loss: 0.5692  |  Score: 85.43 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:37,916][root][INFO] - Step: 900/960  |  Loss: 0.3693  |  Score: 90.47 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:42,824][root][INFO] - Step: 930/1350  |  Loss: 0.3798  |  Score: 88.05 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:43,209][root][INFO] - Step: 450/1035  |  Loss: 0.6865  |  Score: 81.79 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:43,497][root][INFO] - Step: 915/960  |  Loss: 0.3512  |  Score: 90.42 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:48,936][root][INFO] - Step: 465/1035  |  Loss: 0.6947  |  Score: 82.44 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:49,081][root][INFO] - Step: 930/960  |  Loss: 0.3382  |  Score: 90.60 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:50,778][root][INFO] - Step: 945/1350  |  Loss: 0.3889  |  Score: 88.19 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:54,661][root][INFO] - Step: 480/1035  |  Loss: 0.6389  |  Score: 81.63 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:54,665][root][INFO] - Step: 945/960  |  Loss: 0.3505  |  Score: 89.46 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:55,828][root][INFO] - Step: 483/1035  |  Loss: 0.6826  |  Score: 80.74 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:58,726][root][INFO] - Step: 960/1350  |  Loss: 0.3588  |  Score: 89.66 [%]  |  Seq Length: 256.0
[2024-09-26 19:36:59,002][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 19:36:59,003][root][INFO] - Score: 77.61 [%]  |  Evaluation Time: 3.17 [s]
[2024-09-26 19:37:00,274][root][INFO] - Step: 960/960  |  Loss: 0.3579  |  Score: 90.15 [%]  |  Seq Length: 256.0
[2024-09-26 19:37:02,047][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 19:37:02,048][root][INFO] - Score: 71.04 [%]  |  Evaluation Time: 3.04 [s]
[2024-09-26 19:37:02,052][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 19:37:03,215][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 19:37:03,216][root][INFO] - Score: 78.49 [%]  |  Evaluation Time: 2.94 [s]
[2024-09-26 19:37:06,138][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 19:37:06,139][root][INFO] - Score: 70.99 [%]  |  Evaluation Time: 2.92 [s]
[2024-09-26 19:37:06,139][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 19:37:06,140][root][INFO] - - Epoch: 7
[2024-09-26 19:37:06,140][root][INFO] - - DEV score: 78.39 [%]
[2024-09-26 19:37:06,140][root][INFO] - - TEST score: 71.52 [%]
[2024-09-26 19:37:06,140][root][INFO] - Fine-tuning is done!
[2024-09-26 19:37:06,630][root][INFO] - Step: 975/1350  |  Loss: 0.3866  |  Score: 88.12 [%]  |  Seq Length: 256.0
[2024-09-26 19:37:07,039][root][INFO] - Step: 495/1035  |  Loss: 0.5107  |  Score: 84.63 [%]  |  Seq Length: 256.0
[2024-09-26 19:37:12,246][root][INFO] - 

[2024-09-26 19:37:12,246][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 19:37:12,246][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:37:12,246][root][INFO] - 

[2024-09-26 19:37:12,246][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_punc', 'do_hangeulize': False, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 19:37:12,774][root][INFO] - Step: 510/1035  |  Loss: 0.5588  |  Score: 84.80 [%]  |  Seq Length: 256.0
[2024-09-26 19:37:14,539][root][INFO] - Step: 990/1350  |  Loss: 0.3895  |  Score: 88.49 [%]  |  Seq Length: 256.0
[2024-09-26 19:37:16,461][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 19:37:16,461][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 19:37:16,462][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 19:37:16,462][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 19:37:16,462][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 19:37:16,463][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 19:37:16,463][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 19:37:16,464][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 19:37:16,464][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 19:37:16,465][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 19:37:16,465][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 19:37:16,466][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 19:37:16,466][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 19:37:16,467][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 19:37:16,467][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 19:37:16,468][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 19:37:16,468][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 19:37:16,469][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 19:37:16,469][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 19:37:16,470][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 19:37:16,470][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 19:37:16,471][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 19:37:16,471][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 19:37:16,472][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 19:37:16,473][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 19:37:16,477][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-26 19:37:16,583][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-26 19:37:16,585][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-26 19:37:17,057][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 19:37:18,523][root][INFO] - Step: 525/1035  |  Loss: 0.5891  |  Score: 83.82 [%]  |  Seq Length: 256.0
[2024-09-26 19:37:20,971][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 19:37:20,971][root][INFO] - Score: 78.09 [%]  |  Evaluation Time: 6.43 [s]
[2024-09-26 19:37:23,627][root][INFO] - 

[2024-09-26 19:37:23,627][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 19:37:23,627][root][INFO] - Data Preprocessing
[2024-09-26 19:37:23,627][root][INFO] - ㄴ remain_lang                ko_punc
[2024-09-26 19:37:23,627][root][INFO] - ㄴ do_hangeulize              False
[2024-09-26 19:37:23,627][root][INFO] - ㄴ data_remove                True

[2024-09-26 19:37:23,628][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 19:37:23,636][root][INFO] - vocab size              : 51200
[2024-09-26 19:37:23,636][root][INFO] - device                  : gpu
[2024-09-26 19:37:23,636][root][INFO] - random seed             : 42
[2024-09-26 19:37:23,636][root][INFO] - train data size         : 4096
[2024-09-26 19:37:23,636][root][INFO] - max epochs              : 15
[2024-09-26 19:37:23,636][root][INFO] - total steps             : 960
[2024-09-26 19:37:23,636][root][INFO] - warmup steps            : 96
[2024-09-26 19:37:23,636][root][INFO] - batch size              : 64
[2024-09-26 19:37:23,636][root][INFO] - accumulation steps      : 1
[2024-09-26 19:37:23,636][root][INFO] - optimizer               : adamwscale
[2024-09-26 19:37:23,637][root][INFO] - lr_scheduler            : cosine
[2024-09-26 19:37:23,637][root][INFO] - learning rate           : 0.01
[2024-09-26 19:37:23,637][root][INFO] - max length              : 256

[2024-09-26 19:37:23,637][root][INFO] - LoRA Configuration
[2024-09-26 19:37:23,637][root][INFO] - ㄴ r                    : 32
[2024-09-26 19:37:23,637][root][INFO] - ㄴ alpha                : 128
[2024-09-26 19:37:23,637][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 19:37:23,637][root][INFO] - KOMBO Configuration
[2024-09-26 19:37:23,637][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-26 19:37:23,637][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-26 19:37:23,637][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-26 19:37:23,638][root][INFO] - ㄴ do_combination       : True
[2024-09-26 19:37:23,638][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-26 19:37:23,638][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-26 19:37:23,638][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-26 19:37:23,638][root][INFO] -   ㄴ add_lora           : True

[2024-09-26 19:37:23,638][root][INFO] - LoRA in KOMBO Configuration
[2024-09-26 19:37:23,638][root][INFO] - ㄴ r                : 32
[2024-09-26 19:37:23,638][root][INFO] - ㄴ alpha            : 128
[2024-09-26 19:37:23,638][root][INFO] - ㄴ dropout          : 0.03

[2024-09-26 19:37:23,638][root][INFO] - 

[2024-09-26 19:37:23,639][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:37:23,639][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 19:37:23,639][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 19:37:23,639][root][INFO] - * tb interval   : 15

[2024-09-26 19:37:23,639][root][INFO] - 

[2024-09-26 19:37:23,639][root][INFO] - Start the Training !
[2024-09-26 19:37:23,642][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 19:37:24,264][root][INFO] - Step: 540/1035  |  Loss: 0.5419  |  Score: 85.75 [%]  |  Seq Length: 256.0
[2024-09-26 19:37:26,921][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 19:37:26,922][root][INFO] - Score: 71.26 [%]  |  Evaluation Time: 5.95 [s]
[2024-09-26 19:37:26,924][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 19:37:28,118][root][INFO] - Step: 991/1350  |  Loss: 0.3470  |  Score: 90.07 [%]  |  Seq Length: 256.0
[2024-09-26 19:37:28,873][root][INFO] - Step: 552/1035  |  Loss: 0.5558  |  Score: 84.51 [%]  |  Seq Length: 256.0
[2024-09-26 19:37:32,020][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 19:37:32,020][root][INFO] - Score: 77.40 [%]  |  Evaluation Time: 3.14 [s]
[2024-09-26 19:37:33,097][root][INFO] - Step: 15/960  |  Loss: 3.3677  |  Score: 2.54 [%]  |  Seq Length: 256.0
[2024-09-26 19:37:35,122][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 19:37:35,122][root][INFO] - Score: 71.60 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-26 19:37:35,125][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 19:37:35,457][root][INFO] - Step: 1005/1350  |  Loss: 0.3361  |  Score: 90.01 [%]  |  Seq Length: 256.0
[2024-09-26 19:37:36,659][root][INFO] - Step: 555/1035  |  Loss: 0.5220  |  Score: 84.45 [%]  |  Seq Length: 256.0
[2024-09-26 19:37:40,907][root][INFO] - Step: 30/960  |  Loss: 2.2256  |  Score: 28.40 [%]  |  Seq Length: 256.0
[2024-09-26 19:37:42,385][root][INFO] - Step: 570/1035  |  Loss: 0.4854  |  Score: 86.04 [%]  |  Seq Length: 256.0
[2024-09-26 19:37:43,297][root][INFO] - Step: 1020/1350  |  Loss: 0.3311  |  Score: 89.84 [%]  |  Seq Length: 256.0
[2024-09-26 19:37:48,110][root][INFO] - Step: 585/1035  |  Loss: 0.5084  |  Score: 87.03 [%]  |  Seq Length: 256.0
[2024-09-26 19:37:48,683][root][INFO] - Step: 45/960  |  Loss: 1.8916  |  Score: 43.74 [%]  |  Seq Length: 256.0
[2024-09-26 19:37:51,127][root][INFO] - Step: 1035/1350  |  Loss: 0.3075  |  Score: 91.11 [%]  |  Seq Length: 256.0
[2024-09-26 19:37:53,837][root][INFO] - Step: 600/1035  |  Loss: 0.5343  |  Score: 85.57 [%]  |  Seq Length: 256.0
[2024-09-26 19:37:56,444][root][INFO] - Step: 60/960  |  Loss: 1.6867  |  Score: 50.29 [%]  |  Seq Length: 256.0
[2024-09-26 19:37:58,528][root][INFO] - Step: 64/960  |  Loss: 1.4681  |  Score: 61.63 [%]  |  Seq Length: 256.0
[2024-09-26 19:37:59,003][root][INFO] - Step: 1050/1350  |  Loss: 0.3391  |  Score: 90.42 [%]  |  Seq Length: 256.0
[2024-09-26 19:37:59,565][root][INFO] - Step: 615/1035  |  Loss: 0.4913  |  Score: 86.31 [%]  |  Seq Length: 256.0
[2024-09-26 19:38:01,920][root][INFO] - Step: 621/1035  |  Loss: 0.4855  |  Score: 86.22 [%]  |  Seq Length: 256.0
[2024-09-26 19:38:03,364][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 19:38:03,364][root][INFO] - Score: 67.80 [%]  |  Evaluation Time: 4.83 [s]
[2024-09-26 19:38:05,156][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 19:38:05,156][root][INFO] - Score: 77.71 [%]  |  Evaluation Time: 3.23 [s]
[2024-09-26 19:38:07,007][root][INFO] - Step: 1065/1350  |  Loss: 0.3644  |  Score: 89.71 [%]  |  Seq Length: 256.0
[2024-09-26 19:38:08,082][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 19:38:08,083][root][INFO] - Score: 65.23 [%]  |  Evaluation Time: 4.72 [s]
[2024-09-26 19:38:08,084][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 19:38:08,085][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 19:38:08,184][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 19:38:08,184][root][INFO] - Score: 71.19 [%]  |  Evaluation Time: 3.02 [s]
[2024-09-26 19:38:08,188][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 19:38:12,173][root][INFO] - Step: 630/1035  |  Loss: 0.4158  |  Score: 88.15 [%]  |  Seq Length: 256.0
[2024-09-26 19:38:14,325][root][INFO] - Step: 75/960  |  Loss: 1.2989  |  Score: 68.16 [%]  |  Seq Length: 256.0
[2024-09-26 19:38:15,005][root][INFO] - Step: 1080/1350  |  Loss: 0.3397  |  Score: 88.75 [%]  |  Seq Length: 256.0
[2024-09-26 19:38:17,913][root][INFO] - Step: 645/1035  |  Loss: 0.4793  |  Score: 87.31 [%]  |  Seq Length: 256.0
[2024-09-26 19:38:21,362][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 19:38:21,362][root][INFO] - Score: 77.86 [%]  |  Evaluation Time: 6.35 [s]
[2024-09-26 19:38:22,213][root][INFO] - Step: 90/960  |  Loss: 1.3709  |  Score: 69.50 [%]  |  Seq Length: 256.0
[2024-09-26 19:38:23,649][root][INFO] - Step: 660/1035  |  Loss: 0.4134  |  Score: 87.96 [%]  |  Seq Length: 256.0
[2024-09-26 19:38:27,181][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 19:38:27,181][root][INFO] - Score: 71.24 [%]  |  Evaluation Time: 5.82 [s]
[2024-09-26 19:38:27,183][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 19:38:28,174][root][INFO] - Step: 1081/1350  |  Loss: 0.3174  |  Score: 91.50 [%]  |  Seq Length: 256.0
[2024-09-26 19:38:29,374][root][INFO] - Step: 675/1035  |  Loss: 0.5020  |  Score: 86.08 [%]  |  Seq Length: 256.0
[2024-09-26 19:38:29,976][root][INFO] - Step: 105/960  |  Loss: 1.2573  |  Score: 68.91 [%]  |  Seq Length: 256.0
[2024-09-26 19:38:35,168][root][INFO] - Step: 690/1035  |  Loss: 0.5226  |  Score: 86.80 [%]  |  Seq Length: 256.0
[2024-09-26 19:38:35,636][root][INFO] - Step: 1095/1350  |  Loss: 0.3290  |  Score: 90.91 [%]  |  Seq Length: 256.0
[2024-09-26 19:38:37,760][root][INFO] - Step: 120/960  |  Loss: 1.3040  |  Score: 62.12 [%]  |  Seq Length: 256.0
[2024-09-26 19:38:38,390][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 19:38:38,390][root][INFO] - Score: 77.14 [%]  |  Evaluation Time: 3.22 [s]
[2024-09-26 19:38:41,561][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 19:38:41,561][root][INFO] - Score: 70.87 [%]  |  Evaluation Time: 3.17 [s]
[2024-09-26 19:38:41,563][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 19:38:42,011][root][INFO] - Step: 128/960  |  Loss: 1.3166  |  Score: 63.93 [%]  |  Seq Length: 256.0
[2024-09-26 19:38:42,401][root][INFO] - Step: 691/1035  |  Loss: 0.5950  |  Score: 80.44 [%]  |  Seq Length: 256.0
[2024-09-26 19:38:43,598][root][INFO] - Step: 1110/1350  |  Loss: 0.3308  |  Score: 90.12 [%]  |  Seq Length: 256.0
[2024-09-26 19:38:46,871][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 19:38:46,871][root][INFO] - Score: 70.44 [%]  |  Evaluation Time: 4.86 [s]
[2024-09-26 19:38:47,759][root][INFO] - Step: 705/1035  |  Loss: 0.4063  |  Score: 89.32 [%]  |  Seq Length: 256.0
[2024-09-26 19:38:51,451][root][INFO] - Step: 1125/1350  |  Loss: 0.3165  |  Score: 91.12 [%]  |  Seq Length: 256.0
[2024-09-26 19:38:51,569][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 19:38:51,570][root][INFO] - Score: 65.88 [%]  |  Evaluation Time: 4.70 [s]
[2024-09-26 19:38:51,571][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 19:38:51,572][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 19:38:53,493][root][INFO] - Step: 720/1035  |  Loss: 0.4431  |  Score: 86.51 [%]  |  Seq Length: 256.0
[2024-09-26 19:38:55,595][root][INFO] - Step: 135/960  |  Loss: 1.1590  |  Score: 67.35 [%]  |  Seq Length: 256.0
[2024-09-26 19:38:59,235][root][INFO] - Step: 735/1035  |  Loss: 0.4439  |  Score: 87.23 [%]  |  Seq Length: 256.0
[2024-09-26 19:38:59,371][root][INFO] - Step: 1140/1350  |  Loss: 0.3264  |  Score: 90.16 [%]  |  Seq Length: 256.0
[2024-09-26 19:39:03,390][root][INFO] - Step: 150/960  |  Loss: 1.1536  |  Score: 69.64 [%]  |  Seq Length: 256.0
[2024-09-26 19:39:04,963][root][INFO] - Step: 750/1035  |  Loss: 0.4218  |  Score: 88.58 [%]  |  Seq Length: 256.0
[2024-09-26 19:39:07,238][root][INFO] - Step: 1155/1350  |  Loss: 0.3067  |  Score: 91.06 [%]  |  Seq Length: 256.0
[2024-09-26 19:39:08,456][root][INFO] - Step: 759/1035  |  Loss: 0.4123  |  Score: 89.13 [%]  |  Seq Length: 256.0
[2024-09-26 19:39:11,211][root][INFO] - Step: 165/960  |  Loss: 1.0561  |  Score: 71.11 [%]  |  Seq Length: 256.0
[2024-09-26 19:39:11,590][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 19:39:11,590][root][INFO] - Score: 77.17 [%]  |  Evaluation Time: 3.13 [s]
[2024-09-26 19:39:14,796][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 19:39:14,796][root][INFO] - Score: 70.58 [%]  |  Evaluation Time: 3.20 [s]
[2024-09-26 19:39:14,798][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 19:39:15,140][root][INFO] - Step: 1170/1350  |  Loss: 0.3228  |  Score: 89.85 [%]  |  Seq Length: 256.0
[2024-09-26 19:39:17,440][root][INFO] - Step: 765/1035  |  Loss: 0.3949  |  Score: 88.45 [%]  |  Seq Length: 256.0
[2024-09-26 19:39:19,069][root][INFO] - Step: 180/960  |  Loss: 1.0026  |  Score: 71.50 [%]  |  Seq Length: 256.0
[2024-09-26 19:39:21,549][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 19:39:21,549][root][INFO] - Score: 77.18 [%]  |  Evaluation Time: 6.41 [s]
[2024-09-26 19:39:23,166][root][INFO] - Step: 780/1035  |  Loss: 0.3600  |  Score: 89.84 [%]  |  Seq Length: 256.0
[2024-09-26 19:39:25,383][root][INFO] - Step: 192/960  |  Loss: 1.1689  |  Score: 71.09 [%]  |  Seq Length: 256.0
[2024-09-26 19:39:27,322][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 19:39:27,322][root][INFO] - Score: 71.65 [%]  |  Evaluation Time: 5.77 [s]
[2024-09-26 19:39:27,324][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 19:39:28,277][root][INFO] - Step: 1171/1350  |  Loss: 0.3813  |  Score: 92.37 [%]  |  Seq Length: 256.0
[2024-09-26 19:39:28,913][root][INFO] - Step: 795/1035  |  Loss: 0.3787  |  Score: 89.87 [%]  |  Seq Length: 256.0
[2024-09-26 19:39:30,141][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 19:39:30,141][root][INFO] - Score: 78.68 [%]  |  Evaluation Time: 4.76 [s]
[2024-09-26 19:39:34,644][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 19:39:34,644][root][INFO] - Score: 68.74 [%]  |  Evaluation Time: 4.50 [s]
[2024-09-26 19:39:34,645][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 19:39:34,647][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 19:39:34,651][root][INFO] - Step: 810/1035  |  Loss: 0.4244  |  Score: 89.12 [%]  |  Seq Length: 256.0
[2024-09-26 19:39:35,685][root][INFO] - Step: 1185/1350  |  Loss: 0.2950  |  Score: 90.64 [%]  |  Seq Length: 256.0
[2024-09-26 19:39:36,605][root][INFO] - Step: 195/960  |  Loss: 0.8890  |  Score: 73.59 [%]  |  Seq Length: 256.0
[2024-09-26 19:39:40,379][root][INFO] - Step: 825/1035  |  Loss: 0.4084  |  Score: 88.45 [%]  |  Seq Length: 256.0
[2024-09-26 19:39:41,587][root][INFO] - Step: 828/1035  |  Loss: 0.3992  |  Score: 89.41 [%]  |  Seq Length: 256.0
[2024-09-26 19:39:43,470][root][INFO] - Step: 1200/1350  |  Loss: 0.3234  |  Score: 90.41 [%]  |  Seq Length: 256.0
[2024-09-26 19:39:44,429][root][INFO] - Step: 210/960  |  Loss: 0.9878  |  Score: 72.75 [%]  |  Seq Length: 256.0
[2024-09-26 19:39:44,745][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 19:39:44,745][root][INFO] - Score: 76.94 [%]  |  Evaluation Time: 3.16 [s]
[2024-09-26 19:39:47,808][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 19:39:47,808][root][INFO] - Score: 71.00 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-26 19:39:47,810][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 19:39:51,247][root][INFO] - Step: 1215/1350  |  Loss: 0.3432  |  Score: 90.70 [%]  |  Seq Length: 256.0
[2024-09-26 19:39:52,210][root][INFO] - Step: 225/960  |  Loss: 0.8677  |  Score: 78.30 [%]  |  Seq Length: 256.0
[2024-09-26 19:39:52,881][root][INFO] - Step: 840/1035  |  Loss: 0.3812  |  Score: 89.64 [%]  |  Seq Length: 256.0
[2024-09-26 19:39:58,622][root][INFO] - Step: 855/1035  |  Loss: 0.3854  |  Score: 89.31 [%]  |  Seq Length: 256.0
[2024-09-26 19:39:59,017][root][INFO] - Step: 1230/1350  |  Loss: 0.3131  |  Score: 90.22 [%]  |  Seq Length: 256.0
[2024-09-26 19:39:59,960][root][INFO] - Step: 240/960  |  Loss: 0.8759  |  Score: 74.49 [%]  |  Seq Length: 256.0
[2024-09-26 19:40:04,419][root][INFO] - Step: 870/1035  |  Loss: 0.3853  |  Score: 88.80 [%]  |  Seq Length: 256.0
[2024-09-26 19:40:06,703][root][INFO] - Step: 1245/1350  |  Loss: 0.3016  |  Score: 91.19 [%]  |  Seq Length: 256.0
[2024-09-26 19:40:07,712][root][INFO] - Step: 255/960  |  Loss: 1.0116  |  Score: 74.93 [%]  |  Seq Length: 256.0
[2024-09-26 19:40:08,277][root][INFO] - Step: 256/960  |  Loss: 0.8147  |  Score: 81.40 [%]  |  Seq Length: 256.0
[2024-09-26 19:40:10,189][root][INFO] - Step: 885/1035  |  Loss: 0.3579  |  Score: 89.77 [%]  |  Seq Length: 256.0
[2024-09-26 19:40:13,001][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 19:40:13,001][root][INFO] - Score: 77.61 [%]  |  Evaluation Time: 4.72 [s]
[2024-09-26 19:40:14,362][root][INFO] - Step: 1260/1350  |  Loss: 0.3170  |  Score: 90.63 [%]  |  Seq Length: 256.0
[2024-09-26 19:40:14,840][root][INFO] - Step: 897/1035  |  Loss: 0.3657  |  Score: 89.80 [%]  |  Seq Length: 256.0
[2024-09-26 19:40:17,461][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 19:40:17,461][root][INFO] - Score: 69.35 [%]  |  Evaluation Time: 4.46 [s]
[2024-09-26 19:40:17,464][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 19:40:18,058][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 19:40:18,058][root][INFO] - Score: 77.42 [%]  |  Evaluation Time: 3.21 [s]
[2024-09-26 19:40:20,662][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 19:40:20,662][root][INFO] - Score: 78.09 [%]  |  Evaluation Time: 6.30 [s]
[2024-09-26 19:40:21,088][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 19:40:21,088][root][INFO] - Score: 70.68 [%]  |  Evaluation Time: 3.03 [s]
[2024-09-26 19:40:21,091][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 19:40:22,560][root][INFO] - Step: 900/1035  |  Loss: 0.3281  |  Score: 87.69 [%]  |  Seq Length: 256.0
[2024-09-26 19:40:25,067][root][INFO] - Step: 270/960  |  Loss: 0.8255  |  Score: 80.61 [%]  |  Seq Length: 256.0
[2024-09-26 19:40:26,488][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 19:40:26,489][root][INFO] - Score: 70.91 [%]  |  Evaluation Time: 5.82 [s]
[2024-09-26 19:40:26,491][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 19:40:27,431][root][INFO] - Step: 1261/1350  |  Loss: 0.3459  |  Score: 90.81 [%]  |  Seq Length: 256.0
[2024-09-26 19:40:28,287][root][INFO] - Step: 915/1035  |  Loss: 0.3917  |  Score: 88.63 [%]  |  Seq Length: 256.0
[2024-09-26 19:40:32,819][root][INFO] - Step: 285/960  |  Loss: 0.7631  |  Score: 79.41 [%]  |  Seq Length: 256.0
[2024-09-26 19:40:34,011][root][INFO] - Step: 930/1035  |  Loss: 0.3601  |  Score: 90.36 [%]  |  Seq Length: 256.0
[2024-09-26 19:40:34,913][root][INFO] - Step: 1275/1350  |  Loss: 0.3161  |  Score: 90.14 [%]  |  Seq Length: 256.0
[2024-09-26 19:40:39,736][root][INFO] - Step: 945/1035  |  Loss: 0.3675  |  Score: 89.77 [%]  |  Seq Length: 256.0
[2024-09-26 19:40:40,535][root][INFO] - Step: 300/960  |  Loss: 0.7885  |  Score: 78.50 [%]  |  Seq Length: 256.0
[2024-09-26 19:40:42,813][root][INFO] - Step: 1290/1350  |  Loss: 0.3239  |  Score: 90.51 [%]  |  Seq Length: 256.0
[2024-09-26 19:40:45,458][root][INFO] - Step: 960/1035  |  Loss: 0.3377  |  Score: 90.17 [%]  |  Seq Length: 256.0
[2024-09-26 19:40:47,774][root][INFO] - Step: 966/1035  |  Loss: 0.3910  |  Score: 89.43 [%]  |  Seq Length: 256.0
[2024-09-26 19:40:48,370][root][INFO] - Step: 315/960  |  Loss: 0.9201  |  Score: 76.32 [%]  |  Seq Length: 256.0
[2024-09-26 19:40:50,791][root][INFO] - Step: 1305/1350  |  Loss: 0.2913  |  Score: 91.08 [%]  |  Seq Length: 256.0
[2024-09-26 19:40:50,937][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 19:40:50,938][root][INFO] - Score: 76.71 [%]  |  Evaluation Time: 3.16 [s]
[2024-09-26 19:40:50,972][root][INFO] - Step: 320/960  |  Loss: 0.8664  |  Score: 75.64 [%]  |  Seq Length: 256.0
[2024-09-26 19:40:54,089][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 19:40:54,089][root][INFO] - Score: 70.98 [%]  |  Evaluation Time: 3.15 [s]
[2024-09-26 19:40:54,091][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 19:40:55,651][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 19:40:55,652][root][INFO] - Score: 76.20 [%]  |  Evaluation Time: 4.68 [s]
[2024-09-26 19:40:57,847][root][INFO] - Step: 975/1035  |  Loss: 0.3657  |  Score: 89.47 [%]  |  Seq Length: 256.0
[2024-09-26 19:40:58,742][root][INFO] - Step: 1320/1350  |  Loss: 0.3350  |  Score: 90.19 [%]  |  Seq Length: 256.0
[2024-09-26 19:41:00,117][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 19:41:00,117][root][INFO] - Score: 71.91 [%]  |  Evaluation Time: 4.46 [s]
[2024-09-26 19:41:00,118][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 19:41:00,120][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 19:41:03,577][root][INFO] - Step: 990/1035  |  Loss: 0.3411  |  Score: 91.25 [%]  |  Seq Length: 256.0
[2024-09-26 19:41:05,662][root][INFO] - Step: 330/960  |  Loss: 0.6984  |  Score: 81.51 [%]  |  Seq Length: 256.0
[2024-09-26 19:41:06,770][root][INFO] - Step: 1335/1350  |  Loss: 0.3115  |  Score: 90.87 [%]  |  Seq Length: 256.0
[2024-09-26 19:41:09,305][root][INFO] - Step: 1005/1035  |  Loss: 0.3333  |  Score: 90.57 [%]  |  Seq Length: 256.0
[2024-09-26 19:41:13,377][root][INFO] - Step: 345/960  |  Loss: 0.6841  |  Score: 82.57 [%]  |  Seq Length: 256.0
[2024-09-26 19:41:14,682][root][INFO] - Step: 1350/1350  |  Loss: 0.3398  |  Score: 89.37 [%]  |  Seq Length: 256.0
[2024-09-26 19:41:15,032][root][INFO] - Step: 1020/1035  |  Loss: 0.3183  |  Score: 91.41 [%]  |  Seq Length: 256.0
[2024-09-26 19:41:20,821][root][INFO] - Step: 1035/1035  |  Loss: 0.3141  |  Score: 90.60 [%]  |  Seq Length: 256.0
[2024-09-26 19:41:21,028][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 19:41:21,028][root][INFO] - Score: 78.40 [%]  |  Evaluation Time: 6.34 [s]
[2024-09-26 19:41:21,122][root][INFO] - Step: 360/960  |  Loss: 0.6684  |  Score: 81.62 [%]  |  Seq Length: 256.0
[2024-09-26 19:41:24,056][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 19:41:24,057][root][INFO] - Score: 77.45 [%]  |  Evaluation Time: 3.23 [s]
[2024-09-26 19:41:26,803][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 19:41:26,803][root][INFO] - Score: 70.85 [%]  |  Evaluation Time: 5.77 [s]
[2024-09-26 19:41:26,805][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 19:41:26,805][root][INFO] - - Epoch: 5
[2024-09-26 19:41:26,805][root][INFO] - - DEV score: 79.37 [%]
[2024-09-26 19:41:26,805][root][INFO] - - TEST score: 73.20 [%]
[2024-09-26 19:41:26,806][root][INFO] - Fine-tuning is done!
[2024-09-26 19:41:27,128][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 19:41:27,128][root][INFO] - Score: 70.88 [%]  |  Evaluation Time: 3.07 [s]
[2024-09-26 19:41:27,129][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 19:41:27,129][root][INFO] - - Epoch: 6
[2024-09-26 19:41:27,129][root][INFO] - - DEV score: 78.06 [%]
[2024-09-26 19:41:27,130][root][INFO] - - TEST score: 71.92 [%]
[2024-09-26 19:41:27,131][root][INFO] - Fine-tuning is done!
[2024-09-26 19:41:28,885][root][INFO] - Step: 375/960  |  Loss: 0.7983  |  Score: 79.29 [%]  |  Seq Length: 256.0
[2024-09-26 19:41:33,127][root][INFO] - 

[2024-09-26 19:41:33,127][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 19:41:33,128][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:41:33,128][root][INFO] - 

[2024-09-26 19:41:33,128][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': False, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 19:41:33,665][root][INFO] - Step: 384/960  |  Loss: 0.7340  |  Score: 80.15 [%]  |  Seq Length: 256.0
[2024-09-26 19:41:37,294][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 19:41:37,295][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 19:41:37,295][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 19:41:37,295][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 19:41:37,296][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 19:41:37,296][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 19:41:37,297][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 19:41:37,297][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 19:41:37,298][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 19:41:37,298][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 19:41:37,299][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 19:41:37,299][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 19:41:37,300][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 19:41:37,300][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 19:41:37,301][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 19:41:37,301][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 19:41:37,302][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 19:41:37,302][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 19:41:37,303][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 19:41:37,303][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 19:41:37,304][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 19:41:37,304][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 19:41:37,305][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 19:41:37,305][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 19:41:37,307][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 19:41:37,310][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-26 19:41:37,414][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-26 19:41:37,417][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-26 19:41:37,619][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 19:41:38,505][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 19:41:38,505][root][INFO] - Score: 78.72 [%]  |  Evaluation Time: 4.84 [s]
[2024-09-26 19:41:43,015][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 19:41:43,016][root][INFO] - Score: 71.06 [%]  |  Evaluation Time: 4.51 [s]
[2024-09-26 19:41:43,017][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 19:41:43,019][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 19:41:44,083][root][INFO] - 

[2024-09-26 19:41:44,083][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 19:41:44,083][root][INFO] - Data Preprocessing
[2024-09-26 19:41:44,083][root][INFO] - ㄴ remain_lang                ko_en_punc
[2024-09-26 19:41:44,083][root][INFO] - ㄴ do_hangeulize              False
[2024-09-26 19:41:44,083][root][INFO] - ㄴ data_remove                True

[2024-09-26 19:41:44,083][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 19:41:44,091][root][INFO] - vocab size              : 51200
[2024-09-26 19:41:44,091][root][INFO] - device                  : gpu
[2024-09-26 19:41:44,092][root][INFO] - random seed             : 42
[2024-09-26 19:41:44,092][root][INFO] - train data size         : 4416
[2024-09-26 19:41:44,092][root][INFO] - max epochs              : 15
[2024-09-26 19:41:44,092][root][INFO] - total steps             : 1035
[2024-09-26 19:41:44,092][root][INFO] - warmup steps            : 104
[2024-09-26 19:41:44,092][root][INFO] - batch size              : 64
[2024-09-26 19:41:44,092][root][INFO] - accumulation steps      : 1
[2024-09-26 19:41:44,092][root][INFO] - optimizer               : adamwscale
[2024-09-26 19:41:44,092][root][INFO] - lr_scheduler            : cosine
[2024-09-26 19:41:44,092][root][INFO] - learning rate           : 0.01
[2024-09-26 19:41:44,092][root][INFO] - max length              : 256

[2024-09-26 19:41:44,093][root][INFO] - LoRA Configuration
[2024-09-26 19:41:44,093][root][INFO] - ㄴ r                    : 32
[2024-09-26 19:41:44,093][root][INFO] - ㄴ alpha                : 128
[2024-09-26 19:41:44,093][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 19:41:44,093][root][INFO] - KOMBO Configuration
[2024-09-26 19:41:44,093][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-26 19:41:44,093][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-26 19:41:44,093][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-26 19:41:44,093][root][INFO] - ㄴ do_combination       : True
[2024-09-26 19:41:44,093][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-26 19:41:44,094][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-26 19:41:44,094][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-26 19:41:44,094][root][INFO] -   ㄴ add_lora           : True

[2024-09-26 19:41:44,094][root][INFO] - LoRA in KOMBO Configuration
[2024-09-26 19:41:44,094][root][INFO] - ㄴ r                : 32
[2024-09-26 19:41:44,094][root][INFO] - ㄴ alpha            : 128
[2024-09-26 19:41:44,094][root][INFO] - ㄴ dropout          : 0.03

[2024-09-26 19:41:44,094][root][INFO] - 

[2024-09-26 19:41:44,094][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:41:44,094][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 19:41:44,095][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 19:41:44,095][root][INFO] - * tb interval   : 15

[2024-09-26 19:41:44,095][root][INFO] - 

[2024-09-26 19:41:44,095][root][INFO] - Start the Training !
[2024-09-26 19:41:44,098][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 19:41:46,555][root][INFO] - Step: 390/960  |  Loss: 0.5026  |  Score: 86.50 [%]  |  Seq Length: 256.0
[2024-09-26 19:41:53,503][root][INFO] - Step: 15/1035  |  Loss: 3.1768  |  Score: 7.80 [%]  |  Seq Length: 256.0
[2024-09-26 19:41:54,284][root][INFO] - Step: 405/960  |  Loss: 0.6585  |  Score: 82.78 [%]  |  Seq Length: 256.0
[2024-09-26 19:42:01,507][root][INFO] - Step: 30/1035  |  Loss: 2.2287  |  Score: 16.95 [%]  |  Seq Length: 256.0
[2024-09-26 19:42:02,060][root][INFO] - Step: 420/960  |  Loss: 0.6327  |  Score: 83.03 [%]  |  Seq Length: 256.0
[2024-09-26 19:42:09,585][root][INFO] - Step: 45/1035  |  Loss: 1.9868  |  Score: 42.19 [%]  |  Seq Length: 256.0
[2024-09-26 19:42:09,820][root][INFO] - Step: 435/960  |  Loss: 0.6375  |  Score: 81.54 [%]  |  Seq Length: 256.0
[2024-09-26 19:42:16,532][root][INFO] - Step: 448/960  |  Loss: 0.6967  |  Score: 82.51 [%]  |  Seq Length: 256.0
[2024-09-26 19:42:17,632][root][INFO] - Step: 60/1035  |  Loss: 1.6527  |  Score: 55.65 [%]  |  Seq Length: 256.0
[2024-09-26 19:42:21,048][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 19:42:21,049][root][INFO] - Score: 79.45 [%]  |  Evaluation Time: 4.51 [s]
[2024-09-26 19:42:22,420][root][INFO] - Step: 69/1035  |  Loss: 1.4555  |  Score: 58.50 [%]  |  Seq Length: 256.0
[2024-09-26 19:42:25,549][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 19:42:25,549][root][INFO] - Score: 69.43 [%]  |  Evaluation Time: 4.50 [s]
[2024-09-26 19:42:25,552][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 19:42:27,030][root][INFO] - Step: 450/960  |  Loss: 0.4526  |  Score: 87.50 [%]  |  Seq Length: 256.0
[2024-09-26 19:42:27,445][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 19:42:27,445][root][INFO] - Score: 70.42 [%]  |  Evaluation Time: 5.02 [s]
[2024-09-26 19:42:32,388][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 19:42:32,388][root][INFO] - Score: 65.67 [%]  |  Evaluation Time: 4.94 [s]
[2024-09-26 19:42:32,389][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 19:42:32,391][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 19:42:34,963][root][INFO] - Step: 465/960  |  Loss: 0.5489  |  Score: 85.64 [%]  |  Seq Length: 256.0
[2024-09-26 19:42:36,200][root][INFO] - Step: 75/1035  |  Loss: 1.3628  |  Score: 64.48 [%]  |  Seq Length: 256.0
[2024-09-26 19:42:42,689][root][INFO] - Step: 480/960  |  Loss: 0.6382  |  Score: 84.06 [%]  |  Seq Length: 256.0
[2024-09-26 19:42:44,198][root][INFO] - Step: 90/1035  |  Loss: 1.3247  |  Score: 61.12 [%]  |  Seq Length: 256.0
[2024-09-26 19:42:50,425][root][INFO] - Step: 495/960  |  Loss: 0.6705  |  Score: 84.57 [%]  |  Seq Length: 256.0
[2024-09-26 19:42:52,208][root][INFO] - Step: 105/1035  |  Loss: 1.3188  |  Score: 64.92 [%]  |  Seq Length: 256.0
[2024-09-26 19:42:58,129][root][INFO] - Step: 510/960  |  Loss: 0.6290  |  Score: 83.93 [%]  |  Seq Length: 256.0
[2024-09-26 19:42:59,193][root][INFO] - Step: 512/960  |  Loss: 0.4276  |  Score: 91.03 [%]  |  Seq Length: 256.0
[2024-09-26 19:43:00,172][root][INFO] - Step: 120/1035  |  Loss: 1.3043  |  Score: 66.13 [%]  |  Seq Length: 256.0
[2024-09-26 19:43:03,775][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 19:43:03,775][root][INFO] - Score: 78.60 [%]  |  Evaluation Time: 4.58 [s]
[2024-09-26 19:43:08,086][root][INFO] - Step: 135/1035  |  Loss: 1.1957  |  Score: 68.36 [%]  |  Seq Length: 256.0
[2024-09-26 19:43:08,285][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 19:43:08,286][root][INFO] - Score: 71.15 [%]  |  Evaluation Time: 4.51 [s]
[2024-09-26 19:43:08,288][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 19:43:09,745][root][INFO] - Step: 138/1035  |  Loss: 1.1560  |  Score: 68.92 [%]  |  Seq Length: 256.0
[2024-09-26 19:43:14,942][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 19:43:14,942][root][INFO] - Score: 76.10 [%]  |  Evaluation Time: 5.19 [s]
[2024-09-26 19:43:15,561][root][INFO] - Step: 525/960  |  Loss: 0.5228  |  Score: 86.20 [%]  |  Seq Length: 256.0
[2024-09-26 19:43:19,785][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 19:43:19,785][root][INFO] - Score: 68.57 [%]  |  Evaluation Time: 4.84 [s]
[2024-09-26 19:43:19,786][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 19:43:19,787][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 19:43:23,375][root][INFO] - Step: 540/960  |  Loss: 0.5016  |  Score: 87.94 [%]  |  Seq Length: 256.0
[2024-09-26 19:43:26,540][root][INFO] - Step: 150/1035  |  Loss: 1.1186  |  Score: 70.78 [%]  |  Seq Length: 256.0
[2024-09-26 19:43:31,166][root][INFO] - Step: 555/960  |  Loss: 0.4819  |  Score: 87.55 [%]  |  Seq Length: 256.0
[2024-09-26 19:43:34,500][root][INFO] - Step: 165/1035  |  Loss: 1.1044  |  Score: 72.00 [%]  |  Seq Length: 256.0
[2024-09-26 19:43:38,857][root][INFO] - Step: 570/960  |  Loss: 0.5441  |  Score: 84.65 [%]  |  Seq Length: 256.0
[2024-09-26 19:43:41,969][root][INFO] - Step: 576/960  |  Loss: 0.5389  |  Score: 87.57 [%]  |  Seq Length: 256.0
[2024-09-26 19:43:42,394][root][INFO] - Step: 180/1035  |  Loss: 1.1104  |  Score: 69.53 [%]  |  Seq Length: 256.0
[2024-09-26 19:43:46,477][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 19:43:46,478][root][INFO] - Score: 79.33 [%]  |  Evaluation Time: 4.51 [s]
[2024-09-26 19:43:50,330][root][INFO] - Step: 195/1035  |  Loss: 1.0592  |  Score: 71.24 [%]  |  Seq Length: 256.0
[2024-09-26 19:43:51,070][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 19:43:51,071][root][INFO] - Score: 71.02 [%]  |  Evaluation Time: 4.59 [s]
[2024-09-26 19:43:51,072][root][INFO] - 
Save new Best Score (Epoch: 9)
[2024-09-26 19:43:51,073][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 19:43:56,135][root][INFO] - Step: 585/960  |  Loss: 0.4771  |  Score: 88.55 [%]  |  Seq Length: 256.0
[2024-09-26 19:43:56,751][root][INFO] - Step: 207/1035  |  Loss: 1.1312  |  Score: 68.12 [%]  |  Seq Length: 256.0
[2024-09-26 19:44:01,827][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 19:44:01,827][root][INFO] - Score: 76.86 [%]  |  Evaluation Time: 5.07 [s]
[2024-09-26 19:44:03,919][root][INFO] - Step: 600/960  |  Loss: 0.4623  |  Score: 88.70 [%]  |  Seq Length: 256.0
[2024-09-26 19:44:06,666][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 19:44:06,666][root][INFO] - Score: 69.37 [%]  |  Evaluation Time: 4.84 [s]
[2024-09-26 19:44:06,668][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 19:44:06,669][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 19:44:08,782][root][INFO] - Step: 210/1035  |  Loss: 0.8623  |  Score: 82.42 [%]  |  Seq Length: 256.0
[2024-09-26 19:44:11,639][root][INFO] - Step: 615/960  |  Loss: 0.4352  |  Score: 88.11 [%]  |  Seq Length: 256.0
[2024-09-26 19:44:16,708][root][INFO] - Step: 225/1035  |  Loss: 0.9627  |  Score: 74.92 [%]  |  Seq Length: 256.0
[2024-09-26 19:44:19,391][root][INFO] - Step: 630/960  |  Loss: 0.4455  |  Score: 87.88 [%]  |  Seq Length: 256.0
[2024-09-26 19:44:24,571][root][INFO] - Step: 640/960  |  Loss: 0.5056  |  Score: 85.75 [%]  |  Seq Length: 256.0
[2024-09-26 19:44:24,633][root][INFO] - Step: 240/1035  |  Loss: 0.9292  |  Score: 74.81 [%]  |  Seq Length: 256.0
[2024-09-26 19:44:29,093][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 19:44:29,093][root][INFO] - Score: 76.88 [%]  |  Evaluation Time: 4.52 [s]
[2024-09-26 19:44:32,557][root][INFO] - Step: 255/1035  |  Loss: 0.8956  |  Score: 73.28 [%]  |  Seq Length: 256.0
[2024-09-26 19:44:33,506][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 19:44:33,506][root][INFO] - Score: 71.02 [%]  |  Evaluation Time: 4.41 [s]
[2024-09-26 19:44:33,508][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 19:44:36,419][root][INFO] - Step: 645/960  |  Loss: 0.3830  |  Score: 88.75 [%]  |  Seq Length: 256.0
[2024-09-26 19:44:40,442][root][INFO] - Step: 270/1035  |  Loss: 0.9984  |  Score: 74.93 [%]  |  Seq Length: 256.0
[2024-09-26 19:44:43,722][root][INFO] - Step: 276/1035  |  Loss: 0.8759  |  Score: 77.74 [%]  |  Seq Length: 256.0
[2024-09-26 19:44:44,168][root][INFO] - Step: 660/960  |  Loss: 0.4046  |  Score: 88.31 [%]  |  Seq Length: 256.0
[2024-09-26 19:44:48,785][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 19:44:48,786][root][INFO] - Score: 76.07 [%]  |  Evaluation Time: 5.06 [s]
[2024-09-26 19:44:51,876][root][INFO] - Step: 675/960  |  Loss: 0.4273  |  Score: 89.87 [%]  |  Seq Length: 256.0
[2024-09-26 19:44:53,651][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 19:44:53,652][root][INFO] - Score: 70.34 [%]  |  Evaluation Time: 4.86 [s]
[2024-09-26 19:44:53,653][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-26 19:44:53,654][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 19:44:58,980][root][INFO] - Step: 285/1035  |  Loss: 0.8050  |  Score: 80.52 [%]  |  Seq Length: 256.0
[2024-09-26 19:44:59,634][root][INFO] - Step: 690/960  |  Loss: 0.4154  |  Score: 88.73 [%]  |  Seq Length: 256.0
[2024-09-26 19:45:06,951][root][INFO] - Step: 704/960  |  Loss: 0.4096  |  Score: 89.03 [%]  |  Seq Length: 256.0
[2024-09-26 19:45:06,970][root][INFO] - Step: 300/1035  |  Loss: 0.7480  |  Score: 79.26 [%]  |  Seq Length: 256.0
[2024-09-26 19:45:11,603][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 19:45:11,603][root][INFO] - Score: 78.24 [%]  |  Evaluation Time: 4.65 [s]
[2024-09-26 19:45:15,014][root][INFO] - Step: 315/1035  |  Loss: 0.8414  |  Score: 77.34 [%]  |  Seq Length: 256.0
[2024-09-26 19:45:16,141][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 19:45:16,141][root][INFO] - Score: 71.27 [%]  |  Evaluation Time: 4.54 [s]
[2024-09-26 19:45:16,144][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 19:45:17,026][root][INFO] - Step: 705/960  |  Loss: 0.3585  |  Score: 89.40 [%]  |  Seq Length: 256.0
[2024-09-26 19:45:22,931][root][INFO] - Step: 330/1035  |  Loss: 0.7748  |  Score: 79.42 [%]  |  Seq Length: 256.0
[2024-09-26 19:45:24,732][root][INFO] - Step: 720/960  |  Loss: 0.3998  |  Score: 90.00 [%]  |  Seq Length: 256.0
[2024-09-26 19:45:30,957][root][INFO] - Step: 345/1035  |  Loss: 0.8151  |  Score: 75.89 [%]  |  Seq Length: 256.0
[2024-09-26 19:45:32,469][root][INFO] - Step: 735/960  |  Loss: 0.4156  |  Score: 89.08 [%]  |  Seq Length: 256.0
[2024-09-26 19:45:36,121][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 19:45:36,121][root][INFO] - Score: 76.55 [%]  |  Evaluation Time: 5.16 [s]
[2024-09-26 19:45:40,288][root][INFO] - Step: 750/960  |  Loss: 0.3770  |  Score: 89.79 [%]  |  Seq Length: 256.0
[2024-09-26 19:45:40,951][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 19:45:40,951][root][INFO] - Score: 70.29 [%]  |  Evaluation Time: 4.83 [s]
[2024-09-26 19:45:40,952][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 19:45:40,953][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 19:45:41,925][root][INFO] - Step: 346/1035  |  Loss: 0.8250  |  Score: 79.84 [%]  |  Seq Length: 256.0
[2024-09-26 19:45:47,998][root][INFO] - Step: 765/960  |  Loss: 0.3912  |  Score: 90.05 [%]  |  Seq Length: 256.0
[2024-09-26 19:45:49,355][root][INFO] - Step: 360/1035  |  Loss: 0.7288  |  Score: 80.53 [%]  |  Seq Length: 256.0
[2024-09-26 19:45:49,576][root][INFO] - Step: 768/960  |  Loss: 0.4425  |  Score: 88.35 [%]  |  Seq Length: 256.0
[2024-09-26 19:45:54,172][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 19:45:54,172][root][INFO] - Score: 78.79 [%]  |  Evaluation Time: 4.59 [s]
[2024-09-26 19:45:57,331][root][INFO] - Step: 375/1035  |  Loss: 0.7029  |  Score: 80.76 [%]  |  Seq Length: 256.0
[2024-09-26 19:45:58,618][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 19:45:58,618][root][INFO] - Score: 71.10 [%]  |  Evaluation Time: 4.44 [s]
[2024-09-26 19:45:58,621][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 19:46:05,167][root][INFO] - Step: 780/960  |  Loss: 0.3497  |  Score: 90.12 [%]  |  Seq Length: 256.0
[2024-09-26 19:46:05,287][root][INFO] - Step: 390/1035  |  Loss: 0.6535  |  Score: 80.72 [%]  |  Seq Length: 256.0
[2024-09-26 19:46:12,893][root][INFO] - Step: 795/960  |  Loss: 0.3525  |  Score: 90.54 [%]  |  Seq Length: 256.0
[2024-09-26 19:46:13,196][root][INFO] - Step: 405/1035  |  Loss: 0.7766  |  Score: 80.95 [%]  |  Seq Length: 256.0
[2024-09-26 19:46:18,017][root][INFO] - Step: 414/1035  |  Loss: 0.7193  |  Score: 82.73 [%]  |  Seq Length: 256.0
[2024-09-26 19:46:20,631][root][INFO] - Step: 810/960  |  Loss: 0.3309  |  Score: 90.34 [%]  |  Seq Length: 256.0
[2024-09-26 19:46:23,300][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 19:46:23,301][root][INFO] - Score: 78.24 [%]  |  Evaluation Time: 5.28 [s]
[2024-09-26 19:46:28,042][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 19:46:28,043][root][INFO] - Score: 71.51 [%]  |  Evaluation Time: 4.74 [s]
[2024-09-26 19:46:28,044][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 19:46:28,045][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 19:46:28,366][root][INFO] - Step: 825/960  |  Loss: 0.3831  |  Score: 88.97 [%]  |  Seq Length: 256.0
[2024-09-26 19:46:31,664][root][INFO] - Step: 420/1035  |  Loss: 0.6537  |  Score: 83.54 [%]  |  Seq Length: 256.0
[2024-09-26 19:46:32,049][root][INFO] - Step: 832/960  |  Loss: 0.3638  |  Score: 90.95 [%]  |  Seq Length: 256.0
[2024-09-26 19:46:36,596][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 19:46:36,596][root][INFO] - Score: 76.23 [%]  |  Evaluation Time: 4.54 [s]
[2024-09-26 19:46:39,716][root][INFO] - Step: 435/1035  |  Loss: 0.5870  |  Score: 83.99 [%]  |  Seq Length: 256.0
[2024-09-26 19:46:40,981][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 19:46:40,981][root][INFO] - Score: 70.76 [%]  |  Evaluation Time: 4.38 [s]
[2024-09-26 19:46:40,983][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 19:46:45,474][root][INFO] - Step: 840/960  |  Loss: 0.3477  |  Score: 91.74 [%]  |  Seq Length: 256.0
[2024-09-26 19:46:47,707][root][INFO] - Step: 450/1035  |  Loss: 0.6514  |  Score: 81.27 [%]  |  Seq Length: 256.0
[2024-09-26 19:46:53,200][root][INFO] - Step: 855/960  |  Loss: 0.3548  |  Score: 89.64 [%]  |  Seq Length: 256.0
[2024-09-26 19:46:55,770][root][INFO] - Step: 465/1035  |  Loss: 0.6300  |  Score: 81.67 [%]  |  Seq Length: 256.0
[2024-09-26 19:47:01,045][root][INFO] - Step: 870/960  |  Loss: 0.3620  |  Score: 90.30 [%]  |  Seq Length: 256.0
[2024-09-26 19:47:03,743][root][INFO] - Step: 480/1035  |  Loss: 0.6173  |  Score: 84.20 [%]  |  Seq Length: 256.0
[2024-09-26 19:47:05,391][root][INFO] - Step: 483/1035  |  Loss: 0.6777  |  Score: 83.30 [%]  |  Seq Length: 256.0
[2024-09-26 19:47:08,812][root][INFO] - Step: 885/960  |  Loss: 0.3735  |  Score: 89.04 [%]  |  Seq Length: 256.0
[2024-09-26 19:47:10,621][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 19:47:10,622][root][INFO] - Score: 77.98 [%]  |  Evaluation Time: 5.23 [s]
[2024-09-26 19:47:14,548][root][INFO] - Step: 896/960  |  Loss: 0.3354  |  Score: 89.41 [%]  |  Seq Length: 256.0
[2024-09-26 19:47:15,401][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 19:47:15,401][root][INFO] - Score: 71.29 [%]  |  Evaluation Time: 4.78 [s]
[2024-09-26 19:47:15,403][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 19:47:19,090][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 19:47:19,091][root][INFO] - Score: 76.59 [%]  |  Evaluation Time: 4.54 [s]
[2024-09-26 19:47:22,226][root][INFO] - Step: 495/1035  |  Loss: 0.5273  |  Score: 85.89 [%]  |  Seq Length: 256.0
[2024-09-26 19:47:23,702][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 19:47:23,702][root][INFO] - Score: 71.47 [%]  |  Evaluation Time: 4.61 [s]
[2024-09-26 19:47:23,705][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 19:47:26,122][root][INFO] - Step: 900/960  |  Loss: 0.3238  |  Score: 91.54 [%]  |  Seq Length: 256.0
[2024-09-26 19:47:30,272][root][INFO] - Step: 510/1035  |  Loss: 0.5879  |  Score: 84.75 [%]  |  Seq Length: 256.0
[2024-09-26 19:47:33,918][root][INFO] - Step: 915/960  |  Loss: 0.3720  |  Score: 89.58 [%]  |  Seq Length: 256.0
[2024-09-26 19:47:38,214][root][INFO] - Step: 525/1035  |  Loss: 0.6583  |  Score: 84.43 [%]  |  Seq Length: 256.0
[2024-09-26 19:47:41,625][root][INFO] - Step: 930/960  |  Loss: 0.3286  |  Score: 90.45 [%]  |  Seq Length: 256.0
[2024-09-26 19:47:46,176][root][INFO] - Step: 540/1035  |  Loss: 0.5562  |  Score: 84.80 [%]  |  Seq Length: 256.0
[2024-09-26 19:47:49,386][root][INFO] - Step: 945/960  |  Loss: 0.3524  |  Score: 89.63 [%]  |  Seq Length: 256.0
[2024-09-26 19:47:52,591][root][INFO] - Step: 552/1035  |  Loss: 0.6371  |  Score: 82.85 [%]  |  Seq Length: 256.0
[2024-09-26 19:47:57,326][root][INFO] - Step: 960/960  |  Loss: 0.3465  |  Score: 89.70 [%]  |  Seq Length: 256.0
[2024-09-26 19:47:57,698][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 19:47:57,699][root][INFO] - Score: 78.72 [%]  |  Evaluation Time: 5.10 [s]
[2024-09-26 19:48:01,938][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 19:48:01,938][root][INFO] - Score: 77.92 [%]  |  Evaluation Time: 4.61 [s]
[2024-09-26 19:48:02,512][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 19:48:02,513][root][INFO] - Score: 69.86 [%]  |  Evaluation Time: 4.81 [s]
[2024-09-26 19:48:02,515][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 19:48:04,566][root][INFO] - Step: 555/1035  |  Loss: 0.5134  |  Score: 87.60 [%]  |  Seq Length: 256.0
[2024-09-26 19:48:06,475][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 19:48:06,475][root][INFO] - Score: 71.12 [%]  |  Evaluation Time: 4.53 [s]
[2024-09-26 19:48:06,476][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 19:48:06,476][root][INFO] - - Epoch: 9
[2024-09-26 19:48:06,476][root][INFO] - - DEV score: 79.33 [%]
[2024-09-26 19:48:06,476][root][INFO] - - TEST score: 71.02 [%]
[2024-09-26 19:48:06,477][root][INFO] - Fine-tuning is done!
[2024-09-26 19:48:12,722][root][INFO] - Step: 570/1035  |  Loss: 0.5121  |  Score: 87.04 [%]  |  Seq Length: 256.0
[2024-09-26 19:48:12,755][root][INFO] - 

[2024-09-26 19:48:12,755][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 19:48:12,755][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:48:12,755][root][INFO] - 

[2024-09-26 19:48:12,756][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_punc', 'do_hangeulize': False, 'data_remove': False, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 19:48:17,448][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 19:48:17,448][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 19:48:17,449][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 19:48:17,449][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 19:48:17,450][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 19:48:17,450][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 19:48:17,451][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 19:48:17,451][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 19:48:17,452][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 19:48:17,452][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 19:48:17,452][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 19:48:17,453][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 19:48:17,453][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 19:48:17,454][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 19:48:17,454][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 19:48:17,455][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 19:48:17,455][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 19:48:17,456][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 19:48:17,456][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 19:48:17,456][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 19:48:17,457][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 19:48:17,457][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 19:48:17,458][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 19:48:17,458][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 19:48:17,460][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 19:48:17,734][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 19:48:20,701][root][INFO] - Step: 585/1035  |  Loss: 0.4985  |  Score: 86.99 [%]  |  Seq Length: 256.0
[2024-09-26 19:48:21,858][root][INFO] - 

[2024-09-26 19:48:21,858][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 19:48:21,858][root][INFO] - Data Preprocessing
[2024-09-26 19:48:21,858][root][INFO] - ㄴ remain_lang                ko_punc
[2024-09-26 19:48:21,858][root][INFO] - ㄴ do_hangeulize              False
[2024-09-26 19:48:21,858][root][INFO] - ㄴ data_remove                False

[2024-09-26 19:48:21,858][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 19:48:21,868][root][INFO] - vocab size              : 51200
[2024-09-26 19:48:21,868][root][INFO] - device                  : gpu
[2024-09-26 19:48:21,868][root][INFO] - random seed             : 42
[2024-09-26 19:48:21,868][root][INFO] - train data size         : 5760
[2024-09-26 19:48:21,868][root][INFO] - max epochs              : 15
[2024-09-26 19:48:21,868][root][INFO] - total steps             : 1350
[2024-09-26 19:48:21,868][root][INFO] - warmup steps            : 135
[2024-09-26 19:48:21,868][root][INFO] - batch size              : 64
[2024-09-26 19:48:21,869][root][INFO] - accumulation steps      : 1
[2024-09-26 19:48:21,869][root][INFO] - optimizer               : adamwscale
[2024-09-26 19:48:21,869][root][INFO] - lr_scheduler            : cosine
[2024-09-26 19:48:21,869][root][INFO] - learning rate           : 0.01
[2024-09-26 19:48:21,869][root][INFO] - max length              : 256

[2024-09-26 19:48:21,869][root][INFO] - LoRA Configuration
[2024-09-26 19:48:21,869][root][INFO] - ㄴ r                    : 32
[2024-09-26 19:48:21,869][root][INFO] - ㄴ alpha                : 128
[2024-09-26 19:48:21,869][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 19:48:21,869][root][INFO] - 

[2024-09-26 19:48:21,869][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:48:21,870][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 19:48:21,870][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 19:48:21,870][root][INFO] - * tb interval   : 15

[2024-09-26 19:48:21,870][root][INFO] - 

[2024-09-26 19:48:21,870][root][INFO] - Start the Training !
[2024-09-26 19:48:21,873][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 19:48:28,637][root][INFO] - Step: 600/1035  |  Loss: 0.5118  |  Score: 85.04 [%]  |  Seq Length: 256.0
[2024-09-26 19:48:29,990][root][INFO] - Step: 15/1350  |  Loss: 3.2422  |  Score: 4.00 [%]  |  Seq Length: 256.0
[2024-09-26 19:48:35,520][root][INFO] - Step: 30/1350  |  Loss: 2.2856  |  Score: 19.47 [%]  |  Seq Length: 256.0
[2024-09-26 19:48:36,512][root][INFO] - Step: 615/1035  |  Loss: 0.4831  |  Score: 86.30 [%]  |  Seq Length: 256.0
[2024-09-26 19:48:39,744][root][INFO] - Step: 621/1035  |  Loss: 0.5617  |  Score: 83.86 [%]  |  Seq Length: 256.0
[2024-09-26 19:48:41,057][root][INFO] - Step: 45/1350  |  Loss: 2.0151  |  Score: 31.23 [%]  |  Seq Length: 256.0
[2024-09-26 19:48:44,788][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 19:48:44,789][root][INFO] - Score: 77.59 [%]  |  Evaluation Time: 5.04 [s]
[2024-09-26 19:48:46,595][root][INFO] - Step: 60/1350  |  Loss: 1.6495  |  Score: 51.14 [%]  |  Seq Length: 256.0
[2024-09-26 19:48:49,622][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 19:48:49,622][root][INFO] - Score: 70.40 [%]  |  Evaluation Time: 4.83 [s]
[2024-09-26 19:48:49,624][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 19:48:52,132][root][INFO] - Step: 75/1350  |  Loss: 1.4615  |  Score: 58.95 [%]  |  Seq Length: 256.0
[2024-09-26 19:48:54,937][root][INFO] - Step: 630/1035  |  Loss: 0.4734  |  Score: 86.20 [%]  |  Seq Length: 256.0
[2024-09-26 19:48:57,679][root][INFO] - Step: 90/1350  |  Loss: 1.4239  |  Score: 57.16 [%]  |  Seq Length: 256.0
[2024-09-26 19:49:01,531][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 19:49:01,532][root][INFO] - Score: 71.81 [%]  |  Evaluation Time: 3.85 [s]
[2024-09-26 19:49:02,939][root][INFO] - Step: 645/1035  |  Loss: 0.4180  |  Score: 89.20 [%]  |  Seq Length: 256.0
[2024-09-26 19:49:05,137][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 19:49:05,137][root][INFO] - Score: 65.52 [%]  |  Evaluation Time: 3.60 [s]
[2024-09-26 19:49:05,138][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 19:49:05,139][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 19:49:05,834][root][INFO] - Step: 91/1350  |  Loss: 1.0584  |  Score: 72.61 [%]  |  Seq Length: 256.0
[2024-09-26 19:49:10,835][root][INFO] - Step: 660/1035  |  Loss: 0.4519  |  Score: 87.21 [%]  |  Seq Length: 256.0
[2024-09-26 19:49:11,014][root][INFO] - Step: 105/1350  |  Loss: 1.3413  |  Score: 64.48 [%]  |  Seq Length: 256.0
[2024-09-26 19:49:16,570][root][INFO] - Step: 120/1350  |  Loss: 1.3422  |  Score: 63.97 [%]  |  Seq Length: 256.0
[2024-09-26 19:49:18,819][root][INFO] - Step: 675/1035  |  Loss: 0.4466  |  Score: 87.31 [%]  |  Seq Length: 256.0
[2024-09-26 19:49:22,126][root][INFO] - Step: 135/1350  |  Loss: 1.2283  |  Score: 64.07 [%]  |  Seq Length: 256.0
[2024-09-26 19:49:26,813][root][INFO] - Step: 690/1035  |  Loss: 0.4537  |  Score: 86.25 [%]  |  Seq Length: 256.0
[2024-09-26 19:49:27,682][root][INFO] - Step: 150/1350  |  Loss: 1.1478  |  Score: 66.92 [%]  |  Seq Length: 256.0
[2024-09-26 19:49:31,965][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 19:49:31,966][root][INFO] - Score: 77.70 [%]  |  Evaluation Time: 5.15 [s]
[2024-09-26 19:49:33,237][root][INFO] - Step: 165/1350  |  Loss: 1.1800  |  Score: 64.74 [%]  |  Seq Length: 256.0
[2024-09-26 19:49:36,676][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 19:49:36,676][root][INFO] - Score: 71.05 [%]  |  Evaluation Time: 4.71 [s]
[2024-09-26 19:49:36,678][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 19:49:37,784][root][INFO] - Step: 691/1035  |  Loss: 0.4860  |  Score: 87.64 [%]  |  Seq Length: 256.0
[2024-09-26 19:49:38,846][root][INFO] - Step: 180/1350  |  Loss: 1.0836  |  Score: 63.98 [%]  |  Seq Length: 256.0
[2024-09-26 19:49:42,757][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 19:49:42,758][root][INFO] - Score: 76.16 [%]  |  Evaluation Time: 3.91 [s]
[2024-09-26 19:49:45,227][root][INFO] - Step: 705/1035  |  Loss: 0.3750  |  Score: 89.45 [%]  |  Seq Length: 256.0
[2024-09-26 19:49:46,363][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 19:49:46,363][root][INFO] - Score: 68.48 [%]  |  Evaluation Time: 3.60 [s]
[2024-09-26 19:49:46,364][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 19:49:46,365][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 19:49:47,081][root][INFO] - Step: 181/1350  |  Loss: 0.8556  |  Score: 75.15 [%]  |  Seq Length: 256.0
[2024-09-26 19:49:52,287][root][INFO] - Step: 195/1350  |  Loss: 1.0277  |  Score: 69.42 [%]  |  Seq Length: 256.0
[2024-09-26 19:49:53,241][root][INFO] - Step: 720/1035  |  Loss: 0.4222  |  Score: 88.66 [%]  |  Seq Length: 256.0
[2024-09-26 19:49:57,870][root][INFO] - Step: 210/1350  |  Loss: 1.0556  |  Score: 69.49 [%]  |  Seq Length: 256.0
[2024-09-26 19:50:01,335][root][INFO] - Step: 735/1035  |  Loss: 0.3840  |  Score: 88.88 [%]  |  Seq Length: 256.0
[2024-09-26 19:50:03,502][root][INFO] - Step: 225/1350  |  Loss: 1.0132  |  Score: 71.54 [%]  |  Seq Length: 256.0
[2024-09-26 19:50:09,122][root][INFO] - Step: 240/1350  |  Loss: 1.0809  |  Score: 68.82 [%]  |  Seq Length: 256.0
[2024-09-26 19:50:09,270][root][INFO] - Step: 750/1035  |  Loss: 0.3961  |  Score: 89.79 [%]  |  Seq Length: 256.0
[2024-09-26 19:50:14,106][root][INFO] - Step: 759/1035  |  Loss: 0.3845  |  Score: 89.25 [%]  |  Seq Length: 256.0
[2024-09-26 19:50:14,741][root][INFO] - Step: 255/1350  |  Loss: 1.0621  |  Score: 69.37 [%]  |  Seq Length: 256.0
[2024-09-26 19:50:19,334][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 19:50:19,334][root][INFO] - Score: 76.73 [%]  |  Evaluation Time: 5.22 [s]
[2024-09-26 19:50:20,408][root][INFO] - Step: 270/1350  |  Loss: 1.0043  |  Score: 70.11 [%]  |  Seq Length: 256.0
[2024-09-26 19:50:24,063][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 19:50:24,064][root][INFO] - Score: 69.59 [%]  |  Evaluation Time: 4.73 [s]
[2024-09-26 19:50:24,066][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 19:50:24,249][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 19:50:24,249][root][INFO] - Score: 77.89 [%]  |  Evaluation Time: 3.84 [s]
[2024-09-26 19:50:27,774][root][INFO] - Step: 765/1035  |  Loss: 0.3747  |  Score: 87.12 [%]  |  Seq Length: 256.0
[2024-09-26 19:50:27,863][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 19:50:27,863][root][INFO] - Score: 69.11 [%]  |  Evaluation Time: 3.61 [s]
[2024-09-26 19:50:27,864][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 19:50:27,868][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 19:50:28,587][root][INFO] - Step: 271/1350  |  Loss: 0.8061  |  Score: 84.48 [%]  |  Seq Length: 256.0
[2024-09-26 19:50:33,835][root][INFO] - Step: 285/1350  |  Loss: 0.8382  |  Score: 75.00 [%]  |  Seq Length: 256.0
[2024-09-26 19:50:35,747][root][INFO] - Step: 780/1035  |  Loss: 0.3889  |  Score: 89.14 [%]  |  Seq Length: 256.0
[2024-09-26 19:50:39,443][root][INFO] - Step: 300/1350  |  Loss: 0.9521  |  Score: 73.63 [%]  |  Seq Length: 256.0
[2024-09-26 19:50:43,714][root][INFO] - Step: 795/1035  |  Loss: 0.3686  |  Score: 89.64 [%]  |  Seq Length: 256.0
[2024-09-26 19:50:45,062][root][INFO] - Step: 315/1350  |  Loss: 0.9803  |  Score: 74.79 [%]  |  Seq Length: 256.0
[2024-09-26 19:50:50,680][root][INFO] - Step: 330/1350  |  Loss: 0.8840  |  Score: 73.09 [%]  |  Seq Length: 256.0
[2024-09-26 19:50:51,721][root][INFO] - Step: 810/1035  |  Loss: 0.3759  |  Score: 89.83 [%]  |  Seq Length: 256.0
[2024-09-26 19:50:56,273][root][INFO] - Step: 345/1350  |  Loss: 0.8729  |  Score: 73.90 [%]  |  Seq Length: 256.0
[2024-09-26 19:50:59,686][root][INFO] - Step: 825/1035  |  Loss: 0.4047  |  Score: 88.65 [%]  |  Seq Length: 256.0
[2024-09-26 19:51:01,356][root][INFO] - Step: 828/1035  |  Loss: 0.3052  |  Score: 91.16 [%]  |  Seq Length: 256.0
[2024-09-26 19:51:01,872][root][INFO] - Step: 360/1350  |  Loss: 0.8353  |  Score: 75.59 [%]  |  Seq Length: 256.0
[2024-09-26 19:51:05,861][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 19:51:05,861][root][INFO] - Score: 77.63 [%]  |  Evaluation Time: 3.99 [s]
[2024-09-26 19:51:06,551][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 19:51:06,551][root][INFO] - Score: 78.52 [%]  |  Evaluation Time: 5.19 [s]
[2024-09-26 19:51:09,487][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 19:51:09,487][root][INFO] - Score: 70.05 [%]  |  Evaluation Time: 3.62 [s]
[2024-09-26 19:51:09,488][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-26 19:51:09,490][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 19:51:10,208][root][INFO] - Step: 361/1350  |  Loss: 0.9335  |  Score: 83.70 [%]  |  Seq Length: 256.0
[2024-09-26 19:51:11,361][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 19:51:11,361][root][INFO] - Score: 70.87 [%]  |  Evaluation Time: 4.81 [s]
[2024-09-26 19:51:11,363][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 19:51:15,405][root][INFO] - Step: 375/1350  |  Loss: 0.7194  |  Score: 77.17 [%]  |  Seq Length: 256.0
[2024-09-26 19:51:18,101][root][INFO] - Step: 840/1035  |  Loss: 0.3729  |  Score: 89.85 [%]  |  Seq Length: 256.0
[2024-09-26 19:51:20,979][root][INFO] - Step: 390/1350  |  Loss: 0.7745  |  Score: 78.90 [%]  |  Seq Length: 256.0
[2024-09-26 19:51:26,028][root][INFO] - Step: 855/1035  |  Loss: 0.3481  |  Score: 90.28 [%]  |  Seq Length: 256.0
[2024-09-26 19:51:26,551][root][INFO] - Step: 405/1350  |  Loss: 0.7926  |  Score: 77.30 [%]  |  Seq Length: 256.0
[2024-09-26 19:51:32,116][root][INFO] - Step: 420/1350  |  Loss: 0.7567  |  Score: 78.38 [%]  |  Seq Length: 256.0
[2024-09-26 19:51:33,959][root][INFO] - Step: 870/1035  |  Loss: 0.3647  |  Score: 88.66 [%]  |  Seq Length: 256.0
[2024-09-26 19:51:37,687][root][INFO] - Step: 435/1350  |  Loss: 0.8490  |  Score: 77.84 [%]  |  Seq Length: 256.0
[2024-09-26 19:51:41,888][root][INFO] - Step: 885/1035  |  Loss: 0.3455  |  Score: 90.41 [%]  |  Seq Length: 256.0
[2024-09-26 19:51:43,290][root][INFO] - Step: 450/1350  |  Loss: 0.7937  |  Score: 77.42 [%]  |  Seq Length: 256.0
[2024-09-26 19:51:47,226][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 19:51:47,226][root][INFO] - Score: 78.71 [%]  |  Evaluation Time: 3.93 [s]
[2024-09-26 19:51:48,294][root][INFO] - Step: 897/1035  |  Loss: 0.3598  |  Score: 89.18 [%]  |  Seq Length: 256.0
[2024-09-26 19:51:50,904][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 19:51:50,904][root][INFO] - Score: 70.39 [%]  |  Evaluation Time: 3.68 [s]
[2024-09-26 19:51:50,905][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 19:51:50,906][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 19:51:51,605][root][INFO] - Step: 451/1350  |  Loss: 0.7436  |  Score: 77.68 [%]  |  Seq Length: 256.0
[2024-09-26 19:51:53,517][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 19:51:53,518][root][INFO] - Score: 76.75 [%]  |  Evaluation Time: 5.22 [s]
[2024-09-26 19:51:56,802][root][INFO] - Step: 465/1350  |  Loss: 0.6585  |  Score: 79.53 [%]  |  Seq Length: 256.0
[2024-09-26 19:51:58,454][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 19:51:58,455][root][INFO] - Score: 70.29 [%]  |  Evaluation Time: 4.93 [s]
[2024-09-26 19:51:58,457][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 19:52:00,538][root][INFO] - Step: 900/1035  |  Loss: 0.3598  |  Score: 90.70 [%]  |  Seq Length: 256.0
[2024-09-26 19:52:02,371][root][INFO] - Step: 480/1350  |  Loss: 0.6612  |  Score: 80.96 [%]  |  Seq Length: 256.0
[2024-09-26 19:52:07,948][root][INFO] - Step: 495/1350  |  Loss: 0.6882  |  Score: 81.25 [%]  |  Seq Length: 256.0
[2024-09-26 19:52:08,621][root][INFO] - Step: 915/1035  |  Loss: 0.3459  |  Score: 89.98 [%]  |  Seq Length: 256.0
[2024-09-26 19:52:13,525][root][INFO] - Step: 510/1350  |  Loss: 0.7674  |  Score: 79.62 [%]  |  Seq Length: 256.0
[2024-09-26 19:52:16,582][root][INFO] - Step: 930/1035  |  Loss: 0.3447  |  Score: 90.63 [%]  |  Seq Length: 256.0
[2024-09-26 19:52:19,102][root][INFO] - Step: 525/1350  |  Loss: 0.7616  |  Score: 81.63 [%]  |  Seq Length: 256.0
[2024-09-26 19:52:24,566][root][INFO] - Step: 945/1035  |  Loss: 0.3241  |  Score: 90.93 [%]  |  Seq Length: 256.0
[2024-09-26 19:52:24,699][root][INFO] - Step: 540/1350  |  Loss: 0.6719  |  Score: 81.64 [%]  |  Seq Length: 256.0
[2024-09-26 19:52:28,512][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 19:52:28,512][root][INFO] - Score: 78.09 [%]  |  Evaluation Time: 3.81 [s]
[2024-09-26 19:52:32,048][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 19:52:32,048][root][INFO] - Score: 69.67 [%]  |  Evaluation Time: 3.53 [s]
[2024-09-26 19:52:32,050][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 19:52:32,460][root][INFO] - Step: 960/1035  |  Loss: 0.3654  |  Score: 89.74 [%]  |  Seq Length: 256.0
[2024-09-26 19:52:32,750][root][INFO] - Step: 541/1350  |  Loss: 0.5039  |  Score: 88.68 [%]  |  Seq Length: 256.0
[2024-09-26 19:52:35,728][root][INFO] - Step: 966/1035  |  Loss: 0.3255  |  Score: 90.92 [%]  |  Seq Length: 256.0
[2024-09-26 19:52:37,945][root][INFO] - Step: 555/1350  |  Loss: 0.6022  |  Score: 83.34 [%]  |  Seq Length: 256.0
[2024-09-26 19:52:40,849][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 19:52:40,849][root][INFO] - Score: 77.56 [%]  |  Evaluation Time: 5.12 [s]
[2024-09-26 19:52:43,516][root][INFO] - Step: 570/1350  |  Loss: 0.5826  |  Score: 82.61 [%]  |  Seq Length: 256.0
[2024-09-26 19:52:45,610][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 19:52:45,610][root][INFO] - Score: 69.93 [%]  |  Evaluation Time: 4.76 [s]
[2024-09-26 19:52:45,613][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 19:52:49,084][root][INFO] - Step: 585/1350  |  Loss: 0.6392  |  Score: 82.24 [%]  |  Seq Length: 256.0
[2024-09-26 19:52:50,820][root][INFO] - Step: 975/1035  |  Loss: 0.3268  |  Score: 90.73 [%]  |  Seq Length: 256.0
[2024-09-26 19:52:54,658][root][INFO] - Step: 600/1350  |  Loss: 0.5817  |  Score: 83.03 [%]  |  Seq Length: 256.0
[2024-09-26 19:52:58,772][root][INFO] - Step: 990/1035  |  Loss: 0.3087  |  Score: 90.94 [%]  |  Seq Length: 256.0
[2024-09-26 19:53:00,230][root][INFO] - Step: 615/1350  |  Loss: 0.5947  |  Score: 82.00 [%]  |  Seq Length: 256.0
[2024-09-26 19:53:05,828][root][INFO] - Step: 630/1350  |  Loss: 0.6533  |  Score: 80.23 [%]  |  Seq Length: 256.0
[2024-09-26 19:53:06,805][root][INFO] - Step: 1005/1035  |  Loss: 0.3306  |  Score: 90.73 [%]  |  Seq Length: 256.0
[2024-09-26 19:53:09,722][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 19:53:09,723][root][INFO] - Score: 77.36 [%]  |  Evaluation Time: 3.89 [s]
[2024-09-26 19:53:13,355][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 19:53:13,355][root][INFO] - Score: 71.94 [%]  |  Evaluation Time: 3.63 [s]
[2024-09-26 19:53:13,356][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-26 19:53:13,357][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 19:53:14,074][root][INFO] - Step: 631/1350  |  Loss: 0.5920  |  Score: 89.49 [%]  |  Seq Length: 256.0
[2024-09-26 19:53:14,820][root][INFO] - Step: 1020/1035  |  Loss: 0.3490  |  Score: 88.47 [%]  |  Seq Length: 256.0
[2024-09-26 19:53:19,279][root][INFO] - Step: 645/1350  |  Loss: 0.5190  |  Score: 85.53 [%]  |  Seq Length: 256.0
[2024-09-26 19:53:22,798][root][INFO] - Step: 1035/1035  |  Loss: 0.3645  |  Score: 90.07 [%]  |  Seq Length: 256.0
[2024-09-26 19:53:24,854][root][INFO] - Step: 660/1350  |  Loss: 0.5563  |  Score: 83.79 [%]  |  Seq Length: 256.0
[2024-09-26 19:53:28,146][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 19:53:28,146][root][INFO] - Score: 77.48 [%]  |  Evaluation Time: 5.35 [s]
[2024-09-26 19:53:30,429][root][INFO] - Step: 675/1350  |  Loss: 0.5296  |  Score: 85.37 [%]  |  Seq Length: 256.0
[2024-09-26 19:53:32,986][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 19:53:32,986][root][INFO] - Score: 70.97 [%]  |  Evaluation Time: 4.84 [s]
[2024-09-26 19:53:32,987][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 19:53:32,987][root][INFO] - - Epoch: 6
[2024-09-26 19:53:32,987][root][INFO] - - DEV score: 78.24 [%]
[2024-09-26 19:53:32,987][root][INFO] - - TEST score: 71.51 [%]
[2024-09-26 19:53:32,988][root][INFO] - Fine-tuning is done!
[2024-09-26 19:53:36,007][root][INFO] - Step: 690/1350  |  Loss: 0.5480  |  Score: 84.04 [%]  |  Seq Length: 256.0
[2024-09-26 19:53:39,763][root][INFO] - 

[2024-09-26 19:53:39,763][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 19:53:39,763][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:53:39,763][root][INFO] - 

[2024-09-26 19:53:39,763][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': False, 'data_remove': False, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 19:53:41,586][root][INFO] - Step: 705/1350  |  Loss: 0.5784  |  Score: 84.44 [%]  |  Seq Length: 256.0
[2024-09-26 19:53:44,760][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 19:53:44,761][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 19:53:44,762][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 19:53:44,763][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 19:53:44,763][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 19:53:44,764][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 19:53:44,764][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 19:53:44,765][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 19:53:44,765][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 19:53:44,766][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 19:53:44,766][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 19:53:44,767][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 19:53:44,767][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 19:53:44,768][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 19:53:44,768][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 19:53:44,769][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 19:53:44,769][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 19:53:44,770][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 19:53:44,770][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 19:53:44,771][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 19:53:44,772][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 19:53:44,772][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 19:53:44,773][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 19:53:44,773][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 19:53:44,775][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 19:53:45,190][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 19:53:47,182][root][INFO] - Step: 720/1350  |  Loss: 0.6043  |  Score: 83.63 [%]  |  Seq Length: 256.0
[2024-09-26 19:53:49,191][root][INFO] - 

[2024-09-26 19:53:49,192][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 19:53:49,192][root][INFO] - Data Preprocessing
[2024-09-26 19:53:49,192][root][INFO] - ㄴ remain_lang                ko_en_punc
[2024-09-26 19:53:49,192][root][INFO] - ㄴ do_hangeulize              False
[2024-09-26 19:53:49,192][root][INFO] - ㄴ data_remove                False

[2024-09-26 19:53:49,192][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 19:53:49,200][root][INFO] - vocab size              : 51200
[2024-09-26 19:53:49,200][root][INFO] - device                  : gpu
[2024-09-26 19:53:49,200][root][INFO] - random seed             : 42
[2024-09-26 19:53:49,200][root][INFO] - train data size         : 5760
[2024-09-26 19:53:49,200][root][INFO] - max epochs              : 15
[2024-09-26 19:53:49,201][root][INFO] - total steps             : 1350
[2024-09-26 19:53:49,201][root][INFO] - warmup steps            : 135
[2024-09-26 19:53:49,201][root][INFO] - batch size              : 64
[2024-09-26 19:53:49,201][root][INFO] - accumulation steps      : 1
[2024-09-26 19:53:49,201][root][INFO] - optimizer               : adamwscale
[2024-09-26 19:53:49,201][root][INFO] - lr_scheduler            : cosine
[2024-09-26 19:53:49,201][root][INFO] - learning rate           : 0.01
[2024-09-26 19:53:49,201][root][INFO] - max length              : 256

[2024-09-26 19:53:49,201][root][INFO] - LoRA Configuration
[2024-09-26 19:53:49,201][root][INFO] - ㄴ r                    : 32
[2024-09-26 19:53:49,201][root][INFO] - ㄴ alpha                : 128
[2024-09-26 19:53:49,201][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 19:53:49,202][root][INFO] - 

[2024-09-26 19:53:49,202][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:53:49,202][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 19:53:49,202][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 19:53:49,202][root][INFO] - * tb interval   : 15

[2024-09-26 19:53:49,202][root][INFO] - 

[2024-09-26 19:53:49,202][root][INFO] - Start the Training !
[2024-09-26 19:53:49,205][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 19:53:51,056][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 19:53:51,056][root][INFO] - Score: 78.35 [%]  |  Evaluation Time: 3.87 [s]
[2024-09-26 19:53:54,719][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 19:53:54,720][root][INFO] - Score: 71.35 [%]  |  Evaluation Time: 3.66 [s]
[2024-09-26 19:53:54,721][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-26 19:53:54,722][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 19:53:55,424][root][INFO] - Step: 721/1350  |  Loss: 0.4556  |  Score: 88.61 [%]  |  Seq Length: 256.0
[2024-09-26 19:53:57,783][root][INFO] - Step: 15/1350  |  Loss: 3.3197  |  Score: 2.45 [%]  |  Seq Length: 256.0
[2024-09-26 19:54:00,629][root][INFO] - Step: 735/1350  |  Loss: 0.4585  |  Score: 86.19 [%]  |  Seq Length: 256.0
[2024-09-26 19:54:03,505][root][INFO] - Step: 30/1350  |  Loss: 2.3261  |  Score: 18.97 [%]  |  Seq Length: 256.0
[2024-09-26 19:54:06,207][root][INFO] - Step: 750/1350  |  Loss: 0.4820  |  Score: 85.72 [%]  |  Seq Length: 256.0
[2024-09-26 19:54:09,230][root][INFO] - Step: 45/1350  |  Loss: 2.0635  |  Score: 29.16 [%]  |  Seq Length: 256.0
[2024-09-26 19:54:11,780][root][INFO] - Step: 765/1350  |  Loss: 0.4845  |  Score: 85.83 [%]  |  Seq Length: 256.0
[2024-09-26 19:54:14,954][root][INFO] - Step: 60/1350  |  Loss: 1.6941  |  Score: 48.99 [%]  |  Seq Length: 256.0
[2024-09-26 19:54:17,350][root][INFO] - Step: 780/1350  |  Loss: 0.4652  |  Score: 85.80 [%]  |  Seq Length: 256.0
[2024-09-26 19:54:20,677][root][INFO] - Step: 75/1350  |  Loss: 1.4790  |  Score: 58.21 [%]  |  Seq Length: 256.0
[2024-09-26 19:54:22,915][root][INFO] - Step: 795/1350  |  Loss: 0.4731  |  Score: 86.22 [%]  |  Seq Length: 256.0
[2024-09-26 19:54:26,418][root][INFO] - Step: 90/1350  |  Loss: 1.4178  |  Score: 58.04 [%]  |  Seq Length: 256.0
[2024-09-26 19:54:28,501][root][INFO] - Step: 810/1350  |  Loss: 0.4747  |  Score: 86.64 [%]  |  Seq Length: 256.0
[2024-09-26 19:54:30,373][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 19:54:30,373][root][INFO] - Score: 70.51 [%]  |  Evaluation Time: 3.95 [s]
[2024-09-26 19:54:32,332][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 19:54:32,333][root][INFO] - Score: 78.47 [%]  |  Evaluation Time: 3.83 [s]
[2024-09-26 19:54:34,007][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 19:54:34,007][root][INFO] - Score: 65.78 [%]  |  Evaluation Time: 3.63 [s]
[2024-09-26 19:54:34,009][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 19:54:34,011][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 19:54:34,738][root][INFO] - Step: 91/1350  |  Loss: 1.2774  |  Score: 64.23 [%]  |  Seq Length: 256.0
[2024-09-26 19:54:35,958][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 19:54:35,958][root][INFO] - Score: 71.77 [%]  |  Evaluation Time: 3.62 [s]
[2024-09-26 19:54:35,959][root][INFO] - 
Save new Best Score (Epoch: 9)
[2024-09-26 19:54:35,960][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 19:54:36,652][root][INFO] - Step: 811/1350  |  Loss: 0.3932  |  Score: 90.53 [%]  |  Seq Length: 256.0
[2024-09-26 19:54:40,081][root][INFO] - Step: 105/1350  |  Loss: 1.2447  |  Score: 64.01 [%]  |  Seq Length: 256.0
[2024-09-26 19:54:41,856][root][INFO] - Step: 825/1350  |  Loss: 0.3904  |  Score: 88.24 [%]  |  Seq Length: 256.0
[2024-09-26 19:54:45,805][root][INFO] - Step: 120/1350  |  Loss: 1.3120  |  Score: 64.03 [%]  |  Seq Length: 256.0
[2024-09-26 19:54:47,429][root][INFO] - Step: 840/1350  |  Loss: 0.3949  |  Score: 87.31 [%]  |  Seq Length: 256.0
[2024-09-26 19:54:51,532][root][INFO] - Step: 135/1350  |  Loss: 1.1659  |  Score: 64.98 [%]  |  Seq Length: 256.0
[2024-09-26 19:54:52,999][root][INFO] - Step: 855/1350  |  Loss: 0.4121  |  Score: 87.04 [%]  |  Seq Length: 256.0
[2024-09-26 19:54:57,262][root][INFO] - Step: 150/1350  |  Loss: 1.0996  |  Score: 67.60 [%]  |  Seq Length: 256.0
[2024-09-26 19:54:58,569][root][INFO] - Step: 870/1350  |  Loss: 0.4468  |  Score: 88.29 [%]  |  Seq Length: 256.0
[2024-09-26 19:55:02,989][root][INFO] - Step: 165/1350  |  Loss: 1.1995  |  Score: 65.33 [%]  |  Seq Length: 256.0
[2024-09-26 19:55:04,139][root][INFO] - Step: 885/1350  |  Loss: 0.4052  |  Score: 88.31 [%]  |  Seq Length: 256.0
[2024-09-26 19:55:08,778][root][INFO] - Step: 180/1350  |  Loss: 1.1671  |  Score: 64.00 [%]  |  Seq Length: 256.0
[2024-09-26 19:55:09,749][root][INFO] - Step: 900/1350  |  Loss: 0.4528  |  Score: 87.49 [%]  |  Seq Length: 256.0
[2024-09-26 19:55:12,705][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 19:55:12,705][root][INFO] - Score: 76.00 [%]  |  Evaluation Time: 3.92 [s]
[2024-09-26 19:55:13,644][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 19:55:13,644][root][INFO] - Score: 78.80 [%]  |  Evaluation Time: 3.89 [s]
[2024-09-26 19:55:16,462][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 19:55:16,463][root][INFO] - Score: 69.02 [%]  |  Evaluation Time: 3.75 [s]
[2024-09-26 19:55:16,464][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 19:55:16,465][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 19:55:17,233][root][INFO] - Step: 181/1350  |  Loss: 0.6673  |  Score: 83.49 [%]  |  Seq Length: 256.0
[2024-09-26 19:55:17,249][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 19:55:17,249][root][INFO] - Score: 71.26 [%]  |  Evaluation Time: 3.60 [s]
[2024-09-26 19:55:17,251][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 19:55:18,040][root][INFO] - Step: 901/1350  |  Loss: 0.4352  |  Score: 85.88 [%]  |  Seq Length: 256.0
[2024-09-26 19:55:22,641][root][INFO] - Step: 195/1350  |  Loss: 0.9676  |  Score: 71.01 [%]  |  Seq Length: 256.0
[2024-09-26 19:55:23,252][root][INFO] - Step: 915/1350  |  Loss: 0.3676  |  Score: 88.68 [%]  |  Seq Length: 256.0
[2024-09-26 19:55:28,405][root][INFO] - Step: 210/1350  |  Loss: 1.0800  |  Score: 68.92 [%]  |  Seq Length: 256.0
[2024-09-26 19:55:28,831][root][INFO] - Step: 930/1350  |  Loss: 0.3754  |  Score: 88.70 [%]  |  Seq Length: 256.0
[2024-09-26 19:55:34,136][root][INFO] - Step: 225/1350  |  Loss: 1.0361  |  Score: 71.05 [%]  |  Seq Length: 256.0
[2024-09-26 19:55:34,410][root][INFO] - Step: 945/1350  |  Loss: 0.3804  |  Score: 89.38 [%]  |  Seq Length: 256.0
[2024-09-26 19:55:39,873][root][INFO] - Step: 240/1350  |  Loss: 0.9631  |  Score: 70.50 [%]  |  Seq Length: 256.0
[2024-09-26 19:55:39,987][root][INFO] - Step: 960/1350  |  Loss: 0.3899  |  Score: 88.89 [%]  |  Seq Length: 256.0
[2024-09-26 19:55:45,563][root][INFO] - Step: 975/1350  |  Loss: 0.3907  |  Score: 88.24 [%]  |  Seq Length: 256.0
[2024-09-26 19:55:45,607][root][INFO] - Step: 255/1350  |  Loss: 0.9734  |  Score: 69.69 [%]  |  Seq Length: 256.0
[2024-09-26 19:55:51,152][root][INFO] - Step: 990/1350  |  Loss: 0.3702  |  Score: 88.67 [%]  |  Seq Length: 256.0
[2024-09-26 19:55:51,383][root][INFO] - Step: 270/1350  |  Loss: 1.0338  |  Score: 70.42 [%]  |  Seq Length: 256.0
[2024-09-26 19:55:55,160][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 19:55:55,161][root][INFO] - Score: 79.10 [%]  |  Evaluation Time: 4.01 [s]
[2024-09-26 19:55:55,331][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 19:55:55,331][root][INFO] - Score: 77.43 [%]  |  Evaluation Time: 3.94 [s]
[2024-09-26 19:55:58,994][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 19:55:58,994][root][INFO] - Score: 71.55 [%]  |  Evaluation Time: 3.83 [s]
[2024-09-26 19:55:58,995][root][INFO] - 
Save new Best Score (Epoch: 11)
[2024-09-26 19:55:58,996][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 19:55:59,047][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 19:55:59,047][root][INFO] - Score: 70.60 [%]  |  Evaluation Time: 3.71 [s]
[2024-09-26 19:55:59,048][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 19:55:59,049][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 19:55:59,729][root][INFO] - Step: 991/1350  |  Loss: 0.2823  |  Score: 90.79 [%]  |  Seq Length: 256.0
[2024-09-26 19:55:59,767][root][INFO] - Step: 271/1350  |  Loss: 0.6233  |  Score: 83.93 [%]  |  Seq Length: 256.0
[2024-09-26 19:56:04,933][root][INFO] - Step: 1005/1350  |  Loss: 0.3769  |  Score: 89.02 [%]  |  Seq Length: 256.0
[2024-09-26 19:56:05,122][root][INFO] - Step: 285/1350  |  Loss: 0.7406  |  Score: 77.24 [%]  |  Seq Length: 256.0
[2024-09-26 19:56:10,508][root][INFO] - Step: 1020/1350  |  Loss: 0.3620  |  Score: 89.52 [%]  |  Seq Length: 256.0
[2024-09-26 19:56:10,866][root][INFO] - Step: 300/1350  |  Loss: 0.9764  |  Score: 73.19 [%]  |  Seq Length: 256.0
[2024-09-26 19:56:16,084][root][INFO] - Step: 1035/1350  |  Loss: 0.3666  |  Score: 88.30 [%]  |  Seq Length: 256.0
[2024-09-26 19:56:16,605][root][INFO] - Step: 315/1350  |  Loss: 1.0028  |  Score: 75.29 [%]  |  Seq Length: 256.0
[2024-09-26 19:56:21,660][root][INFO] - Step: 1050/1350  |  Loss: 0.3399  |  Score: 90.19 [%]  |  Seq Length: 256.0
[2024-09-26 19:56:22,342][root][INFO] - Step: 330/1350  |  Loss: 0.8516  |  Score: 74.66 [%]  |  Seq Length: 256.0
[2024-09-26 19:56:27,240][root][INFO] - Step: 1065/1350  |  Loss: 0.3219  |  Score: 90.59 [%]  |  Seq Length: 256.0
[2024-09-26 19:56:28,090][root][INFO] - Step: 345/1350  |  Loss: 0.8774  |  Score: 75.12 [%]  |  Seq Length: 256.0
[2024-09-26 19:56:32,848][root][INFO] - Step: 1080/1350  |  Loss: 0.3168  |  Score: 89.90 [%]  |  Seq Length: 256.0
[2024-09-26 19:56:33,856][root][INFO] - Step: 360/1350  |  Loss: 0.8987  |  Score: 76.07 [%]  |  Seq Length: 256.0
[2024-09-26 19:56:36,693][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 19:56:36,693][root][INFO] - Score: 78.29 [%]  |  Evaluation Time: 3.84 [s]
[2024-09-26 19:56:37,731][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 19:56:37,731][root][INFO] - Score: 77.07 [%]  |  Evaluation Time: 3.87 [s]
[2024-09-26 19:56:40,231][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 19:56:40,231][root][INFO] - Score: 70.30 [%]  |  Evaluation Time: 3.54 [s]
[2024-09-26 19:56:40,236][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 19:56:40,944][root][INFO] - Step: 1081/1350  |  Loss: 0.3557  |  Score: 87.79 [%]  |  Seq Length: 256.0
[2024-09-26 19:56:41,347][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 19:56:41,347][root][INFO] - Score: 70.73 [%]  |  Evaluation Time: 3.61 [s]
[2024-09-26 19:56:41,350][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 19:56:42,258][root][INFO] - Step: 361/1350  |  Loss: 0.7751  |  Score: 83.80 [%]  |  Seq Length: 256.0
[2024-09-26 19:56:46,156][root][INFO] - Step: 1095/1350  |  Loss: 0.3406  |  Score: 90.47 [%]  |  Seq Length: 256.0
[2024-09-26 19:56:47,617][root][INFO] - Step: 375/1350  |  Loss: 0.7637  |  Score: 76.97 [%]  |  Seq Length: 256.0
[2024-09-26 19:56:51,737][root][INFO] - Step: 1110/1350  |  Loss: 0.3409  |  Score: 90.88 [%]  |  Seq Length: 256.0
[2024-09-26 19:56:53,350][root][INFO] - Step: 390/1350  |  Loss: 0.7825  |  Score: 77.97 [%]  |  Seq Length: 256.0
[2024-09-26 19:56:57,316][root][INFO] - Step: 1125/1350  |  Loss: 0.3537  |  Score: 89.27 [%]  |  Seq Length: 256.0
[2024-09-26 19:56:59,082][root][INFO] - Step: 405/1350  |  Loss: 0.8417  |  Score: 76.86 [%]  |  Seq Length: 256.0
[2024-09-26 19:57:02,889][root][INFO] - Step: 1140/1350  |  Loss: 0.3080  |  Score: 90.31 [%]  |  Seq Length: 256.0
[2024-09-26 19:57:04,814][root][INFO] - Step: 420/1350  |  Loss: 0.8551  |  Score: 75.67 [%]  |  Seq Length: 256.0
[2024-09-26 19:57:08,546][root][INFO] - Step: 1155/1350  |  Loss: 0.2965  |  Score: 90.99 [%]  |  Seq Length: 256.0
[2024-09-26 19:57:10,541][root][INFO] - Step: 435/1350  |  Loss: 0.8307  |  Score: 77.50 [%]  |  Seq Length: 256.0
[2024-09-26 19:57:14,196][root][INFO] - Step: 1170/1350  |  Loss: 0.3594  |  Score: 88.51 [%]  |  Seq Length: 256.0
[2024-09-26 19:57:16,321][root][INFO] - Step: 450/1350  |  Loss: 0.7798  |  Score: 77.93 [%]  |  Seq Length: 256.0
[2024-09-26 19:57:17,994][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 19:57:17,994][root][INFO] - Score: 79.24 [%]  |  Evaluation Time: 3.79 [s]
[2024-09-26 19:57:20,299][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 19:57:20,299][root][INFO] - Score: 78.86 [%]  |  Evaluation Time: 3.97 [s]
[2024-09-26 19:57:21,573][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 19:57:21,574][root][INFO] - Score: 71.17 [%]  |  Evaluation Time: 3.58 [s]
[2024-09-26 19:57:21,576][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 19:57:22,338][root][INFO] - Step: 1171/1350  |  Loss: 0.4284  |  Score: 82.46 [%]  |  Seq Length: 256.0
[2024-09-26 19:57:23,999][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 19:57:23,999][root][INFO] - Score: 71.33 [%]  |  Evaluation Time: 3.70 [s]
[2024-09-26 19:57:24,000][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 19:57:24,001][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 19:57:24,733][root][INFO] - Step: 451/1350  |  Loss: 0.8821  |  Score: 74.11 [%]  |  Seq Length: 256.0
[2024-09-26 19:57:27,549][root][INFO] - Step: 1185/1350  |  Loss: 0.3370  |  Score: 90.64 [%]  |  Seq Length: 256.0
[2024-09-26 19:57:30,079][root][INFO] - Step: 465/1350  |  Loss: 0.6338  |  Score: 79.91 [%]  |  Seq Length: 256.0
[2024-09-26 19:57:33,126][root][INFO] - Step: 1200/1350  |  Loss: 0.3277  |  Score: 89.61 [%]  |  Seq Length: 256.0
[2024-09-26 19:57:35,806][root][INFO] - Step: 480/1350  |  Loss: 0.6290  |  Score: 81.42 [%]  |  Seq Length: 256.0
[2024-09-26 19:57:38,706][root][INFO] - Step: 1215/1350  |  Loss: 0.3034  |  Score: 91.80 [%]  |  Seq Length: 256.0
[2024-09-26 19:57:41,530][root][INFO] - Step: 495/1350  |  Loss: 0.7053  |  Score: 81.18 [%]  |  Seq Length: 256.0
[2024-09-26 19:57:44,326][root][INFO] - Step: 1230/1350  |  Loss: 0.3232  |  Score: 89.83 [%]  |  Seq Length: 256.0
[2024-09-26 19:57:47,255][root][INFO] - Step: 510/1350  |  Loss: 0.7619  |  Score: 80.87 [%]  |  Seq Length: 256.0
[2024-09-26 19:57:49,949][root][INFO] - Step: 1245/1350  |  Loss: 0.3235  |  Score: 88.75 [%]  |  Seq Length: 256.0
[2024-09-26 19:57:52,984][root][INFO] - Step: 525/1350  |  Loss: 0.7196  |  Score: 83.31 [%]  |  Seq Length: 256.0
[2024-09-26 19:57:55,609][root][INFO] - Step: 1260/1350  |  Loss: 0.3280  |  Score: 91.58 [%]  |  Seq Length: 256.0
[2024-09-26 19:57:58,749][root][INFO] - Step: 540/1350  |  Loss: 0.6525  |  Score: 81.89 [%]  |  Seq Length: 256.0
[2024-09-26 19:57:59,472][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 19:57:59,472][root][INFO] - Score: 78.63 [%]  |  Evaluation Time: 3.86 [s]
[2024-09-26 19:58:02,720][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 19:58:02,720][root][INFO] - Score: 78.28 [%]  |  Evaluation Time: 3.97 [s]
[2024-09-26 19:58:03,079][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 19:58:03,079][root][INFO] - Score: 70.63 [%]  |  Evaluation Time: 3.60 [s]
[2024-09-26 19:58:03,081][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 19:58:03,770][root][INFO] - Step: 1261/1350  |  Loss: 0.2411  |  Score: 93.59 [%]  |  Seq Length: 256.0
[2024-09-26 19:58:06,498][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 19:58:06,498][root][INFO] - Score: 71.41 [%]  |  Evaluation Time: 3.78 [s]
[2024-09-26 19:58:06,500][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 19:58:07,244][root][INFO] - Step: 541/1350  |  Loss: 0.5802  |  Score: 83.04 [%]  |  Seq Length: 256.0
[2024-09-26 19:58:08,974][root][INFO] - Step: 1275/1350  |  Loss: 0.3199  |  Score: 90.89 [%]  |  Seq Length: 256.0
[2024-09-26 19:58:12,592][root][INFO] - Step: 555/1350  |  Loss: 0.5655  |  Score: 84.24 [%]  |  Seq Length: 256.0
[2024-09-26 19:58:14,546][root][INFO] - Step: 1290/1350  |  Loss: 0.3214  |  Score: 90.37 [%]  |  Seq Length: 256.0
[2024-09-26 19:58:18,320][root][INFO] - Step: 570/1350  |  Loss: 0.5765  |  Score: 83.72 [%]  |  Seq Length: 256.0
[2024-09-26 19:58:20,136][root][INFO] - Step: 1305/1350  |  Loss: 0.3169  |  Score: 90.24 [%]  |  Seq Length: 256.0
[2024-09-26 19:58:24,045][root][INFO] - Step: 585/1350  |  Loss: 0.5969  |  Score: 82.43 [%]  |  Seq Length: 256.0
[2024-09-26 19:58:25,754][root][INFO] - Step: 1320/1350  |  Loss: 0.3018  |  Score: 91.15 [%]  |  Seq Length: 256.0
[2024-09-26 19:58:29,768][root][INFO] - Step: 600/1350  |  Loss: 0.5876  |  Score: 81.74 [%]  |  Seq Length: 256.0
[2024-09-26 19:58:31,370][root][INFO] - Step: 1335/1350  |  Loss: 0.3285  |  Score: 90.23 [%]  |  Seq Length: 256.0
[2024-09-26 19:58:35,498][root][INFO] - Step: 615/1350  |  Loss: 0.5642  |  Score: 82.79 [%]  |  Seq Length: 256.0
[2024-09-26 19:58:37,007][root][INFO] - Step: 1350/1350  |  Loss: 0.3202  |  Score: 90.68 [%]  |  Seq Length: 256.0
[2024-09-26 19:58:40,946][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 19:58:40,947][root][INFO] - Score: 78.21 [%]  |  Evaluation Time: 3.94 [s]
[2024-09-26 19:58:41,299][root][INFO] - Step: 630/1350  |  Loss: 0.5764  |  Score: 81.93 [%]  |  Seq Length: 256.0
[2024-09-26 19:58:44,647][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 19:58:44,647][root][INFO] - Score: 71.54 [%]  |  Evaluation Time: 3.70 [s]
[2024-09-26 19:58:44,648][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 19:58:44,648][root][INFO] - - Epoch: 11
[2024-09-26 19:58:44,648][root][INFO] - - DEV score: 79.10 [%]
[2024-09-26 19:58:44,648][root][INFO] - - TEST score: 71.55 [%]
[2024-09-26 19:58:44,649][root][INFO] - Fine-tuning is done!
[2024-09-26 19:58:45,193][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 19:58:45,193][root][INFO] - Score: 77.47 [%]  |  Evaluation Time: 3.89 [s]
[2024-09-26 19:58:48,903][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 19:58:48,903][root][INFO] - Score: 73.22 [%]  |  Evaluation Time: 3.71 [s]
[2024-09-26 19:58:48,904][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-26 19:58:48,906][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 19:58:49,743][root][INFO] - Step: 631/1350  |  Loss: 0.4020  |  Score: 89.86 [%]  |  Seq Length: 256.0
[2024-09-26 19:58:51,023][root][INFO] - 

[2024-09-26 19:58:51,024][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 19:58:51,024][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:58:51,024][root][INFO] - 

[2024-09-26 19:58:51,024][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_punc', 'do_hangeulize': False, 'data_remove': False, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 19:58:55,092][root][INFO] - Step: 645/1350  |  Loss: 0.4674  |  Score: 86.64 [%]  |  Seq Length: 256.0
[2024-09-26 19:58:55,842][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 19:58:55,843][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 19:58:55,843][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 19:58:55,844][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 19:58:55,844][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 19:58:55,845][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 19:58:55,845][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 19:58:55,845][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 19:58:55,846][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 19:58:55,846][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 19:58:55,847][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 19:58:55,847][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 19:58:55,848][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 19:58:55,848][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 19:58:55,848][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 19:58:55,849][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 19:58:55,849][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 19:58:55,850][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 19:58:55,850][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 19:58:55,851][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 19:58:55,859][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 19:58:55,859][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 19:58:55,859][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 19:58:55,860][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 19:58:55,861][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 19:58:55,866][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-26 19:58:55,972][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-26 19:58:55,974][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-26 19:58:56,289][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 19:59:00,825][root][INFO] - Step: 660/1350  |  Loss: 0.5251  |  Score: 84.34 [%]  |  Seq Length: 256.0
[2024-09-26 19:59:03,679][root][INFO] - 

[2024-09-26 19:59:03,680][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 19:59:03,680][root][INFO] - Data Preprocessing
[2024-09-26 19:59:03,681][root][INFO] - ㄴ remain_lang                ko_punc
[2024-09-26 19:59:03,681][root][INFO] - ㄴ do_hangeulize              False
[2024-09-26 19:59:03,681][root][INFO] - ㄴ data_remove                False

[2024-09-26 19:59:03,682][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 19:59:03,700][root][INFO] - vocab size              : 51200
[2024-09-26 19:59:03,700][root][INFO] - device                  : gpu
[2024-09-26 19:59:03,700][root][INFO] - random seed             : 42
[2024-09-26 19:59:03,700][root][INFO] - train data size         : 5760
[2024-09-26 19:59:03,701][root][INFO] - max epochs              : 15
[2024-09-26 19:59:03,701][root][INFO] - total steps             : 1350
[2024-09-26 19:59:03,701][root][INFO] - warmup steps            : 135
[2024-09-26 19:59:03,701][root][INFO] - batch size              : 64
[2024-09-26 19:59:03,701][root][INFO] - accumulation steps      : 1
[2024-09-26 19:59:03,701][root][INFO] - optimizer               : adamwscale
[2024-09-26 19:59:03,701][root][INFO] - lr_scheduler            : cosine
[2024-09-26 19:59:03,702][root][INFO] - learning rate           : 0.01
[2024-09-26 19:59:03,702][root][INFO] - max length              : 256

[2024-09-26 19:59:03,702][root][INFO] - LoRA Configuration
[2024-09-26 19:59:03,702][root][INFO] - ㄴ r                    : 32
[2024-09-26 19:59:03,702][root][INFO] - ㄴ alpha                : 128
[2024-09-26 19:59:03,702][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 19:59:03,702][root][INFO] - KOMBO Configuration
[2024-09-26 19:59:03,703][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-26 19:59:03,703][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-26 19:59:03,703][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-26 19:59:03,703][root][INFO] - ㄴ do_combination       : True
[2024-09-26 19:59:03,703][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-26 19:59:03,704][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-26 19:59:03,704][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-26 19:59:03,704][root][INFO] -   ㄴ add_lora           : True

[2024-09-26 19:59:03,704][root][INFO] - LoRA in KOMBO Configuration
[2024-09-26 19:59:03,704][root][INFO] - ㄴ r                : 32
[2024-09-26 19:59:03,704][root][INFO] - ㄴ alpha            : 128
[2024-09-26 19:59:03,705][root][INFO] - ㄴ dropout          : 0.03

[2024-09-26 19:59:03,705][root][INFO] - 

[2024-09-26 19:59:03,705][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 19:59:03,705][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 19:59:03,705][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 19:59:03,705][root][INFO] - * tb interval   : 15

[2024-09-26 19:59:03,705][root][INFO] - 

[2024-09-26 19:59:03,705][root][INFO] - Start the Training !
[2024-09-26 19:59:03,710][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 19:59:06,585][root][INFO] - Step: 675/1350  |  Loss: 0.5242  |  Score: 86.40 [%]  |  Seq Length: 256.0
[2024-09-26 19:59:12,314][root][INFO] - Step: 690/1350  |  Loss: 0.5295  |  Score: 84.39 [%]  |  Seq Length: 256.0
[2024-09-26 19:59:13,639][root][INFO] - Step: 15/1350  |  Loss: 3.3191  |  Score: 6.00 [%]  |  Seq Length: 256.0
[2024-09-26 19:59:18,044][root][INFO] - Step: 705/1350  |  Loss: 0.5096  |  Score: 84.69 [%]  |  Seq Length: 256.0
[2024-09-26 19:59:21,568][root][INFO] - Step: 30/1350  |  Loss: 2.1255  |  Score: 24.65 [%]  |  Seq Length: 256.0
[2024-09-26 19:59:23,804][root][INFO] - Step: 720/1350  |  Loss: 0.5151  |  Score: 85.61 [%]  |  Seq Length: 256.0
[2024-09-26 19:59:27,662][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 19:59:27,662][root][INFO] - Score: 77.96 [%]  |  Evaluation Time: 3.85 [s]
[2024-09-26 19:59:29,490][root][INFO] - Step: 45/1350  |  Loss: 2.0225  |  Score: 30.50 [%]  |  Seq Length: 256.0
[2024-09-26 19:59:31,271][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 19:59:31,271][root][INFO] - Score: 71.47 [%]  |  Evaluation Time: 3.61 [s]
[2024-09-26 19:59:31,273][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 19:59:32,026][root][INFO] - Step: 721/1350  |  Loss: 0.4444  |  Score: 88.05 [%]  |  Seq Length: 256.0
[2024-09-26 19:59:37,369][root][INFO] - Step: 735/1350  |  Loss: 0.4606  |  Score: 85.15 [%]  |  Seq Length: 256.0
[2024-09-26 19:59:37,493][root][INFO] - Step: 60/1350  |  Loss: 1.6694  |  Score: 48.11 [%]  |  Seq Length: 256.0
[2024-09-26 19:59:43,112][root][INFO] - Step: 750/1350  |  Loss: 0.4545  |  Score: 86.68 [%]  |  Seq Length: 256.0
[2024-09-26 19:59:45,621][root][INFO] - Step: 75/1350  |  Loss: 1.6414  |  Score: 50.80 [%]  |  Seq Length: 256.0
[2024-09-26 19:59:48,854][root][INFO] - Step: 765/1350  |  Loss: 0.4734  |  Score: 86.52 [%]  |  Seq Length: 256.0
[2024-09-26 19:59:53,641][root][INFO] - Step: 90/1350  |  Loss: 1.3530  |  Score: 61.34 [%]  |  Seq Length: 256.0
[2024-09-26 19:59:54,595][root][INFO] - Step: 780/1350  |  Loss: 0.4303  |  Score: 87.36 [%]  |  Seq Length: 256.0
[2024-09-26 20:00:00,192][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 20:00:00,193][root][INFO] - Score: 73.00 [%]  |  Evaluation Time: 6.55 [s]
[2024-09-26 20:00:00,324][root][INFO] - Step: 795/1350  |  Loss: 0.4208  |  Score: 87.73 [%]  |  Seq Length: 256.0
[2024-09-26 20:00:06,036][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 20:00:06,036][root][INFO] - Score: 65.43 [%]  |  Evaluation Time: 5.84 [s]
[2024-09-26 20:00:06,038][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 20:00:06,039][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 20:00:06,099][root][INFO] - Step: 810/1350  |  Loss: 0.4520  |  Score: 87.88 [%]  |  Seq Length: 256.0
[2024-09-26 20:00:07,052][root][INFO] - Step: 91/1350  |  Loss: 1.2007  |  Score: 66.82 [%]  |  Seq Length: 256.0
[2024-09-26 20:00:10,078][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 20:00:10,079][root][INFO] - Score: 77.79 [%]  |  Evaluation Time: 3.97 [s]
[2024-09-26 20:00:13,785][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 20:00:13,785][root][INFO] - Score: 71.10 [%]  |  Evaluation Time: 3.70 [s]
[2024-09-26 20:00:13,787][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 20:00:14,436][root][INFO] - Step: 105/1350  |  Loss: 1.2557  |  Score: 60.14 [%]  |  Seq Length: 256.0
[2024-09-26 20:00:14,568][root][INFO] - Step: 811/1350  |  Loss: 0.3856  |  Score: 90.89 [%]  |  Seq Length: 256.0
[2024-09-26 20:00:19,916][root][INFO] - Step: 825/1350  |  Loss: 0.3717  |  Score: 88.73 [%]  |  Seq Length: 256.0
[2024-09-26 20:00:22,465][root][INFO] - Step: 120/1350  |  Loss: 1.1452  |  Score: 66.75 [%]  |  Seq Length: 256.0
[2024-09-26 20:00:25,646][root][INFO] - Step: 840/1350  |  Loss: 0.3987  |  Score: 88.08 [%]  |  Seq Length: 256.0
[2024-09-26 20:00:30,480][root][INFO] - Step: 135/1350  |  Loss: 1.2420  |  Score: 67.24 [%]  |  Seq Length: 256.0
[2024-09-26 20:00:31,404][root][INFO] - Step: 855/1350  |  Loss: 0.3930  |  Score: 88.68 [%]  |  Seq Length: 256.0
[2024-09-26 20:00:37,146][root][INFO] - Step: 870/1350  |  Loss: 0.4455  |  Score: 88.67 [%]  |  Seq Length: 256.0
[2024-09-26 20:00:38,498][root][INFO] - Step: 150/1350  |  Loss: 1.2823  |  Score: 61.97 [%]  |  Seq Length: 256.0
[2024-09-26 20:00:42,883][root][INFO] - Step: 885/1350  |  Loss: 0.3851  |  Score: 88.61 [%]  |  Seq Length: 256.0
[2024-09-26 20:00:46,447][root][INFO] - Step: 165/1350  |  Loss: 1.1282  |  Score: 66.70 [%]  |  Seq Length: 256.0
[2024-09-26 20:00:48,711][root][INFO] - Step: 900/1350  |  Loss: 0.4084  |  Score: 88.45 [%]  |  Seq Length: 256.0
[2024-09-26 20:00:52,664][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 20:00:52,665][root][INFO] - Score: 77.83 [%]  |  Evaluation Time: 3.95 [s]
[2024-09-26 20:00:54,449][root][INFO] - Step: 180/1350  |  Loss: 1.1777  |  Score: 67.60 [%]  |  Seq Length: 256.0
[2024-09-26 20:00:56,363][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 20:00:56,363][root][INFO] - Score: 71.05 [%]  |  Evaluation Time: 3.70 [s]
[2024-09-26 20:00:56,366][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 20:00:57,092][root][INFO] - Step: 901/1350  |  Loss: 0.3986  |  Score: 87.16 [%]  |  Seq Length: 256.0
[2024-09-26 20:01:00,898][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 20:01:00,898][root][INFO] - Score: 75.57 [%]  |  Evaluation Time: 6.45 [s]
[2024-09-26 20:01:02,448][root][INFO] - Step: 915/1350  |  Loss: 0.3472  |  Score: 90.67 [%]  |  Seq Length: 256.0
[2024-09-26 20:01:06,652][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 20:01:06,652][root][INFO] - Score: 69.98 [%]  |  Evaluation Time: 5.75 [s]
[2024-09-26 20:01:06,654][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 20:01:06,655][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 20:01:07,599][root][INFO] - Step: 181/1350  |  Loss: 0.9774  |  Score: 78.68 [%]  |  Seq Length: 256.0
[2024-09-26 20:01:08,195][root][INFO] - Step: 930/1350  |  Loss: 0.3773  |  Score: 88.48 [%]  |  Seq Length: 256.0
[2024-09-26 20:01:13,936][root][INFO] - Step: 945/1350  |  Loss: 0.3346  |  Score: 90.17 [%]  |  Seq Length: 256.0
[2024-09-26 20:01:14,949][root][INFO] - Step: 195/1350  |  Loss: 0.9672  |  Score: 71.70 [%]  |  Seq Length: 256.0
[2024-09-26 20:01:19,670][root][INFO] - Step: 960/1350  |  Loss: 0.3868  |  Score: 89.34 [%]  |  Seq Length: 256.0
[2024-09-26 20:01:22,879][root][INFO] - Step: 210/1350  |  Loss: 1.0994  |  Score: 70.49 [%]  |  Seq Length: 256.0
[2024-09-26 20:01:25,400][root][INFO] - Step: 975/1350  |  Loss: 0.3918  |  Score: 88.49 [%]  |  Seq Length: 256.0
[2024-09-26 20:01:30,769][root][INFO] - Step: 225/1350  |  Loss: 1.0821  |  Score: 69.22 [%]  |  Seq Length: 256.0
[2024-09-26 20:01:31,175][root][INFO] - Step: 990/1350  |  Loss: 0.3465  |  Score: 90.24 [%]  |  Seq Length: 256.0
[2024-09-26 20:01:35,205][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 20:01:35,205][root][INFO] - Score: 78.12 [%]  |  Evaluation Time: 4.03 [s]
[2024-09-26 20:01:38,685][root][INFO] - Step: 240/1350  |  Loss: 1.0054  |  Score: 72.32 [%]  |  Seq Length: 256.0
[2024-09-26 20:01:38,909][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 20:01:38,909][root][INFO] - Score: 71.24 [%]  |  Evaluation Time: 3.70 [s]
[2024-09-26 20:01:38,911][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 20:01:39,644][root][INFO] - Step: 991/1350  |  Loss: 0.2297  |  Score: 94.32 [%]  |  Seq Length: 256.0
[2024-09-26 20:01:44,991][root][INFO] - Step: 1005/1350  |  Loss: 0.3514  |  Score: 89.52 [%]  |  Seq Length: 256.0
[2024-09-26 20:01:46,555][root][INFO] - Step: 255/1350  |  Loss: 0.9884  |  Score: 69.02 [%]  |  Seq Length: 256.0
[2024-09-26 20:01:50,721][root][INFO] - Step: 1020/1350  |  Loss: 0.3457  |  Score: 89.72 [%]  |  Seq Length: 256.0
[2024-09-26 20:01:54,624][root][INFO] - Step: 270/1350  |  Loss: 0.9818  |  Score: 71.12 [%]  |  Seq Length: 256.0
[2024-09-26 20:01:56,447][root][INFO] - Step: 1035/1350  |  Loss: 0.3404  |  Score: 89.26 [%]  |  Seq Length: 256.0
[2024-09-26 20:02:00,998][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 20:02:00,999][root][INFO] - Score: 77.45 [%]  |  Evaluation Time: 6.37 [s]
[2024-09-26 20:02:02,181][root][INFO] - Step: 1050/1350  |  Loss: 0.3467  |  Score: 89.71 [%]  |  Seq Length: 256.0
[2024-09-26 20:02:06,852][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 20:02:06,852][root][INFO] - Score: 70.63 [%]  |  Evaluation Time: 5.85 [s]
[2024-09-26 20:02:06,853][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 20:02:06,855][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 20:02:07,908][root][INFO] - Step: 1065/1350  |  Loss: 0.3361  |  Score: 90.25 [%]  |  Seq Length: 256.0
[2024-09-26 20:02:07,926][root][INFO] - Step: 271/1350  |  Loss: 0.8958  |  Score: 76.94 [%]  |  Seq Length: 256.0
[2024-09-26 20:02:13,680][root][INFO] - Step: 1080/1350  |  Loss: 0.3220  |  Score: 90.43 [%]  |  Seq Length: 256.0
[2024-09-26 20:02:15,428][root][INFO] - Step: 285/1350  |  Loss: 0.8819  |  Score: 77.06 [%]  |  Seq Length: 256.0
[2024-09-26 20:02:17,591][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 20:02:17,592][root][INFO] - Score: 78.50 [%]  |  Evaluation Time: 3.91 [s]
[2024-09-26 20:02:21,200][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 20:02:21,200][root][INFO] - Score: 70.61 [%]  |  Evaluation Time: 3.61 [s]
[2024-09-26 20:02:21,203][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 20:02:22,128][root][INFO] - Step: 1081/1350  |  Loss: 0.3188  |  Score: 91.21 [%]  |  Seq Length: 256.0
[2024-09-26 20:02:23,357][root][INFO] - Step: 300/1350  |  Loss: 1.1605  |  Score: 73.52 [%]  |  Seq Length: 256.0
[2024-09-26 20:02:27,478][root][INFO] - Step: 1095/1350  |  Loss: 0.3191  |  Score: 91.07 [%]  |  Seq Length: 256.0
[2024-09-26 20:02:31,326][root][INFO] - Step: 315/1350  |  Loss: 0.9402  |  Score: 74.66 [%]  |  Seq Length: 256.0
[2024-09-26 20:02:33,209][root][INFO] - Step: 1110/1350  |  Loss: 0.3384  |  Score: 91.19 [%]  |  Seq Length: 256.0
[2024-09-26 20:02:38,935][root][INFO] - Step: 1125/1350  |  Loss: 0.3291  |  Score: 89.56 [%]  |  Seq Length: 256.0
[2024-09-26 20:02:39,362][root][INFO] - Step: 330/1350  |  Loss: 0.9329  |  Score: 74.09 [%]  |  Seq Length: 256.0
[2024-09-26 20:02:44,671][root][INFO] - Step: 1140/1350  |  Loss: 0.3071  |  Score: 90.76 [%]  |  Seq Length: 256.0
[2024-09-26 20:02:47,350][root][INFO] - Step: 345/1350  |  Loss: 0.8104  |  Score: 77.70 [%]  |  Seq Length: 256.0
[2024-09-26 20:02:50,448][root][INFO] - Step: 1155/1350  |  Loss: 0.3247  |  Score: 90.36 [%]  |  Seq Length: 256.0
[2024-09-26 20:02:55,317][root][INFO] - Step: 360/1350  |  Loss: 0.8821  |  Score: 75.06 [%]  |  Seq Length: 256.0
[2024-09-26 20:02:56,216][root][INFO] - Step: 1170/1350  |  Loss: 0.3144  |  Score: 89.98 [%]  |  Seq Length: 256.0
[2024-09-26 20:03:00,080][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 20:03:00,080][root][INFO] - Score: 78.52 [%]  |  Evaluation Time: 3.86 [s]
[2024-09-26 20:03:01,756][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 20:03:01,757][root][INFO] - Score: 75.32 [%]  |  Evaluation Time: 6.44 [s]
[2024-09-26 20:03:03,756][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 20:03:03,756][root][INFO] - Score: 71.34 [%]  |  Evaluation Time: 3.67 [s]
[2024-09-26 20:03:03,758][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 20:03:04,483][root][INFO] - Step: 1171/1350  |  Loss: 0.4294  |  Score: 81.39 [%]  |  Seq Length: 256.0
[2024-09-26 20:03:07,474][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 20:03:07,475][root][INFO] - Score: 70.45 [%]  |  Evaluation Time: 5.72 [s]
[2024-09-26 20:03:07,477][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 20:03:08,515][root][INFO] - Step: 361/1350  |  Loss: 0.7386  |  Score: 77.66 [%]  |  Seq Length: 256.0
[2024-09-26 20:03:09,830][root][INFO] - Step: 1185/1350  |  Loss: 0.3555  |  Score: 90.09 [%]  |  Seq Length: 256.0
[2024-09-26 20:03:15,559][root][INFO] - Step: 1200/1350  |  Loss: 0.3026  |  Score: 90.39 [%]  |  Seq Length: 256.0
[2024-09-26 20:03:15,857][root][INFO] - Step: 375/1350  |  Loss: 0.7559  |  Score: 79.91 [%]  |  Seq Length: 256.0
[2024-09-26 20:03:21,289][root][INFO] - Step: 1215/1350  |  Loss: 0.2878  |  Score: 91.99 [%]  |  Seq Length: 256.0
[2024-09-26 20:03:23,742][root][INFO] - Step: 390/1350  |  Loss: 0.8460  |  Score: 74.78 [%]  |  Seq Length: 256.0
[2024-09-26 20:03:27,016][root][INFO] - Step: 1230/1350  |  Loss: 0.2959  |  Score: 90.72 [%]  |  Seq Length: 256.0
[2024-09-26 20:03:31,626][root][INFO] - Step: 405/1350  |  Loss: 0.7934  |  Score: 78.25 [%]  |  Seq Length: 256.0
[2024-09-26 20:03:32,745][root][INFO] - Step: 1245/1350  |  Loss: 0.3196  |  Score: 89.54 [%]  |  Seq Length: 256.0
[2024-09-26 20:03:38,513][root][INFO] - Step: 1260/1350  |  Loss: 0.3229  |  Score: 91.44 [%]  |  Seq Length: 256.0
[2024-09-26 20:03:39,561][root][INFO] - Step: 420/1350  |  Loss: 0.7239  |  Score: 78.49 [%]  |  Seq Length: 256.0
[2024-09-26 20:03:42,406][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 20:03:42,407][root][INFO] - Score: 77.98 [%]  |  Evaluation Time: 3.89 [s]
[2024-09-26 20:03:46,019][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 20:03:46,020][root][INFO] - Score: 70.51 [%]  |  Evaluation Time: 3.61 [s]
[2024-09-26 20:03:46,022][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 20:03:46,942][root][INFO] - Step: 1261/1350  |  Loss: 0.3429  |  Score: 88.95 [%]  |  Seq Length: 256.0
[2024-09-26 20:03:47,448][root][INFO] - Step: 435/1350  |  Loss: 0.7172  |  Score: 78.88 [%]  |  Seq Length: 256.0
[2024-09-26 20:03:52,339][root][INFO] - Step: 1275/1350  |  Loss: 0.3249  |  Score: 90.79 [%]  |  Seq Length: 256.0
[2024-09-26 20:03:55,323][root][INFO] - Step: 450/1350  |  Loss: 0.7617  |  Score: 75.93 [%]  |  Seq Length: 256.0
[2024-09-26 20:03:58,083][root][INFO] - Step: 1290/1350  |  Loss: 0.3014  |  Score: 91.29 [%]  |  Seq Length: 256.0
[2024-09-26 20:04:01,560][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 20:04:01,560][root][INFO] - Score: 79.37 [%]  |  Evaluation Time: 6.23 [s]
[2024-09-26 20:04:03,818][root][INFO] - Step: 1305/1350  |  Loss: 0.3177  |  Score: 89.88 [%]  |  Seq Length: 256.0
[2024-09-26 20:04:07,210][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 20:04:07,211][root][INFO] - Score: 73.20 [%]  |  Evaluation Time: 5.65 [s]
[2024-09-26 20:04:07,212][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 20:04:07,215][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 20:04:08,130][root][INFO] - Step: 451/1350  |  Loss: 0.7178  |  Score: 84.95 [%]  |  Seq Length: 256.0
[2024-09-26 20:04:09,566][root][INFO] - Step: 1320/1350  |  Loss: 0.3112  |  Score: 90.72 [%]  |  Seq Length: 256.0
[2024-09-26 20:04:15,306][root][INFO] - Step: 1335/1350  |  Loss: 0.3130  |  Score: 91.07 [%]  |  Seq Length: 256.0
[2024-09-26 20:04:15,571][root][INFO] - Step: 465/1350  |  Loss: 0.6248  |  Score: 81.17 [%]  |  Seq Length: 256.0
[2024-09-26 20:04:21,082][root][INFO] - Step: 1350/1350  |  Loss: 0.3026  |  Score: 90.23 [%]  |  Seq Length: 256.0
[2024-09-26 20:04:23,460][root][INFO] - Step: 480/1350  |  Loss: 0.7290  |  Score: 81.74 [%]  |  Seq Length: 256.0
[2024-09-26 20:04:24,954][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 20:04:24,954][root][INFO] - Score: 77.92 [%]  |  Evaluation Time: 3.87 [s]
[2024-09-26 20:04:28,595][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 20:04:28,596][root][INFO] - Score: 71.44 [%]  |  Evaluation Time: 3.64 [s]
[2024-09-26 20:04:28,598][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 20:04:28,598][root][INFO] - - Epoch: 7
[2024-09-26 20:04:28,598][root][INFO] - - DEV score: 77.47 [%]
[2024-09-26 20:04:28,598][root][INFO] - - TEST score: 73.22 [%]
[2024-09-26 20:04:28,600][root][INFO] - Fine-tuning is done!
[2024-09-26 20:04:31,375][root][INFO] - Step: 495/1350  |  Loss: 0.6703  |  Score: 81.83 [%]  |  Seq Length: 256.0
[2024-09-26 20:04:34,858][root][INFO] - 

[2024-09-26 20:04:34,858][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 20:04:34,858][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 20:04:34,858][root][INFO] - 

[2024-09-26 20:04:34,858][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': False, 'data_remove': False, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 20:04:39,249][root][INFO] - Step: 510/1350  |  Loss: 0.7126  |  Score: 81.64 [%]  |  Seq Length: 256.0
[2024-09-26 20:04:39,633][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 20:04:39,634][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 20:04:39,634][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 20:04:39,635][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 20:04:39,635][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 20:04:39,636][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 20:04:39,637][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 20:04:39,637][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 20:04:39,638][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 20:04:39,638][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 20:04:39,639][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 20:04:39,639][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 20:04:39,640][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 20:04:39,640][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 20:04:39,641][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 20:04:39,641][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 20:04:39,642][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 20:04:39,642][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 20:04:39,643][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 20:04:39,643][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 20:04:39,644][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 20:04:39,644][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 20:04:39,645][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 20:04:39,645][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 20:04:39,647][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 20:04:39,651][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-26 20:04:39,759][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-26 20:04:39,761][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-26 20:04:39,969][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 20:04:43,101][root][INFO] - 

[2024-09-26 20:04:43,101][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 20:04:43,101][root][INFO] - Data Preprocessing
[2024-09-26 20:04:43,101][root][INFO] - ㄴ remain_lang                ko_en_punc
[2024-09-26 20:04:43,101][root][INFO] - ㄴ do_hangeulize              False
[2024-09-26 20:04:43,101][root][INFO] - ㄴ data_remove                False

[2024-09-26 20:04:43,102][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 20:04:43,110][root][INFO] - vocab size              : 51200
[2024-09-26 20:04:43,110][root][INFO] - device                  : gpu
[2024-09-26 20:04:43,110][root][INFO] - random seed             : 42
[2024-09-26 20:04:43,110][root][INFO] - train data size         : 5760
[2024-09-26 20:04:43,111][root][INFO] - max epochs              : 15
[2024-09-26 20:04:43,111][root][INFO] - total steps             : 1350
[2024-09-26 20:04:43,111][root][INFO] - warmup steps            : 135
[2024-09-26 20:04:43,111][root][INFO] - batch size              : 64
[2024-09-26 20:04:43,111][root][INFO] - accumulation steps      : 1
[2024-09-26 20:04:43,111][root][INFO] - optimizer               : adamwscale
[2024-09-26 20:04:43,111][root][INFO] - lr_scheduler            : cosine
[2024-09-26 20:04:43,111][root][INFO] - learning rate           : 0.01
[2024-09-26 20:04:43,111][root][INFO] - max length              : 256

[2024-09-26 20:04:43,111][root][INFO] - LoRA Configuration
[2024-09-26 20:04:43,111][root][INFO] - ㄴ r                    : 32
[2024-09-26 20:04:43,111][root][INFO] - ㄴ alpha                : 128
[2024-09-26 20:04:43,112][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 20:04:43,112][root][INFO] - KOMBO Configuration
[2024-09-26 20:04:43,112][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-26 20:04:43,112][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-26 20:04:43,112][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-26 20:04:43,112][root][INFO] - ㄴ do_combination       : True
[2024-09-26 20:04:43,112][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-26 20:04:43,112][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-26 20:04:43,112][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-26 20:04:43,112][root][INFO] -   ㄴ add_lora           : True

[2024-09-26 20:04:43,113][root][INFO] - LoRA in KOMBO Configuration
[2024-09-26 20:04:43,113][root][INFO] - ㄴ r                : 32
[2024-09-26 20:04:43,113][root][INFO] - ㄴ alpha            : 128
[2024-09-26 20:04:43,113][root][INFO] - ㄴ dropout          : 0.03

[2024-09-26 20:04:43,113][root][INFO] - 

[2024-09-26 20:04:43,113][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-26 20:04:43,113][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-26 20:04:43,113][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb
[2024-09-26 20:04:43,113][root][INFO] - * tb interval   : 15

[2024-09-26 20:04:43,113][root][INFO] - 

[2024-09-26 20:04:43,113][root][INFO] - Start the Training !
[2024-09-26 20:04:43,117][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 20:04:47,095][root][INFO] - Step: 525/1350  |  Loss: 0.7420  |  Score: 76.53 [%]  |  Seq Length: 256.0
[2024-09-26 20:04:52,050][root][INFO] - Step: 15/1350  |  Loss: 3.3412  |  Score: 6.01 [%]  |  Seq Length: 256.0
[2024-09-26 20:04:55,101][root][INFO] - Step: 540/1350  |  Loss: 0.7360  |  Score: 79.76 [%]  |  Seq Length: 256.0
[2024-09-26 20:05:00,119][root][INFO] - Step: 30/1350  |  Loss: 2.1278  |  Score: 24.22 [%]  |  Seq Length: 256.0
[2024-09-26 20:05:01,460][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 20:05:01,460][root][INFO] - Score: 78.36 [%]  |  Evaluation Time: 6.36 [s]
[2024-09-26 20:05:07,178][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 20:05:07,179][root][INFO] - Score: 71.77 [%]  |  Evaluation Time: 5.72 [s]
[2024-09-26 20:05:07,181][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 20:05:08,115][root][INFO] - Step: 541/1350  |  Loss: 0.5282  |  Score: 87.68 [%]  |  Seq Length: 256.0
[2024-09-26 20:05:08,145][root][INFO] - Step: 45/1350  |  Loss: 1.9708  |  Score: 32.42 [%]  |  Seq Length: 256.0
[2024-09-26 20:05:15,575][root][INFO] - Step: 555/1350  |  Loss: 0.6389  |  Score: 84.60 [%]  |  Seq Length: 256.0
[2024-09-26 20:05:16,389][root][INFO] - Step: 60/1350  |  Loss: 1.6714  |  Score: 49.72 [%]  |  Seq Length: 256.0
[2024-09-26 20:05:23,547][root][INFO] - Step: 570/1350  |  Loss: 0.5790  |  Score: 85.18 [%]  |  Seq Length: 256.0
[2024-09-26 20:05:24,426][root][INFO] - Step: 75/1350  |  Loss: 1.5964  |  Score: 52.34 [%]  |  Seq Length: 256.0
[2024-09-26 20:05:31,440][root][INFO] - Step: 585/1350  |  Loss: 0.6027  |  Score: 81.98 [%]  |  Seq Length: 256.0
[2024-09-26 20:05:32,535][root][INFO] - Step: 90/1350  |  Loss: 1.3066  |  Score: 63.45 [%]  |  Seq Length: 256.0
[2024-09-26 20:05:39,038][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 20:05:39,038][root][INFO] - Score: 74.23 [%]  |  Evaluation Time: 6.50 [s]
[2024-09-26 20:05:39,355][root][INFO] - Step: 600/1350  |  Loss: 0.5296  |  Score: 83.67 [%]  |  Seq Length: 256.0
[2024-09-26 20:05:44,826][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 20:05:44,826][root][INFO] - Score: 66.67 [%]  |  Evaluation Time: 5.79 [s]
[2024-09-26 20:05:44,827][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 20:05:44,829][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 20:05:45,761][root][INFO] - Step: 91/1350  |  Loss: 1.3650  |  Score: 61.05 [%]  |  Seq Length: 256.0
[2024-09-26 20:05:47,203][root][INFO] - Step: 615/1350  |  Loss: 0.5716  |  Score: 82.71 [%]  |  Seq Length: 256.0
[2024-09-26 20:05:53,265][root][INFO] - Step: 105/1350  |  Loss: 1.2646  |  Score: 61.34 [%]  |  Seq Length: 256.0
[2024-09-26 20:05:55,102][root][INFO] - Step: 630/1350  |  Loss: 0.6732  |  Score: 79.95 [%]  |  Seq Length: 256.0
[2024-09-26 20:06:01,340][root][INFO] - Step: 120/1350  |  Loss: 1.1955  |  Score: 64.20 [%]  |  Seq Length: 256.0
[2024-09-26 20:06:01,461][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 20:06:01,461][root][INFO] - Score: 79.28 [%]  |  Evaluation Time: 6.36 [s]
[2024-09-26 20:06:07,283][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 20:06:07,283][root][INFO] - Score: 72.84 [%]  |  Evaluation Time: 5.82 [s]
[2024-09-26 20:06:07,287][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 20:06:08,247][root][INFO] - Step: 631/1350  |  Loss: 0.4452  |  Score: 89.15 [%]  |  Seq Length: 256.0
[2024-09-26 20:06:09,496][root][INFO] - Step: 135/1350  |  Loss: 1.2485  |  Score: 66.12 [%]  |  Seq Length: 256.0
[2024-09-26 20:06:15,619][root][INFO] - Step: 645/1350  |  Loss: 0.5398  |  Score: 84.30 [%]  |  Seq Length: 256.0
[2024-09-26 20:06:17,580][root][INFO] - Step: 150/1350  |  Loss: 1.2558  |  Score: 64.23 [%]  |  Seq Length: 256.0
[2024-09-26 20:06:23,513][root][INFO] - Step: 660/1350  |  Loss: 0.5132  |  Score: 85.80 [%]  |  Seq Length: 256.0
[2024-09-26 20:06:25,699][root][INFO] - Step: 165/1350  |  Loss: 1.0806  |  Score: 67.40 [%]  |  Seq Length: 256.0
[2024-09-26 20:06:31,360][root][INFO] - Step: 675/1350  |  Loss: 0.5167  |  Score: 85.16 [%]  |  Seq Length: 256.0
[2024-09-26 20:06:33,799][root][INFO] - Step: 180/1350  |  Loss: 1.0627  |  Score: 68.62 [%]  |  Seq Length: 256.0
[2024-09-26 20:06:39,232][root][INFO] - Step: 690/1350  |  Loss: 0.5203  |  Score: 84.53 [%]  |  Seq Length: 256.0
[2024-09-26 20:06:40,165][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 20:06:40,165][root][INFO] - Score: 76.58 [%]  |  Evaluation Time: 6.36 [s]
[2024-09-26 20:06:45,922][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 20:06:45,923][root][INFO] - Score: 70.65 [%]  |  Evaluation Time: 5.76 [s]
[2024-09-26 20:06:45,924][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 20:06:45,925][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 20:06:46,872][root][INFO] - Step: 181/1350  |  Loss: 0.9295  |  Score: 77.94 [%]  |  Seq Length: 256.0
[2024-09-26 20:06:47,140][root][INFO] - Step: 705/1350  |  Loss: 0.5551  |  Score: 84.24 [%]  |  Seq Length: 256.0
[2024-09-26 20:06:54,387][root][INFO] - Step: 195/1350  |  Loss: 1.0009  |  Score: 70.31 [%]  |  Seq Length: 256.0
[2024-09-26 20:06:55,033][root][INFO] - Step: 720/1350  |  Loss: 0.5621  |  Score: 85.04 [%]  |  Seq Length: 256.0
[2024-09-26 20:07:01,283][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 20:07:01,283][root][INFO] - Score: 78.44 [%]  |  Evaluation Time: 6.25 [s]
[2024-09-26 20:07:02,485][root][INFO] - Step: 210/1350  |  Loss: 1.0572  |  Score: 70.41 [%]  |  Seq Length: 256.0
[2024-09-26 20:07:06,985][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 20:07:06,985][root][INFO] - Score: 71.49 [%]  |  Evaluation Time: 5.70 [s]
[2024-09-26 20:07:06,988][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 20:07:07,909][root][INFO] - Step: 721/1350  |  Loss: 0.4140  |  Score: 83.87 [%]  |  Seq Length: 256.0
[2024-09-26 20:07:10,633][root][INFO] - Step: 225/1350  |  Loss: 1.0581  |  Score: 68.93 [%]  |  Seq Length: 256.0
[2024-09-26 20:07:15,213][root][INFO] - Step: 735/1350  |  Loss: 0.4799  |  Score: 86.30 [%]  |  Seq Length: 256.0
[2024-09-26 20:07:18,699][root][INFO] - Step: 240/1350  |  Loss: 1.0492  |  Score: 72.12 [%]  |  Seq Length: 256.0
[2024-09-26 20:07:23,103][root][INFO] - Step: 750/1350  |  Loss: 0.4476  |  Score: 86.81 [%]  |  Seq Length: 256.0
[2024-09-26 20:07:26,697][root][INFO] - Step: 255/1350  |  Loss: 1.0824  |  Score: 67.01 [%]  |  Seq Length: 256.0
[2024-09-26 20:07:31,004][root][INFO] - Step: 765/1350  |  Loss: 0.4890  |  Score: 85.28 [%]  |  Seq Length: 256.0
[2024-09-26 20:07:34,849][root][INFO] - Step: 270/1350  |  Loss: 1.0223  |  Score: 69.89 [%]  |  Seq Length: 256.0
[2024-09-26 20:07:38,890][root][INFO] - Step: 780/1350  |  Loss: 0.4827  |  Score: 87.23 [%]  |  Seq Length: 256.0
[2024-09-26 20:07:41,225][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 20:07:41,225][root][INFO] - Score: 78.07 [%]  |  Evaluation Time: 6.37 [s]
[2024-09-26 20:07:46,823][root][INFO] - Step: 795/1350  |  Loss: 0.4471  |  Score: 87.52 [%]  |  Seq Length: 256.0
[2024-09-26 20:07:46,930][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 20:07:46,930][root][INFO] - Score: 70.01 [%]  |  Evaluation Time: 5.70 [s]
[2024-09-26 20:07:46,931][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 20:07:46,932][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 20:07:47,842][root][INFO] - Step: 271/1350  |  Loss: 0.8175  |  Score: 81.18 [%]  |  Seq Length: 256.0
[2024-09-26 20:07:54,880][root][INFO] - Step: 810/1350  |  Loss: 0.4221  |  Score: 88.04 [%]  |  Seq Length: 256.0
[2024-09-26 20:07:55,347][root][INFO] - Step: 285/1350  |  Loss: 0.9050  |  Score: 74.74 [%]  |  Seq Length: 256.0
[2024-09-26 20:08:01,365][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 20:08:01,365][root][INFO] - Score: 77.74 [%]  |  Evaluation Time: 6.48 [s]
[2024-09-26 20:08:03,455][root][INFO] - Step: 300/1350  |  Loss: 1.0608  |  Score: 72.81 [%]  |  Seq Length: 256.0
[2024-09-26 20:08:07,025][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 20:08:07,025][root][INFO] - Score: 70.44 [%]  |  Evaluation Time: 5.66 [s]
[2024-09-26 20:08:07,028][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 20:08:07,967][root][INFO] - Step: 811/1350  |  Loss: 0.3782  |  Score: 90.75 [%]  |  Seq Length: 256.0
[2024-09-26 20:08:11,472][root][INFO] - Step: 315/1350  |  Loss: 0.8417  |  Score: 75.32 [%]  |  Seq Length: 256.0
[2024-09-26 20:08:15,302][root][INFO] - Step: 825/1350  |  Loss: 0.4039  |  Score: 88.64 [%]  |  Seq Length: 256.0
[2024-09-26 20:08:19,598][root][INFO] - Step: 330/1350  |  Loss: 0.8714  |  Score: 76.26 [%]  |  Seq Length: 256.0
[2024-09-26 20:08:23,261][root][INFO] - Step: 840/1350  |  Loss: 0.4367  |  Score: 87.96 [%]  |  Seq Length: 256.0
[2024-09-26 20:08:27,667][root][INFO] - Step: 345/1350  |  Loss: 0.8246  |  Score: 76.67 [%]  |  Seq Length: 256.0
[2024-09-26 20:08:31,111][root][INFO] - Step: 855/1350  |  Loss: 0.4096  |  Score: 88.52 [%]  |  Seq Length: 256.0
[2024-09-26 20:08:35,764][root][INFO] - Step: 360/1350  |  Loss: 0.8583  |  Score: 76.49 [%]  |  Seq Length: 256.0
[2024-09-26 20:08:39,010][root][INFO] - Step: 870/1350  |  Loss: 0.4338  |  Score: 87.62 [%]  |  Seq Length: 256.0
[2024-09-26 20:08:42,059][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 20:08:42,060][root][INFO] - Score: 76.43 [%]  |  Evaluation Time: 6.29 [s]
[2024-09-26 20:08:46,855][root][INFO] - Step: 885/1350  |  Loss: 0.4367  |  Score: 87.73 [%]  |  Seq Length: 256.0
[2024-09-26 20:08:47,791][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 20:08:47,791][root][INFO] - Score: 71.63 [%]  |  Evaluation Time: 5.73 [s]
[2024-09-26 20:08:47,794][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 20:08:48,725][root][INFO] - Step: 361/1350  |  Loss: 0.7329  |  Score: 76.88 [%]  |  Seq Length: 256.0
[2024-09-26 20:08:54,746][root][INFO] - Step: 900/1350  |  Loss: 0.4474  |  Score: 87.74 [%]  |  Seq Length: 256.0
[2024-09-26 20:08:56,223][root][INFO] - Step: 375/1350  |  Loss: 0.7288  |  Score: 80.50 [%]  |  Seq Length: 256.0
[2024-09-26 20:09:00,989][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 20:09:00,989][root][INFO] - Score: 77.50 [%]  |  Evaluation Time: 6.24 [s]
[2024-09-26 20:09:04,273][root][INFO] - Step: 390/1350  |  Loss: 0.8541  |  Score: 72.69 [%]  |  Seq Length: 256.0
[2024-09-26 20:09:06,622][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 20:09:06,622][root][INFO] - Score: 72.11 [%]  |  Evaluation Time: 5.63 [s]
[2024-09-26 20:09:06,624][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 20:09:07,613][root][INFO] - Step: 901/1350  |  Loss: 0.3205  |  Score: 92.90 [%]  |  Seq Length: 256.0
[2024-09-26 20:09:12,249][root][INFO] - Step: 405/1350  |  Loss: 0.7876  |  Score: 77.04 [%]  |  Seq Length: 256.0
[2024-09-26 20:09:15,047][root][INFO] - Step: 915/1350  |  Loss: 0.3992  |  Score: 88.15 [%]  |  Seq Length: 256.0
[2024-09-26 20:09:20,262][root][INFO] - Step: 420/1350  |  Loss: 0.7279  |  Score: 79.82 [%]  |  Seq Length: 256.0
[2024-09-26 20:09:23,041][root][INFO] - Step: 930/1350  |  Loss: 0.3798  |  Score: 88.05 [%]  |  Seq Length: 256.0
[2024-09-26 20:09:28,298][root][INFO] - Step: 435/1350  |  Loss: 0.7737  |  Score: 78.64 [%]  |  Seq Length: 256.0
[2024-09-26 20:09:31,064][root][INFO] - Step: 945/1350  |  Loss: 0.3889  |  Score: 88.19 [%]  |  Seq Length: 256.0
[2024-09-26 20:09:36,336][root][INFO] - Step: 450/1350  |  Loss: 0.7710  |  Score: 74.09 [%]  |  Seq Length: 256.0
[2024-09-26 20:09:39,058][root][INFO] - Step: 960/1350  |  Loss: 0.3588  |  Score: 89.66 [%]  |  Seq Length: 256.0
[2024-09-26 20:09:42,620][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 20:09:42,621][root][INFO] - Score: 77.27 [%]  |  Evaluation Time: 6.28 [s]
[2024-09-26 20:09:46,875][root][INFO] - Step: 975/1350  |  Loss: 0.3866  |  Score: 88.12 [%]  |  Seq Length: 256.0
[2024-09-26 20:09:48,316][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 20:09:48,316][root][INFO] - Score: 71.41 [%]  |  Evaluation Time: 5.69 [s]
[2024-09-26 20:09:48,317][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 20:09:48,319][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 20:09:49,241][root][INFO] - Step: 451/1350  |  Loss: 0.6619  |  Score: 85.85 [%]  |  Seq Length: 256.0
[2024-09-26 20:09:54,788][root][INFO] - Step: 990/1350  |  Loss: 0.3895  |  Score: 88.49 [%]  |  Seq Length: 256.0
[2024-09-26 20:09:56,839][root][INFO] - Step: 465/1350  |  Loss: 0.6233  |  Score: 81.62 [%]  |  Seq Length: 256.0
[2024-09-26 20:10:01,072][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 20:10:01,072][root][INFO] - Score: 78.09 [%]  |  Evaluation Time: 6.28 [s]
[2024-09-26 20:10:04,905][root][INFO] - Step: 480/1350  |  Loss: 0.7651  |  Score: 81.24 [%]  |  Seq Length: 256.0
[2024-09-26 20:10:06,785][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 20:10:06,785][root][INFO] - Score: 71.26 [%]  |  Evaluation Time: 5.71 [s]
[2024-09-26 20:10:06,788][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 20:10:07,771][root][INFO] - Step: 991/1350  |  Loss: 0.3470  |  Score: 90.07 [%]  |  Seq Length: 256.0
[2024-09-26 20:10:12,926][root][INFO] - Step: 495/1350  |  Loss: 0.6647  |  Score: 82.54 [%]  |  Seq Length: 256.0
[2024-09-26 20:10:15,076][root][INFO] - Step: 1005/1350  |  Loss: 0.3361  |  Score: 90.01 [%]  |  Seq Length: 256.0
[2024-09-26 20:10:20,986][root][INFO] - Step: 510/1350  |  Loss: 0.7540  |  Score: 81.54 [%]  |  Seq Length: 256.0
[2024-09-26 20:10:23,092][root][INFO] - Step: 1020/1350  |  Loss: 0.3311  |  Score: 89.84 [%]  |  Seq Length: 256.0
[2024-09-26 20:10:29,000][root][INFO] - Step: 525/1350  |  Loss: 0.6823  |  Score: 78.00 [%]  |  Seq Length: 256.0
[2024-09-26 20:10:31,076][root][INFO] - Step: 1035/1350  |  Loss: 0.3075  |  Score: 91.11 [%]  |  Seq Length: 256.0
[2024-09-26 20:10:37,114][root][INFO] - Step: 540/1350  |  Loss: 0.6103  |  Score: 81.02 [%]  |  Seq Length: 256.0
[2024-09-26 20:10:39,043][root][INFO] - Step: 1050/1350  |  Loss: 0.3391  |  Score: 90.42 [%]  |  Seq Length: 256.0
[2024-09-26 20:10:43,412][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 20:10:43,413][root][INFO] - Score: 77.61 [%]  |  Evaluation Time: 6.29 [s]
[2024-09-26 20:10:46,954][root][INFO] - Step: 1065/1350  |  Loss: 0.3644  |  Score: 89.71 [%]  |  Seq Length: 256.0
[2024-09-26 20:10:49,339][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 20:10:49,339][root][INFO] - Score: 71.88 [%]  |  Evaluation Time: 5.92 [s]
[2024-09-26 20:10:49,341][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 20:10:49,342][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 20:10:50,295][root][INFO] - Step: 541/1350  |  Loss: 0.4848  |  Score: 87.06 [%]  |  Seq Length: 256.0
[2024-09-26 20:10:54,837][root][INFO] - Step: 1080/1350  |  Loss: 0.3397  |  Score: 88.75 [%]  |  Seq Length: 256.0
[2024-09-26 20:10:57,799][root][INFO] - Step: 555/1350  |  Loss: 0.6031  |  Score: 83.27 [%]  |  Seq Length: 256.0
[2024-09-26 20:11:01,072][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 20:11:01,072][root][INFO] - Score: 77.86 [%]  |  Evaluation Time: 6.23 [s]
[2024-09-26 20:11:05,783][root][INFO] - Step: 570/1350  |  Loss: 0.5750  |  Score: 85.78 [%]  |  Seq Length: 256.0
[2024-09-26 20:11:06,742][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 20:11:06,743][root][INFO] - Score: 71.24 [%]  |  Evaluation Time: 5.67 [s]
[2024-09-26 20:11:06,745][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 20:11:07,673][root][INFO] - Step: 1081/1350  |  Loss: 0.3174  |  Score: 91.50 [%]  |  Seq Length: 256.0
[2024-09-26 20:11:13,832][root][INFO] - Step: 585/1350  |  Loss: 0.6013  |  Score: 82.64 [%]  |  Seq Length: 256.0
[2024-09-26 20:11:14,994][root][INFO] - Step: 1095/1350  |  Loss: 0.3290  |  Score: 90.91 [%]  |  Seq Length: 256.0
[2024-09-26 20:11:21,919][root][INFO] - Step: 600/1350  |  Loss: 0.5130  |  Score: 83.68 [%]  |  Seq Length: 256.0
[2024-09-26 20:11:22,828][root][INFO] - Step: 1110/1350  |  Loss: 0.3308  |  Score: 90.12 [%]  |  Seq Length: 256.0
[2024-09-26 20:11:30,118][root][INFO] - Step: 615/1350  |  Loss: 0.5580  |  Score: 84.23 [%]  |  Seq Length: 256.0
[2024-09-26 20:11:30,652][root][INFO] - Step: 1125/1350  |  Loss: 0.3165  |  Score: 91.12 [%]  |  Seq Length: 256.0
[2024-09-26 20:11:38,283][root][INFO] - Step: 630/1350  |  Loss: 0.6403  |  Score: 81.31 [%]  |  Seq Length: 256.0
[2024-09-26 20:11:38,477][root][INFO] - Step: 1140/1350  |  Loss: 0.3264  |  Score: 90.16 [%]  |  Seq Length: 256.0
[2024-09-26 20:11:44,674][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 20:11:44,675][root][INFO] - Score: 78.98 [%]  |  Evaluation Time: 6.39 [s]
[2024-09-26 20:11:46,349][root][INFO] - Step: 1155/1350  |  Loss: 0.3067  |  Score: 91.06 [%]  |  Seq Length: 256.0
[2024-09-26 20:11:50,350][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 20:11:50,350][root][INFO] - Score: 72.81 [%]  |  Evaluation Time: 5.67 [s]
[2024-09-26 20:11:50,352][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-26 20:11:50,353][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 20:11:51,287][root][INFO] - Step: 631/1350  |  Loss: 0.5973  |  Score: 83.34 [%]  |  Seq Length: 256.0
[2024-09-26 20:11:54,282][root][INFO] - Step: 1170/1350  |  Loss: 0.3228  |  Score: 89.85 [%]  |  Seq Length: 256.0
[2024-09-26 20:11:58,773][root][INFO] - Step: 645/1350  |  Loss: 0.4960  |  Score: 84.17 [%]  |  Seq Length: 256.0
[2024-09-26 20:12:00,665][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 20:12:00,665][root][INFO] - Score: 77.18 [%]  |  Evaluation Time: 6.38 [s]
[2024-09-26 20:12:06,314][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 20:12:06,314][root][INFO] - Score: 71.65 [%]  |  Evaluation Time: 5.65 [s]
[2024-09-26 20:12:06,316][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 20:12:06,806][root][INFO] - Step: 660/1350  |  Loss: 0.4756  |  Score: 85.79 [%]  |  Seq Length: 256.0
[2024-09-26 20:12:07,229][root][INFO] - Step: 1171/1350  |  Loss: 0.3813  |  Score: 92.37 [%]  |  Seq Length: 256.0
[2024-09-26 20:12:14,698][root][INFO] - Step: 1185/1350  |  Loss: 0.2950  |  Score: 90.64 [%]  |  Seq Length: 256.0
[2024-09-26 20:12:14,773][root][INFO] - Step: 675/1350  |  Loss: 0.5530  |  Score: 83.60 [%]  |  Seq Length: 256.0
[2024-09-26 20:12:22,686][root][INFO] - Step: 1200/1350  |  Loss: 0.3234  |  Score: 90.41 [%]  |  Seq Length: 256.0
[2024-09-26 20:12:22,778][root][INFO] - Step: 690/1350  |  Loss: 0.5480  |  Score: 83.79 [%]  |  Seq Length: 256.0
[2024-09-26 20:12:30,578][root][INFO] - Step: 1215/1350  |  Loss: 0.3432  |  Score: 90.70 [%]  |  Seq Length: 256.0
[2024-09-26 20:12:30,845][root][INFO] - Step: 705/1350  |  Loss: 0.5294  |  Score: 84.57 [%]  |  Seq Length: 256.0
[2024-09-26 20:12:38,353][root][INFO] - Step: 1230/1350  |  Loss: 0.3131  |  Score: 90.22 [%]  |  Seq Length: 256.0
[2024-09-26 20:12:38,865][root][INFO] - Step: 720/1350  |  Loss: 0.5482  |  Score: 84.12 [%]  |  Seq Length: 256.0
[2024-09-26 20:12:45,293][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 20:12:45,293][root][INFO] - Score: 77.97 [%]  |  Evaluation Time: 6.42 [s]
[2024-09-26 20:12:46,160][root][INFO] - Step: 1245/1350  |  Loss: 0.3016  |  Score: 91.19 [%]  |  Seq Length: 256.0
[2024-09-26 20:12:51,165][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 20:12:51,165][root][INFO] - Score: 71.49 [%]  |  Evaluation Time: 5.87 [s]
[2024-09-26 20:12:51,167][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 20:12:52,106][root][INFO] - Step: 721/1350  |  Loss: 0.5020  |  Score: 84.10 [%]  |  Seq Length: 256.0
[2024-09-26 20:12:54,090][root][INFO] - Step: 1260/1350  |  Loss: 0.3170  |  Score: 90.63 [%]  |  Seq Length: 256.0
[2024-09-26 20:12:59,577][root][INFO] - Step: 735/1350  |  Loss: 0.4700  |  Score: 86.62 [%]  |  Seq Length: 256.0
[2024-09-26 20:13:00,394][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 20:13:00,395][root][INFO] - Score: 78.09 [%]  |  Evaluation Time: 6.30 [s]
[2024-09-26 20:13:06,063][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 20:13:06,063][root][INFO] - Score: 70.91 [%]  |  Evaluation Time: 5.67 [s]
[2024-09-26 20:13:06,065][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 20:13:06,986][root][INFO] - Step: 1261/1350  |  Loss: 0.3459  |  Score: 90.81 [%]  |  Seq Length: 256.0
[2024-09-26 20:13:07,627][root][INFO] - Step: 750/1350  |  Loss: 0.4734  |  Score: 86.07 [%]  |  Seq Length: 256.0
[2024-09-26 20:13:14,288][root][INFO] - Step: 1275/1350  |  Loss: 0.3161  |  Score: 90.14 [%]  |  Seq Length: 256.0
[2024-09-26 20:13:15,637][root][INFO] - Step: 765/1350  |  Loss: 0.4640  |  Score: 86.32 [%]  |  Seq Length: 256.0
[2024-09-26 20:13:22,175][root][INFO] - Step: 1290/1350  |  Loss: 0.3239  |  Score: 90.51 [%]  |  Seq Length: 256.0
[2024-09-26 20:13:23,666][root][INFO] - Step: 780/1350  |  Loss: 0.4410  |  Score: 87.94 [%]  |  Seq Length: 256.0
[2024-09-26 20:13:30,062][root][INFO] - Step: 1305/1350  |  Loss: 0.2913  |  Score: 91.08 [%]  |  Seq Length: 256.0
[2024-09-26 20:13:31,721][root][INFO] - Step: 795/1350  |  Loss: 0.4181  |  Score: 88.09 [%]  |  Seq Length: 256.0
[2024-09-26 20:13:37,938][root][INFO] - Step: 1320/1350  |  Loss: 0.3350  |  Score: 90.19 [%]  |  Seq Length: 256.0
[2024-09-26 20:13:39,787][root][INFO] - Step: 810/1350  |  Loss: 0.4552  |  Score: 86.11 [%]  |  Seq Length: 256.0
[2024-09-26 20:13:45,744][root][INFO] - Step: 1335/1350  |  Loss: 0.3115  |  Score: 90.87 [%]  |  Seq Length: 256.0
[2024-09-26 20:13:46,065][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 20:13:46,065][root][INFO] - Score: 77.04 [%]  |  Evaluation Time: 6.27 [s]
[2024-09-26 20:13:51,766][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 20:13:51,766][root][INFO] - Score: 70.94 [%]  |  Evaluation Time: 5.70 [s]
[2024-09-26 20:13:51,769][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 20:13:52,687][root][INFO] - Step: 811/1350  |  Loss: 0.3240  |  Score: 91.91 [%]  |  Seq Length: 256.0
[2024-09-26 20:13:53,610][root][INFO] - Step: 1350/1350  |  Loss: 0.3398  |  Score: 89.37 [%]  |  Seq Length: 256.0
[2024-09-26 20:13:59,779][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 20:13:59,780][root][INFO] - Score: 78.40 [%]  |  Evaluation Time: 6.17 [s]
[2024-09-26 20:14:00,164][root][INFO] - Step: 825/1350  |  Loss: 0.3910  |  Score: 89.41 [%]  |  Seq Length: 256.0
[2024-09-26 20:14:05,324][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 20:14:05,324][root][INFO] - Score: 70.85 [%]  |  Evaluation Time: 5.54 [s]
[2024-09-26 20:14:05,325][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 20:14:05,325][root][INFO] - - Epoch: 5
[2024-09-26 20:14:05,325][root][INFO] - - DEV score: 79.37 [%]
[2024-09-26 20:14:05,325][root][INFO] - - TEST score: 73.20 [%]
[2024-09-26 20:14:05,326][root][INFO] - Fine-tuning is done!
[2024-09-26 20:14:08,144][root][INFO] - Step: 840/1350  |  Loss: 0.4052  |  Score: 87.90 [%]  |  Seq Length: 256.0
[2024-09-26 20:14:16,093][root][INFO] - Step: 855/1350  |  Loss: 0.4403  |  Score: 87.60 [%]  |  Seq Length: 256.0
[2024-09-26 20:14:24,058][root][INFO] - Step: 870/1350  |  Loss: 0.4060  |  Score: 87.93 [%]  |  Seq Length: 256.0
[2024-09-26 20:14:32,027][root][INFO] - Step: 885/1350  |  Loss: 0.4217  |  Score: 87.72 [%]  |  Seq Length: 256.0
[2024-09-26 20:14:39,998][root][INFO] - Step: 900/1350  |  Loss: 0.4399  |  Score: 86.40 [%]  |  Seq Length: 256.0
[2024-09-26 20:14:46,184][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 20:14:46,185][root][INFO] - Score: 77.51 [%]  |  Evaluation Time: 6.18 [s]
[2024-09-26 20:14:51,764][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 20:14:51,764][root][INFO] - Score: 72.70 [%]  |  Evaluation Time: 5.58 [s]
[2024-09-26 20:14:51,766][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 20:14:52,669][root][INFO] - Step: 901/1350  |  Loss: 0.3015  |  Score: 92.96 [%]  |  Seq Length: 256.0
[2024-09-26 20:15:00,062][root][INFO] - Step: 915/1350  |  Loss: 0.3918  |  Score: 89.09 [%]  |  Seq Length: 256.0
[2024-09-26 20:15:08,016][root][INFO] - Step: 930/1350  |  Loss: 0.3679  |  Score: 88.60 [%]  |  Seq Length: 256.0
[2024-09-26 20:15:15,982][root][INFO] - Step: 945/1350  |  Loss: 0.3582  |  Score: 88.96 [%]  |  Seq Length: 256.0
[2024-09-26 20:15:23,933][root][INFO] - Step: 960/1350  |  Loss: 0.3443  |  Score: 90.60 [%]  |  Seq Length: 256.0
[2024-09-26 20:15:31,859][root][INFO] - Step: 975/1350  |  Loss: 0.3773  |  Score: 88.66 [%]  |  Seq Length: 256.0
[2024-09-26 20:15:39,825][root][INFO] - Step: 990/1350  |  Loss: 0.3992  |  Score: 88.31 [%]  |  Seq Length: 256.0
[2024-09-26 20:15:45,980][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 20:15:45,980][root][INFO] - Score: 78.29 [%]  |  Evaluation Time: 6.15 [s]
[2024-09-26 20:15:51,559][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 20:15:51,559][root][INFO] - Score: 71.46 [%]  |  Evaluation Time: 5.58 [s]
[2024-09-26 20:15:51,561][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 20:15:52,453][root][INFO] - Step: 991/1350  |  Loss: 0.3148  |  Score: 90.15 [%]  |  Seq Length: 256.0
[2024-09-26 20:15:59,848][root][INFO] - Step: 1005/1350  |  Loss: 0.3664  |  Score: 89.58 [%]  |  Seq Length: 256.0
[2024-09-26 20:16:07,801][root][INFO] - Step: 1020/1350  |  Loss: 0.3271  |  Score: 89.92 [%]  |  Seq Length: 256.0
[2024-09-26 20:16:15,760][root][INFO] - Step: 1035/1350  |  Loss: 0.3244  |  Score: 90.41 [%]  |  Seq Length: 256.0
[2024-09-26 20:16:23,671][root][INFO] - Step: 1050/1350  |  Loss: 0.3333  |  Score: 90.30 [%]  |  Seq Length: 256.0
[2024-09-26 20:16:31,595][root][INFO] - Step: 1065/1350  |  Loss: 0.3549  |  Score: 89.44 [%]  |  Seq Length: 256.0
[2024-09-26 20:16:39,561][root][INFO] - Step: 1080/1350  |  Loss: 0.3782  |  Score: 88.33 [%]  |  Seq Length: 256.0
[2024-09-26 20:16:45,731][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 20:16:45,731][root][INFO] - Score: 78.32 [%]  |  Evaluation Time: 6.17 [s]
[2024-09-26 20:16:51,342][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 20:16:51,343][root][INFO] - Score: 71.79 [%]  |  Evaluation Time: 5.61 [s]
[2024-09-26 20:16:51,345][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 20:16:52,251][root][INFO] - Step: 1081/1350  |  Loss: 0.2736  |  Score: 93.06 [%]  |  Seq Length: 256.0
[2024-09-26 20:16:59,690][root][INFO] - Step: 1095/1350  |  Loss: 0.3263  |  Score: 90.67 [%]  |  Seq Length: 256.0
[2024-09-26 20:17:07,636][root][INFO] - Step: 1110/1350  |  Loss: 0.3330  |  Score: 90.44 [%]  |  Seq Length: 256.0
[2024-09-26 20:17:15,583][root][INFO] - Step: 1125/1350  |  Loss: 0.3303  |  Score: 90.73 [%]  |  Seq Length: 256.0
[2024-09-26 20:17:23,530][root][INFO] - Step: 1140/1350  |  Loss: 0.3302  |  Score: 89.90 [%]  |  Seq Length: 256.0
[2024-09-26 20:17:31,486][root][INFO] - Step: 1155/1350  |  Loss: 0.3077  |  Score: 91.18 [%]  |  Seq Length: 256.0
[2024-09-26 20:17:39,460][root][INFO] - Step: 1170/1350  |  Loss: 0.2994  |  Score: 89.86 [%]  |  Seq Length: 256.0
[2024-09-26 20:17:45,676][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 20:17:45,676][root][INFO] - Score: 77.71 [%]  |  Evaluation Time: 6.21 [s]
[2024-09-26 20:17:51,434][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 20:17:51,435][root][INFO] - Score: 72.93 [%]  |  Evaluation Time: 5.76 [s]
[2024-09-26 20:17:51,437][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 20:17:52,388][root][INFO] - Step: 1171/1350  |  Loss: 0.3340  |  Score: 90.80 [%]  |  Seq Length: 256.0
[2024-09-26 20:17:59,947][root][INFO] - Step: 1185/1350  |  Loss: 0.3106  |  Score: 90.41 [%]  |  Seq Length: 256.0
[2024-09-26 20:18:08,028][root][INFO] - Step: 1200/1350  |  Loss: 0.3114  |  Score: 90.61 [%]  |  Seq Length: 256.0
[2024-09-26 20:18:16,079][root][INFO] - Step: 1215/1350  |  Loss: 0.2952  |  Score: 91.75 [%]  |  Seq Length: 256.0
[2024-09-26 20:18:24,096][root][INFO] - Step: 1230/1350  |  Loss: 0.3271  |  Score: 89.95 [%]  |  Seq Length: 256.0
[2024-09-26 20:18:32,148][root][INFO] - Step: 1245/1350  |  Loss: 0.3347  |  Score: 90.09 [%]  |  Seq Length: 256.0
[2024-09-26 20:18:40,216][root][INFO] - Step: 1260/1350  |  Loss: 0.3039  |  Score: 91.18 [%]  |  Seq Length: 256.0
[2024-09-26 20:18:46,406][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 20:18:46,406][root][INFO] - Score: 78.11 [%]  |  Evaluation Time: 6.19 [s]
[2024-09-26 20:18:52,140][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 20:18:52,140][root][INFO] - Score: 72.13 [%]  |  Evaluation Time: 5.73 [s]
[2024-09-26 20:18:52,142][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 20:18:53,031][root][INFO] - Step: 1261/1350  |  Loss: 0.2237  |  Score: 93.20 [%]  |  Seq Length: 256.0
[2024-09-26 20:19:00,434][root][INFO] - Step: 1275/1350  |  Loss: 0.3080  |  Score: 90.65 [%]  |  Seq Length: 256.0
[2024-09-26 20:19:08,406][root][INFO] - Step: 1290/1350  |  Loss: 0.3279  |  Score: 89.96 [%]  |  Seq Length: 256.0
[2024-09-26 20:19:16,384][root][INFO] - Step: 1305/1350  |  Loss: 0.3022  |  Score: 90.59 [%]  |  Seq Length: 256.0
[2024-09-26 20:19:24,342][root][INFO] - Step: 1320/1350  |  Loss: 0.3028  |  Score: 91.28 [%]  |  Seq Length: 256.0
[2024-09-26 20:19:32,237][root][INFO] - Step: 1335/1350  |  Loss: 0.3084  |  Score: 90.93 [%]  |  Seq Length: 256.0
[2024-09-26 20:19:40,163][root][INFO] - Step: 1350/1350  |  Loss: 0.3368  |  Score: 89.26 [%]  |  Seq Length: 256.0
[2024-09-26 20:19:46,312][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 20:19:46,312][root][INFO] - Score: 78.28 [%]  |  Evaluation Time: 6.15 [s]
[2024-09-26 20:19:51,880][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 20:19:51,880][root][INFO] - Score: 71.53 [%]  |  Evaluation Time: 5.57 [s]
[2024-09-26 20:19:51,881][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 20:19:51,882][root][INFO] - - Epoch: 7
[2024-09-26 20:19:51,882][root][INFO] - - DEV score: 78.98 [%]
[2024-09-26 20:19:51,882][root][INFO] - - TEST score: 72.81 [%]
[2024-09-26 20:19:51,883][root][INFO] - Fine-tuning is done!
[2024-09-27 09:37:44,483][root][INFO] - 

[2024-09-27 09:37:44,484][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-27 09:37:44,484][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs
[2024-09-27 09:37:44,484][root][INFO] - 

[2024-09-27 09:37:44,484][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-27 09:37:51,623][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-27 09:37:51,624][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-27 09:37:51,625][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-27 09:37:51,625][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-27 09:37:51,626][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-27 09:37:51,626][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-27 09:37:51,627][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-27 09:37:51,627][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-27 09:37:51,628][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-27 09:37:51,628][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-27 09:37:51,629][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-27 09:37:51,629][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-27 09:37:51,630][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-27 09:37:51,630][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-27 09:37:51,631][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-27 09:37:51,631][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-27 09:37:51,632][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-27 09:37:51,632][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-27 09:37:51,633][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-27 09:37:51,633][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-27 09:37:51,634][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-27 09:37:51,634][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-27 09:37:51,635][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-27 09:37:51,635][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-27 09:37:51,637][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-27 09:37:51,818][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-27 09:37:53,797][root][INFO] - 

[2024-09-27 09:37:53,798][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-27 09:37:53,798][root][INFO] - Data Preprocessing
[2024-09-27 09:37:53,798][root][INFO] - ㄴ remain_lang                ko_en
[2024-09-27 09:37:53,798][root][INFO] - ㄴ do_hangeulize              True
[2024-09-27 09:37:53,798][root][INFO] - ㄴ data_remove                True

[2024-09-27 09:37:53,798][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-27 09:37:53,807][root][INFO] - vocab size              : 51200
[2024-09-27 09:37:53,807][root][INFO] - device                  : gpu
[2024-09-27 09:37:53,807][root][INFO] - random seed             : 42
[2024-09-27 09:37:53,807][root][INFO] - train data size         : 448
[2024-09-27 09:37:53,807][root][INFO] - max epochs              : 15
[2024-09-27 09:37:53,807][root][INFO] - total steps             : 105
[2024-09-27 09:37:53,808][root][INFO] - warmup steps            : 10
[2024-09-27 09:37:53,808][root][INFO] - batch size              : 64
[2024-09-27 09:37:53,808][root][INFO] - accumulation steps      : 1
[2024-09-27 09:37:53,808][root][INFO] - optimizer               : adamwscale
[2024-09-27 09:37:53,808][root][INFO] - lr_scheduler            : cosine
[2024-09-27 09:37:53,808][root][INFO] - learning rate           : 0.01
[2024-09-27 09:37:53,808][root][INFO] - max length              : 256

[2024-09-27 09:37:53,808][root][INFO] - LoRA Configuration
[2024-09-27 09:37:53,808][root][INFO] - ㄴ r                    : 32
[2024-09-27 09:37:53,808][root][INFO] - ㄴ alpha                : 128
[2024-09-27 09:37:53,809][root][INFO] - ㄴ dropout              : 0.03

[2024-09-27 09:37:53,809][root][INFO] - 

[2024-09-27 09:37:53,809][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs
[2024-09-27 09:37:53,809][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-27 09:37:53,809][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/tb
[2024-09-27 09:37:53,809][root][INFO] - * tb interval   : 15

[2024-09-27 09:37:53,809][root][INFO] - 

[2024-09-27 09:37:53,809][root][INFO] - Start the Training !
[2024-09-27 09:37:53,812][root][INFO] - 
[1/ 15 Epoch]
[2024-09-27 09:37:57,830][root][INFO] - Step: 7/105  |  Loss: 5.0106  |  Score: 0.87 [%]  |  Seq Length: 256.0
[2024-09-27 09:37:58,303][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-27 09:37:58,303][root][INFO] - Score: 0.40 [%]  |  Evaluation Time: 0.47 [s]
[2024-09-27 09:37:58,835][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-27 09:37:58,835][root][INFO] - Score: -5.72 [%]  |  Evaluation Time: 0.53 [s]
[2024-09-27 09:37:58,837][root][INFO] - 
[2/ 15 Epoch]
[2024-09-27 09:38:01,774][root][INFO] - Step: 14/105  |  Loss: 3.1058  |  Score: 11.46 [%]  |  Seq Length: 256.0
[2024-09-27 09:38:02,250][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-27 09:38:02,250][root][INFO] - Score: -3.03 [%]  |  Evaluation Time: 0.47 [s]
[2024-09-27 09:38:02,681][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-27 09:38:02,682][root][INFO] - Score: 4.05 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 09:38:02,683][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-27 09:38:02,684][root][INFO] - 
[3/ 15 Epoch]
[2024-09-27 09:38:03,397][root][INFO] - Step: 15/105  |  Loss: 2.8258  |  Score: 13.97 [%]  |  Seq Length: 256.0
[2024-09-27 09:38:05,654][root][INFO] - Step: 21/105  |  Loss: 2.1432  |  Score: 32.22 [%]  |  Seq Length: 256.0
[2024-09-27 09:38:06,107][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-27 09:38:06,107][root][INFO] - Score: 14.40 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-27 09:38:06,557][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-27 09:38:06,558][root][INFO] - Score: 14.78 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-27 09:38:06,559][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-27 09:38:06,560][root][INFO] - 
[4/ 15 Epoch]
[2024-09-27 09:38:09,500][root][INFO] - Step: 28/105  |  Loss: 1.9732  |  Score: 47.57 [%]  |  Seq Length: 256.0
[2024-09-27 09:38:09,973][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-27 09:38:09,973][root][INFO] - Score: 20.47 [%]  |  Evaluation Time: 0.47 [s]
[2024-09-27 09:38:10,403][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-27 09:38:10,403][root][INFO] - Score: 21.72 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 09:38:10,404][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-27 09:38:10,405][root][INFO] - 
[5/ 15 Epoch]
[2024-09-27 09:38:11,475][root][INFO] - Step: 30/105  |  Loss: 1.2927  |  Score: 65.89 [%]  |  Seq Length: 256.0
[2024-09-27 09:38:13,327][root][INFO] - Step: 35/105  |  Loss: 1.6236  |  Score: 58.08 [%]  |  Seq Length: 256.0
[2024-09-27 09:38:13,799][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-27 09:38:13,799][root][INFO] - Score: 34.93 [%]  |  Evaluation Time: 0.47 [s]
[2024-09-27 09:38:14,238][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-27 09:38:14,238][root][INFO] - Score: 29.81 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 09:38:14,239][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-27 09:38:14,240][root][INFO] - 
[6/ 15 Epoch]
[2024-09-27 09:38:17,186][root][INFO] - Step: 42/105  |  Loss: 1.3591  |  Score: 65.86 [%]  |  Seq Length: 256.0
[2024-09-27 09:38:17,654][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-27 09:38:17,654][root][INFO] - Score: 42.13 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-27 09:38:18,092][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-27 09:38:18,092][root][INFO] - Score: 31.96 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 09:38:18,093][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-27 09:38:18,094][root][INFO] - 
[7/ 15 Epoch]
[2024-09-27 09:38:19,670][root][INFO] - Step: 45/105  |  Loss: 1.1557  |  Score: 72.21 [%]  |  Seq Length: 256.0
[2024-09-27 09:38:21,151][root][INFO] - Step: 49/105  |  Loss: 1.2884  |  Score: 76.19 [%]  |  Seq Length: 256.0
[2024-09-27 09:38:21,623][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-27 09:38:21,624][root][INFO] - Score: 47.39 [%]  |  Evaluation Time: 0.47 [s]
[2024-09-27 09:38:22,021][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-27 09:38:22,021][root][INFO] - Score: 36.09 [%]  |  Evaluation Time: 0.40 [s]
[2024-09-27 09:38:22,022][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-27 09:38:22,023][root][INFO] - 
[8/ 15 Epoch]
[2024-09-27 09:38:24,955][root][INFO] - Step: 56/105  |  Loss: 1.0518  |  Score: 75.24 [%]  |  Seq Length: 256.0
[2024-09-27 09:38:25,409][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-27 09:38:25,409][root][INFO] - Score: 47.62 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-27 09:38:25,840][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-27 09:38:25,840][root][INFO] - Score: 37.31 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 09:38:25,841][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-27 09:38:25,842][root][INFO] - 
[9/ 15 Epoch]
[2024-09-27 09:38:27,684][root][INFO] - Step: 60/105  |  Loss: 0.8561  |  Score: 82.98 [%]  |  Seq Length: 256.0
[2024-09-27 09:38:28,770][root][INFO] - Step: 63/105  |  Loss: 0.7747  |  Score: 82.49 [%]  |  Seq Length: 256.0
[2024-09-27 09:38:29,254][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-27 09:38:29,255][root][INFO] - Score: 46.12 [%]  |  Evaluation Time: 0.48 [s]
[2024-09-27 09:38:29,705][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-27 09:38:29,705][root][INFO] - Score: 37.83 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-27 09:38:29,708][root][INFO] - 
[10/ 15 Epoch]
[2024-09-27 09:38:32,759][root][INFO] - Step: 70/105  |  Loss: 0.6989  |  Score: 84.67 [%]  |  Seq Length: 256.0
[2024-09-27 09:38:33,204][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-27 09:38:33,204][root][INFO] - Score: 49.72 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 09:38:33,640][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-27 09:38:33,640][root][INFO] - Score: 40.73 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 09:38:33,641][root][INFO] - 
Save new Best Score (Epoch: 10)
[2024-09-27 09:38:33,642][root][INFO] - 
[11/ 15 Epoch]
[2024-09-27 09:38:35,862][root][INFO] - Step: 75/105  |  Loss: 0.6168  |  Score: 86.91 [%]  |  Seq Length: 256.0
[2024-09-27 09:38:36,541][root][INFO] - Step: 77/105  |  Loss: 0.6434  |  Score: 85.80 [%]  |  Seq Length: 256.0
[2024-09-27 09:38:37,014][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-27 09:38:37,014][root][INFO] - Score: 50.84 [%]  |  Evaluation Time: 0.47 [s]
[2024-09-27 09:38:37,439][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-27 09:38:37,439][root][INFO] - Score: 42.11 [%]  |  Evaluation Time: 0.42 [s]
[2024-09-27 09:38:37,440][root][INFO] - 
Save new Best Score (Epoch: 11)
[2024-09-27 09:38:37,442][root][INFO] - 
[12/ 15 Epoch]
[2024-09-27 09:38:40,393][root][INFO] - Step: 84/105  |  Loss: 0.5812  |  Score: 87.28 [%]  |  Seq Length: 256.0
[2024-09-27 09:38:40,864][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-27 09:38:40,864][root][INFO] - Score: 52.01 [%]  |  Evaluation Time: 0.47 [s]
[2024-09-27 09:38:41,315][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-27 09:38:41,315][root][INFO] - Score: 41.14 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-27 09:38:41,316][root][INFO] - 
Save new Best Score (Epoch: 12)
[2024-09-27 09:38:41,318][root][INFO] - 
[13/ 15 Epoch]
[2024-09-27 09:38:44,008][root][INFO] - Step: 90/105  |  Loss: 0.5811  |  Score: 86.89 [%]  |  Seq Length: 256.0
[2024-09-27 09:38:44,343][root][INFO] - Step: 91/105  |  Loss: 0.4166  |  Score: 88.55 [%]  |  Seq Length: 256.0
[2024-09-27 09:38:44,822][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-27 09:38:44,822][root][INFO] - Score: 52.99 [%]  |  Evaluation Time: 0.48 [s]
[2024-09-27 09:38:45,259][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-27 09:38:45,259][root][INFO] - Score: 41.55 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 09:38:45,261][root][INFO] - 
Save new Best Score (Epoch: 13)
[2024-09-27 09:38:45,264][root][INFO] - 
[14/ 15 Epoch]
[2024-09-27 09:38:48,161][root][INFO] - Step: 98/105  |  Loss: 0.5454  |  Score: 87.57 [%]  |  Seq Length: 256.0
[2024-09-27 09:38:48,619][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-27 09:38:48,619][root][INFO] - Score: 52.89 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-27 09:38:49,050][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-27 09:38:49,051][root][INFO] - Score: 41.77 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 09:38:49,052][root][INFO] - 
Save new Best Score (Epoch: 14)
[2024-09-27 09:38:49,053][root][INFO] - 
[15/ 15 Epoch]
[2024-09-27 09:38:52,003][root][INFO] - Step: 105/105  |  Loss: 0.5551  |  Score: 87.42 [%]  |  Seq Length: 256.0
[2024-09-27 09:38:52,450][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-27 09:38:52,451][root][INFO] - Score: 52.86 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 09:38:52,986][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-27 09:38:52,986][root][INFO] - Score: 41.47 [%]  |  Evaluation Time: 0.53 [s]
[2024-09-27 09:38:52,987][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-27 09:38:52,987][root][INFO] - - Epoch: 14
[2024-09-27 09:38:52,987][root][INFO] - - DEV score: 52.89 [%]
[2024-09-27 09:38:52,987][root][INFO] - - TEST score: 41.77 [%]
[2024-09-27 09:38:52,988][root][INFO] - Fine-tuning is done!
[2024-09-27 09:38:58,769][root][INFO] - 

[2024-09-27 09:38:58,769][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-27 09:38:58,770][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs
[2024-09-27 09:38:58,770][root][INFO] - 

[2024-09-27 09:38:58,770][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-27 09:39:02,215][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-27 09:39:02,215][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-27 09:39:02,216][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-27 09:39:02,216][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-27 09:39:02,217][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-27 09:39:02,217][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-27 09:39:02,218][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-27 09:39:02,218][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-27 09:39:02,218][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-27 09:39:02,219][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-27 09:39:02,219][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-27 09:39:02,220][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-27 09:39:02,220][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-27 09:39:02,220][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-27 09:39:02,221][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-27 09:39:02,221][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-27 09:39:02,222][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-27 09:39:02,222][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-27 09:39:02,223][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-27 09:39:02,223][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-27 09:39:02,224][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-27 09:39:02,224][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-27 09:39:02,225][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-27 09:39:02,225][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-27 09:39:02,227][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-27 09:39:02,230][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-27 09:39:02,332][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-27 09:39:02,334][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-27 09:39:02,523][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-27 09:39:05,725][root][INFO] - 

[2024-09-27 09:39:05,725][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-27 09:39:05,725][root][INFO] - Data Preprocessing
[2024-09-27 09:39:05,725][root][INFO] - ㄴ remain_lang                ko_en
[2024-09-27 09:39:05,725][root][INFO] - ㄴ do_hangeulize              True
[2024-09-27 09:39:05,725][root][INFO] - ㄴ data_remove                True

[2024-09-27 09:39:05,725][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-27 09:39:05,733][root][INFO] - vocab size              : 51200
[2024-09-27 09:39:05,734][root][INFO] - device                  : gpu
[2024-09-27 09:39:05,734][root][INFO] - random seed             : 42
[2024-09-27 09:39:05,734][root][INFO] - train data size         : 448
[2024-09-27 09:39:05,734][root][INFO] - max epochs              : 15
[2024-09-27 09:39:05,734][root][INFO] - total steps             : 105
[2024-09-27 09:39:05,734][root][INFO] - warmup steps            : 10
[2024-09-27 09:39:05,734][root][INFO] - batch size              : 64
[2024-09-27 09:39:05,734][root][INFO] - accumulation steps      : 1
[2024-09-27 09:39:05,734][root][INFO] - optimizer               : adamwscale
[2024-09-27 09:39:05,734][root][INFO] - lr_scheduler            : cosine
[2024-09-27 09:39:05,735][root][INFO] - learning rate           : 0.01
[2024-09-27 09:39:05,735][root][INFO] - max length              : 256

[2024-09-27 09:39:05,735][root][INFO] - LoRA Configuration
[2024-09-27 09:39:05,735][root][INFO] - ㄴ r                    : 32
[2024-09-27 09:39:05,735][root][INFO] - ㄴ alpha                : 128
[2024-09-27 09:39:05,735][root][INFO] - ㄴ dropout              : 0.03

[2024-09-27 09:39:05,735][root][INFO] - KOMBO Configuration
[2024-09-27 09:39:05,735][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-27 09:39:05,735][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-27 09:39:05,735][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-27 09:39:05,735][root][INFO] - ㄴ do_combination       : True
[2024-09-27 09:39:05,736][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-27 09:39:05,736][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-27 09:39:05,736][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-27 09:39:05,736][root][INFO] -   ㄴ add_lora           : True

[2024-09-27 09:39:05,736][root][INFO] - LoRA in KOMBO Configuration
[2024-09-27 09:39:05,736][root][INFO] - ㄴ r                : 32
[2024-09-27 09:39:05,736][root][INFO] - ㄴ alpha            : 128
[2024-09-27 09:39:05,736][root][INFO] - ㄴ dropout          : 0.03

[2024-09-27 09:39:05,736][root][INFO] - 

[2024-09-27 09:39:05,736][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs
[2024-09-27 09:39:05,737][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-27 09:39:05,737][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/tb
[2024-09-27 09:39:05,737][root][INFO] - * tb interval   : 15

[2024-09-27 09:39:05,737][root][INFO] - 

[2024-09-27 09:39:05,737][root][INFO] - Start the Training !
[2024-09-27 09:39:05,740][root][INFO] - 
[1/ 15 Epoch]
[2024-09-27 09:39:09,893][root][INFO] - Step: 7/105  |  Loss: 5.0482  |  Score: 2.23 [%]  |  Seq Length: 256.0
[2024-09-27 09:39:10,491][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-27 09:39:10,491][root][INFO] - Score: 0.96 [%]  |  Evaluation Time: 0.60 [s]
[2024-09-27 09:39:11,060][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-27 09:39:11,061][root][INFO] - Score: -4.94 [%]  |  Evaluation Time: 0.57 [s]
[2024-09-27 09:39:11,063][root][INFO] - 
[2/ 15 Epoch]
[2024-09-27 09:39:14,828][root][INFO] - Step: 14/105  |  Loss: 2.7453  |  Score: 10.74 [%]  |  Seq Length: 256.0
[2024-09-27 09:39:15,425][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-27 09:39:15,425][root][INFO] - Score: -1.42 [%]  |  Evaluation Time: 0.59 [s]
[2024-09-27 09:39:15,992][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-27 09:39:15,993][root][INFO] - Score: 6.72 [%]  |  Evaluation Time: 0.56 [s]
[2024-09-27 09:39:15,994][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-27 09:39:15,995][root][INFO] - 
[3/ 15 Epoch]
[2024-09-27 09:39:16,875][root][INFO] - Step: 15/105  |  Loss: 2.4139  |  Score: 15.86 [%]  |  Seq Length: 256.0
[2024-09-27 09:39:19,822][root][INFO] - Step: 21/105  |  Loss: 2.1706  |  Score: 36.18 [%]  |  Seq Length: 256.0
[2024-09-27 09:39:20,414][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-27 09:39:20,414][root][INFO] - Score: 19.71 [%]  |  Evaluation Time: 0.59 [s]
[2024-09-27 09:39:20,963][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-27 09:39:20,963][root][INFO] - Score: 11.20 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-27 09:39:20,964][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-27 09:39:20,965][root][INFO] - 
[4/ 15 Epoch]
[2024-09-27 09:39:24,788][root][INFO] - Step: 28/105  |  Loss: 1.8518  |  Score: 49.73 [%]  |  Seq Length: 256.0
[2024-09-27 09:39:25,400][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-27 09:39:25,400][root][INFO] - Score: 20.85 [%]  |  Evaluation Time: 0.61 [s]
[2024-09-27 09:39:25,948][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-27 09:39:25,948][root][INFO] - Score: 18.17 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-27 09:39:25,949][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-27 09:39:25,950][root][INFO] - 
[5/ 15 Epoch]
[2024-09-27 09:39:27,328][root][INFO] - Step: 30/105  |  Loss: 1.9151  |  Score: 53.95 [%]  |  Seq Length: 256.0
[2024-09-27 09:39:29,757][root][INFO] - Step: 35/105  |  Loss: 1.4397  |  Score: 63.66 [%]  |  Seq Length: 256.0
[2024-09-27 09:39:30,350][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-27 09:39:30,350][root][INFO] - Score: 31.37 [%]  |  Evaluation Time: 0.59 [s]
[2024-09-27 09:39:30,863][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-27 09:39:30,863][root][INFO] - Score: 26.85 [%]  |  Evaluation Time: 0.51 [s]
[2024-09-27 09:39:30,864][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-27 09:39:30,865][root][INFO] - 
[6/ 15 Epoch]
[2024-09-27 09:39:34,594][root][INFO] - Step: 42/105  |  Loss: 1.3368  |  Score: 68.48 [%]  |  Seq Length: 256.0
[2024-09-27 09:39:35,150][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-27 09:39:35,151][root][INFO] - Score: 33.99 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-27 09:39:35,710][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-27 09:39:35,710][root][INFO] - Score: 29.36 [%]  |  Evaluation Time: 0.56 [s]
[2024-09-27 09:39:35,711][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-27 09:39:35,712][root][INFO] - 
[7/ 15 Epoch]
[2024-09-27 09:39:37,590][root][INFO] - Step: 45/105  |  Loss: 1.0198  |  Score: 76.10 [%]  |  Seq Length: 256.0
[2024-09-27 09:39:39,524][root][INFO] - Step: 49/105  |  Loss: 1.1428  |  Score: 76.28 [%]  |  Seq Length: 256.0
[2024-09-27 09:39:40,108][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-27 09:39:40,108][root][INFO] - Score: 39.88 [%]  |  Evaluation Time: 0.58 [s]
[2024-09-27 09:39:40,656][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-27 09:39:40,656][root][INFO] - Score: 34.84 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-27 09:39:40,657][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-27 09:39:40,659][root][INFO] - 
[8/ 15 Epoch]
[2024-09-27 09:39:44,431][root][INFO] - Step: 56/105  |  Loss: 0.8899  |  Score: 81.23 [%]  |  Seq Length: 256.0
[2024-09-27 09:39:44,984][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-27 09:39:44,984][root][INFO] - Score: 42.69 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-27 09:39:45,532][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-27 09:39:45,532][root][INFO] - Score: 37.44 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-27 09:39:45,533][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-27 09:39:45,534][root][INFO] - 
[9/ 15 Epoch]
[2024-09-27 09:39:47,906][root][INFO] - Step: 60/105  |  Loss: 0.7888  |  Score: 82.65 [%]  |  Seq Length: 256.0
[2024-09-27 09:39:49,300][root][INFO] - Step: 63/105  |  Loss: 0.7981  |  Score: 82.09 [%]  |  Seq Length: 256.0
[2024-09-27 09:39:49,918][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-27 09:39:49,919][root][INFO] - Score: 43.56 [%]  |  Evaluation Time: 0.62 [s]
[2024-09-27 09:39:50,435][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-27 09:39:50,436][root][INFO] - Score: 36.34 [%]  |  Evaluation Time: 0.51 [s]
[2024-09-27 09:39:50,438][root][INFO] - 
[10/ 15 Epoch]
[2024-09-27 09:39:54,182][root][INFO] - Step: 70/105  |  Loss: 0.6399  |  Score: 85.80 [%]  |  Seq Length: 256.0
[2024-09-27 09:39:54,767][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-27 09:39:54,767][root][INFO] - Score: 43.56 [%]  |  Evaluation Time: 0.58 [s]
[2024-09-27 09:39:55,281][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-27 09:39:55,281][root][INFO] - Score: 38.87 [%]  |  Evaluation Time: 0.51 [s]
[2024-09-27 09:39:55,282][root][INFO] - 
Save new Best Score (Epoch: 10)
[2024-09-27 09:39:55,283][root][INFO] - 
[11/ 15 Epoch]
[2024-09-27 09:39:58,133][root][INFO] - Step: 75/105  |  Loss: 0.5703  |  Score: 86.08 [%]  |  Seq Length: 256.0
[2024-09-27 09:39:59,021][root][INFO] - Step: 77/105  |  Loss: 0.6475  |  Score: 85.69 [%]  |  Seq Length: 256.0
[2024-09-27 09:39:59,582][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-27 09:39:59,582][root][INFO] - Score: 43.51 [%]  |  Evaluation Time: 0.56 [s]
[2024-09-27 09:40:00,093][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-27 09:40:00,093][root][INFO] - Score: 39.69 [%]  |  Evaluation Time: 0.51 [s]
[2024-09-27 09:40:00,094][root][INFO] - 
Save new Best Score (Epoch: 11)
[2024-09-27 09:40:00,095][root][INFO] - 
[12/ 15 Epoch]
[2024-09-27 09:40:03,825][root][INFO] - Step: 84/105  |  Loss: 0.5411  |  Score: 88.41 [%]  |  Seq Length: 256.0
[2024-09-27 09:40:04,426][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-27 09:40:04,427][root][INFO] - Score: 43.61 [%]  |  Evaluation Time: 0.60 [s]
[2024-09-27 09:40:04,988][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-27 09:40:04,988][root][INFO] - Score: 40.60 [%]  |  Evaluation Time: 0.56 [s]
[2024-09-27 09:40:04,989][root][INFO] - 
Save new Best Score (Epoch: 12)
[2024-09-27 09:40:04,991][root][INFO] - 
[13/ 15 Epoch]
[2024-09-27 09:40:08,358][root][INFO] - Step: 90/105  |  Loss: 0.5462  |  Score: 88.33 [%]  |  Seq Length: 256.0
[2024-09-27 09:40:08,797][root][INFO] - Step: 91/105  |  Loss: 0.5956  |  Score: 90.63 [%]  |  Seq Length: 256.0
[2024-09-27 09:40:09,390][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-27 09:40:09,391][root][INFO] - Score: 44.67 [%]  |  Evaluation Time: 0.59 [s]
[2024-09-27 09:40:09,904][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-27 09:40:09,904][root][INFO] - Score: 40.99 [%]  |  Evaluation Time: 0.51 [s]
[2024-09-27 09:40:09,905][root][INFO] - 
Save new Best Score (Epoch: 13)
[2024-09-27 09:40:09,906][root][INFO] - 
[14/ 15 Epoch]
[2024-09-27 09:40:13,639][root][INFO] - Step: 98/105  |  Loss: 0.5242  |  Score: 87.13 [%]  |  Seq Length: 256.0
[2024-09-27 09:40:14,218][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-27 09:40:14,219][root][INFO] - Score: 45.24 [%]  |  Evaluation Time: 0.58 [s]
[2024-09-27 09:40:14,718][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-27 09:40:14,719][root][INFO] - Score: 42.39 [%]  |  Evaluation Time: 0.50 [s]
[2024-09-27 09:40:14,720][root][INFO] - 
Save new Best Score (Epoch: 14)
[2024-09-27 09:40:14,721][root][INFO] - 
[15/ 15 Epoch]
[2024-09-27 09:40:18,495][root][INFO] - Step: 105/105  |  Loss: 0.5172  |  Score: 88.55 [%]  |  Seq Length: 256.0
[2024-09-27 09:40:19,087][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-27 09:40:19,087][root][INFO] - Score: 44.56 [%]  |  Evaluation Time: 0.59 [s]
[2024-09-27 09:40:19,603][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-27 09:40:19,603][root][INFO] - Score: 41.99 [%]  |  Evaluation Time: 0.51 [s]
[2024-09-27 09:40:19,604][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-27 09:40:19,604][root][INFO] - - Epoch: 14
[2024-09-27 09:40:19,604][root][INFO] - - DEV score: 45.24 [%]
[2024-09-27 09:40:19,605][root][INFO] - - TEST score: 42.39 [%]
[2024-09-27 09:40:19,605][root][INFO] - Fine-tuning is done!
[2024-09-27 09:40:25,801][root][INFO] - 

[2024-09-27 09:40:25,801][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-27 09:40:25,801][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs
[2024-09-27 09:40:25,801][root][INFO] - 

[2024-09-27 09:40:25,801][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en', 'do_hangeulize': True, 'data_remove': False, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-27 09:41:47,714][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-27 09:41:47,715][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-27 09:41:47,716][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-27 09:41:47,717][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-27 09:41:47,717][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-27 09:41:47,717][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-27 09:41:47,718][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-27 09:41:47,718][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-27 09:41:47,719][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-27 09:41:47,719][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-27 09:41:47,720][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-27 09:41:47,720][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-27 09:41:47,720][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-27 09:41:47,721][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-27 09:41:47,721][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-27 09:41:47,722][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-27 09:41:47,722][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-27 09:41:47,722][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-27 09:41:47,723][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-27 09:41:47,723][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-27 09:41:47,724][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-27 09:41:47,724][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-27 09:41:47,725][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-27 09:41:47,725][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-27 09:41:47,727][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-27 09:41:48,053][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-27 09:41:52,012][root][INFO] - 

[2024-09-27 09:41:52,013][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-27 09:41:52,013][root][INFO] - Data Preprocessing
[2024-09-27 09:41:52,013][root][INFO] - ㄴ remain_lang                ko_en
[2024-09-27 09:41:52,013][root][INFO] - ㄴ do_hangeulize              True
[2024-09-27 09:41:52,013][root][INFO] - ㄴ data_remove                False

[2024-09-27 09:41:52,013][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-27 09:41:52,022][root][INFO] - vocab size              : 51200
[2024-09-27 09:41:52,023][root][INFO] - device                  : gpu
[2024-09-27 09:41:52,023][root][INFO] - random seed             : 42
[2024-09-27 09:41:52,023][root][INFO] - train data size         : 5760
[2024-09-27 09:41:52,023][root][INFO] - max epochs              : 15
[2024-09-27 09:41:52,023][root][INFO] - total steps             : 1350
[2024-09-27 09:41:52,023][root][INFO] - warmup steps            : 135
[2024-09-27 09:41:52,023][root][INFO] - batch size              : 64
[2024-09-27 09:41:52,023][root][INFO] - accumulation steps      : 1
[2024-09-27 09:41:52,023][root][INFO] - optimizer               : adamwscale
[2024-09-27 09:41:52,023][root][INFO] - lr_scheduler            : cosine
[2024-09-27 09:41:52,023][root][INFO] - learning rate           : 0.01
[2024-09-27 09:41:52,024][root][INFO] - max length              : 256

[2024-09-27 09:41:52,024][root][INFO] - LoRA Configuration
[2024-09-27 09:41:52,024][root][INFO] - ㄴ r                    : 32
[2024-09-27 09:41:52,024][root][INFO] - ㄴ alpha                : 128
[2024-09-27 09:41:52,024][root][INFO] - ㄴ dropout              : 0.03

[2024-09-27 09:41:52,024][root][INFO] - 

[2024-09-27 09:41:52,024][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs
[2024-09-27 09:41:52,024][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-27 09:41:52,024][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/tb
[2024-09-27 09:41:52,024][root][INFO] - * tb interval   : 15

[2024-09-27 09:41:52,024][root][INFO] - 

[2024-09-27 09:41:52,024][root][INFO] - Start the Training !
[2024-09-27 09:41:52,028][root][INFO] - 
[1/ 15 Epoch]
[2024-09-27 09:42:00,629][root][INFO] - Step: 15/1350  |  Loss: 3.6161  |  Score: -1.24 [%]  |  Seq Length: 256.0
[2024-09-27 09:42:06,365][root][INFO] - Step: 30/1350  |  Loss: 2.2365  |  Score: 15.75 [%]  |  Seq Length: 256.0
[2024-09-27 09:42:12,084][root][INFO] - Step: 45/1350  |  Loss: 2.1137  |  Score: 29.24 [%]  |  Seq Length: 256.0
[2024-09-27 09:42:17,802][root][INFO] - Step: 60/1350  |  Loss: 1.9543  |  Score: 41.15 [%]  |  Seq Length: 256.0
[2024-09-27 09:42:23,512][root][INFO] - Step: 75/1350  |  Loss: 1.5691  |  Score: 57.93 [%]  |  Seq Length: 256.0
[2024-09-27 09:42:29,227][root][INFO] - Step: 90/1350  |  Loss: 1.4644  |  Score: 53.71 [%]  |  Seq Length: 256.0
[2024-09-27 09:42:33,018][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-27 09:42:33,018][root][INFO] - Score: 72.36 [%]  |  Evaluation Time: 3.79 [s]
[2024-09-27 09:42:36,702][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-27 09:42:36,702][root][INFO] - Score: 63.57 [%]  |  Evaluation Time: 3.68 [s]
[2024-09-27 09:42:36,703][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-27 09:42:36,704][root][INFO] - 
[2/ 15 Epoch]
[2024-09-27 09:42:37,413][root][INFO] - Step: 91/1350  |  Loss: 1.4434  |  Score: 56.76 [%]  |  Seq Length: 256.0
[2024-09-27 09:42:42,746][root][INFO] - Step: 105/1350  |  Loss: 1.3170  |  Score: 59.28 [%]  |  Seq Length: 256.0
[2024-09-27 09:42:48,460][root][INFO] - Step: 120/1350  |  Loss: 1.1940  |  Score: 63.01 [%]  |  Seq Length: 256.0
[2024-09-27 09:42:54,178][root][INFO] - Step: 135/1350  |  Loss: 1.1890  |  Score: 66.21 [%]  |  Seq Length: 256.0
[2024-09-27 09:42:59,904][root][INFO] - Step: 150/1350  |  Loss: 1.1772  |  Score: 65.64 [%]  |  Seq Length: 256.0
[2024-09-27 09:43:05,630][root][INFO] - Step: 165/1350  |  Loss: 1.0964  |  Score: 64.70 [%]  |  Seq Length: 256.0
[2024-09-27 09:43:11,371][root][INFO] - Step: 180/1350  |  Loss: 1.2536  |  Score: 62.62 [%]  |  Seq Length: 256.0
[2024-09-27 09:43:15,180][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-27 09:43:15,180][root][INFO] - Score: 75.75 [%]  |  Evaluation Time: 3.80 [s]
[2024-09-27 09:43:18,843][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-27 09:43:18,843][root][INFO] - Score: 67.09 [%]  |  Evaluation Time: 3.66 [s]
[2024-09-27 09:43:18,844][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-27 09:43:18,845][root][INFO] - 
[3/ 15 Epoch]
[2024-09-27 09:43:19,519][root][INFO] - Step: 181/1350  |  Loss: 0.9898  |  Score: 66.51 [%]  |  Seq Length: 256.0
[2024-09-27 09:43:24,869][root][INFO] - Step: 195/1350  |  Loss: 0.9520  |  Score: 69.89 [%]  |  Seq Length: 256.0
[2024-09-27 09:43:30,599][root][INFO] - Step: 210/1350  |  Loss: 1.1336  |  Score: 69.75 [%]  |  Seq Length: 256.0
[2024-09-27 09:43:36,331][root][INFO] - Step: 225/1350  |  Loss: 1.0894  |  Score: 69.27 [%]  |  Seq Length: 256.0
[2024-09-27 09:43:42,055][root][INFO] - Step: 240/1350  |  Loss: 1.0712  |  Score: 69.43 [%]  |  Seq Length: 256.0
[2024-09-27 09:43:47,779][root][INFO] - Step: 255/1350  |  Loss: 1.0839  |  Score: 67.40 [%]  |  Seq Length: 256.0
[2024-09-27 09:43:53,523][root][INFO] - Step: 270/1350  |  Loss: 1.0192  |  Score: 71.54 [%]  |  Seq Length: 256.0
[2024-09-27 09:43:57,328][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-27 09:43:57,328][root][INFO] - Score: 76.41 [%]  |  Evaluation Time: 3.80 [s]
[2024-09-27 09:44:00,839][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-27 09:44:00,839][root][INFO] - Score: 69.09 [%]  |  Evaluation Time: 3.51 [s]
[2024-09-27 09:44:00,840][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-27 09:44:00,842][root][INFO] - 
[4/ 15 Epoch]
[2024-09-27 09:44:01,548][root][INFO] - Step: 271/1350  |  Loss: 1.2082  |  Score: 60.37 [%]  |  Seq Length: 256.0
[2024-09-27 09:44:06,902][root][INFO] - Step: 285/1350  |  Loss: 0.9607  |  Score: 73.15 [%]  |  Seq Length: 256.0
[2024-09-27 09:44:12,632][root][INFO] - Step: 300/1350  |  Loss: 0.8746  |  Score: 74.02 [%]  |  Seq Length: 256.0
[2024-09-27 09:44:18,358][root][INFO] - Step: 315/1350  |  Loss: 0.9491  |  Score: 73.25 [%]  |  Seq Length: 256.0
[2024-09-27 09:44:24,088][root][INFO] - Step: 330/1350  |  Loss: 1.0174  |  Score: 70.38 [%]  |  Seq Length: 256.0
[2024-09-27 09:44:29,813][root][INFO] - Step: 345/1350  |  Loss: 0.9352  |  Score: 72.06 [%]  |  Seq Length: 256.0
[2024-09-27 09:44:35,531][root][INFO] - Step: 360/1350  |  Loss: 0.9545  |  Score: 72.45 [%]  |  Seq Length: 256.0
[2024-09-27 09:44:39,499][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-27 09:44:39,499][root][INFO] - Score: 75.94 [%]  |  Evaluation Time: 3.96 [s]
[2024-09-27 09:44:43,172][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-27 09:44:43,172][root][INFO] - Score: 70.03 [%]  |  Evaluation Time: 3.67 [s]
[2024-09-27 09:44:43,173][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-27 09:44:43,175][root][INFO] - 
[5/ 15 Epoch]
[2024-09-27 09:44:43,847][root][INFO] - Step: 361/1350  |  Loss: 1.2773  |  Score: 68.69 [%]  |  Seq Length: 256.0
[2024-09-27 09:44:49,202][root][INFO] - Step: 375/1350  |  Loss: 0.8094  |  Score: 76.85 [%]  |  Seq Length: 256.0
[2024-09-27 09:44:54,942][root][INFO] - Step: 390/1350  |  Loss: 0.8900  |  Score: 75.17 [%]  |  Seq Length: 256.0
[2024-09-27 09:45:00,674][root][INFO] - Step: 405/1350  |  Loss: 0.8358  |  Score: 74.07 [%]  |  Seq Length: 256.0
[2024-09-27 09:45:06,405][root][INFO] - Step: 420/1350  |  Loss: 0.8883  |  Score: 77.84 [%]  |  Seq Length: 256.0
[2024-09-27 09:45:12,135][root][INFO] - Step: 435/1350  |  Loss: 0.7756  |  Score: 78.75 [%]  |  Seq Length: 256.0
[2024-09-27 09:45:17,856][root][INFO] - Step: 450/1350  |  Loss: 0.9306  |  Score: 72.65 [%]  |  Seq Length: 256.0
[2024-09-27 09:45:21,658][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-27 09:45:21,658][root][INFO] - Score: 77.00 [%]  |  Evaluation Time: 3.80 [s]
[2024-09-27 09:45:25,268][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-27 09:45:25,268][root][INFO] - Score: 68.74 [%]  |  Evaluation Time: 3.61 [s]
[2024-09-27 09:45:25,270][root][INFO] - 
[6/ 15 Epoch]
[2024-09-27 09:45:25,993][root][INFO] - Step: 451/1350  |  Loss: 0.5783  |  Score: 83.33 [%]  |  Seq Length: 256.0
[2024-09-27 09:45:31,365][root][INFO] - Step: 465/1350  |  Loss: 0.6981  |  Score: 78.17 [%]  |  Seq Length: 256.0
[2024-09-27 09:45:37,113][root][INFO] - Step: 480/1350  |  Loss: 0.6764  |  Score: 80.68 [%]  |  Seq Length: 256.0
[2024-09-27 09:45:42,869][root][INFO] - Step: 495/1350  |  Loss: 0.7726  |  Score: 77.47 [%]  |  Seq Length: 256.0
[2024-09-27 09:45:48,602][root][INFO] - Step: 510/1350  |  Loss: 0.7252  |  Score: 78.76 [%]  |  Seq Length: 256.0
[2024-09-27 09:45:54,352][root][INFO] - Step: 525/1350  |  Loss: 0.7158  |  Score: 78.72 [%]  |  Seq Length: 256.0
[2024-09-27 09:46:00,118][root][INFO] - Step: 540/1350  |  Loss: 0.7371  |  Score: 79.20 [%]  |  Seq Length: 256.0
[2024-09-27 09:46:03,927][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-27 09:46:03,927][root][INFO] - Score: 77.03 [%]  |  Evaluation Time: 3.81 [s]
[2024-09-27 09:46:07,467][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-27 09:46:07,467][root][INFO] - Score: 69.39 [%]  |  Evaluation Time: 3.54 [s]
[2024-09-27 09:46:07,468][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-27 09:46:07,469][root][INFO] - 
[7/ 15 Epoch]
[2024-09-27 09:46:08,170][root][INFO] - Step: 541/1350  |  Loss: 0.5627  |  Score: 84.07 [%]  |  Seq Length: 256.0
[2024-09-27 09:46:13,526][root][INFO] - Step: 555/1350  |  Loss: 0.6395  |  Score: 81.82 [%]  |  Seq Length: 256.0
[2024-09-27 09:46:19,266][root][INFO] - Step: 570/1350  |  Loss: 0.6369  |  Score: 77.63 [%]  |  Seq Length: 256.0
[2024-09-27 09:46:24,996][root][INFO] - Step: 585/1350  |  Loss: 0.5769  |  Score: 81.23 [%]  |  Seq Length: 256.0
[2024-09-27 09:46:30,729][root][INFO] - Step: 600/1350  |  Loss: 0.6277  |  Score: 81.86 [%]  |  Seq Length: 256.0
[2024-09-27 09:46:36,461][root][INFO] - Step: 615/1350  |  Loss: 0.6380  |  Score: 81.84 [%]  |  Seq Length: 256.0
[2024-09-27 09:46:42,184][root][INFO] - Step: 630/1350  |  Loss: 0.6424  |  Score: 82.15 [%]  |  Seq Length: 256.0
[2024-09-27 09:46:46,072][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-27 09:46:46,073][root][INFO] - Score: 76.09 [%]  |  Evaluation Time: 3.89 [s]
[2024-09-27 09:46:49,587][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-27 09:46:49,587][root][INFO] - Score: 71.02 [%]  |  Evaluation Time: 3.51 [s]
[2024-09-27 09:46:49,588][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-27 09:46:49,590][root][INFO] - 
[8/ 15 Epoch]
[2024-09-27 09:46:50,470][root][INFO] - Step: 631/1350  |  Loss: 0.6607  |  Score: 77.83 [%]  |  Seq Length: 256.0
[2024-09-27 09:46:55,830][root][INFO] - Step: 645/1350  |  Loss: 0.5624  |  Score: 85.17 [%]  |  Seq Length: 256.0
[2024-09-27 09:47:01,568][root][INFO] - Step: 660/1350  |  Loss: 0.5935  |  Score: 83.91 [%]  |  Seq Length: 256.0
[2024-09-27 09:47:07,308][root][INFO] - Step: 675/1350  |  Loss: 0.5381  |  Score: 84.56 [%]  |  Seq Length: 256.0
[2024-09-27 09:47:13,041][root][INFO] - Step: 690/1350  |  Loss: 0.5140  |  Score: 85.33 [%]  |  Seq Length: 256.0
[2024-09-27 09:47:18,772][root][INFO] - Step: 705/1350  |  Loss: 0.5702  |  Score: 81.90 [%]  |  Seq Length: 256.0
[2024-09-27 09:47:24,491][root][INFO] - Step: 720/1350  |  Loss: 0.5401  |  Score: 82.96 [%]  |  Seq Length: 256.0
[2024-09-27 09:47:28,262][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-27 09:47:28,262][root][INFO] - Score: 77.49 [%]  |  Evaluation Time: 3.77 [s]
[2024-09-27 09:47:31,842][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-27 09:47:31,842][root][INFO] - Score: 70.37 [%]  |  Evaluation Time: 3.58 [s]
[2024-09-27 09:47:31,843][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-27 09:47:31,844][root][INFO] - 
[9/ 15 Epoch]
[2024-09-27 09:47:32,516][root][INFO] - Step: 721/1350  |  Loss: 0.3790  |  Score: 86.26 [%]  |  Seq Length: 256.0
[2024-09-27 09:47:37,870][root][INFO] - Step: 735/1350  |  Loss: 0.4744  |  Score: 86.98 [%]  |  Seq Length: 256.0
[2024-09-27 09:47:43,596][root][INFO] - Step: 750/1350  |  Loss: 0.4744  |  Score: 85.50 [%]  |  Seq Length: 256.0
[2024-09-27 09:47:49,327][root][INFO] - Step: 765/1350  |  Loss: 0.5201  |  Score: 85.10 [%]  |  Seq Length: 256.0
[2024-09-27 09:47:55,060][root][INFO] - Step: 780/1350  |  Loss: 0.5772  |  Score: 84.15 [%]  |  Seq Length: 256.0
[2024-09-27 09:48:00,790][root][INFO] - Step: 795/1350  |  Loss: 0.5419  |  Score: 84.60 [%]  |  Seq Length: 256.0
[2024-09-27 09:48:06,513][root][INFO] - Step: 810/1350  |  Loss: 0.4918  |  Score: 85.39 [%]  |  Seq Length: 256.0
[2024-09-27 09:48:10,417][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-27 09:48:10,417][root][INFO] - Score: 76.84 [%]  |  Evaluation Time: 3.90 [s]
[2024-09-27 09:48:14,148][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-27 09:48:14,148][root][INFO] - Score: 71.16 [%]  |  Evaluation Time: 3.73 [s]
[2024-09-27 09:48:14,149][root][INFO] - 
Save new Best Score (Epoch: 9)
[2024-09-27 09:48:14,150][root][INFO] - 
[10/ 15 Epoch]
[2024-09-27 09:48:14,847][root][INFO] - Step: 811/1350  |  Loss: 0.4350  |  Score: 83.54 [%]  |  Seq Length: 256.0
[2024-09-27 09:48:20,203][root][INFO] - Step: 825/1350  |  Loss: 0.4390  |  Score: 88.41 [%]  |  Seq Length: 256.0
[2024-09-27 09:48:25,943][root][INFO] - Step: 840/1350  |  Loss: 0.4410  |  Score: 87.09 [%]  |  Seq Length: 256.0
[2024-09-27 09:48:31,672][root][INFO] - Step: 855/1350  |  Loss: 0.4482  |  Score: 86.30 [%]  |  Seq Length: 256.0
[2024-09-27 09:48:37,402][root][INFO] - Step: 870/1350  |  Loss: 0.4279  |  Score: 86.69 [%]  |  Seq Length: 256.0
[2024-09-27 09:48:43,127][root][INFO] - Step: 885/1350  |  Loss: 0.4584  |  Score: 86.72 [%]  |  Seq Length: 256.0
[2024-09-27 09:48:48,835][root][INFO] - Step: 900/1350  |  Loss: 0.4540  |  Score: 87.00 [%]  |  Seq Length: 256.0
[2024-09-27 09:48:52,641][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-27 09:48:52,642][root][INFO] - Score: 76.71 [%]  |  Evaluation Time: 3.80 [s]
[2024-09-27 09:48:56,329][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-27 09:48:56,329][root][INFO] - Score: 70.20 [%]  |  Evaluation Time: 3.69 [s]
[2024-09-27 09:48:56,331][root][INFO] - 
[11/ 15 Epoch]
[2024-09-27 09:48:57,191][root][INFO] - Step: 901/1350  |  Loss: 0.2867  |  Score: 91.04 [%]  |  Seq Length: 256.0
[2024-09-27 09:49:02,538][root][INFO] - Step: 915/1350  |  Loss: 0.4258  |  Score: 87.71 [%]  |  Seq Length: 256.0
[2024-09-27 09:49:08,266][root][INFO] - Step: 930/1350  |  Loss: 0.3832  |  Score: 88.31 [%]  |  Seq Length: 256.0
[2024-09-27 09:49:13,993][root][INFO] - Step: 945/1350  |  Loss: 0.3971  |  Score: 87.93 [%]  |  Seq Length: 256.0
[2024-09-27 09:49:19,718][root][INFO] - Step: 960/1350  |  Loss: 0.3819  |  Score: 87.78 [%]  |  Seq Length: 256.0
[2024-09-27 09:49:25,443][root][INFO] - Step: 975/1350  |  Loss: 0.4395  |  Score: 85.47 [%]  |  Seq Length: 256.0
[2024-09-27 09:49:31,167][root][INFO] - Step: 990/1350  |  Loss: 0.4233  |  Score: 87.88 [%]  |  Seq Length: 256.0
[2024-09-27 09:49:34,972][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-27 09:49:34,972][root][INFO] - Score: 76.96 [%]  |  Evaluation Time: 3.80 [s]
[2024-09-27 09:49:38,466][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-27 09:49:38,466][root][INFO] - Score: 70.69 [%]  |  Evaluation Time: 3.49 [s]
[2024-09-27 09:49:38,468][root][INFO] - 
[12/ 15 Epoch]
[2024-09-27 09:49:39,257][root][INFO] - Step: 991/1350  |  Loss: 0.4340  |  Score: 82.48 [%]  |  Seq Length: 256.0
[2024-09-27 09:49:44,604][root][INFO] - Step: 1005/1350  |  Loss: 0.3602  |  Score: 89.93 [%]  |  Seq Length: 256.0
[2024-09-27 09:49:50,332][root][INFO] - Step: 1020/1350  |  Loss: 0.3835  |  Score: 88.46 [%]  |  Seq Length: 256.0
[2024-09-27 09:49:56,063][root][INFO] - Step: 1035/1350  |  Loss: 0.3580  |  Score: 88.58 [%]  |  Seq Length: 256.0
[2024-09-27 09:50:01,795][root][INFO] - Step: 1050/1350  |  Loss: 0.3984  |  Score: 88.45 [%]  |  Seq Length: 256.0
[2024-09-27 09:50:07,524][root][INFO] - Step: 1065/1350  |  Loss: 0.3462  |  Score: 89.80 [%]  |  Seq Length: 256.0
[2024-09-27 09:50:13,238][root][INFO] - Step: 1080/1350  |  Loss: 0.4028  |  Score: 88.21 [%]  |  Seq Length: 256.0
[2024-09-27 09:50:17,113][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-27 09:50:17,113][root][INFO] - Score: 77.15 [%]  |  Evaluation Time: 3.87 [s]
[2024-09-27 09:50:20,628][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-27 09:50:20,628][root][INFO] - Score: 70.17 [%]  |  Evaluation Time: 3.51 [s]
[2024-09-27 09:50:20,630][root][INFO] - 
[13/ 15 Epoch]
[2024-09-27 09:50:21,318][root][INFO] - Step: 1081/1350  |  Loss: 0.2698  |  Score: 91.04 [%]  |  Seq Length: 256.0
[2024-09-27 09:50:26,668][root][INFO] - Step: 1095/1350  |  Loss: 0.3468  |  Score: 88.89 [%]  |  Seq Length: 256.0
[2024-09-27 09:50:32,398][root][INFO] - Step: 1110/1350  |  Loss: 0.4066  |  Score: 88.07 [%]  |  Seq Length: 256.0
[2024-09-27 09:50:38,128][root][INFO] - Step: 1125/1350  |  Loss: 0.3258  |  Score: 90.10 [%]  |  Seq Length: 256.0
[2024-09-27 09:50:43,858][root][INFO] - Step: 1140/1350  |  Loss: 0.3861  |  Score: 87.69 [%]  |  Seq Length: 256.0
[2024-09-27 09:50:49,588][root][INFO] - Step: 1155/1350  |  Loss: 0.3403  |  Score: 89.58 [%]  |  Seq Length: 256.0
[2024-09-27 09:50:55,308][root][INFO] - Step: 1170/1350  |  Loss: 0.3562  |  Score: 89.50 [%]  |  Seq Length: 256.0
[2024-09-27 09:50:59,176][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-27 09:50:59,176][root][INFO] - Score: 77.59 [%]  |  Evaluation Time: 3.86 [s]
[2024-09-27 09:51:02,842][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-27 09:51:02,842][root][INFO] - Score: 70.50 [%]  |  Evaluation Time: 3.66 [s]
[2024-09-27 09:51:02,843][root][INFO] - 
Save new Best Score (Epoch: 13)
[2024-09-27 09:51:02,844][root][INFO] - 
[14/ 15 Epoch]
[2024-09-27 09:51:03,536][root][INFO] - Step: 1171/1350  |  Loss: 0.5324  |  Score: 81.73 [%]  |  Seq Length: 256.0
[2024-09-27 09:51:08,884][root][INFO] - Step: 1185/1350  |  Loss: 0.3622  |  Score: 89.02 [%]  |  Seq Length: 256.0
[2024-09-27 09:51:14,612][root][INFO] - Step: 1200/1350  |  Loss: 0.3212  |  Score: 89.63 [%]  |  Seq Length: 256.0
[2024-09-27 09:51:20,340][root][INFO] - Step: 1215/1350  |  Loss: 0.3497  |  Score: 87.99 [%]  |  Seq Length: 256.0
[2024-09-27 09:51:26,067][root][INFO] - Step: 1230/1350  |  Loss: 0.3570  |  Score: 89.65 [%]  |  Seq Length: 256.0
[2024-09-27 09:51:31,792][root][INFO] - Step: 1245/1350  |  Loss: 0.3401  |  Score: 90.37 [%]  |  Seq Length: 256.0
[2024-09-27 09:51:37,507][root][INFO] - Step: 1260/1350  |  Loss: 0.3710  |  Score: 89.44 [%]  |  Seq Length: 256.0
[2024-09-27 09:51:41,337][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-27 09:51:41,337][root][INFO] - Score: 77.03 [%]  |  Evaluation Time: 3.83 [s]
[2024-09-27 09:51:44,882][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-27 09:51:44,882][root][INFO] - Score: 70.26 [%]  |  Evaluation Time: 3.54 [s]
[2024-09-27 09:51:44,884][root][INFO] - 
[15/ 15 Epoch]
[2024-09-27 09:51:45,622][root][INFO] - Step: 1261/1350  |  Loss: 0.4007  |  Score: 85.63 [%]  |  Seq Length: 256.0
[2024-09-27 09:51:50,974][root][INFO] - Step: 1275/1350  |  Loss: 0.3306  |  Score: 90.77 [%]  |  Seq Length: 256.0
[2024-09-27 09:51:56,701][root][INFO] - Step: 1290/1350  |  Loss: 0.3292  |  Score: 89.78 [%]  |  Seq Length: 256.0
[2024-09-27 09:52:02,430][root][INFO] - Step: 1305/1350  |  Loss: 0.3759  |  Score: 89.95 [%]  |  Seq Length: 256.0
[2024-09-27 09:52:08,159][root][INFO] - Step: 1320/1350  |  Loss: 0.3435  |  Score: 88.67 [%]  |  Seq Length: 256.0
[2024-09-27 09:52:13,890][root][INFO] - Step: 1335/1350  |  Loss: 0.3596  |  Score: 88.43 [%]  |  Seq Length: 256.0
[2024-09-27 09:52:19,604][root][INFO] - Step: 1350/1350  |  Loss: 0.3332  |  Score: 89.36 [%]  |  Seq Length: 256.0
[2024-09-27 09:52:23,410][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-27 09:52:23,410][root][INFO] - Score: 77.08 [%]  |  Evaluation Time: 3.80 [s]
[2024-09-27 09:52:26,950][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-27 09:52:26,950][root][INFO] - Score: 70.92 [%]  |  Evaluation Time: 3.54 [s]
[2024-09-27 09:52:26,952][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-27 09:52:26,952][root][INFO] - - Epoch: 13
[2024-09-27 09:52:26,952][root][INFO] - - DEV score: 77.59 [%]
[2024-09-27 09:52:26,952][root][INFO] - - TEST score: 70.50 [%]
[2024-09-27 09:52:26,953][root][INFO] - Fine-tuning is done!
[2024-09-27 09:52:33,503][root][INFO] - 

[2024-09-27 09:52:33,503][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-27 09:52:33,503][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs
[2024-09-27 09:52:33,503][root][INFO] - 

[2024-09-27 09:52:33,504][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en', 'do_hangeulize': True, 'data_remove': False, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-27 09:52:38,405][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-27 09:52:38,406][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-27 09:52:38,406][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-27 09:52:38,407][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-27 09:52:38,407][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-27 09:52:38,408][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-27 09:52:38,409][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-27 09:52:38,409][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-27 09:52:38,410][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-27 09:52:38,410][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-27 09:52:38,411][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-27 09:52:38,411][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-27 09:52:38,412][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-27 09:52:38,412][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-27 09:52:38,413][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-27 09:52:38,413][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-27 09:52:38,414][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-27 09:52:38,414][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-27 09:52:38,415][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-27 09:52:38,415][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-27 09:52:38,416][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-27 09:52:38,417][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-27 09:52:38,417][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-27 09:52:38,418][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-27 09:52:38,420][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-27 09:52:38,425][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-27 09:52:38,534][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-27 09:52:38,536][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-27 09:52:38,714][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-27 09:52:45,846][root][INFO] - 

[2024-09-27 09:52:45,847][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-27 09:52:45,847][root][INFO] - Data Preprocessing
[2024-09-27 09:52:45,847][root][INFO] - ㄴ remain_lang                ko_en
[2024-09-27 09:52:45,847][root][INFO] - ㄴ do_hangeulize              True
[2024-09-27 09:52:45,847][root][INFO] - ㄴ data_remove                False

[2024-09-27 09:52:45,847][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-27 09:52:45,855][root][INFO] - vocab size              : 51200
[2024-09-27 09:52:45,855][root][INFO] - device                  : gpu
[2024-09-27 09:52:45,855][root][INFO] - random seed             : 42
[2024-09-27 09:52:45,856][root][INFO] - train data size         : 5760
[2024-09-27 09:52:45,856][root][INFO] - max epochs              : 15
[2024-09-27 09:52:45,856][root][INFO] - total steps             : 1350
[2024-09-27 09:52:45,856][root][INFO] - warmup steps            : 135
[2024-09-27 09:52:45,856][root][INFO] - batch size              : 64
[2024-09-27 09:52:45,856][root][INFO] - accumulation steps      : 1
[2024-09-27 09:52:45,856][root][INFO] - optimizer               : adamwscale
[2024-09-27 09:52:45,856][root][INFO] - lr_scheduler            : cosine
[2024-09-27 09:52:45,856][root][INFO] - learning rate           : 0.01
[2024-09-27 09:52:45,856][root][INFO] - max length              : 256

[2024-09-27 09:52:45,856][root][INFO] - LoRA Configuration
[2024-09-27 09:52:45,856][root][INFO] - ㄴ r                    : 32
[2024-09-27 09:52:45,857][root][INFO] - ㄴ alpha                : 128
[2024-09-27 09:52:45,857][root][INFO] - ㄴ dropout              : 0.03

[2024-09-27 09:52:45,857][root][INFO] - KOMBO Configuration
[2024-09-27 09:52:45,857][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-27 09:52:45,857][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-27 09:52:45,857][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-27 09:52:45,857][root][INFO] - ㄴ do_combination       : True
[2024-09-27 09:52:45,857][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-27 09:52:45,857][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-27 09:52:45,857][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-27 09:52:45,858][root][INFO] -   ㄴ add_lora           : True

[2024-09-27 09:52:45,858][root][INFO] - LoRA in KOMBO Configuration
[2024-09-27 09:52:45,858][root][INFO] - ㄴ r                : 32
[2024-09-27 09:52:45,858][root][INFO] - ㄴ alpha            : 128
[2024-09-27 09:52:45,858][root][INFO] - ㄴ dropout          : 0.03

[2024-09-27 09:52:45,858][root][INFO] - 

[2024-09-27 09:52:45,858][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs
[2024-09-27 09:52:45,858][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-27 09:52:45,858][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/tb
[2024-09-27 09:52:45,858][root][INFO] - * tb interval   : 15

[2024-09-27 09:52:45,858][root][INFO] - 

[2024-09-27 09:52:45,858][root][INFO] - Start the Training !
[2024-09-27 09:52:45,862][root][INFO] - 
[1/ 15 Epoch]
[2024-09-27 09:52:55,821][root][INFO] - Step: 15/1350  |  Loss: 3.7926  |  Score: -3.61 [%]  |  Seq Length: 256.0
[2024-09-27 09:53:03,863][root][INFO] - Step: 30/1350  |  Loss: 2.2117  |  Score: 19.52 [%]  |  Seq Length: 256.0
[2024-09-27 09:53:11,869][root][INFO] - Step: 45/1350  |  Loss: 1.9260  |  Score: 27.58 [%]  |  Seq Length: 256.0
[2024-09-27 09:53:19,897][root][INFO] - Step: 60/1350  |  Loss: 1.8475  |  Score: 49.00 [%]  |  Seq Length: 256.0
[2024-09-27 09:53:27,926][root][INFO] - Step: 75/1350  |  Loss: 1.6420  |  Score: 51.62 [%]  |  Seq Length: 256.0
[2024-09-27 09:53:36,158][root][INFO] - Step: 90/1350  |  Loss: 1.4416  |  Score: 53.48 [%]  |  Seq Length: 256.0
[2024-09-27 09:53:42,467][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-27 09:53:42,467][root][INFO] - Score: 69.20 [%]  |  Evaluation Time: 6.31 [s]
[2024-09-27 09:53:48,235][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-27 09:53:48,235][root][INFO] - Score: 62.82 [%]  |  Evaluation Time: 5.77 [s]
[2024-09-27 09:53:48,236][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-27 09:53:48,238][root][INFO] - 
[2/ 15 Epoch]
[2024-09-27 09:53:49,191][root][INFO] - Step: 91/1350  |  Loss: 1.3412  |  Score: 63.13 [%]  |  Seq Length: 256.0
[2024-09-27 09:53:56,697][root][INFO] - Step: 105/1350  |  Loss: 1.5349  |  Score: 58.11 [%]  |  Seq Length: 256.0
[2024-09-27 09:54:04,743][root][INFO] - Step: 120/1350  |  Loss: 1.2128  |  Score: 62.10 [%]  |  Seq Length: 256.0
[2024-09-27 09:54:12,809][root][INFO] - Step: 135/1350  |  Loss: 1.2434  |  Score: 63.82 [%]  |  Seq Length: 256.0
[2024-09-27 09:54:20,841][root][INFO] - Step: 150/1350  |  Loss: 1.1358  |  Score: 65.08 [%]  |  Seq Length: 256.0
[2024-09-27 09:54:28,932][root][INFO] - Step: 165/1350  |  Loss: 1.1777  |  Score: 65.71 [%]  |  Seq Length: 256.0
[2024-09-27 09:54:36,916][root][INFO] - Step: 180/1350  |  Loss: 1.3338  |  Score: 62.84 [%]  |  Seq Length: 256.0
[2024-09-27 09:54:43,198][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-27 09:54:43,198][root][INFO] - Score: 75.31 [%]  |  Evaluation Time: 6.28 [s]
[2024-09-27 09:54:48,957][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-27 09:54:48,957][root][INFO] - Score: 69.10 [%]  |  Evaluation Time: 5.76 [s]
[2024-09-27 09:54:48,958][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-27 09:54:48,959][root][INFO] - 
[3/ 15 Epoch]
[2024-09-27 09:54:49,909][root][INFO] - Step: 181/1350  |  Loss: 1.0809  |  Score: 70.82 [%]  |  Seq Length: 256.0
[2024-09-27 09:54:57,422][root][INFO] - Step: 195/1350  |  Loss: 1.0570  |  Score: 66.34 [%]  |  Seq Length: 256.0
[2024-09-27 09:55:05,502][root][INFO] - Step: 210/1350  |  Loss: 1.1531  |  Score: 66.12 [%]  |  Seq Length: 256.0
[2024-09-27 09:55:13,468][root][INFO] - Step: 225/1350  |  Loss: 1.1471  |  Score: 69.94 [%]  |  Seq Length: 256.0
[2024-09-27 09:55:21,504][root][INFO] - Step: 240/1350  |  Loss: 1.0099  |  Score: 67.61 [%]  |  Seq Length: 256.0
[2024-09-27 09:55:29,493][root][INFO] - Step: 255/1350  |  Loss: 1.0556  |  Score: 70.02 [%]  |  Seq Length: 256.0
[2024-09-27 09:55:37,526][root][INFO] - Step: 270/1350  |  Loss: 0.9581  |  Score: 71.92 [%]  |  Seq Length: 256.0
[2024-09-27 09:55:43,736][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-27 09:55:43,736][root][INFO] - Score: 76.02 [%]  |  Evaluation Time: 6.21 [s]
[2024-09-27 09:55:49,483][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-27 09:55:49,483][root][INFO] - Score: 68.83 [%]  |  Evaluation Time: 5.74 [s]
[2024-09-27 09:55:49,484][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-27 09:55:49,485][root][INFO] - 
[4/ 15 Epoch]
[2024-09-27 09:55:50,491][root][INFO] - Step: 271/1350  |  Loss: 0.9126  |  Score: 66.50 [%]  |  Seq Length: 256.0
[2024-09-27 09:55:58,036][root][INFO] - Step: 285/1350  |  Loss: 0.8482  |  Score: 74.61 [%]  |  Seq Length: 256.0
[2024-09-27 09:56:06,111][root][INFO] - Step: 300/1350  |  Loss: 1.0027  |  Score: 73.88 [%]  |  Seq Length: 256.0
[2024-09-27 09:56:14,083][root][INFO] - Step: 315/1350  |  Loss: 1.0338  |  Score: 72.70 [%]  |  Seq Length: 256.0
[2024-09-27 09:56:22,102][root][INFO] - Step: 330/1350  |  Loss: 0.8612  |  Score: 74.52 [%]  |  Seq Length: 256.0
[2024-09-27 09:56:30,041][root][INFO] - Step: 345/1350  |  Loss: 0.9440  |  Score: 70.91 [%]  |  Seq Length: 256.0
[2024-09-27 09:56:37,977][root][INFO] - Step: 360/1350  |  Loss: 0.9336  |  Score: 73.75 [%]  |  Seq Length: 256.0
[2024-09-27 09:56:44,137][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-27 09:56:44,138][root][INFO] - Score: 77.58 [%]  |  Evaluation Time: 6.16 [s]
[2024-09-27 09:56:49,866][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-27 09:56:49,866][root][INFO] - Score: 70.42 [%]  |  Evaluation Time: 5.73 [s]
[2024-09-27 09:56:49,867][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-27 09:56:49,869][root][INFO] - 
[5/ 15 Epoch]
[2024-09-27 09:56:50,941][root][INFO] - Step: 361/1350  |  Loss: 0.9039  |  Score: 68.34 [%]  |  Seq Length: 256.0
[2024-09-27 09:56:58,380][root][INFO] - Step: 375/1350  |  Loss: 0.7993  |  Score: 77.59 [%]  |  Seq Length: 256.0
[2024-09-27 09:57:06,370][root][INFO] - Step: 390/1350  |  Loss: 0.7732  |  Score: 79.01 [%]  |  Seq Length: 256.0
[2024-09-27 09:57:14,444][root][INFO] - Step: 405/1350  |  Loss: 0.7169  |  Score: 75.85 [%]  |  Seq Length: 256.0
[2024-09-27 09:57:22,409][root][INFO] - Step: 420/1350  |  Loss: 0.7993  |  Score: 73.68 [%]  |  Seq Length: 256.0
[2024-09-27 09:57:30,462][root][INFO] - Step: 435/1350  |  Loss: 0.7452  |  Score: 79.20 [%]  |  Seq Length: 256.0
[2024-09-27 09:57:38,439][root][INFO] - Step: 450/1350  |  Loss: 0.8310  |  Score: 75.46 [%]  |  Seq Length: 256.0
[2024-09-27 09:57:44,764][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-27 09:57:44,764][root][INFO] - Score: 77.94 [%]  |  Evaluation Time: 6.32 [s]
[2024-09-27 09:57:50,687][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-27 09:57:50,687][root][INFO] - Score: 70.40 [%]  |  Evaluation Time: 5.92 [s]
[2024-09-27 09:57:50,688][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-27 09:57:50,689][root][INFO] - 
[6/ 15 Epoch]
[2024-09-27 09:57:51,707][root][INFO] - Step: 451/1350  |  Loss: 0.9647  |  Score: 80.66 [%]  |  Seq Length: 256.0
[2024-09-27 09:57:59,241][root][INFO] - Step: 465/1350  |  Loss: 0.7287  |  Score: 80.78 [%]  |  Seq Length: 256.0
[2024-09-27 09:58:07,228][root][INFO] - Step: 480/1350  |  Loss: 0.6831  |  Score: 82.57 [%]  |  Seq Length: 256.0
[2024-09-27 09:58:15,237][root][INFO] - Step: 495/1350  |  Loss: 0.7925  |  Score: 78.93 [%]  |  Seq Length: 256.0
[2024-09-27 09:58:23,203][root][INFO] - Step: 510/1350  |  Loss: 0.7603  |  Score: 77.49 [%]  |  Seq Length: 256.0
[2024-09-27 09:58:31,190][root][INFO] - Step: 525/1350  |  Loss: 0.7333  |  Score: 80.01 [%]  |  Seq Length: 256.0
[2024-09-27 09:58:39,227][root][INFO] - Step: 540/1350  |  Loss: 0.7152  |  Score: 79.48 [%]  |  Seq Length: 256.0
[2024-09-27 09:58:45,509][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-27 09:58:45,509][root][INFO] - Score: 78.00 [%]  |  Evaluation Time: 6.28 [s]
[2024-09-27 09:58:51,313][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-27 09:58:51,313][root][INFO] - Score: 70.07 [%]  |  Evaluation Time: 5.80 [s]
[2024-09-27 09:58:51,316][root][INFO] - 
[7/ 15 Epoch]
[2024-09-27 09:58:52,260][root][INFO] - Step: 541/1350  |  Loss: 0.7657  |  Score: 81.21 [%]  |  Seq Length: 256.0
[2024-09-27 09:58:59,740][root][INFO] - Step: 555/1350  |  Loss: 0.6360  |  Score: 79.31 [%]  |  Seq Length: 256.0
[2024-09-27 09:59:07,741][root][INFO] - Step: 570/1350  |  Loss: 0.6609  |  Score: 80.81 [%]  |  Seq Length: 256.0
[2024-09-27 09:59:15,773][root][INFO] - Step: 585/1350  |  Loss: 0.5858  |  Score: 82.46 [%]  |  Seq Length: 256.0
[2024-09-27 09:59:23,718][root][INFO] - Step: 600/1350  |  Loss: 0.6177  |  Score: 80.34 [%]  |  Seq Length: 256.0
[2024-09-27 09:59:31,800][root][INFO] - Step: 615/1350  |  Loss: 0.6488  |  Score: 82.14 [%]  |  Seq Length: 256.0
[2024-09-27 09:59:39,813][root][INFO] - Step: 630/1350  |  Loss: 0.6709  |  Score: 80.52 [%]  |  Seq Length: 256.0
[2024-09-27 09:59:46,161][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-27 09:59:46,161][root][INFO] - Score: 77.55 [%]  |  Evaluation Time: 6.34 [s]
[2024-09-27 09:59:51,910][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-27 09:59:51,910][root][INFO] - Score: 70.48 [%]  |  Evaluation Time: 5.75 [s]
[2024-09-27 09:59:51,913][root][INFO] - 
[8/ 15 Epoch]
[2024-09-27 09:59:52,842][root][INFO] - Step: 631/1350  |  Loss: 0.4267  |  Score: 91.65 [%]  |  Seq Length: 256.0
[2024-09-27 10:00:00,295][root][INFO] - Step: 645/1350  |  Loss: 0.5576  |  Score: 85.51 [%]  |  Seq Length: 256.0
[2024-09-27 10:00:08,338][root][INFO] - Step: 660/1350  |  Loss: 0.5254  |  Score: 84.27 [%]  |  Seq Length: 256.0
[2024-09-27 10:00:16,282][root][INFO] - Step: 675/1350  |  Loss: 0.5043  |  Score: 83.93 [%]  |  Seq Length: 256.0
[2024-09-27 10:00:24,261][root][INFO] - Step: 690/1350  |  Loss: 0.5949  |  Score: 82.95 [%]  |  Seq Length: 256.0
[2024-09-27 10:00:32,312][root][INFO] - Step: 705/1350  |  Loss: 0.5643  |  Score: 82.28 [%]  |  Seq Length: 256.0
[2024-09-27 10:00:40,347][root][INFO] - Step: 720/1350  |  Loss: 0.5745  |  Score: 82.96 [%]  |  Seq Length: 256.0
[2024-09-27 10:00:46,595][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-27 10:00:46,595][root][INFO] - Score: 77.58 [%]  |  Evaluation Time: 6.24 [s]
[2024-09-27 10:00:52,257][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-27 10:00:52,257][root][INFO] - Score: 70.31 [%]  |  Evaluation Time: 5.66 [s]
[2024-09-27 10:00:52,260][root][INFO] - 
[9/ 15 Epoch]
[2024-09-27 10:00:53,286][root][INFO] - Step: 721/1350  |  Loss: 0.2657  |  Score: 90.69 [%]  |  Seq Length: 256.0
[2024-09-27 10:01:00,886][root][INFO] - Step: 735/1350  |  Loss: 0.5039  |  Score: 85.49 [%]  |  Seq Length: 256.0
[2024-09-27 10:01:09,003][root][INFO] - Step: 750/1350  |  Loss: 0.4991  |  Score: 84.84 [%]  |  Seq Length: 256.0
[2024-09-27 10:01:17,019][root][INFO] - Step: 765/1350  |  Loss: 0.4947  |  Score: 85.74 [%]  |  Seq Length: 256.0
[2024-09-27 10:01:25,162][root][INFO] - Step: 780/1350  |  Loss: 0.4557  |  Score: 86.78 [%]  |  Seq Length: 256.0
[2024-09-27 10:01:33,269][root][INFO] - Step: 795/1350  |  Loss: 0.4709  |  Score: 85.32 [%]  |  Seq Length: 256.0
[2024-09-27 10:01:41,314][root][INFO] - Step: 810/1350  |  Loss: 0.4686  |  Score: 86.16 [%]  |  Seq Length: 256.0
[2024-09-27 10:01:47,687][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-27 10:01:47,687][root][INFO] - Score: 77.23 [%]  |  Evaluation Time: 6.37 [s]
[2024-09-27 10:01:53,376][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-27 10:01:53,376][root][INFO] - Score: 70.33 [%]  |  Evaluation Time: 5.69 [s]
[2024-09-27 10:01:53,380][root][INFO] - 
[10/ 15 Epoch]
[2024-09-27 10:01:54,284][root][INFO] - Step: 811/1350  |  Loss: 0.4537  |  Score: 89.47 [%]  |  Seq Length: 256.0
[2024-09-27 10:02:01,905][root][INFO] - Step: 825/1350  |  Loss: 0.5093  |  Score: 86.71 [%]  |  Seq Length: 256.0
[2024-09-27 10:02:09,962][root][INFO] - Step: 840/1350  |  Loss: 0.4755  |  Score: 88.07 [%]  |  Seq Length: 256.0
[2024-09-27 10:02:18,027][root][INFO] - Step: 855/1350  |  Loss: 0.4781  |  Score: 87.60 [%]  |  Seq Length: 256.0
[2024-09-27 10:02:26,096][root][INFO] - Step: 870/1350  |  Loss: 0.4438  |  Score: 88.47 [%]  |  Seq Length: 256.0
[2024-09-27 10:02:34,188][root][INFO] - Step: 885/1350  |  Loss: 0.4388  |  Score: 86.14 [%]  |  Seq Length: 256.0
[2024-09-27 10:02:42,211][root][INFO] - Step: 900/1350  |  Loss: 0.4638  |  Score: 84.94 [%]  |  Seq Length: 256.0
[2024-09-27 10:02:48,480][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-27 10:02:48,480][root][INFO] - Score: 77.12 [%]  |  Evaluation Time: 6.27 [s]
[2024-09-27 10:02:54,183][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-27 10:02:54,183][root][INFO] - Score: 70.88 [%]  |  Evaluation Time: 5.70 [s]
[2024-09-27 10:02:54,187][root][INFO] - 
[11/ 15 Epoch]
[2024-09-27 10:02:55,217][root][INFO] - Step: 901/1350  |  Loss: 0.3118  |  Score: 84.21 [%]  |  Seq Length: 256.0
[2024-09-27 10:03:02,755][root][INFO] - Step: 915/1350  |  Loss: 0.4503  |  Score: 85.70 [%]  |  Seq Length: 256.0
[2024-09-27 10:03:10,751][root][INFO] - Step: 930/1350  |  Loss: 0.4020  |  Score: 88.73 [%]  |  Seq Length: 256.0
[2024-09-27 10:03:18,800][root][INFO] - Step: 945/1350  |  Loss: 0.3928  |  Score: 87.71 [%]  |  Seq Length: 256.0
[2024-09-27 10:03:26,851][root][INFO] - Step: 960/1350  |  Loss: 0.4425  |  Score: 88.29 [%]  |  Seq Length: 256.0
[2024-09-27 10:03:34,888][root][INFO] - Step: 975/1350  |  Loss: 0.3931  |  Score: 86.67 [%]  |  Seq Length: 256.0
[2024-09-27 10:03:42,881][root][INFO] - Step: 990/1350  |  Loss: 0.4035  |  Score: 88.30 [%]  |  Seq Length: 256.0
[2024-09-27 10:03:49,205][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-27 10:03:49,205][root][INFO] - Score: 77.69 [%]  |  Evaluation Time: 6.32 [s]
[2024-09-27 10:03:55,037][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-27 10:03:55,037][root][INFO] - Score: 69.62 [%]  |  Evaluation Time: 5.83 [s]
[2024-09-27 10:03:55,039][root][INFO] - 
[12/ 15 Epoch]
[2024-09-27 10:03:55,901][root][INFO] - Step: 991/1350  |  Loss: 0.3962  |  Score: 90.45 [%]  |  Seq Length: 256.0
[2024-09-27 10:04:03,448][root][INFO] - Step: 1005/1350  |  Loss: 0.4025  |  Score: 89.26 [%]  |  Seq Length: 256.0
[2024-09-27 10:04:11,426][root][INFO] - Step: 1020/1350  |  Loss: 0.3792  |  Score: 89.20 [%]  |  Seq Length: 256.0
[2024-09-27 10:04:19,550][root][INFO] - Step: 1035/1350  |  Loss: 0.4116  |  Score: 88.15 [%]  |  Seq Length: 256.0
[2024-09-27 10:04:27,647][root][INFO] - Step: 1050/1350  |  Loss: 0.3841  |  Score: 87.22 [%]  |  Seq Length: 256.0
[2024-09-27 10:04:35,671][root][INFO] - Step: 1065/1350  |  Loss: 0.3816  |  Score: 88.20 [%]  |  Seq Length: 256.0
[2024-09-27 10:04:43,696][root][INFO] - Step: 1080/1350  |  Loss: 0.3541  |  Score: 88.70 [%]  |  Seq Length: 256.0
[2024-09-27 10:04:50,087][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-27 10:04:50,087][root][INFO] - Score: 78.48 [%]  |  Evaluation Time: 6.39 [s]
[2024-09-27 10:04:55,730][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-27 10:04:55,730][root][INFO] - Score: 70.14 [%]  |  Evaluation Time: 5.64 [s]
[2024-09-27 10:04:55,732][root][INFO] - 
Save new Best Score (Epoch: 12)
[2024-09-27 10:04:55,733][root][INFO] - 
[13/ 15 Epoch]
[2024-09-27 10:04:56,635][root][INFO] - Step: 1081/1350  |  Loss: 0.3176  |  Score: 91.50 [%]  |  Seq Length: 256.0
[2024-09-27 10:05:04,158][root][INFO] - Step: 1095/1350  |  Loss: 0.3550  |  Score: 90.12 [%]  |  Seq Length: 256.0
[2024-09-27 10:05:12,239][root][INFO] - Step: 1110/1350  |  Loss: 0.3687  |  Score: 88.16 [%]  |  Seq Length: 256.0
[2024-09-27 10:05:20,248][root][INFO] - Step: 1125/1350  |  Loss: 0.3348  |  Score: 90.21 [%]  |  Seq Length: 256.0
[2024-09-27 10:05:28,405][root][INFO] - Step: 1140/1350  |  Loss: 0.3598  |  Score: 89.45 [%]  |  Seq Length: 256.0
[2024-09-27 10:05:36,344][root][INFO] - Step: 1155/1350  |  Loss: 0.3918  |  Score: 88.82 [%]  |  Seq Length: 256.0
[2024-09-27 10:05:44,367][root][INFO] - Step: 1170/1350  |  Loss: 0.3570  |  Score: 89.17 [%]  |  Seq Length: 256.0
[2024-09-27 10:05:50,756][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-27 10:05:50,757][root][INFO] - Score: 77.33 [%]  |  Evaluation Time: 6.39 [s]
[2024-09-27 10:05:56,527][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-27 10:05:56,528][root][INFO] - Score: 70.87 [%]  |  Evaluation Time: 5.77 [s]
[2024-09-27 10:05:56,530][root][INFO] - 
[14/ 15 Epoch]
[2024-09-27 10:05:57,443][root][INFO] - Step: 1171/1350  |  Loss: 0.4007  |  Score: 90.91 [%]  |  Seq Length: 256.0
[2024-09-27 10:06:04,953][root][INFO] - Step: 1185/1350  |  Loss: 0.3774  |  Score: 89.17 [%]  |  Seq Length: 256.0
[2024-09-27 10:06:13,020][root][INFO] - Step: 1200/1350  |  Loss: 0.3314  |  Score: 90.28 [%]  |  Seq Length: 256.0
[2024-09-27 10:06:21,005][root][INFO] - Step: 1215/1350  |  Loss: 0.3710  |  Score: 89.59 [%]  |  Seq Length: 256.0
[2024-09-27 10:06:29,151][root][INFO] - Step: 1230/1350  |  Loss: 0.3784  |  Score: 88.26 [%]  |  Seq Length: 256.0
[2024-09-27 10:06:37,194][root][INFO] - Step: 1245/1350  |  Loss: 0.3206  |  Score: 90.10 [%]  |  Seq Length: 256.0
[2024-09-27 10:06:45,366][root][INFO] - Step: 1260/1350  |  Loss: 0.3102  |  Score: 90.31 [%]  |  Seq Length: 256.0
[2024-09-27 10:06:51,759][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-27 10:06:51,760][root][INFO] - Score: 78.08 [%]  |  Evaluation Time: 6.39 [s]
[2024-09-27 10:06:57,418][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-27 10:06:57,418][root][INFO] - Score: 70.65 [%]  |  Evaluation Time: 5.66 [s]
[2024-09-27 10:06:57,419][root][INFO] - 
Save new Best Score (Epoch: 14)
[2024-09-27 10:06:57,420][root][INFO] - 
[15/ 15 Epoch]
[2024-09-27 10:06:58,346][root][INFO] - Step: 1261/1350  |  Loss: 0.4100  |  Score: 87.75 [%]  |  Seq Length: 256.0
[2024-09-27 10:07:05,765][root][INFO] - Step: 1275/1350  |  Loss: 0.3512  |  Score: 90.15 [%]  |  Seq Length: 256.0
[2024-09-27 10:07:13,742][root][INFO] - Step: 1290/1350  |  Loss: 0.3433  |  Score: 88.60 [%]  |  Seq Length: 256.0
[2024-09-27 10:07:21,791][root][INFO] - Step: 1305/1350  |  Loss: 0.3329  |  Score: 89.99 [%]  |  Seq Length: 256.0
[2024-09-27 10:07:29,764][root][INFO] - Step: 1320/1350  |  Loss: 0.3564  |  Score: 89.76 [%]  |  Seq Length: 256.0
[2024-09-27 10:07:37,753][root][INFO] - Step: 1335/1350  |  Loss: 0.3078  |  Score: 90.59 [%]  |  Seq Length: 256.0
[2024-09-27 10:07:45,739][root][INFO] - Step: 1350/1350  |  Loss: 0.3692  |  Score: 90.64 [%]  |  Seq Length: 256.0
[2024-09-27 10:07:52,031][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-27 10:07:52,031][root][INFO] - Score: 78.06 [%]  |  Evaluation Time: 6.29 [s]
[2024-09-27 10:07:57,922][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-27 10:07:57,923][root][INFO] - Score: 70.38 [%]  |  Evaluation Time: 5.89 [s]
[2024-09-27 10:07:57,924][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-27 10:07:57,924][root][INFO] - - Epoch: 14
[2024-09-27 10:07:57,924][root][INFO] - - DEV score: 78.08 [%]
[2024-09-27 10:07:57,924][root][INFO] - - TEST score: 70.65 [%]
[2024-09-27 10:07:57,925][root][INFO] - Fine-tuning is done!
[2024-09-27 10:08:04,552][root][INFO] - 

[2024-09-27 10:08:04,552][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-27 10:08:04,552][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs
[2024-09-27 10:08:04,552][root][INFO] - 

[2024-09-27 10:08:04,552][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en', 'do_hangeulize': False, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-27 10:08:08,321][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-27 10:08:08,322][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-27 10:08:08,322][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-27 10:08:08,323][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-27 10:08:08,323][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-27 10:08:08,324][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-27 10:08:08,325][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-27 10:08:08,325][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-27 10:08:08,326][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-27 10:08:08,327][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-27 10:08:08,327][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-27 10:08:08,328][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-27 10:08:08,328][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-27 10:08:08,329][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-27 10:08:08,330][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-27 10:08:08,330][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-27 10:08:08,331][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-27 10:08:08,332][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-27 10:08:08,333][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-27 10:08:08,333][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-27 10:08:08,334][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-27 10:08:08,335][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-27 10:08:08,336][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-27 10:08:08,336][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-27 10:08:08,339][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-27 10:08:08,522][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-27 10:08:12,796][root][INFO] - 

[2024-09-27 10:08:12,796][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-27 10:08:12,796][root][INFO] - Data Preprocessing
[2024-09-27 10:08:12,796][root][INFO] - ㄴ remain_lang                ko_en
[2024-09-27 10:08:12,796][root][INFO] - ㄴ do_hangeulize              False
[2024-09-27 10:08:12,796][root][INFO] - ㄴ data_remove                True

[2024-09-27 10:08:12,797][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-27 10:08:12,805][root][INFO] - vocab size              : 51200
[2024-09-27 10:08:12,805][root][INFO] - device                  : gpu
[2024-09-27 10:08:12,806][root][INFO] - random seed             : 42
[2024-09-27 10:08:12,806][root][INFO] - train data size         : 448
[2024-09-27 10:08:12,806][root][INFO] - max epochs              : 15
[2024-09-27 10:08:12,806][root][INFO] - total steps             : 105
[2024-09-27 10:08:12,806][root][INFO] - warmup steps            : 10
[2024-09-27 10:08:12,806][root][INFO] - batch size              : 64
[2024-09-27 10:08:12,806][root][INFO] - accumulation steps      : 1
[2024-09-27 10:08:12,806][root][INFO] - optimizer               : adamwscale
[2024-09-27 10:08:12,806][root][INFO] - lr_scheduler            : cosine
[2024-09-27 10:08:12,806][root][INFO] - learning rate           : 0.01
[2024-09-27 10:08:12,806][root][INFO] - max length              : 256

[2024-09-27 10:08:12,807][root][INFO] - LoRA Configuration
[2024-09-27 10:08:12,807][root][INFO] - ㄴ r                    : 32
[2024-09-27 10:08:12,807][root][INFO] - ㄴ alpha                : 128
[2024-09-27 10:08:12,807][root][INFO] - ㄴ dropout              : 0.03

[2024-09-27 10:08:12,807][root][INFO] - 

[2024-09-27 10:08:12,807][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs
[2024-09-27 10:08:12,807][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-27 10:08:12,807][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/tb
[2024-09-27 10:08:12,807][root][INFO] - * tb interval   : 15

[2024-09-27 10:08:12,807][root][INFO] - 

[2024-09-27 10:08:12,807][root][INFO] - Start the Training !
[2024-09-27 10:08:12,810][root][INFO] - 
[1/ 15 Epoch]
[2024-09-27 10:08:18,407][root][INFO] - Step: 7/105  |  Loss: 5.0150  |  Score: 0.42 [%]  |  Seq Length: 256.0
[2024-09-27 10:08:18,877][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-27 10:08:18,877][root][INFO] - Score: -0.32 [%]  |  Evaluation Time: 0.47 [s]
[2024-09-27 10:08:19,316][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-27 10:08:19,316][root][INFO] - Score: -6.45 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 10:08:19,318][root][INFO] - 
[2/ 15 Epoch]
[2024-09-27 10:08:22,283][root][INFO] - Step: 14/105  |  Loss: 3.1269  |  Score: 11.34 [%]  |  Seq Length: 256.0
[2024-09-27 10:08:22,767][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-27 10:08:22,767][root][INFO] - Score: -3.24 [%]  |  Evaluation Time: 0.48 [s]
[2024-09-27 10:08:23,225][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-27 10:08:23,226][root][INFO] - Score: 3.80 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-27 10:08:23,227][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-27 10:08:23,228][root][INFO] - 
[3/ 15 Epoch]
[2024-09-27 10:08:24,063][root][INFO] - Step: 15/105  |  Loss: 2.8361  |  Score: 15.18 [%]  |  Seq Length: 256.0
[2024-09-27 10:08:26,310][root][INFO] - Step: 21/105  |  Loss: 2.1850  |  Score: 31.25 [%]  |  Seq Length: 256.0
[2024-09-27 10:08:26,780][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-27 10:08:26,780][root][INFO] - Score: 11.97 [%]  |  Evaluation Time: 0.47 [s]
[2024-09-27 10:08:27,225][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-27 10:08:27,225][root][INFO] - Score: 12.94 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 10:08:27,226][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-27 10:08:27,227][root][INFO] - 
[4/ 15 Epoch]
[2024-09-27 10:08:30,198][root][INFO] - Step: 28/105  |  Loss: 1.9981  |  Score: 46.47 [%]  |  Seq Length: 256.0
[2024-09-27 10:08:30,685][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-27 10:08:30,685][root][INFO] - Score: 18.63 [%]  |  Evaluation Time: 0.48 [s]
[2024-09-27 10:08:31,143][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-27 10:08:31,143][root][INFO] - Score: 19.45 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-27 10:08:31,145][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-27 10:08:31,146][root][INFO] - 
[5/ 15 Epoch]
[2024-09-27 10:08:32,252][root][INFO] - Step: 30/105  |  Loss: 1.2705  |  Score: 66.97 [%]  |  Seq Length: 256.0
[2024-09-27 10:08:34,147][root][INFO] - Step: 35/105  |  Loss: 1.6389  |  Score: 57.38 [%]  |  Seq Length: 256.0
[2024-09-27 10:08:34,638][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-27 10:08:34,639][root][INFO] - Score: 32.30 [%]  |  Evaluation Time: 0.49 [s]
[2024-09-27 10:08:35,082][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-27 10:08:35,083][root][INFO] - Score: 28.87 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 10:08:35,083][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-27 10:08:35,085][root][INFO] - 
[6/ 15 Epoch]
[2024-09-27 10:08:38,175][root][INFO] - Step: 42/105  |  Loss: 1.3463  |  Score: 66.14 [%]  |  Seq Length: 256.0
[2024-09-27 10:08:38,627][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-27 10:08:38,627][root][INFO] - Score: 39.61 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-27 10:08:39,056][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-27 10:08:39,056][root][INFO] - Score: 31.62 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 10:08:39,058][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-27 10:08:39,059][root][INFO] - 
[7/ 15 Epoch]
[2024-09-27 10:08:40,556][root][INFO] - Step: 45/105  |  Loss: 1.1586  |  Score: 71.62 [%]  |  Seq Length: 256.0
[2024-09-27 10:08:42,027][root][INFO] - Step: 49/105  |  Loss: 1.2581  |  Score: 76.44 [%]  |  Seq Length: 256.0
[2024-09-27 10:08:42,512][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-27 10:08:42,512][root][INFO] - Score: 45.64 [%]  |  Evaluation Time: 0.48 [s]
[2024-09-27 10:08:42,955][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-27 10:08:42,955][root][INFO] - Score: 35.36 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 10:08:42,956][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-27 10:08:42,958][root][INFO] - 
[8/ 15 Epoch]
[2024-09-27 10:08:45,911][root][INFO] - Step: 56/105  |  Loss: 1.0570  |  Score: 75.90 [%]  |  Seq Length: 256.0
[2024-09-27 10:08:46,381][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-27 10:08:46,381][root][INFO] - Score: 45.03 [%]  |  Evaluation Time: 0.47 [s]
[2024-09-27 10:08:46,834][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-27 10:08:46,834][root][INFO] - Score: 36.00 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-27 10:08:46,835][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-27 10:08:46,837][root][INFO] - 
[9/ 15 Epoch]
[2024-09-27 10:08:48,742][root][INFO] - Step: 60/105  |  Loss: 0.8486  |  Score: 83.52 [%]  |  Seq Length: 256.0
[2024-09-27 10:08:49,803][root][INFO] - Step: 63/105  |  Loss: 0.7666  |  Score: 82.84 [%]  |  Seq Length: 256.0
[2024-09-27 10:08:50,262][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-27 10:08:50,263][root][INFO] - Score: 44.66 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-27 10:08:50,711][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-27 10:08:50,711][root][INFO] - Score: 35.67 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 10:08:50,714][root][INFO] - 
[10/ 15 Epoch]
[2024-09-27 10:08:53,740][root][INFO] - Step: 70/105  |  Loss: 0.6978  |  Score: 84.97 [%]  |  Seq Length: 256.0
[2024-09-27 10:08:54,204][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-27 10:08:54,205][root][INFO] - Score: 48.06 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-27 10:08:54,651][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-27 10:08:54,651][root][INFO] - Score: 39.24 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 10:08:54,652][root][INFO] - 
Save new Best Score (Epoch: 10)
[2024-09-27 10:08:54,654][root][INFO] - 
[11/ 15 Epoch]
[2024-09-27 10:08:57,063][root][INFO] - Step: 75/105  |  Loss: 0.6244  |  Score: 86.84 [%]  |  Seq Length: 256.0
[2024-09-27 10:08:57,784][root][INFO] - Step: 77/105  |  Loss: 0.6586  |  Score: 85.85 [%]  |  Seq Length: 256.0
[2024-09-27 10:08:58,267][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-27 10:08:58,268][root][INFO] - Score: 48.28 [%]  |  Evaluation Time: 0.48 [s]
[2024-09-27 10:08:58,702][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-27 10:08:58,703][root][INFO] - Score: 38.26 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 10:08:58,705][root][INFO] - 
[12/ 15 Epoch]
[2024-09-27 10:09:01,747][root][INFO] - Step: 84/105  |  Loss: 0.5843  |  Score: 87.13 [%]  |  Seq Length: 256.0
[2024-09-27 10:09:02,222][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-27 10:09:02,223][root][INFO] - Score: 49.86 [%]  |  Evaluation Time: 0.47 [s]
[2024-09-27 10:09:02,657][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-27 10:09:02,658][root][INFO] - Score: 38.52 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 10:09:02,659][root][INFO] - 
Save new Best Score (Epoch: 12)
[2024-09-27 10:09:02,662][root][INFO] - 
[13/ 15 Epoch]
[2024-09-27 10:09:05,396][root][INFO] - Step: 90/105  |  Loss: 0.5843  |  Score: 86.99 [%]  |  Seq Length: 256.0
[2024-09-27 10:09:05,721][root][INFO] - Step: 91/105  |  Loss: 0.4027  |  Score: 89.42 [%]  |  Seq Length: 256.0
[2024-09-27 10:09:06,204][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-27 10:09:06,204][root][INFO] - Score: 51.11 [%]  |  Evaluation Time: 0.48 [s]
[2024-09-27 10:09:06,657][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-27 10:09:06,657][root][INFO] - Score: 38.52 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-27 10:09:06,658][root][INFO] - 
Save new Best Score (Epoch: 13)
[2024-09-27 10:09:06,659][root][INFO] - 
[14/ 15 Epoch]
[2024-09-27 10:09:09,642][root][INFO] - Step: 98/105  |  Loss: 0.5560  |  Score: 87.19 [%]  |  Seq Length: 256.0
[2024-09-27 10:09:10,103][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-27 10:09:10,103][root][INFO] - Score: 50.54 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-27 10:09:10,522][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-27 10:09:10,522][root][INFO] - Score: 38.83 [%]  |  Evaluation Time: 0.42 [s]
[2024-09-27 10:09:10,524][root][INFO] - 
[15/ 15 Epoch]
[2024-09-27 10:09:13,608][root][INFO] - Step: 105/105  |  Loss: 0.5481  |  Score: 87.59 [%]  |  Seq Length: 256.0
[2024-09-27 10:09:14,108][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-27 10:09:14,109][root][INFO] - Score: 50.42 [%]  |  Evaluation Time: 0.50 [s]
[2024-09-27 10:09:14,556][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-27 10:09:14,556][root][INFO] - Score: 38.49 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 10:09:14,557][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-27 10:09:14,557][root][INFO] - - Epoch: 13
[2024-09-27 10:09:14,557][root][INFO] - - DEV score: 51.11 [%]
[2024-09-27 10:09:14,557][root][INFO] - - TEST score: 38.52 [%]
[2024-09-27 10:09:14,558][root][INFO] - Fine-tuning is done!
[2024-09-27 10:09:20,615][root][INFO] - 

[2024-09-27 10:09:20,615][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-27 10:09:20,616][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs
[2024-09-27 10:09:20,616][root][INFO] - 

[2024-09-27 10:09:20,616][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en', 'do_hangeulize': False, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-27 10:09:24,125][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-27 10:09:24,126][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-27 10:09:24,126][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-27 10:09:24,127][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-27 10:09:24,127][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-27 10:09:24,128][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-27 10:09:24,128][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-27 10:09:24,129][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-27 10:09:24,129][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-27 10:09:24,130][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-27 10:09:24,130][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-27 10:09:24,130][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-27 10:09:24,131][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-27 10:09:24,131][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-27 10:09:24,132][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-27 10:09:24,132][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-27 10:09:24,133][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-27 10:09:24,133][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-27 10:09:24,134][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-27 10:09:24,134][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-27 10:09:24,135][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-27 10:09:24,135][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-27 10:09:24,135][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-27 10:09:24,136][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-27 10:09:24,137][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-27 10:09:24,141][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-27 10:09:24,246][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-27 10:09:24,249][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-27 10:09:24,548][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-27 10:09:31,312][root][INFO] - 

[2024-09-27 10:09:31,312][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-27 10:09:31,312][root][INFO] - Data Preprocessing
[2024-09-27 10:09:31,313][root][INFO] - ㄴ remain_lang                ko_en
[2024-09-27 10:09:31,313][root][INFO] - ㄴ do_hangeulize              False
[2024-09-27 10:09:31,313][root][INFO] - ㄴ data_remove                True

[2024-09-27 10:09:31,313][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-27 10:09:31,322][root][INFO] - vocab size              : 51200
[2024-09-27 10:09:31,322][root][INFO] - device                  : gpu
[2024-09-27 10:09:31,323][root][INFO] - random seed             : 42
[2024-09-27 10:09:31,323][root][INFO] - train data size         : 448
[2024-09-27 10:09:31,323][root][INFO] - max epochs              : 15
[2024-09-27 10:09:31,323][root][INFO] - total steps             : 105
[2024-09-27 10:09:31,323][root][INFO] - warmup steps            : 10
[2024-09-27 10:09:31,323][root][INFO] - batch size              : 64
[2024-09-27 10:09:31,323][root][INFO] - accumulation steps      : 1
[2024-09-27 10:09:31,323][root][INFO] - optimizer               : adamwscale
[2024-09-27 10:09:31,323][root][INFO] - lr_scheduler            : cosine
[2024-09-27 10:09:31,323][root][INFO] - learning rate           : 0.01
[2024-09-27 10:09:31,323][root][INFO] - max length              : 256

[2024-09-27 10:09:31,324][root][INFO] - LoRA Configuration
[2024-09-27 10:09:31,324][root][INFO] - ㄴ r                    : 32
[2024-09-27 10:09:31,324][root][INFO] - ㄴ alpha                : 128
[2024-09-27 10:09:31,324][root][INFO] - ㄴ dropout              : 0.03

[2024-09-27 10:09:31,324][root][INFO] - KOMBO Configuration
[2024-09-27 10:09:31,324][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-27 10:09:31,324][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-27 10:09:31,324][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-27 10:09:31,324][root][INFO] - ㄴ do_combination       : True
[2024-09-27 10:09:31,324][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-27 10:09:31,325][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-27 10:09:31,325][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-27 10:09:31,325][root][INFO] -   ㄴ add_lora           : True

[2024-09-27 10:09:31,325][root][INFO] - LoRA in KOMBO Configuration
[2024-09-27 10:09:31,325][root][INFO] - ㄴ r                : 32
[2024-09-27 10:09:31,325][root][INFO] - ㄴ alpha            : 128
[2024-09-27 10:09:31,325][root][INFO] - ㄴ dropout          : 0.03

[2024-09-27 10:09:31,325][root][INFO] - 

[2024-09-27 10:09:31,325][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs
[2024-09-27 10:09:31,325][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-27 10:09:31,326][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/tb
[2024-09-27 10:09:31,326][root][INFO] - * tb interval   : 15

[2024-09-27 10:09:31,326][root][INFO] - 

[2024-09-27 10:09:31,326][root][INFO] - Start the Training !
[2024-09-27 10:09:31,329][root][INFO] - 
[1/ 15 Epoch]
[2024-09-27 10:09:36,154][root][INFO] - Step: 7/105  |  Loss: 5.0053  |  Score: 2.44 [%]  |  Seq Length: 256.0
[2024-09-27 10:09:36,750][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-27 10:09:36,750][root][INFO] - Score: 0.94 [%]  |  Evaluation Time: 0.59 [s]
[2024-09-27 10:09:37,250][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-27 10:09:37,250][root][INFO] - Score: -5.92 [%]  |  Evaluation Time: 0.50 [s]
[2024-09-27 10:09:37,252][root][INFO] - 
[2/ 15 Epoch]
[2024-09-27 10:09:41,046][root][INFO] - Step: 14/105  |  Loss: 2.7845  |  Score: 9.60 [%]  |  Seq Length: 256.0
[2024-09-27 10:09:41,623][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-27 10:09:41,623][root][INFO] - Score: -2.13 [%]  |  Evaluation Time: 0.57 [s]
[2024-09-27 10:09:42,175][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-27 10:09:42,175][root][INFO] - Score: 5.58 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-27 10:09:42,175][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-27 10:09:42,177][root][INFO] - 
[3/ 15 Epoch]
[2024-09-27 10:09:43,149][root][INFO] - Step: 15/105  |  Loss: 2.4184  |  Score: 15.62 [%]  |  Seq Length: 256.0
[2024-09-27 10:09:46,055][root][INFO] - Step: 21/105  |  Loss: 2.2095  |  Score: 34.59 [%]  |  Seq Length: 256.0
[2024-09-27 10:09:46,649][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-27 10:09:46,649][root][INFO] - Score: 18.91 [%]  |  Evaluation Time: 0.59 [s]
[2024-09-27 10:09:47,192][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-27 10:09:47,192][root][INFO] - Score: 10.50 [%]  |  Evaluation Time: 0.54 [s]
[2024-09-27 10:09:47,193][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-27 10:09:47,194][root][INFO] - 
[4/ 15 Epoch]
[2024-09-27 10:09:51,089][root][INFO] - Step: 28/105  |  Loss: 1.8727  |  Score: 49.29 [%]  |  Seq Length: 256.0
[2024-09-27 10:09:51,663][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-27 10:09:51,663][root][INFO] - Score: 19.53 [%]  |  Evaluation Time: 0.57 [s]
[2024-09-27 10:09:52,213][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-27 10:09:52,213][root][INFO] - Score: 18.51 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-27 10:09:52,214][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-27 10:09:52,215][root][INFO] - 
[5/ 15 Epoch]
[2024-09-27 10:09:53,645][root][INFO] - Step: 30/105  |  Loss: 1.9163  |  Score: 52.78 [%]  |  Seq Length: 256.0
[2024-09-27 10:09:56,105][root][INFO] - Step: 35/105  |  Loss: 1.4427  |  Score: 63.52 [%]  |  Seq Length: 256.0
[2024-09-27 10:09:56,690][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-27 10:09:56,690][root][INFO] - Score: 31.68 [%]  |  Evaluation Time: 0.58 [s]
[2024-09-27 10:09:57,244][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-27 10:09:57,244][root][INFO] - Score: 25.71 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-27 10:09:57,245][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-27 10:09:57,246][root][INFO] - 
[6/ 15 Epoch]
[2024-09-27 10:10:01,041][root][INFO] - Step: 42/105  |  Loss: 1.3324  |  Score: 68.40 [%]  |  Seq Length: 256.0
[2024-09-27 10:10:01,615][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-27 10:10:01,615][root][INFO] - Score: 33.11 [%]  |  Evaluation Time: 0.57 [s]
[2024-09-27 10:10:02,165][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-27 10:10:02,165][root][INFO] - Score: 27.81 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-27 10:10:02,166][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-27 10:10:02,167][root][INFO] - 
[7/ 15 Epoch]
[2024-09-27 10:10:04,238][root][INFO] - Step: 45/105  |  Loss: 1.0158  |  Score: 76.61 [%]  |  Seq Length: 256.0
[2024-09-27 10:10:06,142][root][INFO] - Step: 49/105  |  Loss: 1.1656  |  Score: 75.25 [%]  |  Seq Length: 256.0
[2024-09-27 10:10:06,714][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-27 10:10:06,714][root][INFO] - Score: 39.27 [%]  |  Evaluation Time: 0.57 [s]
[2024-09-27 10:10:07,271][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-27 10:10:07,271][root][INFO] - Score: 33.27 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-27 10:10:07,272][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-27 10:10:07,274][root][INFO] - 
[8/ 15 Epoch]
[2024-09-27 10:10:11,117][root][INFO] - Step: 56/105  |  Loss: 0.8799  |  Score: 81.52 [%]  |  Seq Length: 256.0
[2024-09-27 10:10:11,690][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-27 10:10:11,691][root][INFO] - Score: 42.26 [%]  |  Evaluation Time: 0.57 [s]
[2024-09-27 10:10:12,251][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-27 10:10:12,251][root][INFO] - Score: 35.69 [%]  |  Evaluation Time: 0.56 [s]
[2024-09-27 10:10:12,252][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-27 10:10:12,254][root][INFO] - 
[9/ 15 Epoch]
[2024-09-27 10:10:14,805][root][INFO] - Step: 60/105  |  Loss: 0.8206  |  Score: 82.12 [%]  |  Seq Length: 256.0
[2024-09-27 10:10:16,235][root][INFO] - Step: 63/105  |  Loss: 0.7982  |  Score: 82.56 [%]  |  Seq Length: 256.0
[2024-09-27 10:10:16,850][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-27 10:10:16,850][root][INFO] - Score: 43.43 [%]  |  Evaluation Time: 0.61 [s]
[2024-09-27 10:10:17,398][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-27 10:10:17,398][root][INFO] - Score: 35.79 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-27 10:10:17,399][root][INFO] - 
Save new Best Score (Epoch: 9)
[2024-09-27 10:10:17,400][root][INFO] - 
[10/ 15 Epoch]
[2024-09-27 10:10:21,176][root][INFO] - Step: 70/105  |  Loss: 0.6426  |  Score: 85.76 [%]  |  Seq Length: 256.0
[2024-09-27 10:10:21,765][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-27 10:10:21,765][root][INFO] - Score: 42.61 [%]  |  Evaluation Time: 0.59 [s]
[2024-09-27 10:10:22,311][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-27 10:10:22,311][root][INFO] - Score: 36.11 [%]  |  Evaluation Time: 0.54 [s]
[2024-09-27 10:10:22,313][root][INFO] - 
[11/ 15 Epoch]
[2024-09-27 10:10:25,243][root][INFO] - Step: 75/105  |  Loss: 0.5858  |  Score: 85.79 [%]  |  Seq Length: 256.0
[2024-09-27 10:10:26,165][root][INFO] - Step: 77/105  |  Loss: 0.6610  |  Score: 85.02 [%]  |  Seq Length: 256.0
[2024-09-27 10:10:26,761][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-27 10:10:26,761][root][INFO] - Score: 41.47 [%]  |  Evaluation Time: 0.59 [s]
[2024-09-27 10:10:27,306][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-27 10:10:27,307][root][INFO] - Score: 36.41 [%]  |  Evaluation Time: 0.54 [s]
[2024-09-27 10:10:27,311][root][INFO] - 
[12/ 15 Epoch]
[2024-09-27 10:10:31,119][root][INFO] - Step: 84/105  |  Loss: 0.5486  |  Score: 88.30 [%]  |  Seq Length: 256.0
[2024-09-27 10:10:31,691][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-27 10:10:31,691][root][INFO] - Score: 43.47 [%]  |  Evaluation Time: 0.57 [s]
[2024-09-27 10:10:32,239][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-27 10:10:32,239][root][INFO] - Score: 37.20 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-27 10:10:32,240][root][INFO] - 
Save new Best Score (Epoch: 12)
[2024-09-27 10:10:32,242][root][INFO] - 
[13/ 15 Epoch]
[2024-09-27 10:10:35,711][root][INFO] - Step: 90/105  |  Loss: 0.5665  |  Score: 87.98 [%]  |  Seq Length: 256.0
[2024-09-27 10:10:36,111][root][INFO] - Step: 91/105  |  Loss: 0.5824  |  Score: 90.72 [%]  |  Seq Length: 256.0
[2024-09-27 10:10:36,696][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-27 10:10:36,696][root][INFO] - Score: 42.65 [%]  |  Evaluation Time: 0.58 [s]
[2024-09-27 10:10:37,205][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-27 10:10:37,205][root][INFO] - Score: 37.66 [%]  |  Evaluation Time: 0.51 [s]
[2024-09-27 10:10:37,207][root][INFO] - 
[14/ 15 Epoch]
[2024-09-27 10:10:40,933][root][INFO] - Step: 98/105  |  Loss: 0.5348  |  Score: 87.26 [%]  |  Seq Length: 256.0
[2024-09-27 10:10:41,521][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-27 10:10:41,522][root][INFO] - Score: 43.53 [%]  |  Evaluation Time: 0.59 [s]
[2024-09-27 10:10:42,058][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-27 10:10:42,058][root][INFO] - Score: 38.39 [%]  |  Evaluation Time: 0.53 [s]
[2024-09-27 10:10:42,059][root][INFO] - 
Save new Best Score (Epoch: 14)
[2024-09-27 10:10:42,060][root][INFO] - 
[15/ 15 Epoch]
[2024-09-27 10:10:45,997][root][INFO] - Step: 105/105  |  Loss: 0.5185  |  Score: 88.56 [%]  |  Seq Length: 256.0
[2024-09-27 10:10:46,579][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-27 10:10:46,579][root][INFO] - Score: 43.61 [%]  |  Evaluation Time: 0.58 [s]
[2024-09-27 10:10:47,148][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-27 10:10:47,148][root][INFO] - Score: 37.41 [%]  |  Evaluation Time: 0.57 [s]
[2024-09-27 10:10:47,149][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-27 10:10:47,149][root][INFO] - - Epoch: 14
[2024-09-27 10:10:47,149][root][INFO] - - DEV score: 43.53 [%]
[2024-09-27 10:10:47,149][root][INFO] - - TEST score: 38.39 [%]
[2024-09-27 10:10:47,150][root][INFO] - Fine-tuning is done!
[2024-09-27 10:10:53,478][root][INFO] - 

[2024-09-27 10:10:53,478][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-27 10:10:53,478][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs
[2024-09-27 10:10:53,478][root][INFO] - 

[2024-09-27 10:10:53,478][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en', 'do_hangeulize': False, 'data_remove': False, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-27 10:10:58,508][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-27 10:10:58,509][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-27 10:10:58,509][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-27 10:10:58,510][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-27 10:10:58,510][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-27 10:10:58,511][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-27 10:10:58,511][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-27 10:10:58,512][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-27 10:10:58,512][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-27 10:10:58,512][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-27 10:10:58,513][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-27 10:10:58,513][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-27 10:10:58,514][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-27 10:10:58,514][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-27 10:10:58,515][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-27 10:10:58,515][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-27 10:10:58,515][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-27 10:10:58,516][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-27 10:10:58,516][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-27 10:10:58,517][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-27 10:10:58,517][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-27 10:10:58,518][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-27 10:10:58,518][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-27 10:10:58,519][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-27 10:10:58,521][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-27 10:10:58,691][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-27 10:11:02,635][root][INFO] - 

[2024-09-27 10:11:02,635][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-27 10:11:02,635][root][INFO] - Data Preprocessing
[2024-09-27 10:11:02,635][root][INFO] - ㄴ remain_lang                ko_en
[2024-09-27 10:11:02,635][root][INFO] - ㄴ do_hangeulize              False
[2024-09-27 10:11:02,635][root][INFO] - ㄴ data_remove                False

[2024-09-27 10:11:02,635][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-27 10:11:02,644][root][INFO] - vocab size              : 51200
[2024-09-27 10:11:02,644][root][INFO] - device                  : gpu
[2024-09-27 10:11:02,644][root][INFO] - random seed             : 42
[2024-09-27 10:11:02,645][root][INFO] - train data size         : 5760
[2024-09-27 10:11:02,645][root][INFO] - max epochs              : 15
[2024-09-27 10:11:02,645][root][INFO] - total steps             : 1350
[2024-09-27 10:11:02,645][root][INFO] - warmup steps            : 135
[2024-09-27 10:11:02,645][root][INFO] - batch size              : 64
[2024-09-27 10:11:02,645][root][INFO] - accumulation steps      : 1
[2024-09-27 10:11:02,645][root][INFO] - optimizer               : adamwscale
[2024-09-27 10:11:02,645][root][INFO] - lr_scheduler            : cosine
[2024-09-27 10:11:02,645][root][INFO] - learning rate           : 0.01
[2024-09-27 10:11:02,645][root][INFO] - max length              : 256

[2024-09-27 10:11:02,645][root][INFO] - LoRA Configuration
[2024-09-27 10:11:02,646][root][INFO] - ㄴ r                    : 32
[2024-09-27 10:11:02,646][root][INFO] - ㄴ alpha                : 128
[2024-09-27 10:11:02,646][root][INFO] - ㄴ dropout              : 0.03

[2024-09-27 10:11:02,646][root][INFO] - 

[2024-09-27 10:11:02,646][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs
[2024-09-27 10:11:02,646][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-27 10:11:02,646][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/tb
[2024-09-27 10:11:02,646][root][INFO] - * tb interval   : 15

[2024-09-27 10:11:02,646][root][INFO] - 

[2024-09-27 10:11:02,646][root][INFO] - Start the Training !
[2024-09-27 10:11:02,649][root][INFO] - 
[1/ 15 Epoch]
[2024-09-27 10:11:11,183][root][INFO] - Step: 15/1350  |  Loss: 3.3197  |  Score: 2.45 [%]  |  Seq Length: 256.0
[2024-09-27 10:11:16,902][root][INFO] - Step: 30/1350  |  Loss: 2.3261  |  Score: 18.97 [%]  |  Seq Length: 256.0
[2024-09-27 10:11:22,635][root][INFO] - Step: 45/1350  |  Loss: 2.0635  |  Score: 29.16 [%]  |  Seq Length: 256.0
[2024-09-27 10:11:28,353][root][INFO] - Step: 60/1350  |  Loss: 1.6941  |  Score: 48.99 [%]  |  Seq Length: 256.0
[2024-09-27 10:11:34,070][root][INFO] - Step: 75/1350  |  Loss: 1.4790  |  Score: 58.21 [%]  |  Seq Length: 256.0
[2024-09-27 10:11:39,784][root][INFO] - Step: 90/1350  |  Loss: 1.4178  |  Score: 58.04 [%]  |  Seq Length: 256.0
[2024-09-27 10:11:43,854][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-27 10:11:43,854][root][INFO] - Score: 70.51 [%]  |  Evaluation Time: 4.07 [s]
[2024-09-27 10:11:47,512][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-27 10:11:47,513][root][INFO] - Score: 65.78 [%]  |  Evaluation Time: 3.66 [s]
[2024-09-27 10:11:47,514][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-27 10:11:47,515][root][INFO] - 
[2/ 15 Epoch]
[2024-09-27 10:11:48,236][root][INFO] - Step: 91/1350  |  Loss: 1.2774  |  Score: 64.23 [%]  |  Seq Length: 256.0
[2024-09-27 10:11:53,570][root][INFO] - Step: 105/1350  |  Loss: 1.2447  |  Score: 64.01 [%]  |  Seq Length: 256.0
[2024-09-27 10:11:59,296][root][INFO] - Step: 120/1350  |  Loss: 1.3120  |  Score: 64.03 [%]  |  Seq Length: 256.0
[2024-09-27 10:12:05,017][root][INFO] - Step: 135/1350  |  Loss: 1.1659  |  Score: 64.98 [%]  |  Seq Length: 256.0
[2024-09-27 10:12:10,736][root][INFO] - Step: 150/1350  |  Loss: 1.0996  |  Score: 67.60 [%]  |  Seq Length: 256.0
[2024-09-27 10:12:16,453][root][INFO] - Step: 165/1350  |  Loss: 1.1995  |  Score: 65.33 [%]  |  Seq Length: 256.0
[2024-09-27 10:12:22,183][root][INFO] - Step: 180/1350  |  Loss: 1.1671  |  Score: 64.00 [%]  |  Seq Length: 256.0
[2024-09-27 10:12:26,033][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-27 10:12:26,033][root][INFO] - Score: 76.00 [%]  |  Evaluation Time: 3.85 [s]
[2024-09-27 10:12:29,661][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-27 10:12:29,661][root][INFO] - Score: 69.02 [%]  |  Evaluation Time: 3.63 [s]
[2024-09-27 10:12:29,662][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-27 10:12:29,663][root][INFO] - 
[3/ 15 Epoch]
[2024-09-27 10:12:30,400][root][INFO] - Step: 181/1350  |  Loss: 0.6673  |  Score: 83.49 [%]  |  Seq Length: 256.0
[2024-09-27 10:12:35,739][root][INFO] - Step: 195/1350  |  Loss: 0.9676  |  Score: 71.01 [%]  |  Seq Length: 256.0
[2024-09-27 10:12:41,456][root][INFO] - Step: 210/1350  |  Loss: 1.0800  |  Score: 68.92 [%]  |  Seq Length: 256.0
[2024-09-27 10:12:47,171][root][INFO] - Step: 225/1350  |  Loss: 1.0361  |  Score: 71.05 [%]  |  Seq Length: 256.0
[2024-09-27 10:12:52,893][root][INFO] - Step: 240/1350  |  Loss: 0.9631  |  Score: 70.50 [%]  |  Seq Length: 256.0
[2024-09-27 10:12:58,604][root][INFO] - Step: 255/1350  |  Loss: 0.9734  |  Score: 69.69 [%]  |  Seq Length: 256.0
[2024-09-27 10:13:04,343][root][INFO] - Step: 270/1350  |  Loss: 1.0338  |  Score: 70.42 [%]  |  Seq Length: 256.0
[2024-09-27 10:13:08,268][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-27 10:13:08,268][root][INFO] - Score: 77.43 [%]  |  Evaluation Time: 3.92 [s]
[2024-09-27 10:13:12,007][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-27 10:13:12,008][root][INFO] - Score: 70.60 [%]  |  Evaluation Time: 3.74 [s]
[2024-09-27 10:13:12,009][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-27 10:13:12,010][root][INFO] - 
[4/ 15 Epoch]
[2024-09-27 10:13:12,773][root][INFO] - Step: 271/1350  |  Loss: 0.6233  |  Score: 83.93 [%]  |  Seq Length: 256.0
[2024-09-27 10:13:18,111][root][INFO] - Step: 285/1350  |  Loss: 0.7406  |  Score: 77.24 [%]  |  Seq Length: 256.0
[2024-09-27 10:13:23,834][root][INFO] - Step: 300/1350  |  Loss: 0.9764  |  Score: 73.19 [%]  |  Seq Length: 256.0
[2024-09-27 10:13:29,547][root][INFO] - Step: 315/1350  |  Loss: 1.0028  |  Score: 75.29 [%]  |  Seq Length: 256.0
[2024-09-27 10:13:35,261][root][INFO] - Step: 330/1350  |  Loss: 0.8516  |  Score: 74.66 [%]  |  Seq Length: 256.0
[2024-09-27 10:13:40,972][root][INFO] - Step: 345/1350  |  Loss: 0.8774  |  Score: 75.12 [%]  |  Seq Length: 256.0
[2024-09-27 10:13:46,689][root][INFO] - Step: 360/1350  |  Loss: 0.8987  |  Score: 76.07 [%]  |  Seq Length: 256.0
[2024-09-27 10:13:50,531][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-27 10:13:50,531][root][INFO] - Score: 77.07 [%]  |  Evaluation Time: 3.84 [s]
[2024-09-27 10:13:54,094][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-27 10:13:54,094][root][INFO] - Score: 70.73 [%]  |  Evaluation Time: 3.56 [s]
[2024-09-27 10:13:54,096][root][INFO] - 
[5/ 15 Epoch]
[2024-09-27 10:13:54,805][root][INFO] - Step: 361/1350  |  Loss: 0.7751  |  Score: 83.80 [%]  |  Seq Length: 256.0
[2024-09-27 10:14:00,136][root][INFO] - Step: 375/1350  |  Loss: 0.7637  |  Score: 76.97 [%]  |  Seq Length: 256.0
[2024-09-27 10:14:05,846][root][INFO] - Step: 390/1350  |  Loss: 0.7825  |  Score: 77.97 [%]  |  Seq Length: 256.0
[2024-09-27 10:14:11,558][root][INFO] - Step: 405/1350  |  Loss: 0.8417  |  Score: 76.86 [%]  |  Seq Length: 256.0
[2024-09-27 10:14:17,269][root][INFO] - Step: 420/1350  |  Loss: 0.8551  |  Score: 75.67 [%]  |  Seq Length: 256.0
[2024-09-27 10:14:22,986][root][INFO] - Step: 435/1350  |  Loss: 0.8307  |  Score: 77.50 [%]  |  Seq Length: 256.0
[2024-09-27 10:14:28,729][root][INFO] - Step: 450/1350  |  Loss: 0.7798  |  Score: 77.93 [%]  |  Seq Length: 256.0
[2024-09-27 10:14:32,539][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-27 10:14:32,539][root][INFO] - Score: 78.86 [%]  |  Evaluation Time: 3.81 [s]
[2024-09-27 10:14:36,142][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-27 10:14:36,143][root][INFO] - Score: 71.33 [%]  |  Evaluation Time: 3.60 [s]
[2024-09-27 10:14:36,144][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-27 10:14:36,145][root][INFO] - 
[6/ 15 Epoch]
[2024-09-27 10:14:36,856][root][INFO] - Step: 451/1350  |  Loss: 0.8821  |  Score: 74.11 [%]  |  Seq Length: 256.0
[2024-09-27 10:14:42,197][root][INFO] - Step: 465/1350  |  Loss: 0.6338  |  Score: 79.91 [%]  |  Seq Length: 256.0
[2024-09-27 10:14:47,909][root][INFO] - Step: 480/1350  |  Loss: 0.6290  |  Score: 81.42 [%]  |  Seq Length: 256.0
[2024-09-27 10:14:53,622][root][INFO] - Step: 495/1350  |  Loss: 0.7053  |  Score: 81.18 [%]  |  Seq Length: 256.0
[2024-09-27 10:14:59,332][root][INFO] - Step: 510/1350  |  Loss: 0.7619  |  Score: 80.87 [%]  |  Seq Length: 256.0
[2024-09-27 10:15:05,041][root][INFO] - Step: 525/1350  |  Loss: 0.7196  |  Score: 83.31 [%]  |  Seq Length: 256.0
[2024-09-27 10:15:10,762][root][INFO] - Step: 540/1350  |  Loss: 0.6525  |  Score: 81.89 [%]  |  Seq Length: 256.0
[2024-09-27 10:15:14,679][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-27 10:15:14,679][root][INFO] - Score: 78.28 [%]  |  Evaluation Time: 3.91 [s]
[2024-09-27 10:15:18,259][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-27 10:15:18,259][root][INFO] - Score: 71.41 [%]  |  Evaluation Time: 3.58 [s]
[2024-09-27 10:15:18,261][root][INFO] - 
[7/ 15 Epoch]
[2024-09-27 10:15:19,034][root][INFO] - Step: 541/1350  |  Loss: 0.5802  |  Score: 83.04 [%]  |  Seq Length: 256.0
[2024-09-27 10:15:24,367][root][INFO] - Step: 555/1350  |  Loss: 0.5655  |  Score: 84.24 [%]  |  Seq Length: 256.0
[2024-09-27 10:15:30,074][root][INFO] - Step: 570/1350  |  Loss: 0.5765  |  Score: 83.72 [%]  |  Seq Length: 256.0
[2024-09-27 10:15:35,782][root][INFO] - Step: 585/1350  |  Loss: 0.5969  |  Score: 82.43 [%]  |  Seq Length: 256.0
[2024-09-27 10:15:41,495][root][INFO] - Step: 600/1350  |  Loss: 0.5876  |  Score: 81.74 [%]  |  Seq Length: 256.0
[2024-09-27 10:15:47,206][root][INFO] - Step: 615/1350  |  Loss: 0.5642  |  Score: 82.79 [%]  |  Seq Length: 256.0
[2024-09-27 10:15:52,987][root][INFO] - Step: 630/1350  |  Loss: 0.5764  |  Score: 81.93 [%]  |  Seq Length: 256.0
[2024-09-27 10:15:57,039][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-27 10:15:57,039][root][INFO] - Score: 77.47 [%]  |  Evaluation Time: 4.05 [s]
[2024-09-27 10:16:00,794][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-27 10:16:00,794][root][INFO] - Score: 73.22 [%]  |  Evaluation Time: 3.75 [s]
[2024-09-27 10:16:00,795][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-27 10:16:00,796][root][INFO] - 
[8/ 15 Epoch]
[2024-09-27 10:16:01,520][root][INFO] - Step: 631/1350  |  Loss: 0.4020  |  Score: 89.86 [%]  |  Seq Length: 256.0
[2024-09-27 10:16:06,861][root][INFO] - Step: 645/1350  |  Loss: 0.4674  |  Score: 86.64 [%]  |  Seq Length: 256.0
[2024-09-27 10:16:12,579][root][INFO] - Step: 660/1350  |  Loss: 0.5251  |  Score: 84.34 [%]  |  Seq Length: 256.0
[2024-09-27 10:16:18,293][root][INFO] - Step: 675/1350  |  Loss: 0.5242  |  Score: 86.40 [%]  |  Seq Length: 256.0
[2024-09-27 10:16:24,010][root][INFO] - Step: 690/1350  |  Loss: 0.5295  |  Score: 84.39 [%]  |  Seq Length: 256.0
[2024-09-27 10:16:29,723][root][INFO] - Step: 705/1350  |  Loss: 0.5096  |  Score: 84.69 [%]  |  Seq Length: 256.0
[2024-09-27 10:16:35,466][root][INFO] - Step: 720/1350  |  Loss: 0.5151  |  Score: 85.61 [%]  |  Seq Length: 256.0
[2024-09-27 10:16:39,335][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-27 10:16:39,336][root][INFO] - Score: 77.96 [%]  |  Evaluation Time: 3.87 [s]
[2024-09-27 10:16:43,051][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-27 10:16:43,051][root][INFO] - Score: 71.47 [%]  |  Evaluation Time: 3.71 [s]
[2024-09-27 10:16:43,053][root][INFO] - 
[9/ 15 Epoch]
[2024-09-27 10:16:43,742][root][INFO] - Step: 721/1350  |  Loss: 0.4444  |  Score: 88.05 [%]  |  Seq Length: 256.0
[2024-09-27 10:16:49,074][root][INFO] - Step: 735/1350  |  Loss: 0.4606  |  Score: 85.15 [%]  |  Seq Length: 256.0
[2024-09-27 10:16:54,788][root][INFO] - Step: 750/1350  |  Loss: 0.4545  |  Score: 86.68 [%]  |  Seq Length: 256.0
[2024-09-27 10:17:00,504][root][INFO] - Step: 765/1350  |  Loss: 0.4734  |  Score: 86.52 [%]  |  Seq Length: 256.0
[2024-09-27 10:17:06,218][root][INFO] - Step: 780/1350  |  Loss: 0.4303  |  Score: 87.36 [%]  |  Seq Length: 256.0
[2024-09-27 10:17:11,932][root][INFO] - Step: 795/1350  |  Loss: 0.4208  |  Score: 87.73 [%]  |  Seq Length: 256.0
[2024-09-27 10:17:17,689][root][INFO] - Step: 810/1350  |  Loss: 0.4520  |  Score: 87.88 [%]  |  Seq Length: 256.0
[2024-09-27 10:17:21,584][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-27 10:17:21,584][root][INFO] - Score: 77.79 [%]  |  Evaluation Time: 3.89 [s]
[2024-09-27 10:17:25,246][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-27 10:17:25,246][root][INFO] - Score: 71.10 [%]  |  Evaluation Time: 3.66 [s]
[2024-09-27 10:17:25,248][root][INFO] - 
[10/ 15 Epoch]
[2024-09-27 10:17:25,975][root][INFO] - Step: 811/1350  |  Loss: 0.3856  |  Score: 90.89 [%]  |  Seq Length: 256.0
[2024-09-27 10:17:31,309][root][INFO] - Step: 825/1350  |  Loss: 0.3717  |  Score: 88.73 [%]  |  Seq Length: 256.0
[2024-09-27 10:17:37,021][root][INFO] - Step: 840/1350  |  Loss: 0.3987  |  Score: 88.08 [%]  |  Seq Length: 256.0
[2024-09-27 10:17:42,733][root][INFO] - Step: 855/1350  |  Loss: 0.3930  |  Score: 88.68 [%]  |  Seq Length: 256.0
[2024-09-27 10:17:48,444][root][INFO] - Step: 870/1350  |  Loss: 0.4455  |  Score: 88.67 [%]  |  Seq Length: 256.0
[2024-09-27 10:17:54,155][root][INFO] - Step: 885/1350  |  Loss: 0.3851  |  Score: 88.61 [%]  |  Seq Length: 256.0
[2024-09-27 10:17:59,920][root][INFO] - Step: 900/1350  |  Loss: 0.4084  |  Score: 88.45 [%]  |  Seq Length: 256.0
[2024-09-27 10:18:03,959][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-27 10:18:03,959][root][INFO] - Score: 77.83 [%]  |  Evaluation Time: 4.04 [s]
[2024-09-27 10:18:07,618][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-27 10:18:07,618][root][INFO] - Score: 71.05 [%]  |  Evaluation Time: 3.66 [s]
[2024-09-27 10:18:07,620][root][INFO] - 
[11/ 15 Epoch]
[2024-09-27 10:18:08,354][root][INFO] - Step: 901/1350  |  Loss: 0.3986  |  Score: 87.16 [%]  |  Seq Length: 256.0
[2024-09-27 10:18:13,684][root][INFO] - Step: 915/1350  |  Loss: 0.3472  |  Score: 90.67 [%]  |  Seq Length: 256.0
[2024-09-27 10:18:19,393][root][INFO] - Step: 930/1350  |  Loss: 0.3773  |  Score: 88.48 [%]  |  Seq Length: 256.0
[2024-09-27 10:18:25,102][root][INFO] - Step: 945/1350  |  Loss: 0.3346  |  Score: 90.17 [%]  |  Seq Length: 256.0
[2024-09-27 10:18:30,813][root][INFO] - Step: 960/1350  |  Loss: 0.3868  |  Score: 89.34 [%]  |  Seq Length: 256.0
[2024-09-27 10:18:36,523][root][INFO] - Step: 975/1350  |  Loss: 0.3918  |  Score: 88.49 [%]  |  Seq Length: 256.0
[2024-09-27 10:18:42,243][root][INFO] - Step: 990/1350  |  Loss: 0.3465  |  Score: 90.24 [%]  |  Seq Length: 256.0
[2024-09-27 10:18:46,237][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-27 10:18:46,237][root][INFO] - Score: 78.12 [%]  |  Evaluation Time: 3.99 [s]
[2024-09-27 10:18:49,815][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-27 10:18:49,815][root][INFO] - Score: 71.24 [%]  |  Evaluation Time: 3.58 [s]
[2024-09-27 10:18:49,817][root][INFO] - 
[12/ 15 Epoch]
[2024-09-27 10:18:50,588][root][INFO] - Step: 991/1350  |  Loss: 0.2297  |  Score: 94.32 [%]  |  Seq Length: 256.0
[2024-09-27 10:18:55,912][root][INFO] - Step: 1005/1350  |  Loss: 0.3514  |  Score: 89.52 [%]  |  Seq Length: 256.0
[2024-09-27 10:19:01,614][root][INFO] - Step: 1020/1350  |  Loss: 0.3457  |  Score: 89.72 [%]  |  Seq Length: 256.0
[2024-09-27 10:19:07,319][root][INFO] - Step: 1035/1350  |  Loss: 0.3404  |  Score: 89.26 [%]  |  Seq Length: 256.0
[2024-09-27 10:19:13,024][root][INFO] - Step: 1050/1350  |  Loss: 0.3467  |  Score: 89.71 [%]  |  Seq Length: 256.0
[2024-09-27 10:19:18,728][root][INFO] - Step: 1065/1350  |  Loss: 0.3361  |  Score: 90.25 [%]  |  Seq Length: 256.0
[2024-09-27 10:19:24,436][root][INFO] - Step: 1080/1350  |  Loss: 0.3220  |  Score: 90.43 [%]  |  Seq Length: 256.0
[2024-09-27 10:19:28,261][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-27 10:19:28,261][root][INFO] - Score: 78.50 [%]  |  Evaluation Time: 3.82 [s]
[2024-09-27 10:19:31,910][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-27 10:19:31,910][root][INFO] - Score: 70.61 [%]  |  Evaluation Time: 3.65 [s]
[2024-09-27 10:19:31,912][root][INFO] - 
[13/ 15 Epoch]
[2024-09-27 10:19:32,635][root][INFO] - Step: 1081/1350  |  Loss: 0.3188  |  Score: 91.21 [%]  |  Seq Length: 256.0
[2024-09-27 10:19:37,972][root][INFO] - Step: 1095/1350  |  Loss: 0.3191  |  Score: 91.07 [%]  |  Seq Length: 256.0
[2024-09-27 10:19:43,697][root][INFO] - Step: 1110/1350  |  Loss: 0.3384  |  Score: 91.19 [%]  |  Seq Length: 256.0
[2024-09-27 10:19:49,414][root][INFO] - Step: 1125/1350  |  Loss: 0.3291  |  Score: 89.56 [%]  |  Seq Length: 256.0
[2024-09-27 10:19:55,134][root][INFO] - Step: 1140/1350  |  Loss: 0.3071  |  Score: 90.76 [%]  |  Seq Length: 256.0
[2024-09-27 10:20:00,850][root][INFO] - Step: 1155/1350  |  Loss: 0.3247  |  Score: 90.36 [%]  |  Seq Length: 256.0
[2024-09-27 10:20:06,579][root][INFO] - Step: 1170/1350  |  Loss: 0.3144  |  Score: 89.98 [%]  |  Seq Length: 256.0
[2024-09-27 10:20:10,436][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-27 10:20:10,436][root][INFO] - Score: 78.52 [%]  |  Evaluation Time: 3.85 [s]
[2024-09-27 10:20:14,186][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-27 10:20:14,186][root][INFO] - Score: 71.34 [%]  |  Evaluation Time: 3.75 [s]
[2024-09-27 10:20:14,188][root][INFO] - 
[14/ 15 Epoch]
[2024-09-27 10:20:14,910][root][INFO] - Step: 1171/1350  |  Loss: 0.4294  |  Score: 81.39 [%]  |  Seq Length: 256.0
[2024-09-27 10:20:20,246][root][INFO] - Step: 1185/1350  |  Loss: 0.3555  |  Score: 90.09 [%]  |  Seq Length: 256.0
[2024-09-27 10:20:25,961][root][INFO] - Step: 1200/1350  |  Loss: 0.3026  |  Score: 90.39 [%]  |  Seq Length: 256.0
[2024-09-27 10:20:31,674][root][INFO] - Step: 1215/1350  |  Loss: 0.2878  |  Score: 91.99 [%]  |  Seq Length: 256.0
[2024-09-27 10:20:37,386][root][INFO] - Step: 1230/1350  |  Loss: 0.2959  |  Score: 90.72 [%]  |  Seq Length: 256.0
[2024-09-27 10:20:43,101][root][INFO] - Step: 1245/1350  |  Loss: 0.3196  |  Score: 89.54 [%]  |  Seq Length: 256.0
[2024-09-27 10:20:48,855][root][INFO] - Step: 1260/1350  |  Loss: 0.3229  |  Score: 91.44 [%]  |  Seq Length: 256.0
[2024-09-27 10:20:52,710][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-27 10:20:52,710][root][INFO] - Score: 77.98 [%]  |  Evaluation Time: 3.85 [s]
[2024-09-27 10:20:56,261][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-27 10:20:56,262][root][INFO] - Score: 70.51 [%]  |  Evaluation Time: 3.55 [s]
[2024-09-27 10:20:56,263][root][INFO] - 
[15/ 15 Epoch]
[2024-09-27 10:20:56,996][root][INFO] - Step: 1261/1350  |  Loss: 0.3429  |  Score: 88.95 [%]  |  Seq Length: 256.0
[2024-09-27 10:21:02,353][root][INFO] - Step: 1275/1350  |  Loss: 0.3249  |  Score: 90.79 [%]  |  Seq Length: 256.0
[2024-09-27 10:21:08,067][root][INFO] - Step: 1290/1350  |  Loss: 0.3014  |  Score: 91.29 [%]  |  Seq Length: 256.0
[2024-09-27 10:21:13,782][root][INFO] - Step: 1305/1350  |  Loss: 0.3177  |  Score: 89.88 [%]  |  Seq Length: 256.0
[2024-09-27 10:21:19,503][root][INFO] - Step: 1320/1350  |  Loss: 0.3112  |  Score: 90.72 [%]  |  Seq Length: 256.0
[2024-09-27 10:21:25,219][root][INFO] - Step: 1335/1350  |  Loss: 0.3130  |  Score: 91.07 [%]  |  Seq Length: 256.0
[2024-09-27 10:21:30,940][root][INFO] - Step: 1350/1350  |  Loss: 0.3026  |  Score: 90.23 [%]  |  Seq Length: 256.0
[2024-09-27 10:21:34,955][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-27 10:21:34,956][root][INFO] - Score: 77.92 [%]  |  Evaluation Time: 4.01 [s]
[2024-09-27 10:21:38,601][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-27 10:21:38,601][root][INFO] - Score: 71.44 [%]  |  Evaluation Time: 3.64 [s]
[2024-09-27 10:21:38,602][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-27 10:21:38,602][root][INFO] - - Epoch: 7
[2024-09-27 10:21:38,603][root][INFO] - - DEV score: 77.47 [%]
[2024-09-27 10:21:38,603][root][INFO] - - TEST score: 73.22 [%]
[2024-09-27 10:21:38,604][root][INFO] - Fine-tuning is done!
[2024-09-27 10:21:44,501][root][INFO] - 

[2024-09-27 10:21:44,501][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-27 10:21:44,501][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs
[2024-09-27 10:21:44,501][root][INFO] - 

[2024-09-27 10:21:44,501][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en', 'do_hangeulize': False, 'data_remove': False, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-27 10:21:48,983][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-27 10:21:48,984][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-27 10:21:48,984][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-27 10:21:48,985][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-27 10:21:48,985][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-27 10:21:48,985][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-27 10:21:48,986][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-27 10:21:48,986][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-27 10:21:48,987][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-27 10:21:48,987][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-27 10:21:48,987][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-27 10:21:48,988][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-27 10:21:48,988][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-27 10:21:48,989][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-27 10:21:48,989][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-27 10:21:48,990][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-27 10:21:48,990][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-27 10:21:48,990][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-27 10:21:48,991][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-27 10:21:48,991][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-27 10:21:48,992][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-27 10:21:48,992][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-27 10:21:48,993][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-27 10:21:48,993][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-27 10:21:48,995][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-27 10:21:48,998][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-27 10:21:49,103][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-27 10:21:49,105][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-27 10:21:49,519][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-27 10:21:56,241][root][INFO] - 

[2024-09-27 10:21:56,241][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-27 10:21:56,241][root][INFO] - Data Preprocessing
[2024-09-27 10:21:56,241][root][INFO] - ㄴ remain_lang                ko_en
[2024-09-27 10:21:56,241][root][INFO] - ㄴ do_hangeulize              False
[2024-09-27 10:21:56,241][root][INFO] - ㄴ data_remove                False

[2024-09-27 10:21:56,242][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-27 10:21:56,250][root][INFO] - vocab size              : 51200
[2024-09-27 10:21:56,250][root][INFO] - device                  : gpu
[2024-09-27 10:21:56,250][root][INFO] - random seed             : 42
[2024-09-27 10:21:56,251][root][INFO] - train data size         : 5760
[2024-09-27 10:21:56,251][root][INFO] - max epochs              : 15
[2024-09-27 10:21:56,251][root][INFO] - total steps             : 1350
[2024-09-27 10:21:56,251][root][INFO] - warmup steps            : 135
[2024-09-27 10:21:56,251][root][INFO] - batch size              : 64
[2024-09-27 10:21:56,251][root][INFO] - accumulation steps      : 1
[2024-09-27 10:21:56,251][root][INFO] - optimizer               : adamwscale
[2024-09-27 10:21:56,251][root][INFO] - lr_scheduler            : cosine
[2024-09-27 10:21:56,251][root][INFO] - learning rate           : 0.01
[2024-09-27 10:21:56,251][root][INFO] - max length              : 256

[2024-09-27 10:21:56,251][root][INFO] - LoRA Configuration
[2024-09-27 10:21:56,252][root][INFO] - ㄴ r                    : 32
[2024-09-27 10:21:56,252][root][INFO] - ㄴ alpha                : 128
[2024-09-27 10:21:56,252][root][INFO] - ㄴ dropout              : 0.03

[2024-09-27 10:21:56,252][root][INFO] - KOMBO Configuration
[2024-09-27 10:21:56,252][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-27 10:21:56,252][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-27 10:21:56,252][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-27 10:21:56,252][root][INFO] - ㄴ do_combination       : True
[2024-09-27 10:21:56,252][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-27 10:21:56,252][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-27 10:21:56,253][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-27 10:21:56,253][root][INFO] -   ㄴ add_lora           : True

[2024-09-27 10:21:56,253][root][INFO] - LoRA in KOMBO Configuration
[2024-09-27 10:21:56,253][root][INFO] - ㄴ r                : 32
[2024-09-27 10:21:56,253][root][INFO] - ㄴ alpha            : 128
[2024-09-27 10:21:56,253][root][INFO] - ㄴ dropout          : 0.03

[2024-09-27 10:21:56,253][root][INFO] - 

[2024-09-27 10:21:56,253][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs
[2024-09-27 10:21:56,253][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-27 10:21:56,253][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/tb
[2024-09-27 10:21:56,253][root][INFO] - * tb interval   : 15

[2024-09-27 10:21:56,254][root][INFO] - 

[2024-09-27 10:21:56,254][root][INFO] - Start the Training !
[2024-09-27 10:21:56,257][root][INFO] - 
[1/ 15 Epoch]
[2024-09-27 10:22:06,086][root][INFO] - Step: 15/1350  |  Loss: 3.3412  |  Score: 6.01 [%]  |  Seq Length: 256.0
[2024-09-27 10:22:14,029][root][INFO] - Step: 30/1350  |  Loss: 2.1278  |  Score: 24.22 [%]  |  Seq Length: 256.0
[2024-09-27 10:22:21,982][root][INFO] - Step: 45/1350  |  Loss: 1.9708  |  Score: 32.42 [%]  |  Seq Length: 256.0
[2024-09-27 10:22:30,090][root][INFO] - Step: 60/1350  |  Loss: 1.6714  |  Score: 49.72 [%]  |  Seq Length: 256.0
[2024-09-27 10:22:38,097][root][INFO] - Step: 75/1350  |  Loss: 1.5964  |  Score: 52.34 [%]  |  Seq Length: 256.0
[2024-09-27 10:22:46,079][root][INFO] - Step: 90/1350  |  Loss: 1.3066  |  Score: 63.45 [%]  |  Seq Length: 256.0
[2024-09-27 10:22:52,279][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-27 10:22:52,279][root][INFO] - Score: 74.23 [%]  |  Evaluation Time: 6.20 [s]
[2024-09-27 10:22:58,096][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-27 10:22:58,096][root][INFO] - Score: 66.67 [%]  |  Evaluation Time: 5.81 [s]
[2024-09-27 10:22:58,097][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-27 10:22:58,099][root][INFO] - 
[2/ 15 Epoch]
[2024-09-27 10:22:59,211][root][INFO] - Step: 91/1350  |  Loss: 1.3650  |  Score: 61.05 [%]  |  Seq Length: 256.0
[2024-09-27 10:23:06,676][root][INFO] - Step: 105/1350  |  Loss: 1.2646  |  Score: 61.34 [%]  |  Seq Length: 256.0
[2024-09-27 10:23:14,655][root][INFO] - Step: 120/1350  |  Loss: 1.1955  |  Score: 64.20 [%]  |  Seq Length: 256.0
[2024-09-27 10:23:22,630][root][INFO] - Step: 135/1350  |  Loss: 1.2485  |  Score: 66.12 [%]  |  Seq Length: 256.0
[2024-09-27 10:23:30,627][root][INFO] - Step: 150/1350  |  Loss: 1.2558  |  Score: 64.23 [%]  |  Seq Length: 256.0
[2024-09-27 10:23:38,616][root][INFO] - Step: 165/1350  |  Loss: 1.0806  |  Score: 67.40 [%]  |  Seq Length: 256.0
[2024-09-27 10:23:46,622][root][INFO] - Step: 180/1350  |  Loss: 1.0627  |  Score: 68.62 [%]  |  Seq Length: 256.0
[2024-09-27 10:23:52,936][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-27 10:23:52,936][root][INFO] - Score: 76.58 [%]  |  Evaluation Time: 6.31 [s]
[2024-09-27 10:23:58,830][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-27 10:23:58,830][root][INFO] - Score: 70.65 [%]  |  Evaluation Time: 5.89 [s]
[2024-09-27 10:23:58,831][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-27 10:23:58,832][root][INFO] - 
[3/ 15 Epoch]
[2024-09-27 10:23:59,896][root][INFO] - Step: 181/1350  |  Loss: 0.9295  |  Score: 77.94 [%]  |  Seq Length: 256.0
[2024-09-27 10:24:07,364][root][INFO] - Step: 195/1350  |  Loss: 1.0009  |  Score: 70.31 [%]  |  Seq Length: 256.0
[2024-09-27 10:24:15,407][root][INFO] - Step: 210/1350  |  Loss: 1.0572  |  Score: 70.41 [%]  |  Seq Length: 256.0
[2024-09-27 10:24:23,396][root][INFO] - Step: 225/1350  |  Loss: 1.0581  |  Score: 68.93 [%]  |  Seq Length: 256.0
[2024-09-27 10:24:31,373][root][INFO] - Step: 240/1350  |  Loss: 1.0492  |  Score: 72.12 [%]  |  Seq Length: 256.0
[2024-09-27 10:24:39,281][root][INFO] - Step: 255/1350  |  Loss: 1.0824  |  Score: 67.01 [%]  |  Seq Length: 256.0
[2024-09-27 10:24:47,262][root][INFO] - Step: 270/1350  |  Loss: 1.0223  |  Score: 69.89 [%]  |  Seq Length: 256.0
[2024-09-27 10:24:53,641][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-27 10:24:53,641][root][INFO] - Score: 78.07 [%]  |  Evaluation Time: 6.38 [s]
[2024-09-27 10:24:59,502][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-27 10:24:59,502][root][INFO] - Score: 70.01 [%]  |  Evaluation Time: 5.86 [s]
[2024-09-27 10:24:59,503][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-27 10:24:59,504][root][INFO] - 
[4/ 15 Epoch]
[2024-09-27 10:25:00,591][root][INFO] - Step: 271/1350  |  Loss: 0.8175  |  Score: 81.18 [%]  |  Seq Length: 256.0
[2024-09-27 10:25:08,012][root][INFO] - Step: 285/1350  |  Loss: 0.9050  |  Score: 74.74 [%]  |  Seq Length: 256.0
[2024-09-27 10:25:16,037][root][INFO] - Step: 300/1350  |  Loss: 1.0608  |  Score: 72.81 [%]  |  Seq Length: 256.0
[2024-09-27 10:25:24,027][root][INFO] - Step: 315/1350  |  Loss: 0.8417  |  Score: 75.32 [%]  |  Seq Length: 256.0
[2024-09-27 10:25:31,975][root][INFO] - Step: 330/1350  |  Loss: 0.8714  |  Score: 76.26 [%]  |  Seq Length: 256.0
[2024-09-27 10:25:39,972][root][INFO] - Step: 345/1350  |  Loss: 0.8246  |  Score: 76.67 [%]  |  Seq Length: 256.0
[2024-09-27 10:25:48,018][root][INFO] - Step: 360/1350  |  Loss: 0.8583  |  Score: 76.49 [%]  |  Seq Length: 256.0
[2024-09-27 10:25:54,363][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-27 10:25:54,364][root][INFO] - Score: 76.43 [%]  |  Evaluation Time: 6.34 [s]
[2024-09-27 10:26:00,052][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-27 10:26:00,052][root][INFO] - Score: 71.63 [%]  |  Evaluation Time: 5.69 [s]
[2024-09-27 10:26:00,054][root][INFO] - 
[5/ 15 Epoch]
[2024-09-27 10:26:00,971][root][INFO] - Step: 361/1350  |  Loss: 0.7329  |  Score: 76.88 [%]  |  Seq Length: 256.0
[2024-09-27 10:26:08,397][root][INFO] - Step: 375/1350  |  Loss: 0.7288  |  Score: 80.50 [%]  |  Seq Length: 256.0
[2024-09-27 10:26:16,396][root][INFO] - Step: 390/1350  |  Loss: 0.8541  |  Score: 72.69 [%]  |  Seq Length: 256.0
[2024-09-27 10:26:24,370][root][INFO] - Step: 405/1350  |  Loss: 0.7876  |  Score: 77.04 [%]  |  Seq Length: 256.0
[2024-09-27 10:26:32,358][root][INFO] - Step: 420/1350  |  Loss: 0.7279  |  Score: 79.82 [%]  |  Seq Length: 256.0
[2024-09-27 10:26:40,374][root][INFO] - Step: 435/1350  |  Loss: 0.7737  |  Score: 78.64 [%]  |  Seq Length: 256.0
[2024-09-27 10:26:48,382][root][INFO] - Step: 450/1350  |  Loss: 0.7710  |  Score: 74.09 [%]  |  Seq Length: 256.0
[2024-09-27 10:26:54,738][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-27 10:26:54,738][root][INFO] - Score: 77.27 [%]  |  Evaluation Time: 6.35 [s]
[2024-09-27 10:27:00,512][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-27 10:27:00,512][root][INFO] - Score: 71.41 [%]  |  Evaluation Time: 5.77 [s]
[2024-09-27 10:27:00,513][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-27 10:27:00,514][root][INFO] - 
[6/ 15 Epoch]
[2024-09-27 10:27:01,452][root][INFO] - Step: 451/1350  |  Loss: 0.6619  |  Score: 85.85 [%]  |  Seq Length: 256.0
[2024-09-27 10:27:08,971][root][INFO] - Step: 465/1350  |  Loss: 0.6233  |  Score: 81.62 [%]  |  Seq Length: 256.0
[2024-09-27 10:27:16,960][root][INFO] - Step: 480/1350  |  Loss: 0.7651  |  Score: 81.24 [%]  |  Seq Length: 256.0
[2024-09-27 10:27:24,979][root][INFO] - Step: 495/1350  |  Loss: 0.6647  |  Score: 82.54 [%]  |  Seq Length: 256.0
[2024-09-27 10:27:32,947][root][INFO] - Step: 510/1350  |  Loss: 0.7540  |  Score: 81.54 [%]  |  Seq Length: 256.0
[2024-09-27 10:27:40,901][root][INFO] - Step: 525/1350  |  Loss: 0.6823  |  Score: 78.00 [%]  |  Seq Length: 256.0
[2024-09-27 10:27:48,955][root][INFO] - Step: 540/1350  |  Loss: 0.6103  |  Score: 81.02 [%]  |  Seq Length: 256.0
[2024-09-27 10:27:55,357][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-27 10:27:55,357][root][INFO] - Score: 77.61 [%]  |  Evaluation Time: 6.40 [s]
[2024-09-27 10:28:00,999][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-27 10:28:00,999][root][INFO] - Score: 71.88 [%]  |  Evaluation Time: 5.64 [s]
[2024-09-27 10:28:01,000][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-27 10:28:01,001][root][INFO] - 
[7/ 15 Epoch]
[2024-09-27 10:28:02,053][root][INFO] - Step: 541/1350  |  Loss: 0.4848  |  Score: 87.06 [%]  |  Seq Length: 256.0
[2024-09-27 10:28:09,499][root][INFO] - Step: 555/1350  |  Loss: 0.6031  |  Score: 83.27 [%]  |  Seq Length: 256.0
[2024-09-27 10:28:17,463][root][INFO] - Step: 570/1350  |  Loss: 0.5750  |  Score: 85.78 [%]  |  Seq Length: 256.0
[2024-09-27 10:28:25,483][root][INFO] - Step: 585/1350  |  Loss: 0.6013  |  Score: 82.64 [%]  |  Seq Length: 256.0
[2024-09-27 10:28:33,519][root][INFO] - Step: 600/1350  |  Loss: 0.5130  |  Score: 83.68 [%]  |  Seq Length: 256.0
[2024-09-27 10:28:41,457][root][INFO] - Step: 615/1350  |  Loss: 0.5580  |  Score: 84.23 [%]  |  Seq Length: 256.0
[2024-09-27 10:28:49,449][root][INFO] - Step: 630/1350  |  Loss: 0.6403  |  Score: 81.31 [%]  |  Seq Length: 256.0
[2024-09-27 10:28:55,661][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-27 10:28:55,661][root][INFO] - Score: 78.98 [%]  |  Evaluation Time: 6.21 [s]
[2024-09-27 10:29:01,450][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-27 10:29:01,450][root][INFO] - Score: 72.81 [%]  |  Evaluation Time: 5.79 [s]
[2024-09-27 10:29:01,451][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-27 10:29:01,452][root][INFO] - 
[8/ 15 Epoch]
[2024-09-27 10:29:02,401][root][INFO] - Step: 631/1350  |  Loss: 0.5973  |  Score: 83.34 [%]  |  Seq Length: 256.0
[2024-09-27 10:29:09,886][root][INFO] - Step: 645/1350  |  Loss: 0.4960  |  Score: 84.17 [%]  |  Seq Length: 256.0
[2024-09-27 10:29:17,918][root][INFO] - Step: 660/1350  |  Loss: 0.4756  |  Score: 85.79 [%]  |  Seq Length: 256.0
[2024-09-27 10:29:25,953][root][INFO] - Step: 675/1350  |  Loss: 0.5530  |  Score: 83.60 [%]  |  Seq Length: 256.0
[2024-09-27 10:29:33,968][root][INFO] - Step: 690/1350  |  Loss: 0.5480  |  Score: 83.79 [%]  |  Seq Length: 256.0
[2024-09-27 10:29:42,011][root][INFO] - Step: 705/1350  |  Loss: 0.5294  |  Score: 84.57 [%]  |  Seq Length: 256.0
[2024-09-27 10:29:50,009][root][INFO] - Step: 720/1350  |  Loss: 0.5482  |  Score: 84.12 [%]  |  Seq Length: 256.0
[2024-09-27 10:29:56,463][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-27 10:29:56,463][root][INFO] - Score: 77.97 [%]  |  Evaluation Time: 6.45 [s]
[2024-09-27 10:30:02,299][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-27 10:30:02,299][root][INFO] - Score: 71.49 [%]  |  Evaluation Time: 5.83 [s]
[2024-09-27 10:30:02,301][root][INFO] - 
[9/ 15 Epoch]
[2024-09-27 10:30:03,388][root][INFO] - Step: 721/1350  |  Loss: 0.5020  |  Score: 84.10 [%]  |  Seq Length: 256.0
[2024-09-27 10:30:10,938][root][INFO] - Step: 735/1350  |  Loss: 0.4700  |  Score: 86.62 [%]  |  Seq Length: 256.0
[2024-09-27 10:30:19,017][root][INFO] - Step: 750/1350  |  Loss: 0.4734  |  Score: 86.07 [%]  |  Seq Length: 256.0
[2024-09-27 10:30:27,079][root][INFO] - Step: 765/1350  |  Loss: 0.4640  |  Score: 86.32 [%]  |  Seq Length: 256.0
[2024-09-27 10:30:35,055][root][INFO] - Step: 780/1350  |  Loss: 0.4410  |  Score: 87.94 [%]  |  Seq Length: 256.0
[2024-09-27 10:30:43,073][root][INFO] - Step: 795/1350  |  Loss: 0.4181  |  Score: 88.09 [%]  |  Seq Length: 256.0
[2024-09-27 10:30:51,056][root][INFO] - Step: 810/1350  |  Loss: 0.4552  |  Score: 86.11 [%]  |  Seq Length: 256.0
[2024-09-27 10:30:57,331][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-27 10:30:57,332][root][INFO] - Score: 77.04 [%]  |  Evaluation Time: 6.27 [s]
[2024-09-27 10:31:03,119][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-27 10:31:03,119][root][INFO] - Score: 70.94 [%]  |  Evaluation Time: 5.79 [s]
[2024-09-27 10:31:03,122][root][INFO] - 
[10/ 15 Epoch]
[2024-09-27 10:31:04,126][root][INFO] - Step: 811/1350  |  Loss: 0.3240  |  Score: 91.91 [%]  |  Seq Length: 256.0
[2024-09-27 10:31:11,605][root][INFO] - Step: 825/1350  |  Loss: 0.3910  |  Score: 89.41 [%]  |  Seq Length: 256.0
[2024-09-27 10:31:19,634][root][INFO] - Step: 840/1350  |  Loss: 0.4052  |  Score: 87.90 [%]  |  Seq Length: 256.0
[2024-09-27 10:31:27,618][root][INFO] - Step: 855/1350  |  Loss: 0.4403  |  Score: 87.60 [%]  |  Seq Length: 256.0
[2024-09-27 10:31:35,586][root][INFO] - Step: 870/1350  |  Loss: 0.4060  |  Score: 87.93 [%]  |  Seq Length: 256.0
[2024-09-27 10:31:43,567][root][INFO] - Step: 885/1350  |  Loss: 0.4217  |  Score: 87.72 [%]  |  Seq Length: 256.0
[2024-09-27 10:31:51,605][root][INFO] - Step: 900/1350  |  Loss: 0.4399  |  Score: 86.40 [%]  |  Seq Length: 256.0
[2024-09-27 10:31:57,885][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-27 10:31:57,885][root][INFO] - Score: 77.51 [%]  |  Evaluation Time: 6.28 [s]
[2024-09-27 10:32:03,676][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-27 10:32:03,676][root][INFO] - Score: 72.70 [%]  |  Evaluation Time: 5.79 [s]
[2024-09-27 10:32:03,678][root][INFO] - 
[11/ 15 Epoch]
[2024-09-27 10:32:04,784][root][INFO] - Step: 901/1350  |  Loss: 0.3015  |  Score: 92.96 [%]  |  Seq Length: 256.0
[2024-09-27 10:32:12,292][root][INFO] - Step: 915/1350  |  Loss: 0.3918  |  Score: 89.09 [%]  |  Seq Length: 256.0
[2024-09-27 10:32:20,269][root][INFO] - Step: 930/1350  |  Loss: 0.3679  |  Score: 88.60 [%]  |  Seq Length: 256.0
[2024-09-27 10:32:28,268][root][INFO] - Step: 945/1350  |  Loss: 0.3582  |  Score: 88.96 [%]  |  Seq Length: 256.0
[2024-09-27 10:32:36,323][root][INFO] - Step: 960/1350  |  Loss: 0.3443  |  Score: 90.60 [%]  |  Seq Length: 256.0
[2024-09-27 10:32:44,280][root][INFO] - Step: 975/1350  |  Loss: 0.3773  |  Score: 88.66 [%]  |  Seq Length: 256.0
[2024-09-27 10:32:52,281][root][INFO] - Step: 990/1350  |  Loss: 0.3992  |  Score: 88.31 [%]  |  Seq Length: 256.0
[2024-09-27 10:32:58,692][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-27 10:32:58,692][root][INFO] - Score: 78.29 [%]  |  Evaluation Time: 6.41 [s]
[2024-09-27 10:33:04,591][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-27 10:33:04,592][root][INFO] - Score: 71.46 [%]  |  Evaluation Time: 5.90 [s]
[2024-09-27 10:33:04,594][root][INFO] - 
[12/ 15 Epoch]
[2024-09-27 10:33:05,569][root][INFO] - Step: 991/1350  |  Loss: 0.3148  |  Score: 90.15 [%]  |  Seq Length: 256.0
[2024-09-27 10:33:13,079][root][INFO] - Step: 1005/1350  |  Loss: 0.3664  |  Score: 89.58 [%]  |  Seq Length: 256.0
[2024-09-27 10:33:21,079][root][INFO] - Step: 1020/1350  |  Loss: 0.3271  |  Score: 89.92 [%]  |  Seq Length: 256.0
[2024-09-27 10:33:29,078][root][INFO] - Step: 1035/1350  |  Loss: 0.3244  |  Score: 90.41 [%]  |  Seq Length: 256.0
[2024-09-27 10:33:37,027][root][INFO] - Step: 1050/1350  |  Loss: 0.3333  |  Score: 90.30 [%]  |  Seq Length: 256.0
[2024-09-27 10:33:45,080][root][INFO] - Step: 1065/1350  |  Loss: 0.3549  |  Score: 89.44 [%]  |  Seq Length: 256.0
[2024-09-27 10:33:53,103][root][INFO] - Step: 1080/1350  |  Loss: 0.3782  |  Score: 88.33 [%]  |  Seq Length: 256.0
[2024-09-27 10:33:59,367][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-27 10:33:59,367][root][INFO] - Score: 78.32 [%]  |  Evaluation Time: 6.26 [s]
[2024-09-27 10:34:05,057][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-27 10:34:05,057][root][INFO] - Score: 71.79 [%]  |  Evaluation Time: 5.69 [s]
[2024-09-27 10:34:05,059][root][INFO] - 
[13/ 15 Epoch]
[2024-09-27 10:34:05,986][root][INFO] - Step: 1081/1350  |  Loss: 0.2736  |  Score: 93.06 [%]  |  Seq Length: 256.0
[2024-09-27 10:34:13,455][root][INFO] - Step: 1095/1350  |  Loss: 0.3263  |  Score: 90.67 [%]  |  Seq Length: 256.0
[2024-09-27 10:34:21,418][root][INFO] - Step: 1110/1350  |  Loss: 0.3330  |  Score: 90.44 [%]  |  Seq Length: 256.0
[2024-09-27 10:34:29,404][root][INFO] - Step: 1125/1350  |  Loss: 0.3303  |  Score: 90.73 [%]  |  Seq Length: 256.0
[2024-09-27 10:34:37,395][root][INFO] - Step: 1140/1350  |  Loss: 0.3302  |  Score: 89.90 [%]  |  Seq Length: 256.0
[2024-09-27 10:34:45,156][root][INFO] - Step: 1155/1350  |  Loss: 0.3077  |  Score: 91.18 [%]  |  Seq Length: 256.0
[2024-09-27 10:34:52,938][root][INFO] - Step: 1170/1350  |  Loss: 0.2994  |  Score: 89.86 [%]  |  Seq Length: 256.0
[2024-09-27 10:34:59,427][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-27 10:34:59,427][root][INFO] - Score: 77.71 [%]  |  Evaluation Time: 6.49 [s]
[2024-09-27 10:35:05,108][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-27 10:35:05,109][root][INFO] - Score: 72.93 [%]  |  Evaluation Time: 5.68 [s]
[2024-09-27 10:35:05,111][root][INFO] - 
[14/ 15 Epoch]
[2024-09-27 10:35:06,157][root][INFO] - Step: 1171/1350  |  Loss: 0.3340  |  Score: 90.80 [%]  |  Seq Length: 256.0
[2024-09-27 10:35:13,642][root][INFO] - Step: 1185/1350  |  Loss: 0.3106  |  Score: 90.41 [%]  |  Seq Length: 256.0
[2024-09-27 10:35:21,601][root][INFO] - Step: 1200/1350  |  Loss: 0.3114  |  Score: 90.61 [%]  |  Seq Length: 256.0
[2024-09-27 10:35:29,547][root][INFO] - Step: 1215/1350  |  Loss: 0.2952  |  Score: 91.75 [%]  |  Seq Length: 256.0
[2024-09-27 10:35:37,471][root][INFO] - Step: 1230/1350  |  Loss: 0.3271  |  Score: 89.95 [%]  |  Seq Length: 256.0
[2024-09-27 10:35:45,501][root][INFO] - Step: 1245/1350  |  Loss: 0.3347  |  Score: 90.09 [%]  |  Seq Length: 256.0
[2024-09-27 10:35:53,481][root][INFO] - Step: 1260/1350  |  Loss: 0.3039  |  Score: 91.18 [%]  |  Seq Length: 256.0
[2024-09-27 10:35:59,726][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-27 10:35:59,727][root][INFO] - Score: 78.11 [%]  |  Evaluation Time: 6.24 [s]
[2024-09-27 10:36:05,402][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-27 10:36:05,402][root][INFO] - Score: 72.13 [%]  |  Evaluation Time: 5.67 [s]
[2024-09-27 10:36:05,404][root][INFO] - 
[15/ 15 Epoch]
[2024-09-27 10:36:06,343][root][INFO] - Step: 1261/1350  |  Loss: 0.2237  |  Score: 93.20 [%]  |  Seq Length: 256.0
[2024-09-27 10:36:13,743][root][INFO] - Step: 1275/1350  |  Loss: 0.3080  |  Score: 90.65 [%]  |  Seq Length: 256.0
[2024-09-27 10:36:21,651][root][INFO] - Step: 1290/1350  |  Loss: 0.3279  |  Score: 89.96 [%]  |  Seq Length: 256.0
[2024-09-27 10:36:29,668][root][INFO] - Step: 1305/1350  |  Loss: 0.3022  |  Score: 90.59 [%]  |  Seq Length: 256.0
[2024-09-27 10:36:37,679][root][INFO] - Step: 1320/1350  |  Loss: 0.3028  |  Score: 91.28 [%]  |  Seq Length: 256.0
[2024-09-27 10:36:45,634][root][INFO] - Step: 1335/1350  |  Loss: 0.3084  |  Score: 90.93 [%]  |  Seq Length: 256.0
[2024-09-27 10:36:53,634][root][INFO] - Step: 1350/1350  |  Loss: 0.3368  |  Score: 89.26 [%]  |  Seq Length: 256.0
[2024-09-27 10:36:59,886][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-27 10:36:59,887][root][INFO] - Score: 78.28 [%]  |  Evaluation Time: 6.25 [s]
[2024-09-27 10:37:05,621][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-27 10:37:05,621][root][INFO] - Score: 71.53 [%]  |  Evaluation Time: 5.73 [s]
[2024-09-27 10:37:05,622][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-27 10:37:05,622][root][INFO] - - Epoch: 7
[2024-09-27 10:37:05,622][root][INFO] - - DEV score: 78.98 [%]
[2024-09-27 10:37:05,622][root][INFO] - - TEST score: 72.81 [%]
[2024-09-27 10:37:05,623][root][INFO] - Fine-tuning is done!
[2024-09-27 10:40:55,502][root][INFO] - 

[2024-09-27 10:40:55,502][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-27 10:40:55,503][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-27 10:40:55,503][root][INFO] - 

[2024-09-27 10:40:55,503][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-27 10:41:44,648][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-27 10:41:44,649][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-27 10:41:44,649][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-27 10:41:44,650][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-27 10:41:44,650][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-27 10:41:44,650][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-27 10:41:44,651][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-27 10:41:44,651][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-27 10:41:44,652][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-27 10:41:44,652][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-27 10:41:44,653][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-27 10:41:44,653][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-27 10:41:44,654][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-27 10:41:44,654][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-27 10:41:44,654][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-27 10:41:44,655][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-27 10:41:44,655][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-27 10:41:44,656][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-27 10:41:44,656][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-27 10:41:44,657][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-27 10:41:44,657][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-27 10:41:44,657][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-27 10:41:44,658][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-27 10:41:44,658][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-27 10:41:44,660][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-27 10:41:44,846][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-27 10:41:48,720][root][INFO] - 

[2024-09-27 10:41:48,720][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-27 10:41:48,720][root][INFO] - Data Preprocessing
[2024-09-27 10:41:48,720][root][INFO] - ㄴ remain_lang                ko_en_punc
[2024-09-27 10:41:48,721][root][INFO] - ㄴ do_hangeulize              True
[2024-09-27 10:41:48,721][root][INFO] - ㄴ data_remove                True

[2024-09-27 10:41:48,721][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-27 10:41:48,729][root][INFO] - vocab size              : 51200
[2024-09-27 10:41:48,729][root][INFO] - device                  : gpu
[2024-09-27 10:41:48,729][root][INFO] - random seed             : 42
[2024-09-27 10:41:48,729][root][INFO] - train data size         : 4416
[2024-09-27 10:41:48,729][root][INFO] - max epochs              : 15
[2024-09-27 10:41:48,729][root][INFO] - total steps             : 1035
[2024-09-27 10:41:48,729][root][INFO] - warmup steps            : 104
[2024-09-27 10:41:48,729][root][INFO] - batch size              : 64
[2024-09-27 10:41:48,729][root][INFO] - accumulation steps      : 1
[2024-09-27 10:41:48,730][root][INFO] - optimizer               : adamwscale
[2024-09-27 10:41:48,730][root][INFO] - lr_scheduler            : cosine
[2024-09-27 10:41:48,730][root][INFO] - learning rate           : 0.01
[2024-09-27 10:41:48,730][root][INFO] - max length              : 256

[2024-09-27 10:41:48,730][root][INFO] - LoRA Configuration
[2024-09-27 10:41:48,730][root][INFO] - ㄴ r                    : 32
[2024-09-27 10:41:48,730][root][INFO] - ㄴ alpha                : 128
[2024-09-27 10:41:48,730][root][INFO] - ㄴ dropout              : 0.03

[2024-09-27 10:41:48,730][root][INFO] - 

[2024-09-27 10:41:48,730][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-27 10:41:48,730][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-27 10:41:48,730][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb
[2024-09-27 10:41:48,731][root][INFO] - * tb interval   : 15

[2024-09-27 10:41:48,731][root][INFO] - 

[2024-09-27 10:41:48,731][root][INFO] - Start the Training !
[2024-09-27 10:41:48,734][root][INFO] - 
[1/ 15 Epoch]
[2024-09-27 10:41:57,287][root][INFO] - Step: 15/1035  |  Loss: 3.0958  |  Score: 8.16 [%]  |  Seq Length: 256.0
[2024-09-27 10:42:03,017][root][INFO] - Step: 30/1035  |  Loss: 2.3355  |  Score: 16.09 [%]  |  Seq Length: 256.0
[2024-09-27 10:42:08,752][root][INFO] - Step: 45/1035  |  Loss: 1.8017  |  Score: 45.10 [%]  |  Seq Length: 256.0
[2024-09-27 10:43:14,456][root][INFO] - 

[2024-09-27 10:43:14,456][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-27 10:43:14,456][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-27 10:43:14,456][root][INFO] - 

[2024-09-27 10:43:14,456][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-27 10:43:27,302][root][INFO] - 

[2024-09-27 10:43:27,302][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-27 10:43:27,302][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs
[2024-09-27 10:43:27,302][root][INFO] - 

[2024-09-27 10:43:27,302][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-27 10:43:31,980][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-27 10:43:31,981][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-27 10:43:31,981][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-27 10:43:31,982][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-27 10:43:31,982][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-27 10:43:31,983][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-27 10:43:31,983][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-27 10:43:31,984][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-27 10:43:31,984][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-27 10:43:31,985][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-27 10:43:31,985][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-27 10:43:31,986][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-27 10:43:31,986][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-27 10:43:31,987][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-27 10:43:31,988][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-27 10:43:31,988][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-27 10:43:31,989][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-27 10:43:31,989][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-27 10:43:31,990][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-27 10:43:31,990][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-27 10:43:31,991][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-27 10:43:31,992][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-27 10:43:31,992][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-27 10:43:31,993][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-27 10:43:31,995][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-27 10:43:32,260][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-27 10:43:35,946][root][INFO] - 

[2024-09-27 10:43:35,947][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-27 10:43:35,947][root][INFO] - Data Preprocessing
[2024-09-27 10:43:35,947][root][INFO] - ㄴ remain_lang                ko_punc
[2024-09-27 10:43:35,947][root][INFO] - ㄴ do_hangeulize              True
[2024-09-27 10:43:35,947][root][INFO] - ㄴ data_remove                True

[2024-09-27 10:43:35,947][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-27 10:43:35,954][root][INFO] - vocab size              : 51200
[2024-09-27 10:43:35,955][root][INFO] - device                  : gpu
[2024-09-27 10:43:35,955][root][INFO] - random seed             : 42
[2024-09-27 10:43:35,955][root][INFO] - train data size         : 4096
[2024-09-27 10:43:35,955][root][INFO] - max epochs              : 15
[2024-09-27 10:43:35,955][root][INFO] - total steps             : 960
[2024-09-27 10:43:35,955][root][INFO] - warmup steps            : 96
[2024-09-27 10:43:35,955][root][INFO] - batch size              : 64
[2024-09-27 10:43:35,955][root][INFO] - accumulation steps      : 1
[2024-09-27 10:43:35,955][root][INFO] - optimizer               : adamwscale
[2024-09-27 10:43:35,955][root][INFO] - lr_scheduler            : cosine
[2024-09-27 10:43:35,956][root][INFO] - learning rate           : 0.01
[2024-09-27 10:43:35,956][root][INFO] - max length              : 256

[2024-09-27 10:43:35,956][root][INFO] - LoRA Configuration
[2024-09-27 10:43:35,956][root][INFO] - ㄴ r                    : 32
[2024-09-27 10:43:35,956][root][INFO] - ㄴ alpha                : 128
[2024-09-27 10:43:35,956][root][INFO] - ㄴ dropout              : 0.03

[2024-09-27 10:43:35,956][root][INFO] - 

[2024-09-27 10:43:35,956][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs
[2024-09-27 10:43:35,956][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-27 10:43:35,956][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/tb
[2024-09-27 10:43:35,957][root][INFO] - * tb interval   : 15

[2024-09-27 10:43:35,957][root][INFO] - 

[2024-09-27 10:43:35,957][root][INFO] - Start the Training !
[2024-09-27 10:43:35,960][root][INFO] - 
[1/ 15 Epoch]
[2024-09-27 10:43:38,934][root][INFO] - 

[2024-09-27 10:43:38,934][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-27 10:43:38,934][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs
[2024-09-27 10:43:38,934][root][INFO] - 

[2024-09-27 10:43:38,934][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-27 10:43:44,472][root][INFO] - Step: 15/960  |  Loss: 3.1154  |  Score: 6.93 [%]  |  Seq Length: 256.0
[2024-09-27 10:43:46,431][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-27 10:43:46,432][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-27 10:43:46,432][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-27 10:43:46,433][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-27 10:43:46,434][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-27 10:43:46,434][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-27 10:43:46,435][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-27 10:43:46,435][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-27 10:43:46,436][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-27 10:43:46,437][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-27 10:43:46,437][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-27 10:43:46,438][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-27 10:43:46,438][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-27 10:43:46,439][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-27 10:43:46,440][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-27 10:43:46,440][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-27 10:43:46,441][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-27 10:43:46,441][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-27 10:43:46,442][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-27 10:43:46,443][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-27 10:43:46,443][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-27 10:43:46,444][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-27 10:43:46,445][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-27 10:43:46,445][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-27 10:43:46,448][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-27 10:43:46,636][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-27 10:43:50,457][root][INFO] - 

[2024-09-27 10:43:50,457][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-27 10:43:50,457][root][INFO] - Data Preprocessing
[2024-09-27 10:43:50,457][root][INFO] - ㄴ remain_lang                ko_en
[2024-09-27 10:43:50,457][root][INFO] - ㄴ do_hangeulize              True
[2024-09-27 10:43:50,458][root][INFO] - ㄴ data_remove                True

[2024-09-27 10:43:50,458][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-27 10:43:50,468][root][INFO] - vocab size              : 51200
[2024-09-27 10:43:50,468][root][INFO] - device                  : gpu
[2024-09-27 10:43:50,468][root][INFO] - random seed             : 42
[2024-09-27 10:43:50,468][root][INFO] - train data size         : 448
[2024-09-27 10:43:50,468][root][INFO] - max epochs              : 15
[2024-09-27 10:43:50,469][root][INFO] - total steps             : 105
[2024-09-27 10:43:50,469][root][INFO] - warmup steps            : 10
[2024-09-27 10:43:50,469][root][INFO] - batch size              : 64
[2024-09-27 10:43:50,469][root][INFO] - accumulation steps      : 1
[2024-09-27 10:43:50,469][root][INFO] - optimizer               : adamwscale
[2024-09-27 10:43:50,469][root][INFO] - lr_scheduler            : cosine
[2024-09-27 10:43:50,469][root][INFO] - learning rate           : 0.01
[2024-09-27 10:43:50,469][root][INFO] - max length              : 256

[2024-09-27 10:43:50,469][root][INFO] - LoRA Configuration
[2024-09-27 10:43:50,469][root][INFO] - ㄴ r                    : 32
[2024-09-27 10:43:50,469][root][INFO] - ㄴ alpha                : 128
[2024-09-27 10:43:50,470][root][INFO] - ㄴ dropout              : 0.03

[2024-09-27 10:43:50,470][root][INFO] - 

[2024-09-27 10:43:50,470][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs
[2024-09-27 10:43:50,470][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-27 10:43:50,470][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/tb
[2024-09-27 10:43:50,470][root][INFO] - * tb interval   : 15

[2024-09-27 10:43:50,470][root][INFO] - 

[2024-09-27 10:43:50,470][root][INFO] - Start the Training !
[2024-09-27 10:43:50,473][root][INFO] - 
[1/ 15 Epoch]
[2024-09-27 10:43:51,104][root][INFO] - Step: 30/960  |  Loss: 2.3676  |  Score: 21.72 [%]  |  Seq Length: 256.0
[2024-09-27 10:43:55,608][root][INFO] - Step: 7/105  |  Loss: 5.1683  |  Score: -3.42 [%]  |  Seq Length: 256.0
[2024-09-27 10:43:56,033][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-27 10:43:56,033][root][INFO] - Score: 0.34 [%]  |  Evaluation Time: 0.42 [s]
[2024-09-27 10:43:56,465][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-27 10:43:56,465][root][INFO] - Score: -5.79 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 10:43:56,467][root][INFO] - 
[2/ 15 Epoch]
[2024-09-27 10:43:59,197][root][INFO] - Step: 45/960  |  Loss: 1.9307  |  Score: 42.03 [%]  |  Seq Length: 256.0
[2024-09-27 10:43:59,403][root][INFO] - Step: 14/105  |  Loss: 3.0730  |  Score: 12.72 [%]  |  Seq Length: 256.0
[2024-09-27 10:43:59,838][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-27 10:43:59,838][root][INFO] - Score: 0.04 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 10:44:00,238][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-27 10:44:00,238][root][INFO] - Score: 3.71 [%]  |  Evaluation Time: 0.40 [s]
[2024-09-27 10:44:00,239][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-27 10:44:00,240][root][INFO] - 
[3/ 15 Epoch]
[2024-09-27 10:44:01,032][root][INFO] - Step: 15/105  |  Loss: 2.8001  |  Score: 8.07 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:03,167][root][INFO] - Step: 21/105  |  Loss: 2.1650  |  Score: 33.84 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:03,594][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-27 10:44:03,594][root][INFO] - Score: 12.13 [%]  |  Evaluation Time: 0.42 [s]
[2024-09-27 10:44:03,986][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-27 10:44:03,987][root][INFO] - Score: 12.01 [%]  |  Evaluation Time: 0.39 [s]
[2024-09-27 10:44:03,988][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-27 10:44:03,990][root][INFO] - 
[4/ 15 Epoch]
[2024-09-27 10:44:04,971][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-27 10:44:04,971][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-27 10:44:04,972][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-27 10:44:04,973][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-27 10:44:04,973][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-27 10:44:04,974][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-27 10:44:04,974][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-27 10:44:04,975][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-27 10:44:04,975][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-27 10:44:04,976][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-27 10:44:04,976][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-27 10:44:04,977][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-27 10:44:04,977][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-27 10:44:04,978][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-27 10:44:04,979][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-27 10:44:04,979][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-27 10:44:04,980][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-27 10:44:04,980][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-27 10:44:04,981][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-27 10:44:04,981][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-27 10:44:04,982][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-27 10:44:04,983][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-27 10:44:04,983][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-27 10:44:04,984][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-27 10:44:04,986][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-27 10:44:05,321][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-27 10:44:06,850][root][INFO] - Step: 28/105  |  Loss: 1.9360  |  Score: 47.11 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:07,267][root][INFO] - Step: 60/960  |  Loss: 1.5983  |  Score: 59.45 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:07,280][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-27 10:44:07,280][root][INFO] - Score: 18.46 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 10:44:07,671][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-27 10:44:07,671][root][INFO] - Score: 15.58 [%]  |  Evaluation Time: 0.39 [s]
[2024-09-27 10:44:07,672][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-27 10:44:07,673][root][INFO] - 
[5/ 15 Epoch]
[2024-09-27 10:44:08,692][root][INFO] - Step: 30/105  |  Loss: 1.2118  |  Score: 66.40 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:09,225][root][INFO] - 

[2024-09-27 10:44:09,225][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-27 10:44:09,225][root][INFO] - Data Preprocessing
[2024-09-27 10:44:09,225][root][INFO] - ㄴ remain_lang                ko_en_punc
[2024-09-27 10:44:09,226][root][INFO] - ㄴ do_hangeulize              True
[2024-09-27 10:44:09,226][root][INFO] - ㄴ data_remove                True

[2024-09-27 10:44:09,226][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-27 10:44:09,234][root][INFO] - vocab size              : 51200
[2024-09-27 10:44:09,234][root][INFO] - device                  : gpu
[2024-09-27 10:44:09,234][root][INFO] - random seed             : 42
[2024-09-27 10:44:09,234][root][INFO] - train data size         : 4416
[2024-09-27 10:44:09,235][root][INFO] - max epochs              : 15
[2024-09-27 10:44:09,235][root][INFO] - total steps             : 1035
[2024-09-27 10:44:09,235][root][INFO] - warmup steps            : 104
[2024-09-27 10:44:09,235][root][INFO] - batch size              : 64
[2024-09-27 10:44:09,235][root][INFO] - accumulation steps      : 1
[2024-09-27 10:44:09,235][root][INFO] - optimizer               : adamwscale
[2024-09-27 10:44:09,235][root][INFO] - lr_scheduler            : cosine
[2024-09-27 10:44:09,235][root][INFO] - learning rate           : 0.01
[2024-09-27 10:44:09,235][root][INFO] - max length              : 256

[2024-09-27 10:44:09,235][root][INFO] - LoRA Configuration
[2024-09-27 10:44:09,235][root][INFO] - ㄴ r                    : 32
[2024-09-27 10:44:09,235][root][INFO] - ㄴ alpha                : 128
[2024-09-27 10:44:09,235][root][INFO] - ㄴ dropout              : 0.03

[2024-09-27 10:44:09,236][root][INFO] - 

[2024-09-27 10:44:09,236][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-27 10:44:09,236][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-27 10:44:09,236][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb
[2024-09-27 10:44:09,236][root][INFO] - * tb interval   : 15

[2024-09-27 10:44:09,236][root][INFO] - 

[2024-09-27 10:44:09,236][root][INFO] - Start the Training !
[2024-09-27 10:44:09,239][root][INFO] - 
[1/ 15 Epoch]
[2024-09-27 10:44:09,467][root][INFO] - Step: 64/960  |  Loss: 1.5560  |  Score: 56.52 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:10,476][root][INFO] - Step: 35/105  |  Loss: 1.6930  |  Score: 55.56 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:10,900][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-27 10:44:10,900][root][INFO] - Score: 30.53 [%]  |  Evaluation Time: 0.42 [s]
[2024-09-27 10:44:11,313][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-27 10:44:11,313][root][INFO] - Score: 20.05 [%]  |  Evaluation Time: 0.41 [s]
[2024-09-27 10:44:11,314][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-27 10:44:11,315][root][INFO] - 
[6/ 15 Epoch]
[2024-09-27 10:44:13,499][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-27 10:44:13,499][root][INFO] - Score: 72.98 [%]  |  Evaluation Time: 4.03 [s]
[2024-09-27 10:44:14,103][root][INFO] - Step: 42/105  |  Loss: 1.3194  |  Score: 68.91 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:14,513][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-27 10:44:14,513][root][INFO] - Score: 33.20 [%]  |  Evaluation Time: 0.41 [s]
[2024-09-27 10:44:14,923][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-27 10:44:14,923][root][INFO] - Score: 26.87 [%]  |  Evaluation Time: 0.41 [s]
[2024-09-27 10:44:14,924][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-27 10:44:14,926][root][INFO] - 
[7/ 15 Epoch]
[2024-09-27 10:44:16,466][root][INFO] - Step: 45/105  |  Loss: 1.3292  |  Score: 68.61 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:17,534][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-27 10:44:17,535][root][INFO] - Score: 65.27 [%]  |  Evaluation Time: 4.03 [s]
[2024-09-27 10:44:17,536][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-27 10:44:17,537][root][INFO] - 
[2/ 15 Epoch]
[2024-09-27 10:44:17,795][root][INFO] - Step: 15/1035  |  Loss: 3.0958  |  Score: 8.16 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:17,869][root][INFO] - Step: 49/105  |  Loss: 0.9660  |  Score: 79.79 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:18,295][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-27 10:44:18,296][root][INFO] - Score: 40.50 [%]  |  Evaluation Time: 0.42 [s]
[2024-09-27 10:44:18,697][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-27 10:44:18,697][root][INFO] - Score: 30.43 [%]  |  Evaluation Time: 0.40 [s]
[2024-09-27 10:44:18,698][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-27 10:44:18,699][root][INFO] - 
[8/ 15 Epoch]
[2024-09-27 10:44:21,484][root][INFO] - Step: 56/105  |  Loss: 0.8530  |  Score: 79.12 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:21,913][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-27 10:44:21,913][root][INFO] - Score: 45.22 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 10:44:22,344][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-27 10:44:22,344][root][INFO] - Score: 35.35 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 10:44:22,345][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-27 10:44:22,346][root][INFO] - 
[9/ 15 Epoch]
[2024-09-27 10:44:23,524][root][INFO] - Step: 30/1035  |  Loss: 2.3355  |  Score: 16.09 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:23,855][root][INFO] - Step: 75/960  |  Loss: 1.5293  |  Score: 58.12 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:24,137][root][INFO] - Step: 60/105  |  Loss: 0.8274  |  Score: 82.44 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:25,162][root][INFO] - Step: 63/105  |  Loss: 0.6864  |  Score: 83.17 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:25,595][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-27 10:44:25,596][root][INFO] - Score: 45.49 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 10:44:25,996][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-27 10:44:25,997][root][INFO] - Score: 34.72 [%]  |  Evaluation Time: 0.40 [s]
[2024-09-27 10:44:25,999][root][INFO] - 
[10/ 15 Epoch]
[2024-09-27 10:44:28,907][root][INFO] - Step: 70/105  |  Loss: 0.6397  |  Score: 85.49 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:29,245][root][INFO] - Step: 45/1035  |  Loss: 1.8017  |  Score: 45.10 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:29,328][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-27 10:44:29,328][root][INFO] - Score: 47.42 [%]  |  Evaluation Time: 0.42 [s]
[2024-09-27 10:44:29,730][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-27 10:44:29,730][root][INFO] - Score: 33.49 [%]  |  Evaluation Time: 0.40 [s]
[2024-09-27 10:44:29,731][root][INFO] - 
Save new Best Score (Epoch: 10)
[2024-09-27 10:44:29,732][root][INFO] - 
[11/ 15 Epoch]
[2024-09-27 10:44:31,890][root][INFO] - Step: 75/105  |  Loss: 0.5902  |  Score: 87.01 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:31,945][root][INFO] - Step: 90/960  |  Loss: 1.2015  |  Score: 67.93 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:32,564][root][INFO] - Step: 77/105  |  Loss: 0.5839  |  Score: 86.89 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:33,001][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-27 10:44:33,001][root][INFO] - Score: 46.19 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 10:44:33,422][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-27 10:44:33,422][root][INFO] - Score: 34.71 [%]  |  Evaluation Time: 0.42 [s]
[2024-09-27 10:44:33,424][root][INFO] - 
[12/ 15 Epoch]
[2024-09-27 10:44:34,968][root][INFO] - Step: 60/1035  |  Loss: 1.5566  |  Score: 57.29 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:36,351][root][INFO] - Step: 84/105  |  Loss: 0.6058  |  Score: 87.52 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:36,791][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-27 10:44:36,791][root][INFO] - Score: 45.75 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 10:44:37,191][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-27 10:44:37,191][root][INFO] - Score: 36.12 [%]  |  Evaluation Time: 0.40 [s]
[2024-09-27 10:44:37,192][root][INFO] - 
Save new Best Score (Epoch: 12)
[2024-09-27 10:44:37,193][root][INFO] - 
[13/ 15 Epoch]
[2024-09-27 10:44:38,427][root][INFO] - Step: 69/1035  |  Loss: 1.4944  |  Score: 63.15 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:39,697][root][INFO] - Step: 90/105  |  Loss: 0.5369  |  Score: 88.19 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:40,008][root][INFO] - Step: 91/105  |  Loss: 0.3551  |  Score: 91.83 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:40,078][root][INFO] - Step: 105/960  |  Loss: 1.4899  |  Score: 63.51 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:40,433][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-27 10:44:40,434][root][INFO] - Score: 46.16 [%]  |  Evaluation Time: 0.42 [s]
[2024-09-27 10:44:40,869][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-27 10:44:40,869][root][INFO] - Score: 36.51 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 10:44:40,870][root][INFO] - 
Save new Best Score (Epoch: 13)
[2024-09-27 10:44:40,871][root][INFO] - 
[14/ 15 Epoch]
[2024-09-27 10:44:41,680][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-27 10:44:41,680][root][INFO] - Score: 74.32 [%]  |  Evaluation Time: 3.25 [s]
[2024-09-27 10:44:43,838][root][INFO] - Step: 98/105  |  Loss: 0.5140  |  Score: 88.20 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:44,269][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-27 10:44:44,269][root][INFO] - Score: 45.93 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 10:44:44,674][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-27 10:44:44,674][root][INFO] - Score: 35.96 [%]  |  Evaluation Time: 0.40 [s]
[2024-09-27 10:44:44,676][root][INFO] - 
[15/ 15 Epoch]
[2024-09-27 10:44:44,712][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-27 10:44:44,712][root][INFO] - Score: 67.53 [%]  |  Evaluation Time: 3.03 [s]
[2024-09-27 10:44:44,713][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-27 10:44:44,715][root][INFO] - 
[2/ 15 Epoch]
[2024-09-27 10:44:47,416][root][INFO] - Step: 75/1035  |  Loss: 1.3669  |  Score: 62.41 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:47,505][root][INFO] - Step: 105/105  |  Loss: 0.4895  |  Score: 88.25 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:47,936][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-27 10:44:47,936][root][INFO] - Score: 46.26 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 10:44:48,251][root][INFO] - Step: 120/960  |  Loss: 1.2131  |  Score: 69.03 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:48,323][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-27 10:44:48,323][root][INFO] - Score: 36.18 [%]  |  Evaluation Time: 0.38 [s]
[2024-09-27 10:44:48,325][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-27 10:44:48,325][root][INFO] - - Epoch: 13
[2024-09-27 10:44:48,325][root][INFO] - - DEV score: 46.16 [%]
[2024-09-27 10:44:48,325][root][INFO] - - TEST score: 36.51 [%]
[2024-09-27 10:44:48,327][root][INFO] - Fine-tuning is done!
[2024-09-27 10:44:52,626][root][INFO] - Step: 128/960  |  Loss: 1.3841  |  Score: 66.19 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:53,143][root][INFO] - Step: 90/1035  |  Loss: 1.4497  |  Score: 63.63 [%]  |  Seq Length: 256.0
[2024-09-27 10:44:54,707][root][INFO] - 

[2024-09-27 10:44:54,708][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-27 10:44:54,708][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs
[2024-09-27 10:44:54,708][root][INFO] - 

[2024-09-27 10:44:54,708][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-27 10:44:56,629][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-27 10:44:56,629][root][INFO] - Score: 76.66 [%]  |  Evaluation Time: 4.00 [s]
[2024-09-27 10:44:58,864][root][INFO] - Step: 105/1035  |  Loss: 1.4284  |  Score: 66.68 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:00,787][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-27 10:45:00,788][root][INFO] - Score: 67.80 [%]  |  Evaluation Time: 4.16 [s]
[2024-09-27 10:45:00,789][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-27 10:45:00,790][root][INFO] - 
[3/ 15 Epoch]
[2024-09-27 10:45:01,940][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-27 10:45:01,941][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-27 10:45:01,942][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-27 10:45:01,942][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-27 10:45:01,943][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-27 10:45:01,943][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-27 10:45:01,943][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-27 10:45:01,944][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-27 10:45:01,944][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-27 10:45:01,945][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-27 10:45:01,945][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-27 10:45:01,946][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-27 10:45:01,946][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-27 10:45:01,947][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-27 10:45:01,947][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-27 10:45:01,948][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-27 10:45:01,948][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-27 10:45:01,949][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-27 10:45:01,949][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-27 10:45:01,950][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-27 10:45:01,950][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-27 10:45:01,951][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-27 10:45:01,951][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-27 10:45:01,952][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-27 10:45:01,953][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-27 10:45:01,959][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-27 10:45:02,065][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-27 10:45:02,067][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-27 10:45:02,503][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-27 10:45:04,593][root][INFO] - Step: 120/1035  |  Loss: 1.2391  |  Score: 64.02 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:04,947][root][INFO] - Step: 135/960  |  Loss: 1.1357  |  Score: 72.61 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:08,907][root][INFO] - 

[2024-09-27 10:45:08,907][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-27 10:45:08,907][root][INFO] - Data Preprocessing
[2024-09-27 10:45:08,907][root][INFO] - ㄴ remain_lang                ko_en
[2024-09-27 10:45:08,907][root][INFO] - ㄴ do_hangeulize              True
[2024-09-27 10:45:08,907][root][INFO] - ㄴ data_remove                True

[2024-09-27 10:45:08,908][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-27 10:45:08,915][root][INFO] - vocab size              : 51200
[2024-09-27 10:45:08,915][root][INFO] - device                  : gpu
[2024-09-27 10:45:08,916][root][INFO] - random seed             : 42
[2024-09-27 10:45:08,916][root][INFO] - train data size         : 448
[2024-09-27 10:45:08,916][root][INFO] - max epochs              : 15
[2024-09-27 10:45:08,916][root][INFO] - total steps             : 105
[2024-09-27 10:45:08,916][root][INFO] - warmup steps            : 10
[2024-09-27 10:45:08,916][root][INFO] - batch size              : 64
[2024-09-27 10:45:08,916][root][INFO] - accumulation steps      : 1
[2024-09-27 10:45:08,916][root][INFO] - optimizer               : adamwscale
[2024-09-27 10:45:08,916][root][INFO] - lr_scheduler            : cosine
[2024-09-27 10:45:08,916][root][INFO] - learning rate           : 0.01
[2024-09-27 10:45:08,916][root][INFO] - max length              : 256

[2024-09-27 10:45:08,917][root][INFO] - LoRA Configuration
[2024-09-27 10:45:08,917][root][INFO] - ㄴ r                    : 32
[2024-09-27 10:45:08,917][root][INFO] - ㄴ alpha                : 128
[2024-09-27 10:45:08,917][root][INFO] - ㄴ dropout              : 0.03

[2024-09-27 10:45:08,917][root][INFO] - KOMBO Configuration
[2024-09-27 10:45:08,917][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-27 10:45:08,917][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-27 10:45:08,917][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-27 10:45:08,917][root][INFO] - ㄴ do_combination       : True
[2024-09-27 10:45:08,917][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-27 10:45:08,918][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-27 10:45:08,918][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-27 10:45:08,918][root][INFO] -   ㄴ add_lora           : True

[2024-09-27 10:45:08,918][root][INFO] - LoRA in KOMBO Configuration
[2024-09-27 10:45:08,918][root][INFO] - ㄴ r                : 32
[2024-09-27 10:45:08,918][root][INFO] - ㄴ alpha            : 128
[2024-09-27 10:45:08,918][root][INFO] - ㄴ dropout          : 0.03

[2024-09-27 10:45:08,918][root][INFO] - 

[2024-09-27 10:45:08,918][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs
[2024-09-27 10:45:08,918][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-27 10:45:08,918][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/tb
[2024-09-27 10:45:08,919][root][INFO] - * tb interval   : 15

[2024-09-27 10:45:08,919][root][INFO] - 

[2024-09-27 10:45:08,919][root][INFO] - Start the Training !
[2024-09-27 10:45:08,922][root][INFO] - 
[1/ 15 Epoch]
[2024-09-27 10:45:10,317][root][INFO] - Step: 135/1035  |  Loss: 1.2147  |  Score: 64.63 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:11,493][root][INFO] - Step: 138/1035  |  Loss: 1.2541  |  Score: 65.57 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:13,106][root][INFO] - Step: 150/960  |  Loss: 1.2151  |  Score: 70.06 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:13,358][root][INFO] - Step: 7/105  |  Loss: 4.9052  |  Score: 2.09 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:13,828][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-27 10:45:13,828][root][INFO] - Score: -0.21 [%]  |  Evaluation Time: 0.47 [s]
[2024-09-27 10:45:14,287][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-27 10:45:14,287][root][INFO] - Score: -4.51 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-27 10:45:14,289][root][INFO] - 
[2/ 15 Epoch]
[2024-09-27 10:45:14,680][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-27 10:45:14,680][root][INFO] - Score: 76.00 [%]  |  Evaluation Time: 3.18 [s]
[2024-09-27 10:45:17,774][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-27 10:45:17,774][root][INFO] - Score: 67.77 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-27 10:45:17,775][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-27 10:45:17,777][root][INFO] - 
[3/ 15 Epoch]
[2024-09-27 10:45:18,016][root][INFO] - Step: 14/105  |  Loss: 2.7674  |  Score: 8.69 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:18,474][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-27 10:45:18,475][root][INFO] - Score: -0.29 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-27 10:45:18,914][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-27 10:45:18,914][root][INFO] - Score: 7.75 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 10:45:18,915][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-27 10:45:18,917][root][INFO] - 
[3/ 15 Epoch]
[2024-09-27 10:45:19,707][root][INFO] - Step: 15/105  |  Loss: 2.3790  |  Score: 20.93 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:21,262][root][INFO] - Step: 165/960  |  Loss: 1.0905  |  Score: 68.26 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:22,491][root][INFO] - Step: 21/105  |  Loss: 2.1748  |  Score: 34.84 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:22,839][root][INFO] - Step: 150/1035  |  Loss: 1.1123  |  Score: 71.23 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:22,952][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-27 10:45:22,952][root][INFO] - Score: 14.86 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-27 10:45:23,373][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-27 10:45:23,373][root][INFO] - Score: 11.91 [%]  |  Evaluation Time: 0.42 [s]
[2024-09-27 10:45:23,374][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-27 10:45:23,375][root][INFO] - 
[4/ 15 Epoch]
[2024-09-27 10:45:26,871][root][INFO] - Step: 28/105  |  Loss: 1.8530  |  Score: 52.87 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:27,351][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-27 10:45:27,351][root][INFO] - Score: 19.25 [%]  |  Evaluation Time: 0.48 [s]
[2024-09-27 10:45:27,767][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-27 10:45:27,767][root][INFO] - Score: 17.67 [%]  |  Evaluation Time: 0.41 [s]
[2024-09-27 10:45:27,768][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-27 10:45:27,770][root][INFO] - 
[5/ 15 Epoch]
[2024-09-27 10:45:28,576][root][INFO] - Step: 165/1035  |  Loss: 1.1917  |  Score: 71.27 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:29,052][root][INFO] - Step: 30/105  |  Loss: 1.7639  |  Score: 59.47 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:29,353][root][INFO] - Step: 180/960  |  Loss: 1.0470  |  Score: 71.87 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:31,359][root][INFO] - Step: 35/105  |  Loss: 1.4561  |  Score: 61.93 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:31,812][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-27 10:45:31,812][root][INFO] - Score: 34.56 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-27 10:45:32,243][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-27 10:45:32,243][root][INFO] - Score: 30.14 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 10:45:32,244][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-27 10:45:32,245][root][INFO] - 
[6/ 15 Epoch]
[2024-09-27 10:45:34,305][root][INFO] - Step: 180/1035  |  Loss: 1.0880  |  Score: 67.75 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:35,893][root][INFO] - Step: 192/960  |  Loss: 1.0954  |  Score: 71.81 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:35,953][root][INFO] - Step: 42/105  |  Loss: 1.3013  |  Score: 69.38 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:36,428][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-27 10:45:36,429][root][INFO] - Score: 36.08 [%]  |  Evaluation Time: 0.47 [s]
[2024-09-27 10:45:36,862][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-27 10:45:36,862][root][INFO] - Score: 34.87 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 10:45:36,863][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-27 10:45:36,865][root][INFO] - 
[7/ 15 Epoch]
[2024-09-27 10:45:38,757][root][INFO] - Step: 45/105  |  Loss: 0.9154  |  Score: 80.62 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:39,956][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-27 10:45:39,956][root][INFO] - Score: 72.98 [%]  |  Evaluation Time: 4.06 [s]
[2024-09-27 10:45:40,027][root][INFO] - Step: 195/1035  |  Loss: 1.2009  |  Score: 69.56 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:40,567][root][INFO] - Step: 49/105  |  Loss: 1.0351  |  Score: 77.82 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:41,046][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-27 10:45:41,046][root][INFO] - Score: 43.04 [%]  |  Evaluation Time: 0.48 [s]
[2024-09-27 10:45:41,462][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-27 10:45:41,462][root][INFO] - Score: 39.86 [%]  |  Evaluation Time: 0.41 [s]
[2024-09-27 10:45:41,463][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-27 10:45:41,465][root][INFO] - 
[8/ 15 Epoch]
[2024-09-27 10:45:44,023][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-27 10:45:44,023][root][INFO] - Score: 68.67 [%]  |  Evaluation Time: 4.06 [s]
[2024-09-27 10:45:44,026][root][INFO] - 
[4/ 15 Epoch]
[2024-09-27 10:45:44,641][root][INFO] - Step: 207/1035  |  Loss: 1.0819  |  Score: 71.52 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:45,078][root][INFO] - Step: 56/105  |  Loss: 0.8192  |  Score: 81.77 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:45,520][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-27 10:45:45,520][root][INFO] - Score: 46.31 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 10:45:45,922][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-27 10:45:45,922][root][INFO] - Score: 41.63 [%]  |  Evaluation Time: 0.40 [s]
[2024-09-27 10:45:45,923][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-27 10:45:45,926][root][INFO] - 
[9/ 15 Epoch]
[2024-09-27 10:45:46,128][root][INFO] - Step: 195/960  |  Loss: 1.0279  |  Score: 75.76 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:47,921][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-27 10:45:47,921][root][INFO] - Score: 77.30 [%]  |  Evaluation Time: 3.28 [s]
[2024-09-27 10:45:48,164][root][INFO] - Step: 60/105  |  Loss: 0.7314  |  Score: 83.70 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:49,494][root][INFO] - Step: 63/105  |  Loss: 0.6910  |  Score: 84.06 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:49,967][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-27 10:45:49,967][root][INFO] - Score: 45.16 [%]  |  Evaluation Time: 0.47 [s]
[2024-09-27 10:45:50,404][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-27 10:45:50,404][root][INFO] - Score: 39.72 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 10:45:50,406][root][INFO] - 
[10/ 15 Epoch]
[2024-09-27 10:45:51,003][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-27 10:45:51,004][root][INFO] - Score: 69.49 [%]  |  Evaluation Time: 3.08 [s]
[2024-09-27 10:45:51,005][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-27 10:45:51,006][root][INFO] - 
[4/ 15 Epoch]
[2024-09-27 10:45:52,542][root][INFO] - Step: 210/1035  |  Loss: 0.8739  |  Score: 74.58 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:54,156][root][INFO] - Step: 70/105  |  Loss: 0.6464  |  Score: 85.38 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:54,376][root][INFO] - Step: 210/960  |  Loss: 0.9657  |  Score: 75.43 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:54,623][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-27 10:45:54,624][root][INFO] - Score: 43.47 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-27 10:45:55,047][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-27 10:45:55,047][root][INFO] - Score: 38.66 [%]  |  Evaluation Time: 0.42 [s]
[2024-09-27 10:45:55,049][root][INFO] - 
[11/ 15 Epoch]
[2024-09-27 10:45:57,793][root][INFO] - Step: 75/105  |  Loss: 0.5681  |  Score: 84.65 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:58,281][root][INFO] - Step: 225/1035  |  Loss: 1.0253  |  Score: 74.23 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:58,682][root][INFO] - Step: 77/105  |  Loss: 0.5691  |  Score: 87.33 [%]  |  Seq Length: 256.0
[2024-09-27 10:45:59,154][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-27 10:45:59,154][root][INFO] - Score: 42.63 [%]  |  Evaluation Time: 0.47 [s]
[2024-09-27 10:45:59,588][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-27 10:45:59,588][root][INFO] - Score: 39.21 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 10:45:59,590][root][INFO] - 
[12/ 15 Epoch]
[2024-09-27 10:46:02,620][root][INFO] - Step: 225/960  |  Loss: 0.8782  |  Score: 77.91 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:03,193][root][INFO] - Step: 84/105  |  Loss: 0.5730  |  Score: 87.61 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:03,670][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-27 10:46:03,670][root][INFO] - Score: 44.92 [%]  |  Evaluation Time: 0.47 [s]
[2024-09-27 10:46:04,010][root][INFO] - Step: 240/1035  |  Loss: 0.9163  |  Score: 76.18 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:04,100][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-27 10:46:04,101][root][INFO] - Score: 39.33 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 10:46:04,103][root][INFO] - 
[13/ 15 Epoch]
[2024-09-27 10:46:07,403][root][INFO] - Step: 90/105  |  Loss: 0.5030  |  Score: 89.04 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:07,776][root][INFO] - Step: 91/105  |  Loss: 0.5010  |  Score: 90.15 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:08,236][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-27 10:46:08,236][root][INFO] - Score: 43.61 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-27 10:46:08,652][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-27 10:46:08,653][root][INFO] - Score: 40.29 [%]  |  Evaluation Time: 0.41 [s]
[2024-09-27 10:46:08,654][root][INFO] - 
[14/ 15 Epoch]
[2024-09-27 10:46:09,733][root][INFO] - Step: 255/1035  |  Loss: 0.9189  |  Score: 75.72 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:10,842][root][INFO] - Step: 240/960  |  Loss: 0.8963  |  Score: 76.09 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:12,227][root][INFO] - Step: 98/105  |  Loss: 0.4635  |  Score: 88.93 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:12,689][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-27 10:46:12,689][root][INFO] - Score: 43.81 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-27 10:46:13,105][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-27 10:46:13,106][root][INFO] - Score: 40.05 [%]  |  Evaluation Time: 0.41 [s]
[2024-09-27 10:46:13,107][root][INFO] - 
[15/ 15 Epoch]
[2024-09-27 10:46:15,474][root][INFO] - Step: 270/1035  |  Loss: 0.9372  |  Score: 74.28 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:16,684][root][INFO] - Step: 105/105  |  Loss: 0.5544  |  Score: 87.30 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:17,151][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-27 10:46:17,151][root][INFO] - Score: 44.42 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-27 10:46:17,584][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-27 10:46:17,584][root][INFO] - Score: 40.53 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 10:46:17,585][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-27 10:46:17,585][root][INFO] - - Epoch: 8
[2024-09-27 10:46:17,585][root][INFO] - - DEV score: 46.31 [%]
[2024-09-27 10:46:17,585][root][INFO] - - TEST score: 41.63 [%]
[2024-09-27 10:46:17,586][root][INFO] - Fine-tuning is done!
[2024-09-27 10:46:17,795][root][INFO] - Step: 276/1035  |  Loss: 1.1066  |  Score: 73.11 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:19,066][root][INFO] - Step: 255/960  |  Loss: 0.9422  |  Score: 73.50 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:19,696][root][INFO] - Step: 256/960  |  Loss: 1.1633  |  Score: 53.52 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:20,919][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-27 10:46:20,919][root][INFO] - Score: 77.08 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-27 10:46:23,806][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-27 10:46:23,806][root][INFO] - Score: 77.35 [%]  |  Evaluation Time: 4.11 [s]
[2024-09-27 10:46:24,044][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-27 10:46:24,044][root][INFO] - Score: 69.69 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-27 10:46:24,047][root][INFO] - 
[5/ 15 Epoch]
[2024-09-27 10:46:24,360][root][INFO] - 

[2024-09-27 10:46:24,360][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-27 10:46:24,360][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs
[2024-09-27 10:46:24,360][root][INFO] - 

[2024-09-27 10:46:24,361][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en', 'do_hangeulize': False, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-27 10:46:27,787][root][INFO] - Step: 285/1035  |  Loss: 0.9986  |  Score: 74.55 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:27,914][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-27 10:46:27,914][root][INFO] - Score: 68.94 [%]  |  Evaluation Time: 4.10 [s]
[2024-09-27 10:46:27,916][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-27 10:46:27,917][root][INFO] - 
[5/ 15 Epoch]
[2024-09-27 10:46:28,175][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-27 10:46:28,176][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-27 10:46:28,176][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-27 10:46:28,177][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-27 10:46:28,178][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-27 10:46:28,178][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-27 10:46:28,179][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-27 10:46:28,180][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-27 10:46:28,180][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-27 10:46:28,181][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-27 10:46:28,182][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-27 10:46:28,182][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-27 10:46:28,183][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-27 10:46:28,184][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-27 10:46:28,184][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-27 10:46:28,185][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-27 10:46:28,186][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-27 10:46:28,187][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-27 10:46:28,187][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-27 10:46:28,188][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-27 10:46:28,189][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-27 10:46:28,190][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-27 10:46:28,190][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-27 10:46:28,191][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-27 10:46:28,193][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-27 10:46:28,463][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-27 10:46:32,544][root][INFO] - 

[2024-09-27 10:46:32,544][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-27 10:46:32,544][root][INFO] - Data Preprocessing
[2024-09-27 10:46:32,544][root][INFO] - ㄴ remain_lang                ko_en
[2024-09-27 10:46:32,544][root][INFO] - ㄴ do_hangeulize              False
[2024-09-27 10:46:32,545][root][INFO] - ㄴ data_remove                True

[2024-09-27 10:46:32,545][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-27 10:46:32,555][root][INFO] - vocab size              : 51200
[2024-09-27 10:46:32,555][root][INFO] - device                  : gpu
[2024-09-27 10:46:32,555][root][INFO] - random seed             : 42
[2024-09-27 10:46:32,555][root][INFO] - train data size         : 448
[2024-09-27 10:46:32,556][root][INFO] - max epochs              : 15
[2024-09-27 10:46:32,556][root][INFO] - total steps             : 105
[2024-09-27 10:46:32,556][root][INFO] - warmup steps            : 10
[2024-09-27 10:46:32,556][root][INFO] - batch size              : 64
[2024-09-27 10:46:32,556][root][INFO] - accumulation steps      : 1
[2024-09-27 10:46:32,556][root][INFO] - optimizer               : adamwscale
[2024-09-27 10:46:32,556][root][INFO] - lr_scheduler            : cosine
[2024-09-27 10:46:32,556][root][INFO] - learning rate           : 0.01
[2024-09-27 10:46:32,557][root][INFO] - max length              : 256

[2024-09-27 10:46:32,557][root][INFO] - LoRA Configuration
[2024-09-27 10:46:32,557][root][INFO] - ㄴ r                    : 32
[2024-09-27 10:46:32,557][root][INFO] - ㄴ alpha                : 128
[2024-09-27 10:46:32,557][root][INFO] - ㄴ dropout              : 0.03

[2024-09-27 10:46:32,557][root][INFO] - 

[2024-09-27 10:46:32,557][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs
[2024-09-27 10:46:32,558][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-27 10:46:32,558][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/tb
[2024-09-27 10:46:32,558][root][INFO] - * tb interval   : 15

[2024-09-27 10:46:32,558][root][INFO] - 

[2024-09-27 10:46:32,558][root][INFO] - Start the Training !
[2024-09-27 10:46:32,561][root][INFO] - 
[1/ 15 Epoch]
[2024-09-27 10:46:33,547][root][INFO] - Step: 300/1035  |  Loss: 0.8740  |  Score: 77.12 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:36,064][root][INFO] - Step: 270/960  |  Loss: 0.7968  |  Score: 81.47 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:37,925][root][INFO] - Step: 7/105  |  Loss: 5.1705  |  Score: -2.72 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:38,322][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-27 10:46:38,322][root][INFO] - Score: -0.04 [%]  |  Evaluation Time: 0.39 [s]
[2024-09-27 10:46:38,681][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-27 10:46:38,681][root][INFO] - Score: -6.61 [%]  |  Evaluation Time: 0.36 [s]
[2024-09-27 10:46:38,684][root][INFO] - 
[2/ 15 Epoch]
[2024-09-27 10:46:39,281][root][INFO] - Step: 315/1035  |  Loss: 0.8578  |  Score: 76.20 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:41,460][root][INFO] - Step: 14/105  |  Loss: 3.0956  |  Score: 11.21 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:41,834][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-27 10:46:41,835][root][INFO] - Score: -1.77 [%]  |  Evaluation Time: 0.37 [s]
[2024-09-27 10:46:42,220][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-27 10:46:42,221][root][INFO] - Score: 3.04 [%]  |  Evaluation Time: 0.38 [s]
[2024-09-27 10:46:42,222][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-27 10:46:42,224][root][INFO] - 
[3/ 15 Epoch]
[2024-09-27 10:46:43,068][root][INFO] - Step: 15/105  |  Loss: 2.8067  |  Score: 7.03 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:44,300][root][INFO] - Step: 285/960  |  Loss: 0.8378  |  Score: 76.31 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:45,004][root][INFO] - Step: 330/1035  |  Loss: 0.7827  |  Score: 77.88 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:45,183][root][INFO] - Step: 21/105  |  Loss: 2.1494  |  Score: 34.32 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:45,565][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-27 10:46:45,565][root][INFO] - Score: 10.11 [%]  |  Evaluation Time: 0.38 [s]
[2024-09-27 10:46:45,917][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-27 10:46:45,917][root][INFO] - Score: 12.20 [%]  |  Evaluation Time: 0.35 [s]
[2024-09-27 10:46:45,918][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-27 10:46:45,919][root][INFO] - 
[4/ 15 Epoch]
[2024-09-27 10:46:48,694][root][INFO] - Step: 28/105  |  Loss: 1.9447  |  Score: 46.93 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:49,078][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-27 10:46:49,079][root][INFO] - Score: 17.12 [%]  |  Evaluation Time: 0.38 [s]
[2024-09-27 10:46:49,469][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-27 10:46:49,469][root][INFO] - Score: 15.35 [%]  |  Evaluation Time: 0.39 [s]
[2024-09-27 10:46:49,470][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-27 10:46:49,471][root][INFO] - 
[5/ 15 Epoch]
[2024-09-27 10:46:50,506][root][INFO] - Step: 30/105  |  Loss: 1.2170  |  Score: 66.13 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:50,771][root][INFO] - Step: 345/1035  |  Loss: 0.8569  |  Score: 76.31 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:52,256][root][INFO] - Step: 35/105  |  Loss: 1.7033  |  Score: 55.31 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:52,424][root][INFO] - Step: 300/960  |  Loss: 0.8731  |  Score: 78.09 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:52,637][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-27 10:46:52,638][root][INFO] - Score: 26.62 [%]  |  Evaluation Time: 0.38 [s]
[2024-09-27 10:46:52,983][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-27 10:46:52,983][root][INFO] - Score: 20.78 [%]  |  Evaluation Time: 0.34 [s]
[2024-09-27 10:46:52,984][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-27 10:46:52,986][root][INFO] - 
[6/ 15 Epoch]
[2024-09-27 10:46:53,930][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-27 10:46:53,930][root][INFO] - Score: 77.69 [%]  |  Evaluation Time: 3.15 [s]
[2024-09-27 10:46:55,744][root][INFO] - Step: 42/105  |  Loss: 1.3018  |  Score: 69.11 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:56,122][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-27 10:46:56,123][root][INFO] - Score: 30.90 [%]  |  Evaluation Time: 0.38 [s]
[2024-09-27 10:46:56,503][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-27 10:46:56,503][root][INFO] - Score: 25.53 [%]  |  Evaluation Time: 0.38 [s]
[2024-09-27 10:46:56,504][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-27 10:46:56,505][root][INFO] - 
[7/ 15 Epoch]
[2024-09-27 10:46:57,030][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-27 10:46:57,030][root][INFO] - Score: 71.06 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-27 10:46:57,031][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-27 10:46:57,033][root][INFO] - 
[6/ 15 Epoch]
[2024-09-27 10:46:57,757][root][INFO] - Step: 346/1035  |  Loss: 0.7095  |  Score: 80.67 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:57,929][root][INFO] - Step: 45/105  |  Loss: 1.3032  |  Score: 68.69 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:59,320][root][INFO] - Step: 49/105  |  Loss: 0.9530  |  Score: 80.06 [%]  |  Seq Length: 256.0
[2024-09-27 10:46:59,711][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-27 10:46:59,711][root][INFO] - Score: 36.42 [%]  |  Evaluation Time: 0.39 [s]
[2024-09-27 10:47:00,079][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-27 10:47:00,079][root][INFO] - Score: 30.48 [%]  |  Evaluation Time: 0.37 [s]
[2024-09-27 10:47:00,080][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-27 10:47:00,081][root][INFO] - 
[8/ 15 Epoch]
[2024-09-27 10:47:00,664][root][INFO] - Step: 315/960  |  Loss: 1.0040  |  Score: 79.58 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:02,905][root][INFO] - Step: 56/105  |  Loss: 0.8545  |  Score: 79.06 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:03,114][root][INFO] - Step: 360/1035  |  Loss: 0.7633  |  Score: 78.99 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:03,285][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-27 10:47:03,286][root][INFO] - Score: 42.10 [%]  |  Evaluation Time: 0.38 [s]
[2024-09-27 10:47:03,467][root][INFO] - Step: 320/960  |  Loss: 0.8762  |  Score: 77.45 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:03,641][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-27 10:47:03,641][root][INFO] - Score: 35.11 [%]  |  Evaluation Time: 0.35 [s]
[2024-09-27 10:47:03,643][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-27 10:47:03,644][root][INFO] - 
[9/ 15 Epoch]
[2024-09-27 10:47:05,554][root][INFO] - Step: 60/105  |  Loss: 0.8088  |  Score: 82.40 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:06,593][root][INFO] - Step: 63/105  |  Loss: 0.6891  |  Score: 82.85 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:06,975][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-27 10:47:06,976][root][INFO] - Score: 44.19 [%]  |  Evaluation Time: 0.38 [s]
[2024-09-27 10:47:07,346][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-27 10:47:07,346][root][INFO] - Score: 33.82 [%]  |  Evaluation Time: 0.37 [s]
[2024-09-27 10:47:07,347][root][INFO] - 
Save new Best Score (Epoch: 9)
[2024-09-27 10:47:07,348][root][INFO] - 
[10/ 15 Epoch]
[2024-09-27 10:47:07,647][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-27 10:47:07,647][root][INFO] - Score: 77.16 [%]  |  Evaluation Time: 4.18 [s]
[2024-09-27 10:47:08,877][root][INFO] - Step: 375/1035  |  Loss: 0.7775  |  Score: 80.77 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:10,148][root][INFO] - Step: 70/105  |  Loss: 0.6260  |  Score: 85.53 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:10,541][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-27 10:47:10,542][root][INFO] - Score: 46.08 [%]  |  Evaluation Time: 0.39 [s]
[2024-09-27 10:47:10,887][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-27 10:47:10,887][root][INFO] - Score: 34.05 [%]  |  Evaluation Time: 0.34 [s]
[2024-09-27 10:47:10,888][root][INFO] - 
Save new Best Score (Epoch: 10)
[2024-09-27 10:47:10,890][root][INFO] - 
[11/ 15 Epoch]
[2024-09-27 10:47:11,755][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-27 10:47:11,755][root][INFO] - Score: 70.55 [%]  |  Evaluation Time: 4.10 [s]
[2024-09-27 10:47:11,756][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-27 10:47:11,757][root][INFO] - 
[6/ 15 Epoch]
[2024-09-27 10:47:13,214][root][INFO] - Step: 75/105  |  Loss: 0.5785  |  Score: 86.98 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:13,874][root][INFO] - Step: 77/105  |  Loss: 0.5609  |  Score: 86.38 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:14,246][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-27 10:47:14,246][root][INFO] - Score: 45.03 [%]  |  Evaluation Time: 0.37 [s]
[2024-09-27 10:47:14,620][root][INFO] - Step: 390/1035  |  Loss: 0.7167  |  Score: 81.45 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:14,631][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-27 10:47:14,632][root][INFO] - Score: 33.46 [%]  |  Evaluation Time: 0.38 [s]
[2024-09-27 10:47:14,636][root][INFO] - 
[12/ 15 Epoch]
[2024-09-27 10:47:17,397][root][INFO] - Step: 84/105  |  Loss: 0.6027  |  Score: 87.47 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:17,584][root][INFO] - Step: 330/960  |  Loss: 0.7462  |  Score: 81.66 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:17,771][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-27 10:47:17,772][root][INFO] - Score: 44.97 [%]  |  Evaluation Time: 0.37 [s]
[2024-09-27 10:47:18,125][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-27 10:47:18,125][root][INFO] - Score: 35.03 [%]  |  Evaluation Time: 0.35 [s]
[2024-09-27 10:47:18,127][root][INFO] - 
[13/ 15 Epoch]
[2024-09-27 10:47:20,346][root][INFO] - Step: 405/1035  |  Loss: 0.7778  |  Score: 78.65 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:20,598][root][INFO] - Step: 90/105  |  Loss: 0.5307  |  Score: 88.15 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:20,889][root][INFO] - Step: 91/105  |  Loss: 0.3466  |  Score: 91.95 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:21,263][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-27 10:47:21,264][root][INFO] - Score: 45.34 [%]  |  Evaluation Time: 0.37 [s]
[2024-09-27 10:47:21,613][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-27 10:47:21,613][root][INFO] - Score: 34.93 [%]  |  Evaluation Time: 0.35 [s]
[2024-09-27 10:47:21,614][root][INFO] - 
Save new Best Score (Epoch: 13)
[2024-09-27 10:47:21,616][root][INFO] - 
[14/ 15 Epoch]
[2024-09-27 10:47:23,834][root][INFO] - Step: 414/1035  |  Loss: 0.7989  |  Score: 78.64 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:24,359][root][INFO] - Step: 98/105  |  Loss: 0.5094  |  Score: 88.45 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:24,735][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-27 10:47:24,735][root][INFO] - Score: 44.56 [%]  |  Evaluation Time: 0.37 [s]
[2024-09-27 10:47:25,084][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-27 10:47:25,084][root][INFO] - Score: 35.71 [%]  |  Evaluation Time: 0.35 [s]
[2024-09-27 10:47:25,085][root][INFO] - 
Save new Best Score (Epoch: 14)
[2024-09-27 10:47:25,086][root][INFO] - 
[15/ 15 Epoch]
[2024-09-27 10:47:25,779][root][INFO] - Step: 345/960  |  Loss: 0.7406  |  Score: 79.53 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:27,011][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-27 10:47:27,011][root][INFO] - Score: 79.24 [%]  |  Evaluation Time: 3.17 [s]
[2024-09-27 10:47:27,848][root][INFO] - Step: 105/105  |  Loss: 0.4889  |  Score: 88.37 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:28,225][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-27 10:47:28,225][root][INFO] - Score: 45.28 [%]  |  Evaluation Time: 0.37 [s]
[2024-09-27 10:47:28,572][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-27 10:47:28,572][root][INFO] - Score: 34.33 [%]  |  Evaluation Time: 0.35 [s]
[2024-09-27 10:47:28,573][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-27 10:47:28,573][root][INFO] - - Epoch: 14
[2024-09-27 10:47:28,573][root][INFO] - - DEV score: 44.56 [%]
[2024-09-27 10:47:28,574][root][INFO] - - TEST score: 35.71 [%]
[2024-09-27 10:47:28,575][root][INFO] - Fine-tuning is done!
[2024-09-27 10:47:30,043][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-27 10:47:30,044][root][INFO] - Score: 71.84 [%]  |  Evaluation Time: 3.03 [s]
[2024-09-27 10:47:30,045][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-27 10:47:30,046][root][INFO] - 
[7/ 15 Epoch]
[2024-09-27 10:47:32,861][root][INFO] - Step: 420/1035  |  Loss: 0.7175  |  Score: 77.27 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:33,951][root][INFO] - Step: 360/960  |  Loss: 0.7023  |  Score: 78.98 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:34,938][root][INFO] - 

[2024-09-27 10:47:34,938][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-27 10:47:34,938][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs
[2024-09-27 10:47:34,938][root][INFO] - 

[2024-09-27 10:47:34,938][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en', 'do_hangeulize': False, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-27 10:47:38,600][root][INFO] - Step: 435/1035  |  Loss: 0.6458  |  Score: 82.89 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:38,720][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-27 10:47:38,721][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-27 10:47:38,721][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-27 10:47:38,722][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-27 10:47:38,722][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-27 10:47:38,723][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-27 10:47:38,723][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-27 10:47:38,724][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-27 10:47:38,724][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-27 10:47:38,725][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-27 10:47:38,725][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-27 10:47:38,726][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-27 10:47:38,727][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-27 10:47:38,727][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-27 10:47:38,728][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-27 10:47:38,728][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-27 10:47:38,729][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-27 10:47:38,729][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-27 10:47:38,730][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-27 10:47:38,730][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-27 10:47:38,731][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-27 10:47:38,732][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-27 10:47:38,732][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-27 10:47:38,733][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-27 10:47:38,735][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-27 10:47:38,739][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-27 10:47:38,844][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-27 10:47:38,846][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-27 10:47:39,307][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-27 10:47:42,197][root][INFO] - Step: 375/960  |  Loss: 0.7590  |  Score: 80.63 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:44,330][root][INFO] - Step: 450/1035  |  Loss: 0.6809  |  Score: 83.31 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:46,094][root][INFO] - 

[2024-09-27 10:47:46,095][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-27 10:47:46,095][root][INFO] - Data Preprocessing
[2024-09-27 10:47:46,095][root][INFO] - ㄴ remain_lang                ko_en
[2024-09-27 10:47:46,095][root][INFO] - ㄴ do_hangeulize              False
[2024-09-27 10:47:46,095][root][INFO] - ㄴ data_remove                True

[2024-09-27 10:47:46,095][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-27 10:47:46,104][root][INFO] - vocab size              : 51200
[2024-09-27 10:47:46,104][root][INFO] - device                  : gpu
[2024-09-27 10:47:46,105][root][INFO] - random seed             : 42
[2024-09-27 10:47:46,105][root][INFO] - train data size         : 448
[2024-09-27 10:47:46,105][root][INFO] - max epochs              : 15
[2024-09-27 10:47:46,105][root][INFO] - total steps             : 105
[2024-09-27 10:47:46,105][root][INFO] - warmup steps            : 10
[2024-09-27 10:47:46,105][root][INFO] - batch size              : 64
[2024-09-27 10:47:46,105][root][INFO] - accumulation steps      : 1
[2024-09-27 10:47:46,105][root][INFO] - optimizer               : adamwscale
[2024-09-27 10:47:46,105][root][INFO] - lr_scheduler            : cosine
[2024-09-27 10:47:46,105][root][INFO] - learning rate           : 0.01
[2024-09-27 10:47:46,105][root][INFO] - max length              : 256

[2024-09-27 10:47:46,106][root][INFO] - LoRA Configuration
[2024-09-27 10:47:46,106][root][INFO] - ㄴ r                    : 32
[2024-09-27 10:47:46,106][root][INFO] - ㄴ alpha                : 128
[2024-09-27 10:47:46,106][root][INFO] - ㄴ dropout              : 0.03

[2024-09-27 10:47:46,106][root][INFO] - KOMBO Configuration
[2024-09-27 10:47:46,106][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-27 10:47:46,106][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-27 10:47:46,106][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-27 10:47:46,106][root][INFO] - ㄴ do_combination       : True
[2024-09-27 10:47:46,106][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-27 10:47:46,107][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-27 10:47:46,107][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-27 10:47:46,107][root][INFO] -   ㄴ add_lora           : True

[2024-09-27 10:47:46,107][root][INFO] - LoRA in KOMBO Configuration
[2024-09-27 10:47:46,107][root][INFO] - ㄴ r                : 32
[2024-09-27 10:47:46,107][root][INFO] - ㄴ alpha            : 128
[2024-09-27 10:47:46,107][root][INFO] - ㄴ dropout          : 0.03

[2024-09-27 10:47:46,107][root][INFO] - 

[2024-09-27 10:47:46,107][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs
[2024-09-27 10:47:46,107][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-27 10:47:46,107][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en/256t_64b_1s_0.01lr_42rs/tb
[2024-09-27 10:47:46,108][root][INFO] - * tb interval   : 15

[2024-09-27 10:47:46,108][root][INFO] - 

[2024-09-27 10:47:46,108][root][INFO] - Start the Training !
[2024-09-27 10:47:46,111][root][INFO] - 
[1/ 15 Epoch]
[2024-09-27 10:47:47,120][root][INFO] - Step: 384/960  |  Loss: 0.7776  |  Score: 80.19 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:50,055][root][INFO] - Step: 465/1035  |  Loss: 0.6628  |  Score: 81.51 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:50,692][root][INFO] - Step: 7/105  |  Loss: 4.8922  |  Score: 1.97 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:50,964][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-27 10:47:50,964][root][INFO] - Score: 77.49 [%]  |  Evaluation Time: 3.84 [s]
[2024-09-27 10:47:51,182][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-27 10:47:51,183][root][INFO] - Score: -0.18 [%]  |  Evaluation Time: 0.49 [s]
[2024-09-27 10:47:51,620][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-27 10:47:51,620][root][INFO] - Score: -4.78 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 10:47:51,622][root][INFO] - 
[2/ 15 Epoch]
[2024-09-27 10:47:55,305][root][INFO] - Step: 14/105  |  Loss: 2.7787  |  Score: 8.37 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:55,306][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-27 10:47:55,306][root][INFO] - Score: 70.68 [%]  |  Evaluation Time: 4.34 [s]
[2024-09-27 10:47:55,308][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-27 10:47:55,309][root][INFO] - 
[7/ 15 Epoch]
[2024-09-27 10:47:55,782][root][INFO] - Step: 480/1035  |  Loss: 0.6361  |  Score: 82.90 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:55,784][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-27 10:47:55,785][root][INFO] - Score: -0.70 [%]  |  Evaluation Time: 0.48 [s]
[2024-09-27 10:47:56,202][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-27 10:47:56,202][root][INFO] - Score: 6.21 [%]  |  Evaluation Time: 0.42 [s]
[2024-09-27 10:47:56,203][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-27 10:47:56,204][root][INFO] - 
[3/ 15 Epoch]
[2024-09-27 10:47:56,967][root][INFO] - Step: 483/1035  |  Loss: 0.7303  |  Score: 78.80 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:57,059][root][INFO] - Step: 15/105  |  Loss: 2.3864  |  Score: 21.06 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:59,057][root][INFO] - Step: 390/960  |  Loss: 0.5550  |  Score: 84.71 [%]  |  Seq Length: 256.0
[2024-09-27 10:47:59,860][root][INFO] - Step: 21/105  |  Loss: 2.1997  |  Score: 34.03 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:00,218][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-27 10:48:00,218][root][INFO] - Score: 79.05 [%]  |  Evaluation Time: 3.25 [s]
[2024-09-27 10:48:00,349][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-27 10:48:00,349][root][INFO] - Score: 13.87 [%]  |  Evaluation Time: 0.49 [s]
[2024-09-27 10:48:00,792][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-27 10:48:00,793][root][INFO] - Score: 10.19 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 10:48:00,793][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-27 10:48:00,795][root][INFO] - 
[4/ 15 Epoch]
[2024-09-27 10:48:03,313][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-27 10:48:03,313][root][INFO] - Score: 72.13 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-27 10:48:03,314][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-27 10:48:03,315][root][INFO] - 
[8/ 15 Epoch]
[2024-09-27 10:48:04,400][root][INFO] - Step: 28/105  |  Loss: 1.8691  |  Score: 51.96 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:04,879][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-27 10:48:04,879][root][INFO] - Score: 18.51 [%]  |  Evaluation Time: 0.48 [s]
[2024-09-27 10:48:05,335][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-27 10:48:05,335][root][INFO] - Score: 16.81 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-27 10:48:05,336][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-27 10:48:05,337][root][INFO] - 
[5/ 15 Epoch]
[2024-09-27 10:48:06,690][root][INFO] - Step: 30/105  |  Loss: 1.7736  |  Score: 59.83 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:07,302][root][INFO] - Step: 405/960  |  Loss: 0.7023  |  Score: 82.94 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:08,395][root][INFO] - Step: 495/1035  |  Loss: 0.5824  |  Score: 84.24 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:09,019][root][INFO] - Step: 35/105  |  Loss: 1.4598  |  Score: 61.76 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:09,503][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-27 10:48:09,503][root][INFO] - Score: 31.59 [%]  |  Evaluation Time: 0.48 [s]
[2024-09-27 10:48:09,938][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-27 10:48:09,939][root][INFO] - Score: 28.80 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 10:48:09,939][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-27 10:48:09,941][root][INFO] - 
[6/ 15 Epoch]
[2024-09-27 10:48:13,563][root][INFO] - Step: 42/105  |  Loss: 1.2979  |  Score: 70.08 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:14,041][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-27 10:48:14,041][root][INFO] - Score: 36.03 [%]  |  Evaluation Time: 0.48 [s]
[2024-09-27 10:48:14,124][root][INFO] - Step: 510/1035  |  Loss: 0.5389  |  Score: 85.22 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:14,473][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-27 10:48:14,473][root][INFO] - Score: 33.60 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 10:48:14,474][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-27 10:48:14,476][root][INFO] - 
[7/ 15 Epoch]
[2024-09-27 10:48:15,763][root][INFO] - Step: 420/960  |  Loss: 0.6842  |  Score: 81.59 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:16,272][root][INFO] - Step: 45/105  |  Loss: 0.9341  |  Score: 80.14 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:18,087][root][INFO] - Step: 49/105  |  Loss: 1.0264  |  Score: 77.94 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:18,598][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-27 10:48:18,598][root][INFO] - Score: 41.80 [%]  |  Evaluation Time: 0.51 [s]
[2024-09-27 10:48:19,039][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-27 10:48:19,039][root][INFO] - Score: 37.99 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 10:48:19,040][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-27 10:48:19,041][root][INFO] - 
[8/ 15 Epoch]
[2024-09-27 10:48:19,849][root][INFO] - Step: 525/1035  |  Loss: 0.5324  |  Score: 84.57 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:22,709][root][INFO] - Step: 56/105  |  Loss: 0.8251  |  Score: 82.00 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:23,188][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-27 10:48:23,188][root][INFO] - Score: 44.77 [%]  |  Evaluation Time: 0.48 [s]
[2024-09-27 10:48:23,619][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-27 10:48:23,619][root][INFO] - Score: 37.93 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 10:48:23,620][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-27 10:48:23,621][root][INFO] - 
[9/ 15 Epoch]
[2024-09-27 10:48:24,274][root][INFO] - Step: 435/960  |  Loss: 0.7019  |  Score: 82.17 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:25,581][root][INFO] - Step: 540/1035  |  Loss: 0.5750  |  Score: 84.39 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:25,860][root][INFO] - Step: 60/105  |  Loss: 0.7342  |  Score: 83.85 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:27,186][root][INFO] - Step: 63/105  |  Loss: 0.6880  |  Score: 83.78 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:27,693][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-27 10:48:27,693][root][INFO] - Score: 43.44 [%]  |  Evaluation Time: 0.50 [s]
[2024-09-27 10:48:28,138][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-27 10:48:28,138][root][INFO] - Score: 38.57 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 10:48:28,140][root][INFO] - 
[10/ 15 Epoch]
[2024-09-27 10:48:30,204][root][INFO] - Step: 552/1035  |  Loss: 0.5382  |  Score: 84.84 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:31,597][root][INFO] - Step: 448/960  |  Loss: 0.6330  |  Score: 83.23 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:31,736][root][INFO] - Step: 70/105  |  Loss: 0.6553  |  Score: 84.97 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:32,229][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-27 10:48:32,229][root][INFO] - Score: 43.61 [%]  |  Evaluation Time: 0.49 [s]
[2024-09-27 10:48:32,668][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-27 10:48:32,668][root][INFO] - Score: 37.41 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 10:48:32,670][root][INFO] - 
[11/ 15 Epoch]
[2024-09-27 10:48:33,423][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-27 10:48:33,423][root][INFO] - Score: 77.81 [%]  |  Evaluation Time: 3.21 [s]
[2024-09-27 10:48:35,486][root][INFO] - Step: 75/105  |  Loss: 0.5831  |  Score: 84.33 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:36,025][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-27 10:48:36,025][root][INFO] - Score: 78.95 [%]  |  Evaluation Time: 4.43 [s]
[2024-09-27 10:48:36,353][root][INFO] - Step: 77/105  |  Loss: 0.5759  |  Score: 86.99 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:36,464][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-27 10:48:36,464][root][INFO] - Score: 71.25 [%]  |  Evaluation Time: 3.04 [s]
[2024-09-27 10:48:36,466][root][INFO] - 
[9/ 15 Epoch]
[2024-09-27 10:48:36,867][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-27 10:48:36,867][root][INFO] - Score: 42.06 [%]  |  Evaluation Time: 0.51 [s]
[2024-09-27 10:48:37,332][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-27 10:48:37,333][root][INFO] - Score: 37.17 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-27 10:48:37,335][root][INFO] - 
[12/ 15 Epoch]
[2024-09-27 10:48:37,943][root][INFO] - Step: 555/1035  |  Loss: 0.4581  |  Score: 87.17 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:40,124][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-27 10:48:40,125][root][INFO] - Score: 70.85 [%]  |  Evaluation Time: 4.10 [s]
[2024-09-27 10:48:40,125][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-27 10:48:40,127][root][INFO] - 
[8/ 15 Epoch]
[2024-09-27 10:48:40,912][root][INFO] - Step: 84/105  |  Loss: 0.5793  |  Score: 87.32 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:41,372][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-27 10:48:41,372][root][INFO] - Score: 42.64 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-27 10:48:41,626][root][INFO] - Step: 450/960  |  Loss: 0.4652  |  Score: 88.14 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:41,819][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-27 10:48:41,819][root][INFO] - Score: 36.19 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 10:48:41,821][root][INFO] - 
[13/ 15 Epoch]
[2024-09-27 10:48:43,679][root][INFO] - Step: 570/1035  |  Loss: 0.4972  |  Score: 85.55 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:45,182][root][INFO] - Step: 90/105  |  Loss: 0.5087  |  Score: 88.99 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:45,550][root][INFO] - Step: 91/105  |  Loss: 0.4876  |  Score: 90.98 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:46,040][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-27 10:48:46,040][root][INFO] - Score: 42.92 [%]  |  Evaluation Time: 0.49 [s]
[2024-09-27 10:48:46,496][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-27 10:48:46,496][root][INFO] - Score: 36.20 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-27 10:48:46,498][root][INFO] - 
[14/ 15 Epoch]
[2024-09-27 10:48:49,409][root][INFO] - Step: 585/1035  |  Loss: 0.4979  |  Score: 86.49 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:49,758][root][INFO] - Step: 465/960  |  Loss: 0.5077  |  Score: 86.10 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:50,129][root][INFO] - Step: 98/105  |  Loss: 0.4713  |  Score: 88.84 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:50,640][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-27 10:48:50,640][root][INFO] - Score: 42.39 [%]  |  Evaluation Time: 0.51 [s]
[2024-09-27 10:48:51,085][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-27 10:48:51,085][root][INFO] - Score: 36.20 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 10:48:51,087][root][INFO] - 
[15/ 15 Epoch]
[2024-09-27 10:48:54,778][root][INFO] - Step: 105/105  |  Loss: 0.5530  |  Score: 87.09 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:55,139][root][INFO] - Step: 600/1035  |  Loss: 0.5704  |  Score: 86.14 [%]  |  Seq Length: 256.0
[2024-09-27 10:48:55,271][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-27 10:48:55,271][root][INFO] - Score: 43.58 [%]  |  Evaluation Time: 0.49 [s]
[2024-09-27 10:48:55,683][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-27 10:48:55,684][root][INFO] - Score: 36.27 [%]  |  Evaluation Time: 0.41 [s]
[2024-09-27 10:48:55,684][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-27 10:48:55,685][root][INFO] - - Epoch: 8
[2024-09-27 10:48:55,685][root][INFO] - - DEV score: 44.77 [%]
[2024-09-27 10:48:55,685][root][INFO] - - TEST score: 37.93 [%]
[2024-09-27 10:48:55,685][root][INFO] - Fine-tuning is done!
[2024-09-27 10:48:58,029][root][INFO] - Step: 480/960  |  Loss: 0.6222  |  Score: 83.01 [%]  |  Seq Length: 256.0
[2024-09-27 10:49:00,867][root][INFO] - Step: 615/1035  |  Loss: 0.5166  |  Score: 85.98 [%]  |  Seq Length: 256.0
[2024-09-27 10:49:03,213][root][INFO] - Step: 621/1035  |  Loss: 0.5292  |  Score: 86.88 [%]  |  Seq Length: 256.0
[2024-09-27 10:49:06,164][root][INFO] - Step: 495/960  |  Loss: 0.5988  |  Score: 85.89 [%]  |  Seq Length: 256.0
[2024-09-27 10:49:06,358][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-27 10:49:06,358][root][INFO] - Score: 78.40 [%]  |  Evaluation Time: 3.14 [s]
[2024-09-27 10:49:09,450][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-27 10:49:09,450][root][INFO] - Score: 71.50 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-27 10:49:09,452][root][INFO] - 
[10/ 15 Epoch]
[2024-09-27 10:49:13,180][root][INFO] - Step: 630/1035  |  Loss: 0.4039  |  Score: 89.50 [%]  |  Seq Length: 256.0
[2024-09-27 10:49:14,323][root][INFO] - Step: 510/960  |  Loss: 0.6461  |  Score: 83.56 [%]  |  Seq Length: 256.0
[2024-09-27 10:49:15,462][root][INFO] - Step: 512/960  |  Loss: 0.6000  |  Score: 86.19 [%]  |  Seq Length: 256.0
[2024-09-27 10:49:18,912][root][INFO] - Step: 645/1035  |  Loss: 0.4399  |  Score: 88.01 [%]  |  Seq Length: 256.0
[2024-09-27 10:49:19,598][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-27 10:49:19,598][root][INFO] - Score: 79.28 [%]  |  Evaluation Time: 4.13 [s]
[2024-09-27 10:49:23,597][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-27 10:49:23,597][root][INFO] - Score: 70.78 [%]  |  Evaluation Time: 4.00 [s]
[2024-09-27 10:49:23,599][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-27 10:49:23,600][root][INFO] - 
[9/ 15 Epoch]
[2024-09-27 10:49:24,639][root][INFO] - Step: 660/1035  |  Loss: 0.4995  |  Score: 86.85 [%]  |  Seq Length: 256.0
[2024-09-27 10:49:30,375][root][INFO] - Step: 675/1035  |  Loss: 0.4665  |  Score: 87.88 [%]  |  Seq Length: 256.0
[2024-09-27 10:49:31,286][root][INFO] - Step: 525/960  |  Loss: 0.5433  |  Score: 87.33 [%]  |  Seq Length: 256.0
[2024-09-27 10:49:36,136][root][INFO] - Step: 690/1035  |  Loss: 0.4678  |  Score: 87.02 [%]  |  Seq Length: 256.0
[2024-09-27 10:49:39,396][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-27 10:49:39,396][root][INFO] - Score: 78.29 [%]  |  Evaluation Time: 3.26 [s]
[2024-09-27 10:49:39,463][root][INFO] - Step: 540/960  |  Loss: 0.5325  |  Score: 84.71 [%]  |  Seq Length: 256.0
[2024-09-27 10:49:42,403][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-27 10:49:42,404][root][INFO] - Score: 71.98 [%]  |  Evaluation Time: 3.01 [s]
[2024-09-27 10:49:42,408][root][INFO] - 
[11/ 15 Epoch]
[2024-09-27 10:49:43,147][root][INFO] - Step: 691/1035  |  Loss: 0.3822  |  Score: 91.98 [%]  |  Seq Length: 256.0
[2024-09-27 10:49:47,717][root][INFO] - Step: 555/960  |  Loss: 0.5012  |  Score: 86.14 [%]  |  Seq Length: 256.0
[2024-09-27 10:49:48,520][root][INFO] - Step: 705/1035  |  Loss: 0.4045  |  Score: 88.91 [%]  |  Seq Length: 256.0
[2024-09-27 10:49:54,251][root][INFO] - Step: 720/1035  |  Loss: 0.4190  |  Score: 88.62 [%]  |  Seq Length: 256.0
[2024-09-27 10:49:55,952][root][INFO] - Step: 570/960  |  Loss: 0.4958  |  Score: 86.65 [%]  |  Seq Length: 256.0
[2024-09-27 10:49:59,259][root][INFO] - Step: 576/960  |  Loss: 0.4573  |  Score: 86.14 [%]  |  Seq Length: 256.0
[2024-09-27 10:49:59,978][root][INFO] - Step: 735/1035  |  Loss: 0.4287  |  Score: 88.50 [%]  |  Seq Length: 256.0
[2024-09-27 10:50:03,438][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-27 10:50:03,439][root][INFO] - Score: 78.26 [%]  |  Evaluation Time: 4.18 [s]
[2024-09-27 10:50:05,705][root][INFO] - Step: 750/1035  |  Loss: 0.3931  |  Score: 89.12 [%]  |  Seq Length: 256.0
[2024-09-27 10:50:07,481][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-27 10:50:07,482][root][INFO] - Score: 71.01 [%]  |  Evaluation Time: 4.04 [s]
[2024-09-27 10:50:07,486][root][INFO] - 
[10/ 15 Epoch]
[2024-09-27 10:50:09,182][root][INFO] - Step: 759/1035  |  Loss: 0.4388  |  Score: 87.15 [%]  |  Seq Length: 256.0
[2024-09-27 10:50:12,290][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-27 10:50:12,290][root][INFO] - Score: 78.04 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-27 10:50:12,887][root][INFO] - Step: 585/960  |  Loss: 0.4486  |  Score: 86.67 [%]  |  Seq Length: 256.0
[2024-09-27 10:50:15,371][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-27 10:50:15,371][root][INFO] - Score: 71.05 [%]  |  Evaluation Time: 3.08 [s]
[2024-09-27 10:50:15,373][root][INFO] - 
[12/ 15 Epoch]
[2024-09-27 10:50:18,093][root][INFO] - Step: 765/1035  |  Loss: 0.3786  |  Score: 89.45 [%]  |  Seq Length: 256.0
[2024-09-27 10:50:21,146][root][INFO] - Step: 600/960  |  Loss: 0.4853  |  Score: 87.64 [%]  |  Seq Length: 256.0
[2024-09-27 10:50:23,825][root][INFO] - Step: 780/1035  |  Loss: 0.3700  |  Score: 89.88 [%]  |  Seq Length: 256.0
[2024-09-27 10:50:29,290][root][INFO] - Step: 615/960  |  Loss: 0.4583  |  Score: 88.21 [%]  |  Seq Length: 256.0
[2024-09-27 10:50:29,549][root][INFO] - Step: 795/1035  |  Loss: 0.3944  |  Score: 89.95 [%]  |  Seq Length: 256.0
[2024-09-27 10:50:35,278][root][INFO] - Step: 810/1035  |  Loss: 0.3779  |  Score: 89.70 [%]  |  Seq Length: 256.0
[2024-09-27 10:50:37,502][root][INFO] - Step: 630/960  |  Loss: 0.4499  |  Score: 88.17 [%]  |  Seq Length: 256.0
[2024-09-27 10:50:40,999][root][INFO] - Step: 825/1035  |  Loss: 0.4031  |  Score: 88.03 [%]  |  Seq Length: 256.0
[2024-09-27 10:50:42,188][root][INFO] - Step: 828/1035  |  Loss: 0.4133  |  Score: 86.26 [%]  |  Seq Length: 256.0
[2024-09-27 10:50:42,966][root][INFO] - Step: 640/960  |  Loss: 0.4710  |  Score: 85.65 [%]  |  Seq Length: 256.0
[2024-09-27 10:50:45,468][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-27 10:50:45,468][root][INFO] - Score: 78.12 [%]  |  Evaluation Time: 3.28 [s]
[2024-09-27 10:50:47,006][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-27 10:50:47,007][root][INFO] - Score: 77.99 [%]  |  Evaluation Time: 4.04 [s]
[2024-09-27 10:50:48,493][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-27 10:50:48,493][root][INFO] - Score: 71.06 [%]  |  Evaluation Time: 3.02 [s]
[2024-09-27 10:50:48,496][root][INFO] - 
[13/ 15 Epoch]
[2024-09-27 10:50:51,014][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-27 10:50:51,015][root][INFO] - Score: 70.88 [%]  |  Evaluation Time: 4.01 [s]
[2024-09-27 10:50:51,017][root][INFO] - 
[11/ 15 Epoch]
[2024-09-27 10:50:53,414][root][INFO] - Step: 840/1035  |  Loss: 0.3801  |  Score: 90.57 [%]  |  Seq Length: 256.0
[2024-09-27 10:50:54,090][root][INFO] - Step: 645/960  |  Loss: 0.4621  |  Score: 86.16 [%]  |  Seq Length: 256.0
[2024-09-27 10:50:59,138][root][INFO] - Step: 855/1035  |  Loss: 0.3445  |  Score: 89.86 [%]  |  Seq Length: 256.0
[2024-09-27 10:51:00,518][root][INFO] - Step: 660/960  |  Loss: 0.4684  |  Score: 87.99 [%]  |  Seq Length: 256.0
[2024-09-27 10:51:04,869][root][INFO] - Step: 870/1035  |  Loss: 0.3767  |  Score: 89.20 [%]  |  Seq Length: 256.0
[2024-09-27 10:51:06,082][root][INFO] - Step: 675/960  |  Loss: 0.4169  |  Score: 88.77 [%]  |  Seq Length: 256.0
[2024-09-27 10:51:10,592][root][INFO] - Step: 885/1035  |  Loss: 0.3480  |  Score: 90.55 [%]  |  Seq Length: 256.0
[2024-09-27 10:51:11,643][root][INFO] - Step: 690/960  |  Loss: 0.4631  |  Score: 87.85 [%]  |  Seq Length: 256.0
[2024-09-27 10:51:15,214][root][INFO] - Step: 897/1035  |  Loss: 0.3925  |  Score: 88.03 [%]  |  Seq Length: 256.0
[2024-09-27 10:51:16,874][root][INFO] - Step: 704/960  |  Loss: 0.4673  |  Score: 87.77 [%]  |  Seq Length: 256.0
[2024-09-27 10:51:18,317][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-27 10:51:18,317][root][INFO] - Score: 77.94 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-27 10:51:19,994][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-27 10:51:19,994][root][INFO] - Score: 78.50 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-27 10:51:21,500][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-27 10:51:21,500][root][INFO] - Score: 70.88 [%]  |  Evaluation Time: 3.18 [s]
[2024-09-27 10:51:21,502][root][INFO] - 
[14/ 15 Epoch]
[2024-09-27 10:51:22,957][root][INFO] - Step: 900/1035  |  Loss: 0.3517  |  Score: 90.60 [%]  |  Seq Length: 256.0
[2024-09-27 10:51:22,986][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-27 10:51:22,986][root][INFO] - Score: 71.53 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-27 10:51:22,989][root][INFO] - 
[12/ 15 Epoch]
[2024-09-27 10:51:23,798][root][INFO] - Step: 705/960  |  Loss: 0.5027  |  Score: 88.62 [%]  |  Seq Length: 256.0
[2024-09-27 10:51:28,698][root][INFO] - Step: 915/1035  |  Loss: 0.3613  |  Score: 90.29 [%]  |  Seq Length: 256.0
[2024-09-27 10:51:29,390][root][INFO] - Step: 720/960  |  Loss: 0.4035  |  Score: 88.70 [%]  |  Seq Length: 256.0
[2024-09-27 10:51:34,419][root][INFO] - Step: 930/1035  |  Loss: 0.3477  |  Score: 89.37 [%]  |  Seq Length: 256.0
[2024-09-27 10:51:34,975][root][INFO] - Step: 735/960  |  Loss: 0.3978  |  Score: 88.28 [%]  |  Seq Length: 256.0
[2024-09-27 10:51:40,140][root][INFO] - Step: 945/1035  |  Loss: 0.3476  |  Score: 89.55 [%]  |  Seq Length: 256.0
[2024-09-27 10:51:40,538][root][INFO] - Step: 750/960  |  Loss: 0.3742  |  Score: 90.41 [%]  |  Seq Length: 256.0
[2024-09-27 10:51:45,859][root][INFO] - Step: 960/1035  |  Loss: 0.3733  |  Score: 87.84 [%]  |  Seq Length: 256.0
[2024-09-27 10:51:46,099][root][INFO] - Step: 765/960  |  Loss: 0.4278  |  Score: 88.25 [%]  |  Seq Length: 256.0
[2024-09-27 10:51:47,235][root][INFO] - Step: 768/960  |  Loss: 0.4508  |  Score: 88.79 [%]  |  Seq Length: 256.0
[2024-09-27 10:51:48,161][root][INFO] - Step: 966/1035  |  Loss: 0.3548  |  Score: 89.10 [%]  |  Seq Length: 256.0
[2024-09-27 10:51:50,265][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-27 10:51:50,266][root][INFO] - Score: 74.43 [%]  |  Evaluation Time: 3.03 [s]
[2024-09-27 10:51:51,352][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-27 10:51:51,353][root][INFO] - Score: 77.21 [%]  |  Evaluation Time: 3.19 [s]
[2024-09-27 10:51:53,192][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-27 10:51:53,192][root][INFO] - Score: 69.83 [%]  |  Evaluation Time: 2.92 [s]
[2024-09-27 10:51:53,194][root][INFO] - 
[13/ 15 Epoch]
[2024-09-27 10:51:54,437][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-27 10:51:54,438][root][INFO] - Score: 71.70 [%]  |  Evaluation Time: 3.08 [s]
[2024-09-27 10:51:54,440][root][INFO] - 
[15/ 15 Epoch]
[2024-09-27 10:51:58,032][root][INFO] - Step: 780/960  |  Loss: 0.3580  |  Score: 90.71 [%]  |  Seq Length: 256.0
[2024-09-27 10:51:58,158][root][INFO] - Step: 975/1035  |  Loss: 0.3592  |  Score: 88.83 [%]  |  Seq Length: 256.0
[2024-09-27 10:52:03,589][root][INFO] - Step: 795/960  |  Loss: 0.4159  |  Score: 88.16 [%]  |  Seq Length: 256.0
[2024-09-27 10:52:03,876][root][INFO] - Step: 990/1035  |  Loss: 0.3522  |  Score: 90.18 [%]  |  Seq Length: 256.0
[2024-09-27 10:52:09,151][root][INFO] - Step: 810/960  |  Loss: 0.3771  |  Score: 90.35 [%]  |  Seq Length: 256.0
[2024-09-27 10:52:09,599][root][INFO] - Step: 1005/1035  |  Loss: 0.3664  |  Score: 90.43 [%]  |  Seq Length: 256.0
[2024-09-27 10:52:14,705][root][INFO] - Step: 825/960  |  Loss: 0.3711  |  Score: 89.61 [%]  |  Seq Length: 256.0
[2024-09-27 10:52:15,325][root][INFO] - Step: 1020/1035  |  Loss: 0.3763  |  Score: 89.15 [%]  |  Seq Length: 256.0
[2024-09-27 10:52:17,343][root][INFO] - Step: 832/960  |  Loss: 0.4175  |  Score: 88.16 [%]  |  Seq Length: 256.0
[2024-09-27 10:52:20,272][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-27 10:52:20,272][root][INFO] - Score: 78.21 [%]  |  Evaluation Time: 2.93 [s]
[2024-09-27 10:52:21,089][root][INFO] - Step: 1035/1035  |  Loss: 0.3644  |  Score: 89.78 [%]  |  Seq Length: 256.0
[2024-09-27 10:52:23,094][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-27 10:52:23,094][root][INFO] - Score: 69.54 [%]  |  Evaluation Time: 2.82 [s]
[2024-09-27 10:52:23,096][root][INFO] - 
[14/ 15 Epoch]
[2024-09-27 10:52:24,275][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-27 10:52:24,275][root][INFO] - Score: 78.24 [%]  |  Evaluation Time: 3.18 [s]
[2024-09-27 10:52:26,431][root][INFO] - Step: 840/960  |  Loss: 0.3710  |  Score: 90.47 [%]  |  Seq Length: 256.0
[2024-09-27 10:52:27,249][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-27 10:52:27,249][root][INFO] - Score: 70.76 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-27 10:52:27,250][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-27 10:52:27,250][root][INFO] - - Epoch: 7
[2024-09-27 10:52:27,250][root][INFO] - - DEV score: 79.05 [%]
[2024-09-27 10:52:27,250][root][INFO] - - TEST score: 72.13 [%]
[2024-09-27 10:52:27,251][root][INFO] - Fine-tuning is done!
[2024-09-27 10:52:32,015][root][INFO] - Step: 855/960  |  Loss: 0.3972  |  Score: 87.69 [%]  |  Seq Length: 256.0
[2024-09-27 10:52:33,452][root][INFO] - 

[2024-09-27 10:52:33,452][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-27 10:52:33,452][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-27 10:52:33,452][root][INFO] - 

[2024-09-27 10:52:33,452][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-27 10:52:37,573][root][INFO] - Step: 870/960  |  Loss: 0.3648  |  Score: 90.79 [%]  |  Seq Length: 256.0
[2024-09-27 10:52:43,135][root][INFO] - Step: 885/960  |  Loss: 0.3914  |  Score: 88.99 [%]  |  Seq Length: 256.0
[2024-09-27 10:52:47,292][root][INFO] - Step: 896/960  |  Loss: 0.3517  |  Score: 89.51 [%]  |  Seq Length: 256.0
[2024-09-27 10:52:50,220][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-27 10:52:50,221][root][INFO] - Score: 78.24 [%]  |  Evaluation Time: 2.93 [s]
[2024-09-27 10:52:53,074][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-27 10:52:53,074][root][INFO] - Score: 69.85 [%]  |  Evaluation Time: 2.85 [s]
[2024-09-27 10:52:53,076][root][INFO] - 
[15/ 15 Epoch]
[2024-09-27 10:52:54,873][root][INFO] - Step: 900/960  |  Loss: 0.3529  |  Score: 89.32 [%]  |  Seq Length: 256.0
[2024-09-27 10:53:00,427][root][INFO] - Step: 915/960  |  Loss: 0.3568  |  Score: 91.13 [%]  |  Seq Length: 256.0
[2024-09-27 10:53:05,978][root][INFO] - Step: 930/960  |  Loss: 0.3690  |  Score: 89.21 [%]  |  Seq Length: 256.0
[2024-09-27 10:53:11,537][root][INFO] - Step: 945/960  |  Loss: 0.3651  |  Score: 90.63 [%]  |  Seq Length: 256.0
[2024-09-27 10:53:17,112][root][INFO] - Step: 960/960  |  Loss: 0.3543  |  Score: 90.07 [%]  |  Seq Length: 256.0
[2024-09-27 10:53:20,024][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-27 10:53:20,025][root][INFO] - Score: 78.73 [%]  |  Evaluation Time: 2.91 [s]
[2024-09-27 10:53:22,876][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-27 10:53:22,877][root][INFO] - Score: 70.38 [%]  |  Evaluation Time: 2.85 [s]
[2024-09-27 10:53:22,878][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-27 10:53:22,878][root][INFO] - - Epoch: 8
[2024-09-27 10:53:22,878][root][INFO] - - DEV score: 79.28 [%]
[2024-09-27 10:53:22,878][root][INFO] - - TEST score: 70.78 [%]
[2024-09-27 10:53:22,879][root][INFO] - Fine-tuning is done!
[2024-09-27 10:53:23,146][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-27 10:53:23,147][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-27 10:53:23,148][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-27 10:53:23,148][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-27 10:53:23,149][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-27 10:53:23,150][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-27 10:53:23,150][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-27 10:53:23,151][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-27 10:53:23,151][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-27 10:53:23,152][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-27 10:53:23,152][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-27 10:53:23,153][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-27 10:53:23,153][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-27 10:53:23,154][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-27 10:53:23,154][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-27 10:53:23,155][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-27 10:53:23,155][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-27 10:53:23,156][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-27 10:53:23,156][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-27 10:53:23,157][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-27 10:53:23,157][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-27 10:53:23,158][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-27 10:53:23,158][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-27 10:53:23,159][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-27 10:53:23,165][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-27 10:53:23,172][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-27 10:53:23,316][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-27 10:53:23,319][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-27 10:53:23,724][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-27 10:53:29,014][root][INFO] - 

[2024-09-27 10:53:29,014][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-27 10:53:29,014][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs
[2024-09-27 10:53:29,014][root][INFO] - 

[2024-09-27 10:53:29,014][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-27 10:53:30,415][root][INFO] - 

[2024-09-27 10:53:30,415][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-27 10:53:30,415][root][INFO] - Data Preprocessing
[2024-09-27 10:53:30,415][root][INFO] - ㄴ remain_lang                ko_en_punc
[2024-09-27 10:53:30,416][root][INFO] - ㄴ do_hangeulize              True
[2024-09-27 10:53:30,416][root][INFO] - ㄴ data_remove                True

[2024-09-27 10:53:30,416][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-27 10:53:30,424][root][INFO] - vocab size              : 51200
[2024-09-27 10:53:30,425][root][INFO] - device                  : gpu
[2024-09-27 10:53:30,425][root][INFO] - random seed             : 42
[2024-09-27 10:53:30,425][root][INFO] - train data size         : 4416
[2024-09-27 10:53:30,425][root][INFO] - max epochs              : 15
[2024-09-27 10:53:30,425][root][INFO] - total steps             : 1035
[2024-09-27 10:53:30,425][root][INFO] - warmup steps            : 104
[2024-09-27 10:53:30,425][root][INFO] - batch size              : 64
[2024-09-27 10:53:30,425][root][INFO] - accumulation steps      : 1
[2024-09-27 10:53:30,425][root][INFO] - optimizer               : adamwscale
[2024-09-27 10:53:30,425][root][INFO] - lr_scheduler            : cosine
[2024-09-27 10:53:30,426][root][INFO] - learning rate           : 0.01
[2024-09-27 10:53:30,426][root][INFO] - max length              : 256

[2024-09-27 10:53:30,426][root][INFO] - LoRA Configuration
[2024-09-27 10:53:30,426][root][INFO] - ㄴ r                    : 32
[2024-09-27 10:53:30,426][root][INFO] - ㄴ alpha                : 128
[2024-09-27 10:53:30,426][root][INFO] - ㄴ dropout              : 0.03

[2024-09-27 10:53:30,426][root][INFO] - KOMBO Configuration
[2024-09-27 10:53:30,426][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-27 10:53:30,426][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-27 10:53:30,426][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-27 10:53:30,426][root][INFO] - ㄴ do_combination       : True
[2024-09-27 10:53:30,427][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-27 10:53:30,427][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-27 10:53:30,427][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-27 10:53:30,427][root][INFO] -   ㄴ add_lora           : True

[2024-09-27 10:53:30,427][root][INFO] - LoRA in KOMBO Configuration
[2024-09-27 10:53:30,427][root][INFO] - ㄴ r                : 32
[2024-09-27 10:53:30,427][root][INFO] - ㄴ alpha            : 128
[2024-09-27 10:53:30,427][root][INFO] - ㄴ dropout          : 0.03

[2024-09-27 10:53:30,427][root][INFO] - 

[2024-09-27 10:53:30,428][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-27 10:53:30,428][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-27 10:53:30,428][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb
[2024-09-27 10:53:30,428][root][INFO] - * tb interval   : 15

[2024-09-27 10:53:30,428][root][INFO] - 

[2024-09-27 10:53:30,428][root][INFO] - Start the Training !
[2024-09-27 10:53:30,432][root][INFO] - 
[1/ 15 Epoch]
[2024-09-27 10:53:33,735][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-27 10:53:33,735][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-27 10:53:33,736][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-27 10:53:33,736][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-27 10:53:33,737][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-27 10:53:33,737][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-27 10:53:33,738][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-27 10:53:33,738][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-27 10:53:33,739][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-27 10:53:33,739][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-27 10:53:33,740][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-27 10:53:33,740][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-27 10:53:33,740][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-27 10:53:33,741][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-27 10:53:33,741][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-27 10:53:33,742][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-27 10:53:33,742][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-27 10:53:33,743][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-27 10:53:33,743][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-27 10:53:33,743][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-27 10:53:33,744][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-27 10:53:33,744][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-27 10:53:33,745][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-27 10:53:33,745][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-27 10:53:33,747][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-27 10:53:33,753][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-27 10:53:33,860][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-27 10:53:33,862][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-27 10:53:34,321][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-27 10:53:40,196][root][INFO] - Step: 15/1035  |  Loss: 3.3138  |  Score: 2.12 [%]  |  Seq Length: 256.0
[2024-09-27 10:53:40,925][root][INFO] - 

[2024-09-27 10:53:40,925][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-27 10:53:40,925][root][INFO] - Data Preprocessing
[2024-09-27 10:53:40,925][root][INFO] - ㄴ remain_lang                ko_punc
[2024-09-27 10:53:40,925][root][INFO] - ㄴ do_hangeulize              True
[2024-09-27 10:53:40,926][root][INFO] - ㄴ data_remove                True

[2024-09-27 10:53:40,926][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-27 10:53:40,934][root][INFO] - vocab size              : 51200
[2024-09-27 10:53:40,934][root][INFO] - device                  : gpu
[2024-09-27 10:53:40,934][root][INFO] - random seed             : 42
[2024-09-27 10:53:40,934][root][INFO] - train data size         : 4096
[2024-09-27 10:53:40,934][root][INFO] - max epochs              : 15
[2024-09-27 10:53:40,934][root][INFO] - total steps             : 960
[2024-09-27 10:53:40,934][root][INFO] - warmup steps            : 96
[2024-09-27 10:53:40,935][root][INFO] - batch size              : 64
[2024-09-27 10:53:40,935][root][INFO] - accumulation steps      : 1
[2024-09-27 10:53:40,935][root][INFO] - optimizer               : adamwscale
[2024-09-27 10:53:40,935][root][INFO] - lr_scheduler            : cosine
[2024-09-27 10:53:40,935][root][INFO] - learning rate           : 0.01
[2024-09-27 10:53:40,935][root][INFO] - max length              : 256

[2024-09-27 10:53:40,935][root][INFO] - LoRA Configuration
[2024-09-27 10:53:40,935][root][INFO] - ㄴ r                    : 32
[2024-09-27 10:53:40,935][root][INFO] - ㄴ alpha                : 128
[2024-09-27 10:53:40,935][root][INFO] - ㄴ dropout              : 0.03

[2024-09-27 10:53:40,936][root][INFO] - KOMBO Configuration
[2024-09-27 10:53:40,936][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-27 10:53:40,936][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-27 10:53:40,936][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-27 10:53:40,936][root][INFO] - ㄴ do_combination       : True
[2024-09-27 10:53:40,936][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-27 10:53:40,936][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-27 10:53:40,936][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-27 10:53:40,936][root][INFO] -   ㄴ add_lora           : True

[2024-09-27 10:53:40,937][root][INFO] - LoRA in KOMBO Configuration
[2024-09-27 10:53:40,937][root][INFO] - ㄴ r                : 32
[2024-09-27 10:53:40,937][root][INFO] - ㄴ alpha            : 128
[2024-09-27 10:53:40,937][root][INFO] - ㄴ dropout          : 0.03

[2024-09-27 10:53:40,937][root][INFO] - 

[2024-09-27 10:53:40,937][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs
[2024-09-27 10:53:40,937][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-27 10:53:40,937][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/tb
[2024-09-27 10:53:40,937][root][INFO] - * tb interval   : 15

[2024-09-27 10:53:40,937][root][INFO] - 

[2024-09-27 10:53:40,937][root][INFO] - Start the Training !
[2024-09-27 10:53:40,941][root][INFO] - 
[1/ 15 Epoch]
[2024-09-27 10:53:48,172][root][INFO] - Step: 30/1035  |  Loss: 2.1954  |  Score: 22.97 [%]  |  Seq Length: 256.0
[2024-09-27 10:53:50,192][root][INFO] - Step: 15/960  |  Loss: 3.3199  |  Score: 2.31 [%]  |  Seq Length: 256.0
[2024-09-27 10:53:56,140][root][INFO] - Step: 45/1035  |  Loss: 1.8245  |  Score: 48.10 [%]  |  Seq Length: 256.0
[2024-09-27 10:53:57,952][root][INFO] - Step: 30/960  |  Loss: 2.4184  |  Score: 24.01 [%]  |  Seq Length: 256.0
[2024-09-27 10:54:04,167][root][INFO] - Step: 60/1035  |  Loss: 1.6580  |  Score: 60.26 [%]  |  Seq Length: 256.0
[2024-09-27 10:54:05,671][root][INFO] - Step: 45/960  |  Loss: 1.8424  |  Score: 44.81 [%]  |  Seq Length: 256.0
[2024-09-27 10:54:08,953][root][INFO] - Step: 69/1035  |  Loss: 1.6662  |  Score: 50.87 [%]  |  Seq Length: 256.0
[2024-09-27 10:54:13,440][root][INFO] - Step: 60/960  |  Loss: 1.6183  |  Score: 56.87 [%]  |  Seq Length: 256.0
[2024-09-27 10:54:14,059][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-27 10:54:14,059][root][INFO] - Score: 68.33 [%]  |  Evaluation Time: 5.10 [s]
[2024-09-27 10:54:15,563][root][INFO] - Step: 64/960  |  Loss: 2.0318  |  Score: 59.70 [%]  |  Seq Length: 256.0
[2024-09-27 10:54:18,765][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-27 10:54:18,765][root][INFO] - Score: 62.46 [%]  |  Evaluation Time: 4.70 [s]
[2024-09-27 10:54:18,766][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-27 10:54:18,767][root][INFO] - 
[2/ 15 Epoch]
[2024-09-27 10:54:20,196][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-27 10:54:20,197][root][INFO] - Score: 67.32 [%]  |  Evaluation Time: 4.63 [s]
[2024-09-27 10:54:22,220][root][INFO] - Step: 75/1035  |  Loss: 1.2319  |  Score: 70.39 [%]  |  Seq Length: 256.0
[2024-09-27 10:54:24,593][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-27 10:54:24,593][root][INFO] - Score: 64.36 [%]  |  Evaluation Time: 4.39 [s]
[2024-09-27 10:54:24,594][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-27 10:54:24,595][root][INFO] - 
[2/ 15 Epoch]
[2024-09-27 10:54:29,952][root][INFO] - Step: 90/1035  |  Loss: 1.3215  |  Score: 63.90 [%]  |  Seq Length: 256.0
[2024-09-27 10:54:30,633][root][INFO] - Step: 75/960  |  Loss: 1.5482  |  Score: 62.21 [%]  |  Seq Length: 256.0
[2024-09-27 10:54:37,852][root][INFO] - Step: 105/1035  |  Loss: 1.2619  |  Score: 60.93 [%]  |  Seq Length: 256.0
[2024-09-27 10:54:38,296][root][INFO] - Step: 90/960  |  Loss: 1.5519  |  Score: 61.36 [%]  |  Seq Length: 256.0
[2024-09-27 10:54:45,538][root][INFO] - Step: 120/1035  |  Loss: 1.3458  |  Score: 64.75 [%]  |  Seq Length: 256.0
[2024-09-27 10:54:46,022][root][INFO] - Step: 105/960  |  Loss: 1.3877  |  Score: 63.79 [%]  |  Seq Length: 256.0
[2024-09-27 10:54:53,224][root][INFO] - Step: 135/1035  |  Loss: 1.2937  |  Score: 64.89 [%]  |  Seq Length: 256.0
[2024-09-27 10:54:53,818][root][INFO] - Step: 120/960  |  Loss: 1.2456  |  Score: 67.54 [%]  |  Seq Length: 256.0
[2024-09-27 10:54:54,790][root][INFO] - Step: 138/1035  |  Loss: 1.1943  |  Score: 72.49 [%]  |  Seq Length: 256.0
[2024-09-27 10:54:57,968][root][INFO] - Step: 128/960  |  Loss: 1.2673  |  Score: 65.03 [%]  |  Seq Length: 256.0
[2024-09-27 10:54:59,760][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-27 10:54:59,760][root][INFO] - Score: 75.91 [%]  |  Evaluation Time: 4.97 [s]
[2024-09-27 10:55:02,614][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-27 10:55:02,614][root][INFO] - Score: 70.66 [%]  |  Evaluation Time: 4.64 [s]
[2024-09-27 10:55:04,438][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-27 10:55:04,439][root][INFO] - Score: 68.52 [%]  |  Evaluation Time: 4.68 [s]
[2024-09-27 10:55:04,440][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-27 10:55:04,441][root][INFO] - 
[3/ 15 Epoch]
[2024-09-27 10:55:07,115][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-27 10:55:07,115][root][INFO] - Score: 68.54 [%]  |  Evaluation Time: 4.50 [s]
[2024-09-27 10:55:07,116][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-27 10:55:07,117][root][INFO] - 
[3/ 15 Epoch]
[2024-09-27 10:55:11,173][root][INFO] - Step: 135/960  |  Loss: 1.0619  |  Score: 72.18 [%]  |  Seq Length: 256.0
[2024-09-27 10:55:11,313][root][INFO] - Step: 150/1035  |  Loss: 1.1828  |  Score: 71.70 [%]  |  Seq Length: 256.0
[2024-09-27 10:55:19,057][root][INFO] - Step: 150/960  |  Loss: 1.1190  |  Score: 69.37 [%]  |  Seq Length: 256.0
[2024-09-27 10:55:19,276][root][INFO] - Step: 165/1035  |  Loss: 1.0114  |  Score: 73.28 [%]  |  Seq Length: 256.0
[2024-09-27 10:55:26,869][root][INFO] - Step: 165/960  |  Loss: 1.0240  |  Score: 70.72 [%]  |  Seq Length: 256.0
[2024-09-27 10:55:27,254][root][INFO] - Step: 180/1035  |  Loss: 1.0496  |  Score: 69.93 [%]  |  Seq Length: 256.0
[2024-09-27 10:55:34,703][root][INFO] - Step: 180/960  |  Loss: 1.0063  |  Score: 72.89 [%]  |  Seq Length: 256.0
[2024-09-27 10:55:35,215][root][INFO] - Step: 195/1035  |  Loss: 1.0363  |  Score: 70.15 [%]  |  Seq Length: 256.0
[2024-09-27 10:55:40,935][root][INFO] - Step: 192/960  |  Loss: 1.1227  |  Score: 74.39 [%]  |  Seq Length: 256.0
[2024-09-27 10:55:41,601][root][INFO] - Step: 207/1035  |  Loss: 1.1076  |  Score: 70.09 [%]  |  Seq Length: 256.0
[2024-09-27 10:55:45,500][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-27 10:55:45,500][root][INFO] - Score: 77.17 [%]  |  Evaluation Time: 4.56 [s]
[2024-09-27 10:55:46,550][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-27 10:55:46,550][root][INFO] - Score: 77.21 [%]  |  Evaluation Time: 4.95 [s]
[2024-09-27 10:55:49,942][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-27 10:55:49,943][root][INFO] - Score: 71.16 [%]  |  Evaluation Time: 4.44 [s]
[2024-09-27 10:55:49,943][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-27 10:55:49,945][root][INFO] - 
[4/ 15 Epoch]
[2024-09-27 10:55:51,222][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-27 10:55:51,222][root][INFO] - Score: 70.96 [%]  |  Evaluation Time: 4.67 [s]
[2024-09-27 10:55:51,223][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-27 10:55:51,224][root][INFO] - 
[4/ 15 Epoch]
[2024-09-27 10:55:51,836][root][INFO] - Step: 195/960  |  Loss: 0.7937  |  Score: 80.88 [%]  |  Seq Length: 256.0
[2024-09-27 10:55:53,169][root][INFO] - Step: 210/1035  |  Loss: 0.8579  |  Score: 79.17 [%]  |  Seq Length: 256.0
[2024-09-27 10:55:59,559][root][INFO] - Step: 210/960  |  Loss: 1.0326  |  Score: 73.81 [%]  |  Seq Length: 256.0
[2024-09-27 10:56:01,175][root][INFO] - Step: 225/1035  |  Loss: 0.9970  |  Score: 72.64 [%]  |  Seq Length: 256.0
[2024-09-27 10:56:07,072][root][INFO] - Step: 225/960  |  Loss: 1.0248  |  Score: 75.41 [%]  |  Seq Length: 256.0
[2024-09-27 10:56:09,131][root][INFO] - Step: 240/1035  |  Loss: 0.9903  |  Score: 73.45 [%]  |  Seq Length: 256.0
[2024-09-27 10:56:14,553][root][INFO] - Step: 240/960  |  Loss: 0.8830  |  Score: 75.49 [%]  |  Seq Length: 256.0
[2024-09-27 10:56:17,160][root][INFO] - Step: 255/1035  |  Loss: 0.8887  |  Score: 76.91 [%]  |  Seq Length: 256.0
[2024-09-27 10:56:22,090][root][INFO] - Step: 255/960  |  Loss: 0.8544  |  Score: 77.18 [%]  |  Seq Length: 256.0
[2024-09-27 10:56:22,610][root][INFO] - Step: 256/960  |  Loss: 1.4896  |  Score: 76.07 [%]  |  Seq Length: 256.0
[2024-09-27 10:56:25,167][root][INFO] - Step: 270/1035  |  Loss: 0.9042  |  Score: 72.76 [%]  |  Seq Length: 256.0
[2024-09-27 10:56:27,242][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-27 10:56:27,242][root][INFO] - Score: 76.98 [%]  |  Evaluation Time: 4.63 [s]
[2024-09-27 10:56:28,352][root][INFO] - Step: 276/1035  |  Loss: 0.9876  |  Score: 76.76 [%]  |  Seq Length: 256.0
[2024-09-27 10:56:31,652][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-27 10:56:31,652][root][INFO] - Score: 68.68 [%]  |  Evaluation Time: 4.41 [s]
[2024-09-27 10:56:31,654][root][INFO] - 
[5/ 15 Epoch]
[2024-09-27 10:56:33,308][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-27 10:56:33,308][root][INFO] - Score: 78.03 [%]  |  Evaluation Time: 4.95 [s]
[2024-09-27 10:56:38,005][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-27 10:56:38,005][root][INFO] - Score: 70.85 [%]  |  Evaluation Time: 4.69 [s]
[2024-09-27 10:56:38,006][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-27 10:56:38,007][root][INFO] - 
[5/ 15 Epoch]
[2024-09-27 10:56:39,288][root][INFO] - Step: 270/960  |  Loss: 0.7720  |  Score: 79.04 [%]  |  Seq Length: 256.0
[2024-09-27 10:56:43,135][root][INFO] - Step: 285/1035  |  Loss: 0.8166  |  Score: 79.37 [%]  |  Seq Length: 256.0
[2024-09-27 10:56:47,184][root][INFO] - Step: 285/960  |  Loss: 0.8022  |  Score: 78.47 [%]  |  Seq Length: 256.0
[2024-09-27 10:56:51,088][root][INFO] - Step: 300/1035  |  Loss: 0.7899  |  Score: 78.19 [%]  |  Seq Length: 256.0
[2024-09-27 10:56:55,012][root][INFO] - Step: 300/960  |  Loss: 0.7355  |  Score: 80.07 [%]  |  Seq Length: 256.0
[2024-09-27 10:56:59,029][root][INFO] - Step: 315/1035  |  Loss: 0.8188  |  Score: 78.79 [%]  |  Seq Length: 256.0
[2024-09-27 10:57:02,726][root][INFO] - Step: 315/960  |  Loss: 0.8581  |  Score: 77.88 [%]  |  Seq Length: 256.0
[2024-09-27 10:57:05,395][root][INFO] - Step: 320/960  |  Loss: 0.7488  |  Score: 82.65 [%]  |  Seq Length: 256.0
[2024-09-27 10:57:07,001][root][INFO] - Step: 330/1035  |  Loss: 0.8080  |  Score: 76.12 [%]  |  Seq Length: 256.0
[2024-09-27 10:57:10,019][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-27 10:57:10,019][root][INFO] - Score: 75.84 [%]  |  Evaluation Time: 4.62 [s]
[2024-09-27 10:57:14,421][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-27 10:57:14,421][root][INFO] - Score: 72.33 [%]  |  Evaluation Time: 4.40 [s]
[2024-09-27 10:57:14,424][root][INFO] - 
[6/ 15 Epoch]
[2024-09-27 10:57:14,982][root][INFO] - Step: 345/1035  |  Loss: 0.8210  |  Score: 75.78 [%]  |  Seq Length: 256.0
[2024-09-27 10:57:19,926][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-27 10:57:19,926][root][INFO] - Score: 77.76 [%]  |  Evaluation Time: 4.94 [s]
[2024-09-27 10:57:19,949][root][INFO] - Step: 330/960  |  Loss: 0.6370  |  Score: 80.59 [%]  |  Seq Length: 256.0
[2024-09-27 10:57:24,603][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-27 10:57:24,604][root][INFO] - Score: 69.02 [%]  |  Evaluation Time: 4.68 [s]
[2024-09-27 10:57:24,606][root][INFO] - 
[6/ 15 Epoch]
[2024-09-27 10:57:25,686][root][INFO] - Step: 346/1035  |  Loss: 0.5469  |  Score: 83.67 [%]  |  Seq Length: 256.0
[2024-09-27 10:57:27,820][root][INFO] - Step: 345/960  |  Loss: 0.8384  |  Score: 82.32 [%]  |  Seq Length: 256.0
[2024-09-27 10:57:33,163][root][INFO] - Step: 360/1035  |  Loss: 0.6700  |  Score: 83.69 [%]  |  Seq Length: 256.0
[2024-09-27 10:57:35,616][root][INFO] - Step: 360/960  |  Loss: 0.7506  |  Score: 81.71 [%]  |  Seq Length: 256.0
[2024-09-27 10:57:41,036][root][INFO] - Step: 375/1035  |  Loss: 0.6528  |  Score: 82.96 [%]  |  Seq Length: 256.0
[2024-09-27 10:57:43,384][root][INFO] - Step: 375/960  |  Loss: 0.6874  |  Score: 82.25 [%]  |  Seq Length: 256.0
[2024-09-27 10:57:48,064][root][INFO] - Step: 384/960  |  Loss: 0.7305  |  Score: 82.35 [%]  |  Seq Length: 256.0
[2024-09-27 10:57:49,076][root][INFO] - Step: 390/1035  |  Loss: 0.7450  |  Score: 81.17 [%]  |  Seq Length: 256.0
[2024-09-27 10:57:52,757][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-27 10:57:52,757][root][INFO] - Score: 76.78 [%]  |  Evaluation Time: 4.69 [s]
[2024-09-27 10:57:57,007][root][INFO] - Step: 405/1035  |  Loss: 0.8302  |  Score: 76.38 [%]  |  Seq Length: 256.0
[2024-09-27 10:57:57,256][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-27 10:57:57,257][root][INFO] - Score: 71.27 [%]  |  Evaluation Time: 4.50 [s]
[2024-09-27 10:57:57,259][root][INFO] - 
[7/ 15 Epoch]
[2024-09-27 10:58:00,710][root][INFO] - Step: 390/960  |  Loss: 0.5639  |  Score: 84.30 [%]  |  Seq Length: 256.0
[2024-09-27 10:58:01,950][root][INFO] - Step: 414/1035  |  Loss: 0.6693  |  Score: 80.41 [%]  |  Seq Length: 256.0
[2024-09-27 10:58:06,878][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-27 10:58:06,878][root][INFO] - Score: 79.38 [%]  |  Evaluation Time: 4.93 [s]
[2024-09-27 10:58:08,467][root][INFO] - Step: 405/960  |  Loss: 0.6278  |  Score: 83.87 [%]  |  Seq Length: 256.0
[2024-09-27 10:58:11,576][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-27 10:58:11,576][root][INFO] - Score: 71.61 [%]  |  Evaluation Time: 4.70 [s]
[2024-09-27 10:58:11,577][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-27 10:58:11,579][root][INFO] - 
[7/ 15 Epoch]
[2024-09-27 10:58:15,083][root][INFO] - Step: 420/1035  |  Loss: 0.5729  |  Score: 81.92 [%]  |  Seq Length: 256.0
[2024-09-27 10:58:16,231][root][INFO] - Step: 420/960  |  Loss: 0.6702  |  Score: 83.10 [%]  |  Seq Length: 256.0
[2024-09-27 10:58:23,042][root][INFO] - Step: 435/1035  |  Loss: 0.5658  |  Score: 84.43 [%]  |  Seq Length: 256.0
[2024-09-27 10:58:23,997][root][INFO] - Step: 435/960  |  Loss: 0.6039  |  Score: 83.50 [%]  |  Seq Length: 256.0
[2024-09-27 10:58:30,778][root][INFO] - Step: 448/960  |  Loss: 0.6580  |  Score: 82.77 [%]  |  Seq Length: 256.0
[2024-09-27 10:58:31,040][root][INFO] - Step: 450/1035  |  Loss: 0.5963  |  Score: 84.10 [%]  |  Seq Length: 256.0
[2024-09-27 10:58:35,483][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-27 10:58:35,483][root][INFO] - Score: 79.60 [%]  |  Evaluation Time: 4.70 [s]
[2024-09-27 10:58:38,979][root][INFO] - Step: 465/1035  |  Loss: 0.7024  |  Score: 80.91 [%]  |  Seq Length: 256.0
[2024-09-27 10:58:40,051][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-27 10:58:40,051][root][INFO] - Score: 72.39 [%]  |  Evaluation Time: 4.57 [s]
[2024-09-27 10:58:40,052][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-27 10:58:40,053][root][INFO] - 
[8/ 15 Epoch]
[2024-09-27 10:58:41,578][root][INFO] - Step: 450/960  |  Loss: 0.4527  |  Score: 84.81 [%]  |  Seq Length: 256.0
[2024-09-27 10:58:46,929][root][INFO] - Step: 480/1035  |  Loss: 0.7115  |  Score: 80.16 [%]  |  Seq Length: 256.0
[2024-09-27 10:58:48,540][root][INFO] - Step: 483/1035  |  Loss: 0.5116  |  Score: 88.78 [%]  |  Seq Length: 256.0
[2024-09-27 10:58:49,371][root][INFO] - Step: 465/960  |  Loss: 0.5298  |  Score: 86.03 [%]  |  Seq Length: 256.0
[2024-09-27 10:58:53,614][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-27 10:58:53,615][root][INFO] - Score: 76.61 [%]  |  Evaluation Time: 5.07 [s]
[2024-09-27 10:58:57,104][root][INFO] - Step: 480/960  |  Loss: 0.5000  |  Score: 86.99 [%]  |  Seq Length: 256.0
[2024-09-27 10:58:58,267][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-27 10:58:58,267][root][INFO] - Score: 70.48 [%]  |  Evaluation Time: 4.65 [s]
[2024-09-27 10:58:58,270][root][INFO] - 
[8/ 15 Epoch]
[2024-09-27 10:59:04,864][root][INFO] - Step: 495/960  |  Loss: 0.5913  |  Score: 84.41 [%]  |  Seq Length: 256.0
[2024-09-27 10:59:04,966][root][INFO] - Step: 495/1035  |  Loss: 0.5460  |  Score: 83.76 [%]  |  Seq Length: 256.0
[2024-09-27 10:59:12,613][root][INFO] - Step: 510/960  |  Loss: 0.6070  |  Score: 85.36 [%]  |  Seq Length: 256.0
[2024-09-27 10:59:12,954][root][INFO] - Step: 510/1035  |  Loss: 0.5911  |  Score: 83.78 [%]  |  Seq Length: 256.0
[2024-09-27 10:59:13,669][root][INFO] - Step: 512/960  |  Loss: 0.5199  |  Score: 85.42 [%]  |  Seq Length: 256.0
[2024-09-27 10:59:18,325][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-27 10:59:18,325][root][INFO] - Score: 78.29 [%]  |  Evaluation Time: 4.65 [s]
[2024-09-27 10:59:20,912][root][INFO] - Step: 525/1035  |  Loss: 0.5596  |  Score: 84.26 [%]  |  Seq Length: 256.0
[2024-09-27 10:59:22,825][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-27 10:59:22,825][root][INFO] - Score: 72.71 [%]  |  Evaluation Time: 4.50 [s]
[2024-09-27 10:59:22,827][root][INFO] - 
[9/ 15 Epoch]
[2024-09-27 10:59:28,882][root][INFO] - Step: 540/1035  |  Loss: 0.5512  |  Score: 85.28 [%]  |  Seq Length: 256.0
[2024-09-27 10:59:30,037][root][INFO] - Step: 525/960  |  Loss: 0.4798  |  Score: 87.71 [%]  |  Seq Length: 256.0
[2024-09-27 10:59:35,215][root][INFO] - Step: 552/1035  |  Loss: 0.5578  |  Score: 84.00 [%]  |  Seq Length: 256.0
[2024-09-27 10:59:37,773][root][INFO] - Step: 540/960  |  Loss: 0.4546  |  Score: 87.38 [%]  |  Seq Length: 256.0
[2024-09-27 10:59:40,214][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-27 10:59:40,214][root][INFO] - Score: 77.80 [%]  |  Evaluation Time: 5.00 [s]
[2024-09-27 10:59:44,868][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-27 10:59:44,868][root][INFO] - Score: 70.66 [%]  |  Evaluation Time: 4.65 [s]
[2024-09-27 10:59:44,871][root][INFO] - 
[9/ 15 Epoch]
[2024-09-27 10:59:45,555][root][INFO] - Step: 555/960  |  Loss: 0.4853  |  Score: 86.36 [%]  |  Seq Length: 256.0
[2024-09-27 10:59:46,920][root][INFO] - Step: 555/1035  |  Loss: 0.5597  |  Score: 84.80 [%]  |  Seq Length: 256.0
[2024-09-27 10:59:53,312][root][INFO] - Step: 570/960  |  Loss: 0.4680  |  Score: 87.52 [%]  |  Seq Length: 256.0
[2024-09-27 10:59:54,882][root][INFO] - Step: 570/1035  |  Loss: 0.4601  |  Score: 87.78 [%]  |  Seq Length: 256.0
[2024-09-27 10:59:56,417][root][INFO] - Step: 576/960  |  Loss: 0.4394  |  Score: 87.61 [%]  |  Seq Length: 256.0
[2024-09-27 11:00:01,091][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-27 11:00:01,091][root][INFO] - Score: 78.79 [%]  |  Evaluation Time: 4.67 [s]
[2024-09-27 11:00:02,848][root][INFO] - Step: 585/1035  |  Loss: 0.4946  |  Score: 85.42 [%]  |  Seq Length: 256.0
[2024-09-27 11:00:05,506][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-27 11:00:05,506][root][INFO] - Score: 71.20 [%]  |  Evaluation Time: 4.41 [s]
[2024-09-27 11:00:05,508][root][INFO] - 
[10/ 15 Epoch]
[2024-09-27 11:00:10,525][root][INFO] - Step: 585/960  |  Loss: 0.4895  |  Score: 86.13 [%]  |  Seq Length: 256.0
[2024-09-27 11:00:10,807][root][INFO] - Step: 600/1035  |  Loss: 0.4941  |  Score: 87.11 [%]  |  Seq Length: 256.0
[2024-09-27 11:00:18,329][root][INFO] - Step: 600/960  |  Loss: 0.4690  |  Score: 88.06 [%]  |  Seq Length: 256.0
[2024-09-27 11:00:18,773][root][INFO] - Step: 615/1035  |  Loss: 0.5246  |  Score: 85.90 [%]  |  Seq Length: 256.0
[2024-09-27 11:00:22,032][root][INFO] - Step: 621/1035  |  Loss: 0.5167  |  Score: 86.57 [%]  |  Seq Length: 256.0
[2024-09-27 11:00:26,212][root][INFO] - Step: 615/960  |  Loss: 0.4802  |  Score: 87.75 [%]  |  Seq Length: 256.0
[2024-09-27 11:00:27,046][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-27 11:00:27,047][root][INFO] - Score: 77.06 [%]  |  Evaluation Time: 5.01 [s]
[2024-09-27 11:00:31,720][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-27 11:00:31,721][root][INFO] - Score: 71.82 [%]  |  Evaluation Time: 4.67 [s]
[2024-09-27 11:00:31,723][root][INFO] - 
[10/ 15 Epoch]
[2024-09-27 11:00:33,976][root][INFO] - Step: 630/960  |  Loss: 0.4149  |  Score: 89.20 [%]  |  Seq Length: 256.0
[2024-09-27 11:00:36,963][root][INFO] - Step: 630/1035  |  Loss: 0.4785  |  Score: 86.84 [%]  |  Seq Length: 256.0
[2024-09-27 11:00:39,199][root][INFO] - Step: 640/960  |  Loss: 0.4492  |  Score: 87.58 [%]  |  Seq Length: 256.0
[2024-09-27 11:00:43,897][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-27 11:00:43,897][root][INFO] - Score: 77.26 [%]  |  Evaluation Time: 4.69 [s]
[2024-09-27 11:00:44,958][root][INFO] - Step: 645/1035  |  Loss: 0.4662  |  Score: 88.14 [%]  |  Seq Length: 256.0
[2024-09-27 11:00:48,314][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-27 11:00:48,314][root][INFO] - Score: 72.37 [%]  |  Evaluation Time: 4.41 [s]
[2024-09-27 11:00:48,316][root][INFO] - 
[11/ 15 Epoch]
[2024-09-27 11:00:51,366][root][INFO] - Step: 645/960  |  Loss: 0.4134  |  Score: 90.75 [%]  |  Seq Length: 256.0
[2024-09-27 11:00:53,004][root][INFO] - Step: 660/1035  |  Loss: 0.4612  |  Score: 87.28 [%]  |  Seq Length: 256.0
[2024-09-27 11:00:59,051][root][INFO] - Step: 660/960  |  Loss: 0.3945  |  Score: 89.87 [%]  |  Seq Length: 256.0
[2024-09-27 11:01:01,006][root][INFO] - Step: 675/1035  |  Loss: 0.4466  |  Score: 87.38 [%]  |  Seq Length: 256.0
[2024-09-27 11:01:06,770][root][INFO] - Step: 675/960  |  Loss: 0.4073  |  Score: 88.04 [%]  |  Seq Length: 256.0
[2024-09-27 11:01:08,926][root][INFO] - Step: 690/1035  |  Loss: 0.4225  |  Score: 87.86 [%]  |  Seq Length: 256.0
[2024-09-27 11:01:13,942][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-27 11:01:13,942][root][INFO] - Score: 76.93 [%]  |  Evaluation Time: 5.01 [s]
[2024-09-27 11:01:14,585][root][INFO] - Step: 690/960  |  Loss: 0.3989  |  Score: 90.08 [%]  |  Seq Length: 256.0
[2024-09-27 11:01:18,770][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-27 11:01:18,770][root][INFO] - Score: 71.35 [%]  |  Evaluation Time: 4.83 [s]
[2024-09-27 11:01:18,773][root][INFO] - 
[11/ 15 Epoch]
[2024-09-27 11:01:19,646][root][INFO] - Step: 691/1035  |  Loss: 0.4680  |  Score: 88.60 [%]  |  Seq Length: 256.0
[2024-09-27 11:01:21,822][root][INFO] - Step: 704/960  |  Loss: 0.4270  |  Score: 87.74 [%]  |  Seq Length: 256.0
[2024-09-27 11:01:26,569][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-27 11:01:26,570][root][INFO] - Score: 76.13 [%]  |  Evaluation Time: 4.75 [s]
[2024-09-27 11:01:27,133][root][INFO] - Step: 705/1035  |  Loss: 0.4126  |  Score: 89.47 [%]  |  Seq Length: 256.0
[2024-09-27 11:01:30,995][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-27 11:01:30,995][root][INFO] - Score: 71.61 [%]  |  Evaluation Time: 4.42 [s]
[2024-09-27 11:01:30,997][root][INFO] - 
[12/ 15 Epoch]
[2024-09-27 11:01:31,922][root][INFO] - Step: 705/960  |  Loss: 0.4418  |  Score: 91.00 [%]  |  Seq Length: 256.0
[2024-09-27 11:01:35,119][root][INFO] - Step: 720/1035  |  Loss: 0.4203  |  Score: 88.29 [%]  |  Seq Length: 256.0
[2024-09-27 11:01:39,673][root][INFO] - Step: 720/960  |  Loss: 0.3907  |  Score: 89.31 [%]  |  Seq Length: 256.0
[2024-09-27 11:01:42,866][root][INFO] - Step: 735/1035  |  Loss: 0.3815  |  Score: 88.70 [%]  |  Seq Length: 256.0
[2024-09-27 11:01:47,404][root][INFO] - Step: 735/960  |  Loss: 0.3892  |  Score: 89.35 [%]  |  Seq Length: 256.0
[2024-09-27 11:01:50,598][root][INFO] - Step: 750/1035  |  Loss: 0.4389  |  Score: 88.24 [%]  |  Seq Length: 256.0
[2024-09-27 11:01:55,148][root][INFO] - Step: 750/960  |  Loss: 0.3257  |  Score: 91.21 [%]  |  Seq Length: 256.0
[2024-09-27 11:01:55,274][root][INFO] - Step: 759/1035  |  Loss: 0.4280  |  Score: 89.00 [%]  |  Seq Length: 256.0
[2024-09-27 11:02:00,233][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-27 11:02:00,233][root][INFO] - Score: 77.16 [%]  |  Evaluation Time: 4.96 [s]
[2024-09-27 11:02:02,953][root][INFO] - Step: 765/960  |  Loss: 0.3830  |  Score: 89.50 [%]  |  Seq Length: 256.0
[2024-09-27 11:02:04,535][root][INFO] - Step: 768/960  |  Loss: 0.3799  |  Score: 89.90 [%]  |  Seq Length: 256.0
[2024-09-27 11:02:04,914][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-27 11:02:04,914][root][INFO] - Score: 70.91 [%]  |  Evaluation Time: 4.68 [s]
[2024-09-27 11:02:04,917][root][INFO] - 
[12/ 15 Epoch]
[2024-09-27 11:02:08,455][root][INFO] - Step: 765/1035  |  Loss: 0.3866  |  Score: 90.20 [%]  |  Seq Length: 256.0
[2024-09-27 11:02:09,375][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-27 11:02:09,376][root][INFO] - Score: 78.19 [%]  |  Evaluation Time: 4.84 [s]
[2024-09-27 11:02:13,885][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-27 11:02:13,886][root][INFO] - Score: 73.00 [%]  |  Evaluation Time: 4.51 [s]
[2024-09-27 11:02:13,888][root][INFO] - 
[13/ 15 Epoch]
[2024-09-27 11:02:16,460][root][INFO] - Step: 780/1035  |  Loss: 0.3663  |  Score: 90.07 [%]  |  Seq Length: 256.0
[2024-09-27 11:02:20,618][root][INFO] - Step: 780/960  |  Loss: 0.3826  |  Score: 89.54 [%]  |  Seq Length: 256.0
[2024-09-27 11:02:24,260][root][INFO] - Step: 795/1035  |  Loss: 0.3712  |  Score: 89.49 [%]  |  Seq Length: 256.0
[2024-09-27 11:02:28,367][root][INFO] - Step: 795/960  |  Loss: 0.3551  |  Score: 90.09 [%]  |  Seq Length: 256.0
[2024-09-27 11:02:32,182][root][INFO] - Step: 810/1035  |  Loss: 0.3726  |  Score: 89.60 [%]  |  Seq Length: 256.0
[2024-09-27 11:02:36,095][root][INFO] - Step: 810/960  |  Loss: 0.3335  |  Score: 91.02 [%]  |  Seq Length: 256.0
[2024-09-27 11:02:40,090][root][INFO] - Step: 825/1035  |  Loss: 0.3668  |  Score: 89.66 [%]  |  Seq Length: 256.0
[2024-09-27 11:02:41,685][root][INFO] - Step: 828/1035  |  Loss: 0.3289  |  Score: 89.22 [%]  |  Seq Length: 256.0
[2024-09-27 11:02:43,851][root][INFO] - Step: 825/960  |  Loss: 0.3578  |  Score: 90.16 [%]  |  Seq Length: 256.0
[2024-09-27 11:02:46,647][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-27 11:02:46,647][root][INFO] - Score: 78.28 [%]  |  Evaluation Time: 4.96 [s]
[2024-09-27 11:02:47,563][root][INFO] - Step: 832/960  |  Loss: 0.3581  |  Score: 90.01 [%]  |  Seq Length: 256.0
[2024-09-27 11:02:51,332][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-27 11:02:51,333][root][INFO] - Score: 70.69 [%]  |  Evaluation Time: 4.68 [s]
[2024-09-27 11:02:51,335][root][INFO] - 
[13/ 15 Epoch]
[2024-09-27 11:02:52,248][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-27 11:02:52,248][root][INFO] - Score: 76.07 [%]  |  Evaluation Time: 4.68 [s]
[2024-09-27 11:02:56,619][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-27 11:02:56,619][root][INFO] - Score: 71.98 [%]  |  Evaluation Time: 4.37 [s]
[2024-09-27 11:02:56,622][root][INFO] - 
[14/ 15 Epoch]
[2024-09-27 11:02:58,120][root][INFO] - Step: 840/1035  |  Loss: 0.3423  |  Score: 90.96 [%]  |  Seq Length: 256.0
[2024-09-27 11:03:01,165][root][INFO] - Step: 840/960  |  Loss: 0.3764  |  Score: 89.84 [%]  |  Seq Length: 256.0
[2024-09-27 11:03:06,140][root][INFO] - Step: 855/1035  |  Loss: 0.3984  |  Score: 88.54 [%]  |  Seq Length: 256.0
[2024-09-27 11:03:08,895][root][INFO] - Step: 855/960  |  Loss: 0.3477  |  Score: 90.91 [%]  |  Seq Length: 256.0
[2024-09-27 11:03:14,129][root][INFO] - Step: 870/1035  |  Loss: 0.3848  |  Score: 89.15 [%]  |  Seq Length: 256.0
[2024-09-27 11:03:16,610][root][INFO] - Step: 870/960  |  Loss: 0.3312  |  Score: 91.13 [%]  |  Seq Length: 256.0
[2024-09-27 11:03:22,185][root][INFO] - Step: 885/1035  |  Loss: 0.3197  |  Score: 90.88 [%]  |  Seq Length: 256.0
[2024-09-27 11:03:24,408][root][INFO] - Step: 885/960  |  Loss: 0.3447  |  Score: 90.03 [%]  |  Seq Length: 256.0
[2024-09-27 11:03:28,569][root][INFO] - Step: 897/1035  |  Loss: 0.3799  |  Score: 89.70 [%]  |  Seq Length: 256.0
[2024-09-27 11:03:30,236][root][INFO] - Step: 896/960  |  Loss: 0.3556  |  Score: 89.83 [%]  |  Seq Length: 256.0
[2024-09-27 11:03:33,662][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-27 11:03:33,662][root][INFO] - Score: 76.78 [%]  |  Evaluation Time: 5.09 [s]
[2024-09-27 11:03:34,786][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-27 11:03:34,786][root][INFO] - Score: 76.33 [%]  |  Evaluation Time: 4.55 [s]
[2024-09-27 11:03:38,338][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-27 11:03:38,339][root][INFO] - Score: 70.78 [%]  |  Evaluation Time: 4.67 [s]
[2024-09-27 11:03:38,341][root][INFO] - 
[14/ 15 Epoch]
[2024-09-27 11:03:39,188][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-27 11:03:39,188][root][INFO] - Score: 72.95 [%]  |  Evaluation Time: 4.40 [s]
[2024-09-27 11:03:39,190][root][INFO] - 
[15/ 15 Epoch]
[2024-09-27 11:03:40,274][root][INFO] - Step: 900/1035  |  Loss: 0.3603  |  Score: 91.92 [%]  |  Seq Length: 256.0
[2024-09-27 11:03:41,628][root][INFO] - Step: 900/960  |  Loss: 0.3115  |  Score: 91.94 [%]  |  Seq Length: 256.0
[2024-09-27 11:03:48,216][root][INFO] - Step: 915/1035  |  Loss: 0.3531  |  Score: 90.59 [%]  |  Seq Length: 256.0
[2024-09-27 11:03:49,396][root][INFO] - Step: 915/960  |  Loss: 0.3469  |  Score: 90.56 [%]  |  Seq Length: 256.0
[2024-09-27 11:03:56,194][root][INFO] - Step: 930/1035  |  Loss: 0.3346  |  Score: 90.07 [%]  |  Seq Length: 256.0
[2024-09-27 11:03:57,138][root][INFO] - Step: 930/960  |  Loss: 0.3501  |  Score: 91.56 [%]  |  Seq Length: 256.0
[2024-09-27 11:04:04,157][root][INFO] - Step: 945/1035  |  Loss: 0.3628  |  Score: 89.14 [%]  |  Seq Length: 256.0
[2024-09-27 11:04:04,890][root][INFO] - Step: 945/960  |  Loss: 0.3278  |  Score: 90.67 [%]  |  Seq Length: 256.0
[2024-09-27 11:04:12,050][root][INFO] - Step: 960/1035  |  Loss: 0.3682  |  Score: 89.43 [%]  |  Seq Length: 256.0
[2024-09-27 11:04:12,657][root][INFO] - Step: 960/960  |  Loss: 0.3303  |  Score: 90.25 [%]  |  Seq Length: 256.0
[2024-09-27 11:04:15,240][root][INFO] - Step: 966/1035  |  Loss: 0.3745  |  Score: 89.15 [%]  |  Seq Length: 256.0
[2024-09-27 11:04:17,418][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-27 11:04:17,419][root][INFO] - Score: 77.68 [%]  |  Evaluation Time: 4.76 [s]
[2024-09-27 11:04:20,350][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-27 11:04:20,350][root][INFO] - Score: 77.15 [%]  |  Evaluation Time: 5.10 [s]
[2024-09-27 11:04:21,797][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-27 11:04:21,797][root][INFO] - Score: 72.40 [%]  |  Evaluation Time: 4.38 [s]
[2024-09-27 11:04:21,798][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-27 11:04:21,798][root][INFO] - - Epoch: 7
[2024-09-27 11:04:21,798][root][INFO] - - DEV score: 79.60 [%]
[2024-09-27 11:04:21,799][root][INFO] - - TEST score: 72.39 [%]
[2024-09-27 11:04:21,799][root][INFO] - Fine-tuning is done!
[2024-09-27 11:04:25,097][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-27 11:04:25,097][root][INFO] - Score: 70.90 [%]  |  Evaluation Time: 4.74 [s]
[2024-09-27 11:04:25,100][root][INFO] - 
[15/ 15 Epoch]
[2024-09-27 11:04:28,102][root][INFO] - 

[2024-09-27 11:04:28,102][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-27 11:04:28,102][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs
[2024-09-27 11:04:28,102][root][INFO] - 

[2024-09-27 11:04:28,102][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_punc', 'do_hangeulize': False, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-27 11:04:30,311][root][INFO] - Step: 975/1035  |  Loss: 0.3285  |  Score: 90.38 [%]  |  Seq Length: 256.0
[2024-09-27 11:04:32,368][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-27 11:04:32,369][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-27 11:04:32,370][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-27 11:04:32,370][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-27 11:04:32,371][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-27 11:04:32,371][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-27 11:04:32,372][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-27 11:04:32,372][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-27 11:04:32,373][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-27 11:04:32,373][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-27 11:04:32,374][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-27 11:04:32,374][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-27 11:04:32,375][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-27 11:04:32,375][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-27 11:04:32,376][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-27 11:04:32,376][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-27 11:04:32,377][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-27 11:04:32,378][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-27 11:04:32,378][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-27 11:04:32,379][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-27 11:04:32,379][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-27 11:04:32,380][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-27 11:04:32,381][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-27 11:04:32,381][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-27 11:04:32,383][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-27 11:04:32,662][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-27 11:04:36,636][root][INFO] - 

[2024-09-27 11:04:36,637][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-27 11:04:36,637][root][INFO] - Data Preprocessing
[2024-09-27 11:04:36,637][root][INFO] - ㄴ remain_lang                ko_punc
[2024-09-27 11:04:36,637][root][INFO] - ㄴ do_hangeulize              False
[2024-09-27 11:04:36,637][root][INFO] - ㄴ data_remove                True

[2024-09-27 11:04:36,637][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-27 11:04:36,645][root][INFO] - vocab size              : 51200
[2024-09-27 11:04:36,645][root][INFO] - device                  : gpu
[2024-09-27 11:04:36,645][root][INFO] - random seed             : 42
[2024-09-27 11:04:36,646][root][INFO] - train data size         : 4096
[2024-09-27 11:04:36,646][root][INFO] - max epochs              : 15
[2024-09-27 11:04:36,646][root][INFO] - total steps             : 960
[2024-09-27 11:04:36,646][root][INFO] - warmup steps            : 96
[2024-09-27 11:04:36,646][root][INFO] - batch size              : 64
[2024-09-27 11:04:36,646][root][INFO] - accumulation steps      : 1
[2024-09-27 11:04:36,646][root][INFO] - optimizer               : adamwscale
[2024-09-27 11:04:36,646][root][INFO] - lr_scheduler            : cosine
[2024-09-27 11:04:36,646][root][INFO] - learning rate           : 0.01
[2024-09-27 11:04:36,646][root][INFO] - max length              : 256

[2024-09-27 11:04:36,646][root][INFO] - LoRA Configuration
[2024-09-27 11:04:36,647][root][INFO] - ㄴ r                    : 32
[2024-09-27 11:04:36,647][root][INFO] - ㄴ alpha                : 128
[2024-09-27 11:04:36,647][root][INFO] - ㄴ dropout              : 0.03

[2024-09-27 11:04:36,647][root][INFO] - 

[2024-09-27 11:04:36,647][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs
[2024-09-27 11:04:36,647][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-27 11:04:36,647][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/tb
[2024-09-27 11:04:36,647][root][INFO] - * tb interval   : 15

[2024-09-27 11:04:36,647][root][INFO] - 

[2024-09-27 11:04:36,647][root][INFO] - Start the Training !
[2024-09-27 11:04:36,650][root][INFO] - 
[1/ 15 Epoch]
[2024-09-27 11:04:38,212][root][INFO] - Step: 990/1035  |  Loss: 0.3476  |  Score: 90.74 [%]  |  Seq Length: 256.0
[2024-09-27 11:04:44,948][root][INFO] - Step: 15/960  |  Loss: 3.1154  |  Score: 6.93 [%]  |  Seq Length: 256.0
[2024-09-27 11:04:46,175][root][INFO] - Step: 1005/1035  |  Loss: 0.3573  |  Score: 90.35 [%]  |  Seq Length: 256.0
[2024-09-27 11:04:50,478][root][INFO] - Step: 30/960  |  Loss: 2.3676  |  Score: 21.72 [%]  |  Seq Length: 256.0
[2024-09-27 11:04:54,162][root][INFO] - Step: 1020/1035  |  Loss: 0.3235  |  Score: 90.66 [%]  |  Seq Length: 256.0
[2024-09-27 11:04:56,013][root][INFO] - Step: 45/960  |  Loss: 1.9307  |  Score: 42.03 [%]  |  Seq Length: 256.0
[2024-09-27 11:05:01,548][root][INFO] - Step: 60/960  |  Loss: 1.5983  |  Score: 59.45 [%]  |  Seq Length: 256.0
[2024-09-27 11:05:02,104][root][INFO] - Step: 1035/1035  |  Loss: 0.3769  |  Score: 89.28 [%]  |  Seq Length: 256.0
[2024-09-27 11:05:03,035][root][INFO] - Step: 64/960  |  Loss: 1.5560  |  Score: 56.52 [%]  |  Seq Length: 256.0
[2024-09-27 11:05:05,994][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-27 11:05:05,995][root][INFO] - Score: 72.98 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-27 11:05:07,225][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-27 11:05:07,225][root][INFO] - Score: 77.74 [%]  |  Evaluation Time: 5.12 [s]
[2024-09-27 11:05:08,910][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-27 11:05:08,910][root][INFO] - Score: 65.27 [%]  |  Evaluation Time: 2.91 [s]
[2024-09-27 11:05:08,912][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-27 11:05:08,913][root][INFO] - 
[2/ 15 Epoch]
[2024-09-27 11:05:11,872][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-27 11:05:11,872][root][INFO] - Score: 71.91 [%]  |  Evaluation Time: 4.64 [s]
[2024-09-27 11:05:11,873][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-27 11:05:11,873][root][INFO] - - Epoch: 6
[2024-09-27 11:05:11,873][root][INFO] - - DEV score: 79.38 [%]
[2024-09-27 11:05:11,873][root][INFO] - - TEST score: 71.61 [%]
[2024-09-27 11:05:11,874][root][INFO] - Fine-tuning is done!
[2024-09-27 11:05:13,364][root][INFO] - Step: 75/960  |  Loss: 1.5293  |  Score: 58.12 [%]  |  Seq Length: 256.0
[2024-09-27 11:05:18,640][root][INFO] - 

[2024-09-27 11:05:18,640][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-27 11:05:18,640][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-27 11:05:18,640][root][INFO] - 

[2024-09-27 11:05:18,641][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': False, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-27 11:05:18,904][root][INFO] - Step: 90/960  |  Loss: 1.2015  |  Score: 67.93 [%]  |  Seq Length: 256.0
[2024-09-27 11:05:23,495][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-27 11:05:23,496][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-27 11:05:23,496][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-27 11:05:23,497][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-27 11:05:23,497][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-27 11:05:23,498][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-27 11:05:23,498][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-27 11:05:23,499][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-27 11:05:23,499][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-27 11:05:23,499][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-27 11:05:23,500][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-27 11:05:23,500][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-27 11:05:23,501][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-27 11:05:23,501][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-27 11:05:23,502][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-27 11:05:23,502][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-27 11:05:23,502][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-27 11:05:23,503][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-27 11:05:23,503][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-27 11:05:23,504][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-27 11:05:23,504][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-27 11:05:23,505][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-27 11:05:23,505][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-27 11:05:23,506][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-27 11:05:23,507][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-27 11:05:23,955][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-27 11:05:24,447][root][INFO] - Step: 105/960  |  Loss: 1.4899  |  Score: 63.51 [%]  |  Seq Length: 256.0
[2024-09-27 11:05:27,853][root][INFO] - 

[2024-09-27 11:05:27,854][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-27 11:05:27,854][root][INFO] - Data Preprocessing
[2024-09-27 11:05:27,854][root][INFO] - ㄴ remain_lang                ko_en_punc
[2024-09-27 11:05:27,854][root][INFO] - ㄴ do_hangeulize              False
[2024-09-27 11:05:27,854][root][INFO] - ㄴ data_remove                True

[2024-09-27 11:05:27,854][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-27 11:05:27,862][root][INFO] - vocab size              : 51200
[2024-09-27 11:05:27,862][root][INFO] - device                  : gpu
[2024-09-27 11:05:27,862][root][INFO] - random seed             : 42
[2024-09-27 11:05:27,862][root][INFO] - train data size         : 4416
[2024-09-27 11:05:27,862][root][INFO] - max epochs              : 15
[2024-09-27 11:05:27,862][root][INFO] - total steps             : 1035
[2024-09-27 11:05:27,862][root][INFO] - warmup steps            : 104
[2024-09-27 11:05:27,862][root][INFO] - batch size              : 64
[2024-09-27 11:05:27,863][root][INFO] - accumulation steps      : 1
[2024-09-27 11:05:27,863][root][INFO] - optimizer               : adamwscale
[2024-09-27 11:05:27,863][root][INFO] - lr_scheduler            : cosine
[2024-09-27 11:05:27,863][root][INFO] - learning rate           : 0.01
[2024-09-27 11:05:27,863][root][INFO] - max length              : 256

[2024-09-27 11:05:27,863][root][INFO] - LoRA Configuration
[2024-09-27 11:05:27,863][root][INFO] - ㄴ r                    : 32
[2024-09-27 11:05:27,863][root][INFO] - ㄴ alpha                : 128
[2024-09-27 11:05:27,863][root][INFO] - ㄴ dropout              : 0.03

[2024-09-27 11:05:27,863][root][INFO] - 

[2024-09-27 11:05:27,863][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-27 11:05:27,863][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-27 11:05:27,864][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb
[2024-09-27 11:05:27,864][root][INFO] - * tb interval   : 15

[2024-09-27 11:05:27,864][root][INFO] - 

[2024-09-27 11:05:27,864][root][INFO] - Start the Training !
[2024-09-27 11:05:27,867][root][INFO] - 
[1/ 15 Epoch]
[2024-09-27 11:05:30,000][root][INFO] - Step: 120/960  |  Loss: 1.2131  |  Score: 69.03 [%]  |  Seq Length: 256.0
[2024-09-27 11:05:32,979][root][INFO] - Step: 128/960  |  Loss: 1.3841  |  Score: 66.19 [%]  |  Seq Length: 256.0
[2024-09-27 11:05:35,920][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-27 11:05:35,920][root][INFO] - Score: 76.66 [%]  |  Evaluation Time: 2.94 [s]
[2024-09-27 11:05:36,323][root][INFO] - Step: 15/1035  |  Loss: 3.1039  |  Score: 7.39 [%]  |  Seq Length: 256.0
[2024-09-27 11:05:38,810][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-27 11:05:38,810][root][INFO] - Score: 67.80 [%]  |  Evaluation Time: 2.89 [s]
[2024-09-27 11:05:38,811][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-27 11:05:38,813][root][INFO] - 
[3/ 15 Epoch]
[2024-09-27 11:05:41,772][root][INFO] - Step: 135/960  |  Loss: 1.1357  |  Score: 72.61 [%]  |  Seq Length: 256.0
[2024-09-27 11:05:42,043][root][INFO] - Step: 30/1035  |  Loss: 2.3422  |  Score: 15.28 [%]  |  Seq Length: 256.0
[2024-09-27 11:05:47,322][root][INFO] - Step: 150/960  |  Loss: 1.2151  |  Score: 70.06 [%]  |  Seq Length: 256.0
[2024-09-27 11:05:47,763][root][INFO] - Step: 45/1035  |  Loss: 1.8057  |  Score: 44.74 [%]  |  Seq Length: 256.0
[2024-09-27 11:05:52,868][root][INFO] - Step: 165/960  |  Loss: 1.0905  |  Score: 68.26 [%]  |  Seq Length: 256.0
[2024-09-27 11:05:53,483][root][INFO] - Step: 60/1035  |  Loss: 1.5434  |  Score: 57.44 [%]  |  Seq Length: 256.0
[2024-09-27 11:05:56,919][root][INFO] - Step: 69/1035  |  Loss: 1.4595  |  Score: 63.19 [%]  |  Seq Length: 256.0
[2024-09-27 11:05:58,424][root][INFO] - Step: 180/960  |  Loss: 1.0470  |  Score: 71.87 [%]  |  Seq Length: 256.0
[2024-09-27 11:06:00,188][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-27 11:06:00,188][root][INFO] - Score: 74.57 [%]  |  Evaluation Time: 3.27 [s]
[2024-09-27 11:06:02,916][root][INFO] - Step: 192/960  |  Loss: 1.0954  |  Score: 71.81 [%]  |  Seq Length: 256.0
[2024-09-27 11:06:03,237][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-27 11:06:03,237][root][INFO] - Score: 66.09 [%]  |  Evaluation Time: 3.05 [s]
[2024-09-27 11:06:03,238][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-27 11:06:03,239][root][INFO] - 
[2/ 15 Epoch]
[2024-09-27 11:06:05,963][root][INFO] - Step: 75/1035  |  Loss: 1.4589  |  Score: 61.71 [%]  |  Seq Length: 256.0
[2024-09-27 11:06:06,015][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-27 11:06:06,015][root][INFO] - Score: 72.98 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-27 11:06:08,840][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-27 11:06:08,840][root][INFO] - Score: 68.67 [%]  |  Evaluation Time: 2.82 [s]
[2024-09-27 11:06:08,842][root][INFO] - 
[4/ 15 Epoch]
[2024-09-27 11:06:10,334][root][INFO] - Step: 195/960  |  Loss: 1.0279  |  Score: 75.76 [%]  |  Seq Length: 256.0
[2024-09-27 11:06:11,680][root][INFO] - Step: 90/1035  |  Loss: 1.4424  |  Score: 63.24 [%]  |  Seq Length: 256.0
[2024-09-27 11:06:15,888][root][INFO] - Step: 210/960  |  Loss: 0.9657  |  Score: 75.43 [%]  |  Seq Length: 256.0
[2024-09-27 11:06:17,390][root][INFO] - Step: 105/1035  |  Loss: 1.2183  |  Score: 67.81 [%]  |  Seq Length: 256.0
[2024-09-27 11:06:21,440][root][INFO] - Step: 225/960  |  Loss: 0.8782  |  Score: 77.91 [%]  |  Seq Length: 256.0
[2024-09-27 11:06:23,102][root][INFO] - Step: 120/1035  |  Loss: 1.2757  |  Score: 63.54 [%]  |  Seq Length: 256.0
[2024-09-27 11:06:26,991][root][INFO] - Step: 240/960  |  Loss: 0.8963  |  Score: 76.09 [%]  |  Seq Length: 256.0
[2024-09-27 11:06:28,810][root][INFO] - Step: 135/1035  |  Loss: 1.2486  |  Score: 64.45 [%]  |  Seq Length: 256.0
[2024-09-27 11:06:29,976][root][INFO] - Step: 138/1035  |  Loss: 1.2848  |  Score: 64.53 [%]  |  Seq Length: 256.0
[2024-09-27 11:06:32,544][root][INFO] - Step: 255/960  |  Loss: 0.9422  |  Score: 73.50 [%]  |  Seq Length: 256.0
[2024-09-27 11:06:32,979][root][INFO] - Step: 256/960  |  Loss: 1.1633  |  Score: 53.52 [%]  |  Seq Length: 256.0
[2024-09-27 11:06:33,144][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-27 11:06:33,145][root][INFO] - Score: 76.09 [%]  |  Evaluation Time: 3.17 [s]
[2024-09-27 11:06:35,969][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-27 11:06:35,970][root][INFO] - Score: 77.35 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-27 11:06:36,213][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-27 11:06:36,213][root][INFO] - Score: 69.18 [%]  |  Evaluation Time: 3.07 [s]
[2024-09-27 11:06:36,215][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-27 11:06:36,218][root][INFO] - 
[3/ 15 Epoch]
[2024-09-27 11:06:39,059][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-27 11:06:39,060][root][INFO] - Score: 68.94 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-27 11:06:39,061][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-27 11:06:39,062][root][INFO] - 
[5/ 15 Epoch]
[2024-09-27 11:06:41,208][root][INFO] - Step: 150/1035  |  Loss: 1.0463  |  Score: 72.75 [%]  |  Seq Length: 256.0
[2024-09-27 11:06:44,770][root][INFO] - Step: 270/960  |  Loss: 0.7968  |  Score: 81.47 [%]  |  Seq Length: 256.0
[2024-09-27 11:06:46,934][root][INFO] - Step: 165/1035  |  Loss: 1.1681  |  Score: 70.64 [%]  |  Seq Length: 256.0
[2024-09-27 11:06:50,375][root][INFO] - Step: 285/960  |  Loss: 0.8378  |  Score: 76.31 [%]  |  Seq Length: 256.0
[2024-09-27 11:06:52,654][root][INFO] - Step: 180/1035  |  Loss: 1.0441  |  Score: 68.37 [%]  |  Seq Length: 256.0
[2024-09-27 11:06:55,975][root][INFO] - Step: 300/960  |  Loss: 0.8731  |  Score: 78.09 [%]  |  Seq Length: 256.0
[2024-09-27 11:06:58,369][root][INFO] - Step: 195/1035  |  Loss: 1.0577  |  Score: 70.41 [%]  |  Seq Length: 256.0
[2024-09-27 11:07:01,576][root][INFO] - Step: 315/960  |  Loss: 1.0040  |  Score: 79.58 [%]  |  Seq Length: 256.0
[2024-09-27 11:07:02,996][root][INFO] - Step: 207/1035  |  Loss: 1.1200  |  Score: 71.86 [%]  |  Seq Length: 256.0
[2024-09-27 11:07:03,502][root][INFO] - Step: 320/960  |  Loss: 0.8762  |  Score: 77.45 [%]  |  Seq Length: 256.0
[2024-09-27 11:07:06,226][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-27 11:07:06,226][root][INFO] - Score: 77.51 [%]  |  Evaluation Time: 3.23 [s]
[2024-09-27 11:07:06,406][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-27 11:07:06,406][root][INFO] - Score: 77.16 [%]  |  Evaluation Time: 2.90 [s]
[2024-09-27 11:07:09,335][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-27 11:07:09,335][root][INFO] - Score: 70.55 [%]  |  Evaluation Time: 2.93 [s]
[2024-09-27 11:07:09,336][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-27 11:07:09,337][root][INFO] - 
[6/ 15 Epoch]
[2024-09-27 11:07:09,339][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-27 11:07:09,339][root][INFO] - Score: 70.13 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-27 11:07:09,340][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-27 11:07:09,341][root][INFO] - 
[4/ 15 Epoch]
[2024-09-27 11:07:10,850][root][INFO] - Step: 210/1035  |  Loss: 0.8476  |  Score: 75.24 [%]  |  Seq Length: 256.0
[2024-09-27 11:07:13,388][root][INFO] - Step: 330/960  |  Loss: 0.7462  |  Score: 81.66 [%]  |  Seq Length: 256.0
[2024-09-27 11:07:16,566][root][INFO] - Step: 225/1035  |  Loss: 0.9947  |  Score: 74.86 [%]  |  Seq Length: 256.0
[2024-09-27 11:07:18,953][root][INFO] - Step: 345/960  |  Loss: 0.7406  |  Score: 79.53 [%]  |  Seq Length: 256.0
[2024-09-27 11:07:22,281][root][INFO] - Step: 240/1035  |  Loss: 0.8669  |  Score: 76.78 [%]  |  Seq Length: 256.0
[2024-09-27 11:07:24,519][root][INFO] - Step: 360/960  |  Loss: 0.7023  |  Score: 78.98 [%]  |  Seq Length: 256.0
[2024-09-27 11:07:27,998][root][INFO] - Step: 255/1035  |  Loss: 0.9594  |  Score: 74.95 [%]  |  Seq Length: 256.0
[2024-09-27 11:07:30,079][root][INFO] - Step: 375/960  |  Loss: 0.7590  |  Score: 80.63 [%]  |  Seq Length: 256.0
[2024-09-27 11:07:33,446][root][INFO] - Step: 384/960  |  Loss: 0.7776  |  Score: 80.19 [%]  |  Seq Length: 256.0
[2024-09-27 11:07:33,715][root][INFO] - Step: 270/1035  |  Loss: 0.9257  |  Score: 74.06 [%]  |  Seq Length: 256.0
[2024-09-27 11:07:36,023][root][INFO] - Step: 276/1035  |  Loss: 1.0693  |  Score: 72.85 [%]  |  Seq Length: 256.0
[2024-09-27 11:07:36,403][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-27 11:07:36,403][root][INFO] - Score: 77.49 [%]  |  Evaluation Time: 2.95 [s]
[2024-09-27 11:07:39,327][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-27 11:07:39,327][root][INFO] - Score: 70.68 [%]  |  Evaluation Time: 2.92 [s]
[2024-09-27 11:07:39,328][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-27 11:07:39,329][root][INFO] - 
[7/ 15 Epoch]
[2024-09-27 11:07:39,336][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-27 11:07:39,336][root][INFO] - Score: 76.90 [%]  |  Evaluation Time: 3.31 [s]
[2024-09-27 11:07:41,861][root][INFO] - Step: 390/960  |  Loss: 0.5550  |  Score: 84.71 [%]  |  Seq Length: 256.0
[2024-09-27 11:07:42,338][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-27 11:07:42,339][root][INFO] - Score: 68.94 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-27 11:07:42,341][root][INFO] - 
[5/ 15 Epoch]
[2024-09-27 11:07:46,206][root][INFO] - Step: 285/1035  |  Loss: 0.9574  |  Score: 75.16 [%]  |  Seq Length: 256.0
[2024-09-27 11:07:47,420][root][INFO] - Step: 405/960  |  Loss: 0.7023  |  Score: 82.94 [%]  |  Seq Length: 256.0
[2024-09-27 11:07:51,927][root][INFO] - Step: 300/1035  |  Loss: 0.8645  |  Score: 78.23 [%]  |  Seq Length: 256.0
[2024-09-27 11:07:52,978][root][INFO] - Step: 420/960  |  Loss: 0.6842  |  Score: 81.59 [%]  |  Seq Length: 256.0
[2024-09-27 11:07:57,648][root][INFO] - Step: 315/1035  |  Loss: 0.8177  |  Score: 75.94 [%]  |  Seq Length: 256.0
[2024-09-27 11:07:58,539][root][INFO] - Step: 435/960  |  Loss: 0.7019  |  Score: 82.17 [%]  |  Seq Length: 256.0
[2024-09-27 11:08:03,360][root][INFO] - Step: 330/1035  |  Loss: 0.7765  |  Score: 78.02 [%]  |  Seq Length: 256.0
[2024-09-27 11:08:03,415][root][INFO] - Step: 448/960  |  Loss: 0.6330  |  Score: 83.23 [%]  |  Seq Length: 256.0
[2024-09-27 11:08:06,307][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-27 11:08:06,307][root][INFO] - Score: 78.95 [%]  |  Evaluation Time: 2.89 [s]
[2024-09-27 11:08:09,125][root][INFO] - Step: 345/1035  |  Loss: 0.8569  |  Score: 77.47 [%]  |  Seq Length: 256.0
[2024-09-27 11:08:09,185][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-27 11:08:09,185][root][INFO] - Score: 70.85 [%]  |  Evaluation Time: 2.88 [s]
[2024-09-27 11:08:09,186][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-27 11:08:09,187][root][INFO] - 
[8/ 15 Epoch]
[2024-09-27 11:08:10,297][root][INFO] - Step: 450/960  |  Loss: 0.4652  |  Score: 88.14 [%]  |  Seq Length: 256.0
[2024-09-27 11:08:12,352][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-27 11:08:12,353][root][INFO] - Score: 77.19 [%]  |  Evaluation Time: 3.22 [s]
[2024-09-27 11:08:15,358][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-27 11:08:15,358][root][INFO] - Score: 70.53 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-27 11:08:15,359][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-27 11:08:15,360][root][INFO] - 
[6/ 15 Epoch]
[2024-09-27 11:08:15,851][root][INFO] - Step: 465/960  |  Loss: 0.5077  |  Score: 86.10 [%]  |  Seq Length: 256.0
[2024-09-27 11:08:16,073][root][INFO] - Step: 346/1035  |  Loss: 0.7530  |  Score: 80.48 [%]  |  Seq Length: 256.0
[2024-09-27 11:08:21,405][root][INFO] - Step: 480/960  |  Loss: 0.6222  |  Score: 83.01 [%]  |  Seq Length: 256.0
[2024-09-27 11:08:21,411][root][INFO] - Step: 360/1035  |  Loss: 0.7609  |  Score: 78.64 [%]  |  Seq Length: 256.0
[2024-09-27 11:08:26,960][root][INFO] - Step: 495/960  |  Loss: 0.5988  |  Score: 85.89 [%]  |  Seq Length: 256.0
[2024-09-27 11:08:27,126][root][INFO] - Step: 375/1035  |  Loss: 0.7605  |  Score: 81.38 [%]  |  Seq Length: 256.0
[2024-09-27 11:08:32,512][root][INFO] - Step: 510/960  |  Loss: 0.6461  |  Score: 83.56 [%]  |  Seq Length: 256.0
[2024-09-27 11:08:32,843][root][INFO] - Step: 390/1035  |  Loss: 0.7183  |  Score: 80.99 [%]  |  Seq Length: 256.0
[2024-09-27 11:08:33,281][root][INFO] - Step: 512/960  |  Loss: 0.6000  |  Score: 86.19 [%]  |  Seq Length: 256.0
[2024-09-27 11:08:36,307][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-27 11:08:36,308][root][INFO] - Score: 79.28 [%]  |  Evaluation Time: 3.02 [s]
[2024-09-27 11:08:38,565][root][INFO] - Step: 405/1035  |  Loss: 0.7631  |  Score: 79.07 [%]  |  Seq Length: 256.0
[2024-09-27 11:08:39,257][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-27 11:08:39,257][root][INFO] - Score: 70.78 [%]  |  Evaluation Time: 2.95 [s]
[2024-09-27 11:08:39,258][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-27 11:08:39,259][root][INFO] - 
[9/ 15 Epoch]
[2024-09-27 11:08:42,008][root][INFO] - Step: 414/1035  |  Loss: 0.7124  |  Score: 79.86 [%]  |  Seq Length: 256.0
[2024-09-27 11:08:44,509][root][INFO] - Step: 525/960  |  Loss: 0.5433  |  Score: 87.33 [%]  |  Seq Length: 256.0
[2024-09-27 11:08:45,128][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-27 11:08:45,128][root][INFO] - Score: 78.97 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-27 11:08:48,247][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-27 11:08:48,247][root][INFO] - Score: 72.05 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-27 11:08:48,247][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-27 11:08:48,249][root][INFO] - 
[7/ 15 Epoch]
[2024-09-27 11:08:50,068][root][INFO] - Step: 540/960  |  Loss: 0.5325  |  Score: 84.71 [%]  |  Seq Length: 256.0
[2024-09-27 11:08:50,890][root][INFO] - Step: 420/1035  |  Loss: 0.6374  |  Score: 79.03 [%]  |  Seq Length: 256.0
[2024-09-27 11:08:55,627][root][INFO] - Step: 555/960  |  Loss: 0.5012  |  Score: 86.14 [%]  |  Seq Length: 256.0
[2024-09-27 11:08:56,609][root][INFO] - Step: 435/1035  |  Loss: 0.6134  |  Score: 82.87 [%]  |  Seq Length: 256.0
[2024-09-27 11:09:01,182][root][INFO] - Step: 570/960  |  Loss: 0.4958  |  Score: 86.65 [%]  |  Seq Length: 256.0
[2024-09-27 11:09:02,322][root][INFO] - Step: 450/1035  |  Loss: 0.6293  |  Score: 84.10 [%]  |  Seq Length: 256.0
[2024-09-27 11:09:03,475][root][INFO] - Step: 576/960  |  Loss: 0.4573  |  Score: 86.14 [%]  |  Seq Length: 256.0
[2024-09-27 11:09:06,433][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-27 11:09:06,434][root][INFO] - Score: 78.26 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-27 11:09:08,034][root][INFO] - Step: 465/1035  |  Loss: 0.6435  |  Score: 81.77 [%]  |  Seq Length: 256.0
[2024-09-27 11:09:09,449][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-27 11:09:09,449][root][INFO] - Score: 71.01 [%]  |  Evaluation Time: 3.01 [s]
[2024-09-27 11:09:09,451][root][INFO] - 
[10/ 15 Epoch]
[2024-09-27 11:09:13,224][root][INFO] - Step: 585/960  |  Loss: 0.4486  |  Score: 86.67 [%]  |  Seq Length: 256.0
[2024-09-27 11:09:13,743][root][INFO] - Step: 480/1035  |  Loss: 0.6397  |  Score: 83.14 [%]  |  Seq Length: 256.0
[2024-09-27 11:09:14,913][root][INFO] - Step: 483/1035  |  Loss: 0.8125  |  Score: 77.05 [%]  |  Seq Length: 256.0
[2024-09-27 11:09:18,116][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-27 11:09:18,116][root][INFO] - Score: 78.28 [%]  |  Evaluation Time: 3.20 [s]
[2024-09-27 11:09:18,818][root][INFO] - Step: 600/960  |  Loss: 0.4853  |  Score: 87.64 [%]  |  Seq Length: 256.0
[2024-09-27 11:09:21,115][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-27 11:09:21,115][root][INFO] - Score: 72.04 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-27 11:09:21,117][root][INFO] - 
[8/ 15 Epoch]
[2024-09-27 11:09:24,382][root][INFO] - Step: 615/960  |  Loss: 0.4583  |  Score: 88.21 [%]  |  Seq Length: 256.0
[2024-09-27 11:09:26,118][root][INFO] - Step: 495/1035  |  Loss: 0.5787  |  Score: 84.73 [%]  |  Seq Length: 256.0
[2024-09-27 11:09:29,944][root][INFO] - Step: 630/960  |  Loss: 0.4499  |  Score: 88.17 [%]  |  Seq Length: 256.0
[2024-09-27 11:09:31,830][root][INFO] - Step: 510/1035  |  Loss: 0.5602  |  Score: 84.84 [%]  |  Seq Length: 256.0
[2024-09-27 11:09:33,671][root][INFO] - Step: 640/960  |  Loss: 0.4710  |  Score: 85.65 [%]  |  Seq Length: 256.0
[2024-09-27 11:09:36,580][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-27 11:09:36,580][root][INFO] - Score: 77.99 [%]  |  Evaluation Time: 2.91 [s]
[2024-09-27 11:09:37,544][root][INFO] - Step: 525/1035  |  Loss: 0.5436  |  Score: 84.72 [%]  |  Seq Length: 256.0
[2024-09-27 11:09:39,547][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-27 11:09:39,547][root][INFO] - Score: 70.88 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-27 11:09:39,549][root][INFO] - 
[11/ 15 Epoch]
[2024-09-27 11:09:41,806][root][INFO] - Step: 645/960  |  Loss: 0.4621  |  Score: 86.16 [%]  |  Seq Length: 256.0
[2024-09-27 11:09:43,260][root][INFO] - Step: 540/1035  |  Loss: 0.5468  |  Score: 84.62 [%]  |  Seq Length: 256.0
[2024-09-27 11:09:47,361][root][INFO] - Step: 660/960  |  Loss: 0.4684  |  Score: 87.99 [%]  |  Seq Length: 256.0
[2024-09-27 11:09:47,846][root][INFO] - Step: 552/1035  |  Loss: 0.5283  |  Score: 84.84 [%]  |  Seq Length: 256.0
[2024-09-27 11:09:51,014][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-27 11:09:51,015][root][INFO] - Score: 77.58 [%]  |  Evaluation Time: 3.17 [s]
[2024-09-27 11:09:52,920][root][INFO] - Step: 675/960  |  Loss: 0.4169  |  Score: 88.77 [%]  |  Seq Length: 256.0
[2024-09-27 11:09:54,064][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-27 11:09:54,064][root][INFO] - Score: 71.55 [%]  |  Evaluation Time: 3.05 [s]
[2024-09-27 11:09:54,066][root][INFO] - 
[9/ 15 Epoch]
[2024-09-27 11:09:55,741][root][INFO] - Step: 555/1035  |  Loss: 0.4679  |  Score: 87.70 [%]  |  Seq Length: 256.0
[2024-09-27 11:09:58,480][root][INFO] - Step: 690/960  |  Loss: 0.4631  |  Score: 87.85 [%]  |  Seq Length: 256.0
[2024-09-27 11:10:01,457][root][INFO] - Step: 570/1035  |  Loss: 0.5065  |  Score: 85.82 [%]  |  Seq Length: 256.0
[2024-09-27 11:10:03,722][root][INFO] - Step: 704/960  |  Loss: 0.4673  |  Score: 87.77 [%]  |  Seq Length: 256.0
[2024-09-27 11:10:06,642][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-27 11:10:06,642][root][INFO] - Score: 78.50 [%]  |  Evaluation Time: 2.92 [s]
[2024-09-27 11:10:07,172][root][INFO] - Step: 585/1035  |  Loss: 0.4963  |  Score: 86.73 [%]  |  Seq Length: 256.0
[2024-09-27 11:10:09,548][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-27 11:10:09,548][root][INFO] - Score: 71.53 [%]  |  Evaluation Time: 2.90 [s]
[2024-09-27 11:10:09,551][root][INFO] - 
[12/ 15 Epoch]
[2024-09-27 11:10:10,239][root][INFO] - Step: 705/960  |  Loss: 0.5027  |  Score: 88.62 [%]  |  Seq Length: 256.0
[2024-09-27 11:10:12,889][root][INFO] - Step: 600/1035  |  Loss: 0.5450  |  Score: 86.35 [%]  |  Seq Length: 256.0
[2024-09-27 11:10:15,800][root][INFO] - Step: 720/960  |  Loss: 0.4035  |  Score: 88.70 [%]  |  Seq Length: 256.0
[2024-09-27 11:10:18,602][root][INFO] - Step: 615/1035  |  Loss: 0.5220  |  Score: 86.24 [%]  |  Seq Length: 256.0
[2024-09-27 11:10:20,914][root][INFO] - Step: 621/1035  |  Loss: 0.5309  |  Score: 87.11 [%]  |  Seq Length: 256.0
[2024-09-27 11:10:21,366][root][INFO] - Step: 735/960  |  Loss: 0.3978  |  Score: 88.28 [%]  |  Seq Length: 256.0
[2024-09-27 11:10:24,060][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-27 11:10:24,061][root][INFO] - Score: 78.38 [%]  |  Evaluation Time: 3.14 [s]
[2024-09-27 11:10:26,931][root][INFO] - Step: 750/960  |  Loss: 0.3742  |  Score: 90.41 [%]  |  Seq Length: 256.0
[2024-09-27 11:10:27,093][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-27 11:10:27,093][root][INFO] - Score: 71.10 [%]  |  Evaluation Time: 3.03 [s]
[2024-09-27 11:10:27,095][root][INFO] - 
[10/ 15 Epoch]
[2024-09-27 11:10:30,851][root][INFO] - Step: 630/1035  |  Loss: 0.4222  |  Score: 89.07 [%]  |  Seq Length: 256.0
[2024-09-27 11:10:32,490][root][INFO] - Step: 765/960  |  Loss: 0.4278  |  Score: 88.25 [%]  |  Seq Length: 256.0
[2024-09-27 11:10:33,668][root][INFO] - Step: 768/960  |  Loss: 0.4508  |  Score: 88.79 [%]  |  Seq Length: 256.0
[2024-09-27 11:10:36,571][root][INFO] - Step: 645/1035  |  Loss: 0.4321  |  Score: 87.83 [%]  |  Seq Length: 256.0
[2024-09-27 11:10:36,665][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-27 11:10:36,665][root][INFO] - Score: 74.43 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-27 11:10:39,660][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-27 11:10:39,660][root][INFO] - Score: 69.83 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-27 11:10:39,663][root][INFO] - 
[13/ 15 Epoch]
[2024-09-27 11:10:42,288][root][INFO] - Step: 660/1035  |  Loss: 0.4775  |  Score: 87.45 [%]  |  Seq Length: 256.0
[2024-09-27 11:10:44,536][root][INFO] - Step: 780/960  |  Loss: 0.3580  |  Score: 90.71 [%]  |  Seq Length: 256.0
[2024-09-27 11:10:48,002][root][INFO] - Step: 675/1035  |  Loss: 0.4592  |  Score: 87.91 [%]  |  Seq Length: 256.0
[2024-09-27 11:10:50,146][root][INFO] - Step: 795/960  |  Loss: 0.4159  |  Score: 88.16 [%]  |  Seq Length: 256.0
[2024-09-27 11:10:53,756][root][INFO] - Step: 690/1035  |  Loss: 0.4644  |  Score: 86.65 [%]  |  Seq Length: 256.0
[2024-09-27 11:10:55,751][root][INFO] - Step: 810/960  |  Loss: 0.3771  |  Score: 90.35 [%]  |  Seq Length: 256.0
[2024-09-27 11:10:56,998][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-27 11:10:56,998][root][INFO] - Score: 78.05 [%]  |  Evaluation Time: 3.24 [s]
[2024-09-27 11:11:00,050][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-27 11:11:00,050][root][INFO] - Score: 72.21 [%]  |  Evaluation Time: 3.05 [s]
[2024-09-27 11:11:00,052][root][INFO] - 
[11/ 15 Epoch]
[2024-09-27 11:11:00,853][root][INFO] - Step: 691/1035  |  Loss: 0.3416  |  Score: 92.94 [%]  |  Seq Length: 256.0
[2024-09-27 11:11:01,349][root][INFO] - Step: 825/960  |  Loss: 0.3711  |  Score: 89.61 [%]  |  Seq Length: 256.0
[2024-09-27 11:11:03,998][root][INFO] - Step: 832/960  |  Loss: 0.4175  |  Score: 88.16 [%]  |  Seq Length: 256.0
[2024-09-27 11:11:06,199][root][INFO] - Step: 705/1035  |  Loss: 0.3962  |  Score: 89.44 [%]  |  Seq Length: 256.0
[2024-09-27 11:11:06,902][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-27 11:11:06,902][root][INFO] - Score: 78.21 [%]  |  Evaluation Time: 2.90 [s]
[2024-09-27 11:11:09,788][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-27 11:11:09,789][root][INFO] - Score: 69.54 [%]  |  Evaluation Time: 2.88 [s]
[2024-09-27 11:11:09,790][root][INFO] - 
[14/ 15 Epoch]
[2024-09-27 11:11:11,925][root][INFO] - Step: 720/1035  |  Loss: 0.4224  |  Score: 88.27 [%]  |  Seq Length: 256.0
[2024-09-27 11:11:13,086][root][INFO] - Step: 840/960  |  Loss: 0.3710  |  Score: 90.47 [%]  |  Seq Length: 256.0
[2024-09-27 11:11:17,647][root][INFO] - Step: 735/1035  |  Loss: 0.4311  |  Score: 88.49 [%]  |  Seq Length: 256.0
[2024-09-27 11:11:18,681][root][INFO] - Step: 855/960  |  Loss: 0.3972  |  Score: 87.69 [%]  |  Seq Length: 256.0
[2024-09-27 11:11:23,364][root][INFO] - Step: 750/1035  |  Loss: 0.3947  |  Score: 89.21 [%]  |  Seq Length: 256.0
[2024-09-27 11:11:24,279][root][INFO] - Step: 870/960  |  Loss: 0.3648  |  Score: 90.79 [%]  |  Seq Length: 256.0
[2024-09-27 11:11:26,845][root][INFO] - Step: 759/1035  |  Loss: 0.4391  |  Score: 87.63 [%]  |  Seq Length: 256.0
[2024-09-27 11:11:29,896][root][INFO] - Step: 885/960  |  Loss: 0.3914  |  Score: 88.99 [%]  |  Seq Length: 256.0
[2024-09-27 11:11:30,107][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-27 11:11:30,107][root][INFO] - Score: 77.52 [%]  |  Evaluation Time: 3.26 [s]
[2024-09-27 11:11:33,117][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-27 11:11:33,117][root][INFO] - Score: 71.30 [%]  |  Evaluation Time: 3.01 [s]
[2024-09-27 11:11:33,118][root][INFO] - 
[12/ 15 Epoch]
[2024-09-27 11:11:34,023][root][INFO] - Step: 896/960  |  Loss: 0.3517  |  Score: 89.51 [%]  |  Seq Length: 256.0
[2024-09-27 11:11:35,849][root][INFO] - Step: 765/1035  |  Loss: 0.3750  |  Score: 89.51 [%]  |  Seq Length: 256.0
[2024-09-27 11:11:36,915][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-27 11:11:36,915][root][INFO] - Score: 78.24 [%]  |  Evaluation Time: 2.89 [s]
[2024-09-27 11:11:39,794][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-27 11:11:39,795][root][INFO] - Score: 69.85 [%]  |  Evaluation Time: 2.88 [s]
[2024-09-27 11:11:39,797][root][INFO] - 
[15/ 15 Epoch]
[2024-09-27 11:11:41,566][root][INFO] - Step: 780/1035  |  Loss: 0.3780  |  Score: 89.68 [%]  |  Seq Length: 256.0
[2024-09-27 11:11:41,661][root][INFO] - Step: 900/960  |  Loss: 0.3529  |  Score: 89.32 [%]  |  Seq Length: 256.0
[2024-09-27 11:11:47,262][root][INFO] - Step: 915/960  |  Loss: 0.3568  |  Score: 91.13 [%]  |  Seq Length: 256.0
[2024-09-27 11:11:47,282][root][INFO] - Step: 795/1035  |  Loss: 0.3931  |  Score: 89.89 [%]  |  Seq Length: 256.0
[2024-09-27 11:11:52,856][root][INFO] - Step: 930/960  |  Loss: 0.3690  |  Score: 89.21 [%]  |  Seq Length: 256.0
[2024-09-27 11:11:52,994][root][INFO] - Step: 810/1035  |  Loss: 0.3790  |  Score: 89.76 [%]  |  Seq Length: 256.0
[2024-09-27 11:11:58,449][root][INFO] - Step: 945/960  |  Loss: 0.3651  |  Score: 90.63 [%]  |  Seq Length: 256.0
[2024-09-27 11:11:58,707][root][INFO] - Step: 825/1035  |  Loss: 0.4055  |  Score: 88.69 [%]  |  Seq Length: 256.0
[2024-09-27 11:11:59,915][root][INFO] - Step: 828/1035  |  Loss: 0.4206  |  Score: 86.47 [%]  |  Seq Length: 256.0
[2024-09-27 11:12:03,189][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-27 11:12:03,189][root][INFO] - Score: 77.49 [%]  |  Evaluation Time: 3.27 [s]
[2024-09-27 11:12:04,097][root][INFO] - Step: 960/960  |  Loss: 0.3543  |  Score: 90.07 [%]  |  Seq Length: 256.0
[2024-09-27 11:12:06,228][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-27 11:12:06,229][root][INFO] - Score: 71.14 [%]  |  Evaluation Time: 3.04 [s]
[2024-09-27 11:12:06,231][root][INFO] - 
[13/ 15 Epoch]
[2024-09-27 11:12:07,042][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-27 11:12:07,042][root][INFO] - Score: 78.73 [%]  |  Evaluation Time: 2.94 [s]
[2024-09-27 11:12:09,926][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-27 11:12:09,926][root][INFO] - Score: 70.38 [%]  |  Evaluation Time: 2.88 [s]
[2024-09-27 11:12:09,928][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-27 11:12:09,928][root][INFO] - - Epoch: 8
[2024-09-27 11:12:09,928][root][INFO] - - DEV score: 79.28 [%]
[2024-09-27 11:12:09,928][root][INFO] - - TEST score: 70.78 [%]
[2024-09-27 11:12:09,929][root][INFO] - Fine-tuning is done!
[2024-09-27 11:12:11,268][root][INFO] - Step: 840/1035  |  Loss: 0.3779  |  Score: 90.54 [%]  |  Seq Length: 256.0
[2024-09-27 11:12:15,806][root][INFO] - 

[2024-09-27 11:12:15,806][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-27 11:12:15,806][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs
[2024-09-27 11:12:15,806][root][INFO] - 

[2024-09-27 11:12:15,806][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_punc', 'do_hangeulize': False, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-27 11:12:16,997][root][INFO] - Step: 855/1035  |  Loss: 0.3406  |  Score: 89.99 [%]  |  Seq Length: 256.0
[2024-09-27 11:12:21,069][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-27 11:12:21,070][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-27 11:12:21,070][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-27 11:12:21,071][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-27 11:12:21,071][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-27 11:12:21,072][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-27 11:12:21,072][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-27 11:12:21,073][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-27 11:12:21,073][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-27 11:12:21,074][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-27 11:12:21,074][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-27 11:12:21,075][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-27 11:12:21,075][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-27 11:12:21,076][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-27 11:12:21,076][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-27 11:12:21,077][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-27 11:12:21,077][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-27 11:12:21,078][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-27 11:12:21,078][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-27 11:12:21,079][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-27 11:12:21,080][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-27 11:12:21,080][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-27 11:12:21,081][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-27 11:12:21,081][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-27 11:12:21,083][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-27 11:12:21,088][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-27 11:12:21,190][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-27 11:12:21,193][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-27 11:12:21,649][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-27 11:12:22,717][root][INFO] - Step: 870/1035  |  Loss: 0.3797  |  Score: 89.37 [%]  |  Seq Length: 256.0
[2024-09-27 11:12:28,246][root][INFO] - 

[2024-09-27 11:12:28,246][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-27 11:12:28,246][root][INFO] - Data Preprocessing
[2024-09-27 11:12:28,246][root][INFO] - ㄴ remain_lang                ko_punc
[2024-09-27 11:12:28,246][root][INFO] - ㄴ do_hangeulize              False
[2024-09-27 11:12:28,246][root][INFO] - ㄴ data_remove                True

[2024-09-27 11:12:28,246][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-27 11:12:28,254][root][INFO] - vocab size              : 51200
[2024-09-27 11:12:28,255][root][INFO] - device                  : gpu
[2024-09-27 11:12:28,255][root][INFO] - random seed             : 42
[2024-09-27 11:12:28,255][root][INFO] - train data size         : 4096
[2024-09-27 11:12:28,255][root][INFO] - max epochs              : 15
[2024-09-27 11:12:28,255][root][INFO] - total steps             : 960
[2024-09-27 11:12:28,255][root][INFO] - warmup steps            : 96
[2024-09-27 11:12:28,255][root][INFO] - batch size              : 64
[2024-09-27 11:12:28,255][root][INFO] - accumulation steps      : 1
[2024-09-27 11:12:28,255][root][INFO] - optimizer               : adamwscale
[2024-09-27 11:12:28,255][root][INFO] - lr_scheduler            : cosine
[2024-09-27 11:12:28,256][root][INFO] - learning rate           : 0.01
[2024-09-27 11:12:28,256][root][INFO] - max length              : 256

[2024-09-27 11:12:28,256][root][INFO] - LoRA Configuration
[2024-09-27 11:12:28,256][root][INFO] - ㄴ r                    : 32
[2024-09-27 11:12:28,256][root][INFO] - ㄴ alpha                : 128
[2024-09-27 11:12:28,256][root][INFO] - ㄴ dropout              : 0.03

[2024-09-27 11:12:28,256][root][INFO] - KOMBO Configuration
[2024-09-27 11:12:28,256][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-27 11:12:28,256][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-27 11:12:28,256][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-27 11:12:28,256][root][INFO] - ㄴ do_combination       : True
[2024-09-27 11:12:28,257][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-27 11:12:28,257][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-27 11:12:28,257][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-27 11:12:28,257][root][INFO] -   ㄴ add_lora           : True

[2024-09-27 11:12:28,257][root][INFO] - LoRA in KOMBO Configuration
[2024-09-27 11:12:28,257][root][INFO] - ㄴ r                : 32
[2024-09-27 11:12:28,257][root][INFO] - ㄴ alpha            : 128
[2024-09-27 11:12:28,257][root][INFO] - ㄴ dropout          : 0.03

[2024-09-27 11:12:28,257][root][INFO] - 

[2024-09-27 11:12:28,257][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs
[2024-09-27 11:12:28,258][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-27 11:12:28,258][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_punc/256t_64b_1s_0.01lr_42rs/tb
[2024-09-27 11:12:28,258][root][INFO] - * tb interval   : 15

[2024-09-27 11:12:28,258][root][INFO] - 

[2024-09-27 11:12:28,258][root][INFO] - Start the Training !
[2024-09-27 11:12:28,261][root][INFO] - 
[1/ 15 Epoch]
[2024-09-27 11:12:28,440][root][INFO] - Step: 885/1035  |  Loss: 0.3432  |  Score: 90.46 [%]  |  Seq Length: 256.0
[2024-09-27 11:12:33,031][root][INFO] - Step: 897/1035  |  Loss: 0.4061  |  Score: 87.86 [%]  |  Seq Length: 256.0
[2024-09-27 11:12:36,329][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-27 11:12:36,329][root][INFO] - Score: 77.84 [%]  |  Evaluation Time: 3.29 [s]
[2024-09-27 11:12:37,387][root][INFO] - Step: 15/960  |  Loss: 3.3199  |  Score: 2.31 [%]  |  Seq Length: 256.0
[2024-09-27 11:12:39,375][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-27 11:12:39,375][root][INFO] - Score: 71.40 [%]  |  Evaluation Time: 3.04 [s]
[2024-09-27 11:12:39,377][root][INFO] - 
[14/ 15 Epoch]
[2024-09-27 11:12:40,870][root][INFO] - Step: 900/1035  |  Loss: 0.3396  |  Score: 90.69 [%]  |  Seq Length: 256.0
[2024-09-27 11:12:45,099][root][INFO] - Step: 30/960  |  Loss: 2.4184  |  Score: 24.01 [%]  |  Seq Length: 256.0
[2024-09-27 11:12:46,636][root][INFO] - Step: 915/1035  |  Loss: 0.3681  |  Score: 90.18 [%]  |  Seq Length: 256.0
[2024-09-27 11:12:52,397][root][INFO] - Step: 930/1035  |  Loss: 0.3442  |  Score: 89.49 [%]  |  Seq Length: 256.0
[2024-09-27 11:12:52,786][root][INFO] - Step: 45/960  |  Loss: 1.8424  |  Score: 44.81 [%]  |  Seq Length: 256.0
[2024-09-27 11:12:58,162][root][INFO] - Step: 945/1035  |  Loss: 0.3388  |  Score: 90.07 [%]  |  Seq Length: 256.0
[2024-09-27 11:13:00,479][root][INFO] - Step: 60/960  |  Loss: 1.6183  |  Score: 56.87 [%]  |  Seq Length: 256.0
[2024-09-27 11:13:02,600][root][INFO] - Step: 64/960  |  Loss: 2.0318  |  Score: 59.70 [%]  |  Seq Length: 256.0
[2024-09-27 11:13:03,906][root][INFO] - Step: 960/1035  |  Loss: 0.3695  |  Score: 88.12 [%]  |  Seq Length: 256.0
[2024-09-27 11:13:06,256][root][INFO] - Step: 966/1035  |  Loss: 0.3629  |  Score: 88.93 [%]  |  Seq Length: 256.0
[2024-09-27 11:13:07,400][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-27 11:13:07,400][root][INFO] - Score: 67.32 [%]  |  Evaluation Time: 4.80 [s]
[2024-09-27 11:13:09,383][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-27 11:13:09,383][root][INFO] - Score: 76.86 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-27 11:13:11,788][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-27 11:13:11,788][root][INFO] - Score: 64.36 [%]  |  Evaluation Time: 4.39 [s]
[2024-09-27 11:13:11,789][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-27 11:13:11,790][root][INFO] - 
[2/ 15 Epoch]
[2024-09-27 11:13:12,402][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-27 11:13:12,403][root][INFO] - Score: 71.64 [%]  |  Evaluation Time: 3.02 [s]
[2024-09-27 11:13:12,405][root][INFO] - 
[15/ 15 Epoch]
[2024-09-27 11:13:16,399][root][INFO] - Step: 975/1035  |  Loss: 0.3594  |  Score: 88.70 [%]  |  Seq Length: 256.0
[2024-09-27 11:13:17,752][root][INFO] - Step: 75/960  |  Loss: 1.5482  |  Score: 62.21 [%]  |  Seq Length: 256.0
[2024-09-27 11:13:22,136][root][INFO] - Step: 990/1035  |  Loss: 0.3548  |  Score: 90.07 [%]  |  Seq Length: 256.0
[2024-09-27 11:13:25,385][root][INFO] - Step: 90/960  |  Loss: 1.5519  |  Score: 61.36 [%]  |  Seq Length: 256.0
[2024-09-27 11:13:27,851][root][INFO] - Step: 1005/1035  |  Loss: 0.3693  |  Score: 90.57 [%]  |  Seq Length: 256.0
[2024-09-27 11:13:33,083][root][INFO] - Step: 105/960  |  Loss: 1.3877  |  Score: 63.79 [%]  |  Seq Length: 256.0
[2024-09-27 11:13:33,572][root][INFO] - Step: 1020/1035  |  Loss: 0.3755  |  Score: 89.16 [%]  |  Seq Length: 256.0
[2024-09-27 11:13:39,314][root][INFO] - Step: 1035/1035  |  Loss: 0.3716  |  Score: 89.41 [%]  |  Seq Length: 256.0
[2024-09-27 11:13:40,802][root][INFO] - Step: 120/960  |  Loss: 1.2456  |  Score: 67.54 [%]  |  Seq Length: 256.0
[2024-09-27 11:13:42,476][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-27 11:13:42,476][root][INFO] - Score: 77.79 [%]  |  Evaluation Time: 3.16 [s]
[2024-09-27 11:13:44,985][root][INFO] - Step: 128/960  |  Loss: 1.2673  |  Score: 65.03 [%]  |  Seq Length: 256.0
[2024-09-27 11:13:45,622][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-27 11:13:45,622][root][INFO] - Score: 71.19 [%]  |  Evaluation Time: 3.14 [s]
[2024-09-27 11:13:45,623][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-27 11:13:45,623][root][INFO] - - Epoch: 6
[2024-09-27 11:13:45,623][root][INFO] - - DEV score: 78.97 [%]
[2024-09-27 11:13:45,623][root][INFO] - - TEST score: 72.05 [%]
[2024-09-27 11:13:45,624][root][INFO] - Fine-tuning is done!
[2024-09-27 11:13:49,721][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-27 11:13:49,721][root][INFO] - Score: 70.66 [%]  |  Evaluation Time: 4.73 [s]
[2024-09-27 11:13:51,586][root][INFO] - 

[2024-09-27 11:13:51,586][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-27 11:13:51,586][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-27 11:13:51,586][root][INFO] - 

[2024-09-27 11:13:51,586][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': False, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-27 11:13:54,154][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-27 11:13:54,154][root][INFO] - Score: 68.54 [%]  |  Evaluation Time: 4.43 [s]
[2024-09-27 11:13:54,155][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-27 11:13:54,157][root][INFO] - 
[3/ 15 Epoch]
[2024-09-27 11:13:56,308][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-27 11:13:56,308][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-27 11:13:56,309][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-27 11:13:56,309][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-27 11:13:56,310][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-27 11:13:56,310][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-27 11:13:56,311][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-27 11:13:56,311][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-27 11:13:56,312][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-27 11:13:56,312][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-27 11:13:56,313][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-27 11:13:56,313][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-27 11:13:56,314][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-27 11:13:56,315][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-27 11:13:56,315][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-27 11:13:56,316][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-27 11:13:56,316][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-27 11:13:56,317][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-27 11:13:56,317][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-27 11:13:56,318][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-27 11:13:56,319][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-27 11:13:56,319][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-27 11:13:56,320][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-27 11:13:56,320][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-27 11:13:56,322][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-27 11:13:56,326][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-27 11:13:56,432][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-27 11:13:56,435][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-27 11:13:56,744][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-27 11:13:58,212][root][INFO] - Step: 135/960  |  Loss: 1.0619  |  Score: 72.18 [%]  |  Seq Length: 256.0
[2024-09-27 11:14:03,382][root][INFO] - 

[2024-09-27 11:14:03,382][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-27 11:14:03,382][root][INFO] - Data Preprocessing
[2024-09-27 11:14:03,383][root][INFO] - ㄴ remain_lang                ko_en_punc
[2024-09-27 11:14:03,383][root][INFO] - ㄴ do_hangeulize              False
[2024-09-27 11:14:03,383][root][INFO] - ㄴ data_remove                True

[2024-09-27 11:14:03,383][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-27 11:14:03,396][root][INFO] - vocab size              : 51200
[2024-09-27 11:14:03,397][root][INFO] - device                  : gpu
[2024-09-27 11:14:03,397][root][INFO] - random seed             : 42
[2024-09-27 11:14:03,397][root][INFO] - train data size         : 4416
[2024-09-27 11:14:03,397][root][INFO] - max epochs              : 15
[2024-09-27 11:14:03,397][root][INFO] - total steps             : 1035
[2024-09-27 11:14:03,397][root][INFO] - warmup steps            : 104
[2024-09-27 11:14:03,397][root][INFO] - batch size              : 64
[2024-09-27 11:14:03,398][root][INFO] - accumulation steps      : 1
[2024-09-27 11:14:03,398][root][INFO] - optimizer               : adamwscale
[2024-09-27 11:14:03,398][root][INFO] - lr_scheduler            : cosine
[2024-09-27 11:14:03,398][root][INFO] - learning rate           : 0.01
[2024-09-27 11:14:03,398][root][INFO] - max length              : 256

[2024-09-27 11:14:03,398][root][INFO] - LoRA Configuration
[2024-09-27 11:14:03,398][root][INFO] - ㄴ r                    : 32
[2024-09-27 11:14:03,398][root][INFO] - ㄴ alpha                : 128
[2024-09-27 11:14:03,399][root][INFO] - ㄴ dropout              : 0.03

[2024-09-27 11:14:03,399][root][INFO] - KOMBO Configuration
[2024-09-27 11:14:03,399][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-27 11:14:03,399][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-27 11:14:03,399][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-27 11:14:03,399][root][INFO] - ㄴ do_combination       : True
[2024-09-27 11:14:03,399][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-27 11:14:03,400][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-27 11:14:03,400][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-27 11:14:03,400][root][INFO] -   ㄴ add_lora           : True

[2024-09-27 11:14:03,400][root][INFO] - LoRA in KOMBO Configuration
[2024-09-27 11:14:03,400][root][INFO] - ㄴ r                : 32
[2024-09-27 11:14:03,400][root][INFO] - ㄴ alpha            : 128
[2024-09-27 11:14:03,401][root][INFO] - ㄴ dropout          : 0.03

[2024-09-27 11:14:03,401][root][INFO] - 

[2024-09-27 11:14:03,401][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-27 11:14:03,401][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-27 11:14:03,401][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb
[2024-09-27 11:14:03,401][root][INFO] - * tb interval   : 15

[2024-09-27 11:14:03,401][root][INFO] - 

[2024-09-27 11:14:03,401][root][INFO] - Start the Training !
[2024-09-27 11:14:03,405][root][INFO] - 
[1/ 15 Epoch]
[2024-09-27 11:14:06,111][root][INFO] - Step: 150/960  |  Loss: 1.1190  |  Score: 69.37 [%]  |  Seq Length: 256.0
[2024-09-27 11:14:13,378][root][INFO] - Step: 15/1035  |  Loss: 3.3420  |  Score: 0.58 [%]  |  Seq Length: 256.0
[2024-09-27 11:14:13,895][root][INFO] - Step: 165/960  |  Loss: 1.0240  |  Score: 70.72 [%]  |  Seq Length: 256.0
[2024-09-27 11:14:21,349][root][INFO] - Step: 30/1035  |  Loss: 2.2042  |  Score: 22.40 [%]  |  Seq Length: 256.0
[2024-09-27 11:14:21,565][root][INFO] - Step: 180/960  |  Loss: 1.0063  |  Score: 72.89 [%]  |  Seq Length: 256.0
[2024-09-27 11:14:27,782][root][INFO] - Step: 192/960  |  Loss: 1.1227  |  Score: 74.39 [%]  |  Seq Length: 256.0
[2024-09-27 11:14:29,326][root][INFO] - Step: 45/1035  |  Loss: 1.8200  |  Score: 48.06 [%]  |  Seq Length: 256.0
[2024-09-27 11:14:32,438][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-27 11:14:32,438][root][INFO] - Score: 77.17 [%]  |  Evaluation Time: 4.65 [s]
[2024-09-27 11:14:36,984][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-27 11:14:36,985][root][INFO] - Score: 71.16 [%]  |  Evaluation Time: 4.54 [s]
[2024-09-27 11:14:36,986][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-27 11:14:36,987][root][INFO] - 
[4/ 15 Epoch]
[2024-09-27 11:14:37,416][root][INFO] - Step: 60/1035  |  Loss: 1.6524  |  Score: 59.78 [%]  |  Seq Length: 256.0
[2024-09-27 11:14:38,992][root][INFO] - Step: 195/960  |  Loss: 0.7937  |  Score: 80.88 [%]  |  Seq Length: 256.0
[2024-09-27 11:14:42,211][root][INFO] - Step: 69/1035  |  Loss: 1.6636  |  Score: 49.45 [%]  |  Seq Length: 256.0
[2024-09-27 11:14:46,714][root][INFO] - Step: 210/960  |  Loss: 1.0326  |  Score: 73.81 [%]  |  Seq Length: 256.0
[2024-09-27 11:14:47,254][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-27 11:14:47,254][root][INFO] - Score: 67.70 [%]  |  Evaluation Time: 5.04 [s]
[2024-09-27 11:14:52,105][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-27 11:14:52,105][root][INFO] - Score: 62.23 [%]  |  Evaluation Time: 4.85 [s]
[2024-09-27 11:14:52,106][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-27 11:14:52,107][root][INFO] - 
[2/ 15 Epoch]
[2024-09-27 11:14:54,397][root][INFO] - Step: 225/960  |  Loss: 1.0248  |  Score: 75.41 [%]  |  Seq Length: 256.0
[2024-09-27 11:14:55,669][root][INFO] - Step: 75/1035  |  Loss: 1.2297  |  Score: 70.06 [%]  |  Seq Length: 256.0
[2024-09-27 11:15:02,082][root][INFO] - Step: 240/960  |  Loss: 0.8830  |  Score: 75.49 [%]  |  Seq Length: 256.0
[2024-09-27 11:15:03,582][root][INFO] - Step: 90/1035  |  Loss: 1.3837  |  Score: 63.72 [%]  |  Seq Length: 256.0
[2024-09-27 11:15:09,887][root][INFO] - Step: 255/960  |  Loss: 0.8544  |  Score: 77.18 [%]  |  Seq Length: 256.0
[2024-09-27 11:15:10,494][root][INFO] - Step: 256/960  |  Loss: 1.4896  |  Score: 76.07 [%]  |  Seq Length: 256.0
[2024-09-27 11:15:11,568][root][INFO] - Step: 105/1035  |  Loss: 1.3218  |  Score: 61.37 [%]  |  Seq Length: 256.0
[2024-09-27 11:15:15,171][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-27 11:15:15,172][root][INFO] - Score: 76.98 [%]  |  Evaluation Time: 4.67 [s]
[2024-09-27 11:15:19,477][root][INFO] - Step: 120/1035  |  Loss: 1.4495  |  Score: 63.27 [%]  |  Seq Length: 256.0
[2024-09-27 11:15:19,767][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-27 11:15:19,767][root][INFO] - Score: 68.68 [%]  |  Evaluation Time: 4.59 [s]
[2024-09-27 11:15:19,770][root][INFO] - 
[5/ 15 Epoch]
[2024-09-27 11:15:27,353][root][INFO] - Step: 135/1035  |  Loss: 1.2932  |  Score: 64.69 [%]  |  Seq Length: 256.0
[2024-09-27 11:15:27,394][root][INFO] - Step: 270/960  |  Loss: 0.7720  |  Score: 79.04 [%]  |  Seq Length: 256.0
[2024-09-27 11:15:28,987][root][INFO] - Step: 138/1035  |  Loss: 1.1067  |  Score: 72.18 [%]  |  Seq Length: 256.0
[2024-09-27 11:15:34,151][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-27 11:15:34,151][root][INFO] - Score: 74.61 [%]  |  Evaluation Time: 5.16 [s]
[2024-09-27 11:15:35,105][root][INFO] - Step: 285/960  |  Loss: 0.8022  |  Score: 78.47 [%]  |  Seq Length: 256.0
[2024-09-27 11:15:38,842][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-27 11:15:38,842][root][INFO] - Score: 67.98 [%]  |  Evaluation Time: 4.69 [s]
[2024-09-27 11:15:38,844][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-27 11:15:38,845][root][INFO] - 
[3/ 15 Epoch]
[2024-09-27 11:15:42,806][root][INFO] - Step: 300/960  |  Loss: 0.7355  |  Score: 80.07 [%]  |  Seq Length: 256.0
[2024-09-27 11:15:45,691][root][INFO] - Step: 150/1035  |  Loss: 1.0911  |  Score: 71.24 [%]  |  Seq Length: 256.0
[2024-09-27 11:15:50,444][root][INFO] - Step: 315/960  |  Loss: 0.8581  |  Score: 77.88 [%]  |  Seq Length: 256.0
[2024-09-27 11:15:53,038][root][INFO] - Step: 320/960  |  Loss: 0.7488  |  Score: 82.65 [%]  |  Seq Length: 256.0
[2024-09-27 11:15:53,608][root][INFO] - Step: 165/1035  |  Loss: 1.0187  |  Score: 72.45 [%]  |  Seq Length: 256.0
[2024-09-27 11:15:57,743][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-27 11:15:57,743][root][INFO] - Score: 75.84 [%]  |  Evaluation Time: 4.70 [s]
[2024-09-27 11:16:01,560][root][INFO] - Step: 180/1035  |  Loss: 1.0311  |  Score: 70.62 [%]  |  Seq Length: 256.0
[2024-09-27 11:16:02,167][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-27 11:16:02,167][root][INFO] - Score: 72.33 [%]  |  Evaluation Time: 4.42 [s]
[2024-09-27 11:16:02,169][root][INFO] - 
[6/ 15 Epoch]
[2024-09-27 11:16:07,781][root][INFO] - Step: 330/960  |  Loss: 0.6370  |  Score: 80.59 [%]  |  Seq Length: 256.0
[2024-09-27 11:16:09,483][root][INFO] - Step: 195/1035  |  Loss: 1.0639  |  Score: 69.84 [%]  |  Seq Length: 256.0
[2024-09-27 11:16:15,630][root][INFO] - Step: 345/960  |  Loss: 0.8384  |  Score: 82.32 [%]  |  Seq Length: 256.0
[2024-09-27 11:16:15,857][root][INFO] - Step: 207/1035  |  Loss: 1.0973  |  Score: 69.66 [%]  |  Seq Length: 256.0
[2024-09-27 11:16:20,813][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-27 11:16:20,813][root][INFO] - Score: 76.56 [%]  |  Evaluation Time: 4.95 [s]
[2024-09-27 11:16:23,336][root][INFO] - Step: 360/960  |  Loss: 0.7506  |  Score: 81.71 [%]  |  Seq Length: 256.0
[2024-09-27 11:16:25,510][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-27 11:16:25,510][root][INFO] - Score: 70.16 [%]  |  Evaluation Time: 4.69 [s]
[2024-09-27 11:16:25,511][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-27 11:16:25,512][root][INFO] - 
[4/ 15 Epoch]
[2024-09-27 11:16:27,518][root][INFO] - Step: 210/1035  |  Loss: 0.8742  |  Score: 79.08 [%]  |  Seq Length: 256.0
[2024-09-27 11:16:31,072][root][INFO] - Step: 375/960  |  Loss: 0.6874  |  Score: 82.25 [%]  |  Seq Length: 256.0
[2024-09-27 11:16:35,461][root][INFO] - Step: 225/1035  |  Loss: 1.1426  |  Score: 72.07 [%]  |  Seq Length: 256.0
[2024-09-27 11:16:35,752][root][INFO] - Step: 384/960  |  Loss: 0.7305  |  Score: 82.35 [%]  |  Seq Length: 256.0
[2024-09-27 11:16:40,372][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-27 11:16:40,373][root][INFO] - Score: 76.78 [%]  |  Evaluation Time: 4.62 [s]
[2024-09-27 11:16:43,396][root][INFO] - Step: 240/1035  |  Loss: 0.8818  |  Score: 73.84 [%]  |  Seq Length: 256.0
[2024-09-27 11:16:44,733][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-27 11:16:44,733][root][INFO] - Score: 71.27 [%]  |  Evaluation Time: 4.36 [s]
[2024-09-27 11:16:44,735][root][INFO] - 
[7/ 15 Epoch]
[2024-09-27 11:16:48,207][root][INFO] - Step: 390/960  |  Loss: 0.5639  |  Score: 84.30 [%]  |  Seq Length: 256.0
[2024-09-27 11:16:51,346][root][INFO] - Step: 255/1035  |  Loss: 0.8978  |  Score: 76.94 [%]  |  Seq Length: 256.0
[2024-09-27 11:16:55,907][root][INFO] - Step: 405/960  |  Loss: 0.6278  |  Score: 83.87 [%]  |  Seq Length: 256.0
[2024-09-27 11:16:59,284][root][INFO] - Step: 270/1035  |  Loss: 1.0386  |  Score: 73.06 [%]  |  Seq Length: 256.0
[2024-09-27 11:17:02,439][root][INFO] - Step: 276/1035  |  Loss: 0.9797  |  Score: 77.22 [%]  |  Seq Length: 256.0
[2024-09-27 11:17:03,604][root][INFO] - Step: 420/960  |  Loss: 0.6702  |  Score: 83.10 [%]  |  Seq Length: 256.0
[2024-09-27 11:17:07,409][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-27 11:17:07,409][root][INFO] - Score: 76.92 [%]  |  Evaluation Time: 4.97 [s]
[2024-09-27 11:17:11,288][root][INFO] - Step: 435/960  |  Loss: 0.6039  |  Score: 83.50 [%]  |  Seq Length: 256.0
[2024-09-27 11:17:12,080][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-27 11:17:12,080][root][INFO] - Score: 68.64 [%]  |  Evaluation Time: 4.67 [s]
[2024-09-27 11:17:12,082][root][INFO] - 
[5/ 15 Epoch]
[2024-09-27 11:17:17,212][root][INFO] - Step: 285/1035  |  Loss: 0.9127  |  Score: 78.04 [%]  |  Seq Length: 256.0
[2024-09-27 11:17:17,992][root][INFO] - Step: 448/960  |  Loss: 0.6580  |  Score: 82.77 [%]  |  Seq Length: 256.0
[2024-09-27 11:17:22,575][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-27 11:17:22,576][root][INFO] - Score: 79.60 [%]  |  Evaluation Time: 4.58 [s]
[2024-09-27 11:17:25,106][root][INFO] - Step: 300/1035  |  Loss: 0.9200  |  Score: 77.53 [%]  |  Seq Length: 256.0
[2024-09-27 11:17:27,049][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-27 11:17:27,049][root][INFO] - Score: 72.39 [%]  |  Evaluation Time: 4.47 [s]
[2024-09-27 11:17:27,050][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-27 11:17:27,051][root][INFO] - 
[8/ 15 Epoch]
[2024-09-27 11:17:28,466][root][INFO] - Step: 450/960  |  Loss: 0.4527  |  Score: 84.81 [%]  |  Seq Length: 256.0
[2024-09-27 11:17:33,010][root][INFO] - Step: 315/1035  |  Loss: 1.0238  |  Score: 79.38 [%]  |  Seq Length: 256.0
[2024-09-27 11:17:36,154][root][INFO] - Step: 465/960  |  Loss: 0.5298  |  Score: 86.03 [%]  |  Seq Length: 256.0
[2024-09-27 11:17:41,003][root][INFO] - Step: 330/1035  |  Loss: 0.8113  |  Score: 76.54 [%]  |  Seq Length: 256.0
[2024-09-27 11:17:43,867][root][INFO] - Step: 480/960  |  Loss: 0.5000  |  Score: 86.99 [%]  |  Seq Length: 256.0
[2024-09-27 11:17:48,911][root][INFO] - Step: 345/1035  |  Loss: 0.8147  |  Score: 75.89 [%]  |  Seq Length: 256.0
[2024-09-27 11:17:51,588][root][INFO] - Step: 495/960  |  Loss: 0.5913  |  Score: 84.41 [%]  |  Seq Length: 256.0
[2024-09-27 11:17:53,907][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-27 11:17:53,907][root][INFO] - Score: 77.34 [%]  |  Evaluation Time: 4.99 [s]
[2024-09-27 11:17:58,545][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-27 11:17:58,545][root][INFO] - Score: 68.78 [%]  |  Evaluation Time: 4.64 [s]
[2024-09-27 11:17:58,547][root][INFO] - 
[6/ 15 Epoch]
[2024-09-27 11:17:59,282][root][INFO] - Step: 510/960  |  Loss: 0.6070  |  Score: 85.36 [%]  |  Seq Length: 256.0
[2024-09-27 11:17:59,554][root][INFO] - Step: 346/1035  |  Loss: 0.5953  |  Score: 85.35 [%]  |  Seq Length: 256.0
[2024-09-27 11:18:00,372][root][INFO] - Step: 512/960  |  Loss: 0.5199  |  Score: 85.42 [%]  |  Seq Length: 256.0
[2024-09-27 11:18:04,874][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-27 11:18:04,874][root][INFO] - Score: 78.29 [%]  |  Evaluation Time: 4.50 [s]
[2024-09-27 11:18:06,948][root][INFO] - Step: 360/1035  |  Loss: 0.6712  |  Score: 83.36 [%]  |  Seq Length: 256.0
[2024-09-27 11:18:09,542][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-27 11:18:09,542][root][INFO] - Score: 72.71 [%]  |  Evaluation Time: 4.67 [s]
[2024-09-27 11:18:09,544][root][INFO] - 
[9/ 15 Epoch]
[2024-09-27 11:18:14,898][root][INFO] - Step: 375/1035  |  Loss: 0.7050  |  Score: 82.36 [%]  |  Seq Length: 256.0
[2024-09-27 11:18:16,665][root][INFO] - Step: 525/960  |  Loss: 0.4798  |  Score: 87.71 [%]  |  Seq Length: 256.0
[2024-09-27 11:18:22,836][root][INFO] - Step: 390/1035  |  Loss: 0.7517  |  Score: 80.79 [%]  |  Seq Length: 256.0
[2024-09-27 11:18:24,363][root][INFO] - Step: 540/960  |  Loss: 0.4546  |  Score: 87.38 [%]  |  Seq Length: 256.0
[2024-09-27 11:18:30,765][root][INFO] - Step: 405/1035  |  Loss: 0.8289  |  Score: 75.82 [%]  |  Seq Length: 256.0
[2024-09-27 11:18:32,035][root][INFO] - Step: 555/960  |  Loss: 0.4853  |  Score: 86.36 [%]  |  Seq Length: 256.0
[2024-09-27 11:18:35,538][root][INFO] - Step: 414/1035  |  Loss: 0.7434  |  Score: 79.55 [%]  |  Seq Length: 256.0
[2024-09-27 11:18:39,737][root][INFO] - Step: 570/960  |  Loss: 0.4680  |  Score: 87.52 [%]  |  Seq Length: 256.0
[2024-09-27 11:18:40,471][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-27 11:18:40,471][root][INFO] - Score: 78.78 [%]  |  Evaluation Time: 4.93 [s]
[2024-09-27 11:18:42,824][root][INFO] - Step: 576/960  |  Loss: 0.4394  |  Score: 87.61 [%]  |  Seq Length: 256.0
[2024-09-27 11:18:45,183][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-27 11:18:45,183][root][INFO] - Score: 71.97 [%]  |  Evaluation Time: 4.71 [s]
[2024-09-27 11:18:45,184][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-27 11:18:45,186][root][INFO] - 
[7/ 15 Epoch]
[2024-09-27 11:18:47,347][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-27 11:18:47,347][root][INFO] - Score: 78.79 [%]  |  Evaluation Time: 4.52 [s]
[2024-09-27 11:18:48,801][root][INFO] - Step: 420/1035  |  Loss: 0.6372  |  Score: 81.54 [%]  |  Seq Length: 256.0
[2024-09-27 11:18:51,770][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-27 11:18:51,770][root][INFO] - Score: 71.20 [%]  |  Evaluation Time: 4.42 [s]
[2024-09-27 11:18:51,772][root][INFO] - 
[10/ 15 Epoch]
[2024-09-27 11:18:56,740][root][INFO] - Step: 435/1035  |  Loss: 0.5507  |  Score: 84.35 [%]  |  Seq Length: 256.0
[2024-09-27 11:18:56,792][root][INFO] - Step: 585/960  |  Loss: 0.4895  |  Score: 86.13 [%]  |  Seq Length: 256.0
[2024-09-27 11:19:04,568][root][INFO] - Step: 600/960  |  Loss: 0.4690  |  Score: 88.06 [%]  |  Seq Length: 256.0
[2024-09-27 11:19:04,681][root][INFO] - Step: 450/1035  |  Loss: 0.6168  |  Score: 83.64 [%]  |  Seq Length: 256.0
[2024-09-27 11:19:12,412][root][INFO] - Step: 615/960  |  Loss: 0.4802  |  Score: 87.75 [%]  |  Seq Length: 256.0
[2024-09-27 11:19:12,566][root][INFO] - Step: 465/1035  |  Loss: 0.6917  |  Score: 81.29 [%]  |  Seq Length: 256.0
[2024-09-27 11:19:20,264][root][INFO] - Step: 630/960  |  Loss: 0.4149  |  Score: 89.20 [%]  |  Seq Length: 256.0
[2024-09-27 11:19:20,442][root][INFO] - Step: 480/1035  |  Loss: 0.7119  |  Score: 79.90 [%]  |  Seq Length: 256.0
[2024-09-27 11:19:22,062][root][INFO] - Step: 483/1035  |  Loss: 0.5377  |  Score: 89.08 [%]  |  Seq Length: 256.0
[2024-09-27 11:19:25,553][root][INFO] - Step: 640/960  |  Loss: 0.4492  |  Score: 87.58 [%]  |  Seq Length: 256.0
[2024-09-27 11:19:27,189][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-27 11:19:27,189][root][INFO] - Score: 76.40 [%]  |  Evaluation Time: 5.12 [s]
[2024-09-27 11:19:30,101][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-27 11:19:30,101][root][INFO] - Score: 77.26 [%]  |  Evaluation Time: 4.55 [s]
[2024-09-27 11:19:32,052][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-27 11:19:32,052][root][INFO] - Score: 69.80 [%]  |  Evaluation Time: 4.86 [s]
[2024-09-27 11:19:32,054][root][INFO] - 
[8/ 15 Epoch]
[2024-09-27 11:19:34,665][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-27 11:19:34,666][root][INFO] - Score: 72.37 [%]  |  Evaluation Time: 4.56 [s]
[2024-09-27 11:19:34,668][root][INFO] - 
[11/ 15 Epoch]
[2024-09-27 11:19:37,719][root][INFO] - Step: 645/960  |  Loss: 0.4134  |  Score: 90.75 [%]  |  Seq Length: 256.0
[2024-09-27 11:19:38,831][root][INFO] - Step: 495/1035  |  Loss: 0.5565  |  Score: 84.04 [%]  |  Seq Length: 256.0
[2024-09-27 11:19:45,456][root][INFO] - Step: 660/960  |  Loss: 0.3945  |  Score: 89.87 [%]  |  Seq Length: 256.0
[2024-09-27 11:19:46,764][root][INFO] - Step: 510/1035  |  Loss: 0.6181  |  Score: 82.71 [%]  |  Seq Length: 256.0
[2024-09-27 11:19:53,154][root][INFO] - Step: 675/960  |  Loss: 0.4073  |  Score: 88.04 [%]  |  Seq Length: 256.0
[2024-09-27 11:19:54,690][root][INFO] - Step: 525/1035  |  Loss: 0.5654  |  Score: 84.51 [%]  |  Seq Length: 256.0
[2024-09-27 11:20:00,864][root][INFO] - Step: 690/960  |  Loss: 0.3989  |  Score: 90.08 [%]  |  Seq Length: 256.0
[2024-09-27 11:20:02,719][root][INFO] - Step: 540/1035  |  Loss: 0.5584  |  Score: 84.95 [%]  |  Seq Length: 256.0
[2024-09-27 11:20:08,042][root][INFO] - Step: 704/960  |  Loss: 0.4270  |  Score: 87.74 [%]  |  Seq Length: 256.0
[2024-09-27 11:20:09,015][root][INFO] - Step: 552/1035  |  Loss: 0.5757  |  Score: 83.30 [%]  |  Seq Length: 256.0
[2024-09-27 11:20:12,621][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-27 11:20:12,621][root][INFO] - Score: 76.13 [%]  |  Evaluation Time: 4.58 [s]
[2024-09-27 11:20:14,071][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-27 11:20:14,072][root][INFO] - Score: 77.92 [%]  |  Evaluation Time: 5.05 [s]
[2024-09-27 11:20:17,084][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-27 11:20:17,084][root][INFO] - Score: 71.61 [%]  |  Evaluation Time: 4.46 [s]
[2024-09-27 11:20:17,086][root][INFO] - 
[12/ 15 Epoch]
[2024-09-27 11:20:18,200][root][INFO] - Step: 705/960  |  Loss: 0.4418  |  Score: 91.00 [%]  |  Seq Length: 256.0
[2024-09-27 11:20:18,773][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-27 11:20:18,773][root][INFO] - Score: 69.88 [%]  |  Evaluation Time: 4.70 [s]
[2024-09-27 11:20:18,775][root][INFO] - 
[9/ 15 Epoch]
[2024-09-27 11:20:20,830][root][INFO] - Step: 555/1035  |  Loss: 0.5575  |  Score: 85.29 [%]  |  Seq Length: 256.0
[2024-09-27 11:20:25,955][root][INFO] - Step: 720/960  |  Loss: 0.3907  |  Score: 89.31 [%]  |  Seq Length: 256.0
[2024-09-27 11:20:28,717][root][INFO] - Step: 570/1035  |  Loss: 0.4579  |  Score: 87.85 [%]  |  Seq Length: 256.0
[2024-09-27 11:20:33,651][root][INFO] - Step: 735/960  |  Loss: 0.3892  |  Score: 89.35 [%]  |  Seq Length: 256.0
[2024-09-27 11:20:36,615][root][INFO] - Step: 585/1035  |  Loss: 0.4763  |  Score: 85.47 [%]  |  Seq Length: 256.0
[2024-09-27 11:20:41,306][root][INFO] - Step: 750/960  |  Loss: 0.3257  |  Score: 91.21 [%]  |  Seq Length: 256.0
[2024-09-27 11:20:44,561][root][INFO] - Step: 600/1035  |  Loss: 0.4836  |  Score: 87.26 [%]  |  Seq Length: 256.0
[2024-09-27 11:20:49,073][root][INFO] - Step: 765/960  |  Loss: 0.3830  |  Score: 89.50 [%]  |  Seq Length: 256.0
[2024-09-27 11:20:50,671][root][INFO] - Step: 768/960  |  Loss: 0.3799  |  Score: 89.90 [%]  |  Seq Length: 256.0
[2024-09-27 11:20:52,481][root][INFO] - Step: 615/1035  |  Loss: 0.5273  |  Score: 85.60 [%]  |  Seq Length: 256.0
[2024-09-27 11:20:55,350][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-27 11:20:55,350][root][INFO] - Score: 78.19 [%]  |  Evaluation Time: 4.68 [s]
[2024-09-27 11:20:55,690][root][INFO] - Step: 621/1035  |  Loss: 0.5377  |  Score: 86.64 [%]  |  Seq Length: 256.0
[2024-09-27 11:21:00,035][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-27 11:21:00,035][root][INFO] - Score: 73.00 [%]  |  Evaluation Time: 4.68 [s]
[2024-09-27 11:21:00,037][root][INFO] - 
[13/ 15 Epoch]
[2024-09-27 11:21:00,726][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-27 11:21:00,726][root][INFO] - Score: 76.95 [%]  |  Evaluation Time: 5.03 [s]
[2024-09-27 11:21:05,496][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-27 11:21:05,496][root][INFO] - Score: 70.71 [%]  |  Evaluation Time: 4.77 [s]
[2024-09-27 11:21:05,498][root][INFO] - 
[10/ 15 Epoch]
[2024-09-27 11:21:06,573][root][INFO] - Step: 780/960  |  Loss: 0.3826  |  Score: 89.54 [%]  |  Seq Length: 256.0
[2024-09-27 11:21:10,614][root][INFO] - Step: 630/1035  |  Loss: 0.4800  |  Score: 87.32 [%]  |  Seq Length: 256.0
[2024-09-27 11:21:14,284][root][INFO] - Step: 795/960  |  Loss: 0.3551  |  Score: 90.09 [%]  |  Seq Length: 256.0
[2024-09-27 11:21:18,628][root][INFO] - Step: 645/1035  |  Loss: 0.4649  |  Score: 87.72 [%]  |  Seq Length: 256.0
[2024-09-27 11:21:21,998][root][INFO] - Step: 810/960  |  Loss: 0.3335  |  Score: 91.02 [%]  |  Seq Length: 256.0
[2024-09-27 11:21:26,607][root][INFO] - Step: 660/1035  |  Loss: 0.4534  |  Score: 87.39 [%]  |  Seq Length: 256.0
[2024-09-27 11:21:29,723][root][INFO] - Step: 825/960  |  Loss: 0.3578  |  Score: 90.16 [%]  |  Seq Length: 256.0
[2024-09-27 11:21:33,373][root][INFO] - Step: 832/960  |  Loss: 0.3581  |  Score: 90.01 [%]  |  Seq Length: 256.0
[2024-09-27 11:21:34,649][root][INFO] - Step: 675/1035  |  Loss: 0.4502  |  Score: 87.38 [%]  |  Seq Length: 256.0
[2024-09-27 11:21:38,076][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-27 11:21:38,076][root][INFO] - Score: 76.07 [%]  |  Evaluation Time: 4.70 [s]
[2024-09-27 11:21:42,520][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-27 11:21:42,521][root][INFO] - Score: 71.98 [%]  |  Evaluation Time: 4.44 [s]
[2024-09-27 11:21:42,523][root][INFO] - 
[14/ 15 Epoch]
[2024-09-27 11:21:42,596][root][INFO] - Step: 690/1035  |  Loss: 0.4363  |  Score: 87.32 [%]  |  Seq Length: 256.0
[2024-09-27 11:21:46,920][root][INFO] - Step: 840/960  |  Loss: 0.3764  |  Score: 89.84 [%]  |  Seq Length: 256.0
[2024-09-27 11:21:47,610][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-27 11:21:47,610][root][INFO] - Score: 76.62 [%]  |  Evaluation Time: 5.01 [s]
[2024-09-27 11:21:52,538][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-27 11:21:52,538][root][INFO] - Score: 70.37 [%]  |  Evaluation Time: 4.92 [s]
[2024-09-27 11:21:52,541][root][INFO] - 
[11/ 15 Epoch]
[2024-09-27 11:21:53,454][root][INFO] - Step: 691/1035  |  Loss: 0.4744  |  Score: 89.08 [%]  |  Seq Length: 256.0
[2024-09-27 11:21:54,436][root][INFO] - Step: 855/960  |  Loss: 0.3477  |  Score: 90.91 [%]  |  Seq Length: 256.0
[2024-09-27 11:22:00,953][root][INFO] - Step: 705/1035  |  Loss: 0.4071  |  Score: 89.51 [%]  |  Seq Length: 256.0
[2024-09-27 11:22:01,972][root][INFO] - Step: 870/960  |  Loss: 0.3312  |  Score: 91.13 [%]  |  Seq Length: 256.0
[2024-09-27 11:22:08,941][root][INFO] - Step: 720/1035  |  Loss: 0.4241  |  Score: 88.47 [%]  |  Seq Length: 256.0
[2024-09-27 11:22:09,525][root][INFO] - Step: 885/960  |  Loss: 0.3447  |  Score: 90.03 [%]  |  Seq Length: 256.0
[2024-09-27 11:22:15,066][root][INFO] - Step: 896/960  |  Loss: 0.3556  |  Score: 89.83 [%]  |  Seq Length: 256.0
[2024-09-27 11:22:16,919][root][INFO] - Step: 735/1035  |  Loss: 0.3841  |  Score: 88.88 [%]  |  Seq Length: 256.0
[2024-09-27 11:22:19,756][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-27 11:22:19,756][root][INFO] - Score: 76.33 [%]  |  Evaluation Time: 4.69 [s]
[2024-09-27 11:22:24,218][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-27 11:22:24,219][root][INFO] - Score: 72.95 [%]  |  Evaluation Time: 4.46 [s]
[2024-09-27 11:22:24,221][root][INFO] - 
[15/ 15 Epoch]
[2024-09-27 11:22:24,874][root][INFO] - Step: 750/1035  |  Loss: 0.4468  |  Score: 87.86 [%]  |  Seq Length: 256.0
[2024-09-27 11:22:26,728][root][INFO] - Step: 900/960  |  Loss: 0.3115  |  Score: 91.94 [%]  |  Seq Length: 256.0
[2024-09-27 11:22:29,658][root][INFO] - Step: 759/1035  |  Loss: 0.4217  |  Score: 88.49 [%]  |  Seq Length: 256.0
[2024-09-27 11:22:34,622][root][INFO] - Step: 915/960  |  Loss: 0.3469  |  Score: 90.56 [%]  |  Seq Length: 256.0
[2024-09-27 11:22:34,727][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-27 11:22:34,727][root][INFO] - Score: 76.65 [%]  |  Evaluation Time: 5.07 [s]
[2024-09-27 11:22:39,452][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-27 11:22:39,452][root][INFO] - Score: 70.15 [%]  |  Evaluation Time: 4.72 [s]
[2024-09-27 11:22:39,455][root][INFO] - 
[12/ 15 Epoch]
[2024-09-27 11:22:42,425][root][INFO] - Step: 930/960  |  Loss: 0.3501  |  Score: 91.56 [%]  |  Seq Length: 256.0
[2024-09-27 11:22:43,178][root][INFO] - Step: 765/1035  |  Loss: 0.3851  |  Score: 90.33 [%]  |  Seq Length: 256.0
[2024-09-27 11:22:50,220][root][INFO] - Step: 945/960  |  Loss: 0.3278  |  Score: 90.67 [%]  |  Seq Length: 256.0
[2024-09-27 11:22:51,075][root][INFO] - Step: 780/1035  |  Loss: 0.3680  |  Score: 89.94 [%]  |  Seq Length: 256.0
[2024-09-27 11:22:57,968][root][INFO] - Step: 960/960  |  Loss: 0.3303  |  Score: 90.25 [%]  |  Seq Length: 256.0
[2024-09-27 11:22:58,970][root][INFO] - Step: 795/1035  |  Loss: 0.3809  |  Score: 89.33 [%]  |  Seq Length: 256.0
[2024-09-27 11:23:02,662][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-27 11:23:02,662][root][INFO] - Score: 77.68 [%]  |  Evaluation Time: 4.69 [s]
[2024-09-27 11:23:06,867][root][INFO] - Step: 810/1035  |  Loss: 0.3745  |  Score: 89.35 [%]  |  Seq Length: 256.0
[2024-09-27 11:23:07,142][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-27 11:23:07,142][root][INFO] - Score: 72.40 [%]  |  Evaluation Time: 4.48 [s]
[2024-09-27 11:23:07,143][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-27 11:23:07,143][root][INFO] - - Epoch: 7
[2024-09-27 11:23:07,143][root][INFO] - - DEV score: 79.60 [%]
[2024-09-27 11:23:07,143][root][INFO] - - TEST score: 72.39 [%]
[2024-09-27 11:23:07,144][root][INFO] - Fine-tuning is done!
[2024-09-27 11:23:14,733][root][INFO] - Step: 825/1035  |  Loss: 0.3748  |  Score: 89.48 [%]  |  Seq Length: 256.0
[2024-09-27 11:23:16,370][root][INFO] - Step: 828/1035  |  Loss: 0.3442  |  Score: 88.57 [%]  |  Seq Length: 256.0
[2024-09-27 11:23:21,397][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-27 11:23:21,397][root][INFO] - Score: 77.93 [%]  |  Evaluation Time: 5.02 [s]
[2024-09-27 11:23:26,091][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-27 11:23:26,091][root][INFO] - Score: 70.68 [%]  |  Evaluation Time: 4.69 [s]
[2024-09-27 11:23:26,093][root][INFO] - 
[13/ 15 Epoch]
[2024-09-27 11:23:33,013][root][INFO] - Step: 840/1035  |  Loss: 0.3531  |  Score: 90.36 [%]  |  Seq Length: 256.0
[2024-09-27 11:23:41,037][root][INFO] - Step: 855/1035  |  Loss: 0.3905  |  Score: 88.74 [%]  |  Seq Length: 256.0
[2024-09-27 11:23:49,021][root][INFO] - Step: 870/1035  |  Loss: 0.3979  |  Score: 88.73 [%]  |  Seq Length: 256.0
[2024-09-27 11:23:57,056][root][INFO] - Step: 885/1035  |  Loss: 0.3404  |  Score: 90.66 [%]  |  Seq Length: 256.0
[2024-09-27 11:24:03,481][root][INFO] - Step: 897/1035  |  Loss: 0.3731  |  Score: 89.54 [%]  |  Seq Length: 256.0
[2024-09-27 11:24:08,420][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-27 11:24:08,420][root][INFO] - Score: 75.89 [%]  |  Evaluation Time: 4.94 [s]
[2024-09-27 11:24:13,110][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-27 11:24:13,110][root][INFO] - Score: 70.39 [%]  |  Evaluation Time: 4.69 [s]
[2024-09-27 11:24:13,113][root][INFO] - 
[14/ 15 Epoch]
[2024-09-27 11:24:15,167][root][INFO] - Step: 900/1035  |  Loss: 0.3634  |  Score: 92.13 [%]  |  Seq Length: 256.0
[2024-09-27 11:24:23,057][root][INFO] - Step: 915/1035  |  Loss: 0.3640  |  Score: 90.27 [%]  |  Seq Length: 256.0
[2024-09-27 11:24:30,930][root][INFO] - Step: 930/1035  |  Loss: 0.3415  |  Score: 89.95 [%]  |  Seq Length: 256.0
[2024-09-27 11:24:38,858][root][INFO] - Step: 945/1035  |  Loss: 0.3553  |  Score: 89.24 [%]  |  Seq Length: 256.0
[2024-09-27 11:24:46,686][root][INFO] - Step: 960/1035  |  Loss: 0.3601  |  Score: 89.71 [%]  |  Seq Length: 256.0
[2024-09-27 11:24:49,841][root][INFO] - Step: 966/1035  |  Loss: 0.3731  |  Score: 89.39 [%]  |  Seq Length: 256.0
[2024-09-27 11:24:54,757][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-27 11:24:54,757][root][INFO] - Score: 76.90 [%]  |  Evaluation Time: 4.91 [s]
[2024-09-27 11:24:59,419][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-27 11:24:59,419][root][INFO] - Score: 70.08 [%]  |  Evaluation Time: 4.66 [s]
[2024-09-27 11:24:59,422][root][INFO] - 
[15/ 15 Epoch]
[2024-09-27 11:25:04,707][root][INFO] - Step: 975/1035  |  Loss: 0.3308  |  Score: 90.48 [%]  |  Seq Length: 256.0
[2024-09-27 11:25:12,583][root][INFO] - Step: 990/1035  |  Loss: 0.3549  |  Score: 90.62 [%]  |  Seq Length: 256.0
[2024-09-27 11:25:20,466][root][INFO] - Step: 1005/1035  |  Loss: 0.3671  |  Score: 90.02 [%]  |  Seq Length: 256.0
[2024-09-27 11:25:28,398][root][INFO] - Step: 1020/1035  |  Loss: 0.3263  |  Score: 90.30 [%]  |  Seq Length: 256.0
[2024-09-27 11:25:36,284][root][INFO] - Step: 1035/1035  |  Loss: 0.3787  |  Score: 89.39 [%]  |  Seq Length: 256.0
[2024-09-27 11:25:41,360][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-27 11:25:41,360][root][INFO] - Score: 77.15 [%]  |  Evaluation Time: 5.07 [s]
[2024-09-27 11:25:46,035][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-27 11:25:46,036][root][INFO] - Score: 71.05 [%]  |  Evaluation Time: 4.67 [s]
[2024-09-27 11:25:46,037][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-27 11:25:46,037][root][INFO] - - Epoch: 6
[2024-09-27 11:25:46,037][root][INFO] - - DEV score: 78.78 [%]
[2024-09-27 11:25:46,037][root][INFO] - - TEST score: 71.97 [%]
[2024-09-27 11:25:46,038][root][INFO] - Fine-tuning is done!
[2024-09-27 11:30:16,178][root][INFO] - 

[2024-09-27 11:30:16,178][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-27 11:30:16,178][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs
[2024-09-27 11:30:16,178][root][INFO] - 

[2024-09-27 11:30:16,179][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-27 11:30:20,801][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-27 11:30:20,802][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-27 11:30:20,802][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-27 11:30:20,802][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-27 11:30:20,803][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-27 11:30:20,803][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-27 11:30:20,804][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-27 11:30:20,804][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-27 11:30:20,805][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-27 11:30:20,805][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-27 11:30:20,806][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-27 11:30:20,806][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-27 11:30:20,807][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-27 11:30:20,807][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-27 11:30:20,807][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-27 11:30:20,808][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-27 11:30:20,808][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-27 11:30:20,809][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-27 11:30:20,809][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-27 11:30:20,810][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-27 11:30:20,810][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-27 11:30:20,811][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-27 11:30:20,811][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-27 11:30:20,812][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-27 11:30:20,813][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-27 11:30:21,067][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-27 11:30:25,453][root][INFO] - 

[2024-09-27 11:30:25,453][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-27 11:30:25,453][root][INFO] - Data Preprocessing
[2024-09-27 11:30:25,453][root][INFO] - ㄴ remain_lang                ko
[2024-09-27 11:30:25,454][root][INFO] - ㄴ do_hangeulize              True
[2024-09-27 11:30:25,454][root][INFO] - ㄴ data_remove                True

[2024-09-27 11:30:25,454][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-27 11:30:25,463][root][INFO] - vocab size              : 51200
[2024-09-27 11:30:25,463][root][INFO] - device                  : gpu
[2024-09-27 11:30:25,463][root][INFO] - random seed             : 42
[2024-09-27 11:30:25,463][root][INFO] - train data size         : 448
[2024-09-27 11:30:25,464][root][INFO] - max epochs              : 15
[2024-09-27 11:30:25,464][root][INFO] - total steps             : 105
[2024-09-27 11:30:25,464][root][INFO] - warmup steps            : 10
[2024-09-27 11:30:25,464][root][INFO] - batch size              : 64
[2024-09-27 11:30:25,464][root][INFO] - accumulation steps      : 1
[2024-09-27 11:30:25,464][root][INFO] - optimizer               : adamwscale
[2024-09-27 11:30:25,464][root][INFO] - lr_scheduler            : cosine
[2024-09-27 11:30:25,464][root][INFO] - learning rate           : 0.01
[2024-09-27 11:30:25,464][root][INFO] - max length              : 256

[2024-09-27 11:30:25,464][root][INFO] - LoRA Configuration
[2024-09-27 11:30:25,464][root][INFO] - ㄴ r                    : 32
[2024-09-27 11:30:25,465][root][INFO] - ㄴ alpha                : 128
[2024-09-27 11:30:25,465][root][INFO] - ㄴ dropout              : 0.03

[2024-09-27 11:30:25,465][root][INFO] - 

[2024-09-27 11:30:25,465][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs
[2024-09-27 11:30:25,465][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-27 11:30:25,465][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/tb
[2024-09-27 11:30:25,465][root][INFO] - * tb interval   : 15

[2024-09-27 11:30:25,465][root][INFO] - 

[2024-09-27 11:30:25,465][root][INFO] - Start the Training !
[2024-09-27 11:30:25,468][root][INFO] - 
[1/ 15 Epoch]
[2024-09-27 11:30:30,920][root][INFO] - Step: 7/105  |  Loss: 5.0380  |  Score: -2.00 [%]  |  Seq Length: 256.0
[2024-09-27 11:30:31,375][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-27 11:30:31,375][root][INFO] - Score: 1.79 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-27 11:30:31,786][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-27 11:30:31,787][root][INFO] - Score: -11.30 [%]  |  Evaluation Time: 0.41 [s]
[2024-09-27 11:30:31,789][root][INFO] - 
[2/ 15 Epoch]
[2024-09-27 11:30:34,798][root][INFO] - Step: 14/105  |  Loss: 2.7135  |  Score: 14.65 [%]  |  Seq Length: 256.0
[2024-09-27 11:30:35,272][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-27 11:30:35,272][root][INFO] - Score: 1.23 [%]  |  Evaluation Time: 0.47 [s]
[2024-09-27 11:30:35,712][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-27 11:30:35,713][root][INFO] - Score: 0.33 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 11:30:35,715][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-27 11:30:35,719][root][INFO] - 
[3/ 15 Epoch]
[2024-09-27 11:30:36,627][root][INFO] - Step: 15/105  |  Loss: 2.0411  |  Score: 39.92 [%]  |  Seq Length: 256.0
[2024-09-27 11:30:38,777][root][INFO] - Step: 21/105  |  Loss: 2.0538  |  Score: 38.92 [%]  |  Seq Length: 256.0
[2024-09-27 11:30:39,230][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-27 11:30:39,230][root][INFO] - Score: 14.33 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-27 11:30:39,670][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-27 11:30:39,670][root][INFO] - Score: 10.22 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 11:30:39,671][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-27 11:30:39,672][root][INFO] - 
[4/ 15 Epoch]
[2024-09-27 11:30:42,712][root][INFO] - Step: 28/105  |  Loss: 1.7221  |  Score: 54.14 [%]  |  Seq Length: 256.0
[2024-09-27 11:30:43,207][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-27 11:30:43,207][root][INFO] - Score: 25.17 [%]  |  Evaluation Time: 0.49 [s]
[2024-09-27 11:30:43,644][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-27 11:30:43,644][root][INFO] - Score: 19.68 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 11:30:43,645][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-27 11:30:43,646][root][INFO] - 
[5/ 15 Epoch]
[2024-09-27 11:30:44,896][root][INFO] - Step: 30/105  |  Loss: 1.5971  |  Score: 66.87 [%]  |  Seq Length: 256.0
[2024-09-27 11:30:46,624][root][INFO] - Step: 35/105  |  Loss: 1.4726  |  Score: 65.07 [%]  |  Seq Length: 256.0
[2024-09-27 11:30:47,084][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-27 11:30:47,084][root][INFO] - Score: 32.24 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-27 11:30:47,530][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-27 11:30:47,531][root][INFO] - Score: 29.48 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 11:30:47,532][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-27 11:30:47,533][root][INFO] - 
[6/ 15 Epoch]
[2024-09-27 11:30:50,454][root][INFO] - Step: 42/105  |  Loss: 1.2491  |  Score: 69.78 [%]  |  Seq Length: 256.0
[2024-09-27 11:30:50,914][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-27 11:30:50,914][root][INFO] - Score: 35.44 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-27 11:30:51,358][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-27 11:30:51,358][root][INFO] - Score: 34.18 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 11:30:51,359][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-27 11:30:51,361][root][INFO] - 
[7/ 15 Epoch]
[2024-09-27 11:30:52,818][root][INFO] - Step: 45/105  |  Loss: 0.9955  |  Score: 76.90 [%]  |  Seq Length: 256.0
[2024-09-27 11:30:54,156][root][INFO] - Step: 49/105  |  Loss: 1.0591  |  Score: 75.29 [%]  |  Seq Length: 256.0
[2024-09-27 11:30:54,625][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-27 11:30:54,625][root][INFO] - Score: 39.52 [%]  |  Evaluation Time: 0.47 [s]
[2024-09-27 11:30:55,031][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-27 11:30:55,031][root][INFO] - Score: 33.57 [%]  |  Evaluation Time: 0.40 [s]
[2024-09-27 11:30:55,032][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-27 11:30:55,033][root][INFO] - 
[8/ 15 Epoch]
[2024-09-27 11:30:58,035][root][INFO] - Step: 56/105  |  Loss: 0.8035  |  Score: 82.14 [%]  |  Seq Length: 256.0
[2024-09-27 11:30:58,494][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-27 11:30:58,495][root][INFO] - Score: 39.92 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-27 11:30:58,943][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-27 11:30:58,944][root][INFO] - Score: 33.84 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-27 11:30:58,944][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-27 11:30:58,946][root][INFO] - 
[9/ 15 Epoch]
[2024-09-27 11:31:00,906][root][INFO] - Step: 60/105  |  Loss: 0.6375  |  Score: 86.56 [%]  |  Seq Length: 256.0
[2024-09-27 11:31:01,917][root][INFO] - Step: 63/105  |  Loss: 0.6378  |  Score: 84.59 [%]  |  Seq Length: 256.0
[2024-09-27 11:31:02,382][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-27 11:31:02,382][root][INFO] - Score: 43.54 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-27 11:31:02,823][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-27 11:31:02,823][root][INFO] - Score: 33.70 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 11:31:02,824][root][INFO] - 
Save new Best Score (Epoch: 9)
[2024-09-27 11:31:02,825][root][INFO] - 
[10/ 15 Epoch]
[2024-09-27 11:31:05,757][root][INFO] - Step: 70/105  |  Loss: 0.6112  |  Score: 86.79 [%]  |  Seq Length: 256.0
[2024-09-27 11:31:06,221][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-27 11:31:06,221][root][INFO] - Score: 46.43 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-27 11:31:06,658][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-27 11:31:06,659][root][INFO] - Score: 32.56 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 11:31:06,660][root][INFO] - 
Save new Best Score (Epoch: 10)
[2024-09-27 11:31:06,663][root][INFO] - 
[11/ 15 Epoch]
[2024-09-27 11:31:08,940][root][INFO] - Step: 75/105  |  Loss: 0.5960  |  Score: 86.53 [%]  |  Seq Length: 256.0
[2024-09-27 11:31:09,555][root][INFO] - Step: 77/105  |  Loss: 0.5415  |  Score: 85.17 [%]  |  Seq Length: 256.0
[2024-09-27 11:31:10,022][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-27 11:31:10,022][root][INFO] - Score: 45.44 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-27 11:31:10,472][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-27 11:31:10,472][root][INFO] - Score: 31.51 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-27 11:31:10,474][root][INFO] - 
[12/ 15 Epoch]
[2024-09-27 11:31:13,285][root][INFO] - Step: 84/105  |  Loss: 0.5513  |  Score: 88.26 [%]  |  Seq Length: 256.0
[2024-09-27 11:31:13,748][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-27 11:31:13,748][root][INFO] - Score: 45.19 [%]  |  Evaluation Time: 0.46 [s]
[2024-09-27 11:31:14,182][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-27 11:31:14,182][root][INFO] - Score: 31.54 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 11:31:14,185][root][INFO] - 
[13/ 15 Epoch]
[2024-09-27 11:31:17,018][root][INFO] - Step: 90/105  |  Loss: 0.4917  |  Score: 87.57 [%]  |  Seq Length: 256.0
[2024-09-27 11:31:17,243][root][INFO] - Step: 91/105  |  Loss: 0.6568  |  Score: 81.63 [%]  |  Seq Length: 256.0
[2024-09-27 11:31:17,712][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-27 11:31:17,712][root][INFO] - Score: 45.72 [%]  |  Evaluation Time: 0.47 [s]
[2024-09-27 11:31:18,149][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-27 11:31:18,150][root][INFO] - Score: 32.26 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 11:31:18,154][root][INFO] - 
[14/ 15 Epoch]
[2024-09-27 11:31:21,060][root][INFO] - Step: 98/105  |  Loss: 0.5300  |  Score: 87.68 [%]  |  Seq Length: 256.0
[2024-09-27 11:31:21,515][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-27 11:31:21,516][root][INFO] - Score: 46.02 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-27 11:31:21,952][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-27 11:31:21,953][root][INFO] - Score: 32.28 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 11:31:21,957][root][INFO] - 
[15/ 15 Epoch]
[2024-09-27 11:31:24,791][root][INFO] - Step: 105/105  |  Loss: 0.5383  |  Score: 86.79 [%]  |  Seq Length: 256.0
[2024-09-27 11:31:25,245][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-27 11:31:25,245][root][INFO] - Score: 46.33 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-27 11:31:25,688][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-27 11:31:25,688][root][INFO] - Score: 32.26 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 11:31:25,689][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-27 11:31:25,690][root][INFO] - - Epoch: 10
[2024-09-27 11:31:25,690][root][INFO] - - DEV score: 46.43 [%]
[2024-09-27 11:31:25,690][root][INFO] - - TEST score: 32.56 [%]
[2024-09-27 11:31:25,691][root][INFO] - Fine-tuning is done!
[2024-09-27 11:31:31,511][root][INFO] - 

[2024-09-27 11:31:31,511][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-27 11:31:31,512][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs
[2024-09-27 11:31:31,512][root][INFO] - 

[2024-09-27 11:31:31,512][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-27 11:31:35,598][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-27 11:31:35,598][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-27 11:31:35,599][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-27 11:31:35,599][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-27 11:31:35,600][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-27 11:31:35,600][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-27 11:31:35,601][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-27 11:31:35,601][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-27 11:31:35,601][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-27 11:31:35,602][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-27 11:31:35,602][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-27 11:31:35,603][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-27 11:31:35,603][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-27 11:31:35,604][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-27 11:31:35,604][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-27 11:31:35,604][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-27 11:31:35,605][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-27 11:31:35,605][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-27 11:31:35,606][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-27 11:31:35,606][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-27 11:31:35,607][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-27 11:31:35,607][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-27 11:31:35,608][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-27 11:31:35,608][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-27 11:31:35,610][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-27 11:31:35,614][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-27 11:31:35,717][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-27 11:31:35,719][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-27 11:31:35,915][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-27 11:31:42,559][root][INFO] - 

[2024-09-27 11:31:42,559][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-27 11:31:42,559][root][INFO] - Data Preprocessing
[2024-09-27 11:31:42,559][root][INFO] - ㄴ remain_lang                ko
[2024-09-27 11:31:42,559][root][INFO] - ㄴ do_hangeulize              True
[2024-09-27 11:31:42,559][root][INFO] - ㄴ data_remove                True

[2024-09-27 11:31:42,559][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-27 11:31:42,567][root][INFO] - vocab size              : 51200
[2024-09-27 11:31:42,567][root][INFO] - device                  : gpu
[2024-09-27 11:31:42,567][root][INFO] - random seed             : 42
[2024-09-27 11:31:42,568][root][INFO] - train data size         : 448
[2024-09-27 11:31:42,568][root][INFO] - max epochs              : 15
[2024-09-27 11:31:42,568][root][INFO] - total steps             : 105
[2024-09-27 11:31:42,568][root][INFO] - warmup steps            : 10
[2024-09-27 11:31:42,568][root][INFO] - batch size              : 64
[2024-09-27 11:31:42,568][root][INFO] - accumulation steps      : 1
[2024-09-27 11:31:42,568][root][INFO] - optimizer               : adamwscale
[2024-09-27 11:31:42,568][root][INFO] - lr_scheduler            : cosine
[2024-09-27 11:31:42,568][root][INFO] - learning rate           : 0.01
[2024-09-27 11:31:42,568][root][INFO] - max length              : 256

[2024-09-27 11:31:42,568][root][INFO] - LoRA Configuration
[2024-09-27 11:31:42,569][root][INFO] - ㄴ r                    : 32
[2024-09-27 11:31:42,569][root][INFO] - ㄴ alpha                : 128
[2024-09-27 11:31:42,569][root][INFO] - ㄴ dropout              : 0.03

[2024-09-27 11:31:42,569][root][INFO] - KOMBO Configuration
[2024-09-27 11:31:42,569][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-27 11:31:42,569][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-27 11:31:42,569][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-27 11:31:42,569][root][INFO] - ㄴ do_combination       : True
[2024-09-27 11:31:42,569][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-27 11:31:42,569][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-27 11:31:42,570][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-27 11:31:42,570][root][INFO] -   ㄴ add_lora           : True

[2024-09-27 11:31:42,570][root][INFO] - LoRA in KOMBO Configuration
[2024-09-27 11:31:42,570][root][INFO] - ㄴ r                : 32
[2024-09-27 11:31:42,570][root][INFO] - ㄴ alpha            : 128
[2024-09-27 11:31:42,570][root][INFO] - ㄴ dropout          : 0.03

[2024-09-27 11:31:42,570][root][INFO] - 

[2024-09-27 11:31:42,570][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs
[2024-09-27 11:31:42,570][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-27 11:31:42,570][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/tb
[2024-09-27 11:31:42,570][root][INFO] - * tb interval   : 15

[2024-09-27 11:31:42,570][root][INFO] - 

[2024-09-27 11:31:42,571][root][INFO] - Start the Training !
[2024-09-27 11:31:42,573][root][INFO] - 
[1/ 15 Epoch]
[2024-09-27 11:31:47,118][root][INFO] - Step: 7/105  |  Loss: 4.8429  |  Score: 7.86 [%]  |  Seq Length: 256.0
[2024-09-27 11:31:47,713][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-27 11:31:47,713][root][INFO] - Score: 0.94 [%]  |  Evaluation Time: 0.59 [s]
[2024-09-27 11:31:48,225][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-27 11:31:48,225][root][INFO] - Score: -8.15 [%]  |  Evaluation Time: 0.51 [s]
[2024-09-27 11:31:48,227][root][INFO] - 
[2/ 15 Epoch]
[2024-09-27 11:31:51,862][root][INFO] - Step: 14/105  |  Loss: 2.7094  |  Score: 20.57 [%]  |  Seq Length: 256.0
[2024-09-27 11:31:52,393][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-27 11:31:52,393][root][INFO] - Score: 3.14 [%]  |  Evaluation Time: 0.53 [s]
[2024-09-27 11:31:52,915][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-27 11:31:52,916][root][INFO] - Score: 5.57 [%]  |  Evaluation Time: 0.52 [s]
[2024-09-27 11:31:52,917][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-27 11:31:52,918][root][INFO] - 
[3/ 15 Epoch]
[2024-09-27 11:31:53,950][root][INFO] - Step: 15/105  |  Loss: 2.5352  |  Score: 20.13 [%]  |  Seq Length: 256.0
[2024-09-27 11:31:56,767][root][INFO] - Step: 21/105  |  Loss: 2.5252  |  Score: 32.15 [%]  |  Seq Length: 256.0
[2024-09-27 11:31:57,386][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-27 11:31:57,386][root][INFO] - Score: 10.90 [%]  |  Evaluation Time: 0.62 [s]
[2024-09-27 11:31:57,927][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-27 11:31:57,927][root][INFO] - Score: 9.27 [%]  |  Evaluation Time: 0.54 [s]
[2024-09-27 11:31:57,928][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-27 11:31:57,929][root][INFO] - 
[4/ 15 Epoch]
[2024-09-27 11:32:01,653][root][INFO] - Step: 28/105  |  Loss: 1.8511  |  Score: 50.29 [%]  |  Seq Length: 256.0
[2024-09-27 11:32:02,182][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-27 11:32:02,182][root][INFO] - Score: 14.21 [%]  |  Evaluation Time: 0.53 [s]
[2024-09-27 11:32:02,703][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-27 11:32:02,703][root][INFO] - Score: 11.93 [%]  |  Evaluation Time: 0.52 [s]
[2024-09-27 11:32:02,704][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-27 11:32:02,705][root][INFO] - 
[5/ 15 Epoch]
[2024-09-27 11:32:04,096][root][INFO] - Step: 30/105  |  Loss: 1.4425  |  Score: 62.98 [%]  |  Seq Length: 256.0
[2024-09-27 11:32:06,390][root][INFO] - Step: 35/105  |  Loss: 1.3417  |  Score: 67.22 [%]  |  Seq Length: 256.0
[2024-09-27 11:32:06,953][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-27 11:32:06,953][root][INFO] - Score: 31.29 [%]  |  Evaluation Time: 0.56 [s]
[2024-09-27 11:32:07,493][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-27 11:32:07,493][root][INFO] - Score: 22.11 [%]  |  Evaluation Time: 0.54 [s]
[2024-09-27 11:32:07,494][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-27 11:32:07,496][root][INFO] - 
[6/ 15 Epoch]
[2024-09-27 11:32:11,138][root][INFO] - Step: 42/105  |  Loss: 1.2601  |  Score: 67.80 [%]  |  Seq Length: 256.0
[2024-09-27 11:32:11,685][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-27 11:32:11,685][root][INFO] - Score: 31.55 [%]  |  Evaluation Time: 0.54 [s]
[2024-09-27 11:32:12,175][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-27 11:32:12,175][root][INFO] - Score: 24.88 [%]  |  Evaluation Time: 0.49 [s]
[2024-09-27 11:32:12,176][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-27 11:32:12,177][root][INFO] - 
[7/ 15 Epoch]
[2024-09-27 11:32:14,209][root][INFO] - Step: 45/105  |  Loss: 1.3131  |  Score: 69.52 [%]  |  Seq Length: 256.0
[2024-09-27 11:32:15,919][root][INFO] - Step: 49/105  |  Loss: 0.8952  |  Score: 78.47 [%]  |  Seq Length: 256.0
[2024-09-27 11:32:16,491][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-27 11:32:16,491][root][INFO] - Score: 37.58 [%]  |  Evaluation Time: 0.57 [s]
[2024-09-27 11:32:17,034][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-27 11:32:17,034][root][INFO] - Score: 29.71 [%]  |  Evaluation Time: 0.54 [s]
[2024-09-27 11:32:17,035][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-27 11:32:17,036][root][INFO] - 
[8/ 15 Epoch]
[2024-09-27 11:32:20,682][root][INFO] - Step: 56/105  |  Loss: 0.9348  |  Score: 80.07 [%]  |  Seq Length: 256.0
[2024-09-27 11:32:21,250][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-27 11:32:21,250][root][INFO] - Score: 38.85 [%]  |  Evaluation Time: 0.57 [s]
[2024-09-27 11:32:21,746][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-27 11:32:21,746][root][INFO] - Score: 31.11 [%]  |  Evaluation Time: 0.49 [s]
[2024-09-27 11:32:21,747][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-27 11:32:21,748][root][INFO] - 
[9/ 15 Epoch]
[2024-09-27 11:32:24,109][root][INFO] - Step: 60/105  |  Loss: 0.7488  |  Score: 83.46 [%]  |  Seq Length: 256.0
[2024-09-27 11:32:25,362][root][INFO] - Step: 63/105  |  Loss: 0.8293  |  Score: 80.11 [%]  |  Seq Length: 256.0
[2024-09-27 11:32:25,910][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-27 11:32:25,911][root][INFO] - Score: 44.24 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-27 11:32:26,455][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-27 11:32:26,456][root][INFO] - Score: 33.67 [%]  |  Evaluation Time: 0.54 [s]
[2024-09-27 11:32:26,457][root][INFO] - 
Save new Best Score (Epoch: 9)
[2024-09-27 11:32:26,458][root][INFO] - 
[10/ 15 Epoch]
[2024-09-27 11:32:30,154][root][INFO] - Step: 70/105  |  Loss: 0.6146  |  Score: 85.74 [%]  |  Seq Length: 256.0
[2024-09-27 11:32:30,691][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-27 11:32:30,691][root][INFO] - Score: 47.82 [%]  |  Evaluation Time: 0.53 [s]
[2024-09-27 11:32:31,216][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-27 11:32:31,216][root][INFO] - Score: 36.23 [%]  |  Evaluation Time: 0.52 [s]
[2024-09-27 11:32:31,217][root][INFO] - 
Save new Best Score (Epoch: 10)
[2024-09-27 11:32:31,218][root][INFO] - 
[11/ 15 Epoch]
[2024-09-27 11:32:34,071][root][INFO] - Step: 75/105  |  Loss: 0.5851  |  Score: 87.18 [%]  |  Seq Length: 256.0
[2024-09-27 11:32:34,813][root][INFO] - Step: 77/105  |  Loss: 0.5856  |  Score: 82.48 [%]  |  Seq Length: 256.0
[2024-09-27 11:32:35,364][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-27 11:32:35,364][root][INFO] - Score: 46.96 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-27 11:32:35,915][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-27 11:32:35,915][root][INFO] - Score: 35.04 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-27 11:32:35,917][root][INFO] - 
[12/ 15 Epoch]
[2024-09-27 11:32:39,540][root][INFO] - Step: 84/105  |  Loss: 0.5838  |  Score: 85.44 [%]  |  Seq Length: 256.0
[2024-09-27 11:32:40,073][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-27 11:32:40,074][root][INFO] - Score: 47.74 [%]  |  Evaluation Time: 0.53 [s]
[2024-09-27 11:32:40,617][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-27 11:32:40,618][root][INFO] - Score: 35.85 [%]  |  Evaluation Time: 0.54 [s]
[2024-09-27 11:32:40,620][root][INFO] - 
[13/ 15 Epoch]
[2024-09-27 11:32:44,022][root][INFO] - Step: 90/105  |  Loss: 0.5329  |  Score: 87.65 [%]  |  Seq Length: 256.0
[2024-09-27 11:32:44,268][root][INFO] - Step: 91/105  |  Loss: 0.3680  |  Score: 89.75 [%]  |  Seq Length: 256.0
[2024-09-27 11:32:44,822][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-27 11:32:44,822][root][INFO] - Score: 48.16 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-27 11:32:45,353][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-27 11:32:45,354][root][INFO] - Score: 35.37 [%]  |  Evaluation Time: 0.53 [s]
[2024-09-27 11:32:45,355][root][INFO] - 
[14/ 15 Epoch]
[2024-09-27 11:32:49,136][root][INFO] - Step: 98/105  |  Loss: 0.5252  |  Score: 87.58 [%]  |  Seq Length: 256.0
[2024-09-27 11:32:49,699][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-27 11:32:49,700][root][INFO] - Score: 48.36 [%]  |  Evaluation Time: 0.56 [s]
[2024-09-27 11:32:50,238][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-27 11:32:50,238][root][INFO] - Score: 36.01 [%]  |  Evaluation Time: 0.54 [s]
[2024-09-27 11:32:50,239][root][INFO] - 
Save new Best Score (Epoch: 14)
[2024-09-27 11:32:50,241][root][INFO] - 
[15/ 15 Epoch]
[2024-09-27 11:32:54,031][root][INFO] - Step: 105/105  |  Loss: 0.4865  |  Score: 88.26 [%]  |  Seq Length: 256.0
[2024-09-27 11:32:54,614][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-27 11:32:54,615][root][INFO] - Score: 48.24 [%]  |  Evaluation Time: 0.58 [s]
[2024-09-27 11:32:55,098][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-27 11:32:55,098][root][INFO] - Score: 35.65 [%]  |  Evaluation Time: 0.48 [s]
[2024-09-27 11:32:55,099][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-27 11:32:55,099][root][INFO] - - Epoch: 14
[2024-09-27 11:32:55,099][root][INFO] - - DEV score: 48.36 [%]
[2024-09-27 11:32:55,099][root][INFO] - - TEST score: 36.01 [%]
[2024-09-27 11:32:55,100][root][INFO] - Fine-tuning is done!
[2024-09-27 11:33:00,990][root][INFO] - 

[2024-09-27 11:33:00,990][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-27 11:33:00,990][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs
[2024-09-27 11:33:00,990][root][INFO] - 

[2024-09-27 11:33:00,990][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko', 'do_hangeulize': False, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-27 11:33:04,683][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-27 11:33:04,683][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-27 11:33:04,684][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-27 11:33:04,684][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-27 11:33:04,685][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-27 11:33:04,685][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-27 11:33:04,686][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-27 11:33:04,686][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-27 11:33:04,687][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-27 11:33:04,687][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-27 11:33:04,688][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-27 11:33:04,688][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-27 11:33:04,689][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-27 11:33:04,689][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-27 11:33:04,689][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-27 11:33:04,690][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-27 11:33:04,690][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-27 11:33:04,691][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-27 11:33:04,691][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-27 11:33:04,692][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-27 11:33:04,693][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-27 11:33:04,693][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-27 11:33:04,694][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-27 11:33:04,694][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-27 11:33:04,696][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-27 11:33:04,956][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-27 11:33:09,267][root][INFO] - 

[2024-09-27 11:33:09,267][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-27 11:33:09,267][root][INFO] - Data Preprocessing
[2024-09-27 11:33:09,267][root][INFO] - ㄴ remain_lang                ko
[2024-09-27 11:33:09,268][root][INFO] - ㄴ do_hangeulize              False
[2024-09-27 11:33:09,268][root][INFO] - ㄴ data_remove                True

[2024-09-27 11:33:09,268][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-27 11:33:09,276][root][INFO] - vocab size              : 51200
[2024-09-27 11:33:09,277][root][INFO] - device                  : gpu
[2024-09-27 11:33:09,277][root][INFO] - random seed             : 42
[2024-09-27 11:33:09,277][root][INFO] - train data size         : 448
[2024-09-27 11:33:09,277][root][INFO] - max epochs              : 15
[2024-09-27 11:33:09,277][root][INFO] - total steps             : 105
[2024-09-27 11:33:09,277][root][INFO] - warmup steps            : 10
[2024-09-27 11:33:09,277][root][INFO] - batch size              : 64
[2024-09-27 11:33:09,277][root][INFO] - accumulation steps      : 1
[2024-09-27 11:33:09,277][root][INFO] - optimizer               : adamwscale
[2024-09-27 11:33:09,277][root][INFO] - lr_scheduler            : cosine
[2024-09-27 11:33:09,277][root][INFO] - learning rate           : 0.01
[2024-09-27 11:33:09,277][root][INFO] - max length              : 256

[2024-09-27 11:33:09,278][root][INFO] - LoRA Configuration
[2024-09-27 11:33:09,278][root][INFO] - ㄴ r                    : 32
[2024-09-27 11:33:09,278][root][INFO] - ㄴ alpha                : 128
[2024-09-27 11:33:09,278][root][INFO] - ㄴ dropout              : 0.03

[2024-09-27 11:33:09,278][root][INFO] - 

[2024-09-27 11:33:09,278][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs
[2024-09-27 11:33:09,278][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-27 11:33:09,278][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/tb
[2024-09-27 11:33:09,278][root][INFO] - * tb interval   : 15

[2024-09-27 11:33:09,278][root][INFO] - 

[2024-09-27 11:33:09,278][root][INFO] - Start the Training !
[2024-09-27 11:33:09,281][root][INFO] - 
[1/ 15 Epoch]
[2024-09-27 11:33:14,738][root][INFO] - Step: 7/105  |  Loss: 5.0380  |  Score: -2.00 [%]  |  Seq Length: 256.0
[2024-09-27 11:33:15,179][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-27 11:33:15,180][root][INFO] - Score: 1.79 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 11:33:15,603][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-27 11:33:15,603][root][INFO] - Score: -11.30 [%]  |  Evaluation Time: 0.42 [s]
[2024-09-27 11:33:15,606][root][INFO] - 
[2/ 15 Epoch]
[2024-09-27 11:33:18,451][root][INFO] - Step: 14/105  |  Loss: 2.7135  |  Score: 14.65 [%]  |  Seq Length: 256.0
[2024-09-27 11:33:18,875][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-27 11:33:18,876][root][INFO] - Score: 1.23 [%]  |  Evaluation Time: 0.42 [s]
[2024-09-27 11:33:19,303][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-27 11:33:19,303][root][INFO] - Score: 0.33 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 11:33:19,305][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-27 11:33:19,308][root][INFO] - 
[3/ 15 Epoch]
[2024-09-27 11:33:20,058][root][INFO] - Step: 15/105  |  Loss: 2.0411  |  Score: 39.92 [%]  |  Seq Length: 256.0
[2024-09-27 11:33:22,188][root][INFO] - Step: 21/105  |  Loss: 2.0538  |  Score: 38.92 [%]  |  Seq Length: 256.0
[2024-09-27 11:33:22,641][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-27 11:33:22,641][root][INFO] - Score: 14.33 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-27 11:33:23,082][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-27 11:33:23,082][root][INFO] - Score: 10.22 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 11:33:23,083][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-27 11:33:23,084][root][INFO] - 
[4/ 15 Epoch]
[2024-09-27 11:33:26,062][root][INFO] - Step: 28/105  |  Loss: 1.7221  |  Score: 54.14 [%]  |  Seq Length: 256.0
[2024-09-27 11:33:26,516][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-27 11:33:26,516][root][INFO] - Score: 25.17 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-27 11:33:26,932][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-27 11:33:26,933][root][INFO] - Score: 19.68 [%]  |  Evaluation Time: 0.41 [s]
[2024-09-27 11:33:26,933][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-27 11:33:26,935][root][INFO] - 
[5/ 15 Epoch]
[2024-09-27 11:33:28,025][root][INFO] - Step: 30/105  |  Loss: 1.5971  |  Score: 66.87 [%]  |  Seq Length: 256.0
[2024-09-27 11:33:29,746][root][INFO] - Step: 35/105  |  Loss: 1.4726  |  Score: 65.07 [%]  |  Seq Length: 256.0
[2024-09-27 11:33:30,190][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-27 11:33:30,190][root][INFO] - Score: 32.24 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 11:33:30,620][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-27 11:33:30,621][root][INFO] - Score: 29.48 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 11:33:30,622][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-27 11:33:30,623][root][INFO] - 
[6/ 15 Epoch]
[2024-09-27 11:33:33,456][root][INFO] - Step: 42/105  |  Loss: 1.2491  |  Score: 69.78 [%]  |  Seq Length: 256.0
[2024-09-27 11:33:33,904][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-27 11:33:33,904][root][INFO] - Score: 35.44 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-27 11:33:34,330][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-27 11:33:34,331][root][INFO] - Score: 34.18 [%]  |  Evaluation Time: 0.42 [s]
[2024-09-27 11:33:34,332][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-27 11:33:34,335][root][INFO] - 
[7/ 15 Epoch]
[2024-09-27 11:33:35,875][root][INFO] - Step: 45/105  |  Loss: 0.9955  |  Score: 76.90 [%]  |  Seq Length: 256.0
[2024-09-27 11:33:37,221][root][INFO] - Step: 49/105  |  Loss: 1.0591  |  Score: 75.29 [%]  |  Seq Length: 256.0
[2024-09-27 11:33:37,635][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-27 11:33:37,635][root][INFO] - Score: 39.52 [%]  |  Evaluation Time: 0.41 [s]
[2024-09-27 11:33:38,063][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-27 11:33:38,063][root][INFO] - Score: 33.57 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 11:33:38,065][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-27 11:33:38,068][root][INFO] - 
[8/ 15 Epoch]
[2024-09-27 11:33:40,917][root][INFO] - Step: 56/105  |  Loss: 0.8035  |  Score: 82.14 [%]  |  Seq Length: 256.0
[2024-09-27 11:33:41,373][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-27 11:33:41,373][root][INFO] - Score: 39.92 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-27 11:33:41,770][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-27 11:33:41,770][root][INFO] - Score: 33.84 [%]  |  Evaluation Time: 0.39 [s]
[2024-09-27 11:33:41,771][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-27 11:33:41,772][root][INFO] - 
[9/ 15 Epoch]
[2024-09-27 11:33:43,791][root][INFO] - Step: 60/105  |  Loss: 0.6375  |  Score: 86.56 [%]  |  Seq Length: 256.0
[2024-09-27 11:33:44,772][root][INFO] - Step: 63/105  |  Loss: 0.6378  |  Score: 84.59 [%]  |  Seq Length: 256.0
[2024-09-27 11:33:45,212][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-27 11:33:45,212][root][INFO] - Score: 43.54 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 11:33:45,650][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-27 11:33:45,650][root][INFO] - Score: 33.70 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 11:33:45,651][root][INFO] - 
Save new Best Score (Epoch: 9)
[2024-09-27 11:33:45,652][root][INFO] - 
[10/ 15 Epoch]
[2024-09-27 11:33:48,689][root][INFO] - Step: 70/105  |  Loss: 0.6112  |  Score: 86.79 [%]  |  Seq Length: 256.0
[2024-09-27 11:33:49,105][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-27 11:33:49,105][root][INFO] - Score: 46.43 [%]  |  Evaluation Time: 0.41 [s]
[2024-09-27 11:33:49,534][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-27 11:33:49,535][root][INFO] - Score: 32.56 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 11:33:49,536][root][INFO] - 
Save new Best Score (Epoch: 10)
[2024-09-27 11:33:49,537][root][INFO] - 
[11/ 15 Epoch]
[2024-09-27 11:33:51,745][root][INFO] - Step: 75/105  |  Loss: 0.5960  |  Score: 86.53 [%]  |  Seq Length: 256.0
[2024-09-27 11:33:52,339][root][INFO] - Step: 77/105  |  Loss: 0.5415  |  Score: 85.17 [%]  |  Seq Length: 256.0
[2024-09-27 11:33:52,788][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-27 11:33:52,788][root][INFO] - Score: 45.44 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-27 11:33:53,189][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-27 11:33:53,189][root][INFO] - Score: 31.51 [%]  |  Evaluation Time: 0.40 [s]
[2024-09-27 11:33:53,192][root][INFO] - 
[12/ 15 Epoch]
[2024-09-27 11:33:56,062][root][INFO] - Step: 84/105  |  Loss: 0.5513  |  Score: 88.26 [%]  |  Seq Length: 256.0
[2024-09-27 11:33:56,517][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-27 11:33:56,517][root][INFO] - Score: 45.19 [%]  |  Evaluation Time: 0.45 [s]
[2024-09-27 11:33:56,947][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-27 11:33:56,947][root][INFO] - Score: 31.54 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 11:33:56,949][root][INFO] - 
[13/ 15 Epoch]
[2024-09-27 11:33:59,635][root][INFO] - Step: 90/105  |  Loss: 0.4917  |  Score: 87.57 [%]  |  Seq Length: 256.0
[2024-09-27 11:33:59,827][root][INFO] - Step: 91/105  |  Loss: 0.6568  |  Score: 81.63 [%]  |  Seq Length: 256.0
[2024-09-27 11:34:00,260][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-27 11:34:00,260][root][INFO] - Score: 45.72 [%]  |  Evaluation Time: 0.43 [s]
[2024-09-27 11:34:00,700][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-27 11:34:00,700][root][INFO] - Score: 32.26 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 11:34:00,702][root][INFO] - 
[14/ 15 Epoch]
[2024-09-27 11:34:03,545][root][INFO] - Step: 98/105  |  Loss: 0.5300  |  Score: 87.68 [%]  |  Seq Length: 256.0
[2024-09-27 11:34:03,991][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-27 11:34:03,991][root][INFO] - Score: 46.02 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 11:34:04,437][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-27 11:34:04,437][root][INFO] - Score: 32.28 [%]  |  Evaluation Time: 0.44 [s]
[2024-09-27 11:34:04,441][root][INFO] - 
[15/ 15 Epoch]
[2024-09-27 11:34:07,389][root][INFO] - Step: 105/105  |  Loss: 0.5383  |  Score: 86.79 [%]  |  Seq Length: 256.0
[2024-09-27 11:34:07,814][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-27 11:34:07,814][root][INFO] - Score: 46.33 [%]  |  Evaluation Time: 0.42 [s]
[2024-09-27 11:34:08,218][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-27 11:34:08,218][root][INFO] - Score: 32.26 [%]  |  Evaluation Time: 0.40 [s]
[2024-09-27 11:34:08,219][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-27 11:34:08,219][root][INFO] - - Epoch: 10
[2024-09-27 11:34:08,219][root][INFO] - - DEV score: 46.43 [%]
[2024-09-27 11:34:08,219][root][INFO] - - TEST score: 32.56 [%]
[2024-09-27 11:34:08,220][root][INFO] - Fine-tuning is done!
[2024-09-27 11:34:14,398][root][INFO] - 

[2024-09-27 11:34:14,398][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-27 11:34:14,398][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs
[2024-09-27 11:34:14,398][root][INFO] - 

[2024-09-27 11:34:14,398][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko', 'do_hangeulize': False, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-27 11:34:18,332][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-27 11:34:18,332][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-27 11:34:18,333][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-27 11:34:18,333][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-27 11:34:18,334][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-27 11:34:18,334][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-27 11:34:18,335][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-27 11:34:18,335][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-27 11:34:18,336][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-27 11:34:18,336][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-27 11:34:18,337][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-27 11:34:18,337][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-27 11:34:18,338][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-27 11:34:18,338][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-27 11:34:18,339][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-27 11:34:18,339][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-27 11:34:18,340][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-27 11:34:18,340][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-27 11:34:18,341][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-27 11:34:18,341][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-27 11:34:18,342][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-27 11:34:18,342][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-27 11:34:18,343][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-27 11:34:18,343][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-27 11:34:18,345][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-27 11:34:18,349][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-27 11:34:18,457][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-27 11:34:18,459][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-27 11:34:18,889][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-27 11:34:25,328][root][INFO] - 

[2024-09-27 11:34:25,328][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-27 11:34:25,328][root][INFO] - Data Preprocessing
[2024-09-27 11:34:25,328][root][INFO] - ㄴ remain_lang                ko
[2024-09-27 11:34:25,328][root][INFO] - ㄴ do_hangeulize              False
[2024-09-27 11:34:25,328][root][INFO] - ㄴ data_remove                True

[2024-09-27 11:34:25,328][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-27 11:34:25,337][root][INFO] - vocab size              : 51200
[2024-09-27 11:34:25,337][root][INFO] - device                  : gpu
[2024-09-27 11:34:25,337][root][INFO] - random seed             : 42
[2024-09-27 11:34:25,337][root][INFO] - train data size         : 448
[2024-09-27 11:34:25,337][root][INFO] - max epochs              : 15
[2024-09-27 11:34:25,337][root][INFO] - total steps             : 105
[2024-09-27 11:34:25,337][root][INFO] - warmup steps            : 10
[2024-09-27 11:34:25,337][root][INFO] - batch size              : 64
[2024-09-27 11:34:25,337][root][INFO] - accumulation steps      : 1
[2024-09-27 11:34:25,337][root][INFO] - optimizer               : adamwscale
[2024-09-27 11:34:25,337][root][INFO] - lr_scheduler            : cosine
[2024-09-27 11:34:25,338][root][INFO] - learning rate           : 0.01
[2024-09-27 11:34:25,338][root][INFO] - max length              : 256

[2024-09-27 11:34:25,338][root][INFO] - LoRA Configuration
[2024-09-27 11:34:25,338][root][INFO] - ㄴ r                    : 32
[2024-09-27 11:34:25,338][root][INFO] - ㄴ alpha                : 128
[2024-09-27 11:34:25,338][root][INFO] - ㄴ dropout              : 0.03

[2024-09-27 11:34:25,338][root][INFO] - KOMBO Configuration
[2024-09-27 11:34:25,338][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-27 11:34:25,338][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-27 11:34:25,338][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-27 11:34:25,338][root][INFO] - ㄴ do_combination       : True
[2024-09-27 11:34:25,339][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-27 11:34:25,339][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-27 11:34:25,339][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-27 11:34:25,339][root][INFO] -   ㄴ add_lora           : True

[2024-09-27 11:34:25,339][root][INFO] - LoRA in KOMBO Configuration
[2024-09-27 11:34:25,339][root][INFO] - ㄴ r                : 32
[2024-09-27 11:34:25,339][root][INFO] - ㄴ alpha            : 128
[2024-09-27 11:34:25,339][root][INFO] - ㄴ dropout          : 0.03

[2024-09-27 11:34:25,339][root][INFO] - 

[2024-09-27 11:34:25,339][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs
[2024-09-27 11:34:25,340][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-27 11:34:25,340][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko/256t_64b_1s_0.01lr_42rs/tb
[2024-09-27 11:34:25,340][root][INFO] - * tb interval   : 15

[2024-09-27 11:34:25,340][root][INFO] - 

[2024-09-27 11:34:25,340][root][INFO] - Start the Training !
[2024-09-27 11:34:25,343][root][INFO] - 
[1/ 15 Epoch]
[2024-09-27 11:34:30,127][root][INFO] - Step: 7/105  |  Loss: 4.8429  |  Score: 7.86 [%]  |  Seq Length: 256.0
[2024-09-27 11:34:30,684][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-27 11:34:30,684][root][INFO] - Score: 0.94 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-27 11:34:31,194][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-27 11:34:31,195][root][INFO] - Score: -8.15 [%]  |  Evaluation Time: 0.51 [s]
[2024-09-27 11:34:31,197][root][INFO] - 
[2/ 15 Epoch]
[2024-09-27 11:34:34,852][root][INFO] - Step: 14/105  |  Loss: 2.7094  |  Score: 20.57 [%]  |  Seq Length: 256.0
[2024-09-27 11:34:35,428][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-27 11:34:35,429][root][INFO] - Score: 3.14 [%]  |  Evaluation Time: 0.57 [s]
[2024-09-27 11:34:35,970][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-27 11:34:35,970][root][INFO] - Score: 5.57 [%]  |  Evaluation Time: 0.54 [s]
[2024-09-27 11:34:35,971][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-27 11:34:35,972][root][INFO] - 
[3/ 15 Epoch]
[2024-09-27 11:34:36,980][root][INFO] - Step: 15/105  |  Loss: 2.5352  |  Score: 20.13 [%]  |  Seq Length: 256.0
[2024-09-27 11:34:39,745][root][INFO] - Step: 21/105  |  Loss: 2.5252  |  Score: 32.15 [%]  |  Seq Length: 256.0
[2024-09-27 11:34:40,307][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-27 11:34:40,307][root][INFO] - Score: 10.90 [%]  |  Evaluation Time: 0.56 [s]
[2024-09-27 11:34:40,826][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-27 11:34:40,826][root][INFO] - Score: 9.27 [%]  |  Evaluation Time: 0.52 [s]
[2024-09-27 11:34:40,827][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-27 11:34:40,828][root][INFO] - 
[4/ 15 Epoch]
[2024-09-27 11:34:44,592][root][INFO] - Step: 28/105  |  Loss: 1.8511  |  Score: 50.29 [%]  |  Seq Length: 256.0
[2024-09-27 11:34:45,166][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-27 11:34:45,166][root][INFO] - Score: 14.21 [%]  |  Evaluation Time: 0.57 [s]
[2024-09-27 11:34:45,656][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-27 11:34:45,656][root][INFO] - Score: 11.93 [%]  |  Evaluation Time: 0.49 [s]
[2024-09-27 11:34:45,657][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-27 11:34:45,658][root][INFO] - 
[5/ 15 Epoch]
[2024-09-27 11:34:47,029][root][INFO] - Step: 30/105  |  Loss: 1.4425  |  Score: 62.98 [%]  |  Seq Length: 256.0
[2024-09-27 11:34:49,236][root][INFO] - Step: 35/105  |  Loss: 1.3417  |  Score: 67.22 [%]  |  Seq Length: 256.0
[2024-09-27 11:34:49,765][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-27 11:34:49,765][root][INFO] - Score: 31.29 [%]  |  Evaluation Time: 0.53 [s]
[2024-09-27 11:34:50,303][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-27 11:34:50,304][root][INFO] - Score: 22.11 [%]  |  Evaluation Time: 0.54 [s]
[2024-09-27 11:34:50,305][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-27 11:34:50,306][root][INFO] - 
[6/ 15 Epoch]
[2024-09-27 11:34:54,051][root][INFO] - Step: 42/105  |  Loss: 1.2601  |  Score: 67.80 [%]  |  Seq Length: 256.0
[2024-09-27 11:34:54,686][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-27 11:34:54,686][root][INFO] - Score: 31.55 [%]  |  Evaluation Time: 0.63 [s]
[2024-09-27 11:34:55,217][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-27 11:34:55,217][root][INFO] - Score: 24.88 [%]  |  Evaluation Time: 0.53 [s]
[2024-09-27 11:34:55,218][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-27 11:34:55,219][root][INFO] - 
[7/ 15 Epoch]
[2024-09-27 11:34:57,137][root][INFO] - Step: 45/105  |  Loss: 1.3131  |  Score: 69.52 [%]  |  Seq Length: 256.0
[2024-09-27 11:34:58,906][root][INFO] - Step: 49/105  |  Loss: 0.8952  |  Score: 78.47 [%]  |  Seq Length: 256.0
[2024-09-27 11:34:59,490][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-27 11:34:59,490][root][INFO] - Score: 37.58 [%]  |  Evaluation Time: 0.58 [s]
[2024-09-27 11:35:00,047][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-27 11:35:00,047][root][INFO] - Score: 29.71 [%]  |  Evaluation Time: 0.56 [s]
[2024-09-27 11:35:00,048][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-27 11:35:00,049][root][INFO] - 
[8/ 15 Epoch]
[2024-09-27 11:35:03,767][root][INFO] - Step: 56/105  |  Loss: 0.9348  |  Score: 80.07 [%]  |  Seq Length: 256.0
[2024-09-27 11:35:04,330][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-27 11:35:04,330][root][INFO] - Score: 38.85 [%]  |  Evaluation Time: 0.56 [s]
[2024-09-27 11:35:04,859][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-27 11:35:04,859][root][INFO] - Score: 31.11 [%]  |  Evaluation Time: 0.53 [s]
[2024-09-27 11:35:04,860][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-27 11:35:04,861][root][INFO] - 
[9/ 15 Epoch]
[2024-09-27 11:35:07,359][root][INFO] - Step: 60/105  |  Loss: 0.7488  |  Score: 83.46 [%]  |  Seq Length: 256.0
[2024-09-27 11:35:08,626][root][INFO] - Step: 63/105  |  Loss: 0.8293  |  Score: 80.11 [%]  |  Seq Length: 256.0
[2024-09-27 11:35:09,155][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-27 11:35:09,155][root][INFO] - Score: 44.24 [%]  |  Evaluation Time: 0.53 [s]
[2024-09-27 11:35:09,641][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-27 11:35:09,641][root][INFO] - Score: 33.67 [%]  |  Evaluation Time: 0.48 [s]
[2024-09-27 11:35:09,642][root][INFO] - 
Save new Best Score (Epoch: 9)
[2024-09-27 11:35:09,643][root][INFO] - 
[10/ 15 Epoch]
[2024-09-27 11:35:13,289][root][INFO] - Step: 70/105  |  Loss: 0.6146  |  Score: 85.74 [%]  |  Seq Length: 256.0
[2024-09-27 11:35:13,855][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-27 11:35:13,855][root][INFO] - Score: 47.82 [%]  |  Evaluation Time: 0.56 [s]
[2024-09-27 11:35:14,364][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-27 11:35:14,364][root][INFO] - Score: 36.23 [%]  |  Evaluation Time: 0.51 [s]
[2024-09-27 11:35:14,366][root][INFO] - 
Save new Best Score (Epoch: 10)
[2024-09-27 11:35:14,369][root][INFO] - 
[11/ 15 Epoch]
[2024-09-27 11:35:17,315][root][INFO] - Step: 75/105  |  Loss: 0.5851  |  Score: 87.18 [%]  |  Seq Length: 256.0
[2024-09-27 11:35:18,054][root][INFO] - Step: 77/105  |  Loss: 0.5856  |  Score: 82.48 [%]  |  Seq Length: 256.0
[2024-09-27 11:35:18,587][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-27 11:35:18,587][root][INFO] - Score: 46.96 [%]  |  Evaluation Time: 0.53 [s]
[2024-09-27 11:35:19,125][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-27 11:35:19,125][root][INFO] - Score: 35.04 [%]  |  Evaluation Time: 0.54 [s]
[2024-09-27 11:35:19,127][root][INFO] - 
[12/ 15 Epoch]
[2024-09-27 11:35:22,881][root][INFO] - Step: 84/105  |  Loss: 0.5838  |  Score: 85.44 [%]  |  Seq Length: 256.0
[2024-09-27 11:35:23,461][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-27 11:35:23,461][root][INFO] - Score: 47.74 [%]  |  Evaluation Time: 0.58 [s]
[2024-09-27 11:35:24,012][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-27 11:35:24,012][root][INFO] - Score: 35.85 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-27 11:35:24,014][root][INFO] - 
[13/ 15 Epoch]
[2024-09-27 11:35:27,563][root][INFO] - Step: 90/105  |  Loss: 0.5329  |  Score: 87.65 [%]  |  Seq Length: 256.0
[2024-09-27 11:35:27,792][root][INFO] - Step: 91/105  |  Loss: 0.3680  |  Score: 89.75 [%]  |  Seq Length: 256.0
[2024-09-27 11:35:28,321][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-27 11:35:28,321][root][INFO] - Score: 48.16 [%]  |  Evaluation Time: 0.53 [s]
[2024-09-27 11:35:28,959][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-27 11:35:28,959][root][INFO] - Score: 35.37 [%]  |  Evaluation Time: 0.63 [s]
[2024-09-27 11:35:28,962][root][INFO] - 
[14/ 15 Epoch]
[2024-09-27 11:35:32,704][root][INFO] - Step: 98/105  |  Loss: 0.5252  |  Score: 87.58 [%]  |  Seq Length: 256.0
[2024-09-27 11:35:33,254][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-27 11:35:33,255][root][INFO] - Score: 48.36 [%]  |  Evaluation Time: 0.55 [s]
[2024-09-27 11:35:33,794][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-27 11:35:33,794][root][INFO] - Score: 36.01 [%]  |  Evaluation Time: 0.54 [s]
[2024-09-27 11:35:33,795][root][INFO] - 
Save new Best Score (Epoch: 14)
[2024-09-27 11:35:33,797][root][INFO] - 
[15/ 15 Epoch]
[2024-09-27 11:35:37,631][root][INFO] - Step: 105/105  |  Loss: 0.4865  |  Score: 88.26 [%]  |  Seq Length: 256.0
[2024-09-27 11:35:38,206][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-27 11:35:38,206][root][INFO] - Score: 48.24 [%]  |  Evaluation Time: 0.57 [s]
[2024-09-27 11:35:38,730][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-27 11:35:38,730][root][INFO] - Score: 35.65 [%]  |  Evaluation Time: 0.52 [s]
[2024-09-27 11:35:38,731][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-27 11:35:38,731][root][INFO] - - Epoch: 14
[2024-09-27 11:35:38,731][root][INFO] - - DEV score: 48.36 [%]
[2024-09-27 11:35:38,731][root][INFO] - - TEST score: 36.01 [%]
[2024-09-27 11:35:38,733][root][INFO] - Fine-tuning is done!
[2024-09-27 14:01:26,959][root][INFO] - 

[2024-09-27 14:01:26,959][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-27 14:01:26,959][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-27 14:01:26,959][root][INFO] - 

[2024-09-27 14:01:26,959][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'seeds': '', 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-27 14:02:15,004][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-27 14:02:15,004][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-27 14:02:15,005][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-27 14:02:15,005][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-27 14:02:15,006][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-27 14:02:15,006][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-27 14:02:15,007][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-27 14:02:15,007][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-27 14:02:15,008][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-27 14:02:15,008][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-27 14:02:15,009][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-27 14:02:15,009][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-27 14:02:15,010][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-27 14:02:15,010][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-27 14:02:15,011][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-27 14:02:15,011][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-27 14:02:15,012][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-27 14:02:15,012][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-27 14:02:15,013][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-27 14:02:15,013][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-27 14:02:15,014][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-27 14:02:15,014][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-27 14:02:15,015][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-27 14:02:15,015][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-27 14:02:15,017][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-27 14:02:15,205][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-27 14:02:19,181][root][INFO] - 

[2024-09-27 14:02:19,182][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-27 14:02:19,182][root][INFO] - Data Preprocessing
[2024-09-27 14:02:19,182][root][INFO] - ㄴ remain_lang                ko_en_punc
[2024-09-27 14:02:19,182][root][INFO] - ㄴ do_hangeulize              True
[2024-09-27 14:02:19,182][root][INFO] - ㄴ data_remove                True

[2024-09-27 14:02:19,182][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-27 14:02:19,190][root][INFO] - vocab size              : 51200
[2024-09-27 14:02:19,190][root][INFO] - device                  : gpu
[2024-09-27 14:02:19,190][root][INFO] - random seed             : 42
[2024-09-27 14:02:19,190][root][INFO] - train data size         : 4416
[2024-09-27 14:02:19,190][root][INFO] - max epochs              : 15
[2024-09-27 14:02:19,190][root][INFO] - total steps             : 1035
[2024-09-27 14:02:19,190][root][INFO] - warmup steps            : 104
[2024-09-27 14:02:19,190][root][INFO] - batch size              : 64
[2024-09-27 14:02:19,190][root][INFO] - accumulation steps      : 1
[2024-09-27 14:02:19,190][root][INFO] - optimizer               : adamwscale
[2024-09-27 14:02:19,191][root][INFO] - lr_scheduler            : cosine
[2024-09-27 14:02:19,191][root][INFO] - learning rate           : 0.01
[2024-09-27 14:02:19,191][root][INFO] - max length              : 256

[2024-09-27 14:02:19,191][root][INFO] - LoRA Configuration
[2024-09-27 14:02:19,191][root][INFO] - ㄴ r                    : 32
[2024-09-27 14:02:19,191][root][INFO] - ㄴ alpha                : 128
[2024-09-27 14:02:19,191][root][INFO] - ㄴ dropout              : 0.03

[2024-09-27 14:02:19,191][root][INFO] - 

[2024-09-27 14:02:19,191][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs
[2024-09-27 14:02:19,191][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-27 14:02:19,191][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/ko_en_punc/256t_64b_1s_0.01lr_42rs/tb
[2024-09-27 14:02:19,191][root][INFO] - * tb interval   : 15

[2024-09-27 14:02:19,192][root][INFO] - 

[2024-09-27 14:02:19,192][root][INFO] - Start the Training !
[2024-09-27 14:02:19,194][root][INFO] - 
[1/ 15 Epoch]
[2024-09-27 14:02:27,676][root][INFO] - Step: 15/1035  |  Loss: 3.2320  |  Score: 8.30 [%]  |  Seq Length: 256.0
[2024-09-27 14:02:33,375][root][INFO] - Step: 30/1035  |  Loss: 2.2783  |  Score: 19.95 [%]  |  Seq Length: 256.0
[2024-09-27 14:02:39,070][root][INFO] - Step: 45/1035  |  Loss: 1.9845  |  Score: 37.75 [%]  |  Seq Length: 256.0
[2024-09-27 14:02:44,773][root][INFO] - Step: 60/1035  |  Loss: 1.6977  |  Score: 55.19 [%]  |  Seq Length: 256.0
[2024-09-27 14:02:48,204][root][INFO] - Step: 69/1035  |  Loss: 1.5733  |  Score: 59.65 [%]  |  Seq Length: 256.0
[2024-09-27 14:02:51,317][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-27 14:02:51,317][root][INFO] - Score: 73.07 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-27 14:02:54,286][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-27 14:02:54,286][root][INFO] - Score: 61.76 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-27 14:02:54,287][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-27 14:02:54,288][root][INFO] - 
[2/ 15 Epoch]
[2024-09-27 14:02:56,887][root][INFO] - Step: 75/1035  |  Loss: 1.3812  |  Score: 63.28 [%]  |  Seq Length: 256.0
[2024-09-27 14:03:02,596][root][INFO] - Step: 90/1035  |  Loss: 1.3100  |  Score: 63.54 [%]  |  Seq Length: 256.0
[2024-09-27 14:03:08,299][root][INFO] - Step: 105/1035  |  Loss: 1.2323  |  Score: 63.34 [%]  |  Seq Length: 256.0
[2024-09-27 14:03:13,998][root][INFO] - Step: 120/1035  |  Loss: 1.2890  |  Score: 65.41 [%]  |  Seq Length: 256.0
[2024-09-27 14:03:19,700][root][INFO] - Step: 135/1035  |  Loss: 1.2640  |  Score: 66.19 [%]  |  Seq Length: 256.0
[2024-09-27 14:03:20,897][root][INFO] - Step: 138/1035  |  Loss: 1.2267  |  Score: 72.78 [%]  |  Seq Length: 256.0
[2024-09-27 14:03:24,073][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-27 14:03:24,073][root][INFO] - Score: 75.34 [%]  |  Evaluation Time: 3.17 [s]
[2024-09-27 14:03:27,049][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-27 14:03:27,049][root][INFO] - Score: 68.21 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-27 14:03:27,050][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-27 14:03:27,051][root][INFO] - 
[3/ 15 Epoch]
[2024-09-27 14:03:31,927][root][INFO] - Step: 150/1035  |  Loss: 1.1503  |  Score: 68.61 [%]  |  Seq Length: 256.0
[2024-09-27 14:03:37,623][root][INFO] - Step: 165/1035  |  Loss: 1.0443  |  Score: 72.30 [%]  |  Seq Length: 256.0
[2024-09-27 14:03:43,347][root][INFO] - Step: 180/1035  |  Loss: 1.0556  |  Score: 72.01 [%]  |  Seq Length: 256.0
[2024-09-27 14:03:49,101][root][INFO] - Step: 195/1035  |  Loss: 1.2044  |  Score: 70.78 [%]  |  Seq Length: 256.0
[2024-09-27 14:03:53,758][root][INFO] - Step: 207/1035  |  Loss: 1.0119  |  Score: 70.82 [%]  |  Seq Length: 256.0
[2024-09-27 14:03:56,923][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-27 14:03:56,923][root][INFO] - Score: 77.68 [%]  |  Evaluation Time: 3.16 [s]
[2024-09-27 14:03:59,945][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-27 14:03:59,945][root][INFO] - Score: 69.24 [%]  |  Evaluation Time: 3.02 [s]
[2024-09-27 14:03:59,946][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-27 14:03:59,947][root][INFO] - 
[4/ 15 Epoch]
[2024-09-27 14:04:01,392][root][INFO] - Step: 210/1035  |  Loss: 1.0744  |  Score: 69.67 [%]  |  Seq Length: 256.0
[2024-09-27 14:04:07,093][root][INFO] - Step: 225/1035  |  Loss: 0.9189  |  Score: 75.95 [%]  |  Seq Length: 256.0
[2024-09-27 14:04:12,795][root][INFO] - Step: 240/1035  |  Loss: 0.8683  |  Score: 75.81 [%]  |  Seq Length: 256.0
[2024-09-27 14:04:18,500][root][INFO] - Step: 255/1035  |  Loss: 1.0046  |  Score: 73.87 [%]  |  Seq Length: 256.0
[2024-09-27 14:04:24,204][root][INFO] - Step: 270/1035  |  Loss: 0.9021  |  Score: 75.73 [%]  |  Seq Length: 256.0
[2024-09-27 14:04:26,528][root][INFO] - Step: 276/1035  |  Loss: 0.9975  |  Score: 67.36 [%]  |  Seq Length: 256.0
[2024-09-27 14:04:29,630][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-27 14:04:29,630][root][INFO] - Score: 77.50 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-27 14:04:32,767][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-27 14:04:32,767][root][INFO] - Score: 70.09 [%]  |  Evaluation Time: 3.14 [s]
[2024-09-27 14:04:32,768][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-27 14:04:32,769][root][INFO] - 
[5/ 15 Epoch]
[2024-09-27 14:04:36,525][root][INFO] - Step: 285/1035  |  Loss: 0.8253  |  Score: 79.03 [%]  |  Seq Length: 256.0
[2024-09-27 14:04:42,232][root][INFO] - Step: 300/1035  |  Loss: 0.8934  |  Score: 77.59 [%]  |  Seq Length: 256.0
[2024-09-27 14:04:47,942][root][INFO] - Step: 315/1035  |  Loss: 0.8234  |  Score: 77.08 [%]  |  Seq Length: 256.0
[2024-09-27 14:04:53,648][root][INFO] - Step: 330/1035  |  Loss: 0.7648  |  Score: 78.42 [%]  |  Seq Length: 256.0
[2024-09-27 14:04:59,412][root][INFO] - Step: 345/1035  |  Loss: 0.9360  |  Score: 74.90 [%]  |  Seq Length: 256.0
[2024-09-27 14:05:02,704][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-27 14:05:02,704][root][INFO] - Score: 76.57 [%]  |  Evaluation Time: 3.29 [s]
[2024-09-27 14:05:05,700][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-27 14:05:05,700][root][INFO] - Score: 70.48 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-27 14:05:05,702][root][INFO] - 
[6/ 15 Epoch]
[2024-09-27 14:05:06,558][root][INFO] - Step: 346/1035  |  Loss: 0.7622  |  Score: 78.76 [%]  |  Seq Length: 256.0
[2024-09-27 14:05:11,886][root][INFO] - Step: 360/1035  |  Loss: 0.7149  |  Score: 80.53 [%]  |  Seq Length: 256.0
[2024-09-27 14:05:17,588][root][INFO] - Step: 375/1035  |  Loss: 0.6979  |  Score: 82.91 [%]  |  Seq Length: 256.0
[2024-09-27 14:05:23,299][root][INFO] - Step: 390/1035  |  Loss: 0.7403  |  Score: 79.27 [%]  |  Seq Length: 256.0
[2024-09-27 14:05:29,014][root][INFO] - Step: 405/1035  |  Loss: 0.6694  |  Score: 79.43 [%]  |  Seq Length: 256.0
[2024-09-27 14:05:32,493][root][INFO] - Step: 414/1035  |  Loss: 0.6930  |  Score: 81.45 [%]  |  Seq Length: 256.0
[2024-09-27 14:05:35,610][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-27 14:05:35,610][root][INFO] - Score: 77.96 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-27 14:05:38,761][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-27 14:05:38,761][root][INFO] - Score: 71.93 [%]  |  Evaluation Time: 3.15 [s]
[2024-09-27 14:05:38,762][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-27 14:05:38,763][root][INFO] - 
[7/ 15 Epoch]
[2024-09-27 14:05:41,352][root][INFO] - Step: 420/1035  |  Loss: 0.5806  |  Score: 83.52 [%]  |  Seq Length: 256.0
[2024-09-27 14:05:47,061][root][INFO] - Step: 435/1035  |  Loss: 0.5785  |  Score: 85.11 [%]  |  Seq Length: 256.0
[2024-09-27 14:05:52,777][root][INFO] - Step: 450/1035  |  Loss: 0.6901  |  Score: 81.37 [%]  |  Seq Length: 256.0
[2024-09-27 14:05:58,485][root][INFO] - Step: 465/1035  |  Loss: 0.7268  |  Score: 82.57 [%]  |  Seq Length: 256.0
[2024-09-27 14:06:04,195][root][INFO] - Step: 480/1035  |  Loss: 0.6923  |  Score: 80.86 [%]  |  Seq Length: 256.0
[2024-09-27 14:06:05,389][root][INFO] - Step: 483/1035  |  Loss: 0.6940  |  Score: 81.25 [%]  |  Seq Length: 256.0
[2024-09-27 14:06:08,641][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-27 14:06:08,641][root][INFO] - Score: 77.96 [%]  |  Evaluation Time: 3.25 [s]
[2024-09-27 14:06:11,606][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-27 14:06:11,606][root][INFO] - Score: 70.73 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-27 14:06:11,608][root][INFO] - 
[8/ 15 Epoch]
[2024-09-27 14:06:16,567][root][INFO] - Step: 495/1035  |  Loss: 0.5298  |  Score: 84.19 [%]  |  Seq Length: 256.0
[2024-09-27 14:06:22,267][root][INFO] - Step: 510/1035  |  Loss: 0.5620  |  Score: 84.98 [%]  |  Seq Length: 256.0
[2024-09-27 14:06:27,975][root][INFO] - Step: 525/1035  |  Loss: 0.6064  |  Score: 83.34 [%]  |  Seq Length: 256.0
[2024-09-27 14:06:33,679][root][INFO] - Step: 540/1035  |  Loss: 0.5484  |  Score: 85.29 [%]  |  Seq Length: 256.0
[2024-09-27 14:06:38,290][root][INFO] - Step: 552/1035  |  Loss: 0.5562  |  Score: 84.19 [%]  |  Seq Length: 256.0
[2024-09-27 14:06:41,388][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-27 14:06:41,388][root][INFO] - Score: 77.68 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-27 14:06:44,449][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-27 14:06:44,449][root][INFO] - Score: 71.51 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-27 14:06:44,451][root][INFO] - 
[9/ 15 Epoch]
[2024-09-27 14:06:46,026][root][INFO] - Step: 555/1035  |  Loss: 0.5178  |  Score: 84.05 [%]  |  Seq Length: 256.0
[2024-09-27 14:06:51,743][root][INFO] - Step: 570/1035  |  Loss: 0.4731  |  Score: 86.18 [%]  |  Seq Length: 256.0
[2024-09-27 14:06:57,460][root][INFO] - Step: 585/1035  |  Loss: 0.4880  |  Score: 87.07 [%]  |  Seq Length: 256.0
[2024-09-27 14:07:03,178][root][INFO] - Step: 600/1035  |  Loss: 0.5069  |  Score: 85.71 [%]  |  Seq Length: 256.0
[2024-09-27 14:07:08,895][root][INFO] - Step: 615/1035  |  Loss: 0.5021  |  Score: 86.20 [%]  |  Seq Length: 256.0
[2024-09-27 14:07:11,199][root][INFO] - Step: 621/1035  |  Loss: 0.4864  |  Score: 86.00 [%]  |  Seq Length: 256.0
[2024-09-27 14:07:14,378][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-27 14:07:14,378][root][INFO] - Score: 77.53 [%]  |  Evaluation Time: 3.18 [s]
[2024-09-27 14:07:17,457][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-27 14:07:17,457][root][INFO] - Score: 71.23 [%]  |  Evaluation Time: 3.08 [s]
[2024-09-27 14:07:17,459][root][INFO] - 
[10/ 15 Epoch]
[2024-09-27 14:07:21,286][root][INFO] - Step: 630/1035  |  Loss: 0.4179  |  Score: 87.96 [%]  |  Seq Length: 256.0
[2024-09-27 14:07:27,022][root][INFO] - Step: 645/1035  |  Loss: 0.4993  |  Score: 87.00 [%]  |  Seq Length: 256.0
[2024-09-27 14:07:32,748][root][INFO] - Step: 660/1035  |  Loss: 0.4187  |  Score: 87.72 [%]  |  Seq Length: 256.0
[2024-09-27 14:07:38,477][root][INFO] - Step: 675/1035  |  Loss: 0.5031  |  Score: 86.26 [%]  |  Seq Length: 256.0
[2024-09-27 14:07:44,245][root][INFO] - Step: 690/1035  |  Loss: 0.5282  |  Score: 86.61 [%]  |  Seq Length: 256.0
[2024-09-27 14:07:47,366][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-27 14:07:47,366][root][INFO] - Score: 76.74 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-27 14:07:50,564][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-27 14:07:50,565][root][INFO] - Score: 70.56 [%]  |  Evaluation Time: 3.20 [s]
[2024-09-27 14:07:50,567][root][INFO] - 
[11/ 15 Epoch]
[2024-09-27 14:07:51,278][root][INFO] - Step: 691/1035  |  Loss: 0.5624  |  Score: 81.59 [%]  |  Seq Length: 256.0
[2024-09-27 14:07:56,633][root][INFO] - Step: 705/1035  |  Loss: 0.4131  |  Score: 89.01 [%]  |  Seq Length: 256.0
[2024-09-27 14:08:02,367][root][INFO] - Step: 720/1035  |  Loss: 0.4177  |  Score: 86.98 [%]  |  Seq Length: 256.0
[2024-09-27 14:08:08,108][root][INFO] - Step: 735/1035  |  Loss: 0.4474  |  Score: 87.23 [%]  |  Seq Length: 256.0
[2024-09-27 14:08:13,844][root][INFO] - Step: 750/1035  |  Loss: 0.4256  |  Score: 88.46 [%]  |  Seq Length: 256.0
[2024-09-27 14:08:17,331][root][INFO] - Step: 759/1035  |  Loss: 0.4049  |  Score: 89.29 [%]  |  Seq Length: 256.0
[2024-09-27 14:08:20,503][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-27 14:08:20,503][root][INFO] - Score: 77.36 [%]  |  Evaluation Time: 3.17 [s]
[2024-09-27 14:08:23,478][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-27 14:08:23,478][root][INFO] - Score: 70.58 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-27 14:08:23,480][root][INFO] - 
[12/ 15 Epoch]
[2024-09-27 14:08:26,095][root][INFO] - Step: 765/1035  |  Loss: 0.3910  |  Score: 87.85 [%]  |  Seq Length: 256.0
[2024-09-27 14:08:31,815][root][INFO] - Step: 780/1035  |  Loss: 0.3618  |  Score: 89.82 [%]  |  Seq Length: 256.0
[2024-09-27 14:08:37,539][root][INFO] - Step: 795/1035  |  Loss: 0.3725  |  Score: 89.99 [%]  |  Seq Length: 256.0
[2024-09-27 14:08:43,258][root][INFO] - Step: 810/1035  |  Loss: 0.4104  |  Score: 89.21 [%]  |  Seq Length: 256.0
[2024-09-27 14:08:48,974][root][INFO] - Step: 825/1035  |  Loss: 0.4208  |  Score: 88.11 [%]  |  Seq Length: 256.0
[2024-09-27 14:08:50,135][root][INFO] - Step: 828/1035  |  Loss: 0.3871  |  Score: 89.16 [%]  |  Seq Length: 256.0
[2024-09-27 14:08:53,302][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-27 14:08:53,302][root][INFO] - Score: 77.34 [%]  |  Evaluation Time: 3.16 [s]
[2024-09-27 14:08:56,281][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-27 14:08:56,281][root][INFO] - Score: 70.78 [%]  |  Evaluation Time: 2.98 [s]
[2024-09-27 14:08:56,283][root][INFO] - 
[13/ 15 Epoch]
[2024-09-27 14:09:01,160][root][INFO] - Step: 840/1035  |  Loss: 0.3849  |  Score: 89.43 [%]  |  Seq Length: 256.0
[2024-09-27 14:09:06,877][root][INFO] - Step: 855/1035  |  Loss: 0.3909  |  Score: 88.97 [%]  |  Seq Length: 256.0
[2024-09-27 14:09:12,596][root][INFO] - Step: 870/1035  |  Loss: 0.3805  |  Score: 88.97 [%]  |  Seq Length: 256.0
[2024-09-27 14:09:18,313][root][INFO] - Step: 885/1035  |  Loss: 0.3627  |  Score: 89.37 [%]  |  Seq Length: 256.0
[2024-09-27 14:09:22,928][root][INFO] - Step: 897/1035  |  Loss: 0.3698  |  Score: 89.62 [%]  |  Seq Length: 256.0
[2024-09-27 14:09:26,059][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-27 14:09:26,059][root][INFO] - Score: 77.09 [%]  |  Evaluation Time: 3.13 [s]
[2024-09-27 14:09:29,190][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-27 14:09:29,190][root][INFO] - Score: 70.48 [%]  |  Evaluation Time: 3.13 [s]
[2024-09-27 14:09:29,192][root][INFO] - 
[14/ 15 Epoch]
[2024-09-27 14:09:30,636][root][INFO] - Step: 900/1035  |  Loss: 0.3377  |  Score: 86.81 [%]  |  Seq Length: 256.0
[2024-09-27 14:09:36,362][root][INFO] - Step: 915/1035  |  Loss: 0.3861  |  Score: 88.65 [%]  |  Seq Length: 256.0
[2024-09-27 14:09:42,086][root][INFO] - Step: 930/1035  |  Loss: 0.3663  |  Score: 90.28 [%]  |  Seq Length: 256.0
[2024-09-27 14:09:47,810][root][INFO] - Step: 945/1035  |  Loss: 0.3826  |  Score: 89.38 [%]  |  Seq Length: 256.0
[2024-09-27 14:09:53,532][root][INFO] - Step: 960/1035  |  Loss: 0.3328  |  Score: 90.49 [%]  |  Seq Length: 256.0
[2024-09-27 14:09:55,878][root][INFO] - Step: 966/1035  |  Loss: 0.3702  |  Score: 89.96 [%]  |  Seq Length: 256.0
[2024-09-27 14:09:59,060][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-27 14:09:59,061][root][INFO] - Score: 76.72 [%]  |  Evaluation Time: 3.18 [s]
[2024-09-27 14:10:02,047][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-27 14:10:02,047][root][INFO] - Score: 70.90 [%]  |  Evaluation Time: 2.98 [s]
[2024-09-27 14:10:02,050][root][INFO] - 
[15/ 15 Epoch]
[2024-09-27 14:10:05,923][root][INFO] - Step: 975/1035  |  Loss: 0.3575  |  Score: 89.69 [%]  |  Seq Length: 256.0
[2024-09-27 14:10:11,650][root][INFO] - Step: 990/1035  |  Loss: 0.3298  |  Score: 91.45 [%]  |  Seq Length: 256.0
[2024-09-27 14:10:17,378][root][INFO] - Step: 1005/1035  |  Loss: 0.3295  |  Score: 90.68 [%]  |  Seq Length: 256.0
[2024-09-27 14:10:23,106][root][INFO] - Step: 1020/1035  |  Loss: 0.3249  |  Score: 91.14 [%]  |  Seq Length: 256.0
[2024-09-27 14:10:28,886][root][INFO] - Step: 1035/1035  |  Loss: 0.3152  |  Score: 90.50 [%]  |  Seq Length: 256.0
[2024-09-27 14:10:32,217][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-27 14:10:32,217][root][INFO] - Score: 77.52 [%]  |  Evaluation Time: 3.33 [s]
[2024-09-27 14:10:35,351][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-27 14:10:35,351][root][INFO] - Score: 70.78 [%]  |  Evaluation Time: 3.13 [s]
[2024-09-27 14:10:35,353][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-27 14:10:35,353][root][INFO] - - Epoch: 6
[2024-09-27 14:10:35,353][root][INFO] - - DEV score: 77.96 [%]
[2024-09-27 14:10:35,353][root][INFO] - - TEST score: 71.93 [%]
[2024-09-27 14:10:35,355][root][INFO] - Fine-tuning is done!
