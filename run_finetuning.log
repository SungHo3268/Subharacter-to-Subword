[2024-09-19 09:46:34,049][root][INFO] - 

[2024-09-19 09:46:34,049][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 09:46:34,049][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs
[2024-09-19 09:46:34,049][root][INFO] - 

[2024-09-19 09:46:34,049][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 128, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 5e-05, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 8, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 09:46:39,379][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 09:46:41,285][root][INFO] - 

[2024-09-19 09:46:41,286][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-19 09:46:41,286][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 09:46:41,294][root][INFO] - vocab size              : 51200
[2024-09-19 09:46:41,294][root][INFO] - device                  : gpu
[2024-09-19 09:46:41,294][root][INFO] - random seed             : 42
[2024-09-19 09:46:41,294][root][INFO] - train data size         : 544
[2024-09-19 09:46:41,295][root][INFO] - max epochs              : 15
[2024-09-19 09:46:41,295][root][INFO] - total steps             : 1033
[2024-09-19 09:46:41,295][root][INFO] - warmup steps            : 103
[2024-09-19 09:46:41,295][root][INFO] - batch size              : 64
[2024-09-19 09:46:41,295][root][INFO] - accumulation steps      : 8
[2024-09-19 09:46:41,295][root][INFO] - optimizer               : adamwscale
[2024-09-19 09:46:41,295][root][INFO] - lr_scheduler            : cosine
[2024-09-19 09:46:41,295][root][INFO] - learning rate           : 5e-05
[2024-09-19 09:46:41,295][root][INFO] - max length              : 128

[2024-09-19 09:46:41,295][root][INFO] - 

[2024-09-19 09:46:41,295][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs
[2024-09-19 09:46:41,296][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs/ckpt
[2024-09-19 09:46:41,296][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs/tb
[2024-09-19 09:46:41,296][root][INFO] - * tb interval           : 15

[2024-09-19 09:46:41,296][root][INFO] - 

[2024-09-19 09:46:41,296][root][INFO] - Start the Training !
[2024-09-19 09:46:41,298][root][INFO] - 
[1/ 15 Epoch]
[2024-09-19 09:46:51,398][root][INFO] - Step: 15/1033  |  Loss: 4.6560  |  Score: 8.47 [%]  |  Seq Length: 128.0
[2024-09-19 09:46:59,829][root][INFO] - Step: 30/1033  |  Loss: 3.0399  |  Score: -1.96 [%]  |  Seq Length: 128.0
[2024-09-19 09:47:07,851][root][INFO] - Step: 45/1033  |  Loss: 2.4013  |  Score: 12.23 [%]  |  Seq Length: 128.0
[2024-09-19 09:47:16,168][root][INFO] - Step: 60/1033  |  Loss: 2.4516  |  Score: 12.63 [%]  |  Seq Length: 128.0
[2024-09-19 09:47:21,454][root][INFO] - Step: 68/1033  |  Loss: 2.3626  |  Score: 15.85 [%]  |  Seq Length: 128.0
[2024-09-19 09:47:25,439][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 09:47:25,439][root][INFO] - Score: 14.09 [%]  |  Evaluation Time: 3.98 [s]
[2024-09-19 09:47:28,879][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 09:47:28,879][root][INFO] - Score: 17.64 [%]  |  Evaluation Time: 3.44 [s]
[2024-09-19 09:47:28,881][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 09:47:28,882][root][INFO] - 
[2/ 15 Epoch]
[2024-09-19 09:47:32,581][root][INFO] - Step: 75/1033  |  Loss: 2.0800  |  Score: 27.72 [%]  |  Seq Length: 128.0
[2024-09-19 09:47:40,758][root][INFO] - Step: 90/1033  |  Loss: 2.1077  |  Score: 29.43 [%]  |  Seq Length: 128.0
[2024-09-19 09:47:48,410][root][INFO] - Step: 105/1033  |  Loss: 2.0913  |  Score: 34.62 [%]  |  Seq Length: 128.0
[2024-09-19 09:47:56,113][root][INFO] - Step: 120/1033  |  Loss: 1.8503  |  Score: 35.96 [%]  |  Seq Length: 128.0
[2024-09-19 09:48:03,977][root][INFO] - Step: 135/1033  |  Loss: 1.6520  |  Score: 42.29 [%]  |  Seq Length: 128.0
[2024-09-19 09:48:05,469][root][INFO] - Step: 137/1033  |  Loss: 1.6903  |  Score: 55.04 [%]  |  Seq Length: 128.0
[2024-09-19 09:48:08,990][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 09:48:08,990][root][INFO] - Score: 51.82 [%]  |  Evaluation Time: 3.52 [s]
[2024-09-19 09:48:12,449][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 09:48:12,449][root][INFO] - Score: 48.49 [%]  |  Evaluation Time: 3.46 [s]
[2024-09-19 09:48:12,451][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 09:48:12,452][root][INFO] - 
[3/ 15 Epoch]
[2024-09-19 09:48:19,115][root][INFO] - Step: 150/1033  |  Loss: 1.5004  |  Score: 49.34 [%]  |  Seq Length: 128.0
[2024-09-19 09:48:27,129][root][INFO] - Step: 165/1033  |  Loss: 1.4546  |  Score: 57.17 [%]  |  Seq Length: 128.0
[2024-09-19 09:48:34,967][root][INFO] - Step: 180/1033  |  Loss: 1.5548  |  Score: 51.38 [%]  |  Seq Length: 128.0
[2024-09-19 09:48:42,755][root][INFO] - Step: 195/1033  |  Loss: 1.3891  |  Score: 56.09 [%]  |  Seq Length: 128.0
[2024-09-19 09:48:48,876][root][INFO] - Step: 206/1033  |  Loss: 1.3708  |  Score: 55.42 [%]  |  Seq Length: 128.0
[2024-09-19 09:48:52,384][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 09:48:52,384][root][INFO] - Score: 63.88 [%]  |  Evaluation Time: 3.50 [s]
[2024-09-19 09:48:55,733][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 09:48:55,733][root][INFO] - Score: 60.80 [%]  |  Evaluation Time: 3.35 [s]
[2024-09-19 09:48:55,734][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-19 09:48:55,735][root][INFO] - 
[4/ 15 Epoch]
[2024-09-19 09:48:57,737][root][INFO] - Step: 210/1033  |  Loss: 1.2910  |  Score: 65.68 [%]  |  Seq Length: 128.0
[2024-09-19 09:49:05,357][root][INFO] - Step: 225/1033  |  Loss: 1.2889  |  Score: 59.47 [%]  |  Seq Length: 128.0
[2024-09-19 09:49:13,037][root][INFO] - Step: 240/1033  |  Loss: 1.2855  |  Score: 58.14 [%]  |  Seq Length: 128.0
[2024-09-19 09:49:20,875][root][INFO] - Step: 255/1033  |  Loss: 1.2998  |  Score: 55.84 [%]  |  Seq Length: 128.0
[2024-09-19 09:49:28,663][root][INFO] - Step: 270/1033  |  Loss: 1.1752  |  Score: 61.08 [%]  |  Seq Length: 128.0
[2024-09-19 09:49:31,549][root][INFO] - Step: 275/1033  |  Loss: 1.1725  |  Score: 67.96 [%]  |  Seq Length: 128.0
[2024-09-19 09:49:35,059][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 09:49:35,059][root][INFO] - Score: 68.28 [%]  |  Evaluation Time: 3.51 [s]
[2024-09-19 09:49:38,369][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 09:49:38,369][root][INFO] - Score: 59.88 [%]  |  Evaluation Time: 3.31 [s]
[2024-09-19 09:49:38,370][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-19 09:49:38,371][root][INFO] - 
[5/ 15 Epoch]
[2024-09-19 09:49:43,427][root][INFO] - Step: 285/1033  |  Loss: 1.0572  |  Score: 65.80 [%]  |  Seq Length: 128.0
[2024-09-19 09:49:49,423][root][INFO] - 

[2024-09-19 09:49:49,424][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 09:49:49,424][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs
[2024-09-19 09:49:49,424][root][INFO] - 

[2024-09-19 09:49:49,424][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 128, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 5e-05, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 8, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 09:49:51,182][root][INFO] - Step: 300/1033  |  Loss: 1.1061  |  Score: 63.06 [%]  |  Seq Length: 128.0
[2024-09-19 09:49:54,112][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-19 09:49:54,113][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-19 09:49:54,113][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-19 09:49:54,114][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-19 09:49:54,114][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-19 09:49:54,114][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-19 09:49:54,115][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-19 09:49:54,115][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-19 09:49:54,116][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-19 09:49:54,116][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-19 09:49:54,116][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-19 09:49:54,117][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-19 09:49:54,117][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-19 09:49:54,117][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-19 09:49:54,118][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-19 09:49:54,118][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-19 09:49:54,118][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-19 09:49:54,119][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-19 09:49:54,119][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-19 09:49:54,119][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-19 09:49:54,120][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-19 09:49:54,120][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-19 09:49:54,121][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-19 09:49:54,121][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-19 09:49:54,123][root][INFO] - Trainable params: 884736 || all params: 126049536 || trainable: 0.70 %
[2024-09-19 09:49:54,295][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 09:49:56,273][root][INFO] - 

[2024-09-19 09:49:56,273][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-19 09:49:56,273][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 09:49:56,281][root][INFO] - vocab size              : 51200
[2024-09-19 09:49:56,282][root][INFO] - device                  : gpu
[2024-09-19 09:49:56,282][root][INFO] - random seed             : 42
[2024-09-19 09:49:56,282][root][INFO] - train data size         : 544
[2024-09-19 09:49:56,282][root][INFO] - max epochs              : 15
[2024-09-19 09:49:56,282][root][INFO] - total steps             : 1033
[2024-09-19 09:49:56,282][root][INFO] - warmup steps            : 103
[2024-09-19 09:49:56,282][root][INFO] - batch size              : 64
[2024-09-19 09:49:56,282][root][INFO] - accumulation steps      : 8
[2024-09-19 09:49:56,282][root][INFO] - optimizer               : adamwscale
[2024-09-19 09:49:56,282][root][INFO] - lr_scheduler            : cosine
[2024-09-19 09:49:56,282][root][INFO] - learning rate           : 5e-05
[2024-09-19 09:49:56,283][root][INFO] - max length              : 128

[2024-09-19 09:49:56,283][root][INFO] - LoRA Configuration
[2024-09-19 09:49:56,283][root][INFO] - ㄴ r                    : 16
[2024-09-19 09:49:56,283][root][INFO] - ㄴ alpha                : 64
[2024-09-19 09:49:56,283][root][INFO] - ㄴ dropout              : 0.03

[2024-09-19 09:49:56,283][root][INFO] - 

[2024-09-19 09:49:56,283][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs
[2024-09-19 09:49:56,283][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs/ckpt
[2024-09-19 09:49:56,283][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs/tb
[2024-09-19 09:49:56,283][root][INFO] - * tb interval           : 15

[2024-09-19 09:49:56,283][root][INFO] - 

[2024-09-19 09:49:56,283][root][INFO] - Start the Training !
[2024-09-19 09:49:56,286][root][INFO] - 
[1/ 15 Epoch]
[2024-09-19 09:49:59,162][root][INFO] - Step: 315/1033  |  Loss: 1.1288  |  Score: 65.54 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:06,257][root][INFO] - Step: 15/1033  |  Loss: 7.0161  |  Score: -0.18 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:07,039][root][INFO] - Step: 330/1033  |  Loss: 1.1131  |  Score: 62.71 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:14,406][root][INFO] - Step: 344/1033  |  Loss: 1.1131  |  Score: 61.94 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:14,771][root][INFO] - Step: 30/1033  |  Loss: 6.7364  |  Score: -1.98 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:17,978][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 09:50:17,979][root][INFO] - Score: 67.36 [%]  |  Evaluation Time: 3.57 [s]
[2024-09-19 09:50:21,395][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 09:50:21,396][root][INFO] - Score: 62.61 [%]  |  Evaluation Time: 3.42 [s]
[2024-09-19 09:50:21,397][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-19 09:50:21,398][root][INFO] - 
[6/ 15 Epoch]
[2024-09-19 09:50:21,998][root][INFO] - Step: 345/1033  |  Loss: 0.8747  |  Score: 64.10 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:23,255][root][INFO] - Step: 45/1033  |  Loss: 6.5852  |  Score: 1.52 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:29,686][root][INFO] - Step: 360/1033  |  Loss: 1.0000  |  Score: 67.20 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:31,698][root][INFO] - Step: 60/1033  |  Loss: 6.2561  |  Score: 5.65 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:36,644][root][INFO] - Step: 68/1033  |  Loss: 5.7377  |  Score: 4.60 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:36,866][root][INFO] - Step: 375/1033  |  Loss: 1.0029  |  Score: 66.69 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:40,702][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 09:50:40,702][root][INFO] - Score: 6.34 [%]  |  Evaluation Time: 4.05 [s]
[2024-09-19 09:50:44,570][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 09:50:44,570][root][INFO] - Score: -0.99 [%]  |  Evaluation Time: 3.87 [s]
[2024-09-19 09:50:44,571][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 09:50:44,572][root][INFO] - 
[2/ 15 Epoch]
[2024-09-19 09:50:44,961][root][INFO] - Step: 390/1033  |  Loss: 1.0118  |  Score: 67.26 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:48,123][root][INFO] - Step: 75/1033  |  Loss: 6.3265  |  Score: 5.78 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:52,889][root][INFO] - Step: 405/1033  |  Loss: 1.0083  |  Score: 62.71 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:56,616][root][INFO] - Step: 90/1033  |  Loss: 6.1769  |  Score: 8.01 [%]  |  Seq Length: 128.0
[2024-09-19 09:50:57,352][root][INFO] - Step: 413/1033  |  Loss: 0.9930  |  Score: 67.94 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:01,018][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-19 09:51:01,019][root][INFO] - Score: 70.65 [%]  |  Evaluation Time: 3.66 [s]
[2024-09-19 09:51:04,584][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-19 09:51:04,585][root][INFO] - Score: 59.15 [%]  |  Evaluation Time: 3.56 [s]
[2024-09-19 09:51:04,589][root][INFO] - 
[7/ 15 Epoch]
[2024-09-19 09:51:05,165][root][INFO] - Step: 105/1033  |  Loss: 6.0004  |  Score: -4.61 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:08,455][root][INFO] - Step: 420/1033  |  Loss: 0.9982  |  Score: 66.26 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:13,483][root][INFO] - Step: 120/1033  |  Loss: 5.7832  |  Score: 0.65 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:16,541][root][INFO] - Step: 435/1033  |  Loss: 1.0002  |  Score: 69.57 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:19,862][root][INFO] - 

[2024-09-19 09:51:19,862][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 09:51:19,862][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs
[2024-09-19 09:51:19,862][root][INFO] - 

[2024-09-19 09:51:19,862][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 128, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 5e-05, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 8, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 09:51:21,799][root][INFO] - Step: 135/1033  |  Loss: 5.7606  |  Score: -1.93 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:23,409][root][INFO] - Step: 137/1033  |  Loss: 5.6417  |  Score: 12.45 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:24,054][root][INFO] - Step: 450/1033  |  Loss: 0.9364  |  Score: 68.75 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:24,980][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-19 09:51:24,981][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-19 09:51:24,982][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-19 09:51:24,983][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-19 09:51:24,984][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-19 09:51:24,985][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-19 09:51:24,986][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-19 09:51:24,987][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-19 09:51:24,988][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-19 09:51:24,989][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-19 09:51:24,990][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-19 09:51:24,991][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-19 09:51:24,992][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-19 09:51:24,993][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-19 09:51:24,994][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-19 09:51:24,995][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-19 09:51:24,997][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-19 09:51:24,997][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-19 09:51:24,998][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-19 09:51:24,999][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-19 09:51:25,000][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-19 09:51:25,001][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-19 09:51:25,002][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-19 09:51:25,003][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-19 09:51:25,005][root][INFO] - Trainable params: 884736 || all params: 126049536 || trainable: 0.70 %
[2024-09-19 09:51:25,008][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-19 09:51:25,014][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-19 09:51:25,016][root][INFO] - Trainable params: 1298304 || all params: 126463104 || trainable: 1.03 %
[2024-09-19 09:51:25,173][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 09:51:27,573][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 09:51:27,573][root][INFO] - Score: 5.14 [%]  |  Evaluation Time: 4.16 [s]
[2024-09-19 09:51:28,637][root][INFO] - 

[2024-09-19 09:51:28,638][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-19 09:51:28,638][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 09:51:28,646][root][INFO] - vocab size              : 51200
[2024-09-19 09:51:28,646][root][INFO] - device                  : gpu
[2024-09-19 09:51:28,646][root][INFO] - random seed             : 42
[2024-09-19 09:51:28,646][root][INFO] - train data size         : 544
[2024-09-19 09:51:28,646][root][INFO] - max epochs              : 15
[2024-09-19 09:51:28,646][root][INFO] - total steps             : 1033
[2024-09-19 09:51:28,646][root][INFO] - warmup steps            : 103
[2024-09-19 09:51:28,646][root][INFO] - batch size              : 64
[2024-09-19 09:51:28,646][root][INFO] - accumulation steps      : 8
[2024-09-19 09:51:28,647][root][INFO] - optimizer               : adamwscale
[2024-09-19 09:51:28,647][root][INFO] - lr_scheduler            : cosine
[2024-09-19 09:51:28,647][root][INFO] - learning rate           : 5e-05
[2024-09-19 09:51:28,647][root][INFO] - max length              : 128

[2024-09-19 09:51:28,647][root][INFO] - LoRA Configuration
[2024-09-19 09:51:28,647][root][INFO] - ㄴ r                    : 16
[2024-09-19 09:51:28,647][root][INFO] - ㄴ alpha                : 64
[2024-09-19 09:51:28,647][root][INFO] - ㄴ dropout              : 0.03

[2024-09-19 09:51:28,647][root][INFO] - KOMBO Configuration
[2024-09-19 09:51:28,647][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-19 09:51:28,647][root][INFO] - ㄴ reducer              : linear
[2024-09-19 09:51:28,648][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-19 09:51:28,648][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-19 09:51:28,648][root][INFO] - ㄴ do_combination       : False
[2024-09-19 09:51:28,648][root][INFO] - 

[2024-09-19 09:51:28,648][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs
[2024-09-19 09:51:28,648][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs/ckpt
[2024-09-19 09:51:28,648][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_5e-05lr_42rs/tb
[2024-09-19 09:51:28,648][root][INFO] - * tb interval           : 15

[2024-09-19 09:51:28,648][root][INFO] - 

[2024-09-19 09:51:28,648][root][INFO] - Start the Training !
[2024-09-19 09:51:28,651][root][INFO] - 
[1/ 15 Epoch]
[2024-09-19 09:51:31,573][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 09:51:31,573][root][INFO] - Score: 0.59 [%]  |  Evaluation Time: 4.00 [s]
[2024-09-19 09:51:31,574][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 09:51:31,576][root][INFO] - 
[3/ 15 Epoch]
[2024-09-19 09:51:32,043][root][INFO] - Step: 465/1033  |  Loss: 0.9302  |  Score: 68.39 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:38,497][root][INFO] - Step: 150/1033  |  Loss: 5.6828  |  Score: -3.87 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:39,972][root][INFO] - Step: 480/1033  |  Loss: 0.9655  |  Score: 64.68 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:41,204][root][INFO] - Step: 482/1033  |  Loss: 0.9291  |  Score: 71.78 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:44,697][root][INFO] - Step: 15/1033  |  Loss: 6.6237  |  Score: 2.99 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:44,877][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-19 09:51:44,877][root][INFO] - Score: 68.22 [%]  |  Evaluation Time: 3.67 [s]
[2024-09-19 09:51:47,092][root][INFO] - Step: 165/1033  |  Loss: 5.6870  |  Score: -1.70 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:48,406][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-19 09:51:48,406][root][INFO] - Score: 64.30 [%]  |  Evaluation Time: 3.53 [s]
[2024-09-19 09:51:48,407][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-19 09:51:48,408][root][INFO] - 
[8/ 15 Epoch]
[2024-09-19 09:51:55,506][root][INFO] - Step: 495/1033  |  Loss: 0.9473  |  Score: 70.29 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:55,552][root][INFO] - Step: 180/1033  |  Loss: 5.0945  |  Score: 3.16 [%]  |  Seq Length: 128.0
[2024-09-19 09:51:58,150][root][INFO] - Step: 30/1033  |  Loss: 6.9392  |  Score: -0.84 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:03,479][root][INFO] - Step: 510/1033  |  Loss: 0.8937  |  Score: 71.52 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:03,911][root][INFO] - Step: 195/1033  |  Loss: 5.2837  |  Score: -3.13 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:10,393][root][INFO] - Step: 206/1033  |  Loss: 4.7846  |  Score: -2.58 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:11,462][root][INFO] - Step: 45/1033  |  Loss: 6.7202  |  Score: 1.52 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:11,598][root][INFO] - Step: 525/1033  |  Loss: 0.9718  |  Score: 66.62 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:14,594][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 09:52:14,594][root][INFO] - Score: 4.52 [%]  |  Evaluation Time: 4.20 [s]
[2024-09-19 09:52:18,607][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 09:52:18,607][root][INFO] - Score: -6.01 [%]  |  Evaluation Time: 4.01 [s]
[2024-09-19 09:52:18,609][root][INFO] - 
[4/ 15 Epoch]
[2024-09-19 09:52:19,687][root][INFO] - Step: 540/1033  |  Loss: 0.8425  |  Score: 69.81 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:20,743][root][INFO] - Step: 210/1033  |  Loss: 4.4162  |  Score: 5.91 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:24,606][root][INFO] - Step: 60/1033  |  Loss: 6.0123  |  Score: -1.28 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:25,626][root][INFO] - Step: 551/1033  |  Loss: 0.8372  |  Score: 70.30 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:29,048][root][INFO] - Step: 225/1033  |  Loss: 5.0689  |  Score: 5.30 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:29,329][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-19 09:52:29,329][root][INFO] - Score: 70.90 [%]  |  Evaluation Time: 3.70 [s]
[2024-09-19 09:52:32,383][root][INFO] - Step: 68/1033  |  Loss: 6.1948  |  Score: -4.42 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:32,943][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-19 09:52:32,943][root][INFO] - Score: 64.25 [%]  |  Evaluation Time: 3.61 [s]
[2024-09-19 09:52:32,944][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-19 09:52:32,945][root][INFO] - 
[9/ 15 Epoch]
[2024-09-19 09:52:35,368][root][INFO] - Step: 555/1033  |  Loss: 0.8398  |  Score: 75.97 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:37,509][root][INFO] - Step: 240/1033  |  Loss: 4.7683  |  Score: 2.18 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:39,679][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 09:52:39,679][root][INFO] - Score: 5.53 [%]  |  Evaluation Time: 7.29 [s]
[2024-09-19 09:52:43,660][root][INFO] - Step: 570/1033  |  Loss: 0.7999  |  Score: 74.14 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:45,114][root][INFO] - Step: 255/1033  |  Loss: 4.4975  |  Score: -0.86 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:46,586][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 09:52:46,586][root][INFO] - Score: -1.56 [%]  |  Evaluation Time: 6.90 [s]
[2024-09-19 09:52:46,587][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 09:52:46,588][root][INFO] - 
[2/ 15 Epoch]
[2024-09-19 09:52:51,941][root][INFO] - Step: 585/1033  |  Loss: 0.8595  |  Score: 69.20 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:52,258][root][INFO] - Step: 75/1033  |  Loss: 6.0948  |  Score: -1.04 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:53,549][root][INFO] - Step: 270/1033  |  Loss: 4.6937  |  Score: -0.17 [%]  |  Seq Length: 128.0
[2024-09-19 09:52:56,844][root][INFO] - Step: 275/1033  |  Loss: 4.6641  |  Score: 0.17 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:00,019][root][INFO] - Step: 600/1033  |  Loss: 0.8158  |  Score: 72.72 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:00,873][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 09:53:00,873][root][INFO] - Score: 5.84 [%]  |  Evaluation Time: 4.02 [s]
[2024-09-19 09:53:02,430][root][INFO] - Step: 90/1033  |  Loss: 6.1270  |  Score: 1.97 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:04,919][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 09:53:04,919][root][INFO] - Score: -2.00 [%]  |  Evaluation Time: 4.04 [s]
[2024-09-19 09:53:04,923][root][INFO] - 
[5/ 15 Epoch]
[2024-09-19 09:53:08,241][root][INFO] - Step: 615/1033  |  Loss: 0.7927  |  Score: 71.38 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:10,549][root][INFO] - Step: 285/1033  |  Loss: 4.4889  |  Score: -0.23 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:10,858][root][INFO] - Step: 619/1033  |  Loss: 0.9441  |  Score: 72.69 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:12,622][root][INFO] - Step: 105/1033  |  Loss: 5.7940  |  Score: 6.53 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:14,544][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-19 09:53:14,545][root][INFO] - Score: 68.74 [%]  |  Evaluation Time: 3.68 [s]
[2024-09-19 09:53:18,088][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-19 09:53:18,088][root][INFO] - Score: 66.56 [%]  |  Evaluation Time: 3.54 [s]
[2024-09-19 09:53:18,090][root][INFO] - 
Save new Best Score (Epoch: 9)
[2024-09-19 09:53:18,091][root][INFO] - 
[10/ 15 Epoch]
[2024-09-19 09:53:19,083][root][INFO] - Step: 300/1033  |  Loss: 4.3360  |  Score: 3.93 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:23,034][root][INFO] - Step: 120/1033  |  Loss: 6.1205  |  Score: -3.43 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:23,875][root][INFO] - Step: 630/1033  |  Loss: 0.8398  |  Score: 71.76 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:27,695][root][INFO] - Step: 315/1033  |  Loss: 4.1249  |  Score: 5.07 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:32,229][root][INFO] - Step: 645/1033  |  Loss: 0.7594  |  Score: 71.62 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:33,287][root][INFO] - Step: 135/1033  |  Loss: 5.3378  |  Score: 7.77 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:35,208][root][INFO] - Step: 137/1033  |  Loss: 5.8812  |  Score: -3.16 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:36,126][root][INFO] - Step: 330/1033  |  Loss: 4.0800  |  Score: -3.31 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:40,122][root][INFO] - Step: 660/1033  |  Loss: 0.7853  |  Score: 71.69 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:40,904][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 09:53:40,905][root][INFO] - Score: 7.10 [%]  |  Evaluation Time: 5.69 [s]
[2024-09-19 09:53:44,438][root][INFO] - Step: 344/1033  |  Loss: 4.1850  |  Score: 1.52 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:46,256][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 09:53:46,256][root][INFO] - Score: -1.47 [%]  |  Evaluation Time: 5.35 [s]
[2024-09-19 09:53:46,258][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 09:53:46,259][root][INFO] - 
[3/ 15 Epoch]
[2024-09-19 09:53:48,159][root][INFO] - Step: 675/1033  |  Loss: 0.7804  |  Score: 75.74 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:48,485][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 09:53:48,485][root][INFO] - Score: 1.61 [%]  |  Evaluation Time: 4.04 [s]
[2024-09-19 09:53:52,351][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 09:53:52,351][root][INFO] - Score: -2.31 [%]  |  Evaluation Time: 3.86 [s]
[2024-09-19 09:53:52,353][root][INFO] - 
[6/ 15 Epoch]
[2024-09-19 09:53:52,957][root][INFO] - Step: 345/1033  |  Loss: 3.8294  |  Score: 14.90 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:54,590][root][INFO] - Step: 150/1033  |  Loss: 4.8769  |  Score: 7.55 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:55,521][root][INFO] - Step: 688/1033  |  Loss: 0.8244  |  Score: 71.28 [%]  |  Seq Length: 128.0
[2024-09-19 09:53:59,180][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-19 09:53:59,180][root][INFO] - Score: 70.70 [%]  |  Evaluation Time: 3.66 [s]
[2024-09-19 09:54:01,281][root][INFO] - Step: 360/1033  |  Loss: 4.0348  |  Score: 6.65 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:02,661][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-19 09:54:02,662][root][INFO] - Score: 63.26 [%]  |  Evaluation Time: 3.48 [s]
[2024-09-19 09:54:02,664][root][INFO] - 
[11/ 15 Epoch]
[2024-09-19 09:54:03,624][root][INFO] - Step: 690/1033  |  Loss: 0.9458  |  Score: 66.05 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:04,780][root][INFO] - Step: 165/1033  |  Loss: 5.3852  |  Score: -3.35 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:09,650][root][INFO] - Step: 375/1033  |  Loss: 3.7172  |  Score: 4.59 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:11,381][root][INFO] - Step: 705/1033  |  Loss: 0.7698  |  Score: 74.92 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:14,577][root][INFO] - Step: 180/1033  |  Loss: 4.8926  |  Score: 3.01 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:17,981][root][INFO] - Step: 390/1033  |  Loss: 3.6551  |  Score: 1.28 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:19,253][root][INFO] - Step: 720/1033  |  Loss: 0.7689  |  Score: 73.02 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:24,706][root][INFO] - Step: 195/1033  |  Loss: 4.8143  |  Score: 4.30 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:26,447][root][INFO] - Step: 405/1033  |  Loss: 3.7659  |  Score: -6.32 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:27,292][root][INFO] - Step: 735/1033  |  Loss: 0.8024  |  Score: 71.99 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:31,228][root][INFO] - Step: 413/1033  |  Loss: 3.5965  |  Score: 0.82 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:32,742][root][INFO] - Step: 206/1033  |  Loss: 4.8324  |  Score: 0.36 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:35,321][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-19 09:54:35,321][root][INFO] - Score: 5.60 [%]  |  Evaluation Time: 4.09 [s]
[2024-09-19 09:54:35,392][root][INFO] - Step: 750/1033  |  Loss: 0.7641  |  Score: 72.16 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:38,434][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 09:54:38,434][root][INFO] - Score: 6.36 [%]  |  Evaluation Time: 5.69 [s]
[2024-09-19 09:54:39,347][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-19 09:54:39,347][root][INFO] - Score: -3.64 [%]  |  Evaluation Time: 4.02 [s]
[2024-09-19 09:54:39,349][root][INFO] - 
[7/ 15 Epoch]
[2024-09-19 09:54:39,636][root][INFO] - Step: 757/1033  |  Loss: 0.7596  |  Score: 72.99 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:43,427][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-19 09:54:43,427][root][INFO] - Score: 71.95 [%]  |  Evaluation Time: 3.79 [s]
[2024-09-19 09:54:43,499][root][INFO] - Step: 420/1033  |  Loss: 3.5008  |  Score: 12.96 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:43,797][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 09:54:43,798][root][INFO] - Score: -1.20 [%]  |  Evaluation Time: 5.36 [s]
[2024-09-19 09:54:43,800][root][INFO] - 
[4/ 15 Epoch]
[2024-09-19 09:54:46,390][root][INFO] - Step: 210/1033  |  Loss: 4.9819  |  Score: 1.33 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:46,907][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-19 09:54:46,908][root][INFO] - Score: 66.66 [%]  |  Evaluation Time: 3.48 [s]
[2024-09-19 09:54:46,910][root][INFO] - 
Save new Best Score (Epoch: 11)
[2024-09-19 09:54:46,912][root][INFO] - 
[12/ 15 Epoch]
[2024-09-19 09:54:51,150][root][INFO] - Step: 765/1033  |  Loss: 0.7101  |  Score: 74.20 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:51,944][root][INFO] - Step: 435/1033  |  Loss: 3.6294  |  Score: 1.70 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:56,792][root][INFO] - Step: 225/1033  |  Loss: 4.3579  |  Score: 5.25 [%]  |  Seq Length: 128.0
[2024-09-19 09:54:58,987][root][INFO] - Step: 780/1033  |  Loss: 0.7841  |  Score: 72.78 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:00,301][root][INFO] - Step: 450/1033  |  Loss: 3.4627  |  Score: 5.00 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:06,531][root][INFO] - Step: 795/1033  |  Loss: 0.8076  |  Score: 74.83 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:07,049][root][INFO] - Step: 240/1033  |  Loss: 4.3791  |  Score: -2.20 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:08,546][root][INFO] - Step: 465/1033  |  Loss: 3.3870  |  Score: -0.34 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:14,461][root][INFO] - Step: 810/1033  |  Loss: 0.7421  |  Score: 72.66 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:16,954][root][INFO] - Step: 255/1033  |  Loss: 3.9663  |  Score: 5.59 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:17,106][root][INFO] - Step: 480/1033  |  Loss: 3.3944  |  Score: 5.86 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:18,418][root][INFO] - Step: 482/1033  |  Loss: 3.1073  |  Score: -1.27 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:22,410][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-19 09:55:22,411][root][INFO] - Score: 6.28 [%]  |  Evaluation Time: 3.99 [s]
[2024-09-19 09:55:22,525][root][INFO] - Step: 825/1033  |  Loss: 0.7451  |  Score: 72.16 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:23,394][root][INFO] - Step: 826/1033  |  Loss: 0.6361  |  Score: 81.29 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:26,301][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-19 09:55:26,301][root][INFO] - Score: -3.50 [%]  |  Evaluation Time: 3.89 [s]
[2024-09-19 09:55:26,304][root][INFO] - 
[8/ 15 Epoch]
[2024-09-19 09:55:26,996][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-19 09:55:26,997][root][INFO] - Score: 68.37 [%]  |  Evaluation Time: 3.60 [s]
[2024-09-19 09:55:27,208][root][INFO] - Step: 270/1033  |  Loss: 3.6468  |  Score: 0.47 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:30,381][root][INFO] - Step: 275/1033  |  Loss: 4.1394  |  Score: 1.60 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:30,452][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-19 09:55:30,452][root][INFO] - Score: 65.03 [%]  |  Evaluation Time: 3.45 [s]
[2024-09-19 09:55:30,454][root][INFO] - 
[13/ 15 Epoch]
[2024-09-19 09:55:33,923][root][INFO] - Step: 495/1033  |  Loss: 3.2067  |  Score: 6.15 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:36,249][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 09:55:36,249][root][INFO] - Score: 2.10 [%]  |  Evaluation Time: 5.86 [s]
[2024-09-19 09:55:37,841][root][INFO] - Step: 840/1033  |  Loss: 0.6958  |  Score: 74.92 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:41,645][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 09:55:41,645][root][INFO] - Score: -2.84 [%]  |  Evaluation Time: 5.39 [s]
[2024-09-19 09:55:41,648][root][INFO] - 
[5/ 15 Epoch]
[2024-09-19 09:55:42,316][root][INFO] - Step: 510/1033  |  Loss: 3.1974  |  Score: -1.52 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:45,847][root][INFO] - Step: 855/1033  |  Loss: 0.7671  |  Score: 73.46 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:47,409][root][INFO] - Step: 285/1033  |  Loss: 3.9947  |  Score: -4.63 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:50,783][root][INFO] - Step: 525/1033  |  Loss: 3.1282  |  Score: 1.99 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:54,218][root][INFO] - Step: 870/1033  |  Loss: 0.7184  |  Score: 75.47 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:56,274][root][INFO] - Step: 300/1033  |  Loss: 3.6947  |  Score: -4.02 [%]  |  Seq Length: 128.0
[2024-09-19 09:55:58,142][root][INFO] - Step: 540/1033  |  Loss: 3.2208  |  Score: 4.93 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:02,371][root][INFO] - Step: 885/1033  |  Loss: 0.7425  |  Score: 75.50 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:04,271][root][INFO] - Step: 551/1033  |  Loss: 3.2982  |  Score: 1.81 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:06,355][root][INFO] - Step: 315/1033  |  Loss: 3.5586  |  Score: 0.90 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:08,097][root][INFO] - Step: 895/1033  |  Loss: 0.7426  |  Score: 74.72 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:08,440][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-19 09:56:08,440][root][INFO] - Score: 3.33 [%]  |  Evaluation Time: 4.17 [s]
[2024-09-19 09:56:11,791][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-19 09:56:11,792][root][INFO] - Score: 70.17 [%]  |  Evaluation Time: 3.69 [s]
[2024-09-19 09:56:12,345][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-19 09:56:12,345][root][INFO] - Score: -1.94 [%]  |  Evaluation Time: 3.90 [s]
[2024-09-19 09:56:12,348][root][INFO] - 
[9/ 15 Epoch]
[2024-09-19 09:56:14,988][root][INFO] - Step: 555/1033  |  Loss: 2.9444  |  Score: 0.08 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:15,660][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-19 09:56:15,660][root][INFO] - Score: 61.70 [%]  |  Evaluation Time: 3.87 [s]
[2024-09-19 09:56:15,662][root][INFO] - 
[14/ 15 Epoch]
[2024-09-19 09:56:16,315][root][INFO] - Step: 330/1033  |  Loss: 2.9103  |  Score: 6.28 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:18,450][root][INFO] - Step: 900/1033  |  Loss: 0.7192  |  Score: 74.01 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:22,922][root][INFO] - Step: 570/1033  |  Loss: 3.2350  |  Score: -3.82 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:26,234][root][INFO] - Step: 915/1033  |  Loss: 0.7457  |  Score: 72.22 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:26,298][root][INFO] - Step: 344/1033  |  Loss: 3.0437  |  Score: 6.92 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:31,335][root][INFO] - Step: 585/1033  |  Loss: 3.0030  |  Score: 3.44 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:31,929][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 09:56:31,929][root][INFO] - Score: 0.87 [%]  |  Evaluation Time: 5.63 [s]
[2024-09-19 09:56:34,454][root][INFO] - Step: 930/1033  |  Loss: 0.6895  |  Score: 74.83 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:37,216][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 09:56:37,216][root][INFO] - Score: -3.26 [%]  |  Evaluation Time: 5.28 [s]
[2024-09-19 09:56:37,218][root][INFO] - 
[6/ 15 Epoch]
[2024-09-19 09:56:37,896][root][INFO] - Step: 345/1033  |  Loss: 4.0986  |  Score: 1.73 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:39,547][root][INFO] - Step: 600/1033  |  Loss: 3.0244  |  Score: 4.13 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:42,536][root][INFO] - Step: 945/1033  |  Loss: 0.6923  |  Score: 76.28 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:47,360][root][INFO] - Step: 360/1033  |  Loss: 3.0812  |  Score: -0.90 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:48,062][root][INFO] - Step: 615/1033  |  Loss: 3.0629  |  Score: 1.84 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:50,474][root][INFO] - Step: 960/1033  |  Loss: 0.6961  |  Score: 75.43 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:50,918][root][INFO] - Step: 619/1033  |  Loss: 2.8702  |  Score: 1.69 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:52,776][root][INFO] - Step: 964/1033  |  Loss: 0.6864  |  Score: 77.40 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:54,980][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-19 09:56:54,980][root][INFO] - Score: 4.90 [%]  |  Evaluation Time: 4.06 [s]
[2024-09-19 09:56:56,407][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-19 09:56:56,407][root][INFO] - Score: 69.98 [%]  |  Evaluation Time: 3.63 [s]
[2024-09-19 09:56:57,656][root][INFO] - Step: 375/1033  |  Loss: 2.8478  |  Score: 6.67 [%]  |  Seq Length: 128.0
[2024-09-19 09:56:58,917][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-19 09:56:58,918][root][INFO] - Score: -3.42 [%]  |  Evaluation Time: 3.94 [s]
[2024-09-19 09:56:58,920][root][INFO] - 
[10/ 15 Epoch]
[2024-09-19 09:56:59,951][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-19 09:56:59,952][root][INFO] - Score: 63.63 [%]  |  Evaluation Time: 3.54 [s]
[2024-09-19 09:56:59,957][root][INFO] - 
[15/ 15 Epoch]
[2024-09-19 09:57:04,847][root][INFO] - Step: 630/1033  |  Loss: 2.9836  |  Score: -1.45 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:06,040][root][INFO] - Step: 975/1033  |  Loss: 0.6025  |  Score: 80.59 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:07,647][root][INFO] - Step: 390/1033  |  Loss: 2.7917  |  Score: 3.28 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:13,235][root][INFO] - Step: 990/1033  |  Loss: 0.7344  |  Score: 77.41 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:13,282][root][INFO] - Step: 645/1033  |  Loss: 3.0641  |  Score: -0.05 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:17,731][root][INFO] - Step: 405/1033  |  Loss: 2.8825  |  Score: 1.20 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:21,261][root][INFO] - Step: 1005/1033  |  Loss: 0.6655  |  Score: 76.26 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:21,621][root][INFO] - Step: 660/1033  |  Loss: 2.9266  |  Score: 6.63 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:23,390][root][INFO] - Step: 413/1033  |  Loss: 3.0610  |  Score: 4.85 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:29,032][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-19 09:57:29,032][root][INFO] - Score: 5.93 [%]  |  Evaluation Time: 5.64 [s]
[2024-09-19 09:57:29,312][root][INFO] - Step: 1020/1033  |  Loss: 0.7397  |  Score: 74.03 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:30,104][root][INFO] - Step: 675/1033  |  Loss: 2.8487  |  Score: 7.10 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:34,434][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-19 09:57:34,435][root][INFO] - Score: -5.95 [%]  |  Evaluation Time: 5.40 [s]
[2024-09-19 09:57:34,436][root][INFO] - 
[7/ 15 Epoch]
[2024-09-19 09:57:36,331][root][INFO] - Step: 1033/1033  |  Loss: 0.6881  |  Score: 73.72 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:37,754][root][INFO] - Step: 688/1033  |  Loss: 2.8152  |  Score: 7.58 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:39,266][root][INFO] - Step: 420/1033  |  Loss: 2.6592  |  Score: 2.62 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:39,993][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-19 09:57:39,993][root][INFO] - Score: 71.86 [%]  |  Evaluation Time: 3.66 [s]
[2024-09-19 09:57:41,764][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-19 09:57:41,764][root][INFO] - Score: 7.48 [%]  |  Evaluation Time: 4.01 [s]
[2024-09-19 09:57:43,542][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-19 09:57:43,543][root][INFO] - Score: 64.86 [%]  |  Evaluation Time: 3.55 [s]
[2024-09-19 09:57:43,544][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 09:57:43,544][root][INFO] - - Epoch: 11
[2024-09-19 09:57:43,545][root][INFO] - - DEV score: 71.95 [%]
[2024-09-19 09:57:43,545][root][INFO] - - TEST score: 66.66 [%]
[2024-09-19 09:57:43,546][root][INFO] - Fine-tuning is done!
[2024-09-19 09:57:45,766][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-19 09:57:45,767][root][INFO] - Score: -3.35 [%]  |  Evaluation Time: 4.00 [s]
[2024-09-19 09:57:45,769][root][INFO] - 
[11/ 15 Epoch]
[2024-09-19 09:57:46,510][root][INFO] - Step: 690/1033  |  Loss: 2.9369  |  Score: 1.96 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:49,339][root][INFO] - Step: 435/1033  |  Loss: 2.8087  |  Score: 5.30 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:54,062][root][INFO] - Step: 705/1033  |  Loss: 2.9657  |  Score: 2.51 [%]  |  Seq Length: 128.0
[2024-09-19 09:57:59,362][root][INFO] - Step: 450/1033  |  Loss: 2.8269  |  Score: 1.86 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:02,497][root][INFO] - Step: 720/1033  |  Loss: 2.8984  |  Score: 3.78 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:09,233][root][INFO] - Step: 465/1033  |  Loss: 2.7663  |  Score: 2.26 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:10,602][root][INFO] - Step: 735/1033  |  Loss: 2.7246  |  Score: 1.40 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:18,206][root][INFO] - Step: 750/1033  |  Loss: 2.8062  |  Score: 3.80 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:19,068][root][INFO] - Step: 480/1033  |  Loss: 2.7933  |  Score: 5.39 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:20,482][root][INFO] - Step: 482/1033  |  Loss: 2.6748  |  Score: 10.01 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:22,383][root][INFO] - Step: 757/1033  |  Loss: 2.7449  |  Score: -0.32 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:26,015][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-19 09:58:26,015][root][INFO] - Score: 5.71 [%]  |  Evaluation Time: 5.53 [s]
[2024-09-19 09:58:26,367][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-19 09:58:26,368][root][INFO] - Score: 4.63 [%]  |  Evaluation Time: 3.98 [s]
[2024-09-19 09:58:30,174][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-19 09:58:30,175][root][INFO] - Score: -5.10 [%]  |  Evaluation Time: 3.80 [s]
[2024-09-19 09:58:30,177][root][INFO] - 
[12/ 15 Epoch]
[2024-09-19 09:58:31,274][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-19 09:58:31,275][root][INFO] - Score: -1.76 [%]  |  Evaluation Time: 5.26 [s]
[2024-09-19 09:58:31,277][root][INFO] - 
[8/ 15 Epoch]
[2024-09-19 09:58:34,505][root][INFO] - Step: 765/1033  |  Loss: 2.7285  |  Score: 11.60 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:39,951][root][INFO] - Step: 495/1033  |  Loss: 2.7532  |  Score: -0.31 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:42,794][root][INFO] - Step: 780/1033  |  Loss: 2.6711  |  Score: 4.26 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:49,923][root][INFO] - Step: 510/1033  |  Loss: 2.6058  |  Score: 7.33 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:50,802][root][INFO] - Step: 795/1033  |  Loss: 2.8625  |  Score: 1.56 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:58,999][root][INFO] - Step: 810/1033  |  Loss: 2.8589  |  Score: 1.83 [%]  |  Seq Length: 128.0
[2024-09-19 09:58:59,851][root][INFO] - Step: 525/1033  |  Loss: 2.7174  |  Score: 4.97 [%]  |  Seq Length: 128.0
[2024-09-19 09:59:06,431][root][INFO] - Step: 825/1033  |  Loss: 2.8063  |  Score: 3.70 [%]  |  Seq Length: 128.0
[2024-09-19 09:59:07,300][root][INFO] - Step: 826/1033  |  Loss: 2.7263  |  Score: 3.88 [%]  |  Seq Length: 128.0
[2024-09-19 09:59:10,135][root][INFO] - Step: 540/1033  |  Loss: 2.8168  |  Score: 0.86 [%]  |  Seq Length: 128.0
[2024-09-19 09:59:11,288][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-19 09:59:11,288][root][INFO] - Score: 7.68 [%]  |  Evaluation Time: 3.98 [s]
[2024-09-19 09:59:15,145][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-19 09:59:15,145][root][INFO] - Score: -2.41 [%]  |  Evaluation Time: 3.85 [s]
[2024-09-19 09:59:15,147][root][INFO] - 
[13/ 15 Epoch]
[2024-09-19 09:59:17,623][root][INFO] - Step: 551/1033  |  Loss: 2.8515  |  Score: 3.94 [%]  |  Seq Length: 128.0
[2024-09-19 09:59:21,881][root][INFO] - Step: 840/1033  |  Loss: 2.9026  |  Score: -1.09 [%]  |  Seq Length: 128.0
[2024-09-19 09:59:23,117][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-19 09:59:23,117][root][INFO] - Score: 2.49 [%]  |  Evaluation Time: 5.49 [s]
[2024-09-19 09:59:28,358][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-19 09:59:28,358][root][INFO] - Score: -4.99 [%]  |  Evaluation Time: 5.24 [s]
[2024-09-19 09:59:28,360][root][INFO] - 
[9/ 15 Epoch]
[2024-09-19 09:59:29,367][root][INFO] - Step: 855/1033  |  Loss: 2.6870  |  Score: 6.75 [%]  |  Seq Length: 128.0
[2024-09-19 09:59:31,280][root][INFO] - Step: 555/1033  |  Loss: 2.9109  |  Score: 3.27 [%]  |  Seq Length: 128.0
[2024-09-19 09:59:37,482][root][INFO] - Step: 870/1033  |  Loss: 2.7040  |  Score: 4.59 [%]  |  Seq Length: 128.0
[2024-09-19 09:59:41,101][root][INFO] - Step: 570/1033  |  Loss: 2.8248  |  Score: -1.36 [%]  |  Seq Length: 128.0
[2024-09-19 09:59:45,890][root][INFO] - Step: 885/1033  |  Loss: 2.6090  |  Score: 5.51 [%]  |  Seq Length: 128.0
[2024-09-19 09:59:51,243][root][INFO] - Step: 585/1033  |  Loss: 2.5388  |  Score: 9.20 [%]  |  Seq Length: 128.0
[2024-09-19 09:59:51,456][root][INFO] - Step: 895/1033  |  Loss: 2.8643  |  Score: 2.06 [%]  |  Seq Length: 128.0
[2024-09-19 09:59:55,548][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-19 09:59:55,548][root][INFO] - Score: 6.92 [%]  |  Evaluation Time: 4.09 [s]
[2024-09-19 09:59:59,475][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-19 09:59:59,476][root][INFO] - Score: -0.97 [%]  |  Evaluation Time: 3.92 [s]
[2024-09-19 09:59:59,477][root][INFO] - 
Save new Best Score (Epoch: 13)
[2024-09-19 09:59:59,479][root][INFO] - 
[14/ 15 Epoch]
[2024-09-19 10:00:01,342][root][INFO] - Step: 600/1033  |  Loss: 2.7516  |  Score: 4.42 [%]  |  Seq Length: 128.0
[2024-09-19 10:00:02,343][root][INFO] - Step: 900/1033  |  Loss: 2.6980  |  Score: -6.64 [%]  |  Seq Length: 128.0
[2024-09-19 10:00:09,898][root][INFO] - Step: 915/1033  |  Loss: 2.6152  |  Score: 9.53 [%]  |  Seq Length: 128.0
[2024-09-19 10:00:10,992][root][INFO] - Step: 615/1033  |  Loss: 2.5421  |  Score: 9.60 [%]  |  Seq Length: 128.0
[2024-09-19 10:00:14,327][root][INFO] - Step: 619/1033  |  Loss: 2.3272  |  Score: 12.49 [%]  |  Seq Length: 128.0
[2024-09-19 10:00:18,401][root][INFO] - Step: 930/1033  |  Loss: 2.7094  |  Score: 8.98 [%]  |  Seq Length: 128.0
[2024-09-19 10:00:19,805][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-19 10:00:19,805][root][INFO] - Score: 0.91 [%]  |  Evaluation Time: 5.47 [s]
[2024-09-19 10:00:24,998][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-19 10:00:24,998][root][INFO] - Score: -4.40 [%]  |  Evaluation Time: 5.19 [s]
[2024-09-19 10:00:25,000][root][INFO] - 
[10/ 15 Epoch]
[2024-09-19 10:00:26,830][root][INFO] - Step: 945/1033  |  Loss: 2.8150  |  Score: 3.56 [%]  |  Seq Length: 128.0
[2024-09-19 10:00:32,069][root][INFO] - Step: 630/1033  |  Loss: 2.6507  |  Score: 6.12 [%]  |  Seq Length: 128.0
[2024-09-19 10:00:35,147][root][INFO] - Step: 960/1033  |  Loss: 2.7436  |  Score: 2.07 [%]  |  Seq Length: 128.0
[2024-09-19 10:00:37,586][root][INFO] - Step: 964/1033  |  Loss: 2.7660  |  Score: 4.72 [%]  |  Seq Length: 128.0
[2024-09-19 10:00:41,656][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-19 10:00:41,656][root][INFO] - Score: 8.10 [%]  |  Evaluation Time: 4.07 [s]
[2024-09-19 10:00:42,135][root][INFO] - Step: 645/1033  |  Loss: 2.6027  |  Score: 7.02 [%]  |  Seq Length: 128.0
[2024-09-19 10:00:45,441][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-19 10:00:45,442][root][INFO] - Score: -1.38 [%]  |  Evaluation Time: 3.78 [s]
[2024-09-19 10:00:45,442][root][INFO] - 
Save new Best Score (Epoch: 14)
[2024-09-19 10:00:45,443][root][INFO] - 
[15/ 15 Epoch]
[2024-09-19 10:00:51,585][root][INFO] - Step: 975/1033  |  Loss: 2.9009  |  Score: 3.27 [%]  |  Seq Length: 128.0
[2024-09-19 10:00:51,945][root][INFO] - Step: 660/1033  |  Loss: 2.5760  |  Score: 7.13 [%]  |  Seq Length: 128.0
[2024-09-19 10:00:59,685][root][INFO] - Step: 990/1033  |  Loss: 2.7218  |  Score: 7.79 [%]  |  Seq Length: 128.0
[2024-09-19 10:01:02,089][root][INFO] - Step: 675/1033  |  Loss: 2.5976  |  Score: 8.07 [%]  |  Seq Length: 128.0
[2024-09-19 10:01:07,672][root][INFO] - Step: 1005/1033  |  Loss: 2.8011  |  Score: 2.49 [%]  |  Seq Length: 128.0
[2024-09-19 10:01:11,202][root][INFO] - Step: 688/1033  |  Loss: 2.6665  |  Score: 5.98 [%]  |  Seq Length: 128.0
[2024-09-19 10:01:15,839][root][INFO] - Step: 1020/1033  |  Loss: 2.7291  |  Score: 2.35 [%]  |  Seq Length: 128.0
[2024-09-19 10:01:16,733][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-19 10:01:16,733][root][INFO] - Score: 8.98 [%]  |  Evaluation Time: 5.53 [s]
[2024-09-19 10:01:22,029][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-19 10:01:22,030][root][INFO] - Score: -1.50 [%]  |  Evaluation Time: 5.29 [s]
[2024-09-19 10:01:22,031][root][INFO] - 
Save new Best Score (Epoch: 10)
[2024-09-19 10:01:22,032][root][INFO] - 
[11/ 15 Epoch]
[2024-09-19 10:01:23,068][root][INFO] - Step: 1033/1033  |  Loss: 2.6075  |  Score: 5.40 [%]  |  Seq Length: 128.0
[2024-09-19 10:01:23,069][root][INFO] - Step: 690/1033  |  Loss: 2.5632  |  Score: 7.31 [%]  |  Seq Length: 128.0
[2024-09-19 10:01:26,985][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-19 10:01:26,985][root][INFO] - Score: 5.67 [%]  |  Evaluation Time: 3.91 [s]
[2024-09-19 10:01:30,756][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-19 10:01:30,757][root][INFO] - Score: -3.58 [%]  |  Evaluation Time: 3.77 [s]
[2024-09-19 10:01:30,758][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 10:01:30,758][root][INFO] - - Epoch: 14
[2024-09-19 10:01:30,758][root][INFO] - - DEV score: 8.10 [%]
[2024-09-19 10:01:30,758][root][INFO] - - TEST score: -1.38 [%]
[2024-09-19 10:01:30,759][root][INFO] - Fine-tuning is done!
[2024-09-19 10:01:33,120][root][INFO] - Step: 705/1033  |  Loss: 2.5511  |  Score: 9.51 [%]  |  Seq Length: 128.0
[2024-09-19 10:01:42,706][root][INFO] - Step: 720/1033  |  Loss: 2.5823  |  Score: 9.47 [%]  |  Seq Length: 128.0
[2024-09-19 10:01:52,406][root][INFO] - Step: 735/1033  |  Loss: 2.7269  |  Score: 7.95 [%]  |  Seq Length: 128.0
[2024-09-19 10:02:02,057][root][INFO] - Step: 750/1033  |  Loss: 2.5804  |  Score: 8.58 [%]  |  Seq Length: 128.0
[2024-09-19 10:02:07,026][root][INFO] - Step: 757/1033  |  Loss: 2.3835  |  Score: 8.92 [%]  |  Seq Length: 128.0
[2024-09-19 10:02:12,377][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-19 10:02:12,377][root][INFO] - Score: 8.21 [%]  |  Evaluation Time: 5.35 [s]
[2024-09-19 10:02:17,520][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-19 10:02:17,520][root][INFO] - Score: 2.13 [%]  |  Evaluation Time: 5.14 [s]
[2024-09-19 10:02:17,521][root][INFO] - 
Save new Best Score (Epoch: 11)
[2024-09-19 10:02:17,522][root][INFO] - 
[12/ 15 Epoch]
[2024-09-19 10:02:22,551][root][INFO] - Step: 765/1033  |  Loss: 2.7436  |  Score: 0.38 [%]  |  Seq Length: 128.0
[2024-09-19 10:02:32,426][root][INFO] - Step: 780/1033  |  Loss: 2.4733  |  Score: 8.74 [%]  |  Seq Length: 128.0
[2024-09-19 10:02:42,213][root][INFO] - Step: 795/1033  |  Loss: 2.5869  |  Score: 9.44 [%]  |  Seq Length: 128.0
[2024-09-19 10:02:51,988][root][INFO] - Step: 810/1033  |  Loss: 2.6459  |  Score: 3.10 [%]  |  Seq Length: 128.0
[2024-09-19 10:03:01,777][root][INFO] - Step: 825/1033  |  Loss: 2.4534  |  Score: 11.43 [%]  |  Seq Length: 128.0
[2024-09-19 10:03:02,790][root][INFO] - Step: 826/1033  |  Loss: 2.4785  |  Score: 9.43 [%]  |  Seq Length: 128.0
[2024-09-19 10:03:08,232][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-19 10:03:08,233][root][INFO] - Score: 4.60 [%]  |  Evaluation Time: 5.44 [s]
[2024-09-19 10:03:13,408][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-19 10:03:13,408][root][INFO] - Score: 0.94 [%]  |  Evaluation Time: 5.17 [s]
[2024-09-19 10:03:13,410][root][INFO] - 
[13/ 15 Epoch]
[2024-09-19 10:03:22,665][root][INFO] - Step: 840/1033  |  Loss: 2.6163  |  Score: 8.69 [%]  |  Seq Length: 128.0
[2024-09-19 10:03:32,563][root][INFO] - Step: 855/1033  |  Loss: 2.5700  |  Score: 9.40 [%]  |  Seq Length: 128.0
[2024-09-19 10:03:42,509][root][INFO] - Step: 870/1033  |  Loss: 2.4217  |  Score: 8.17 [%]  |  Seq Length: 128.0
[2024-09-19 10:03:52,370][root][INFO] - Step: 885/1033  |  Loss: 2.5803  |  Score: 8.06 [%]  |  Seq Length: 128.0
[2024-09-19 10:03:59,353][root][INFO] - Step: 895/1033  |  Loss: 2.5452  |  Score: 7.52 [%]  |  Seq Length: 128.0
[2024-09-19 10:04:04,756][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-19 10:04:04,756][root][INFO] - Score: 9.86 [%]  |  Evaluation Time: 5.40 [s]
[2024-09-19 10:04:09,861][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-19 10:04:09,861][root][INFO] - Score: 0.69 [%]  |  Evaluation Time: 5.10 [s]
[2024-09-19 10:04:09,862][root][INFO] - 
Save new Best Score (Epoch: 13)
[2024-09-19 10:04:09,863][root][INFO] - 
[14/ 15 Epoch]
[2024-09-19 10:04:13,161][root][INFO] - Step: 900/1033  |  Loss: 2.5669  |  Score: 9.49 [%]  |  Seq Length: 128.0
[2024-09-19 10:04:23,000][root][INFO] - Step: 915/1033  |  Loss: 2.4554  |  Score: 7.69 [%]  |  Seq Length: 128.0
[2024-09-19 10:04:32,935][root][INFO] - Step: 930/1033  |  Loss: 2.5846  |  Score: 11.55 [%]  |  Seq Length: 128.0
[2024-09-19 10:04:43,068][root][INFO] - Step: 945/1033  |  Loss: 2.4898  |  Score: 10.09 [%]  |  Seq Length: 128.0
[2024-09-19 10:04:53,218][root][INFO] - Step: 960/1033  |  Loss: 2.6222  |  Score: 6.26 [%]  |  Seq Length: 128.0
[2024-09-19 10:04:56,085][root][INFO] - Step: 964/1033  |  Loss: 2.4740  |  Score: 5.38 [%]  |  Seq Length: 128.0
[2024-09-19 10:05:01,593][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-19 10:05:01,593][root][INFO] - Score: 8.46 [%]  |  Evaluation Time: 5.50 [s]
[2024-09-19 10:05:06,798][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-19 10:05:06,798][root][INFO] - Score: 2.15 [%]  |  Evaluation Time: 5.20 [s]
[2024-09-19 10:05:06,799][root][INFO] - 
Save new Best Score (Epoch: 14)
[2024-09-19 10:05:06,801][root][INFO] - 
[15/ 15 Epoch]
[2024-09-19 10:05:13,933][root][INFO] - Step: 975/1033  |  Loss: 2.6149  |  Score: 5.04 [%]  |  Seq Length: 128.0
[2024-09-19 10:05:23,958][root][INFO] - Step: 990/1033  |  Loss: 2.7164  |  Score: 0.86 [%]  |  Seq Length: 128.0
[2024-09-19 10:05:33,338][root][INFO] - Step: 1005/1033  |  Loss: 2.6377  |  Score: 6.61 [%]  |  Seq Length: 128.0
[2024-09-19 10:05:43,181][root][INFO] - Step: 1020/1033  |  Loss: 2.4797  |  Score: 11.42 [%]  |  Seq Length: 128.0
[2024-09-19 10:05:52,037][root][INFO] - Step: 1033/1033  |  Loss: 2.3558  |  Score: 16.70 [%]  |  Seq Length: 128.0
[2024-09-19 10:05:57,497][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-19 10:05:57,498][root][INFO] - Score: 5.67 [%]  |  Evaluation Time: 5.46 [s]
[2024-09-19 10:06:02,602][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-19 10:06:02,602][root][INFO] - Score: 1.91 [%]  |  Evaluation Time: 5.10 [s]
[2024-09-19 10:06:02,603][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 10:06:02,603][root][INFO] - - Epoch: 14
[2024-09-19 10:06:02,603][root][INFO] - - DEV score: 8.46 [%]
[2024-09-19 10:06:02,603][root][INFO] - - TEST score: 2.15 [%]
[2024-09-19 10:06:02,604][root][INFO] - Fine-tuning is done!
[2024-09-19 10:36:10,076][root][INFO] - 

[2024-09-19 10:36:10,076][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 10:36:10,076][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs
[2024-09-19 10:36:10,077][root][INFO] - 

[2024-09-19 10:36:10,077][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 128, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 5e-05, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 4, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 10:36:20,051][root][INFO] - 

[2024-09-19 10:36:20,051][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 10:36:20,051][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs
[2024-09-19 10:36:20,051][root][INFO] - 

[2024-09-19 10:36:20,051][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 128, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 5e-05, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 4, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 10:36:35,216][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 10:36:37,163][root][INFO] - 

[2024-09-19 10:36:37,163][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-19 10:36:37,163][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 10:36:37,171][root][INFO] - vocab size              : 51200
[2024-09-19 10:36:37,171][root][INFO] - device                  : gpu
[2024-09-19 10:36:37,171][root][INFO] - random seed             : 42
[2024-09-19 10:36:37,171][root][INFO] - train data size         : 28864
[2024-09-19 10:36:37,171][root][INFO] - max epochs              : 5
[2024-09-19 10:36:37,171][root][INFO] - total steps             : 9020
[2024-09-19 10:36:37,172][root][INFO] - warmup steps            : 902
[2024-09-19 10:36:37,172][root][INFO] - batch size              : 64
[2024-09-19 10:36:37,172][root][INFO] - accumulation steps      : 4
[2024-09-19 10:36:37,172][root][INFO] - optimizer               : adamwscale
[2024-09-19 10:36:37,172][root][INFO] - lr_scheduler            : cosine
[2024-09-19 10:36:37,172][root][INFO] - learning rate           : 5e-05
[2024-09-19 10:36:37,172][root][INFO] - max length              : 128

[2024-09-19 10:36:37,172][root][INFO] - 

[2024-09-19 10:36:37,172][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs
[2024-09-19 10:36:37,172][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs/ckpt
[2024-09-19 10:36:37,172][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs/tb
[2024-09-19 10:36:37,173][root][INFO] - * tb interval           : 100

[2024-09-19 10:36:37,173][root][INFO] - 

[2024-09-19 10:36:37,173][root][INFO] - Start the Training !
[2024-09-19 10:36:37,175][root][INFO] - 
[1/ 5 Epoch]
[2024-09-19 10:36:37,946][root][INFO] - 

[2024-09-19 10:36:37,946][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 10:36:37,946][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs
[2024-09-19 10:36:37,946][root][INFO] - 

[2024-09-19 10:36:37,946][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 128, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 5e-05, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 4, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 10:36:45,184][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-19 10:36:45,185][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-19 10:36:45,185][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-19 10:36:45,186][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-19 10:36:45,186][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-19 10:36:45,186][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-19 10:36:45,187][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-19 10:36:45,187][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-19 10:36:45,188][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-19 10:36:45,188][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-19 10:36:45,188][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-19 10:36:45,189][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-19 10:36:45,189][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-19 10:36:45,190][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-19 10:36:45,190][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-19 10:36:45,190][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-19 10:36:45,191][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-19 10:36:45,191][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-19 10:36:45,192][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-19 10:36:45,192][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-19 10:36:45,193][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-19 10:36:45,193][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-19 10:36:45,193][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-19 10:36:45,194][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-19 10:36:45,196][root][INFO] - Trainable params: 884736 || all params: 126050304 || trainable: 0.70 %
[2024-09-19 10:36:45,372][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 10:36:47,272][root][INFO] - 

[2024-09-19 10:36:47,273][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-19 10:36:47,273][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 10:36:47,281][root][INFO] - vocab size              : 51200
[2024-09-19 10:36:47,281][root][INFO] - device                  : gpu
[2024-09-19 10:36:47,281][root][INFO] - random seed             : 42
[2024-09-19 10:36:47,281][root][INFO] - train data size         : 28864
[2024-09-19 10:36:47,281][root][INFO] - max epochs              : 5
[2024-09-19 10:36:47,281][root][INFO] - total steps             : 9020
[2024-09-19 10:36:47,281][root][INFO] - warmup steps            : 902
[2024-09-19 10:36:47,281][root][INFO] - batch size              : 64
[2024-09-19 10:36:47,282][root][INFO] - accumulation steps      : 4
[2024-09-19 10:36:47,282][root][INFO] - optimizer               : adamwscale
[2024-09-19 10:36:47,282][root][INFO] - lr_scheduler            : cosine
[2024-09-19 10:36:47,282][root][INFO] - learning rate           : 5e-05
[2024-09-19 10:36:47,282][root][INFO] - max length              : 128

[2024-09-19 10:36:47,282][root][INFO] - LoRA Configuration
[2024-09-19 10:36:47,282][root][INFO] - ㄴ r                    : 16
[2024-09-19 10:36:47,282][root][INFO] - ㄴ alpha                : 64
[2024-09-19 10:36:47,282][root][INFO] - ㄴ dropout              : 0.03

[2024-09-19 10:36:47,282][root][INFO] - 

[2024-09-19 10:36:47,282][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs
[2024-09-19 10:36:47,283][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs/ckpt
[2024-09-19 10:36:47,283][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs/tb
[2024-09-19 10:36:47,283][root][INFO] - * tb interval           : 100

[2024-09-19 10:36:47,283][root][INFO] - 

[2024-09-19 10:36:47,283][root][INFO] - Start the Training !
[2024-09-19 10:36:47,286][root][INFO] - 
[1/ 5 Epoch]
[2024-09-19 10:37:02,406][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-19 10:37:02,406][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-19 10:37:02,407][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-19 10:37:02,407][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-19 10:37:02,408][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-19 10:37:02,408][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-19 10:37:02,408][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-19 10:37:02,409][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-19 10:37:02,409][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-19 10:37:02,409][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-19 10:37:02,410][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-19 10:37:02,410][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-19 10:37:02,411][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-19 10:37:02,411][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-19 10:37:02,412][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-19 10:37:02,412][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-19 10:37:02,412][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-19 10:37:02,413][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-19 10:37:02,413][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-19 10:37:02,414][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-19 10:37:02,414][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-19 10:37:02,414][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-19 10:37:02,415][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-19 10:37:02,415][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-19 10:37:02,417][root][INFO] - Trainable params: 884736 || all params: 126050304 || trainable: 0.70 %
[2024-09-19 10:37:02,422][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-19 10:37:02,428][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-19 10:37:02,430][root][INFO] - Trainable params: 1298304 || all params: 126463872 || trainable: 1.03 %
[2024-09-19 10:37:02,606][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 10:37:04,784][root][INFO] - 

[2024-09-19 10:37:04,784][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-19 10:37:04,785][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 10:37:04,794][root][INFO] - vocab size              : 51200
[2024-09-19 10:37:04,794][root][INFO] - device                  : gpu
[2024-09-19 10:37:04,794][root][INFO] - random seed             : 42
[2024-09-19 10:37:04,794][root][INFO] - train data size         : 28864
[2024-09-19 10:37:04,794][root][INFO] - max epochs              : 5
[2024-09-19 10:37:04,794][root][INFO] - total steps             : 9020
[2024-09-19 10:37:04,794][root][INFO] - warmup steps            : 902
[2024-09-19 10:37:04,795][root][INFO] - batch size              : 64
[2024-09-19 10:37:04,795][root][INFO] - accumulation steps      : 4
[2024-09-19 10:37:04,795][root][INFO] - optimizer               : adamwscale
[2024-09-19 10:37:04,795][root][INFO] - lr_scheduler            : cosine
[2024-09-19 10:37:04,795][root][INFO] - learning rate           : 5e-05
[2024-09-19 10:37:04,795][root][INFO] - max length              : 128

[2024-09-19 10:37:04,795][root][INFO] - LoRA Configuration
[2024-09-19 10:37:04,795][root][INFO] - ㄴ r                    : 16
[2024-09-19 10:37:04,795][root][INFO] - ㄴ alpha                : 64
[2024-09-19 10:37:04,795][root][INFO] - ㄴ dropout              : 0.03

[2024-09-19 10:37:04,795][root][INFO] - KOMBO Configuration
[2024-09-19 10:37:04,795][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-19 10:37:04,796][root][INFO] - ㄴ reducer              : linear
[2024-09-19 10:37:04,796][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-19 10:37:04,796][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-19 10:37:04,796][root][INFO] - ㄴ do_combination       : False
[2024-09-19 10:37:04,796][root][INFO] - 

[2024-09-19 10:37:04,796][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs
[2024-09-19 10:37:04,796][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs/ckpt
[2024-09-19 10:37:04,796][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_5e-05lr_42rs/tb
[2024-09-19 10:37:04,796][root][INFO] - * tb interval           : 100

[2024-09-19 10:37:04,796][root][INFO] - 

[2024-09-19 10:37:04,796][root][INFO] - Start the Training !
[2024-09-19 10:37:04,799][root][INFO] - 
[1/ 5 Epoch]
[2024-09-19 10:37:10,750][root][INFO] - Step: 100/9020  |  Loss: 0.7038  |  Score: 59.41 [%]  |  Seq Length: 128.0
[2024-09-19 10:37:17,830][root][INFO] - Step: 100/9020  |  Loss: 0.9553  |  Score: 48.53 [%]  |  Seq Length: 128.0
[2024-09-19 10:37:41,929][root][INFO] - Step: 200/9020  |  Loss: 0.5332  |  Score: 74.34 [%]  |  Seq Length: 128.0
[2024-09-19 10:37:45,551][root][INFO] - Step: 200/9020  |  Loss: 0.9379  |  Score: 46.94 [%]  |  Seq Length: 128.0
[2024-09-19 10:37:47,241][root][INFO] - Step: 100/9020  |  Loss: 0.9631  |  Score: 47.75 [%]  |  Seq Length: 128.0
[2024-09-19 10:38:12,544][root][INFO] - Step: 300/9020  |  Loss: 0.4663  |  Score: 78.41 [%]  |  Seq Length: 128.0
[2024-09-19 10:38:14,299][root][INFO] - Step: 300/9020  |  Loss: 0.8871  |  Score: 47.05 [%]  |  Seq Length: 128.0
[2024-09-19 10:38:26,868][root][INFO] - Step: 200/9020  |  Loss: 0.9255  |  Score: 47.17 [%]  |  Seq Length: 128.0
[2024-09-19 10:38:43,146][root][INFO] - Step: 400/9020  |  Loss: 0.8638  |  Score: 46.30 [%]  |  Seq Length: 128.0
[2024-09-19 10:38:43,255][root][INFO] - Step: 400/9020  |  Loss: 0.4260  |  Score: 80.80 [%]  |  Seq Length: 128.0
[2024-09-19 10:39:07,136][root][INFO] - Step: 300/9020  |  Loss: 0.8873  |  Score: 46.97 [%]  |  Seq Length: 128.0
[2024-09-19 10:39:11,922][root][INFO] - Step: 500/9020  |  Loss: 0.8241  |  Score: 48.08 [%]  |  Seq Length: 128.0
[2024-09-19 10:39:13,381][root][INFO] - Step: 500/9020  |  Loss: 0.4129  |  Score: 81.75 [%]  |  Seq Length: 128.0
[2024-09-19 10:39:39,839][root][INFO] - Step: 600/9020  |  Loss: 0.8222  |  Score: 47.69 [%]  |  Seq Length: 128.0
[2024-09-19 10:39:43,000][root][INFO] - Step: 600/9020  |  Loss: 0.3989  |  Score: 82.16 [%]  |  Seq Length: 128.0
[2024-09-19 10:39:47,789][root][INFO] - Step: 400/9020  |  Loss: 0.8704  |  Score: 46.45 [%]  |  Seq Length: 128.0
[2024-09-19 10:40:08,496][root][INFO] - Step: 700/9020  |  Loss: 0.8189  |  Score: 47.89 [%]  |  Seq Length: 128.0
[2024-09-19 10:40:11,336][root][INFO] - Step: 700/9020  |  Loss: 0.3939  |  Score: 82.16 [%]  |  Seq Length: 128.0
[2024-09-19 10:40:26,718][root][INFO] - Step: 500/9020  |  Loss: 0.8420  |  Score: 46.78 [%]  |  Seq Length: 128.0
[2024-09-19 10:40:37,443][root][INFO] - Step: 800/9020  |  Loss: 0.7933  |  Score: 49.88 [%]  |  Seq Length: 128.0
[2024-09-19 10:40:41,942][root][INFO] - Step: 800/9020  |  Loss: 0.3746  |  Score: 83.86 [%]  |  Seq Length: 128.0
[2024-09-19 10:41:06,035][root][INFO] - Step: 900/9020  |  Loss: 0.7866  |  Score: 49.98 [%]  |  Seq Length: 128.0
[2024-09-19 10:41:07,227][root][INFO] - Step: 600/9020  |  Loss: 0.8216  |  Score: 47.62 [%]  |  Seq Length: 128.0
[2024-09-19 10:41:12,360][root][INFO] - Step: 900/9020  |  Loss: 0.3680  |  Score: 83.56 [%]  |  Seq Length: 128.0
[2024-09-19 10:41:34,775][root][INFO] - Step: 1000/9020  |  Loss: 0.7816  |  Score: 50.53 [%]  |  Seq Length: 128.0
[2024-09-19 10:41:42,839][root][INFO] - Step: 1000/9020  |  Loss: 0.3855  |  Score: 82.75 [%]  |  Seq Length: 128.0
[2024-09-19 10:41:46,853][root][INFO] - Step: 700/9020  |  Loss: 0.8121  |  Score: 48.55 [%]  |  Seq Length: 128.0
[2024-09-19 10:42:03,754][root][INFO] - Step: 1100/9020  |  Loss: 0.7723  |  Score: 50.94 [%]  |  Seq Length: 128.0
[2024-09-19 10:42:14,259][root][INFO] - Step: 1100/9020  |  Loss: 0.3472  |  Score: 85.16 [%]  |  Seq Length: 128.0
[2024-09-19 10:42:25,799][root][INFO] - Step: 800/9020  |  Loss: 0.7997  |  Score: 49.22 [%]  |  Seq Length: 128.0
[2024-09-19 10:42:32,155][root][INFO] - Step: 1200/9020  |  Loss: 0.7676  |  Score: 50.89 [%]  |  Seq Length: 128.0
[2024-09-19 10:42:45,362][root][INFO] - Step: 1200/9020  |  Loss: 0.3510  |  Score: 84.62 [%]  |  Seq Length: 128.0
[2024-09-19 10:43:00,503][root][INFO] - Step: 1300/9020  |  Loss: 0.7493  |  Score: 52.94 [%]  |  Seq Length: 128.0
[2024-09-19 10:43:05,560][root][INFO] - Step: 900/9020  |  Loss: 0.7785  |  Score: 51.16 [%]  |  Seq Length: 128.0
[2024-09-19 10:43:16,451][root][INFO] - Step: 1300/9020  |  Loss: 0.3465  |  Score: 84.84 [%]  |  Seq Length: 128.0
[2024-09-19 10:43:29,034][root][INFO] - Step: 1400/9020  |  Loss: 0.7399  |  Score: 53.92 [%]  |  Seq Length: 128.0
[2024-09-19 10:43:46,300][root][INFO] - Step: 1000/9020  |  Loss: 0.7525  |  Score: 52.39 [%]  |  Seq Length: 128.0
[2024-09-19 10:43:47,032][root][INFO] - Step: 1400/9020  |  Loss: 0.3617  |  Score: 84.64 [%]  |  Seq Length: 128.0
[2024-09-19 10:43:56,125][root][INFO] - Step: 1500/9020  |  Loss: 0.7383  |  Score: 54.34 [%]  |  Seq Length: 128.0
[2024-09-19 10:44:18,526][root][INFO] - Step: 1500/9020  |  Loss: 0.3448  |  Score: 84.97 [%]  |  Seq Length: 128.0
[2024-09-19 10:44:24,833][root][INFO] - Step: 1600/9020  |  Loss: 0.7169  |  Score: 55.36 [%]  |  Seq Length: 128.0
[2024-09-19 10:44:26,061][root][INFO] - Step: 1100/9020  |  Loss: 0.7474  |  Score: 52.88 [%]  |  Seq Length: 128.0
[2024-09-19 10:44:49,084][root][INFO] - Step: 1600/9020  |  Loss: 0.3500  |  Score: 84.33 [%]  |  Seq Length: 128.0
[2024-09-19 10:44:53,155][root][INFO] - Step: 1700/9020  |  Loss: 0.7127  |  Score: 56.83 [%]  |  Seq Length: 128.0
[2024-09-19 10:45:05,695][root][INFO] - Step: 1200/9020  |  Loss: 0.7244  |  Score: 55.41 [%]  |  Seq Length: 128.0
[2024-09-19 10:45:20,511][root][INFO] - Step: 1700/9020  |  Loss: 0.3361  |  Score: 85.23 [%]  |  Seq Length: 128.0
[2024-09-19 10:45:21,284][root][INFO] - Step: 1800/9020  |  Loss: 0.7142  |  Score: 56.48 [%]  |  Seq Length: 128.0
[2024-09-19 10:45:22,521][root][INFO] - Step: 1804/9020  |  Loss: 0.7556  |  Score: 54.14 [%]  |  Seq Length: 128.0
[2024-09-19 10:45:42,078][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 10:45:42,078][root][INFO] - Score: 56.43 [%]  |  Evaluation Time: 19.55 [s]
[2024-09-19 10:45:45,820][root][INFO] - Step: 1300/9020  |  Loss: 0.7181  |  Score: 55.53 [%]  |  Seq Length: 128.0
[2024-09-19 10:45:52,932][root][INFO] - Step: 1800/9020  |  Loss: 0.3447  |  Score: 84.70 [%]  |  Seq Length: 128.0
[2024-09-19 10:45:54,268][root][INFO] - Step: 1804/9020  |  Loss: 0.3097  |  Score: 89.45 [%]  |  Seq Length: 128.0
[2024-09-19 10:46:12,981][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 10:46:12,981][root][INFO] - Score: 85.79 [%]  |  Evaluation Time: 18.71 [s]
[2024-09-19 10:46:25,661][root][INFO] - Step: 1400/9020  |  Loss: 0.7041  |  Score: 57.48 [%]  |  Seq Length: 128.0
[2024-09-19 10:46:47,370][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 10:46:47,370][root][INFO] - Score: 56.81 [%]  |  Evaluation Time: 65.29 [s]
[2024-09-19 10:46:47,371][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 10:46:47,372][root][INFO] - 
[2/ 5 Epoch]
[2024-09-19 10:47:05,982][root][INFO] - Step: 1500/9020  |  Loss: 0.7051  |  Score: 56.75 [%]  |  Seq Length: 128.0
[2024-09-19 10:47:11,901][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 10:47:11,902][root][INFO] - Score: 85.90 [%]  |  Evaluation Time: 58.92 [s]
[2024-09-19 10:47:11,903][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 10:47:11,904][root][INFO] - 
[2/ 5 Epoch]
[2024-09-19 10:47:15,774][root][INFO] - Step: 1900/9020  |  Loss: 0.6995  |  Score: 57.23 [%]  |  Seq Length: 128.0
[2024-09-19 10:47:42,240][root][INFO] - Step: 1900/9020  |  Loss: 0.3280  |  Score: 85.64 [%]  |  Seq Length: 128.0
[2024-09-19 10:47:43,126][root][INFO] - Step: 2000/9020  |  Loss: 0.6956  |  Score: 58.09 [%]  |  Seq Length: 128.0
[2024-09-19 10:47:46,004][root][INFO] - Step: 1600/9020  |  Loss: 0.6865  |  Score: 58.05 [%]  |  Seq Length: 128.0
[2024-09-19 10:48:11,514][root][INFO] - Step: 2100/9020  |  Loss: 0.6957  |  Score: 58.20 [%]  |  Seq Length: 128.0
[2024-09-19 10:48:13,496][root][INFO] - Step: 2000/9020  |  Loss: 0.3137  |  Score: 86.62 [%]  |  Seq Length: 128.0
[2024-09-19 10:48:26,381][root][INFO] - Step: 1700/9020  |  Loss: 0.6859  |  Score: 58.84 [%]  |  Seq Length: 128.0
[2024-09-19 10:48:40,132][root][INFO] - Step: 2200/9020  |  Loss: 0.6896  |  Score: 58.91 [%]  |  Seq Length: 128.0
[2024-09-19 10:48:44,630][root][INFO] - Step: 2100/9020  |  Loss: 0.3148  |  Score: 86.17 [%]  |  Seq Length: 128.0
[2024-09-19 10:49:06,510][root][INFO] - Step: 1800/9020  |  Loss: 0.6823  |  Score: 59.19 [%]  |  Seq Length: 128.0
[2024-09-19 10:49:08,136][root][INFO] - Step: 1804/9020  |  Loss: 0.6879  |  Score: 61.48 [%]  |  Seq Length: 128.0
[2024-09-19 10:49:08,870][root][INFO] - Step: 2300/9020  |  Loss: 0.6755  |  Score: 60.39 [%]  |  Seq Length: 128.0
[2024-09-19 10:49:14,899][root][INFO] - Step: 2200/9020  |  Loss: 0.3223  |  Score: 86.23 [%]  |  Seq Length: 128.0
[2024-09-19 10:49:37,365][root][INFO] - Step: 2400/9020  |  Loss: 0.6708  |  Score: 60.28 [%]  |  Seq Length: 128.0
[2024-09-19 10:49:40,974][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 10:49:40,975][root][INFO] - Score: 60.86 [%]  |  Evaluation Time: 32.84 [s]
[2024-09-19 10:49:44,936][root][INFO] - Step: 2300/9020  |  Loss: 0.3196  |  Score: 86.69 [%]  |  Seq Length: 128.0
[2024-09-19 10:50:05,528][root][INFO] - Step: 2500/9020  |  Loss: 0.6669  |  Score: 61.41 [%]  |  Seq Length: 128.0
[2024-09-19 10:50:15,902][root][INFO] - Step: 2400/9020  |  Loss: 0.3141  |  Score: 86.50 [%]  |  Seq Length: 128.0
[2024-09-19 10:50:33,668][root][INFO] - Step: 2600/9020  |  Loss: 0.6620  |  Score: 62.02 [%]  |  Seq Length: 128.0
[2024-09-19 10:50:46,725][root][INFO] - Step: 2500/9020  |  Loss: 0.3132  |  Score: 86.67 [%]  |  Seq Length: 128.0
[2024-09-19 10:51:01,730][root][INFO] - Step: 2700/9020  |  Loss: 0.6568  |  Score: 62.44 [%]  |  Seq Length: 128.0
[2024-09-19 10:51:17,641][root][INFO] - Step: 2600/9020  |  Loss: 0.3006  |  Score: 86.81 [%]  |  Seq Length: 128.0
[2024-09-19 10:51:29,650][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 10:51:29,651][root][INFO] - Score: 61.16 [%]  |  Evaluation Time: 108.67 [s]
[2024-09-19 10:51:29,652][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 10:51:29,654][root][INFO] - 
[2/ 5 Epoch]
[2024-09-19 10:51:29,790][root][INFO] - Step: 2800/9020  |  Loss: 0.6539  |  Score: 63.28 [%]  |  Seq Length: 128.0
[2024-09-19 10:51:47,963][root][INFO] - Step: 2700/9020  |  Loss: 0.3183  |  Score: 86.50 [%]  |  Seq Length: 128.0
[2024-09-19 10:51:57,468][root][INFO] - Step: 2900/9020  |  Loss: 0.6385  |  Score: 64.27 [%]  |  Seq Length: 128.0
[2024-09-19 10:52:07,560][root][INFO] - Step: 1900/9020  |  Loss: 0.6615  |  Score: 61.04 [%]  |  Seq Length: 128.0
[2024-09-19 10:52:18,670][root][INFO] - Step: 2800/9020  |  Loss: 0.2979  |  Score: 87.62 [%]  |  Seq Length: 128.0
[2024-09-19 10:52:25,636][root][INFO] - Step: 3000/9020  |  Loss: 0.6343  |  Score: 64.28 [%]  |  Seq Length: 128.0
[2024-09-19 10:52:46,466][root][INFO] - Step: 2000/9020  |  Loss: 0.6582  |  Score: 62.27 [%]  |  Seq Length: 128.0
[2024-09-19 10:52:49,932][root][INFO] - Step: 2900/9020  |  Loss: 0.2988  |  Score: 87.47 [%]  |  Seq Length: 128.0
[2024-09-19 10:52:54,054][root][INFO] - Step: 3100/9020  |  Loss: 0.6236  |  Score: 65.03 [%]  |  Seq Length: 128.0
[2024-09-19 10:53:20,803][root][INFO] - Step: 3000/9020  |  Loss: 0.3189  |  Score: 86.19 [%]  |  Seq Length: 128.0
[2024-09-19 10:53:21,879][root][INFO] - Step: 3200/9020  |  Loss: 0.6167  |  Score: 66.59 [%]  |  Seq Length: 128.0
[2024-09-19 10:53:25,874][root][INFO] - Step: 2100/9020  |  Loss: 0.6531  |  Score: 62.41 [%]  |  Seq Length: 128.0
[2024-09-19 10:53:50,415][root][INFO] - Step: 3300/9020  |  Loss: 0.6147  |  Score: 67.20 [%]  |  Seq Length: 128.0
[2024-09-19 10:53:51,993][root][INFO] - Step: 3100/9020  |  Loss: 0.3096  |  Score: 87.11 [%]  |  Seq Length: 128.0
[2024-09-19 10:54:04,060][root][INFO] - Step: 2200/9020  |  Loss: 0.6436  |  Score: 63.69 [%]  |  Seq Length: 128.0
[2024-09-19 10:54:17,945][root][INFO] - Step: 3400/9020  |  Loss: 0.6119  |  Score: 66.52 [%]  |  Seq Length: 128.0
[2024-09-19 10:54:22,449][root][INFO] - Step: 3200/9020  |  Loss: 0.3024  |  Score: 87.12 [%]  |  Seq Length: 128.0
[2024-09-19 10:54:43,087][root][INFO] - Step: 2300/9020  |  Loss: 0.6466  |  Score: 63.20 [%]  |  Seq Length: 128.0
[2024-09-19 10:54:46,455][root][INFO] - Step: 3500/9020  |  Loss: 0.6059  |  Score: 67.48 [%]  |  Seq Length: 128.0
[2024-09-19 10:54:52,934][root][INFO] - Step: 3300/9020  |  Loss: 0.3033  |  Score: 87.12 [%]  |  Seq Length: 128.0
[2024-09-19 10:55:14,280][root][INFO] - Step: 3600/9020  |  Loss: 0.5982  |  Score: 68.09 [%]  |  Seq Length: 128.0
[2024-09-19 10:55:16,393][root][INFO] - Step: 3608/9020  |  Loss: 0.6085  |  Score: 66.91 [%]  |  Seq Length: 128.0
[2024-09-19 10:55:17,467][root][INFO] - Step: 2400/9020  |  Loss: 0.6413  |  Score: 63.59 [%]  |  Seq Length: 128.0
[2024-09-19 10:55:23,871][root][INFO] - Step: 3400/9020  |  Loss: 0.3016  |  Score: 87.39 [%]  |  Seq Length: 128.0
[2024-09-19 10:55:35,964][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 10:55:35,964][root][INFO] - Score: 68.68 [%]  |  Evaluation Time: 19.57 [s]
[2024-09-19 10:55:54,034][root][INFO] - Step: 2500/9020  |  Loss: 0.6270  |  Score: 65.22 [%]  |  Seq Length: 128.0
[2024-09-19 10:55:55,019][root][INFO] - Step: 3500/9020  |  Loss: 0.3041  |  Score: 86.94 [%]  |  Seq Length: 128.0
[2024-09-19 10:56:25,710][root][INFO] - Step: 3600/9020  |  Loss: 0.3074  |  Score: 87.05 [%]  |  Seq Length: 128.0
[2024-09-19 10:56:28,160][root][INFO] - Step: 3608/9020  |  Loss: 0.2901  |  Score: 88.05 [%]  |  Seq Length: 128.0
[2024-09-19 10:56:30,755][root][INFO] - Step: 2600/9020  |  Loss: 0.6185  |  Score: 66.27 [%]  |  Seq Length: 128.0
[2024-09-19 10:56:40,074][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 10:56:40,075][root][INFO] - Score: 68.70 [%]  |  Evaluation Time: 64.11 [s]
[2024-09-19 10:56:40,076][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 10:56:40,077][root][INFO] - 
[3/ 5 Epoch]
[2024-09-19 10:56:46,047][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 10:56:46,048][root][INFO] - Score: 86.79 [%]  |  Evaluation Time: 17.88 [s]
[2024-09-19 10:57:06,458][root][INFO] - Step: 3700/9020  |  Loss: 0.5903  |  Score: 69.75 [%]  |  Seq Length: 128.0
[2024-09-19 10:57:10,190][root][INFO] - Step: 2700/9020  |  Loss: 0.6152  |  Score: 67.11 [%]  |  Seq Length: 128.0
[2024-09-19 10:57:34,753][root][INFO] - Step: 3800/9020  |  Loss: 0.5940  |  Score: 68.53 [%]  |  Seq Length: 128.0
[2024-09-19 10:57:46,836][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 10:57:46,836][root][INFO] - Score: 87.17 [%]  |  Evaluation Time: 60.79 [s]
[2024-09-19 10:57:46,838][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 10:57:46,839][root][INFO] - 
[3/ 5 Epoch]
[2024-09-19 10:57:49,402][root][INFO] - Step: 2800/9020  |  Loss: 0.6056  |  Score: 67.73 [%]  |  Seq Length: 128.0
[2024-09-19 10:58:02,933][root][INFO] - Step: 3900/9020  |  Loss: 0.5850  |  Score: 69.05 [%]  |  Seq Length: 128.0
[2024-09-19 10:58:15,579][root][INFO] - Step: 3700/9020  |  Loss: 0.2786  |  Score: 88.45 [%]  |  Seq Length: 128.0
[2024-09-19 10:58:28,415][root][INFO] - Step: 2900/9020  |  Loss: 0.6017  |  Score: 68.16 [%]  |  Seq Length: 128.0
[2024-09-19 10:58:30,974][root][INFO] - Step: 4000/9020  |  Loss: 0.5834  |  Score: 70.23 [%]  |  Seq Length: 128.0
[2024-09-19 10:58:46,650][root][INFO] - Step: 3800/9020  |  Loss: 0.2891  |  Score: 87.80 [%]  |  Seq Length: 128.0
[2024-09-19 10:58:59,652][root][INFO] - Step: 4100/9020  |  Loss: 0.5765  |  Score: 69.92 [%]  |  Seq Length: 128.0
[2024-09-19 10:59:07,476][root][INFO] - Step: 3000/9020  |  Loss: 0.6002  |  Score: 68.50 [%]  |  Seq Length: 128.0
[2024-09-19 10:59:18,442][root][INFO] - Step: 3900/9020  |  Loss: 0.2807  |  Score: 88.73 [%]  |  Seq Length: 128.0
[2024-09-19 10:59:27,618][root][INFO] - Step: 4200/9020  |  Loss: 0.5636  |  Score: 71.67 [%]  |  Seq Length: 128.0
[2024-09-19 10:59:46,805][root][INFO] - Step: 3100/9020  |  Loss: 0.5955  |  Score: 68.64 [%]  |  Seq Length: 128.0
[2024-09-19 10:59:48,930][root][INFO] - Step: 4000/9020  |  Loss: 0.2756  |  Score: 88.81 [%]  |  Seq Length: 128.0
[2024-09-19 10:59:55,518][root][INFO] - Step: 4300/9020  |  Loss: 0.5570  |  Score: 71.75 [%]  |  Seq Length: 128.0
[2024-09-19 11:00:19,806][root][INFO] - Step: 4100/9020  |  Loss: 0.2774  |  Score: 88.30 [%]  |  Seq Length: 128.0
[2024-09-19 11:00:23,911][root][INFO] - Step: 4400/9020  |  Loss: 0.5529  |  Score: 72.22 [%]  |  Seq Length: 128.0
[2024-09-19 11:00:26,013][root][INFO] - Step: 3200/9020  |  Loss: 0.5956  |  Score: 69.55 [%]  |  Seq Length: 128.0
[2024-09-19 11:00:50,792][root][INFO] - Step: 4200/9020  |  Loss: 0.2886  |  Score: 87.17 [%]  |  Seq Length: 128.0
[2024-09-19 11:00:52,230][root][INFO] - Step: 4500/9020  |  Loss: 0.5523  |  Score: 72.42 [%]  |  Seq Length: 128.0
[2024-09-19 11:01:05,218][root][INFO] - Step: 3300/9020  |  Loss: 0.5812  |  Score: 70.58 [%]  |  Seq Length: 128.0
[2024-09-19 11:01:20,027][root][INFO] - Step: 4300/9020  |  Loss: 0.2957  |  Score: 87.23 [%]  |  Seq Length: 128.0
[2024-09-19 11:01:20,807][root][INFO] - Step: 4600/9020  |  Loss: 0.5533  |  Score: 72.38 [%]  |  Seq Length: 128.0
[2024-09-19 11:01:44,680][root][INFO] - Step: 3400/9020  |  Loss: 0.5863  |  Score: 69.38 [%]  |  Seq Length: 128.0
[2024-09-19 11:01:49,384][root][INFO] - Step: 4700/9020  |  Loss: 0.5507  |  Score: 73.33 [%]  |  Seq Length: 128.0
[2024-09-19 11:01:50,800][root][INFO] - Step: 4400/9020  |  Loss: 0.2807  |  Score: 88.14 [%]  |  Seq Length: 128.0
[2024-09-19 11:02:18,093][root][INFO] - Step: 4800/9020  |  Loss: 0.5472  |  Score: 73.08 [%]  |  Seq Length: 128.0
[2024-09-19 11:02:21,250][root][INFO] - Step: 4500/9020  |  Loss: 0.2827  |  Score: 88.23 [%]  |  Seq Length: 128.0
[2024-09-19 11:02:23,836][root][INFO] - Step: 3500/9020  |  Loss: 0.5812  |  Score: 70.20 [%]  |  Seq Length: 128.0
[2024-09-19 11:02:46,543][root][INFO] - Step: 4900/9020  |  Loss: 0.5471  |  Score: 73.00 [%]  |  Seq Length: 128.0
[2024-09-19 11:02:52,365][root][INFO] - Step: 4600/9020  |  Loss: 0.2749  |  Score: 88.41 [%]  |  Seq Length: 128.0
[2024-09-19 11:03:00,704][root][INFO] - Step: 3600/9020  |  Loss: 0.5723  |  Score: 70.86 [%]  |  Seq Length: 128.0
[2024-09-19 11:03:04,106][root][INFO] - Step: 3608/9020  |  Loss: 0.5977  |  Score: 71.25 [%]  |  Seq Length: 128.0
[2024-09-19 11:03:14,039][root][INFO] - Step: 5000/9020  |  Loss: 0.5285  |  Score: 74.39 [%]  |  Seq Length: 128.0
[2024-09-19 11:03:22,723][root][INFO] - Step: 4700/9020  |  Loss: 0.2887  |  Score: 87.61 [%]  |  Seq Length: 128.0
[2024-09-19 11:03:39,410][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 11:03:39,410][root][INFO] - Score: 72.06 [%]  |  Evaluation Time: 35.30 [s]
[2024-09-19 11:03:42,648][root][INFO] - Step: 5100/9020  |  Loss: 0.5347  |  Score: 73.77 [%]  |  Seq Length: 128.0
[2024-09-19 11:03:52,995][root][INFO] - Step: 4800/9020  |  Loss: 0.2899  |  Score: 88.12 [%]  |  Seq Length: 128.0
[2024-09-19 11:04:11,225][root][INFO] - Step: 5200/9020  |  Loss: 0.5175  |  Score: 75.50 [%]  |  Seq Length: 128.0
[2024-09-19 11:04:23,670][root][INFO] - Step: 4900/9020  |  Loss: 0.2694  |  Score: 88.62 [%]  |  Seq Length: 128.0
[2024-09-19 11:04:39,538][root][INFO] - Step: 5300/9020  |  Loss: 0.5350  |  Score: 74.42 [%]  |  Seq Length: 128.0
[2024-09-19 11:04:54,239][root][INFO] - Step: 5000/9020  |  Loss: 0.2950  |  Score: 87.44 [%]  |  Seq Length: 128.0
[2024-09-19 11:05:07,026][root][INFO] - Step: 5400/9020  |  Loss: 0.5161  |  Score: 75.27 [%]  |  Seq Length: 128.0
[2024-09-19 11:05:10,585][root][INFO] - Step: 5412/9020  |  Loss: 0.5392  |  Score: 74.35 [%]  |  Seq Length: 128.0
[2024-09-19 11:05:25,378][root][INFO] - Step: 5100/9020  |  Loss: 0.2846  |  Score: 88.45 [%]  |  Seq Length: 128.0
[2024-09-19 11:05:30,217][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 11:05:30,218][root][INFO] - Score: 72.30 [%]  |  Evaluation Time: 110.80 [s]
[2024-09-19 11:05:30,220][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 11:05:30,222][root][INFO] - 
[3/ 5 Epoch]
[2024-09-19 11:05:30,504][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 11:05:30,505][root][INFO] - Score: 74.83 [%]  |  Evaluation Time: 19.92 [s]
[2024-09-19 11:05:55,767][root][INFO] - Step: 5200/9020  |  Loss: 0.2768  |  Score: 88.31 [%]  |  Seq Length: 128.0
[2024-09-19 11:06:06,478][root][INFO] - Step: 3700/9020  |  Loss: 0.5632  |  Score: 71.60 [%]  |  Seq Length: 128.0
[2024-09-19 11:06:26,398][root][INFO] - Step: 5300/9020  |  Loss: 0.2852  |  Score: 88.20 [%]  |  Seq Length: 128.0
[2024-09-19 11:06:34,382][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 11:06:34,383][root][INFO] - Score: 75.15 [%]  |  Evaluation Time: 63.88 [s]
[2024-09-19 11:06:34,384][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-19 11:06:34,385][root][INFO] - 
[4/ 5 Epoch]
[2024-09-19 11:06:45,680][root][INFO] - Step: 3800/9020  |  Loss: 0.5743  |  Score: 70.66 [%]  |  Seq Length: 128.0
[2024-09-19 11:06:57,340][root][INFO] - Step: 5400/9020  |  Loss: 0.2796  |  Score: 88.19 [%]  |  Seq Length: 128.0
[2024-09-19 11:06:59,360][root][INFO] - Step: 5500/9020  |  Loss: 0.5280  |  Score: 74.47 [%]  |  Seq Length: 128.0
[2024-09-19 11:07:01,391][root][INFO] - Step: 5412/9020  |  Loss: 0.3090  |  Score: 86.93 [%]  |  Seq Length: 128.0
[2024-09-19 11:07:19,103][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 11:07:19,103][root][INFO] - Score: 87.36 [%]  |  Evaluation Time: 17.71 [s]
[2024-09-19 11:07:24,601][root][INFO] - Step: 3900/9020  |  Loss: 0.5726  |  Score: 71.20 [%]  |  Seq Length: 128.0
[2024-09-19 11:07:26,733][root][INFO] - Step: 5600/9020  |  Loss: 0.5234  |  Score: 74.73 [%]  |  Seq Length: 128.0
[2024-09-19 11:07:55,126][root][INFO] - Step: 5700/9020  |  Loss: 0.5175  |  Score: 75.03 [%]  |  Seq Length: 128.0
[2024-09-19 11:08:03,987][root][INFO] - Step: 4000/9020  |  Loss: 0.5636  |  Score: 71.09 [%]  |  Seq Length: 128.0
[2024-09-19 11:08:18,009][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 11:08:18,009][root][INFO] - Score: 87.58 [%]  |  Evaluation Time: 58.90 [s]
[2024-09-19 11:08:18,010][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-19 11:08:18,011][root][INFO] - 
[4/ 5 Epoch]
[2024-09-19 11:08:23,329][root][INFO] - Step: 5800/9020  |  Loss: 0.5074  |  Score: 75.86 [%]  |  Seq Length: 128.0
[2024-09-19 11:08:42,048][root][INFO] - Step: 4100/9020  |  Loss: 0.5553  |  Score: 72.78 [%]  |  Seq Length: 128.0
[2024-09-19 11:08:44,992][root][INFO] - Step: 5500/9020  |  Loss: 0.2605  |  Score: 89.04 [%]  |  Seq Length: 128.0
[2024-09-19 11:08:50,536][root][INFO] - Step: 5900/9020  |  Loss: 0.5165  |  Score: 75.38 [%]  |  Seq Length: 128.0
[2024-09-19 11:09:14,994][root][INFO] - Step: 5600/9020  |  Loss: 0.2694  |  Score: 88.77 [%]  |  Seq Length: 128.0
[2024-09-19 11:09:17,809][root][INFO] - Step: 6000/9020  |  Loss: 0.5083  |  Score: 75.64 [%]  |  Seq Length: 128.0
[2024-09-19 11:09:20,308][root][INFO] - Step: 4200/9020  |  Loss: 0.5607  |  Score: 71.53 [%]  |  Seq Length: 128.0
[2024-09-19 11:09:45,298][root][INFO] - Step: 5700/9020  |  Loss: 0.2715  |  Score: 88.95 [%]  |  Seq Length: 128.0
[2024-09-19 11:09:46,001][root][INFO] - Step: 6100/9020  |  Loss: 0.4987  |  Score: 76.73 [%]  |  Seq Length: 128.0
[2024-09-19 11:09:59,076][root][INFO] - Step: 4300/9020  |  Loss: 0.5612  |  Score: 71.95 [%]  |  Seq Length: 128.0
[2024-09-19 11:10:14,117][root][INFO] - Step: 6200/9020  |  Loss: 0.5144  |  Score: 75.47 [%]  |  Seq Length: 128.0
[2024-09-19 11:10:16,516][root][INFO] - Step: 5800/9020  |  Loss: 0.2636  |  Score: 89.16 [%]  |  Seq Length: 128.0
[2024-09-19 11:10:37,896][root][INFO] - Step: 4400/9020  |  Loss: 0.5696  |  Score: 70.88 [%]  |  Seq Length: 128.0
[2024-09-19 11:10:41,791][root][INFO] - Step: 6300/9020  |  Loss: 0.5077  |  Score: 75.62 [%]  |  Seq Length: 128.0
[2024-09-19 11:10:47,048][root][INFO] - Step: 5900/9020  |  Loss: 0.2817  |  Score: 88.64 [%]  |  Seq Length: 128.0
[2024-09-19 11:11:08,994][root][INFO] - Step: 6400/9020  |  Loss: 0.5096  |  Score: 75.42 [%]  |  Seq Length: 128.0
[2024-09-19 11:11:16,460][root][INFO] - Step: 4500/9020  |  Loss: 0.5551  |  Score: 72.06 [%]  |  Seq Length: 128.0
[2024-09-19 11:11:17,329][root][INFO] - Step: 6000/9020  |  Loss: 0.2814  |  Score: 88.20 [%]  |  Seq Length: 128.0
[2024-09-19 11:11:36,935][root][INFO] - Step: 6500/9020  |  Loss: 0.5049  |  Score: 76.20 [%]  |  Seq Length: 128.0
[2024-09-19 11:11:47,736][root][INFO] - Step: 6100/9020  |  Loss: 0.2805  |  Score: 88.03 [%]  |  Seq Length: 128.0
[2024-09-19 11:11:55,205][root][INFO] - Step: 4600/9020  |  Loss: 0.5500  |  Score: 72.78 [%]  |  Seq Length: 128.0
[2024-09-19 11:12:05,470][root][INFO] - Step: 6600/9020  |  Loss: 0.4934  |  Score: 76.39 [%]  |  Seq Length: 128.0
[2024-09-19 11:12:17,859][root][INFO] - Step: 6200/9020  |  Loss: 0.2597  |  Score: 88.98 [%]  |  Seq Length: 128.0
[2024-09-19 11:12:33,930][root][INFO] - Step: 6700/9020  |  Loss: 0.4981  |  Score: 76.03 [%]  |  Seq Length: 128.0
[2024-09-19 11:12:34,197][root][INFO] - Step: 4700/9020  |  Loss: 0.5586  |  Score: 72.39 [%]  |  Seq Length: 128.0
[2024-09-19 11:12:47,769][root][INFO] - Step: 6300/9020  |  Loss: 0.2613  |  Score: 89.52 [%]  |  Seq Length: 128.0
[2024-09-19 11:13:02,463][root][INFO] - Step: 6800/9020  |  Loss: 0.5015  |  Score: 76.25 [%]  |  Seq Length: 128.0
[2024-09-19 11:13:13,628][root][INFO] - Step: 4800/9020  |  Loss: 0.5462  |  Score: 73.16 [%]  |  Seq Length: 128.0
[2024-09-19 11:13:18,493][root][INFO] - Step: 6400/9020  |  Loss: 0.2579  |  Score: 89.39 [%]  |  Seq Length: 128.0
[2024-09-19 11:13:29,374][root][INFO] - Step: 6900/9020  |  Loss: 0.5050  |  Score: 76.11 [%]  |  Seq Length: 128.0
[2024-09-19 11:13:48,397][root][INFO] - Step: 6500/9020  |  Loss: 0.2646  |  Score: 88.67 [%]  |  Seq Length: 128.0
[2024-09-19 11:13:52,701][root][INFO] - Step: 4900/9020  |  Loss: 0.5474  |  Score: 72.64 [%]  |  Seq Length: 128.0
[2024-09-19 11:13:55,054][root][INFO] - Step: 7000/9020  |  Loss: 0.4956  |  Score: 76.81 [%]  |  Seq Length: 128.0
[2024-09-19 11:14:19,446][root][INFO] - Step: 6600/9020  |  Loss: 0.2647  |  Score: 88.97 [%]  |  Seq Length: 128.0
[2024-09-19 11:14:22,837][root][INFO] - Step: 7100/9020  |  Loss: 0.5045  |  Score: 75.98 [%]  |  Seq Length: 128.0
[2024-09-19 11:14:32,321][root][INFO] - Step: 5000/9020  |  Loss: 0.5448  |  Score: 73.72 [%]  |  Seq Length: 128.0
[2024-09-19 11:14:50,062][root][INFO] - Step: 6700/9020  |  Loss: 0.2649  |  Score: 88.98 [%]  |  Seq Length: 128.0
[2024-09-19 11:14:51,315][root][INFO] - Step: 7200/9020  |  Loss: 0.4943  |  Score: 76.58 [%]  |  Seq Length: 128.0
[2024-09-19 11:14:55,811][root][INFO] - Step: 7216/9020  |  Loss: 0.5084  |  Score: 75.98 [%]  |  Seq Length: 128.0
[2024-09-19 11:15:11,066][root][INFO] - Step: 5100/9020  |  Loss: 0.5463  |  Score: 73.00 [%]  |  Seq Length: 128.0
[2024-09-19 11:15:15,544][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 11:15:15,544][root][INFO] - Score: 76.65 [%]  |  Evaluation Time: 19.73 [s]
[2024-09-19 11:15:20,718][root][INFO] - Step: 6800/9020  |  Loss: 0.2646  |  Score: 88.91 [%]  |  Seq Length: 128.0
[2024-09-19 11:15:49,756][root][INFO] - Step: 5200/9020  |  Loss: 0.5552  |  Score: 71.91 [%]  |  Seq Length: 128.0
[2024-09-19 11:15:51,381][root][INFO] - Step: 6900/9020  |  Loss: 0.2715  |  Score: 88.73 [%]  |  Seq Length: 128.0
[2024-09-19 11:16:20,115][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 11:16:20,116][root][INFO] - Score: 76.93 [%]  |  Evaluation Time: 64.57 [s]
[2024-09-19 11:16:20,117][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-19 11:16:20,118][root][INFO] - 
[5/ 5 Epoch]
[2024-09-19 11:16:22,083][root][INFO] - Step: 7000/9020  |  Loss: 0.2573  |  Score: 89.67 [%]  |  Seq Length: 128.0
[2024-09-19 11:16:28,292][root][INFO] - Step: 5300/9020  |  Loss: 0.5384  |  Score: 73.73 [%]  |  Seq Length: 128.0
[2024-09-19 11:16:44,386][root][INFO] - Step: 7300/9020  |  Loss: 0.4904  |  Score: 76.95 [%]  |  Seq Length: 128.0
[2024-09-19 11:16:53,054][root][INFO] - Step: 7100/9020  |  Loss: 0.2546  |  Score: 89.30 [%]  |  Seq Length: 128.0
[2024-09-19 11:17:07,737][root][INFO] - Step: 5400/9020  |  Loss: 0.5436  |  Score: 73.38 [%]  |  Seq Length: 128.0
[2024-09-19 11:17:12,176][root][INFO] - Step: 7400/9020  |  Loss: 0.4899  |  Score: 77.56 [%]  |  Seq Length: 128.0
[2024-09-19 11:17:12,638][root][INFO] - Step: 5412/9020  |  Loss: 0.5369  |  Score: 74.06 [%]  |  Seq Length: 128.0
[2024-09-19 11:17:23,528][root][INFO] - Step: 7200/9020  |  Loss: 0.2675  |  Score: 88.98 [%]  |  Seq Length: 128.0
[2024-09-19 11:17:28,500][root][INFO] - Step: 7216/9020  |  Loss: 0.2354  |  Score: 90.62 [%]  |  Seq Length: 128.0
[2024-09-19 11:17:38,368][root][INFO] - Step: 7500/9020  |  Loss: 0.5001  |  Score: 76.58 [%]  |  Seq Length: 128.0
[2024-09-19 11:17:45,728][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 11:17:45,728][root][INFO] - Score: 74.48 [%]  |  Evaluation Time: 33.09 [s]
[2024-09-19 11:17:46,744][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 11:17:46,744][root][INFO] - Score: 87.66 [%]  |  Evaluation Time: 18.24 [s]
[2024-09-19 11:18:07,609][root][INFO] - Step: 7600/9020  |  Loss: 0.4875  |  Score: 76.72 [%]  |  Seq Length: 128.0
[2024-09-19 11:18:36,952][root][INFO] - Step: 7700/9020  |  Loss: 0.5029  |  Score: 76.19 [%]  |  Seq Length: 128.0
[2024-09-19 11:18:45,419][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 11:18:45,419][root][INFO] - Score: 87.88 [%]  |  Evaluation Time: 58.67 [s]
[2024-09-19 11:18:45,421][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-19 11:18:45,422][root][INFO] - 
[5/ 5 Epoch]
[2024-09-19 11:19:05,462][root][INFO] - Step: 7800/9020  |  Loss: 0.4899  |  Score: 77.50 [%]  |  Seq Length: 128.0
[2024-09-19 11:19:11,740][root][INFO] - Step: 7300/9020  |  Loss: 0.2621  |  Score: 89.62 [%]  |  Seq Length: 128.0
[2024-09-19 11:19:33,942][root][INFO] - Step: 7900/9020  |  Loss: 0.4917  |  Score: 77.17 [%]  |  Seq Length: 128.0
[2024-09-19 11:19:34,275][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 11:19:34,276][root][INFO] - Score: 74.35 [%]  |  Evaluation Time: 108.54 [s]
[2024-09-19 11:19:34,278][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-19 11:19:34,281][root][INFO] - 
[4/ 5 Epoch]
[2024-09-19 11:19:42,189][root][INFO] - Step: 7400/9020  |  Loss: 0.2586  |  Score: 89.56 [%]  |  Seq Length: 128.0
[2024-09-19 11:20:02,157][root][INFO] - Step: 8000/9020  |  Loss: 0.4964  |  Score: 76.81 [%]  |  Seq Length: 128.0
[2024-09-19 11:20:09,193][root][INFO] - Step: 5500/9020  |  Loss: 0.5412  |  Score: 73.46 [%]  |  Seq Length: 128.0
[2024-09-19 11:20:13,929][root][INFO] - Step: 7500/9020  |  Loss: 0.2547  |  Score: 89.44 [%]  |  Seq Length: 128.0
[2024-09-19 11:20:29,484][root][INFO] - Step: 8100/9020  |  Loss: 0.4943  |  Score: 76.62 [%]  |  Seq Length: 128.0
[2024-09-19 11:20:44,420][root][INFO] - Step: 7600/9020  |  Loss: 0.2540  |  Score: 89.88 [%]  |  Seq Length: 128.0
[2024-09-19 11:20:48,422][root][INFO] - Step: 5600/9020  |  Loss: 0.5405  |  Score: 73.38 [%]  |  Seq Length: 128.0
[2024-09-19 11:20:57,298][root][INFO] - Step: 8200/9020  |  Loss: 0.4921  |  Score: 76.70 [%]  |  Seq Length: 128.0
[2024-09-19 11:21:15,022][root][INFO] - Step: 7700/9020  |  Loss: 0.2489  |  Score: 89.84 [%]  |  Seq Length: 128.0
[2024-09-19 11:21:25,538][root][INFO] - Step: 8300/9020  |  Loss: 0.4880  |  Score: 77.19 [%]  |  Seq Length: 128.0
[2024-09-19 11:21:27,065][root][INFO] - Step: 5700/9020  |  Loss: 0.5449  |  Score: 72.61 [%]  |  Seq Length: 128.0
[2024-09-19 11:21:43,436][root][INFO] - Step: 7800/9020  |  Loss: 0.2440  |  Score: 89.84 [%]  |  Seq Length: 128.0
[2024-09-19 11:21:54,051][root][INFO] - Step: 8400/9020  |  Loss: 0.4988  |  Score: 76.28 [%]  |  Seq Length: 128.0
[2024-09-19 11:22:06,317][root][INFO] - Step: 5800/9020  |  Loss: 0.5352  |  Score: 73.59 [%]  |  Seq Length: 128.0
[2024-09-19 11:22:14,286][root][INFO] - Step: 7900/9020  |  Loss: 0.2530  |  Score: 89.75 [%]  |  Seq Length: 128.0
[2024-09-19 11:22:22,112][root][INFO] - Step: 8500/9020  |  Loss: 0.5004  |  Score: 75.88 [%]  |  Seq Length: 128.0
[2024-09-19 11:22:45,281][root][INFO] - Step: 8000/9020  |  Loss: 0.2685  |  Score: 88.92 [%]  |  Seq Length: 128.0
[2024-09-19 11:22:45,847][root][INFO] - Step: 5900/9020  |  Loss: 0.5403  |  Score: 72.97 [%]  |  Seq Length: 128.0
[2024-09-19 11:22:50,446][root][INFO] - Step: 8600/9020  |  Loss: 0.4952  |  Score: 76.83 [%]  |  Seq Length: 128.0
[2024-09-19 11:23:16,046][root][INFO] - Step: 8100/9020  |  Loss: 0.2481  |  Score: 89.81 [%]  |  Seq Length: 128.0
[2024-09-19 11:23:17,657][root][INFO] - Step: 8700/9020  |  Loss: 0.4845  |  Score: 77.75 [%]  |  Seq Length: 128.0
[2024-09-19 11:23:24,416][root][INFO] - Step: 6000/9020  |  Loss: 0.5473  |  Score: 73.25 [%]  |  Seq Length: 128.0
[2024-09-19 11:23:46,127][root][INFO] - Step: 8800/9020  |  Loss: 0.5023  |  Score: 76.73 [%]  |  Seq Length: 128.0
[2024-09-19 11:23:46,777][root][INFO] - Step: 8200/9020  |  Loss: 0.2549  |  Score: 89.75 [%]  |  Seq Length: 128.0
[2024-09-19 11:24:03,066][root][INFO] - Step: 6100/9020  |  Loss: 0.5366  |  Score: 73.66 [%]  |  Seq Length: 128.0
[2024-09-19 11:24:14,654][root][INFO] - Step: 8900/9020  |  Loss: 0.4886  |  Score: 77.12 [%]  |  Seq Length: 128.0
[2024-09-19 11:24:17,494][root][INFO] - Step: 8300/9020  |  Loss: 0.2621  |  Score: 89.22 [%]  |  Seq Length: 128.0
[2024-09-19 11:24:42,164][root][INFO] - Step: 9000/9020  |  Loss: 0.4765  |  Score: 77.56 [%]  |  Seq Length: 128.0
[2024-09-19 11:24:42,675][root][INFO] - Step: 6200/9020  |  Loss: 0.5507  |  Score: 73.03 [%]  |  Seq Length: 128.0
[2024-09-19 11:24:46,974][root][INFO] - Step: 9020/9020  |  Loss: 0.4613  |  Score: 78.73 [%]  |  Seq Length: 128.0
[2024-09-19 11:24:48,531][root][INFO] - Step: 8400/9020  |  Loss: 0.2564  |  Score: 89.36 [%]  |  Seq Length: 128.0
[2024-09-19 11:25:06,867][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 11:25:06,867][root][INFO] - Score: 77.11 [%]  |  Evaluation Time: 19.89 [s]
[2024-09-19 11:25:19,910][root][INFO] - Step: 8500/9020  |  Loss: 0.2426  |  Score: 89.61 [%]  |  Seq Length: 128.0
[2024-09-19 11:25:21,722][root][INFO] - Step: 6300/9020  |  Loss: 0.5253  |  Score: 74.11 [%]  |  Seq Length: 128.0
[2024-09-19 11:25:51,785][root][INFO] - Step: 8600/9020  |  Loss: 0.2422  |  Score: 89.75 [%]  |  Seq Length: 128.0
[2024-09-19 11:26:01,292][root][INFO] - Step: 6400/9020  |  Loss: 0.5445  |  Score: 72.88 [%]  |  Seq Length: 128.0
[2024-09-19 11:26:11,564][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 11:26:11,564][root][INFO] - Score: 77.45 [%]  |  Evaluation Time: 64.69 [s]
[2024-09-19 11:26:11,565][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-19 11:26:11,565][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 11:26:11,565][root][INFO] - - Epoch: 5
[2024-09-19 11:26:11,565][root][INFO] - - DEV score: 77.11 [%]
[2024-09-19 11:26:11,565][root][INFO] - - TEST score: 77.45 [%]
[2024-09-19 11:26:11,566][root][INFO] - Fine-tuning is done!
[2024-09-19 11:26:22,788][root][INFO] - Step: 8700/9020  |  Loss: 0.2555  |  Score: 89.59 [%]  |  Seq Length: 128.0
[2024-09-19 11:26:41,061][root][INFO] - Step: 6500/9020  |  Loss: 0.5304  |  Score: 74.25 [%]  |  Seq Length: 128.0
[2024-09-19 11:26:53,753][root][INFO] - Step: 8800/9020  |  Loss: 0.2658  |  Score: 88.58 [%]  |  Seq Length: 128.0
[2024-09-19 11:27:19,863][root][INFO] - Step: 6600/9020  |  Loss: 0.5349  |  Score: 73.73 [%]  |  Seq Length: 128.0
[2024-09-19 11:27:25,354][root][INFO] - Step: 8900/9020  |  Loss: 0.2622  |  Score: 89.25 [%]  |  Seq Length: 128.0
[2024-09-19 11:27:56,885][root][INFO] - Step: 9000/9020  |  Loss: 0.2675  |  Score: 89.19 [%]  |  Seq Length: 128.0
[2024-09-19 11:27:58,883][root][INFO] - Step: 6700/9020  |  Loss: 0.5349  |  Score: 73.56 [%]  |  Seq Length: 128.0
[2024-09-19 11:28:03,495][root][INFO] - Step: 9020/9020  |  Loss: 0.2841  |  Score: 88.17 [%]  |  Seq Length: 128.0
[2024-09-19 11:28:21,538][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 11:28:21,538][root][INFO] - Score: 87.67 [%]  |  Evaluation Time: 18.04 [s]
[2024-09-19 11:28:38,340][root][INFO] - Step: 6800/9020  |  Loss: 0.5333  |  Score: 73.86 [%]  |  Seq Length: 128.0
[2024-09-19 11:29:16,089][root][INFO] - Step: 6900/9020  |  Loss: 0.5297  |  Score: 74.48 [%]  |  Seq Length: 128.0
[2024-09-19 11:29:19,997][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 11:29:19,998][root][INFO] - Score: 87.97 [%]  |  Evaluation Time: 58.46 [s]
[2024-09-19 11:29:19,999][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-19 11:29:19,999][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 11:29:19,999][root][INFO] - - Epoch: 5
[2024-09-19 11:29:19,999][root][INFO] - - DEV score: 87.67 [%]
[2024-09-19 11:29:19,999][root][INFO] - - TEST score: 87.97 [%]
[2024-09-19 11:29:20,000][root][INFO] - Fine-tuning is done!
[2024-09-19 11:29:55,203][root][INFO] - Step: 7000/9020  |  Loss: 0.5346  |  Score: 74.09 [%]  |  Seq Length: 128.0
[2024-09-19 11:30:33,818][root][INFO] - Step: 7100/9020  |  Loss: 0.5291  |  Score: 74.34 [%]  |  Seq Length: 128.0
[2024-09-19 11:31:11,381][root][INFO] - Step: 7200/9020  |  Loss: 0.5305  |  Score: 74.11 [%]  |  Seq Length: 128.0
[2024-09-19 11:31:17,864][root][INFO] - Step: 7216/9020  |  Loss: 0.5108  |  Score: 76.15 [%]  |  Seq Length: 128.0
[2024-09-19 11:31:49,897][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 11:31:49,897][root][INFO] - Score: 75.73 [%]  |  Evaluation Time: 32.03 [s]
[2024-09-19 11:33:38,325][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 11:33:38,325][root][INFO] - Score: 75.52 [%]  |  Evaluation Time: 108.42 [s]
[2024-09-19 11:33:38,326][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-19 11:33:38,328][root][INFO] - 
[5/ 5 Epoch]
[2024-09-19 11:34:11,114][root][INFO] - Step: 7300/9020  |  Loss: 0.5222  |  Score: 74.39 [%]  |  Seq Length: 128.0
[2024-09-19 11:34:46,789][root][INFO] - Step: 7400/9020  |  Loss: 0.5349  |  Score: 74.09 [%]  |  Seq Length: 128.0
[2024-09-19 11:35:23,262][root][INFO] - Step: 7500/9020  |  Loss: 0.5284  |  Score: 73.91 [%]  |  Seq Length: 128.0
[2024-09-19 11:35:55,941][root][INFO] - Step: 7600/9020  |  Loss: 0.5298  |  Score: 74.17 [%]  |  Seq Length: 128.0
[2024-09-19 11:36:33,159][root][INFO] - Step: 7700/9020  |  Loss: 0.5338  |  Score: 74.11 [%]  |  Seq Length: 128.0
[2024-09-19 11:37:11,187][root][INFO] - Step: 7800/9020  |  Loss: 0.5224  |  Score: 74.55 [%]  |  Seq Length: 128.0
[2024-09-19 11:37:49,325][root][INFO] - Step: 7900/9020  |  Loss: 0.5260  |  Score: 74.86 [%]  |  Seq Length: 128.0
[2024-09-19 11:38:26,939][root][INFO] - Step: 8000/9020  |  Loss: 0.5243  |  Score: 74.48 [%]  |  Seq Length: 128.0
[2024-09-19 11:39:03,603][root][INFO] - Step: 8100/9020  |  Loss: 0.5177  |  Score: 75.30 [%]  |  Seq Length: 128.0
[2024-09-19 11:39:38,892][root][INFO] - Step: 8200/9020  |  Loss: 0.5162  |  Score: 75.11 [%]  |  Seq Length: 128.0
[2024-09-19 11:40:15,483][root][INFO] - Step: 8300/9020  |  Loss: 0.5292  |  Score: 74.09 [%]  |  Seq Length: 128.0
[2024-09-19 11:40:53,007][root][INFO] - Step: 8400/9020  |  Loss: 0.5327  |  Score: 74.05 [%]  |  Seq Length: 128.0
[2024-09-19 11:41:30,259][root][INFO] - Step: 8500/9020  |  Loss: 0.5239  |  Score: 74.27 [%]  |  Seq Length: 128.0
[2024-09-19 11:42:08,680][root][INFO] - Step: 8600/9020  |  Loss: 0.5334  |  Score: 73.98 [%]  |  Seq Length: 128.0
[2024-09-19 11:42:46,907][root][INFO] - Step: 8700/9020  |  Loss: 0.5285  |  Score: 74.34 [%]  |  Seq Length: 128.0
[2024-09-19 11:43:24,044][root][INFO] - Step: 8800/9020  |  Loss: 0.5146  |  Score: 75.52 [%]  |  Seq Length: 128.0
[2024-09-19 11:44:00,639][root][INFO] - Step: 8900/9020  |  Loss: 0.5254  |  Score: 74.47 [%]  |  Seq Length: 128.0
[2024-09-19 11:44:34,842][root][INFO] - Step: 9000/9020  |  Loss: 0.5199  |  Score: 74.81 [%]  |  Seq Length: 128.0
[2024-09-19 11:44:42,199][root][INFO] - Step: 9020/9020  |  Loss: 0.4892  |  Score: 75.86 [%]  |  Seq Length: 128.0
[2024-09-19 11:45:15,304][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 11:45:15,304][root][INFO] - Score: 75.84 [%]  |  Evaluation Time: 33.10 [s]
[2024-09-19 11:47:02,264][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 11:47:02,264][root][INFO] - Score: 75.77 [%]  |  Evaluation Time: 106.96 [s]
[2024-09-19 11:47:02,266][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-19 11:47:02,266][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 11:47:02,266][root][INFO] - - Epoch: 5
[2024-09-19 11:47:02,266][root][INFO] - - DEV score: 75.84 [%]
[2024-09-19 11:47:02,266][root][INFO] - - TEST score: 75.77 [%]
[2024-09-19 11:47:02,267][root][INFO] - Fine-tuning is done!
[2024-09-19 12:14:36,388][root][INFO] - 

[2024-09-19 12:14:36,388][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 12:14:36,388][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs
[2024-09-19 12:14:36,388][root][INFO] - 

[2024-09-19 12:14:36,388][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 128, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 4, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 12:14:48,126][root][INFO] - 

[2024-09-19 12:14:48,126][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 12:14:48,126][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs
[2024-09-19 12:14:48,126][root][INFO] - 

[2024-09-19 12:14:48,126][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 128, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 4, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 12:14:57,947][root][INFO] - 

[2024-09-19 12:14:57,947][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 12:14:57,947][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs
[2024-09-19 12:14:57,948][root][INFO] - 

[2024-09-19 12:14:57,948][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 128, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 4, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 12:15:00,600][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 12:15:02,493][root][INFO] - 

[2024-09-19 12:15:02,493][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-19 12:15:02,493][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 12:15:02,501][root][INFO] - vocab size              : 51200
[2024-09-19 12:15:02,501][root][INFO] - device                  : gpu
[2024-09-19 12:15:02,501][root][INFO] - random seed             : 42
[2024-09-19 12:15:02,501][root][INFO] - train data size         : 28864
[2024-09-19 12:15:02,501][root][INFO] - max epochs              : 5
[2024-09-19 12:15:02,501][root][INFO] - total steps             : 9020
[2024-09-19 12:15:02,502][root][INFO] - warmup steps            : 902
[2024-09-19 12:15:02,502][root][INFO] - batch size              : 64
[2024-09-19 12:15:02,502][root][INFO] - accumulation steps      : 4
[2024-09-19 12:15:02,502][root][INFO] - optimizer               : adamwscale
[2024-09-19 12:15:02,502][root][INFO] - lr_scheduler            : cosine
[2024-09-19 12:15:02,502][root][INFO] - learning rate           : 0.02
[2024-09-19 12:15:02,502][root][INFO] - max length              : 128

[2024-09-19 12:15:02,502][root][INFO] - 

[2024-09-19 12:15:02,502][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs
[2024-09-19 12:15:02,502][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs/ckpt
[2024-09-19 12:15:02,502][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs/tb
[2024-09-19 12:15:02,502][root][INFO] - * tb interval           : 100

[2024-09-19 12:15:02,503][root][INFO] - 

[2024-09-19 12:15:02,503][root][INFO] - Start the Training !
[2024-09-19 12:15:02,505][root][INFO] - 
[1/ 5 Epoch]
[2024-09-19 12:15:12,532][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:12,532][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:12,533][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:12,533][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:12,533][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:12,534][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:12,534][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:12,534][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:12,535][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:12,535][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:12,535][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:12,535][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:12,536][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:12,536][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:12,536][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:12,537][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:12,537][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:12,537][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:12,538][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:12,538][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:12,538][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:12,539][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:12,539][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:12,539][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:12,541][root][INFO] - Trainable params: 884736 || all params: 126050304 || trainable: 0.70 %
[2024-09-19 12:15:12,722][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 12:15:14,632][root][INFO] - 

[2024-09-19 12:15:14,632][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-19 12:15:14,633][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 12:15:14,640][root][INFO] - vocab size              : 51200
[2024-09-19 12:15:14,641][root][INFO] - device                  : gpu
[2024-09-19 12:15:14,641][root][INFO] - random seed             : 42
[2024-09-19 12:15:14,641][root][INFO] - train data size         : 28864
[2024-09-19 12:15:14,641][root][INFO] - max epochs              : 5
[2024-09-19 12:15:14,641][root][INFO] - total steps             : 9020
[2024-09-19 12:15:14,641][root][INFO] - warmup steps            : 902
[2024-09-19 12:15:14,641][root][INFO] - batch size              : 64
[2024-09-19 12:15:14,641][root][INFO] - accumulation steps      : 4
[2024-09-19 12:15:14,641][root][INFO] - optimizer               : adamwscale
[2024-09-19 12:15:14,641][root][INFO] - lr_scheduler            : cosine
[2024-09-19 12:15:14,642][root][INFO] - learning rate           : 0.02
[2024-09-19 12:15:14,642][root][INFO] - max length              : 128

[2024-09-19 12:15:14,642][root][INFO] - LoRA Configuration
[2024-09-19 12:15:14,642][root][INFO] - ㄴ r                    : 16
[2024-09-19 12:15:14,642][root][INFO] - ㄴ alpha                : 64
[2024-09-19 12:15:14,642][root][INFO] - ㄴ dropout              : 0.03

[2024-09-19 12:15:14,642][root][INFO] - 

[2024-09-19 12:15:14,642][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs
[2024-09-19 12:15:14,642][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs/ckpt
[2024-09-19 12:15:14,642][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs/tb
[2024-09-19 12:15:14,643][root][INFO] - * tb interval           : 100

[2024-09-19 12:15:14,643][root][INFO] - 

[2024-09-19 12:15:14,643][root][INFO] - Start the Training !
[2024-09-19 12:15:14,646][root][INFO] - 
[1/ 5 Epoch]
[2024-09-19 12:15:22,374][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:22,375][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:22,375][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:22,375][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:22,376][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:22,376][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:22,377][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:22,377][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:22,377][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:22,378][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:22,378][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:22,378][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:22,378][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:22,379][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:22,379][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:22,379][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:22,380][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:22,380][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:22,380][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:22,381][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:22,381][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:22,381][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:22,382][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-19 12:15:22,382][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-19 12:15:22,384][root][INFO] - Trainable params: 884736 || all params: 126050304 || trainable: 0.70 %
[2024-09-19 12:15:22,387][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-19 12:15:22,393][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-19 12:15:22,395][root][INFO] - Trainable params: 1298304 || all params: 126463872 || trainable: 1.03 %
[2024-09-19 12:15:22,572][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 12:15:24,480][root][INFO] - 

[2024-09-19 12:15:24,480][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-19 12:15:24,480][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 12:15:24,488][root][INFO] - vocab size              : 51200
[2024-09-19 12:15:24,488][root][INFO] - device                  : gpu
[2024-09-19 12:15:24,488][root][INFO] - random seed             : 42
[2024-09-19 12:15:24,488][root][INFO] - train data size         : 28864
[2024-09-19 12:15:24,488][root][INFO] - max epochs              : 5
[2024-09-19 12:15:24,488][root][INFO] - total steps             : 9020
[2024-09-19 12:15:24,489][root][INFO] - warmup steps            : 902
[2024-09-19 12:15:24,489][root][INFO] - batch size              : 64
[2024-09-19 12:15:24,489][root][INFO] - accumulation steps      : 4
[2024-09-19 12:15:24,489][root][INFO] - optimizer               : adamwscale
[2024-09-19 12:15:24,489][root][INFO] - lr_scheduler            : cosine
[2024-09-19 12:15:24,489][root][INFO] - learning rate           : 0.02
[2024-09-19 12:15:24,489][root][INFO] - max length              : 128

[2024-09-19 12:15:24,489][root][INFO] - LoRA Configuration
[2024-09-19 12:15:24,489][root][INFO] - ㄴ r                    : 16
[2024-09-19 12:15:24,489][root][INFO] - ㄴ alpha                : 64
[2024-09-19 12:15:24,489][root][INFO] - ㄴ dropout              : 0.03

[2024-09-19 12:15:24,489][root][INFO] - KOMBO Configuration
[2024-09-19 12:15:24,490][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-19 12:15:24,490][root][INFO] - ㄴ reducer              : linear
[2024-09-19 12:15:24,490][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-19 12:15:24,490][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-19 12:15:24,490][root][INFO] - ㄴ do_combination       : False
[2024-09-19 12:15:24,490][root][INFO] - 

[2024-09-19 12:15:24,490][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs
[2024-09-19 12:15:24,490][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs/ckpt
[2024-09-19 12:15:24,490][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.02lr_42rs/tb
[2024-09-19 12:15:24,490][root][INFO] - * tb interval           : 100

[2024-09-19 12:15:24,490][root][INFO] - 

[2024-09-19 12:15:24,491][root][INFO] - Start the Training !
[2024-09-19 12:15:24,493][root][INFO] - 
[1/ 5 Epoch]
[2024-09-19 12:15:34,665][root][INFO] - Step: 100/9020  |  Loss: 0.7128  |  Score: 67.62 [%]  |  Seq Length: 128.0
[2024-09-19 12:15:44,895][root][INFO] - Step: 100/9020  |  Loss: 0.5816  |  Score: 69.56 [%]  |  Seq Length: 128.0
[2024-09-19 12:16:05,111][root][INFO] - Step: 200/9020  |  Loss: 0.4706  |  Score: 78.67 [%]  |  Seq Length: 128.0
[2024-09-19 12:16:05,290][root][INFO] - Step: 100/9020  |  Loss: 0.6445  |  Score: 63.14 [%]  |  Seq Length: 128.0
[2024-09-19 12:16:13,811][root][INFO] - Step: 200/9020  |  Loss: 0.4273  |  Score: 80.27 [%]  |  Seq Length: 128.0
[2024-09-19 12:16:35,544][root][INFO] - Step: 300/9020  |  Loss: 0.4347  |  Score: 80.44 [%]  |  Seq Length: 128.0
[2024-09-19 12:16:42,550][root][INFO] - Step: 300/9020  |  Loss: 0.3947  |  Score: 82.42 [%]  |  Seq Length: 128.0
[2024-09-19 12:16:44,288][root][INFO] - Step: 200/9020  |  Loss: 0.4689  |  Score: 78.06 [%]  |  Seq Length: 128.0
[2024-09-19 12:17:06,585][root][INFO] - Step: 400/9020  |  Loss: 0.4044  |  Score: 81.38 [%]  |  Seq Length: 128.0
[2024-09-19 12:17:10,834][root][INFO] - Step: 400/9020  |  Loss: 0.4059  |  Score: 81.86 [%]  |  Seq Length: 128.0
[2024-09-19 12:17:23,802][root][INFO] - Step: 300/9020  |  Loss: 0.4342  |  Score: 79.95 [%]  |  Seq Length: 128.0
[2024-09-19 12:17:36,807][root][INFO] - Step: 500/9020  |  Loss: 0.4114  |  Score: 81.97 [%]  |  Seq Length: 128.0
[2024-09-19 12:17:39,554][root][INFO] - Step: 500/9020  |  Loss: 0.3820  |  Score: 83.09 [%]  |  Seq Length: 128.0
[2024-09-19 12:18:03,859][root][INFO] - Step: 400/9020  |  Loss: 0.4197  |  Score: 81.47 [%]  |  Seq Length: 128.0
[2024-09-19 12:18:07,315][root][INFO] - Step: 600/9020  |  Loss: 0.4015  |  Score: 81.83 [%]  |  Seq Length: 128.0
[2024-09-19 12:18:08,355][root][INFO] - Step: 600/9020  |  Loss: 0.3603  |  Score: 84.45 [%]  |  Seq Length: 128.0
[2024-09-19 12:18:36,576][root][INFO] - Step: 700/9020  |  Loss: 0.3739  |  Score: 83.56 [%]  |  Seq Length: 128.0
[2024-09-19 12:18:38,123][root][INFO] - Step: 700/9020  |  Loss: 0.4165  |  Score: 81.80 [%]  |  Seq Length: 128.0
[2024-09-19 12:18:43,771][root][INFO] - Step: 500/9020  |  Loss: 0.5131  |  Score: 74.17 [%]  |  Seq Length: 128.0
[2024-09-19 12:19:05,001][root][INFO] - Step: 800/9020  |  Loss: 0.3571  |  Score: 84.42 [%]  |  Seq Length: 128.0
[2024-09-19 12:19:08,884][root][INFO] - Step: 800/9020  |  Loss: 0.4076  |  Score: 81.58 [%]  |  Seq Length: 128.0
[2024-09-19 12:19:22,061][root][INFO] - Step: 600/9020  |  Loss: 0.4797  |  Score: 76.95 [%]  |  Seq Length: 128.0
[2024-09-19 12:19:32,333][root][INFO] - Step: 900/9020  |  Loss: 0.3649  |  Score: 84.62 [%]  |  Seq Length: 128.0
[2024-09-19 12:19:39,879][root][INFO] - Step: 900/9020  |  Loss: 0.3895  |  Score: 82.92 [%]  |  Seq Length: 128.0
[2024-09-19 12:20:00,567][root][INFO] - Step: 1000/9020  |  Loss: 0.3736  |  Score: 83.47 [%]  |  Seq Length: 128.0
[2024-09-19 12:20:01,024][root][INFO] - Step: 700/9020  |  Loss: 0.4571  |  Score: 78.75 [%]  |  Seq Length: 128.0
[2024-09-19 12:20:10,597][root][INFO] - Step: 1000/9020  |  Loss: 0.4181  |  Score: 80.86 [%]  |  Seq Length: 128.0
[2024-09-19 12:20:28,593][root][INFO] - Step: 1100/9020  |  Loss: 0.3502  |  Score: 84.66 [%]  |  Seq Length: 128.0
[2024-09-19 12:20:40,089][root][INFO] - Step: 800/9020  |  Loss: 0.4435  |  Score: 78.92 [%]  |  Seq Length: 128.0
[2024-09-19 12:20:40,655][root][INFO] - Step: 1100/9020  |  Loss: 0.3843  |  Score: 82.98 [%]  |  Seq Length: 128.0
[2024-09-19 12:20:56,582][root][INFO] - Step: 1200/9020  |  Loss: 0.3411  |  Score: 84.78 [%]  |  Seq Length: 128.0
[2024-09-19 12:21:10,611][root][INFO] - Step: 1200/9020  |  Loss: 0.3828  |  Score: 83.47 [%]  |  Seq Length: 128.0
[2024-09-19 12:21:19,662][root][INFO] - Step: 900/9020  |  Loss: 0.4463  |  Score: 79.08 [%]  |  Seq Length: 128.0
[2024-09-19 12:21:24,614][root][INFO] - Step: 1300/9020  |  Loss: 0.3456  |  Score: 84.84 [%]  |  Seq Length: 128.0
[2024-09-19 12:21:41,241][root][INFO] - Step: 1300/9020  |  Loss: 0.3715  |  Score: 83.28 [%]  |  Seq Length: 128.0
[2024-09-19 12:21:52,575][root][INFO] - Step: 1400/9020  |  Loss: 0.3423  |  Score: 85.20 [%]  |  Seq Length: 128.0
[2024-09-19 12:21:59,158][root][INFO] - Step: 1000/9020  |  Loss: 0.4764  |  Score: 77.05 [%]  |  Seq Length: 128.0
[2024-09-19 12:22:11,745][root][INFO] - Step: 1400/9020  |  Loss: 0.3894  |  Score: 83.03 [%]  |  Seq Length: 128.0
[2024-09-19 12:22:19,800][root][INFO] - Step: 1500/9020  |  Loss: 0.3433  |  Score: 85.42 [%]  |  Seq Length: 128.0
[2024-09-19 12:22:38,584][root][INFO] - Step: 1100/9020  |  Loss: 0.4879  |  Score: 76.25 [%]  |  Seq Length: 128.0
[2024-09-19 12:22:41,779][root][INFO] - Step: 1500/9020  |  Loss: 0.3761  |  Score: 83.30 [%]  |  Seq Length: 128.0
[2024-09-19 12:22:46,742][root][INFO] - Step: 1600/9020  |  Loss: 0.3402  |  Score: 85.44 [%]  |  Seq Length: 128.0
[2024-09-19 12:23:12,475][root][INFO] - Step: 1600/9020  |  Loss: 0.3822  |  Score: 82.98 [%]  |  Seq Length: 128.0
[2024-09-19 12:23:15,367][root][INFO] - Step: 1700/9020  |  Loss: 0.3409  |  Score: 85.05 [%]  |  Seq Length: 128.0
[2024-09-19 12:23:17,842][root][INFO] - Step: 1200/9020  |  Loss: 0.4496  |  Score: 78.59 [%]  |  Seq Length: 128.0
[2024-09-19 12:23:42,522][root][INFO] - Step: 1800/9020  |  Loss: 0.3286  |  Score: 85.75 [%]  |  Seq Length: 128.0
[2024-09-19 12:23:42,597][root][INFO] - Step: 1700/9020  |  Loss: 0.3690  |  Score: 83.58 [%]  |  Seq Length: 128.0
[2024-09-19 12:23:43,680][root][INFO] - Step: 1804/9020  |  Loss: 0.2808  |  Score: 87.03 [%]  |  Seq Length: 128.0
[2024-09-19 12:23:57,985][root][INFO] - Step: 1300/9020  |  Loss: 0.4920  |  Score: 76.25 [%]  |  Seq Length: 128.0
[2024-09-19 12:24:03,084][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 12:24:03,084][root][INFO] - Score: 86.38 [%]  |  Evaluation Time: 19.40 [s]
[2024-09-19 12:24:13,367][root][INFO] - Step: 1800/9020  |  Loss: 0.3758  |  Score: 82.97 [%]  |  Seq Length: 128.0
[2024-09-19 12:24:14,719][root][INFO] - Step: 1804/9020  |  Loss: 0.3306  |  Score: 87.50 [%]  |  Seq Length: 128.0
[2024-09-19 12:24:32,948][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 12:24:32,948][root][INFO] - Score: 84.04 [%]  |  Evaluation Time: 18.23 [s]
[2024-09-19 12:24:37,700][root][INFO] - Step: 1400/9020  |  Loss: 0.4858  |  Score: 76.28 [%]  |  Seq Length: 128.0
[2024-09-19 12:25:06,643][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 12:25:06,643][root][INFO] - Score: 86.21 [%]  |  Evaluation Time: 63.56 [s]
[2024-09-19 12:25:06,644][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 12:25:06,645][root][INFO] - 
[2/ 5 Epoch]
[2024-09-19 12:25:17,489][root][INFO] - Step: 1500/9020  |  Loss: 0.5439  |  Score: 71.17 [%]  |  Seq Length: 128.0
[2024-09-19 12:25:31,647][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 12:25:31,647][root][INFO] - Score: 83.72 [%]  |  Evaluation Time: 58.70 [s]
[2024-09-19 12:25:31,649][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 12:25:31,650][root][INFO] - 
[2/ 5 Epoch]
[2024-09-19 12:25:32,228][root][INFO] - Step: 1900/9020  |  Loss: 0.3145  |  Score: 86.46 [%]  |  Seq Length: 128.0
[2024-09-19 12:25:56,730][root][INFO] - Step: 1600/9020  |  Loss: 0.4980  |  Score: 75.48 [%]  |  Seq Length: 128.0
[2024-09-19 12:26:00,036][root][INFO] - Step: 2000/9020  |  Loss: 0.3154  |  Score: 86.22 [%]  |  Seq Length: 128.0
[2024-09-19 12:26:01,364][root][INFO] - Step: 1900/9020  |  Loss: 0.2976  |  Score: 87.50 [%]  |  Seq Length: 128.0
[2024-09-19 12:26:27,789][root][INFO] - Step: 2100/9020  |  Loss: 0.3115  |  Score: 86.86 [%]  |  Seq Length: 128.0
[2024-09-19 12:26:31,936][root][INFO] - Step: 2000/9020  |  Loss: 0.3053  |  Score: 86.80 [%]  |  Seq Length: 128.0
[2024-09-19 12:26:34,967][root][INFO] - Step: 1700/9020  |  Loss: 0.4542  |  Score: 78.59 [%]  |  Seq Length: 128.0
[2024-09-19 12:26:54,351][root][INFO] - Step: 2200/9020  |  Loss: 0.3174  |  Score: 86.73 [%]  |  Seq Length: 128.0
[2024-09-19 12:27:02,756][root][INFO] - Step: 2100/9020  |  Loss: 0.3007  |  Score: 87.03 [%]  |  Seq Length: 128.0
[2024-09-19 12:27:13,489][root][INFO] - Step: 1800/9020  |  Loss: 0.4471  |  Score: 78.86 [%]  |  Seq Length: 128.0
[2024-09-19 12:27:15,024][root][INFO] - Step: 1804/9020  |  Loss: 0.5065  |  Score: 74.77 [%]  |  Seq Length: 128.0
[2024-09-19 12:27:22,569][root][INFO] - Step: 2300/9020  |  Loss: 0.3172  |  Score: 86.55 [%]  |  Seq Length: 128.0
[2024-09-19 12:27:33,043][root][INFO] - Step: 2200/9020  |  Loss: 0.3115  |  Score: 86.66 [%]  |  Seq Length: 128.0
[2024-09-19 12:27:47,639][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 12:27:47,639][root][INFO] - Score: 78.12 [%]  |  Evaluation Time: 32.61 [s]
[2024-09-19 12:27:50,275][root][INFO] - Step: 2400/9020  |  Loss: 0.3088  |  Score: 87.23 [%]  |  Seq Length: 128.0
[2024-09-19 12:28:04,289][root][INFO] - Step: 2300/9020  |  Loss: 0.3141  |  Score: 86.69 [%]  |  Seq Length: 128.0
[2024-09-19 12:28:18,320][root][INFO] - Step: 2500/9020  |  Loss: 0.3268  |  Score: 85.77 [%]  |  Seq Length: 128.0
[2024-09-19 12:28:34,867][root][INFO] - Step: 2400/9020  |  Loss: 0.3096  |  Score: 86.77 [%]  |  Seq Length: 128.0
[2024-09-19 12:28:46,241][root][INFO] - Step: 2600/9020  |  Loss: 0.3175  |  Score: 86.47 [%]  |  Seq Length: 128.0
[2024-09-19 12:29:05,973][root][INFO] - Step: 2500/9020  |  Loss: 0.3173  |  Score: 86.17 [%]  |  Seq Length: 128.0
[2024-09-19 12:29:14,378][root][INFO] - Step: 2700/9020  |  Loss: 0.3005  |  Score: 87.11 [%]  |  Seq Length: 128.0
[2024-09-19 12:29:34,884][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 12:29:34,885][root][INFO] - Score: 78.47 [%]  |  Evaluation Time: 107.24 [s]
[2024-09-19 12:29:34,886][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 12:29:34,887][root][INFO] - 
[2/ 5 Epoch]
[2024-09-19 12:29:36,844][root][INFO] - Step: 2600/9020  |  Loss: 0.3076  |  Score: 86.92 [%]  |  Seq Length: 128.0
[2024-09-19 12:29:42,049][root][INFO] - Step: 2800/9020  |  Loss: 0.3254  |  Score: 86.36 [%]  |  Seq Length: 128.0
[2024-09-19 12:30:07,310][root][INFO] - Step: 2700/9020  |  Loss: 0.3189  |  Score: 86.56 [%]  |  Seq Length: 128.0
[2024-09-19 12:30:10,675][root][INFO] - Step: 2900/9020  |  Loss: 0.3127  |  Score: 86.34 [%]  |  Seq Length: 128.0
[2024-09-19 12:30:13,202][root][INFO] - Step: 1900/9020  |  Loss: 0.4469  |  Score: 79.25 [%]  |  Seq Length: 128.0
[2024-09-19 12:30:38,214][root][INFO] - Step: 2800/9020  |  Loss: 0.3250  |  Score: 86.08 [%]  |  Seq Length: 128.0
[2024-09-19 12:30:38,833][root][INFO] - Step: 3000/9020  |  Loss: 0.3161  |  Score: 86.14 [%]  |  Seq Length: 128.0
[2024-09-19 12:30:52,421][root][INFO] - Step: 2000/9020  |  Loss: 0.4150  |  Score: 80.47 [%]  |  Seq Length: 128.0
[2024-09-19 12:31:06,354][root][INFO] - Step: 3100/9020  |  Loss: 0.3070  |  Score: 86.92 [%]  |  Seq Length: 128.0
[2024-09-19 12:31:08,760][root][INFO] - Step: 2900/9020  |  Loss: 0.3058  |  Score: 87.22 [%]  |  Seq Length: 128.0
[2024-09-19 12:31:31,538][root][INFO] - Step: 2100/9020  |  Loss: 0.4051  |  Score: 81.44 [%]  |  Seq Length: 128.0
[2024-09-19 12:31:34,230][root][INFO] - Step: 3200/9020  |  Loss: 0.3004  |  Score: 87.31 [%]  |  Seq Length: 128.0
[2024-09-19 12:31:40,031][root][INFO] - Step: 3000/9020  |  Loss: 0.3192  |  Score: 86.44 [%]  |  Seq Length: 128.0
[2024-09-19 12:32:01,403][root][INFO] - Step: 3300/9020  |  Loss: 0.3074  |  Score: 87.11 [%]  |  Seq Length: 128.0
[2024-09-19 12:32:10,205][root][INFO] - Step: 2200/9020  |  Loss: 0.4007  |  Score: 82.22 [%]  |  Seq Length: 128.0
[2024-09-19 12:32:10,397][root][INFO] - Step: 3100/9020  |  Loss: 0.3152  |  Score: 86.98 [%]  |  Seq Length: 128.0
[2024-09-19 12:32:28,762][root][INFO] - Step: 3400/9020  |  Loss: 0.3123  |  Score: 86.39 [%]  |  Seq Length: 128.0
[2024-09-19 12:32:42,233][root][INFO] - Step: 3200/9020  |  Loss: 0.3153  |  Score: 86.09 [%]  |  Seq Length: 128.0
[2024-09-19 12:32:49,041][root][INFO] - Step: 2300/9020  |  Loss: 0.3922  |  Score: 82.44 [%]  |  Seq Length: 128.0
[2024-09-19 12:32:57,055][root][INFO] - Step: 3500/9020  |  Loss: 0.3124  |  Score: 86.67 [%]  |  Seq Length: 128.0
[2024-09-19 12:33:13,146][root][INFO] - Step: 3300/9020  |  Loss: 0.3111  |  Score: 86.77 [%]  |  Seq Length: 128.0
[2024-09-19 12:33:25,269][root][INFO] - Step: 3600/9020  |  Loss: 0.3130  |  Score: 86.23 [%]  |  Seq Length: 128.0
[2024-09-19 12:33:27,621][root][INFO] - Step: 3608/9020  |  Loss: 0.3088  |  Score: 86.88 [%]  |  Seq Length: 128.0
[2024-09-19 12:33:28,056][root][INFO] - Step: 2400/9020  |  Loss: 0.4096  |  Score: 81.28 [%]  |  Seq Length: 128.0
[2024-09-19 12:33:44,241][root][INFO] - Step: 3400/9020  |  Loss: 0.3207  |  Score: 85.89 [%]  |  Seq Length: 128.0
[2024-09-19 12:33:47,098][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 12:33:47,098][root][INFO] - Score: 87.11 [%]  |  Evaluation Time: 19.47 [s]
[2024-09-19 12:34:07,006][root][INFO] - Step: 2500/9020  |  Loss: 0.3704  |  Score: 83.48 [%]  |  Seq Length: 128.0
[2024-09-19 12:34:15,134][root][INFO] - Step: 3500/9020  |  Loss: 0.3186  |  Score: 86.00 [%]  |  Seq Length: 128.0
[2024-09-19 12:34:45,597][root][INFO] - Step: 2600/9020  |  Loss: 0.3942  |  Score: 82.67 [%]  |  Seq Length: 128.0
[2024-09-19 12:34:46,344][root][INFO] - Step: 3600/9020  |  Loss: 0.3185  |  Score: 86.44 [%]  |  Seq Length: 128.0
[2024-09-19 12:34:48,686][root][INFO] - Step: 3608/9020  |  Loss: 0.3188  |  Score: 86.09 [%]  |  Seq Length: 128.0
[2024-09-19 12:34:50,622][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 12:34:50,623][root][INFO] - Score: 87.22 [%]  |  Evaluation Time: 63.52 [s]
[2024-09-19 12:34:50,624][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 12:34:50,625][root][INFO] - 
[3/ 5 Epoch]
[2024-09-19 12:35:07,044][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 12:35:07,044][root][INFO] - Score: 83.72 [%]  |  Evaluation Time: 18.36 [s]
[2024-09-19 12:35:13,943][root][INFO] - Step: 3700/9020  |  Loss: 0.2724  |  Score: 88.76 [%]  |  Seq Length: 128.0
[2024-09-19 12:35:24,756][root][INFO] - Step: 2700/9020  |  Loss: 0.3667  |  Score: 84.17 [%]  |  Seq Length: 128.0
[2024-09-19 12:35:42,286][root][INFO] - Step: 3800/9020  |  Loss: 0.2866  |  Score: 87.42 [%]  |  Seq Length: 128.0
[2024-09-19 12:36:04,408][root][INFO] - Step: 2800/9020  |  Loss: 0.3789  |  Score: 82.94 [%]  |  Seq Length: 128.0
[2024-09-19 12:36:06,143][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 12:36:06,143][root][INFO] - Score: 84.03 [%]  |  Evaluation Time: 59.10 [s]
[2024-09-19 12:36:06,145][root][INFO] - 
[3/ 5 Epoch]
[2024-09-19 12:36:11,196][root][INFO] - Step: 3900/9020  |  Loss: 0.2811  |  Score: 88.42 [%]  |  Seq Length: 128.0
[2024-09-19 12:36:34,248][root][INFO] - Step: 3700/9020  |  Loss: 0.2296  |  Score: 91.03 [%]  |  Seq Length: 128.0
[2024-09-19 12:36:39,391][root][INFO] - Step: 4000/9020  |  Loss: 0.2894  |  Score: 87.97 [%]  |  Seq Length: 128.0
[2024-09-19 12:36:43,586][root][INFO] - Step: 2900/9020  |  Loss: 0.3626  |  Score: 83.81 [%]  |  Seq Length: 128.0
[2024-09-19 12:37:05,187][root][INFO] - Step: 3800/9020  |  Loss: 0.2335  |  Score: 90.44 [%]  |  Seq Length: 128.0
[2024-09-19 12:37:08,303][root][INFO] - Step: 4100/9020  |  Loss: 0.2766  |  Score: 88.19 [%]  |  Seq Length: 128.0
[2024-09-19 12:37:21,915][root][INFO] - Step: 3000/9020  |  Loss: 0.3475  |  Score: 84.36 [%]  |  Seq Length: 128.0
[2024-09-19 12:37:35,968][root][INFO] - Step: 3900/9020  |  Loss: 0.2292  |  Score: 90.72 [%]  |  Seq Length: 128.0
[2024-09-19 12:37:37,189][root][INFO] - Step: 4200/9020  |  Loss: 0.2695  |  Score: 88.50 [%]  |  Seq Length: 128.0
[2024-09-19 12:38:00,219][root][INFO] - Step: 3100/9020  |  Loss: 0.3602  |  Score: 83.98 [%]  |  Seq Length: 128.0
[2024-09-19 12:38:05,012][root][INFO] - Step: 4300/9020  |  Loss: 0.2742  |  Score: 88.16 [%]  |  Seq Length: 128.0
[2024-09-19 12:38:06,902][root][INFO] - Step: 4000/9020  |  Loss: 0.2375  |  Score: 89.84 [%]  |  Seq Length: 128.0
[2024-09-19 12:38:33,338][root][INFO] - Step: 4400/9020  |  Loss: 0.2761  |  Score: 88.45 [%]  |  Seq Length: 128.0
[2024-09-19 12:38:37,381][root][INFO] - Step: 4100/9020  |  Loss: 0.2305  |  Score: 90.55 [%]  |  Seq Length: 128.0
[2024-09-19 12:38:38,573][root][INFO] - Step: 3200/9020  |  Loss: 0.3475  |  Score: 84.80 [%]  |  Seq Length: 128.0
[2024-09-19 12:39:02,132][root][INFO] - Step: 4500/9020  |  Loss: 0.2869  |  Score: 88.00 [%]  |  Seq Length: 128.0
[2024-09-19 12:39:07,454][root][INFO] - Step: 4200/9020  |  Loss: 0.2459  |  Score: 89.48 [%]  |  Seq Length: 128.0
[2024-09-19 12:39:17,399][root][INFO] - Step: 3300/9020  |  Loss: 0.3490  |  Score: 84.69 [%]  |  Seq Length: 128.0
[2024-09-19 12:39:30,611][root][INFO] - Step: 4600/9020  |  Loss: 0.2856  |  Score: 87.78 [%]  |  Seq Length: 128.0
[2024-09-19 12:39:38,591][root][INFO] - Step: 4300/9020  |  Loss: 0.2420  |  Score: 89.91 [%]  |  Seq Length: 128.0
[2024-09-19 12:39:52,659][root][INFO] - Step: 3400/9020  |  Loss: 0.3453  |  Score: 84.47 [%]  |  Seq Length: 128.0
[2024-09-19 12:39:58,938][root][INFO] - Step: 4700/9020  |  Loss: 0.2965  |  Score: 87.27 [%]  |  Seq Length: 128.0
[2024-09-19 12:40:08,983][root][INFO] - Step: 4400/9020  |  Loss: 0.2324  |  Score: 90.28 [%]  |  Seq Length: 128.0
[2024-09-19 12:40:27,369][root][INFO] - Step: 4800/9020  |  Loss: 0.2799  |  Score: 88.09 [%]  |  Seq Length: 128.0
[2024-09-19 12:40:31,045][root][INFO] - Step: 3500/9020  |  Loss: 0.3427  |  Score: 85.59 [%]  |  Seq Length: 128.0
[2024-09-19 12:40:39,125][root][INFO] - Step: 4500/9020  |  Loss: 0.2434  |  Score: 89.62 [%]  |  Seq Length: 128.0
[2024-09-19 12:40:56,158][root][INFO] - Step: 4900/9020  |  Loss: 0.2838  |  Score: 88.33 [%]  |  Seq Length: 128.0
[2024-09-19 12:41:08,375][root][INFO] - Step: 3600/9020  |  Loss: 0.3431  |  Score: 85.02 [%]  |  Seq Length: 128.0
[2024-09-19 12:41:09,267][root][INFO] - Step: 4600/9020  |  Loss: 0.2318  |  Score: 90.27 [%]  |  Seq Length: 128.0
[2024-09-19 12:41:11,486][root][INFO] - Step: 3608/9020  |  Loss: 0.3977  |  Score: 84.14 [%]  |  Seq Length: 128.0
[2024-09-19 12:41:25,197][root][INFO] - Step: 5000/9020  |  Loss: 0.2757  |  Score: 88.52 [%]  |  Seq Length: 128.0
[2024-09-19 12:41:40,274][root][INFO] - Step: 4700/9020  |  Loss: 0.2453  |  Score: 89.42 [%]  |  Seq Length: 128.0
[2024-09-19 12:41:44,309][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 12:41:44,309][root][INFO] - Score: 82.94 [%]  |  Evaluation Time: 32.82 [s]
[2024-09-19 12:41:54,291][root][INFO] - Step: 5100/9020  |  Loss: 0.2785  |  Score: 88.48 [%]  |  Seq Length: 128.0
[2024-09-19 12:42:10,732][root][INFO] - Step: 4800/9020  |  Loss: 0.2472  |  Score: 89.95 [%]  |  Seq Length: 128.0
[2024-09-19 12:42:23,148][root][INFO] - Step: 5200/9020  |  Loss: 0.2694  |  Score: 88.64 [%]  |  Seq Length: 128.0
[2024-09-19 12:42:40,011][root][INFO] - Step: 4900/9020  |  Loss: 0.2388  |  Score: 90.33 [%]  |  Seq Length: 128.0
[2024-09-19 12:42:51,943][root][INFO] - Step: 5300/9020  |  Loss: 0.2783  |  Score: 88.36 [%]  |  Seq Length: 128.0
[2024-09-19 12:43:10,866][root][INFO] - Step: 5000/9020  |  Loss: 0.2542  |  Score: 89.52 [%]  |  Seq Length: 128.0
[2024-09-19 12:43:18,679][root][INFO] - Step: 5400/9020  |  Loss: 0.2687  |  Score: 88.41 [%]  |  Seq Length: 128.0
[2024-09-19 12:43:22,217][root][INFO] - Step: 5412/9020  |  Loss: 0.2676  |  Score: 89.45 [%]  |  Seq Length: 128.0
[2024-09-19 12:43:33,086][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 12:43:33,087][root][INFO] - Score: 83.11 [%]  |  Evaluation Time: 108.77 [s]
[2024-09-19 12:43:33,089][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 12:43:33,092][root][INFO] - 
[3/ 5 Epoch]
[2024-09-19 12:43:41,593][root][INFO] - Step: 5100/9020  |  Loss: 0.2423  |  Score: 90.00 [%]  |  Seq Length: 128.0
[2024-09-19 12:43:41,830][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 12:43:41,830][root][INFO] - Score: 87.62 [%]  |  Evaluation Time: 19.61 [s]
[2024-09-19 12:44:08,989][root][INFO] - Step: 3700/9020  |  Loss: 0.3231  |  Score: 86.33 [%]  |  Seq Length: 128.0
[2024-09-19 12:44:12,047][root][INFO] - Step: 5200/9020  |  Loss: 0.2451  |  Score: 89.95 [%]  |  Seq Length: 128.0
[2024-09-19 12:44:43,508][root][INFO] - Step: 5300/9020  |  Loss: 0.2463  |  Score: 90.06 [%]  |  Seq Length: 128.0
[2024-09-19 12:44:45,589][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 12:44:45,589][root][INFO] - Score: 87.79 [%]  |  Evaluation Time: 63.76 [s]
[2024-09-19 12:44:45,590][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-19 12:44:45,591][root][INFO] - 
[4/ 5 Epoch]
[2024-09-19 12:44:47,422][root][INFO] - Step: 3800/9020  |  Loss: 0.3388  |  Score: 85.41 [%]  |  Seq Length: 128.0
[2024-09-19 12:45:10,862][root][INFO] - Step: 5500/9020  |  Loss: 0.2523  |  Score: 89.35 [%]  |  Seq Length: 128.0
[2024-09-19 12:45:14,746][root][INFO] - Step: 5400/9020  |  Loss: 0.2348  |  Score: 90.23 [%]  |  Seq Length: 128.0
[2024-09-19 12:45:18,395][root][INFO] - Step: 5412/9020  |  Loss: 0.2608  |  Score: 89.30 [%]  |  Seq Length: 128.0
[2024-09-19 12:45:25,748][root][INFO] - Step: 3900/9020  |  Loss: 0.3349  |  Score: 85.78 [%]  |  Seq Length: 128.0
[2024-09-19 12:45:37,083][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 12:45:37,083][root][INFO] - Score: 83.83 [%]  |  Evaluation Time: 18.69 [s]
[2024-09-19 12:45:39,045][root][INFO] - Step: 5600/9020  |  Loss: 0.2454  |  Score: 90.11 [%]  |  Seq Length: 128.0
[2024-09-19 12:46:03,851][root][INFO] - Step: 4000/9020  |  Loss: 0.3264  |  Score: 86.61 [%]  |  Seq Length: 128.0
[2024-09-19 12:46:07,603][root][INFO] - Step: 5700/9020  |  Loss: 0.2414  |  Score: 89.92 [%]  |  Seq Length: 128.0
[2024-09-19 12:46:36,414][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 12:46:36,414][root][INFO] - Score: 83.85 [%]  |  Evaluation Time: 59.33 [s]
[2024-09-19 12:46:36,417][root][INFO] - 
[4/ 5 Epoch]
[2024-09-19 12:46:36,454][root][INFO] - Step: 5800/9020  |  Loss: 0.2382  |  Score: 90.06 [%]  |  Seq Length: 128.0
[2024-09-19 12:46:39,806][root][INFO] - Step: 4100/9020  |  Loss: 0.3304  |  Score: 85.89 [%]  |  Seq Length: 128.0
[2024-09-19 12:47:03,825][root][INFO] - Step: 5500/9020  |  Loss: 0.1540  |  Score: 94.03 [%]  |  Seq Length: 128.0
[2024-09-19 12:47:04,819][root][INFO] - Step: 5900/9020  |  Loss: 0.2390  |  Score: 90.22 [%]  |  Seq Length: 128.0
[2024-09-19 12:47:17,545][root][INFO] - Step: 4200/9020  |  Loss: 0.3038  |  Score: 87.08 [%]  |  Seq Length: 128.0
[2024-09-19 12:47:33,280][root][INFO] - Step: 6000/9020  |  Loss: 0.2322  |  Score: 90.47 [%]  |  Seq Length: 128.0
[2024-09-19 12:47:35,579][root][INFO] - Step: 5600/9020  |  Loss: 0.1490  |  Score: 94.14 [%]  |  Seq Length: 128.0
[2024-09-19 12:47:53,528][root][INFO] - Step: 4300/9020  |  Loss: 0.3192  |  Score: 86.45 [%]  |  Seq Length: 128.0
[2024-09-19 12:48:02,401][root][INFO] - Step: 6100/9020  |  Loss: 0.2336  |  Score: 90.50 [%]  |  Seq Length: 128.0
[2024-09-19 12:48:06,453][root][INFO] - Step: 5700/9020  |  Loss: 0.1681  |  Score: 93.48 [%]  |  Seq Length: 128.0
[2024-09-19 12:48:30,682][root][INFO] - Step: 6200/9020  |  Loss: 0.2413  |  Score: 89.56 [%]  |  Seq Length: 128.0
[2024-09-19 12:48:31,879][root][INFO] - Step: 4400/9020  |  Loss: 0.3241  |  Score: 86.19 [%]  |  Seq Length: 128.0
[2024-09-19 12:48:36,932][root][INFO] - Step: 5800/9020  |  Loss: 0.1645  |  Score: 93.91 [%]  |  Seq Length: 128.0
[2024-09-19 12:48:58,141][root][INFO] - Step: 6300/9020  |  Loss: 0.2403  |  Score: 89.94 [%]  |  Seq Length: 128.0
[2024-09-19 12:49:07,605][root][INFO] - Step: 5900/9020  |  Loss: 0.1681  |  Score: 93.55 [%]  |  Seq Length: 128.0
[2024-09-19 12:49:09,198][root][INFO] - Step: 4500/9020  |  Loss: 0.3090  |  Score: 86.95 [%]  |  Seq Length: 128.0
[2024-09-19 12:49:27,212][root][INFO] - Step: 6400/9020  |  Loss: 0.2356  |  Score: 90.30 [%]  |  Seq Length: 128.0
[2024-09-19 12:49:38,119][root][INFO] - Step: 6000/9020  |  Loss: 0.1743  |  Score: 93.11 [%]  |  Seq Length: 128.0
[2024-09-19 12:49:47,995][root][INFO] - Step: 4600/9020  |  Loss: 0.3135  |  Score: 86.64 [%]  |  Seq Length: 128.0
[2024-09-19 12:49:56,187][root][INFO] - Step: 6500/9020  |  Loss: 0.2363  |  Score: 90.38 [%]  |  Seq Length: 128.0
[2024-09-19 12:50:08,624][root][INFO] - Step: 6100/9020  |  Loss: 0.1715  |  Score: 93.16 [%]  |  Seq Length: 128.0
[2024-09-19 12:50:24,875][root][INFO] - Step: 6600/9020  |  Loss: 0.2347  |  Score: 90.06 [%]  |  Seq Length: 128.0
[2024-09-19 12:50:26,394][root][INFO] - Step: 4700/9020  |  Loss: 0.3133  |  Score: 86.16 [%]  |  Seq Length: 128.0
[2024-09-19 12:50:39,149][root][INFO] - Step: 6200/9020  |  Loss: 0.1613  |  Score: 93.59 [%]  |  Seq Length: 128.0
[2024-09-19 12:50:53,471][root][INFO] - Step: 6700/9020  |  Loss: 0.2410  |  Score: 89.86 [%]  |  Seq Length: 128.0
[2024-09-19 12:51:05,349][root][INFO] - Step: 4800/9020  |  Loss: 0.3097  |  Score: 86.67 [%]  |  Seq Length: 128.0
[2024-09-19 12:51:09,430][root][INFO] - Step: 6300/9020  |  Loss: 0.1605  |  Score: 93.53 [%]  |  Seq Length: 128.0
[2024-09-19 12:51:21,943][root][INFO] - Step: 6800/9020  |  Loss: 0.2293  |  Score: 90.88 [%]  |  Seq Length: 128.0
[2024-09-19 12:51:39,885][root][INFO] - Step: 6400/9020  |  Loss: 0.1598  |  Score: 93.31 [%]  |  Seq Length: 128.0
[2024-09-19 12:51:43,652][root][INFO] - Step: 4900/9020  |  Loss: 0.3070  |  Score: 87.20 [%]  |  Seq Length: 128.0
[2024-09-19 12:51:50,477][root][INFO] - Step: 6900/9020  |  Loss: 0.2376  |  Score: 90.33 [%]  |  Seq Length: 128.0
[2024-09-19 12:52:10,779][root][INFO] - Step: 6500/9020  |  Loss: 0.1615  |  Score: 93.58 [%]  |  Seq Length: 128.0
[2024-09-19 12:52:19,062][root][INFO] - Step: 7000/9020  |  Loss: 0.2311  |  Score: 90.42 [%]  |  Seq Length: 128.0
[2024-09-19 12:52:21,585][root][INFO] - Step: 5000/9020  |  Loss: 0.2990  |  Score: 87.30 [%]  |  Seq Length: 128.0
[2024-09-19 12:52:42,358][root][INFO] - Step: 6600/9020  |  Loss: 0.1617  |  Score: 93.50 [%]  |  Seq Length: 128.0
[2024-09-19 12:52:48,155][root][INFO] - Step: 7100/9020  |  Loss: 0.2403  |  Score: 90.17 [%]  |  Seq Length: 128.0
[2024-09-19 12:52:59,621][root][INFO] - Step: 5100/9020  |  Loss: 0.3142  |  Score: 86.39 [%]  |  Seq Length: 128.0
[2024-09-19 12:53:13,438][root][INFO] - Step: 6700/9020  |  Loss: 0.1591  |  Score: 93.55 [%]  |  Seq Length: 128.0
[2024-09-19 12:53:16,235][root][INFO] - Step: 7200/9020  |  Loss: 0.2434  |  Score: 90.11 [%]  |  Seq Length: 128.0
[2024-09-19 12:53:21,009][root][INFO] - Step: 7216/9020  |  Loss: 0.2366  |  Score: 90.33 [%]  |  Seq Length: 128.0
[2024-09-19 12:53:38,381][root][INFO] - Step: 5200/9020  |  Loss: 0.3044  |  Score: 86.94 [%]  |  Seq Length: 128.0
[2024-09-19 12:53:40,457][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 12:53:40,457][root][INFO] - Score: 88.30 [%]  |  Evaluation Time: 19.45 [s]
[2024-09-19 12:53:44,222][root][INFO] - Step: 6800/9020  |  Loss: 0.1582  |  Score: 93.69 [%]  |  Seq Length: 128.0
[2024-09-19 12:54:15,098][root][INFO] - Step: 6900/9020  |  Loss: 0.1602  |  Score: 93.31 [%]  |  Seq Length: 128.0
[2024-09-19 12:54:17,158][root][INFO] - Step: 5300/9020  |  Loss: 0.3061  |  Score: 87.08 [%]  |  Seq Length: 128.0
[2024-09-19 12:54:44,317][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 12:54:44,318][root][INFO] - Score: 88.47 [%]  |  Evaluation Time: 63.86 [s]
[2024-09-19 12:54:44,319][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-19 12:54:44,320][root][INFO] - 
[5/ 5 Epoch]
[2024-09-19 12:54:45,361][root][INFO] - Step: 7000/9020  |  Loss: 0.1580  |  Score: 93.64 [%]  |  Seq Length: 128.0
[2024-09-19 12:54:55,527][root][INFO] - Step: 5400/9020  |  Loss: 0.3089  |  Score: 87.09 [%]  |  Seq Length: 128.0
[2024-09-19 12:54:59,426][root][INFO] - Step: 5412/9020  |  Loss: 0.3000  |  Score: 87.21 [%]  |  Seq Length: 128.0
[2024-09-19 12:55:08,333][root][INFO] - Step: 7300/9020  |  Loss: 0.2054  |  Score: 91.11 [%]  |  Seq Length: 128.0
[2024-09-19 12:55:16,754][root][INFO] - Step: 7100/9020  |  Loss: 0.1639  |  Score: 93.75 [%]  |  Seq Length: 128.0
[2024-09-19 12:55:32,839][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 12:55:32,840][root][INFO] - Score: 87.30 [%]  |  Evaluation Time: 33.41 [s]
[2024-09-19 12:55:36,702][root][INFO] - Step: 7400/9020  |  Loss: 0.2017  |  Score: 91.77 [%]  |  Seq Length: 128.0
[2024-09-19 12:55:47,706][root][INFO] - Step: 7200/9020  |  Loss: 0.1626  |  Score: 93.20 [%]  |  Seq Length: 128.0
[2024-09-19 12:55:52,884][root][INFO] - Step: 7216/9020  |  Loss: 0.1486  |  Score: 94.24 [%]  |  Seq Length: 128.0
[2024-09-19 12:56:05,800][root][INFO] - Step: 7500/9020  |  Loss: 0.2084  |  Score: 91.47 [%]  |  Seq Length: 128.0
[2024-09-19 12:56:10,693][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 12:56:10,693][root][INFO] - Score: 83.56 [%]  |  Evaluation Time: 17.81 [s]
[2024-09-19 12:56:34,884][root][INFO] - Step: 7600/9020  |  Loss: 0.1952  |  Score: 92.23 [%]  |  Seq Length: 128.0
[2024-09-19 12:57:04,243][root][INFO] - Step: 7700/9020  |  Loss: 0.2146  |  Score: 91.30 [%]  |  Seq Length: 128.0
[2024-09-19 12:57:08,357][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 12:57:08,357][root][INFO] - Score: 83.42 [%]  |  Evaluation Time: 57.66 [s]
[2024-09-19 12:57:08,360][root][INFO] - 
[5/ 5 Epoch]
[2024-09-19 12:57:19,193][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 12:57:19,193][root][INFO] - Score: 87.24 [%]  |  Evaluation Time: 106.35 [s]
[2024-09-19 12:57:19,194][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-19 12:57:19,196][root][INFO] - 
[4/ 5 Epoch]
[2024-09-19 12:57:33,006][root][INFO] - Step: 7800/9020  |  Loss: 0.2048  |  Score: 91.70 [%]  |  Seq Length: 128.0
[2024-09-19 12:57:34,027][root][INFO] - Step: 7300/9020  |  Loss: 0.1130  |  Score: 95.65 [%]  |  Seq Length: 128.0
[2024-09-19 12:57:52,658][root][INFO] - Step: 5500/9020  |  Loss: 0.2764  |  Score: 88.67 [%]  |  Seq Length: 128.0
[2024-09-19 12:58:01,500][root][INFO] - Step: 7900/9020  |  Loss: 0.2023  |  Score: 92.00 [%]  |  Seq Length: 128.0
[2024-09-19 12:58:04,682][root][INFO] - Step: 7400/9020  |  Loss: 0.1145  |  Score: 95.56 [%]  |  Seq Length: 128.0
[2024-09-19 12:58:25,356][root][INFO] - Step: 5600/9020  |  Loss: 0.2713  |  Score: 87.95 [%]  |  Seq Length: 128.0
[2024-09-19 12:58:30,030][root][INFO] - Step: 8000/9020  |  Loss: 0.2054  |  Score: 92.00 [%]  |  Seq Length: 128.0
[2024-09-19 12:58:35,442][root][INFO] - Step: 7500/9020  |  Loss: 0.1026  |  Score: 96.11 [%]  |  Seq Length: 128.0
[2024-09-19 12:58:58,603][root][INFO] - Step: 8100/9020  |  Loss: 0.2064  |  Score: 91.91 [%]  |  Seq Length: 128.0
[2024-09-19 12:59:03,333][root][INFO] - Step: 5700/9020  |  Loss: 0.2752  |  Score: 88.27 [%]  |  Seq Length: 128.0
[2024-09-19 12:59:05,508][root][INFO] - Step: 7600/9020  |  Loss: 0.1089  |  Score: 95.83 [%]  |  Seq Length: 128.0
[2024-09-19 12:59:27,146][root][INFO] - Step: 8200/9020  |  Loss: 0.2095  |  Score: 91.61 [%]  |  Seq Length: 128.0
[2024-09-19 12:59:35,887][root][INFO] - Step: 7700/9020  |  Loss: 0.1003  |  Score: 96.20 [%]  |  Seq Length: 128.0
[2024-09-19 12:59:41,663][root][INFO] - Step: 5800/9020  |  Loss: 0.2735  |  Score: 88.50 [%]  |  Seq Length: 128.0
[2024-09-19 12:59:55,042][root][INFO] - Step: 8300/9020  |  Loss: 0.2048  |  Score: 91.98 [%]  |  Seq Length: 128.0
[2024-09-19 13:00:06,685][root][INFO] - Step: 7800/9020  |  Loss: 0.0983  |  Score: 96.19 [%]  |  Seq Length: 128.0
[2024-09-19 13:00:19,400][root][INFO] - Step: 5900/9020  |  Loss: 0.2680  |  Score: 88.70 [%]  |  Seq Length: 128.0
[2024-09-19 13:00:21,962][root][INFO] - Step: 8400/9020  |  Loss: 0.2114  |  Score: 91.62 [%]  |  Seq Length: 128.0
[2024-09-19 13:00:36,003][root][INFO] - Step: 7900/9020  |  Loss: 0.1104  |  Score: 95.83 [%]  |  Seq Length: 128.0
[2024-09-19 13:00:49,196][root][INFO] - Step: 8500/9020  |  Loss: 0.2115  |  Score: 91.02 [%]  |  Seq Length: 128.0
[2024-09-19 13:00:57,620][root][INFO] - Step: 6000/9020  |  Loss: 0.2767  |  Score: 88.09 [%]  |  Seq Length: 128.0
[2024-09-19 13:01:06,451][root][INFO] - Step: 8000/9020  |  Loss: 0.1106  |  Score: 95.92 [%]  |  Seq Length: 128.0
[2024-09-19 13:01:17,211][root][INFO] - Step: 8600/9020  |  Loss: 0.2134  |  Score: 91.17 [%]  |  Seq Length: 128.0
[2024-09-19 13:01:36,600][root][INFO] - Step: 6100/9020  |  Loss: 0.2747  |  Score: 88.34 [%]  |  Seq Length: 128.0
[2024-09-19 13:01:37,227][root][INFO] - Step: 8100/9020  |  Loss: 0.1129  |  Score: 95.80 [%]  |  Seq Length: 128.0
[2024-09-19 13:01:45,929][root][INFO] - Step: 8700/9020  |  Loss: 0.2010  |  Score: 91.94 [%]  |  Seq Length: 128.0
[2024-09-19 13:02:08,264][root][INFO] - Step: 8200/9020  |  Loss: 0.1045  |  Score: 95.89 [%]  |  Seq Length: 128.0
[2024-09-19 13:02:14,043][root][INFO] - Step: 8800/9020  |  Loss: 0.2139  |  Score: 91.39 [%]  |  Seq Length: 128.0
[2024-09-19 13:02:14,441][root][INFO] - Step: 6200/9020  |  Loss: 0.2723  |  Score: 88.75 [%]  |  Seq Length: 128.0
[2024-09-19 13:02:38,857][root][INFO] - Step: 8300/9020  |  Loss: 0.1109  |  Score: 95.73 [%]  |  Seq Length: 128.0
[2024-09-19 13:02:41,889][root][INFO] - Step: 8900/9020  |  Loss: 0.2158  |  Score: 91.31 [%]  |  Seq Length: 128.0
[2024-09-19 13:02:53,552][root][INFO] - Step: 6300/9020  |  Loss: 0.2678  |  Score: 88.61 [%]  |  Seq Length: 128.0
[2024-09-19 13:03:09,439][root][INFO] - Step: 8400/9020  |  Loss: 0.1022  |  Score: 96.16 [%]  |  Seq Length: 128.0
[2024-09-19 13:03:09,974][root][INFO] - Step: 9000/9020  |  Loss: 0.2025  |  Score: 91.89 [%]  |  Seq Length: 128.0
[2024-09-19 13:03:15,766][root][INFO] - Step: 9020/9020  |  Loss: 0.1918  |  Score: 92.81 [%]  |  Seq Length: 128.0
[2024-09-19 13:03:31,219][root][INFO] - Step: 6400/9020  |  Loss: 0.2737  |  Score: 88.34 [%]  |  Seq Length: 128.0
[2024-09-19 13:03:35,433][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 13:03:35,433][root][INFO] - Score: 88.48 [%]  |  Evaluation Time: 19.66 [s]
[2024-09-19 13:03:38,802][root][INFO] - Step: 8500/9020  |  Loss: 0.1004  |  Score: 96.30 [%]  |  Seq Length: 128.0
[2024-09-19 13:04:09,832][root][INFO] - Step: 6500/9020  |  Loss: 0.2704  |  Score: 88.95 [%]  |  Seq Length: 128.0
[2024-09-19 13:04:10,991][root][INFO] - Step: 8600/9020  |  Loss: 0.0902  |  Score: 96.48 [%]  |  Seq Length: 128.0
[2024-09-19 13:04:39,136][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 13:04:39,137][root][INFO] - Score: 88.57 [%]  |  Evaluation Time: 63.70 [s]
[2024-09-19 13:04:39,138][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-19 13:04:39,138][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 13:04:39,138][root][INFO] - - Epoch: 5
[2024-09-19 13:04:39,138][root][INFO] - - DEV score: 88.48 [%]
[2024-09-19 13:04:39,138][root][INFO] - - TEST score: 88.57 [%]
[2024-09-19 13:04:39,139][root][INFO] - Fine-tuning is done!
[2024-09-19 13:04:41,295][root][INFO] - Step: 8700/9020  |  Loss: 0.0982  |  Score: 96.30 [%]  |  Seq Length: 128.0
[2024-09-19 13:04:49,106][root][INFO] - Step: 6600/9020  |  Loss: 0.2615  |  Score: 88.94 [%]  |  Seq Length: 128.0
[2024-09-19 13:05:12,035][root][INFO] - Step: 8800/9020  |  Loss: 0.1161  |  Score: 95.98 [%]  |  Seq Length: 128.0
[2024-09-19 13:05:25,923][root][INFO] - Step: 6700/9020  |  Loss: 0.2646  |  Score: 89.23 [%]  |  Seq Length: 128.0
[2024-09-19 13:05:42,737][root][INFO] - Step: 8900/9020  |  Loss: 0.1144  |  Score: 95.66 [%]  |  Seq Length: 128.0
[2024-09-19 13:06:04,782][root][INFO] - Step: 6800/9020  |  Loss: 0.2652  |  Score: 88.92 [%]  |  Seq Length: 128.0
[2024-09-19 13:06:14,001][root][INFO] - Step: 9000/9020  |  Loss: 0.1002  |  Score: 96.28 [%]  |  Seq Length: 128.0
[2024-09-19 13:06:20,266][root][INFO] - Step: 9020/9020  |  Loss: 0.1324  |  Score: 95.47 [%]  |  Seq Length: 128.0
[2024-09-19 13:06:37,983][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 13:06:37,984][root][INFO] - Score: 83.18 [%]  |  Evaluation Time: 17.72 [s]
[2024-09-19 13:06:43,018][root][INFO] - Step: 6900/9020  |  Loss: 0.2652  |  Score: 88.95 [%]  |  Seq Length: 128.0
[2024-09-19 13:07:21,730][root][INFO] - Step: 7000/9020  |  Loss: 0.2458  |  Score: 90.00 [%]  |  Seq Length: 128.0
[2024-09-19 13:07:38,476][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 13:07:38,477][root][INFO] - Score: 83.19 [%]  |  Evaluation Time: 60.49 [s]
[2024-09-19 13:07:38,478][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 13:07:38,478][root][INFO] - - Epoch: 1
[2024-09-19 13:07:38,478][root][INFO] - - DEV score: 84.04 [%]
[2024-09-19 13:07:38,478][root][INFO] - - TEST score: 83.72 [%]
[2024-09-19 13:07:38,480][root][INFO] - Fine-tuning is done!
[2024-09-19 13:08:00,562][root][INFO] - Step: 7100/9020  |  Loss: 0.2585  |  Score: 89.34 [%]  |  Seq Length: 128.0
[2024-09-19 13:08:37,631][root][INFO] - Step: 7200/9020  |  Loss: 0.2561  |  Score: 89.22 [%]  |  Seq Length: 128.0
[2024-09-19 13:08:43,691][root][INFO] - Step: 7216/9020  |  Loss: 0.2810  |  Score: 88.34 [%]  |  Seq Length: 128.0
[2024-09-19 13:09:16,823][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 13:09:16,824][root][INFO] - Score: 88.10 [%]  |  Evaluation Time: 33.13 [s]
[2024-09-19 13:11:00,167][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 13:11:00,167][root][INFO] - Score: 87.98 [%]  |  Evaluation Time: 103.34 [s]
[2024-09-19 13:11:00,168][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-19 13:11:00,170][root][INFO] - 
[5/ 5 Epoch]
[2024-09-19 13:11:31,883][root][INFO] - Step: 7300/9020  |  Loss: 0.2322  |  Score: 90.85 [%]  |  Seq Length: 128.0
[2024-09-19 13:12:08,833][root][INFO] - Step: 7400/9020  |  Loss: 0.2354  |  Score: 90.11 [%]  |  Seq Length: 128.0
[2024-09-19 13:12:45,628][root][INFO] - Step: 7500/9020  |  Loss: 0.2378  |  Score: 90.61 [%]  |  Seq Length: 128.0
[2024-09-19 13:13:22,294][root][INFO] - Step: 7600/9020  |  Loss: 0.2316  |  Score: 90.48 [%]  |  Seq Length: 128.0
[2024-09-19 13:13:58,614][root][INFO] - Step: 7700/9020  |  Loss: 0.2390  |  Score: 89.98 [%]  |  Seq Length: 128.0
[2024-09-19 13:14:35,410][root][INFO] - Step: 7800/9020  |  Loss: 0.2311  |  Score: 90.92 [%]  |  Seq Length: 128.0
[2024-09-19 13:15:14,373][root][INFO] - Step: 7900/9020  |  Loss: 0.2217  |  Score: 90.97 [%]  |  Seq Length: 128.0
[2024-09-19 13:15:52,480][root][INFO] - Step: 8000/9020  |  Loss: 0.2289  |  Score: 90.52 [%]  |  Seq Length: 128.0
[2024-09-19 13:16:29,654][root][INFO] - Step: 8100/9020  |  Loss: 0.2360  |  Score: 90.12 [%]  |  Seq Length: 128.0
[2024-09-19 13:17:06,623][root][INFO] - Step: 8200/9020  |  Loss: 0.2318  |  Score: 90.64 [%]  |  Seq Length: 128.0
[2024-09-19 13:17:44,200][root][INFO] - Step: 8300/9020  |  Loss: 0.2301  |  Score: 90.75 [%]  |  Seq Length: 128.0
[2024-09-19 13:18:22,706][root][INFO] - Step: 8400/9020  |  Loss: 0.2269  |  Score: 90.56 [%]  |  Seq Length: 128.0
[2024-09-19 13:18:59,936][root][INFO] - Step: 8500/9020  |  Loss: 0.2264  |  Score: 90.56 [%]  |  Seq Length: 128.0
[2024-09-19 13:19:37,582][root][INFO] - Step: 8600/9020  |  Loss: 0.2376  |  Score: 90.16 [%]  |  Seq Length: 128.0
[2024-09-19 13:20:16,008][root][INFO] - Step: 8700/9020  |  Loss: 0.2344  |  Score: 90.33 [%]  |  Seq Length: 128.0
[2024-09-19 13:20:53,904][root][INFO] - Step: 8800/9020  |  Loss: 0.2256  |  Score: 90.78 [%]  |  Seq Length: 128.0
[2024-09-19 13:21:30,609][root][INFO] - Step: 8900/9020  |  Loss: 0.2282  |  Score: 90.67 [%]  |  Seq Length: 128.0
[2024-09-19 13:22:08,673][root][INFO] - Step: 9000/9020  |  Loss: 0.2315  |  Score: 90.52 [%]  |  Seq Length: 128.0
[2024-09-19 13:22:16,109][root][INFO] - Step: 9020/9020  |  Loss: 0.2041  |  Score: 92.09 [%]  |  Seq Length: 128.0
[2024-09-19 13:22:48,148][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 13:22:48,148][root][INFO] - Score: 88.20 [%]  |  Evaluation Time: 32.04 [s]
[2024-09-19 13:24:32,089][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 13:24:32,089][root][INFO] - Score: 88.10 [%]  |  Evaluation Time: 103.94 [s]
[2024-09-19 13:24:32,090][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-19 13:24:32,090][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 13:24:32,090][root][INFO] - - Epoch: 5
[2024-09-19 13:24:32,091][root][INFO] - - DEV score: 88.20 [%]
[2024-09-19 13:24:32,091][root][INFO] - - TEST score: 88.10 [%]
[2024-09-19 13:24:32,091][root][INFO] - Fine-tuning is done!
[2024-09-19 13:32:48,860][root][INFO] - 

[2024-09-19 13:32:48,860][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 13:32:48,860][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.0001lr_42rs
[2024-09-19 13:32:48,860][root][INFO] - 

[2024-09-19 13:32:48,860][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 128, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.0001, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 4, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.0001lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.0001lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.0001lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 13:33:13,205][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 13:33:13,971][root][INFO] - 

[2024-09-19 13:33:13,971][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 13:33:13,971][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs
[2024-09-19 13:33:13,971][root][INFO] - 

[2024-09-19 13:33:13,971][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 128, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 8, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 13:33:14,987][root][INFO] - 

[2024-09-19 13:33:14,987][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-19 13:33:14,987][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 13:33:14,994][root][INFO] - vocab size              : 51200
[2024-09-19 13:33:14,994][root][INFO] - device                  : gpu
[2024-09-19 13:33:14,994][root][INFO] - random seed             : 42
[2024-09-19 13:33:14,995][root][INFO] - train data size         : 28864
[2024-09-19 13:33:14,995][root][INFO] - max epochs              : 5
[2024-09-19 13:33:14,995][root][INFO] - total steps             : 9020
[2024-09-19 13:33:14,995][root][INFO] - warmup steps            : 902
[2024-09-19 13:33:14,995][root][INFO] - batch size              : 64
[2024-09-19 13:33:14,995][root][INFO] - accumulation steps      : 4
[2024-09-19 13:33:14,995][root][INFO] - optimizer               : adamwscale
[2024-09-19 13:33:14,995][root][INFO] - lr_scheduler            : cosine
[2024-09-19 13:33:14,995][root][INFO] - learning rate           : 0.0001
[2024-09-19 13:33:14,995][root][INFO] - max length              : 128

[2024-09-19 13:33:14,995][root][INFO] - 

[2024-09-19 13:33:14,996][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.0001lr_42rs
[2024-09-19 13:33:14,996][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.0001lr_42rs/ckpt
[2024-09-19 13:33:14,996][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/128t_64b_4s_0.0001lr_42rs/tb
[2024-09-19 13:33:14,996][root][INFO] - * tb interval           : 100

[2024-09-19 13:33:14,996][root][INFO] - 

[2024-09-19 13:33:14,996][root][INFO] - Start the Training !
[2024-09-19 13:33:14,999][root][INFO] - 
[1/ 5 Epoch]
[2024-09-19 13:33:18,892][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:18,892][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:18,893][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:18,893][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:18,893][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:18,894][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:18,894][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:18,894][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:18,895][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:18,895][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:18,896][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:18,896][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:18,896][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:18,897][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:18,897][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:18,898][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:18,898][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:18,898][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:18,899][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:18,899][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:18,900][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:18,900][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:18,901][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:18,901][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:18,903][root][INFO] - Trainable params: 884736 || all params: 126049536 || trainable: 0.70 %
[2024-09-19 13:33:19,073][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 13:33:20,874][root][INFO] - 

[2024-09-19 13:33:20,874][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-19 13:33:20,874][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 13:33:20,881][root][INFO] - vocab size              : 51200
[2024-09-19 13:33:20,882][root][INFO] - device                  : gpu
[2024-09-19 13:33:20,882][root][INFO] - random seed             : 42
[2024-09-19 13:33:20,882][root][INFO] - train data size         : 544
[2024-09-19 13:33:20,882][root][INFO] - max epochs              : 15
[2024-09-19 13:33:20,882][root][INFO] - total steps             : 1033
[2024-09-19 13:33:20,882][root][INFO] - warmup steps            : 103
[2024-09-19 13:33:20,882][root][INFO] - batch size              : 64
[2024-09-19 13:33:20,882][root][INFO] - accumulation steps      : 8
[2024-09-19 13:33:20,882][root][INFO] - optimizer               : adamwscale
[2024-09-19 13:33:20,882][root][INFO] - lr_scheduler            : cosine
[2024-09-19 13:33:20,882][root][INFO] - learning rate           : 0.02
[2024-09-19 13:33:20,882][root][INFO] - max length              : 128

[2024-09-19 13:33:20,883][root][INFO] - LoRA Configuration
[2024-09-19 13:33:20,883][root][INFO] - ㄴ r                    : 16
[2024-09-19 13:33:20,883][root][INFO] - ㄴ alpha                : 64
[2024-09-19 13:33:20,883][root][INFO] - ㄴ dropout              : 0.03

[2024-09-19 13:33:20,883][root][INFO] - 

[2024-09-19 13:33:20,883][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs
[2024-09-19 13:33:20,883][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs/ckpt
[2024-09-19 13:33:20,883][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs/tb
[2024-09-19 13:33:20,883][root][INFO] - * tb interval           : 15

[2024-09-19 13:33:20,883][root][INFO] - 

[2024-09-19 13:33:20,883][root][INFO] - Start the Training !
[2024-09-19 13:33:20,886][root][INFO] - 
[1/ 15 Epoch]
[2024-09-19 13:33:27,008][root][INFO] - 

[2024-09-19 13:33:27,008][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 13:33:27,008][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs
[2024-09-19 13:33:27,008][root][INFO] - 

[2024-09-19 13:33:27,008][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 128, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 8, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 13:33:30,680][root][INFO] - Step: 15/1033  |  Loss: 3.1790  |  Score: 3.91 [%]  |  Seq Length: 128.0
[2024-09-19 13:33:32,279][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:32,279][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:32,280][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:32,280][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:32,281][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:32,281][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:32,281][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:32,282][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:32,282][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:32,283][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:32,283][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:32,283][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:32,284][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:32,284][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:32,284][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:32,285][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:32,285][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:32,286][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:32,286][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:32,286][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:32,287][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:32,287][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:32,288][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-19 13:33:32,288][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-19 13:33:32,290][root][INFO] - Trainable params: 884736 || all params: 126049536 || trainable: 0.70 %
[2024-09-19 13:33:32,293][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-19 13:33:32,299][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-19 13:33:32,301][root][INFO] - Trainable params: 1298304 || all params: 126463104 || trainable: 1.03 %
[2024-09-19 13:33:32,475][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 13:33:34,712][root][INFO] - 

[2024-09-19 13:33:34,712][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-19 13:33:34,712][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 13:33:34,724][root][INFO] - vocab size              : 51200
[2024-09-19 13:33:34,724][root][INFO] - device                  : gpu
[2024-09-19 13:33:34,724][root][INFO] - random seed             : 42
[2024-09-19 13:33:34,725][root][INFO] - train data size         : 544
[2024-09-19 13:33:34,725][root][INFO] - max epochs              : 15
[2024-09-19 13:33:34,725][root][INFO] - total steps             : 1033
[2024-09-19 13:33:34,725][root][INFO] - warmup steps            : 103
[2024-09-19 13:33:34,725][root][INFO] - batch size              : 64
[2024-09-19 13:33:34,725][root][INFO] - accumulation steps      : 8
[2024-09-19 13:33:34,725][root][INFO] - optimizer               : adamwscale
[2024-09-19 13:33:34,725][root][INFO] - lr_scheduler            : cosine
[2024-09-19 13:33:34,725][root][INFO] - learning rate           : 0.02
[2024-09-19 13:33:34,725][root][INFO] - max length              : 128

[2024-09-19 13:33:34,725][root][INFO] - LoRA Configuration
[2024-09-19 13:33:34,726][root][INFO] - ㄴ r                    : 16
[2024-09-19 13:33:34,726][root][INFO] - ㄴ alpha                : 64
[2024-09-19 13:33:34,726][root][INFO] - ㄴ dropout              : 0.03

[2024-09-19 13:33:34,726][root][INFO] - KOMBO Configuration
[2024-09-19 13:33:34,726][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-19 13:33:34,726][root][INFO] - ㄴ reducer              : linear
[2024-09-19 13:33:34,726][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-19 13:33:34,726][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-19 13:33:34,726][root][INFO] - ㄴ do_combination       : False
[2024-09-19 13:33:34,727][root][INFO] - 

[2024-09-19 13:33:34,727][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs
[2024-09-19 13:33:34,727][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs/ckpt
[2024-09-19 13:33:34,727][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/128t_64b_8s_0.02lr_42rs/tb
[2024-09-19 13:33:34,727][root][INFO] - * tb interval           : 15

[2024-09-19 13:33:34,727][root][INFO] - 

[2024-09-19 13:33:34,727][root][INFO] - Start the Training !
[2024-09-19 13:33:34,730][root][INFO] - 
[1/ 15 Epoch]
[2024-09-19 13:33:39,377][root][INFO] - Step: 30/1033  |  Loss: 2.2442  |  Score: 20.29 [%]  |  Seq Length: 128.0
[2024-09-19 13:33:46,637][root][INFO] - Step: 15/1033  |  Loss: 3.0365  |  Score: 13.74 [%]  |  Seq Length: 128.0
[2024-09-19 13:33:47,572][root][INFO] - Step: 45/1033  |  Loss: 1.8205  |  Score: 40.67 [%]  |  Seq Length: 128.0
[2024-09-19 13:33:48,277][root][INFO] - Step: 100/9020  |  Loss: 0.6317  |  Score: 65.78 [%]  |  Seq Length: 128.0
[2024-09-19 13:33:55,730][root][INFO] - Step: 60/1033  |  Loss: 1.3726  |  Score: 57.96 [%]  |  Seq Length: 128.0
[2024-09-19 13:33:56,825][root][INFO] - Step: 30/1033  |  Loss: 2.3732  |  Score: 17.91 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:00,702][root][INFO] - Step: 68/1033  |  Loss: 1.6100  |  Score: 53.91 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:04,637][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 13:34:04,637][root][INFO] - Score: 66.62 [%]  |  Evaluation Time: 3.93 [s]
[2024-09-19 13:34:05,586][root][INFO] - Step: 45/1033  |  Loss: 1.9895  |  Score: 39.03 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:08,674][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 13:34:08,674][root][INFO] - Score: 61.42 [%]  |  Evaluation Time: 4.03 [s]
[2024-09-19 13:34:08,675][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 13:34:08,676][root][INFO] - 
[2/ 15 Epoch]
[2024-09-19 13:34:12,419][root][INFO] - Step: 75/1033  |  Loss: 1.7902  |  Score: 59.36 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:14,279][root][INFO] - Step: 60/1033  |  Loss: 1.6042  |  Score: 49.10 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:18,564][root][INFO] - Step: 200/9020  |  Loss: 0.4676  |  Score: 78.94 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:20,289][root][INFO] - Step: 68/1033  |  Loss: 1.7632  |  Score: 51.26 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:20,587][root][INFO] - Step: 90/1033  |  Loss: 1.3893  |  Score: 60.41 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:25,822][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 13:34:25,822][root][INFO] - Score: 63.84 [%]  |  Evaluation Time: 5.53 [s]
[2024-09-19 13:34:28,065][root][INFO] - Step: 105/1033  |  Loss: 1.1970  |  Score: 63.25 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:31,109][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 13:34:31,109][root][INFO] - Score: 58.93 [%]  |  Evaluation Time: 5.28 [s]
[2024-09-19 13:34:31,110][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 13:34:31,111][root][INFO] - 
[2/ 15 Epoch]
[2024-09-19 13:34:35,482][root][INFO] - Step: 75/1033  |  Loss: 1.6489  |  Score: 48.35 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:36,403][root][INFO] - Step: 120/1033  |  Loss: 1.2150  |  Score: 63.51 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:44,713][root][INFO] - Step: 135/1033  |  Loss: 1.3111  |  Score: 55.91 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:45,461][root][INFO] - Step: 90/1033  |  Loss: 1.4478  |  Score: 52.00 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:46,325][root][INFO] - Step: 137/1033  |  Loss: 1.0421  |  Score: 63.16 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:50,252][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 13:34:50,252][root][INFO] - Score: 68.95 [%]  |  Evaluation Time: 3.92 [s]
[2024-09-19 13:34:51,107][root][INFO] - Step: 300/9020  |  Loss: 0.4199  |  Score: 81.50 [%]  |  Seq Length: 128.0
[2024-09-19 13:34:54,113][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 13:34:54,113][root][INFO] - Score: 64.12 [%]  |  Evaluation Time: 3.86 [s]
[2024-09-19 13:34:54,114][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 13:34:54,116][root][INFO] - 
[3/ 15 Epoch]
[2024-09-19 13:34:55,848][root][INFO] - Step: 105/1033  |  Loss: 1.2806  |  Score: 63.42 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:01,268][root][INFO] - Step: 150/1033  |  Loss: 1.1158  |  Score: 68.69 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:06,283][root][INFO] - Step: 120/1033  |  Loss: 1.3832  |  Score: 56.50 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:10,074][root][INFO] - Step: 165/1033  |  Loss: 1.0546  |  Score: 63.01 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:16,609][root][INFO] - Step: 135/1033  |  Loss: 1.4762  |  Score: 55.99 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:18,311][root][INFO] - Step: 180/1033  |  Loss: 1.0355  |  Score: 67.48 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:18,524][root][INFO] - Step: 137/1033  |  Loss: 1.3340  |  Score: 66.67 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:22,058][root][INFO] - Step: 400/9020  |  Loss: 0.3903  |  Score: 82.89 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:23,948][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 13:35:23,948][root][INFO] - Score: 69.70 [%]  |  Evaluation Time: 5.42 [s]
[2024-09-19 13:35:26,697][root][INFO] - Step: 195/1033  |  Loss: 0.9870  |  Score: 66.59 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:29,111][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 13:35:29,111][root][INFO] - Score: 64.43 [%]  |  Evaluation Time: 5.16 [s]
[2024-09-19 13:35:29,112][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 13:35:29,113][root][INFO] - 
[3/ 15 Epoch]
[2024-09-19 13:35:33,386][root][INFO] - Step: 206/1033  |  Loss: 1.0521  |  Score: 65.29 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:37,397][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 13:35:37,398][root][INFO] - Score: 69.94 [%]  |  Evaluation Time: 4.01 [s]
[2024-09-19 13:35:37,804][root][INFO] - Step: 150/1033  |  Loss: 1.2217  |  Score: 62.47 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:41,202][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 13:35:41,202][root][INFO] - Score: 67.54 [%]  |  Evaluation Time: 3.80 [s]
[2024-09-19 13:35:41,203][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-19 13:35:41,204][root][INFO] - 
[4/ 15 Epoch]
[2024-09-19 13:35:43,351][root][INFO] - Step: 210/1033  |  Loss: 1.0454  |  Score: 70.80 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:48,001][root][INFO] - Step: 165/1033  |  Loss: 1.7544  |  Score: 45.41 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:51,757][root][INFO] - Step: 225/1033  |  Loss: 0.8365  |  Score: 71.34 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:53,048][root][INFO] - Step: 500/9020  |  Loss: 0.3776  |  Score: 83.41 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:58,406][root][INFO] - Step: 180/1033  |  Loss: 1.7745  |  Score: 44.84 [%]  |  Seq Length: 128.0
[2024-09-19 13:35:59,697][root][INFO] - Step: 240/1033  |  Loss: 0.9283  |  Score: 70.68 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:07,346][root][INFO] - Step: 195/1033  |  Loss: 1.5625  |  Score: 52.40 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:07,836][root][INFO] - Step: 255/1033  |  Loss: 0.8809  |  Score: 70.23 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:15,026][root][INFO] - Step: 206/1033  |  Loss: 1.2410  |  Score: 56.59 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:16,098][root][INFO] - Step: 270/1033  |  Loss: 0.9333  |  Score: 69.07 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:19,161][root][INFO] - Step: 275/1033  |  Loss: 0.7357  |  Score: 76.38 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:20,568][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 13:36:20,568][root][INFO] - Score: 63.29 [%]  |  Evaluation Time: 5.54 [s]
[2024-09-19 13:36:23,239][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 13:36:23,240][root][INFO] - Score: 75.17 [%]  |  Evaluation Time: 4.07 [s]
[2024-09-19 13:36:23,841][root][INFO] - Step: 600/9020  |  Loss: 0.3683  |  Score: 83.34 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:25,830][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 13:36:25,830][root][INFO] - Score: 60.36 [%]  |  Evaluation Time: 5.26 [s]
[2024-09-19 13:36:25,832][root][INFO] - 
[4/ 15 Epoch]
[2024-09-19 13:36:27,028][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 13:36:27,029][root][INFO] - Score: 65.60 [%]  |  Evaluation Time: 3.79 [s]
[2024-09-19 13:36:27,030][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-19 13:36:27,031][root][INFO] - 
[5/ 15 Epoch]
[2024-09-19 13:36:28,415][root][INFO] - Step: 210/1033  |  Loss: 1.4502  |  Score: 58.85 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:32,389][root][INFO] - Step: 285/1033  |  Loss: 0.6935  |  Score: 75.53 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:38,576][root][INFO] - Step: 225/1033  |  Loss: 1.2243  |  Score: 59.42 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:39,828][root][INFO] - Step: 300/1033  |  Loss: 0.7788  |  Score: 73.49 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:48,610][root][INFO] - Step: 240/1033  |  Loss: 1.3819  |  Score: 58.58 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:48,743][root][INFO] - Step: 315/1033  |  Loss: 0.7126  |  Score: 77.50 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:55,262][root][INFO] - Step: 700/9020  |  Loss: 0.3668  |  Score: 83.66 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:57,063][root][INFO] - Step: 330/1033  |  Loss: 0.8002  |  Score: 75.09 [%]  |  Seq Length: 128.0
[2024-09-19 13:36:58,900][root][INFO] - Step: 255/1033  |  Loss: 1.3560  |  Score: 55.38 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:05,071][root][INFO] - Step: 344/1033  |  Loss: 0.7201  |  Score: 73.59 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:09,011][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 13:37:09,011][root][INFO] - Score: 69.98 [%]  |  Evaluation Time: 3.94 [s]
[2024-09-19 13:37:09,230][root][INFO] - Step: 270/1033  |  Loss: 1.2105  |  Score: 60.87 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:12,814][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 13:37:12,814][root][INFO] - Score: 64.62 [%]  |  Evaluation Time: 3.80 [s]
[2024-09-19 13:37:12,819][root][INFO] - 
[6/ 15 Epoch]
[2024-09-19 13:37:12,879][root][INFO] - Step: 275/1033  |  Loss: 1.4420  |  Score: 52.95 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:13,453][root][INFO] - Step: 345/1033  |  Loss: 0.4812  |  Score: 75.95 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:18,462][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 13:37:18,462][root][INFO] - Score: 46.62 [%]  |  Evaluation Time: 5.58 [s]
[2024-09-19 13:37:22,210][root][INFO] - Step: 360/1033  |  Loss: 0.6074  |  Score: 78.42 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:23,691][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 13:37:23,691][root][INFO] - Score: 47.25 [%]  |  Evaluation Time: 5.23 [s]
[2024-09-19 13:37:23,693][root][INFO] - 
[5/ 15 Epoch]
[2024-09-19 13:37:26,433][root][INFO] - Step: 800/9020  |  Loss: 0.3470  |  Score: 85.14 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:30,361][root][INFO] - Step: 285/1033  |  Loss: 1.4337  |  Score: 53.20 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:30,477][root][INFO] - Step: 375/1033  |  Loss: 0.6458  |  Score: 81.51 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:38,624][root][INFO] - Step: 390/1033  |  Loss: 0.6032  |  Score: 77.40 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:40,543][root][INFO] - Step: 300/1033  |  Loss: 1.1816  |  Score: 62.42 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:46,969][root][INFO] - Step: 405/1033  |  Loss: 0.6265  |  Score: 75.16 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:50,680][root][INFO] - Step: 315/1033  |  Loss: 1.1357  |  Score: 65.05 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:51,442][root][INFO] - Step: 413/1033  |  Loss: 0.6393  |  Score: 74.58 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:55,320][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-19 13:37:55,320][root][INFO] - Score: 72.11 [%]  |  Evaluation Time: 3.88 [s]
[2024-09-19 13:37:56,999][root][INFO] - Step: 900/9020  |  Loss: 0.3431  |  Score: 84.98 [%]  |  Seq Length: 128.0
[2024-09-19 13:37:59,143][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-19 13:37:59,143][root][INFO] - Score: 66.17 [%]  |  Evaluation Time: 3.82 [s]
[2024-09-19 13:37:59,145][root][INFO] - 
[7/ 15 Epoch]
[2024-09-19 13:38:01,098][root][INFO] - Step: 330/1033  |  Loss: 1.0440  |  Score: 63.74 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:02,987][root][INFO] - Step: 420/1033  |  Loss: 0.5809  |  Score: 80.15 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:10,763][root][INFO] - Step: 435/1033  |  Loss: 0.4817  |  Score: 80.45 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:10,889][root][INFO] - Step: 344/1033  |  Loss: 1.0669  |  Score: 67.22 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:16,472][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 13:38:16,472][root][INFO] - Score: 67.25 [%]  |  Evaluation Time: 5.58 [s]
[2024-09-19 13:38:19,044][root][INFO] - Step: 450/1033  |  Loss: 0.5513  |  Score: 80.68 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:21,861][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 13:38:21,861][root][INFO] - Score: 62.26 [%]  |  Evaluation Time: 5.39 [s]
[2024-09-19 13:38:21,862][root][INFO] - 
[6/ 15 Epoch]
[2024-09-19 13:38:22,509][root][INFO] - Step: 345/1033  |  Loss: 1.2624  |  Score: 69.19 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:27,342][root][INFO] - Step: 465/1033  |  Loss: 0.5740  |  Score: 79.65 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:27,848][root][INFO] - Step: 1000/9020  |  Loss: 0.3661  |  Score: 83.73 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:32,682][root][INFO] - Step: 360/1033  |  Loss: 0.9799  |  Score: 67.69 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:35,662][root][INFO] - Step: 480/1033  |  Loss: 0.5163  |  Score: 80.52 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:36,949][root][INFO] - Step: 482/1033  |  Loss: 0.5080  |  Score: 79.83 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:41,666][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-19 13:38:41,666][root][INFO] - Score: 71.49 [%]  |  Evaluation Time: 4.71 [s]
[2024-09-19 13:38:42,709][root][INFO] - Step: 375/1033  |  Loss: 1.0848  |  Score: 63.27 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:46,171][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-19 13:38:46,171][root][INFO] - Score: 63.55 [%]  |  Evaluation Time: 4.50 [s]
[2024-09-19 13:38:46,173][root][INFO] - 
[8/ 15 Epoch]
[2024-09-19 13:38:53,073][root][INFO] - Step: 390/1033  |  Loss: 0.9357  |  Score: 67.30 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:54,174][root][INFO] - Step: 495/1033  |  Loss: 0.4448  |  Score: 81.94 [%]  |  Seq Length: 128.0
[2024-09-19 13:38:58,424][root][INFO] - Step: 1100/9020  |  Loss: 0.3277  |  Score: 85.78 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:02,521][root][INFO] - Step: 510/1033  |  Loss: 0.4516  |  Score: 83.49 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:03,083][root][INFO] - Step: 405/1033  |  Loss: 0.9601  |  Score: 66.05 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:08,607][root][INFO] - Step: 413/1033  |  Loss: 0.8160  |  Score: 70.15 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:10,534][root][INFO] - Step: 525/1033  |  Loss: 0.4675  |  Score: 82.27 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:14,152][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-19 13:39:14,152][root][INFO] - Score: 66.54 [%]  |  Evaluation Time: 5.54 [s]
[2024-09-19 13:39:18,504][root][INFO] - Step: 540/1033  |  Loss: 0.4436  |  Score: 79.97 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:19,590][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-19 13:39:19,590][root][INFO] - Score: 62.67 [%]  |  Evaluation Time: 5.44 [s]
[2024-09-19 13:39:19,592][root][INFO] - 
[7/ 15 Epoch]
[2024-09-19 13:39:24,391][root][INFO] - Step: 420/1033  |  Loss: 0.8734  |  Score: 66.97 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:24,552][root][INFO] - Step: 551/1033  |  Loss: 0.5128  |  Score: 82.64 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:28,454][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-19 13:39:28,454][root][INFO] - Score: 73.02 [%]  |  Evaluation Time: 3.90 [s]
[2024-09-19 13:39:30,111][root][INFO] - Step: 1200/9020  |  Loss: 0.3298  |  Score: 85.64 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:32,618][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-19 13:39:32,618][root][INFO] - Score: 63.36 [%]  |  Evaluation Time: 4.16 [s]
[2024-09-19 13:39:32,623][root][INFO] - 
[9/ 15 Epoch]
[2024-09-19 13:39:34,692][root][INFO] - Step: 435/1033  |  Loss: 0.8400  |  Score: 70.95 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:34,828][root][INFO] - Step: 555/1033  |  Loss: 0.4223  |  Score: 82.47 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:43,186][root][INFO] - Step: 570/1033  |  Loss: 0.4005  |  Score: 84.64 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:45,014][root][INFO] - Step: 450/1033  |  Loss: 0.9450  |  Score: 69.84 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:51,637][root][INFO] - Step: 585/1033  |  Loss: 0.3854  |  Score: 83.54 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:55,312][root][INFO] - Step: 465/1033  |  Loss: 0.8001  |  Score: 68.85 [%]  |  Seq Length: 128.0
[2024-09-19 13:39:59,891][root][INFO] - Step: 600/1033  |  Loss: 0.4226  |  Score: 85.64 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:00,001][root][INFO] - Step: 1300/9020  |  Loss: 0.3276  |  Score: 85.83 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:04,369][root][INFO] - Step: 480/1033  |  Loss: 0.8307  |  Score: 74.63 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:05,476][root][INFO] - Step: 482/1033  |  Loss: 0.9642  |  Score: 67.66 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:08,068][root][INFO] - Step: 615/1033  |  Loss: 0.3579  |  Score: 84.83 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:10,821][root][INFO] - Step: 619/1033  |  Loss: 0.4489  |  Score: 79.47 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:10,970][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-19 13:40:10,970][root][INFO] - Score: 69.54 [%]  |  Evaluation Time: 5.49 [s]
[2024-09-19 13:40:14,802][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-19 13:40:14,802][root][INFO] - Score: 72.11 [%]  |  Evaluation Time: 3.98 [s]
[2024-09-19 13:40:16,222][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-19 13:40:16,222][root][INFO] - Score: 66.40 [%]  |  Evaluation Time: 5.25 [s]
[2024-09-19 13:40:16,223][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-19 13:40:16,224][root][INFO] - 
[8/ 15 Epoch]
[2024-09-19 13:40:18,571][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-19 13:40:18,572][root][INFO] - Score: 64.57 [%]  |  Evaluation Time: 3.77 [s]
[2024-09-19 13:40:18,574][root][INFO] - 
[10/ 15 Epoch]
[2024-09-19 13:40:24,611][root][INFO] - Step: 630/1033  |  Loss: 0.3376  |  Score: 86.57 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:25,228][root][INFO] - Step: 495/1033  |  Loss: 0.6719  |  Score: 76.99 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:31,595][root][INFO] - Step: 1400/9020  |  Loss: 0.3436  |  Score: 84.98 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:32,752][root][INFO] - Step: 645/1033  |  Loss: 0.3390  |  Score: 85.43 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:35,576][root][INFO] - Step: 510/1033  |  Loss: 0.7648  |  Score: 75.31 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:40,572][root][INFO] - Step: 660/1033  |  Loss: 0.3667  |  Score: 85.64 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:45,967][root][INFO] - Step: 525/1033  |  Loss: 0.7659  |  Score: 72.94 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:48,477][root][INFO] - Step: 675/1033  |  Loss: 0.3292  |  Score: 85.38 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:55,394][root][INFO] - Step: 540/1033  |  Loss: 0.6774  |  Score: 74.97 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:55,721][root][INFO] - Step: 688/1033  |  Loss: 0.3538  |  Score: 87.38 [%]  |  Seq Length: 128.0
[2024-09-19 13:40:59,671][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-19 13:40:59,671][root][INFO] - Score: 70.93 [%]  |  Evaluation Time: 3.95 [s]
[2024-09-19 13:41:02,761][root][INFO] - Step: 551/1033  |  Loss: 0.7113  |  Score: 76.49 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:03,002][root][INFO] - Step: 1500/9020  |  Loss: 0.3253  |  Score: 86.22 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:03,513][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-19 13:41:03,513][root][INFO] - Score: 63.83 [%]  |  Evaluation Time: 3.84 [s]
[2024-09-19 13:41:03,515][root][INFO] - 
[11/ 15 Epoch]
[2024-09-19 13:41:04,490][root][INFO] - Step: 690/1033  |  Loss: 0.2664  |  Score: 90.36 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:08,229][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-19 13:41:08,229][root][INFO] - Score: 71.40 [%]  |  Evaluation Time: 5.47 [s]
[2024-09-19 13:41:13,128][root][INFO] - Step: 705/1033  |  Loss: 0.3079  |  Score: 88.01 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:13,362][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-19 13:41:13,363][root][INFO] - Score: 65.99 [%]  |  Evaluation Time: 5.13 [s]
[2024-09-19 13:41:13,363][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-19 13:41:13,364][root][INFO] - 
[9/ 15 Epoch]
[2024-09-19 13:41:16,241][root][INFO] - Step: 555/1033  |  Loss: 0.6276  |  Score: 79.70 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:22,204][root][INFO] - Step: 720/1033  |  Loss: 0.3197  |  Score: 86.99 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:26,326][root][INFO] - Step: 570/1033  |  Loss: 0.5551  |  Score: 80.44 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:30,537][root][INFO] - Step: 735/1033  |  Loss: 0.2936  |  Score: 88.03 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:33,738][root][INFO] - Step: 1600/9020  |  Loss: 0.3334  |  Score: 85.67 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:36,297][root][INFO] - Step: 585/1033  |  Loss: 0.6163  |  Score: 76.77 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:38,767][root][INFO] - Step: 750/1033  |  Loss: 0.3296  |  Score: 85.04 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:43,003][root][INFO] - Step: 757/1033  |  Loss: 0.3123  |  Score: 87.43 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:46,509][root][INFO] - Step: 600/1033  |  Loss: 0.5483  |  Score: 79.96 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:46,933][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-19 13:41:46,933][root][INFO] - Score: 74.22 [%]  |  Evaluation Time: 3.93 [s]
[2024-09-19 13:41:50,708][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-19 13:41:50,708][root][INFO] - Score: 65.26 [%]  |  Evaluation Time: 3.77 [s]
[2024-09-19 13:41:50,710][root][INFO] - 
[12/ 15 Epoch]
[2024-09-19 13:41:54,975][root][INFO] - Step: 765/1033  |  Loss: 0.2261  |  Score: 89.85 [%]  |  Seq Length: 128.0
[2024-09-19 13:41:56,811][root][INFO] - Step: 615/1033  |  Loss: 0.6251  |  Score: 77.94 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:00,214][root][INFO] - Step: 619/1033  |  Loss: 0.5890  |  Score: 77.90 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:03,369][root][INFO] - Step: 780/1033  |  Loss: 0.2979  |  Score: 88.31 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:05,724][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-19 13:42:05,725][root][INFO] - Score: 72.81 [%]  |  Evaluation Time: 5.51 [s]
[2024-09-19 13:42:06,153][root][INFO] - Step: 1700/9020  |  Loss: 0.3191  |  Score: 86.44 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:10,889][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-19 13:42:10,889][root][INFO] - Score: 64.20 [%]  |  Evaluation Time: 5.16 [s]
[2024-09-19 13:42:10,891][root][INFO] - 
[10/ 15 Epoch]
[2024-09-19 13:42:11,587][root][INFO] - Step: 795/1033  |  Loss: 0.3002  |  Score: 87.72 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:17,809][root][INFO] - Step: 630/1033  |  Loss: 0.4728  |  Score: 81.36 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:19,820][root][INFO] - Step: 810/1033  |  Loss: 0.2773  |  Score: 88.23 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:27,979][root][INFO] - Step: 645/1033  |  Loss: 0.5224  |  Score: 81.29 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:28,040][root][INFO] - Step: 825/1033  |  Loss: 0.2826  |  Score: 87.16 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:28,935][root][INFO] - Step: 826/1033  |  Loss: 0.3296  |  Score: 82.23 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:32,882][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-19 13:42:32,882][root][INFO] - Score: 70.63 [%]  |  Evaluation Time: 3.94 [s]
[2024-09-19 13:42:36,665][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-19 13:42:36,665][root][INFO] - Score: 66.84 [%]  |  Evaluation Time: 3.78 [s]
[2024-09-19 13:42:36,667][root][INFO] - 
[13/ 15 Epoch]
[2024-09-19 13:42:37,177][root][INFO] - Step: 1800/9020  |  Loss: 0.3262  |  Score: 85.67 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:37,956][root][INFO] - Step: 660/1033  |  Loss: 0.5082  |  Score: 82.90 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:38,593][root][INFO] - Step: 1804/9020  |  Loss: 0.2828  |  Score: 90.23 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:44,345][root][INFO] - Step: 840/1033  |  Loss: 0.2625  |  Score: 89.38 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:48,097][root][INFO] - Step: 675/1033  |  Loss: 0.4812  |  Score: 82.21 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:52,100][root][INFO] - Step: 855/1033  |  Loss: 0.2592  |  Score: 89.08 [%]  |  Seq Length: 128.0
[2024-09-19 13:42:56,552][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 13:42:56,552][root][INFO] - Score: 86.67 [%]  |  Evaluation Time: 17.96 [s]
[2024-09-19 13:42:57,063][root][INFO] - Step: 688/1033  |  Loss: 0.4515  |  Score: 84.02 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:01,060][root][INFO] - Step: 870/1033  |  Loss: 0.2567  |  Score: 88.81 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:02,526][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-19 13:43:02,526][root][INFO] - Score: 75.26 [%]  |  Evaluation Time: 5.46 [s]
[2024-09-19 13:43:07,775][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-19 13:43:07,775][root][INFO] - Score: 65.63 [%]  |  Evaluation Time: 5.25 [s]
[2024-09-19 13:43:07,776][root][INFO] - 
Save new Best Score (Epoch: 10)
[2024-09-19 13:43:07,777][root][INFO] - 
[11/ 15 Epoch]
[2024-09-19 13:43:08,862][root][INFO] - Step: 690/1033  |  Loss: 0.4456  |  Score: 70.76 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:09,821][root][INFO] - Step: 885/1033  |  Loss: 0.2386  |  Score: 88.42 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:14,408][root][INFO] - Step: 895/1033  |  Loss: 0.2420  |  Score: 88.80 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:18,386][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-19 13:43:18,386][root][INFO] - Score: 73.05 [%]  |  Evaluation Time: 3.97 [s]
[2024-09-19 13:43:18,500][root][INFO] - Step: 705/1033  |  Loss: 0.3898  |  Score: 85.26 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:22,205][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-19 13:43:22,205][root][INFO] - Score: 65.06 [%]  |  Evaluation Time: 3.82 [s]
[2024-09-19 13:43:22,207][root][INFO] - 
[14/ 15 Epoch]
[2024-09-19 13:43:25,123][root][INFO] - Step: 900/1033  |  Loss: 0.2395  |  Score: 88.73 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:27,464][root][INFO] - Step: 720/1033  |  Loss: 0.4247  |  Score: 81.91 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:33,896][root][INFO] - Step: 915/1033  |  Loss: 0.2554  |  Score: 87.42 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:37,177][root][INFO] - Step: 735/1033  |  Loss: 0.4018  |  Score: 84.73 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:42,445][root][INFO] - Step: 930/1033  |  Loss: 0.2448  |  Score: 88.99 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:46,457][root][INFO] - Step: 750/1033  |  Loss: 0.4605  |  Score: 82.13 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:50,700][root][INFO] - Step: 945/1033  |  Loss: 0.2509  |  Score: 89.15 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:51,479][root][INFO] - Step: 757/1033  |  Loss: 0.3966  |  Score: 84.51 [%]  |  Seq Length: 128.0
[2024-09-19 13:43:56,934][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-19 13:43:56,935][root][INFO] - Score: 74.17 [%]  |  Evaluation Time: 5.45 [s]
[2024-09-19 13:43:57,791][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 13:43:57,792][root][INFO] - Score: 86.83 [%]  |  Evaluation Time: 61.24 [s]
[2024-09-19 13:43:57,793][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 13:43:57,796][root][INFO] - 
[2/ 5 Epoch]
[2024-09-19 13:43:59,077][root][INFO] - Step: 960/1033  |  Loss: 0.2457  |  Score: 88.21 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:01,522][root][INFO] - Step: 964/1033  |  Loss: 0.2188  |  Score: 92.50 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:02,125][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-19 13:44:02,125][root][INFO] - Score: 67.15 [%]  |  Evaluation Time: 5.19 [s]
[2024-09-19 13:44:02,126][root][INFO] - 
Save new Best Score (Epoch: 11)
[2024-09-19 13:44:02,127][root][INFO] - 
[12/ 15 Epoch]
[2024-09-19 13:44:05,746][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-19 13:44:05,746][root][INFO] - Score: 74.33 [%]  |  Evaluation Time: 4.22 [s]
[2024-09-19 13:44:07,351][root][INFO] - Step: 765/1033  |  Loss: 0.3354  |  Score: 86.57 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:09,569][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-19 13:44:09,569][root][INFO] - Score: 63.45 [%]  |  Evaluation Time: 3.82 [s]
[2024-09-19 13:44:09,571][root][INFO] - 
[15/ 15 Epoch]
[2024-09-19 13:44:15,719][root][INFO] - Step: 975/1033  |  Loss: 0.2363  |  Score: 88.32 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:17,307][root][INFO] - Step: 780/1033  |  Loss: 0.3925  |  Score: 84.63 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:24,174][root][INFO] - Step: 990/1033  |  Loss: 0.2597  |  Score: 87.83 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:27,198][root][INFO] - Step: 795/1033  |  Loss: 0.3679  |  Score: 85.43 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:27,708][root][INFO] - Step: 1900/9020  |  Loss: 0.3012  |  Score: 86.83 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:32,483][root][INFO] - Step: 1005/1033  |  Loss: 0.2360  |  Score: 89.56 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:36,128][root][INFO] - Step: 810/1033  |  Loss: 0.3660  |  Score: 85.25 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:41,424][root][INFO] - Step: 1020/1033  |  Loss: 0.2343  |  Score: 87.63 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:45,348][root][INFO] - Step: 825/1033  |  Loss: 0.3662  |  Score: 85.70 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:46,364][root][INFO] - Step: 826/1033  |  Loss: 0.3183  |  Score: 84.69 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:48,593][root][INFO] - Step: 1033/1033  |  Loss: 0.2289  |  Score: 88.99 [%]  |  Seq Length: 128.0
[2024-09-19 13:44:51,781][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-19 13:44:51,782][root][INFO] - Score: 72.68 [%]  |  Evaluation Time: 5.41 [s]
[2024-09-19 13:44:53,045][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-19 13:44:53,046][root][INFO] - Score: 75.11 [%]  |  Evaluation Time: 4.45 [s]
[2024-09-19 13:44:56,843][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-19 13:44:56,843][root][INFO] - Score: 67.48 [%]  |  Evaluation Time: 3.80 [s]
[2024-09-19 13:44:56,844][root][INFO] - 
Save new Best Score (Epoch: 15)
[2024-09-19 13:44:56,844][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 13:44:56,844][root][INFO] - - Epoch: 15
[2024-09-19 13:44:56,844][root][INFO] - - DEV score: 75.11 [%]
[2024-09-19 13:44:56,844][root][INFO] - - TEST score: 67.48 [%]
[2024-09-19 13:44:56,845][root][INFO] - Fine-tuning is done!
[2024-09-19 13:44:56,909][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-19 13:44:56,909][root][INFO] - Score: 63.66 [%]  |  Evaluation Time: 5.13 [s]
[2024-09-19 13:44:56,911][root][INFO] - 
[13/ 15 Epoch]
[2024-09-19 13:44:59,373][root][INFO] - Step: 2000/9020  |  Loss: 0.2901  |  Score: 87.95 [%]  |  Seq Length: 128.0
[2024-09-19 13:45:05,999][root][INFO] - Step: 840/1033  |  Loss: 0.3296  |  Score: 86.14 [%]  |  Seq Length: 128.0
[2024-09-19 13:45:15,738][root][INFO] - Step: 855/1033  |  Loss: 0.3233  |  Score: 84.86 [%]  |  Seq Length: 128.0
[2024-09-19 13:45:25,614][root][INFO] - Step: 870/1033  |  Loss: 0.3203  |  Score: 85.41 [%]  |  Seq Length: 128.0
[2024-09-19 13:45:29,783][root][INFO] - Step: 2100/9020  |  Loss: 0.2896  |  Score: 87.58 [%]  |  Seq Length: 128.0
[2024-09-19 13:45:35,526][root][INFO] - Step: 885/1033  |  Loss: 0.3301  |  Score: 86.89 [%]  |  Seq Length: 128.0
[2024-09-19 13:45:42,398][root][INFO] - Step: 895/1033  |  Loss: 0.3365  |  Score: 88.47 [%]  |  Seq Length: 128.0
[2024-09-19 13:45:47,780][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-19 13:45:47,780][root][INFO] - Score: 74.16 [%]  |  Evaluation Time: 5.38 [s]
[2024-09-19 13:45:53,182][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-19 13:45:53,182][root][INFO] - Score: 66.58 [%]  |  Evaluation Time: 5.40 [s]
[2024-09-19 13:45:53,184][root][INFO] - 
[14/ 15 Epoch]
[2024-09-19 13:45:56,452][root][INFO] - Step: 900/1033  |  Loss: 0.2744  |  Score: 88.11 [%]  |  Seq Length: 128.0
[2024-09-19 13:46:00,038][root][INFO] - Step: 2200/9020  |  Loss: 0.2956  |  Score: 87.67 [%]  |  Seq Length: 128.0
[2024-09-19 13:46:06,217][root][INFO] - Step: 915/1033  |  Loss: 0.3110  |  Score: 85.71 [%]  |  Seq Length: 128.0
[2024-09-19 13:46:14,330][root][INFO] - Step: 930/1033  |  Loss: 0.3049  |  Score: 86.66 [%]  |  Seq Length: 128.0
[2024-09-19 13:46:22,582][root][INFO] - Step: 945/1033  |  Loss: 0.2845  |  Score: 86.48 [%]  |  Seq Length: 128.0
[2024-09-19 13:46:28,932][root][INFO] - Step: 2300/9020  |  Loss: 0.2987  |  Score: 87.36 [%]  |  Seq Length: 128.0
[2024-09-19 13:46:32,362][root][INFO] - Step: 960/1033  |  Loss: 0.3399  |  Score: 86.10 [%]  |  Seq Length: 128.0
[2024-09-19 13:46:35,242][root][INFO] - Step: 964/1033  |  Loss: 0.2986  |  Score: 85.60 [%]  |  Seq Length: 128.0
[2024-09-19 13:46:40,684][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-19 13:46:40,684][root][INFO] - Score: 71.97 [%]  |  Evaluation Time: 5.44 [s]
[2024-09-19 13:46:45,775][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-19 13:46:45,775][root][INFO] - Score: 64.37 [%]  |  Evaluation Time: 5.09 [s]
[2024-09-19 13:46:45,777][root][INFO] - 
[15/ 15 Epoch]
[2024-09-19 13:46:53,072][root][INFO] - Step: 975/1033  |  Loss: 0.3162  |  Score: 86.75 [%]  |  Seq Length: 128.0
[2024-09-19 13:46:56,977][root][INFO] - Step: 2400/9020  |  Loss: 0.2891  |  Score: 87.86 [%]  |  Seq Length: 128.0
[2024-09-19 13:47:02,719][root][INFO] - Step: 990/1033  |  Loss: 0.3047  |  Score: 87.13 [%]  |  Seq Length: 128.0
[2024-09-19 13:47:12,349][root][INFO] - Step: 1005/1033  |  Loss: 0.3052  |  Score: 86.88 [%]  |  Seq Length: 128.0
[2024-09-19 13:47:22,101][root][INFO] - Step: 1020/1033  |  Loss: 0.3064  |  Score: 88.08 [%]  |  Seq Length: 128.0
[2024-09-19 13:47:29,179][root][INFO] - Step: 2500/9020  |  Loss: 0.2887  |  Score: 87.92 [%]  |  Seq Length: 128.0
[2024-09-19 13:47:30,750][root][INFO] - Step: 1033/1033  |  Loss: 0.2921  |  Score: 87.27 [%]  |  Seq Length: 128.0
[2024-09-19 13:47:36,154][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-19 13:47:36,154][root][INFO] - Score: 72.76 [%]  |  Evaluation Time: 5.40 [s]
[2024-09-19 13:47:41,291][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-19 13:47:41,291][root][INFO] - Score: 64.42 [%]  |  Evaluation Time: 5.14 [s]
[2024-09-19 13:47:41,292][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 13:47:41,292][root][INFO] - - Epoch: 11
[2024-09-19 13:47:41,293][root][INFO] - - DEV score: 74.17 [%]
[2024-09-19 13:47:41,293][root][INFO] - - TEST score: 67.15 [%]
[2024-09-19 13:47:41,293][root][INFO] - Fine-tuning is done!
[2024-09-19 13:47:59,930][root][INFO] - Step: 2600/9020  |  Loss: 0.2797  |  Score: 87.94 [%]  |  Seq Length: 128.0
[2024-09-19 13:48:30,619][root][INFO] - Step: 2700/9020  |  Loss: 0.2974  |  Score: 87.45 [%]  |  Seq Length: 128.0
[2024-09-19 13:49:02,064][root][INFO] - Step: 2800/9020  |  Loss: 0.2770  |  Score: 88.44 [%]  |  Seq Length: 128.0
[2024-09-19 13:49:32,414][root][INFO] - Step: 2900/9020  |  Loss: 0.2778  |  Score: 88.27 [%]  |  Seq Length: 128.0
[2024-09-19 13:50:03,745][root][INFO] - Step: 3000/9020  |  Loss: 0.2967  |  Score: 87.47 [%]  |  Seq Length: 128.0
[2024-09-19 13:50:34,056][root][INFO] - Step: 3100/9020  |  Loss: 0.2886  |  Score: 87.67 [%]  |  Seq Length: 128.0
[2024-09-19 13:51:04,994][root][INFO] - Step: 3200/9020  |  Loss: 0.2820  |  Score: 88.28 [%]  |  Seq Length: 128.0
[2024-09-19 13:51:35,583][root][INFO] - Step: 3300/9020  |  Loss: 0.2805  |  Score: 88.69 [%]  |  Seq Length: 128.0
[2024-09-19 13:52:07,095][root][INFO] - Step: 3400/9020  |  Loss: 0.2813  |  Score: 87.95 [%]  |  Seq Length: 128.0
[2024-09-19 13:52:37,768][root][INFO] - Step: 3500/9020  |  Loss: 0.2836  |  Score: 88.09 [%]  |  Seq Length: 128.0
[2024-09-19 13:53:08,532][root][INFO] - Step: 3600/9020  |  Loss: 0.2859  |  Score: 88.14 [%]  |  Seq Length: 128.0
[2024-09-19 13:53:11,033][root][INFO] - Step: 3608/9020  |  Loss: 0.2597  |  Score: 89.02 [%]  |  Seq Length: 128.0
[2024-09-19 13:53:31,016][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 13:53:31,017][root][INFO] - Score: 87.72 [%]  |  Evaluation Time: 19.98 [s]
[2024-09-19 13:54:28,970][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 13:54:28,970][root][INFO] - Score: 88.06 [%]  |  Evaluation Time: 57.95 [s]
[2024-09-19 13:54:28,971][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 13:54:28,972][root][INFO] - 
[3/ 5 Epoch]
[2024-09-19 13:54:57,492][root][INFO] - Step: 3700/9020  |  Loss: 0.2447  |  Score: 90.20 [%]  |  Seq Length: 128.0
[2024-09-19 13:55:28,465][root][INFO] - Step: 3800/9020  |  Loss: 0.2567  |  Score: 89.62 [%]  |  Seq Length: 128.0
[2024-09-19 13:55:58,337][root][INFO] - Step: 3900/9020  |  Loss: 0.2481  |  Score: 89.94 [%]  |  Seq Length: 128.0
[2024-09-19 13:56:29,268][root][INFO] - Step: 4000/9020  |  Loss: 0.2460  |  Score: 89.88 [%]  |  Seq Length: 128.0
[2024-09-19 13:56:59,109][root][INFO] - Step: 4100/9020  |  Loss: 0.2480  |  Score: 89.89 [%]  |  Seq Length: 128.0
[2024-09-19 13:57:29,350][root][INFO] - Step: 4200/9020  |  Loss: 0.2596  |  Score: 88.75 [%]  |  Seq Length: 128.0
[2024-09-19 13:58:00,717][root][INFO] - Step: 4300/9020  |  Loss: 0.2663  |  Score: 88.48 [%]  |  Seq Length: 128.0
[2024-09-19 13:58:31,128][root][INFO] - Step: 4400/9020  |  Loss: 0.2517  |  Score: 89.59 [%]  |  Seq Length: 128.0
[2024-09-19 13:59:01,797][root][INFO] - Step: 4500/9020  |  Loss: 0.2544  |  Score: 89.88 [%]  |  Seq Length: 128.0
[2024-09-19 13:59:32,327][root][INFO] - Step: 4600/9020  |  Loss: 0.2468  |  Score: 90.03 [%]  |  Seq Length: 128.0
[2024-09-19 14:00:03,658][root][INFO] - Step: 4700/9020  |  Loss: 0.2590  |  Score: 89.28 [%]  |  Seq Length: 128.0
[2024-09-19 14:00:34,556][root][INFO] - Step: 4800/9020  |  Loss: 0.2580  |  Score: 89.48 [%]  |  Seq Length: 128.0
[2024-09-19 14:01:03,247][root][INFO] - Step: 4900/9020  |  Loss: 0.2411  |  Score: 90.03 [%]  |  Seq Length: 128.0
[2024-09-19 14:01:33,863][root][INFO] - Step: 5000/9020  |  Loss: 0.2653  |  Score: 88.92 [%]  |  Seq Length: 128.0
[2024-09-19 14:02:05,394][root][INFO] - Step: 5100/9020  |  Loss: 0.2559  |  Score: 89.48 [%]  |  Seq Length: 128.0
[2024-09-19 14:02:36,447][root][INFO] - Step: 5200/9020  |  Loss: 0.2485  |  Score: 89.94 [%]  |  Seq Length: 128.0
[2024-09-19 14:03:05,625][root][INFO] - Step: 5300/9020  |  Loss: 0.2561  |  Score: 89.36 [%]  |  Seq Length: 128.0
[2024-09-19 14:03:35,156][root][INFO] - Step: 5400/9020  |  Loss: 0.2492  |  Score: 89.86 [%]  |  Seq Length: 128.0
[2024-09-19 14:03:38,633][root][INFO] - Step: 5412/9020  |  Loss: 0.2856  |  Score: 87.97 [%]  |  Seq Length: 128.0
[2024-09-19 14:03:56,292][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 14:03:56,292][root][INFO] - Score: 88.05 [%]  |  Evaluation Time: 17.66 [s]
[2024-09-19 14:04:56,573][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 14:04:56,574][root][INFO] - Score: 88.37 [%]  |  Evaluation Time: 60.28 [s]
[2024-09-19 14:04:56,575][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-19 14:04:56,576][root][INFO] - 
[4/ 5 Epoch]
[2024-09-19 14:05:23,469][root][INFO] - Step: 5500/9020  |  Loss: 0.2222  |  Score: 91.12 [%]  |  Seq Length: 128.0
[2024-09-19 14:05:53,515][root][INFO] - Step: 5600/9020  |  Loss: 0.2308  |  Score: 90.67 [%]  |  Seq Length: 128.0
[2024-09-19 14:06:24,583][root][INFO] - Step: 5700/9020  |  Loss: 0.2326  |  Score: 90.53 [%]  |  Seq Length: 128.0
[2024-09-19 14:06:54,719][root][INFO] - Step: 5800/9020  |  Loss: 0.2272  |  Score: 90.78 [%]  |  Seq Length: 128.0
[2024-09-19 14:07:25,764][root][INFO] - Step: 5900/9020  |  Loss: 0.2440  |  Score: 90.38 [%]  |  Seq Length: 128.0
[2024-09-19 14:07:57,469][root][INFO] - Step: 6000/9020  |  Loss: 0.2431  |  Score: 89.95 [%]  |  Seq Length: 128.0
[2024-09-19 14:08:27,024][root][INFO] - Step: 6100/9020  |  Loss: 0.2438  |  Score: 89.98 [%]  |  Seq Length: 128.0
[2024-09-19 14:08:57,493][root][INFO] - Step: 6200/9020  |  Loss: 0.2224  |  Score: 90.83 [%]  |  Seq Length: 128.0
[2024-09-19 14:09:28,077][root][INFO] - Step: 6300/9020  |  Loss: 0.2247  |  Score: 91.14 [%]  |  Seq Length: 128.0
[2024-09-19 14:09:58,184][root][INFO] - Step: 6400/9020  |  Loss: 0.2212  |  Score: 91.03 [%]  |  Seq Length: 128.0
[2024-09-19 14:10:28,586][root][INFO] - Step: 6500/9020  |  Loss: 0.2282  |  Score: 90.47 [%]  |  Seq Length: 128.0
[2024-09-19 14:10:58,873][root][INFO] - Step: 6600/9020  |  Loss: 0.2256  |  Score: 91.02 [%]  |  Seq Length: 128.0
[2024-09-19 14:11:30,922][root][INFO] - Step: 6700/9020  |  Loss: 0.2270  |  Score: 90.98 [%]  |  Seq Length: 128.0
[2024-09-19 14:12:01,079][root][INFO] - Step: 6800/9020  |  Loss: 0.2251  |  Score: 90.94 [%]  |  Seq Length: 128.0
[2024-09-19 14:12:30,844][root][INFO] - Step: 6900/9020  |  Loss: 0.2347  |  Score: 90.30 [%]  |  Seq Length: 128.0
[2024-09-19 14:13:01,572][root][INFO] - Step: 7000/9020  |  Loss: 0.2213  |  Score: 91.41 [%]  |  Seq Length: 128.0
[2024-09-19 14:13:31,566][root][INFO] - Step: 7100/9020  |  Loss: 0.2170  |  Score: 90.72 [%]  |  Seq Length: 128.0
[2024-09-19 14:14:02,840][root][INFO] - Step: 7200/9020  |  Loss: 0.2313  |  Score: 90.69 [%]  |  Seq Length: 128.0
[2024-09-19 14:14:07,705][root][INFO] - Step: 7216/9020  |  Loss: 0.2020  |  Score: 92.38 [%]  |  Seq Length: 128.0
[2024-09-19 14:14:25,218][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 14:14:25,218][root][INFO] - Score: 88.28 [%]  |  Evaluation Time: 17.51 [s]
[2024-09-19 14:15:24,807][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 14:15:24,807][root][INFO] - Score: 88.61 [%]  |  Evaluation Time: 59.59 [s]
[2024-09-19 14:15:24,808][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-19 14:15:24,809][root][INFO] - 
[5/ 5 Epoch]
[2024-09-19 14:15:50,175][root][INFO] - Step: 7300/9020  |  Loss: 0.2193  |  Score: 91.28 [%]  |  Seq Length: 128.0
[2024-09-19 14:16:19,791][root][INFO] - Step: 7400/9020  |  Loss: 0.2182  |  Score: 91.48 [%]  |  Seq Length: 128.0
[2024-09-19 14:16:50,684][root][INFO] - Step: 7500/9020  |  Loss: 0.2112  |  Score: 91.45 [%]  |  Seq Length: 128.0
[2024-09-19 14:17:21,320][root][INFO] - Step: 7600/9020  |  Loss: 0.2114  |  Score: 91.95 [%]  |  Seq Length: 128.0
[2024-09-19 14:17:53,739][root][INFO] - Step: 7700/9020  |  Loss: 0.2104  |  Score: 91.42 [%]  |  Seq Length: 128.0
[2024-09-19 14:18:24,071][root][INFO] - Step: 7800/9020  |  Loss: 0.2047  |  Score: 91.50 [%]  |  Seq Length: 128.0
[2024-09-19 14:18:54,521][root][INFO] - Step: 7900/9020  |  Loss: 0.2125  |  Score: 91.62 [%]  |  Seq Length: 128.0
[2024-09-19 14:19:25,238][root][INFO] - Step: 8000/9020  |  Loss: 0.2238  |  Score: 91.08 [%]  |  Seq Length: 128.0
[2024-09-19 14:19:55,607][root][INFO] - Step: 8100/9020  |  Loss: 0.2072  |  Score: 91.83 [%]  |  Seq Length: 128.0
[2024-09-19 14:20:26,186][root][INFO] - Step: 8200/9020  |  Loss: 0.2148  |  Score: 91.69 [%]  |  Seq Length: 128.0
[2024-09-19 14:20:57,088][root][INFO] - Step: 8300/9020  |  Loss: 0.2175  |  Score: 90.94 [%]  |  Seq Length: 128.0
[2024-09-19 14:21:27,444][root][INFO] - Step: 8400/9020  |  Loss: 0.2148  |  Score: 91.36 [%]  |  Seq Length: 128.0
[2024-09-19 14:21:57,463][root][INFO] - Step: 8500/9020  |  Loss: 0.2007  |  Score: 91.73 [%]  |  Seq Length: 128.0
[2024-09-19 14:22:27,392][root][INFO] - Step: 8600/9020  |  Loss: 0.1995  |  Score: 92.20 [%]  |  Seq Length: 128.0
[2024-09-19 14:22:56,932][root][INFO] - Step: 8700/9020  |  Loss: 0.2175  |  Score: 91.30 [%]  |  Seq Length: 128.0
[2024-09-19 14:23:28,211][root][INFO] - Step: 8800/9020  |  Loss: 0.2235  |  Score: 90.94 [%]  |  Seq Length: 128.0
[2024-09-19 14:23:59,300][root][INFO] - Step: 8900/9020  |  Loss: 0.2210  |  Score: 91.09 [%]  |  Seq Length: 128.0
[2024-09-19 14:24:29,663][root][INFO] - Step: 9000/9020  |  Loss: 0.2248  |  Score: 91.12 [%]  |  Seq Length: 128.0
[2024-09-19 14:24:35,673][root][INFO] - Step: 9020/9020  |  Loss: 0.2408  |  Score: 90.22 [%]  |  Seq Length: 128.0
[2024-09-19 14:24:53,342][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 14:24:53,342][root][INFO] - Score: 88.33 [%]  |  Evaluation Time: 17.67 [s]
[2024-09-19 14:25:51,213][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 14:25:51,214][root][INFO] - Score: 88.60 [%]  |  Evaluation Time: 57.87 [s]
[2024-09-19 14:25:51,215][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-19 14:25:51,215][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 14:25:51,215][root][INFO] - - Epoch: 5
[2024-09-19 14:25:51,215][root][INFO] - - DEV score: 88.33 [%]
[2024-09-19 14:25:51,215][root][INFO] - - TEST score: 88.60 [%]
[2024-09-19 14:25:51,216][root][INFO] - Fine-tuning is done!
[2024-09-19 16:42:14,472][root][INFO] - 

[2024-09-19 16:42:14,472][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 16:42:14,472][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs
[2024-09-19 16:42:14,472][root][INFO] - 

[2024-09-19 16:42:14,472][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 16:42:33,966][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-19 16:42:33,966][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-19 16:42:33,967][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-19 16:42:33,967][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-19 16:42:33,968][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-19 16:42:33,968][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-19 16:42:33,969][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-19 16:42:33,969][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-19 16:42:33,970][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-19 16:42:33,970][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-19 16:42:33,971][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-19 16:42:33,971][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-19 16:42:33,972][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-19 16:42:33,972][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-19 16:42:33,972][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-19 16:42:33,973][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-19 16:42:33,973][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-19 16:42:33,974][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-19 16:42:33,974][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-19 16:42:33,975][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-19 16:42:33,975][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-19 16:42:33,976][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-19 16:42:33,976][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-19 16:42:33,976][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-19 16:42:33,978][root][INFO] - Trainable params: 1769472 || all params: 126935040 || trainable: 1.39 %
[2024-09-19 16:42:34,163][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 16:42:36,040][root][INFO] - 

[2024-09-19 16:42:36,040][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-19 16:42:36,040][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 16:42:36,048][root][INFO] - vocab size              : 51200
[2024-09-19 16:42:36,048][root][INFO] - device                  : gpu
[2024-09-19 16:42:36,049][root][INFO] - random seed             : 42
[2024-09-19 16:42:36,049][root][INFO] - train data size         : 115456
[2024-09-19 16:42:36,049][root][INFO] - max epochs              : 5
[2024-09-19 16:42:36,049][root][INFO] - total steps             : 9020
[2024-09-19 16:42:36,049][root][INFO] - warmup steps            : 902
[2024-09-19 16:42:36,049][root][INFO] - batch size              : 64
[2024-09-19 16:42:36,049][root][INFO] - accumulation steps      : 1
[2024-09-19 16:42:36,049][root][INFO] - optimizer               : adamwscale
[2024-09-19 16:42:36,049][root][INFO] - lr_scheduler            : cosine
[2024-09-19 16:42:36,049][root][INFO] - learning rate           : 0.02
[2024-09-19 16:42:36,050][root][INFO] - max length              : 256

[2024-09-19 16:42:36,050][root][INFO] - LoRA Configuration
[2024-09-19 16:42:36,050][root][INFO] - ㄴ r                    : 32
[2024-09-19 16:42:36,050][root][INFO] - ㄴ alpha                : 128
[2024-09-19 16:42:36,050][root][INFO] - ㄴ dropout              : 0.03

[2024-09-19 16:42:36,050][root][INFO] - 

[2024-09-19 16:42:36,050][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs
[2024-09-19 16:42:36,050][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs/ckpt
[2024-09-19 16:42:36,050][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs/tb
[2024-09-19 16:42:36,051][root][INFO] - * tb interval           : 100

[2024-09-19 16:42:36,051][root][INFO] - 

[2024-09-19 16:42:36,051][root][INFO] - Start the Training !
[2024-09-19 16:42:36,054][root][INFO] - 
[1/ 5 Epoch]
[2024-09-19 16:43:13,897][root][INFO] - Step: 100/9020  |  Loss: 0.5514  |  Score: 71.67 [%]  |  Seq Length: 256.0
[2024-09-19 16:43:50,353][root][INFO] - Step: 200/9020  |  Loss: 0.4262  |  Score: 80.92 [%]  |  Seq Length: 256.0
[2024-09-19 16:44:26,920][root][INFO] - Step: 300/9020  |  Loss: 0.4085  |  Score: 82.20 [%]  |  Seq Length: 256.0
[2024-09-19 16:44:37,409][root][INFO] - 

[2024-09-19 16:44:37,410][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 16:44:37,410][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs
[2024-09-19 16:44:37,410][root][INFO] - 

[2024-09-19 16:44:37,410][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 16:44:56,720][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-19 16:44:56,721][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-19 16:44:56,721][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-19 16:44:56,722][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-19 16:44:56,722][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-19 16:44:56,723][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-19 16:44:56,723][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-19 16:44:56,724][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-19 16:44:56,724][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-19 16:44:56,724][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-19 16:44:56,725][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-19 16:44:56,725][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-19 16:44:56,726][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-19 16:44:56,726][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-19 16:44:56,727][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-19 16:44:56,727][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-19 16:44:56,727][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-19 16:44:56,728][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-19 16:44:56,728][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-19 16:44:56,729][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-19 16:44:56,729][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-19 16:44:56,730][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-19 16:44:56,730][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-19 16:44:56,731][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-19 16:44:56,732][root][INFO] - Trainable params: 1769472 || all params: 126935040 || trainable: 1.39 %
[2024-09-19 16:44:56,736][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-19 16:44:56,840][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-19 16:44:56,842][root][INFO] - Trainable params: 8985600 || all params: 134151168 || trainable: 6.70 %
[2024-09-19 16:44:57,030][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 16:45:00,134][root][INFO] - 

[2024-09-19 16:45:00,134][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-19 16:45:00,135][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 16:45:00,142][root][INFO] - vocab size              : 51200
[2024-09-19 16:45:00,142][root][INFO] - device                  : gpu
[2024-09-19 16:45:00,142][root][INFO] - random seed             : 42
[2024-09-19 16:45:00,142][root][INFO] - train data size         : 115456
[2024-09-19 16:45:00,142][root][INFO] - max epochs              : 5
[2024-09-19 16:45:00,142][root][INFO] - total steps             : 9020
[2024-09-19 16:45:00,143][root][INFO] - warmup steps            : 902
[2024-09-19 16:45:00,143][root][INFO] - batch size              : 64
[2024-09-19 16:45:00,143][root][INFO] - accumulation steps      : 1
[2024-09-19 16:45:00,143][root][INFO] - optimizer               : adamwscale
[2024-09-19 16:45:00,143][root][INFO] - lr_scheduler            : cosine
[2024-09-19 16:45:00,143][root][INFO] - learning rate           : 0.02
[2024-09-19 16:45:00,143][root][INFO] - max length              : 256

[2024-09-19 16:45:00,143][root][INFO] - LoRA Configuration
[2024-09-19 16:45:00,143][root][INFO] - ㄴ r                    : 32
[2024-09-19 16:45:00,143][root][INFO] - ㄴ alpha                : 128
[2024-09-19 16:45:00,143][root][INFO] - ㄴ dropout              : 0.03

[2024-09-19 16:45:00,143][root][INFO] - KOMBO Configuration
[2024-09-19 16:45:00,144][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-19 16:45:00,144][root][INFO] - ㄴ reducer              : linear
[2024-09-19 16:45:00,144][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-19 16:45:00,144][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-19 16:45:00,144][root][INFO] - ㄴ do_combination       : True
[2024-09-19 16:45:00,144][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-19 16:45:00,144][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-19 16:45:00,144][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-19 16:45:00,144][root][INFO] -   ㄴ add_lora           : False
[2024-09-19 16:45:00,145][root][INFO] - 

[2024-09-19 16:45:00,145][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs
[2024-09-19 16:45:00,145][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs/ckpt
[2024-09-19 16:45:00,145][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs/tb
[2024-09-19 16:45:00,145][root][INFO] - * tb interval           : 100

[2024-09-19 16:45:00,145][root][INFO] - 

[2024-09-19 16:45:00,145][root][INFO] - Start the Training !
[2024-09-19 16:45:00,148][root][INFO] - 
[1/ 5 Epoch]
[2024-09-19 16:45:03,530][root][INFO] - Step: 400/9020  |  Loss: 0.3744  |  Score: 83.59 [%]  |  Seq Length: 256.0
[2024-09-19 16:45:40,292][root][INFO] - Step: 500/9020  |  Loss: 0.3725  |  Score: 83.95 [%]  |  Seq Length: 256.0
[2024-09-19 16:45:50,022][root][INFO] - Step: 100/9020  |  Loss: 0.5303  |  Score: 73.59 [%]  |  Seq Length: 256.0
[2024-09-19 16:45:55,460][root][INFO] - 

[2024-09-19 16:45:55,460][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 16:45:55,461][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs
[2024-09-19 16:45:55,461][root][INFO] - 

[2024-09-19 16:45:55,461][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 16:46:15,875][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 16:46:16,978][root][INFO] - Step: 600/9020  |  Loss: 0.3585  |  Score: 83.89 [%]  |  Seq Length: 256.0
[2024-09-19 16:46:17,773][root][INFO] - 

[2024-09-19 16:46:17,774][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-19 16:46:17,774][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 16:46:17,784][root][INFO] - vocab size              : 51200
[2024-09-19 16:46:17,784][root][INFO] - device                  : gpu
[2024-09-19 16:46:17,784][root][INFO] - random seed             : 42
[2024-09-19 16:46:17,784][root][INFO] - train data size         : 115456
[2024-09-19 16:46:17,784][root][INFO] - max epochs              : 5
[2024-09-19 16:46:17,784][root][INFO] - total steps             : 9020
[2024-09-19 16:46:17,784][root][INFO] - warmup steps            : 902
[2024-09-19 16:46:17,784][root][INFO] - batch size              : 64
[2024-09-19 16:46:17,785][root][INFO] - accumulation steps      : 1
[2024-09-19 16:46:17,785][root][INFO] - optimizer               : adamwscale
[2024-09-19 16:46:17,785][root][INFO] - lr_scheduler            : cosine
[2024-09-19 16:46:17,785][root][INFO] - learning rate           : 0.02
[2024-09-19 16:46:17,785][root][INFO] - max length              : 256

[2024-09-19 16:46:17,785][root][INFO] - 

[2024-09-19 16:46:17,785][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs
[2024-09-19 16:46:17,785][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs/ckpt
[2024-09-19 16:46:17,785][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.02lr_42rs/tb
[2024-09-19 16:46:17,786][root][INFO] - * tb interval           : 100

[2024-09-19 16:46:17,786][root][INFO] - 

[2024-09-19 16:46:17,786][root][INFO] - Start the Training !
[2024-09-19 16:46:17,789][root][INFO] - 
[1/ 5 Epoch]
[2024-09-19 16:46:39,649][root][INFO] - Step: 200/9020  |  Loss: 0.4278  |  Score: 80.78 [%]  |  Seq Length: 256.0
[2024-09-19 16:46:53,640][root][INFO] - Step: 700/9020  |  Loss: 0.3622  |  Score: 84.06 [%]  |  Seq Length: 256.0
[2024-09-19 16:47:02,978][root][INFO] - Step: 100/9020  |  Loss: 0.7323  |  Score: 69.39 [%]  |  Seq Length: 256.0
[2024-09-19 16:47:29,384][root][INFO] - Step: 300/9020  |  Loss: 0.4043  |  Score: 81.94 [%]  |  Seq Length: 256.0
[2024-09-19 16:47:30,342][root][INFO] - Step: 800/9020  |  Loss: 0.3636  |  Score: 84.11 [%]  |  Seq Length: 256.0
[2024-09-19 16:47:47,154][root][INFO] - Step: 200/9020  |  Loss: 0.4600  |  Score: 79.33 [%]  |  Seq Length: 256.0
[2024-09-19 16:48:07,046][root][INFO] - Step: 900/9020  |  Loss: 0.3322  |  Score: 86.09 [%]  |  Seq Length: 256.0
[2024-09-19 16:48:18,823][root][INFO] - Step: 400/9020  |  Loss: 0.3931  |  Score: 82.72 [%]  |  Seq Length: 256.0
[2024-09-19 16:48:31,392][root][INFO] - Step: 300/9020  |  Loss: 0.4333  |  Score: 80.20 [%]  |  Seq Length: 256.0
[2024-09-19 16:48:43,757][root][INFO] - Step: 1000/9020  |  Loss: 0.3504  |  Score: 84.41 [%]  |  Seq Length: 256.0
[2024-09-19 16:49:08,311][root][INFO] - Step: 500/9020  |  Loss: 0.3678  |  Score: 83.97 [%]  |  Seq Length: 256.0
[2024-09-19 16:49:15,625][root][INFO] - Step: 400/9020  |  Loss: 0.4111  |  Score: 81.59 [%]  |  Seq Length: 256.0
[2024-09-19 16:49:20,486][root][INFO] - Step: 1100/9020  |  Loss: 0.3357  |  Score: 85.08 [%]  |  Seq Length: 256.0
[2024-09-19 16:49:57,222][root][INFO] - Step: 1200/9020  |  Loss: 0.3434  |  Score: 85.28 [%]  |  Seq Length: 256.0
[2024-09-19 16:49:57,747][root][INFO] - Step: 600/9020  |  Loss: 0.3591  |  Score: 84.30 [%]  |  Seq Length: 256.0
[2024-09-19 16:49:59,935][root][INFO] - Step: 500/9020  |  Loss: 0.4339  |  Score: 80.98 [%]  |  Seq Length: 256.0
[2024-09-19 16:50:33,959][root][INFO] - Step: 1300/9020  |  Loss: 0.3422  |  Score: 85.14 [%]  |  Seq Length: 256.0
[2024-09-19 16:50:44,309][root][INFO] - Step: 600/9020  |  Loss: 0.4286  |  Score: 80.42 [%]  |  Seq Length: 256.0
[2024-09-19 16:50:47,466][root][INFO] - Step: 700/9020  |  Loss: 0.3695  |  Score: 83.50 [%]  |  Seq Length: 256.0
[2024-09-19 16:51:10,699][root][INFO] - Step: 1400/9020  |  Loss: 0.3434  |  Score: 84.91 [%]  |  Seq Length: 256.0
[2024-09-19 16:51:28,613][root][INFO] - Step: 700/9020  |  Loss: 0.4390  |  Score: 80.55 [%]  |  Seq Length: 256.0
[2024-09-19 16:51:37,355][root][INFO] - Step: 800/9020  |  Loss: 0.3614  |  Score: 84.27 [%]  |  Seq Length: 256.0
[2024-09-19 16:51:47,433][root][INFO] - Step: 1500/9020  |  Loss: 0.3427  |  Score: 85.36 [%]  |  Seq Length: 256.0
[2024-09-19 16:52:12,906][root][INFO] - Step: 800/9020  |  Loss: 0.4488  |  Score: 79.66 [%]  |  Seq Length: 256.0
[2024-09-19 16:52:24,210][root][INFO] - Step: 1600/9020  |  Loss: 0.3542  |  Score: 84.64 [%]  |  Seq Length: 256.0
[2024-09-19 16:52:27,035][root][INFO] - Step: 900/9020  |  Loss: 0.3622  |  Score: 83.61 [%]  |  Seq Length: 256.0
[2024-09-19 16:52:57,274][root][INFO] - Step: 900/9020  |  Loss: 0.4425  |  Score: 80.22 [%]  |  Seq Length: 256.0
[2024-09-19 16:53:00,952][root][INFO] - Step: 1700/9020  |  Loss: 0.3430  |  Score: 85.30 [%]  |  Seq Length: 256.0
[2024-09-19 16:53:15,587][root][INFO] - Step: 1000/9020  |  Loss: 0.3522  |  Score: 84.89 [%]  |  Seq Length: 256.0
[2024-09-19 16:53:37,842][root][INFO] - Step: 1800/9020  |  Loss: 0.3458  |  Score: 84.84 [%]  |  Seq Length: 256.0
[2024-09-19 16:53:39,370][root][INFO] - Step: 1804/9020  |  Loss: 0.4418  |  Score: 80.75 [%]  |  Seq Length: 256.0
[2024-09-19 16:53:41,665][root][INFO] - Step: 1000/9020  |  Loss: 0.4818  |  Score: 77.58 [%]  |  Seq Length: 256.0
[2024-09-19 16:54:05,349][root][INFO] - Step: 1100/9020  |  Loss: 0.3473  |  Score: 85.17 [%]  |  Seq Length: 256.0
[2024-09-19 16:54:08,648][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 16:54:08,648][root][INFO] - Score: 86.00 [%]  |  Evaluation Time: 29.28 [s]
[2024-09-19 16:54:26,010][root][INFO] - Step: 1100/9020  |  Loss: 0.4520  |  Score: 79.62 [%]  |  Seq Length: 256.0
[2024-09-19 16:54:54,791][root][INFO] - Step: 1200/9020  |  Loss: 0.3528  |  Score: 84.05 [%]  |  Seq Length: 256.0
[2024-09-19 16:55:10,371][root][INFO] - Step: 1200/9020  |  Loss: 0.4417  |  Score: 79.72 [%]  |  Seq Length: 256.0
[2024-09-19 16:55:44,296][root][INFO] - Step: 1300/9020  |  Loss: 0.3452  |  Score: 84.70 [%]  |  Seq Length: 256.0
[2024-09-19 16:55:44,866][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 16:55:44,866][root][INFO] - Score: 85.90 [%]  |  Evaluation Time: 96.22 [s]
[2024-09-19 16:55:44,867][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 16:55:44,868][root][INFO] - 
[2/ 5 Epoch]
[2024-09-19 16:55:54,761][root][INFO] - Step: 1300/9020  |  Loss: 0.4572  |  Score: 79.36 [%]  |  Seq Length: 256.0
[2024-09-19 16:56:20,468][root][INFO] - Step: 1900/9020  |  Loss: 0.2993  |  Score: 87.47 [%]  |  Seq Length: 256.0
[2024-09-19 16:56:33,684][root][INFO] - Step: 1400/9020  |  Loss: 0.3352  |  Score: 85.77 [%]  |  Seq Length: 256.0
[2024-09-19 16:56:39,101][root][INFO] - Step: 1400/9020  |  Loss: 0.4493  |  Score: 79.42 [%]  |  Seq Length: 256.0
[2024-09-19 16:56:57,205][root][INFO] - Step: 2000/9020  |  Loss: 0.3199  |  Score: 86.08 [%]  |  Seq Length: 256.0
[2024-09-19 16:57:23,147][root][INFO] - Step: 1500/9020  |  Loss: 0.3312  |  Score: 86.16 [%]  |  Seq Length: 256.0
[2024-09-19 16:57:23,480][root][INFO] - Step: 1500/9020  |  Loss: 0.4362  |  Score: 80.34 [%]  |  Seq Length: 256.0
[2024-09-19 16:57:33,945][root][INFO] - Step: 2100/9020  |  Loss: 0.3120  |  Score: 86.67 [%]  |  Seq Length: 256.0
[2024-09-19 16:58:07,839][root][INFO] - Step: 1600/9020  |  Loss: 0.4405  |  Score: 80.05 [%]  |  Seq Length: 256.0
[2024-09-19 16:58:10,690][root][INFO] - Step: 2200/9020  |  Loss: 0.3161  |  Score: 86.59 [%]  |  Seq Length: 256.0
[2024-09-19 16:58:12,654][root][INFO] - Step: 1600/9020  |  Loss: 0.3402  |  Score: 85.34 [%]  |  Seq Length: 256.0
[2024-09-19 16:58:47,436][root][INFO] - Step: 2300/9020  |  Loss: 0.3211  |  Score: 86.45 [%]  |  Seq Length: 256.0
[2024-09-19 16:58:52,209][root][INFO] - Step: 1700/9020  |  Loss: 0.4375  |  Score: 80.02 [%]  |  Seq Length: 256.0
[2024-09-19 16:59:02,437][root][INFO] - Step: 1700/9020  |  Loss: 0.3452  |  Score: 85.00 [%]  |  Seq Length: 256.0
[2024-09-19 16:59:24,183][root][INFO] - Step: 2400/9020  |  Loss: 0.3024  |  Score: 86.39 [%]  |  Seq Length: 256.0
[2024-09-19 16:59:36,644][root][INFO] - Step: 1800/9020  |  Loss: 0.4529  |  Score: 79.53 [%]  |  Seq Length: 256.0
[2024-09-19 16:59:38,424][root][INFO] - Step: 1804/9020  |  Loss: 0.4012  |  Score: 85.37 [%]  |  Seq Length: 256.0
[2024-09-19 16:59:51,970][root][INFO] - Step: 1800/9020  |  Loss: 0.3401  |  Score: 84.89 [%]  |  Seq Length: 256.0
[2024-09-19 16:59:53,960][root][INFO] - Step: 1804/9020  |  Loss: 0.3170  |  Score: 85.84 [%]  |  Seq Length: 256.0
[2024-09-19 17:00:00,961][root][INFO] - Step: 2500/9020  |  Loss: 0.3280  |  Score: 85.72 [%]  |  Seq Length: 256.0
[2024-09-19 17:00:07,790][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 17:00:07,790][root][INFO] - Score: 80.14 [%]  |  Evaluation Time: 29.36 [s]
[2024-09-19 17:00:37,732][root][INFO] - Step: 2600/9020  |  Loss: 0.2995  |  Score: 87.08 [%]  |  Seq Length: 256.0
[2024-09-19 17:00:38,879][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 17:00:38,879][root][INFO] - Score: 86.61 [%]  |  Evaluation Time: 44.92 [s]
[2024-09-19 17:01:14,512][root][INFO] - Step: 2700/9020  |  Loss: 0.3155  |  Score: 86.97 [%]  |  Seq Length: 256.0
[2024-09-19 17:01:44,553][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 17:01:44,553][root][INFO] - Score: 80.11 [%]  |  Evaluation Time: 96.76 [s]
[2024-09-19 17:01:44,554][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 17:01:44,555][root][INFO] - 
[2/ 5 Epoch]
[2024-09-19 17:01:51,275][root][INFO] - Step: 2800/9020  |  Loss: 0.3226  |  Score: 85.94 [%]  |  Seq Length: 256.0
[2024-09-19 17:02:27,413][root][INFO] - Step: 1900/9020  |  Loss: 0.3968  |  Score: 82.34 [%]  |  Seq Length: 256.0
[2024-09-19 17:02:28,050][root][INFO] - Step: 2900/9020  |  Loss: 0.3184  |  Score: 86.50 [%]  |  Seq Length: 256.0
[2024-09-19 17:03:04,807][root][INFO] - Step: 3000/9020  |  Loss: 0.3249  |  Score: 86.09 [%]  |  Seq Length: 256.0
[2024-09-19 17:03:08,355][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 17:03:08,355][root][INFO] - Score: 86.35 [%]  |  Evaluation Time: 149.47 [s]
[2024-09-19 17:03:08,356][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 17:03:08,358][root][INFO] - 
[2/ 5 Epoch]
[2024-09-19 17:03:11,746][root][INFO] - Step: 2000/9020  |  Loss: 0.4143  |  Score: 82.16 [%]  |  Seq Length: 256.0
[2024-09-19 17:03:41,572][root][INFO] - Step: 3100/9020  |  Loss: 0.3107  |  Score: 86.83 [%]  |  Seq Length: 256.0
[2024-09-19 17:03:55,946][root][INFO] - Step: 1900/9020  |  Loss: 0.3150  |  Score: 86.88 [%]  |  Seq Length: 256.0
[2024-09-19 17:03:56,045][root][INFO] - Step: 2100/9020  |  Loss: 0.3895  |  Score: 83.25 [%]  |  Seq Length: 256.0
[2024-09-19 17:04:18,343][root][INFO] - Step: 3200/9020  |  Loss: 0.3091  |  Score: 87.08 [%]  |  Seq Length: 256.0
[2024-09-19 17:04:39,596][root][INFO] - Step: 2200/9020  |  Loss: 0.4024  |  Score: 82.55 [%]  |  Seq Length: 256.0
[2024-09-19 17:04:45,464][root][INFO] - Step: 2000/9020  |  Loss: 0.3169  |  Score: 86.52 [%]  |  Seq Length: 256.0
[2024-09-19 17:04:55,122][root][INFO] - Step: 3300/9020  |  Loss: 0.3125  |  Score: 86.77 [%]  |  Seq Length: 256.0
[2024-09-19 17:05:23,869][root][INFO] - Step: 2300/9020  |  Loss: 0.3909  |  Score: 82.75 [%]  |  Seq Length: 256.0
[2024-09-19 17:05:31,922][root][INFO] - Step: 3400/9020  |  Loss: 0.3077  |  Score: 86.78 [%]  |  Seq Length: 256.0
[2024-09-19 17:05:35,422][root][INFO] - Step: 2100/9020  |  Loss: 0.3074  |  Score: 87.27 [%]  |  Seq Length: 256.0
[2024-09-19 17:06:08,162][root][INFO] - Step: 2400/9020  |  Loss: 0.3972  |  Score: 83.11 [%]  |  Seq Length: 256.0
[2024-09-19 17:06:08,713][root][INFO] - Step: 3500/9020  |  Loss: 0.3053  |  Score: 87.33 [%]  |  Seq Length: 256.0
[2024-09-19 17:06:24,906][root][INFO] - Step: 2200/9020  |  Loss: 0.3204  |  Score: 86.48 [%]  |  Seq Length: 256.0
[2024-09-19 17:06:45,477][root][INFO] - Step: 3600/9020  |  Loss: 0.3139  |  Score: 86.78 [%]  |  Seq Length: 256.0
[2024-09-19 17:06:48,453][root][INFO] - Step: 3608/9020  |  Loss: 0.2856  |  Score: 87.49 [%]  |  Seq Length: 256.0
[2024-09-19 17:06:52,264][root][INFO] - Step: 2500/9020  |  Loss: 0.4001  |  Score: 83.09 [%]  |  Seq Length: 256.0
[2024-09-19 17:07:14,504][root][INFO] - Step: 2300/9020  |  Loss: 0.3152  |  Score: 86.67 [%]  |  Seq Length: 256.0
[2024-09-19 17:07:17,694][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 17:07:17,695][root][INFO] - Score: 87.17 [%]  |  Evaluation Time: 29.24 [s]
[2024-09-19 17:07:35,711][root][INFO] - Step: 2600/9020  |  Loss: 0.3921  |  Score: 82.95 [%]  |  Seq Length: 256.0
[2024-09-19 17:08:04,138][root][INFO] - Step: 2400/9020  |  Loss: 0.3212  |  Score: 86.20 [%]  |  Seq Length: 256.0
[2024-09-19 17:08:19,170][root][INFO] - Step: 2700/9020  |  Loss: 0.4118  |  Score: 82.25 [%]  |  Seq Length: 256.0
[2024-09-19 17:08:53,848][root][INFO] - Step: 2500/9020  |  Loss: 0.3059  |  Score: 86.91 [%]  |  Seq Length: 256.0
[2024-09-19 17:08:54,011][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 17:08:54,011][root][INFO] - Score: 87.16 [%]  |  Evaluation Time: 96.31 [s]
[2024-09-19 17:08:54,012][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 17:08:54,014][root][INFO] - 
[3/ 5 Epoch]
[2024-09-19 17:09:02,617][root][INFO] - Step: 2800/9020  |  Loss: 0.4188  |  Score: 81.20 [%]  |  Seq Length: 256.0
[2024-09-19 17:09:28,288][root][INFO] - Step: 3700/9020  |  Loss: 0.2731  |  Score: 88.65 [%]  |  Seq Length: 256.0
[2024-09-19 17:09:42,855][root][INFO] - Step: 2600/9020  |  Loss: 0.3206  |  Score: 86.47 [%]  |  Seq Length: 256.0
[2024-09-19 17:09:46,723][root][INFO] - Step: 2900/9020  |  Loss: 0.4230  |  Score: 81.02 [%]  |  Seq Length: 256.0
[2024-09-19 17:10:05,168][root][INFO] - Step: 3800/9020  |  Loss: 0.2853  |  Score: 87.78 [%]  |  Seq Length: 256.0
[2024-09-19 17:10:30,995][root][INFO] - Step: 3000/9020  |  Loss: 0.4071  |  Score: 82.16 [%]  |  Seq Length: 256.0
[2024-09-19 17:10:32,376][root][INFO] - Step: 2700/9020  |  Loss: 0.3185  |  Score: 86.62 [%]  |  Seq Length: 256.0
[2024-09-19 17:10:42,034][root][INFO] - Step: 3900/9020  |  Loss: 0.2888  |  Score: 87.81 [%]  |  Seq Length: 256.0
[2024-09-19 17:11:14,573][root][INFO] - Step: 3100/9020  |  Loss: 0.4069  |  Score: 81.88 [%]  |  Seq Length: 256.0
[2024-09-19 17:11:18,937][root][INFO] - Step: 4000/9020  |  Loss: 0.2623  |  Score: 89.34 [%]  |  Seq Length: 256.0
[2024-09-19 17:11:21,006][root][INFO] - Step: 2800/9020  |  Loss: 0.3205  |  Score: 86.34 [%]  |  Seq Length: 256.0
[2024-09-19 17:11:55,812][root][INFO] - Step: 4100/9020  |  Loss: 0.2871  |  Score: 88.09 [%]  |  Seq Length: 256.0
[2024-09-19 17:11:58,039][root][INFO] - Step: 3200/9020  |  Loss: 0.4062  |  Score: 81.98 [%]  |  Seq Length: 256.0
[2024-09-19 17:12:10,392][root][INFO] - Step: 2900/9020  |  Loss: 0.3095  |  Score: 86.92 [%]  |  Seq Length: 256.0
[2024-09-19 17:12:32,667][root][INFO] - Step: 4200/9020  |  Loss: 0.2749  |  Score: 88.55 [%]  |  Seq Length: 256.0
[2024-09-19 17:12:41,514][root][INFO] - Step: 3300/9020  |  Loss: 0.4193  |  Score: 80.95 [%]  |  Seq Length: 256.0
[2024-09-19 17:13:00,100][root][INFO] - Step: 3000/9020  |  Loss: 0.3301  |  Score: 85.80 [%]  |  Seq Length: 256.0
[2024-09-19 17:13:09,528][root][INFO] - Step: 4300/9020  |  Loss: 0.2734  |  Score: 88.28 [%]  |  Seq Length: 256.0
[2024-09-19 17:13:25,831][root][INFO] - Step: 3400/9020  |  Loss: 0.4189  |  Score: 81.66 [%]  |  Seq Length: 256.0
[2024-09-19 17:13:46,400][root][INFO] - Step: 4400/9020  |  Loss: 0.2813  |  Score: 88.20 [%]  |  Seq Length: 256.0
[2024-09-19 17:13:49,575][root][INFO] - Step: 3100/9020  |  Loss: 0.3074  |  Score: 86.94 [%]  |  Seq Length: 256.0
[2024-09-19 17:14:10,118][root][INFO] - Step: 3500/9020  |  Loss: 0.4265  |  Score: 81.05 [%]  |  Seq Length: 256.0
[2024-09-19 17:14:23,298][root][INFO] - Step: 4500/9020  |  Loss: 0.2755  |  Score: 88.41 [%]  |  Seq Length: 256.0
[2024-09-19 17:14:39,383][root][INFO] - Step: 3200/9020  |  Loss: 0.3026  |  Score: 87.28 [%]  |  Seq Length: 256.0
[2024-09-19 17:14:54,458][root][INFO] - Step: 3600/9020  |  Loss: 0.4295  |  Score: 81.00 [%]  |  Seq Length: 256.0
[2024-09-19 17:14:58,003][root][INFO] - Step: 3608/9020  |  Loss: 0.4211  |  Score: 80.38 [%]  |  Seq Length: 256.0
[2024-09-19 17:15:00,162][root][INFO] - Step: 4600/9020  |  Loss: 0.2759  |  Score: 88.16 [%]  |  Seq Length: 256.0
[2024-09-19 17:15:27,358][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 17:15:27,359][root][INFO] - Score: 79.61 [%]  |  Evaluation Time: 29.35 [s]
[2024-09-19 17:15:28,925][root][INFO] - Step: 3300/9020  |  Loss: 0.3022  |  Score: 87.11 [%]  |  Seq Length: 256.0
[2024-09-19 17:15:37,123][root][INFO] - Step: 4700/9020  |  Loss: 0.2674  |  Score: 88.50 [%]  |  Seq Length: 256.0
[2024-09-19 17:16:14,031][root][INFO] - Step: 4800/9020  |  Loss: 0.2799  |  Score: 88.34 [%]  |  Seq Length: 256.0
[2024-09-19 17:16:18,473][root][INFO] - Step: 3400/9020  |  Loss: 0.3160  |  Score: 86.84 [%]  |  Seq Length: 256.0
[2024-09-19 17:16:51,035][root][INFO] - Step: 4900/9020  |  Loss: 0.2853  |  Score: 87.73 [%]  |  Seq Length: 256.0
[2024-09-19 17:17:04,157][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 17:17:04,158][root][INFO] - Score: 79.61 [%]  |  Evaluation Time: 96.80 [s]
[2024-09-19 17:17:04,160][root][INFO] - 
[3/ 5 Epoch]
[2024-09-19 17:17:08,288][root][INFO] - Step: 3500/9020  |  Loss: 0.3046  |  Score: 87.41 [%]  |  Seq Length: 256.0
[2024-09-19 17:17:28,062][root][INFO] - Step: 5000/9020  |  Loss: 0.2760  |  Score: 88.47 [%]  |  Seq Length: 256.0
[2024-09-19 17:17:45,301][root][INFO] - Step: 3700/9020  |  Loss: 0.4132  |  Score: 81.88 [%]  |  Seq Length: 256.0
[2024-09-19 17:17:58,122][root][INFO] - Step: 3600/9020  |  Loss: 0.2979  |  Score: 87.39 [%]  |  Seq Length: 256.0
[2024-09-19 17:18:02,108][root][INFO] - Step: 3608/9020  |  Loss: 0.2787  |  Score: 89.06 [%]  |  Seq Length: 256.0
[2024-09-19 17:18:05,083][root][INFO] - Step: 5100/9020  |  Loss: 0.2946  |  Score: 87.23 [%]  |  Seq Length: 256.0
[2024-09-19 17:18:29,627][root][INFO] - Step: 3800/9020  |  Loss: 0.4103  |  Score: 82.11 [%]  |  Seq Length: 256.0
[2024-09-19 17:18:41,954][root][INFO] - Step: 5200/9020  |  Loss: 0.2747  |  Score: 88.38 [%]  |  Seq Length: 256.0
[2024-09-19 17:18:47,117][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 17:18:47,118][root][INFO] - Score: 86.64 [%]  |  Evaluation Time: 45.01 [s]
[2024-09-19 17:19:13,938][root][INFO] - Step: 3900/9020  |  Loss: 0.4039  |  Score: 82.58 [%]  |  Seq Length: 256.0
[2024-09-19 17:19:18,832][root][INFO] - Step: 5300/9020  |  Loss: 0.2643  |  Score: 88.91 [%]  |  Seq Length: 256.0
[2024-09-19 17:19:55,713][root][INFO] - Step: 5400/9020  |  Loss: 0.2665  |  Score: 89.09 [%]  |  Seq Length: 256.0
[2024-09-19 17:19:58,199][root][INFO] - Step: 4000/9020  |  Loss: 0.4097  |  Score: 81.75 [%]  |  Seq Length: 256.0
[2024-09-19 17:20:00,167][root][INFO] - Step: 5412/9020  |  Loss: 0.2256  |  Score: 90.72 [%]  |  Seq Length: 256.0
[2024-09-19 17:20:29,341][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 17:20:29,341][root][INFO] - Score: 87.96 [%]  |  Evaluation Time: 29.17 [s]
[2024-09-19 17:20:42,487][root][INFO] - Step: 4100/9020  |  Loss: 0.3943  |  Score: 83.00 [%]  |  Seq Length: 256.0
[2024-09-19 17:21:15,508][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 17:21:15,508][root][INFO] - Score: 86.87 [%]  |  Evaluation Time: 148.39 [s]
[2024-09-19 17:21:15,510][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 17:21:15,511][root][INFO] - 
[3/ 5 Epoch]
[2024-09-19 17:21:26,755][root][INFO] - Step: 4200/9020  |  Loss: 0.4064  |  Score: 81.67 [%]  |  Seq Length: 256.0
[2024-09-19 17:22:01,562][root][INFO] - Step: 3700/9020  |  Loss: 0.2825  |  Score: 88.01 [%]  |  Seq Length: 256.0
[2024-09-19 17:22:05,540][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 17:22:05,540][root][INFO] - Score: 87.89 [%]  |  Evaluation Time: 96.20 [s]
[2024-09-19 17:22:05,541][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-19 17:22:05,543][root][INFO] - 
[4/ 5 Epoch]
[2024-09-19 17:22:11,076][root][INFO] - Step: 4300/9020  |  Loss: 0.4158  |  Score: 81.38 [%]  |  Seq Length: 256.0
[2024-09-19 17:22:38,409][root][INFO] - Step: 5500/9020  |  Loss: 0.2320  |  Score: 90.71 [%]  |  Seq Length: 256.0
[2024-09-19 17:22:51,289][root][INFO] - Step: 3800/9020  |  Loss: 0.2903  |  Score: 87.30 [%]  |  Seq Length: 256.0
[2024-09-19 17:22:55,390][root][INFO] - Step: 4400/9020  |  Loss: 0.4023  |  Score: 82.38 [%]  |  Seq Length: 256.0
[2024-09-19 17:23:15,301][root][INFO] - Step: 5600/9020  |  Loss: 0.2472  |  Score: 89.91 [%]  |  Seq Length: 256.0
[2024-09-19 17:23:39,705][root][INFO] - Step: 4500/9020  |  Loss: 0.4176  |  Score: 81.77 [%]  |  Seq Length: 256.0
[2024-09-19 17:23:41,075][root][INFO] - Step: 3900/9020  |  Loss: 0.2848  |  Score: 87.91 [%]  |  Seq Length: 256.0
[2024-09-19 17:23:52,184][root][INFO] - Step: 5700/9020  |  Loss: 0.2287  |  Score: 90.53 [%]  |  Seq Length: 256.0
[2024-09-19 17:24:24,031][root][INFO] - Step: 4600/9020  |  Loss: 0.4267  |  Score: 80.67 [%]  |  Seq Length: 256.0
[2024-09-19 17:24:29,093][root][INFO] - Step: 5800/9020  |  Loss: 0.2424  |  Score: 90.12 [%]  |  Seq Length: 256.0
[2024-09-19 17:24:30,725][root][INFO] - Step: 4000/9020  |  Loss: 0.2703  |  Score: 89.28 [%]  |  Seq Length: 256.0
[2024-09-19 17:25:06,293][root][INFO] - Step: 5900/9020  |  Loss: 0.2239  |  Score: 90.56 [%]  |  Seq Length: 256.0
[2024-09-19 17:25:08,339][root][INFO] - Step: 4700/9020  |  Loss: 0.4293  |  Score: 80.77 [%]  |  Seq Length: 256.0
[2024-09-19 17:25:20,360][root][INFO] - Step: 4100/9020  |  Loss: 0.2851  |  Score: 88.05 [%]  |  Seq Length: 256.0
[2024-09-19 17:25:43,196][root][INFO] - Step: 6000/9020  |  Loss: 0.2317  |  Score: 90.64 [%]  |  Seq Length: 256.0
[2024-09-19 17:25:52,638][root][INFO] - Step: 4800/9020  |  Loss: 0.4278  |  Score: 81.05 [%]  |  Seq Length: 256.0
[2024-09-19 17:26:10,026][root][INFO] - Step: 4200/9020  |  Loss: 0.2806  |  Score: 88.31 [%]  |  Seq Length: 256.0
[2024-09-19 17:26:20,099][root][INFO] - Step: 6100/9020  |  Loss: 0.2369  |  Score: 90.28 [%]  |  Seq Length: 256.0
[2024-09-19 17:26:36,950][root][INFO] - Step: 4900/9020  |  Loss: 0.4241  |  Score: 81.41 [%]  |  Seq Length: 256.0
[2024-09-19 17:26:57,004][root][INFO] - Step: 6200/9020  |  Loss: 0.2328  |  Score: 90.42 [%]  |  Seq Length: 256.0
[2024-09-19 17:26:59,571][root][INFO] - Step: 4300/9020  |  Loss: 0.2806  |  Score: 88.23 [%]  |  Seq Length: 256.0
[2024-09-19 17:27:21,277][root][INFO] - Step: 5000/9020  |  Loss: 0.4304  |  Score: 80.69 [%]  |  Seq Length: 256.0
[2024-09-19 17:27:34,078][root][INFO] - Step: 6300/9020  |  Loss: 0.2322  |  Score: 90.69 [%]  |  Seq Length: 256.0
[2024-09-19 17:27:49,461][root][INFO] - Step: 4400/9020  |  Loss: 0.2841  |  Score: 87.56 [%]  |  Seq Length: 256.0
[2024-09-19 17:28:05,586][root][INFO] - Step: 5100/9020  |  Loss: 0.4262  |  Score: 80.83 [%]  |  Seq Length: 256.0
[2024-09-19 17:28:10,983][root][INFO] - Step: 6400/9020  |  Loss: 0.2319  |  Score: 90.47 [%]  |  Seq Length: 256.0
[2024-09-19 17:28:39,337][root][INFO] - Step: 4500/9020  |  Loss: 0.2807  |  Score: 88.25 [%]  |  Seq Length: 256.0
[2024-09-19 17:28:48,014][root][INFO] - Step: 6500/9020  |  Loss: 0.2399  |  Score: 90.39 [%]  |  Seq Length: 256.0
[2024-09-19 17:28:49,333][root][INFO] - Step: 5200/9020  |  Loss: 0.4329  |  Score: 80.94 [%]  |  Seq Length: 256.0
[2024-09-19 17:29:24,922][root][INFO] - Step: 6600/9020  |  Loss: 0.2174  |  Score: 90.59 [%]  |  Seq Length: 256.0
[2024-09-19 17:29:28,666][root][INFO] - Step: 4600/9020  |  Loss: 0.2704  |  Score: 88.47 [%]  |  Seq Length: 256.0
[2024-09-19 17:29:32,796][root][INFO] - Step: 5300/9020  |  Loss: 0.4305  |  Score: 80.69 [%]  |  Seq Length: 256.0
[2024-09-19 17:30:01,909][root][INFO] - Step: 6700/9020  |  Loss: 0.2158  |  Score: 91.70 [%]  |  Seq Length: 256.0
[2024-09-19 17:30:16,251][root][INFO] - Step: 5400/9020  |  Loss: 0.4398  |  Score: 80.38 [%]  |  Seq Length: 256.0
[2024-09-19 17:30:18,399][root][INFO] - Step: 4700/9020  |  Loss: 0.2783  |  Score: 88.23 [%]  |  Seq Length: 256.0
[2024-09-19 17:30:21,500][root][INFO] - Step: 5412/9020  |  Loss: 0.4498  |  Score: 78.79 [%]  |  Seq Length: 256.0
[2024-09-19 17:30:38,807][root][INFO] - Step: 6800/9020  |  Loss: 0.2275  |  Score: 91.09 [%]  |  Seq Length: 256.0
[2024-09-19 17:30:50,944][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 17:30:50,945][root][INFO] - Score: 78.66 [%]  |  Evaluation Time: 29.44 [s]
[2024-09-19 17:31:08,164][root][INFO] - Step: 4800/9020  |  Loss: 0.2729  |  Score: 88.84 [%]  |  Seq Length: 256.0
[2024-09-19 17:31:15,693][root][INFO] - Step: 6900/9020  |  Loss: 0.2406  |  Score: 90.02 [%]  |  Seq Length: 256.0
[2024-09-19 17:31:52,592][root][INFO] - Step: 7000/9020  |  Loss: 0.2169  |  Score: 91.22 [%]  |  Seq Length: 256.0
[2024-09-19 17:31:57,732][root][INFO] - Step: 4900/9020  |  Loss: 0.2847  |  Score: 88.36 [%]  |  Seq Length: 256.0
[2024-09-19 17:32:27,989][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 17:32:27,990][root][INFO] - Score: 78.20 [%]  |  Evaluation Time: 97.04 [s]
[2024-09-19 17:32:27,992][root][INFO] - 
[4/ 5 Epoch]
[2024-09-19 17:32:29,481][root][INFO] - Step: 7100/9020  |  Loss: 0.2257  |  Score: 91.06 [%]  |  Seq Length: 256.0
[2024-09-19 17:32:47,490][root][INFO] - Step: 5000/9020  |  Loss: 0.2665  |  Score: 89.00 [%]  |  Seq Length: 256.0
[2024-09-19 17:33:06,363][root][INFO] - Step: 7200/9020  |  Loss: 0.2257  |  Score: 90.78 [%]  |  Seq Length: 256.0
[2024-09-19 17:33:07,347][root][INFO] - Step: 5500/9020  |  Loss: 0.4168  |  Score: 81.92 [%]  |  Seq Length: 256.0
[2024-09-19 17:33:12,288][root][INFO] - Step: 7216/9020  |  Loss: 0.2287  |  Score: 92.09 [%]  |  Seq Length: 256.0
[2024-09-19 17:33:37,048][root][INFO] - Step: 5100/9020  |  Loss: 0.2659  |  Score: 88.73 [%]  |  Seq Length: 256.0
[2024-09-19 17:33:41,525][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 17:33:41,526][root][INFO] - Score: 88.61 [%]  |  Evaluation Time: 29.23 [s]
[2024-09-19 17:33:51,697][root][INFO] - Step: 5600/9020  |  Loss: 0.4135  |  Score: 81.97 [%]  |  Seq Length: 256.0
[2024-09-19 17:34:26,631][root][INFO] - Step: 5200/9020  |  Loss: 0.2758  |  Score: 88.06 [%]  |  Seq Length: 256.0
[2024-09-19 17:34:36,022][root][INFO] - Step: 5700/9020  |  Loss: 0.4209  |  Score: 81.58 [%]  |  Seq Length: 256.0
[2024-09-19 17:35:16,183][root][INFO] - Step: 5300/9020  |  Loss: 0.2761  |  Score: 88.45 [%]  |  Seq Length: 256.0
[2024-09-19 17:35:17,726][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 17:35:17,726][root][INFO] - Score: 88.66 [%]  |  Evaluation Time: 96.20 [s]
[2024-09-19 17:35:17,727][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-19 17:35:17,728][root][INFO] - 
[5/ 5 Epoch]
[2024-09-19 17:35:20,418][root][INFO] - Step: 5800/9020  |  Loss: 0.4320  |  Score: 80.92 [%]  |  Seq Length: 256.0
[2024-09-19 17:35:49,094][root][INFO] - Step: 7300/9020  |  Loss: 0.2032  |  Score: 92.04 [%]  |  Seq Length: 256.0
[2024-09-19 17:36:04,767][root][INFO] - Step: 5900/9020  |  Loss: 0.4225  |  Score: 81.34 [%]  |  Seq Length: 256.0
[2024-09-19 17:36:05,834][root][INFO] - Step: 5400/9020  |  Loss: 0.2704  |  Score: 88.59 [%]  |  Seq Length: 256.0
[2024-09-19 17:36:11,791][root][INFO] - Step: 5412/9020  |  Loss: 0.2529  |  Score: 89.19 [%]  |  Seq Length: 256.0
[2024-09-19 17:36:26,022][root][INFO] - Step: 7400/9020  |  Loss: 0.1913  |  Score: 92.55 [%]  |  Seq Length: 256.0
[2024-09-19 17:36:49,154][root][INFO] - Step: 6000/9020  |  Loss: 0.4284  |  Score: 81.31 [%]  |  Seq Length: 256.0
[2024-09-19 17:36:56,812][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 17:36:56,813][root][INFO] - Score: 87.84 [%]  |  Evaluation Time: 45.02 [s]
[2024-09-19 17:37:02,917][root][INFO] - Step: 7500/9020  |  Loss: 0.2034  |  Score: 91.80 [%]  |  Seq Length: 256.0
[2024-09-19 17:37:33,524][root][INFO] - Step: 6100/9020  |  Loss: 0.4280  |  Score: 80.89 [%]  |  Seq Length: 256.0
[2024-09-19 17:37:39,808][root][INFO] - Step: 7600/9020  |  Loss: 0.1806  |  Score: 92.95 [%]  |  Seq Length: 256.0
[2024-09-19 17:38:16,738][root][INFO] - Step: 7700/9020  |  Loss: 0.1940  |  Score: 92.25 [%]  |  Seq Length: 256.0
[2024-09-19 17:38:17,796][root][INFO] - Step: 6200/9020  |  Loss: 0.4238  |  Score: 81.20 [%]  |  Seq Length: 256.0
[2024-09-19 17:38:53,669][root][INFO] - Step: 7800/9020  |  Loss: 0.1970  |  Score: 92.17 [%]  |  Seq Length: 256.0
[2024-09-19 17:39:02,011][root][INFO] - Step: 6300/9020  |  Loss: 0.4302  |  Score: 81.42 [%]  |  Seq Length: 256.0
[2024-09-19 17:39:25,333][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 17:39:25,333][root][INFO] - Score: 88.07 [%]  |  Evaluation Time: 148.52 [s]
[2024-09-19 17:39:25,334][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-19 17:39:25,336][root][INFO] - 
[4/ 5 Epoch]
[2024-09-19 17:39:30,574][root][INFO] - Step: 7900/9020  |  Loss: 0.1954  |  Score: 92.50 [%]  |  Seq Length: 256.0
[2024-09-19 17:39:46,376][root][INFO] - Step: 6400/9020  |  Loss: 0.4238  |  Score: 81.95 [%]  |  Seq Length: 256.0
[2024-09-19 17:40:07,484][root][INFO] - Step: 8000/9020  |  Loss: 0.1864  |  Score: 92.69 [%]  |  Seq Length: 256.0
[2024-09-19 17:40:09,572][root][INFO] - Step: 5500/9020  |  Loss: 0.2334  |  Score: 90.66 [%]  |  Seq Length: 256.0
[2024-09-19 17:40:30,731][root][INFO] - Step: 6500/9020  |  Loss: 0.4277  |  Score: 80.95 [%]  |  Seq Length: 256.0
[2024-09-19 17:40:44,402][root][INFO] - Step: 8100/9020  |  Loss: 0.1881  |  Score: 92.59 [%]  |  Seq Length: 256.0
[2024-09-19 17:40:59,272][root][INFO] - Step: 5600/9020  |  Loss: 0.2303  |  Score: 90.34 [%]  |  Seq Length: 256.0
[2024-09-19 17:41:15,597][root][INFO] - Step: 6600/9020  |  Loss: 0.4263  |  Score: 81.59 [%]  |  Seq Length: 256.0
[2024-09-19 17:41:21,561][root][INFO] - Step: 8200/9020  |  Loss: 0.1799  |  Score: 92.84 [%]  |  Seq Length: 256.0
[2024-09-19 17:41:48,835][root][INFO] - Step: 5700/9020  |  Loss: 0.2319  |  Score: 90.73 [%]  |  Seq Length: 256.0
[2024-09-19 17:41:58,669][root][INFO] - Step: 8300/9020  |  Loss: 0.2008  |  Score: 92.25 [%]  |  Seq Length: 256.0
[2024-09-19 17:42:00,021][root][INFO] - Step: 6700/9020  |  Loss: 0.4273  |  Score: 81.28 [%]  |  Seq Length: 256.0
[2024-09-19 17:42:35,544][root][INFO] - Step: 8400/9020  |  Loss: 0.1897  |  Score: 92.23 [%]  |  Seq Length: 256.0
[2024-09-19 17:42:38,756][root][INFO] - Step: 5800/9020  |  Loss: 0.2273  |  Score: 90.92 [%]  |  Seq Length: 256.0
[2024-09-19 17:42:44,531][root][INFO] - Step: 6800/9020  |  Loss: 0.4146  |  Score: 81.83 [%]  |  Seq Length: 256.0
[2024-09-19 17:43:12,442][root][INFO] - Step: 8500/9020  |  Loss: 0.1951  |  Score: 92.25 [%]  |  Seq Length: 256.0
[2024-09-19 17:43:27,914][root][INFO] - Step: 5900/9020  |  Loss: 0.2319  |  Score: 90.48 [%]  |  Seq Length: 256.0
[2024-09-19 17:43:28,855][root][INFO] - Step: 6900/9020  |  Loss: 0.4348  |  Score: 80.11 [%]  |  Seq Length: 256.0
[2024-09-19 17:43:49,345][root][INFO] - Step: 8600/9020  |  Loss: 0.1799  |  Score: 93.00 [%]  |  Seq Length: 256.0
[2024-09-19 17:44:13,082][root][INFO] - Step: 7000/9020  |  Loss: 0.4250  |  Score: 81.58 [%]  |  Seq Length: 256.0
[2024-09-19 17:44:17,689][root][INFO] - Step: 6000/9020  |  Loss: 0.2347  |  Score: 90.30 [%]  |  Seq Length: 256.0
[2024-09-19 17:44:26,261][root][INFO] - Step: 8700/9020  |  Loss: 0.1926  |  Score: 92.36 [%]  |  Seq Length: 256.0
[2024-09-19 17:44:56,642][root][INFO] - Step: 7100/9020  |  Loss: 0.4266  |  Score: 81.09 [%]  |  Seq Length: 256.0
[2024-09-19 17:45:03,184][root][INFO] - Step: 8800/9020  |  Loss: 0.1820  |  Score: 92.83 [%]  |  Seq Length: 256.0
[2024-09-19 17:45:07,571][root][INFO] - Step: 6100/9020  |  Loss: 0.2298  |  Score: 90.97 [%]  |  Seq Length: 256.0
[2024-09-19 17:45:40,107][root][INFO] - Step: 8900/9020  |  Loss: 0.1861  |  Score: 92.23 [%]  |  Seq Length: 256.0
[2024-09-19 17:45:40,144][root][INFO] - Step: 7200/9020  |  Loss: 0.4314  |  Score: 81.22 [%]  |  Seq Length: 256.0
[2024-09-19 17:45:47,132][root][INFO] - Step: 7216/9020  |  Loss: 0.4041  |  Score: 83.51 [%]  |  Seq Length: 256.0
[2024-09-19 17:45:57,309][root][INFO] - Step: 6200/9020  |  Loss: 0.2392  |  Score: 90.28 [%]  |  Seq Length: 256.0
[2024-09-19 17:46:16,570][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 17:46:16,570][root][INFO] - Score: 78.56 [%]  |  Evaluation Time: 29.44 [s]
[2024-09-19 17:46:17,019][root][INFO] - Step: 9000/9020  |  Loss: 0.1870  |  Score: 92.53 [%]  |  Seq Length: 256.0
[2024-09-19 17:46:24,411][root][INFO] - Step: 9020/9020  |  Loss: 0.1702  |  Score: 93.39 [%]  |  Seq Length: 256.0
[2024-09-19 17:46:46,477][root][INFO] - Step: 6300/9020  |  Loss: 0.2422  |  Score: 90.11 [%]  |  Seq Length: 256.0
[2024-09-19 17:46:53,613][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 17:46:53,614][root][INFO] - Score: 88.78 [%]  |  Evaluation Time: 29.20 [s]
[2024-09-19 17:47:35,734][root][INFO] - Step: 6400/9020  |  Loss: 0.2281  |  Score: 90.50 [%]  |  Seq Length: 256.0
[2024-09-19 17:47:53,518][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 17:47:53,519][root][INFO] - Score: 78.46 [%]  |  Evaluation Time: 96.95 [s]
[2024-09-19 17:47:53,521][root][INFO] - 
[5/ 5 Epoch]
[2024-09-19 17:48:24,522][root][INFO] - Step: 6500/9020  |  Loss: 0.2274  |  Score: 90.41 [%]  |  Seq Length: 256.0
[2024-09-19 17:48:29,970][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 17:48:29,970][root][INFO] - Score: 88.66 [%]  |  Evaluation Time: 96.35 [s]
[2024-09-19 17:48:29,971][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-19 17:48:29,971][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 17:48:29,971][root][INFO] - - Epoch: 5
[2024-09-19 17:48:29,971][root][INFO] - - DEV score: 88.78 [%]
[2024-09-19 17:48:29,971][root][INFO] - - TEST score: 88.66 [%]
[2024-09-19 17:48:29,972][root][INFO] - Fine-tuning is done!
[2024-09-19 17:48:31,161][root][INFO] - Step: 7300/9020  |  Loss: 0.4341  |  Score: 80.51 [%]  |  Seq Length: 256.0
[2024-09-19 17:49:14,388][root][INFO] - Step: 6600/9020  |  Loss: 0.2379  |  Score: 90.20 [%]  |  Seq Length: 256.0
[2024-09-19 17:49:15,513][root][INFO] - Step: 7400/9020  |  Loss: 0.4277  |  Score: 81.06 [%]  |  Seq Length: 256.0
[2024-09-19 17:49:59,818][root][INFO] - Step: 7500/9020  |  Loss: 0.4260  |  Score: 81.30 [%]  |  Seq Length: 256.0
[2024-09-19 17:50:03,046][root][INFO] - Step: 6700/9020  |  Loss: 0.2325  |  Score: 90.56 [%]  |  Seq Length: 256.0
[2024-09-19 17:50:44,049][root][INFO] - Step: 7600/9020  |  Loss: 0.4235  |  Score: 81.39 [%]  |  Seq Length: 256.0
[2024-09-19 17:50:52,682][root][INFO] - Step: 6800/9020  |  Loss: 0.2264  |  Score: 90.86 [%]  |  Seq Length: 256.0
[2024-09-19 17:51:28,294][root][INFO] - Step: 7700/9020  |  Loss: 0.3996  |  Score: 82.56 [%]  |  Seq Length: 256.0
[2024-09-19 17:51:42,513][root][INFO] - Step: 6900/9020  |  Loss: 0.2324  |  Score: 90.52 [%]  |  Seq Length: 256.0
[2024-09-19 17:52:12,629][root][INFO] - Step: 7800/9020  |  Loss: 0.4031  |  Score: 82.48 [%]  |  Seq Length: 256.0
[2024-09-19 17:52:32,244][root][INFO] - Step: 7000/9020  |  Loss: 0.2228  |  Score: 91.11 [%]  |  Seq Length: 256.0
[2024-09-19 17:52:56,937][root][INFO] - Step: 7900/9020  |  Loss: 0.4198  |  Score: 80.89 [%]  |  Seq Length: 256.0
[2024-09-19 17:53:21,990][root][INFO] - Step: 7100/9020  |  Loss: 0.2162  |  Score: 91.25 [%]  |  Seq Length: 256.0
[2024-09-19 17:53:41,238][root][INFO] - Step: 8000/9020  |  Loss: 0.4082  |  Score: 82.52 [%]  |  Seq Length: 256.0
[2024-09-19 17:54:11,656][root][INFO] - Step: 7200/9020  |  Loss: 0.2240  |  Score: 91.00 [%]  |  Seq Length: 256.0
[2024-09-19 17:54:19,716][root][INFO] - Step: 7216/9020  |  Loss: 0.2331  |  Score: 90.48 [%]  |  Seq Length: 256.0
[2024-09-19 17:54:25,488][root][INFO] - Step: 8100/9020  |  Loss: 0.4094  |  Score: 81.84 [%]  |  Seq Length: 256.0
[2024-09-19 17:55:04,971][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 17:55:04,971][root][INFO] - Score: 88.58 [%]  |  Evaluation Time: 45.25 [s]
[2024-09-19 17:55:09,794][root][INFO] - Step: 8200/9020  |  Loss: 0.4072  |  Score: 82.47 [%]  |  Seq Length: 256.0
[2024-09-19 17:55:54,184][root][INFO] - Step: 8300/9020  |  Loss: 0.4112  |  Score: 82.06 [%]  |  Seq Length: 256.0
[2024-09-19 17:56:38,653][root][INFO] - Step: 8400/9020  |  Loss: 0.4115  |  Score: 81.83 [%]  |  Seq Length: 256.0
[2024-09-19 17:57:23,073][root][INFO] - Step: 8500/9020  |  Loss: 0.4061  |  Score: 81.94 [%]  |  Seq Length: 256.0
[2024-09-19 17:57:33,782][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 17:57:33,782][root][INFO] - Score: 88.49 [%]  |  Evaluation Time: 148.81 [s]
[2024-09-19 17:57:33,783][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-19 17:57:33,785][root][INFO] - 
[5/ 5 Epoch]
[2024-09-19 17:58:07,490][root][INFO] - Step: 8600/9020  |  Loss: 0.4041  |  Score: 82.19 [%]  |  Seq Length: 256.0
[2024-09-19 17:58:16,005][root][INFO] - Step: 7300/9020  |  Loss: 0.1865  |  Score: 92.28 [%]  |  Seq Length: 256.0
[2024-09-19 17:58:51,945][root][INFO] - Step: 8700/9020  |  Loss: 0.4049  |  Score: 82.64 [%]  |  Seq Length: 256.0
[2024-09-19 17:59:05,855][root][INFO] - Step: 7400/9020  |  Loss: 0.1918  |  Score: 92.11 [%]  |  Seq Length: 256.0
[2024-09-19 17:59:36,363][root][INFO] - Step: 8800/9020  |  Loss: 0.4287  |  Score: 80.94 [%]  |  Seq Length: 256.0
[2024-09-19 17:59:55,640][root][INFO] - Step: 7500/9020  |  Loss: 0.1841  |  Score: 92.84 [%]  |  Seq Length: 256.0
[2024-09-19 18:00:20,724][root][INFO] - Step: 8900/9020  |  Loss: 0.4182  |  Score: 81.83 [%]  |  Seq Length: 256.0
[2024-09-19 18:00:45,270][root][INFO] - Step: 7600/9020  |  Loss: 0.1878  |  Score: 92.55 [%]  |  Seq Length: 256.0
[2024-09-19 18:01:05,011][root][INFO] - Step: 9000/9020  |  Loss: 0.4247  |  Score: 81.02 [%]  |  Seq Length: 256.0
[2024-09-19 18:01:13,718][root][INFO] - Step: 9020/9020  |  Loss: 0.4172  |  Score: 82.54 [%]  |  Seq Length: 256.0
[2024-09-19 18:01:34,789][root][INFO] - Step: 7700/9020  |  Loss: 0.1935  |  Score: 92.28 [%]  |  Seq Length: 256.0
[2024-09-19 18:01:43,168][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 18:01:43,168][root][INFO] - Score: 78.67 [%]  |  Evaluation Time: 29.45 [s]
[2024-09-19 18:02:24,372][root][INFO] - Step: 7800/9020  |  Loss: 0.1962  |  Score: 92.12 [%]  |  Seq Length: 256.0
[2024-09-19 18:03:14,370][root][INFO] - Step: 7900/9020  |  Loss: 0.1813  |  Score: 92.81 [%]  |  Seq Length: 256.0
[2024-09-19 18:03:20,166][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 18:03:20,167][root][INFO] - Score: 78.62 [%]  |  Evaluation Time: 97.00 [s]
[2024-09-19 18:03:20,168][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 18:03:20,168][root][INFO] - - Epoch: 1
[2024-09-19 18:03:20,168][root][INFO] - - DEV score: 80.14 [%]
[2024-09-19 18:03:20,168][root][INFO] - - TEST score: 80.11 [%]
[2024-09-19 18:03:20,169][root][INFO] - Fine-tuning is done!
[2024-09-19 18:03:25,129][root][INFO] - 

[2024-09-19 18:03:25,129][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 18:03:25,129][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.02lr_42rs
[2024-09-19 18:03:25,129][root][INFO] - 

[2024-09-19 18:03:25,130][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 18:04:02,832][root][INFO] - Step: 8000/9020  |  Loss: 0.1991  |  Score: 91.94 [%]  |  Seq Length: 256.0
[2024-09-19 18:04:44,797][root][INFO] - 

[2024-09-19 18:04:44,797][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 18:04:44,797][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.0001lr_42rs
[2024-09-19 18:04:44,797][root][INFO] - 

[2024-09-19 18:04:44,797][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.0001, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.0001lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.0001lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.0001lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 18:04:51,328][root][INFO] - Step: 8100/9020  |  Loss: 0.1781  |  Score: 92.78 [%]  |  Seq Length: 256.0
[2024-09-19 18:05:05,004][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 18:05:09,043][root][INFO] - 

[2024-09-19 18:05:09,044][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-19 18:05:09,044][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 18:05:09,053][root][INFO] - vocab size              : 51200
[2024-09-19 18:05:09,053][root][INFO] - device                  : gpu
[2024-09-19 18:05:09,053][root][INFO] - random seed             : 42
[2024-09-19 18:05:09,054][root][INFO] - train data size         : 115456
[2024-09-19 18:05:09,054][root][INFO] - max epochs              : 5
[2024-09-19 18:05:09,054][root][INFO] - total steps             : 9020
[2024-09-19 18:05:09,054][root][INFO] - warmup steps            : 902
[2024-09-19 18:05:09,054][root][INFO] - batch size              : 64
[2024-09-19 18:05:09,054][root][INFO] - accumulation steps      : 1
[2024-09-19 18:05:09,054][root][INFO] - optimizer               : adamwscale
[2024-09-19 18:05:09,054][root][INFO] - lr_scheduler            : cosine
[2024-09-19 18:05:09,054][root][INFO] - learning rate           : 0.0001
[2024-09-19 18:05:09,054][root][INFO] - max length              : 256

[2024-09-19 18:05:09,054][root][INFO] - 

[2024-09-19 18:05:09,055][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.0001lr_42rs
[2024-09-19 18:05:09,055][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.0001lr_42rs/ckpt
[2024-09-19 18:05:09,055][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.0001lr_42rs/tb
[2024-09-19 18:05:09,055][root][INFO] - * tb interval           : 100

[2024-09-19 18:05:09,055][root][INFO] - 

[2024-09-19 18:05:09,055][root][INFO] - Start the Training !
[2024-09-19 18:05:09,058][root][INFO] - 
[1/ 5 Epoch]
[2024-09-19 18:05:17,369][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-19 18:05:17,370][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-19 18:05:17,370][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-19 18:05:17,371][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-19 18:05:17,372][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-19 18:05:17,372][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-19 18:05:17,373][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-19 18:05:17,373][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-19 18:05:17,374][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-19 18:05:17,374][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-19 18:05:17,375][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-19 18:05:17,375][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-19 18:05:17,376][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-19 18:05:17,376][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-19 18:05:17,377][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-19 18:05:17,378][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-19 18:05:17,378][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-19 18:05:17,379][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-19 18:05:17,379][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-19 18:05:17,380][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-19 18:05:17,381][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-19 18:05:17,381][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-19 18:05:17,382][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-19 18:05:17,382][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-19 18:05:17,385][root][INFO] - Trainable params: 1769472 || all params: 126935808 || trainable: 1.39 %
[2024-09-19 18:05:17,613][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 18:05:23,659][root][INFO] - 

[2024-09-19 18:05:23,659][root][INFO] - ========== Fine-tuning on KorNLI ==========
[2024-09-19 18:05:23,659][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 18:05:23,673][root][INFO] - vocab size              : 51200
[2024-09-19 18:05:23,673][root][INFO] - device                  : gpu
[2024-09-19 18:05:23,674][root][INFO] - random seed             : 42
[2024-09-19 18:05:23,674][root][INFO] - train data size         : 845504
[2024-09-19 18:05:23,674][root][INFO] - max epochs              : 3
[2024-09-19 18:05:23,674][root][INFO] - total steps             : 39633
[2024-09-19 18:05:23,674][root][INFO] - warmup steps            : 3963
[2024-09-19 18:05:23,674][root][INFO] - batch size              : 64
[2024-09-19 18:05:23,675][root][INFO] - accumulation steps      : 1
[2024-09-19 18:05:23,675][root][INFO] - optimizer               : adamwscale
[2024-09-19 18:05:23,675][root][INFO] - lr_scheduler            : cosine
[2024-09-19 18:05:23,675][root][INFO] - learning rate           : 0.02
[2024-09-19 18:05:23,675][root][INFO] - max length              : 256

[2024-09-19 18:05:23,675][root][INFO] - LoRA Configuration
[2024-09-19 18:05:23,675][root][INFO] - ㄴ r                    : 32
[2024-09-19 18:05:23,676][root][INFO] - ㄴ alpha                : 128
[2024-09-19 18:05:23,676][root][INFO] - ㄴ dropout              : 0.03

[2024-09-19 18:05:23,676][root][INFO] - 

[2024-09-19 18:05:23,676][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.02lr_42rs
[2024-09-19 18:05:23,676][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.02lr_42rs/ckpt
[2024-09-19 18:05:23,676][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.02lr_42rs/tb
[2024-09-19 18:05:23,677][root][INFO] - * tb interval           : 400

[2024-09-19 18:05:23,677][root][INFO] - 

[2024-09-19 18:05:23,677][root][INFO] - Start the Training !
[2024-09-19 18:05:23,682][root][INFO] - 
[1/ 3 Epoch]
[2024-09-19 18:05:41,149][root][INFO] - Step: 8200/9020  |  Loss: 0.1933  |  Score: 92.25 [%]  |  Seq Length: 256.0
[2024-09-19 18:05:56,380][root][INFO] - Step: 100/9020  |  Loss: 0.6294  |  Score: 65.36 [%]  |  Seq Length: 256.0
[2024-09-19 18:06:26,955][root][INFO] - 

[2024-09-19 18:06:26,955][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-19 18:06:26,955][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.02lr_42rs
[2024-09-19 18:06:26,955][root][INFO] - 

[2024-09-19 18:06:26,956][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 2, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-19 18:06:31,008][root][INFO] - Step: 8300/9020  |  Loss: 0.1872  |  Score: 92.64 [%]  |  Seq Length: 256.0
[2024-09-19 18:06:40,632][root][INFO] - Step: 200/9020  |  Loss: 0.4611  |  Score: 79.02 [%]  |  Seq Length: 256.0
[2024-09-19 18:07:20,946][root][INFO] - Step: 8400/9020  |  Loss: 0.1774  |  Score: 92.94 [%]  |  Seq Length: 256.0
[2024-09-19 18:07:24,954][root][INFO] - Step: 300/9020  |  Loss: 0.4174  |  Score: 81.48 [%]  |  Seq Length: 256.0
[2024-09-19 18:08:09,296][root][INFO] - Step: 400/9020  |  Loss: 0.3947  |  Score: 82.19 [%]  |  Seq Length: 256.0
[2024-09-19 18:08:10,480][root][INFO] - Step: 8500/9020  |  Loss: 0.1848  |  Score: 93.05 [%]  |  Seq Length: 256.0
[2024-09-19 18:08:32,378][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-19 18:08:32,378][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-19 18:08:32,379][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-19 18:08:32,379][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-19 18:08:32,380][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-19 18:08:32,380][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-19 18:08:32,381][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-19 18:08:32,382][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-19 18:08:32,382][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-19 18:08:32,383][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-19 18:08:32,384][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-19 18:08:32,384][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-19 18:08:32,385][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-19 18:08:32,386][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-19 18:08:32,387][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-19 18:08:32,387][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-19 18:08:32,388][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-19 18:08:32,388][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-19 18:08:32,389][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-19 18:08:32,390][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-19 18:08:32,390][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-19 18:08:32,391][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-19 18:08:32,391][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-19 18:08:32,392][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-19 18:08:32,393][root][INFO] - Trainable params: 1769472 || all params: 126935808 || trainable: 1.39 %
[2024-09-19 18:08:32,840][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-19 18:08:39,538][root][INFO] - 

[2024-09-19 18:08:39,538][root][INFO] - ========== Fine-tuning on KorNLI ==========
[2024-09-19 18:08:39,538][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-19 18:08:39,547][root][INFO] - vocab size              : 51200
[2024-09-19 18:08:39,547][root][INFO] - device                  : gpu
[2024-09-19 18:08:39,547][root][INFO] - random seed             : 42
[2024-09-19 18:08:39,547][root][INFO] - train data size         : 422752
[2024-09-19 18:08:39,547][root][INFO] - max epochs              : 3
[2024-09-19 18:08:39,547][root][INFO] - total steps             : 39633
[2024-09-19 18:08:39,547][root][INFO] - warmup steps            : 3963
[2024-09-19 18:08:39,548][root][INFO] - batch size              : 64
[2024-09-19 18:08:39,548][root][INFO] - accumulation steps      : 2
[2024-09-19 18:08:39,548][root][INFO] - optimizer               : adamwscale
[2024-09-19 18:08:39,548][root][INFO] - lr_scheduler            : cosine
[2024-09-19 18:08:39,548][root][INFO] - learning rate           : 0.02
[2024-09-19 18:08:39,548][root][INFO] - max length              : 256

[2024-09-19 18:08:39,548][root][INFO] - LoRA Configuration
[2024-09-19 18:08:39,548][root][INFO] - ㄴ r                    : 32
[2024-09-19 18:08:39,548][root][INFO] - ㄴ alpha                : 128
[2024-09-19 18:08:39,548][root][INFO] - ㄴ dropout              : 0.03

[2024-09-19 18:08:39,548][root][INFO] - 

[2024-09-19 18:08:39,549][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.02lr_42rs
[2024-09-19 18:08:39,549][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.02lr_42rs/ckpt
[2024-09-19 18:08:39,549][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.02lr_42rs/tb
[2024-09-19 18:08:39,549][root][INFO] - * tb interval           : 400

[2024-09-19 18:08:39,549][root][INFO] - 

[2024-09-19 18:08:39,549][root][INFO] - Start the Training !
[2024-09-19 18:08:39,552][root][INFO] - 
[1/ 3 Epoch]
[2024-09-19 18:08:53,664][root][INFO] - Step: 500/9020  |  Loss: 0.3819  |  Score: 82.83 [%]  |  Seq Length: 256.0
[2024-09-19 18:08:59,031][root][INFO] - Step: 8600/9020  |  Loss: 0.1805  |  Score: 92.83 [%]  |  Seq Length: 256.0
[2024-09-19 18:09:38,073][root][INFO] - Step: 600/9020  |  Loss: 0.3693  |  Score: 83.83 [%]  |  Seq Length: 256.0
[2024-09-19 18:09:48,581][root][INFO] - Step: 8700/9020  |  Loss: 0.1889  |  Score: 92.28 [%]  |  Seq Length: 256.0
[2024-09-19 18:10:22,454][root][INFO] - Step: 700/9020  |  Loss: 0.3657  |  Score: 83.41 [%]  |  Seq Length: 256.0
[2024-09-19 18:10:37,658][root][INFO] - Step: 8800/9020  |  Loss: 0.1901  |  Score: 92.06 [%]  |  Seq Length: 256.0
[2024-09-19 18:11:06,818][root][INFO] - Step: 800/9020  |  Loss: 0.3476  |  Score: 84.92 [%]  |  Seq Length: 256.0
[2024-09-19 18:11:27,275][root][INFO] - Step: 8900/9020  |  Loss: 0.1762  |  Score: 92.83 [%]  |  Seq Length: 256.0
[2024-09-19 18:11:51,214][root][INFO] - Step: 900/9020  |  Loss: 0.3396  |  Score: 85.23 [%]  |  Seq Length: 256.0
[2024-09-19 18:12:16,960][root][INFO] - Step: 9000/9020  |  Loss: 0.1861  |  Score: 92.67 [%]  |  Seq Length: 256.0
[2024-09-19 18:12:26,960][root][INFO] - Step: 9020/9020  |  Loss: 0.1821  |  Score: 92.28 [%]  |  Seq Length: 256.0
[2024-09-19 18:12:35,617][root][INFO] - Step: 1000/9020  |  Loss: 0.3611  |  Score: 84.05 [%]  |  Seq Length: 256.0
[2024-09-19 18:13:12,233][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 18:13:12,233][root][INFO] - Score: 88.43 [%]  |  Evaluation Time: 45.27 [s]
[2024-09-19 18:13:20,001][root][INFO] - Step: 1100/9020  |  Loss: 0.3260  |  Score: 85.69 [%]  |  Seq Length: 256.0
[2024-09-19 18:14:04,447][root][INFO] - Step: 1200/9020  |  Loss: 0.3323  |  Score: 85.84 [%]  |  Seq Length: 256.0
[2024-09-19 18:14:48,888][root][INFO] - Step: 1300/9020  |  Loss: 0.3297  |  Score: 86.06 [%]  |  Seq Length: 256.0
[2024-09-19 18:15:33,284][root][INFO] - Step: 1400/9020  |  Loss: 0.3390  |  Score: 85.66 [%]  |  Seq Length: 256.0
[2024-09-19 18:15:40,943][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 18:15:40,943][root][INFO] - Score: 88.59 [%]  |  Evaluation Time: 148.70 [s]
[2024-09-19 18:15:40,944][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 18:15:40,944][root][INFO] - - Epoch: 4
[2024-09-19 18:15:40,944][root][INFO] - - DEV score: 88.58 [%]
[2024-09-19 18:15:40,945][root][INFO] - - TEST score: 88.49 [%]
[2024-09-19 18:15:40,945][root][INFO] - Fine-tuning is done!
[2024-09-19 18:16:17,752][root][INFO] - Step: 1500/9020  |  Loss: 0.3297  |  Score: 85.94 [%]  |  Seq Length: 256.0
[2024-09-19 18:17:02,166][root][INFO] - Step: 1600/9020  |  Loss: 0.3328  |  Score: 85.41 [%]  |  Seq Length: 256.0
[2024-09-19 18:17:46,547][root][INFO] - Step: 1700/9020  |  Loss: 0.3148  |  Score: 86.98 [%]  |  Seq Length: 256.0
[2024-09-19 18:18:31,013][root][INFO] - Step: 1800/9020  |  Loss: 0.3202  |  Score: 86.05 [%]  |  Seq Length: 256.0
[2024-09-19 18:18:32,810][root][INFO] - Step: 1804/9020  |  Loss: 0.3009  |  Score: 87.24 [%]  |  Seq Length: 256.0
[2024-09-19 18:19:02,201][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-19 18:19:02,201][root][INFO] - Score: 86.80 [%]  |  Evaluation Time: 29.39 [s]
[2024-09-19 18:20:39,055][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-19 18:20:39,055][root][INFO] - Score: 86.87 [%]  |  Evaluation Time: 96.85 [s]
[2024-09-19 18:20:39,056][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-19 18:20:39,057][root][INFO] - 
[2/ 5 Epoch]
[2024-09-19 18:21:22,166][root][INFO] - Step: 1900/9020  |  Loss: 0.3061  |  Score: 86.80 [%]  |  Seq Length: 256.0
[2024-09-19 18:22:06,499][root][INFO] - Step: 2000/9020  |  Loss: 0.2920  |  Score: 87.67 [%]  |  Seq Length: 256.0
[2024-09-19 18:22:50,792][root][INFO] - Step: 2100/9020  |  Loss: 0.2942  |  Score: 87.45 [%]  |  Seq Length: 256.0
[2024-09-19 18:23:35,154][root][INFO] - Step: 2200/9020  |  Loss: 0.2940  |  Score: 87.67 [%]  |  Seq Length: 256.0
[2024-09-19 18:24:19,533][root][INFO] - Step: 2300/9020  |  Loss: 0.2965  |  Score: 87.42 [%]  |  Seq Length: 256.0
[2024-09-19 18:25:03,958][root][INFO] - Step: 2400/9020  |  Loss: 0.2855  |  Score: 88.12 [%]  |  Seq Length: 256.0
[2024-09-19 18:25:48,321][root][INFO] - Step: 2500/9020  |  Loss: 0.2892  |  Score: 87.77 [%]  |  Seq Length: 256.0
[2024-09-19 18:26:32,703][root][INFO] - Step: 2600/9020  |  Loss: 0.2804  |  Score: 88.02 [%]  |  Seq Length: 256.0
[2024-09-19 18:27:17,096][root][INFO] - Step: 2700/9020  |  Loss: 0.2893  |  Score: 88.06 [%]  |  Seq Length: 256.0
[2024-09-19 18:28:01,438][root][INFO] - Step: 2800/9020  |  Loss: 0.2792  |  Score: 88.58 [%]  |  Seq Length: 256.0
[2024-09-19 18:28:45,826][root][INFO] - Step: 2900/9020  |  Loss: 0.2773  |  Score: 88.22 [%]  |  Seq Length: 256.0
[2024-09-19 18:29:30,243][root][INFO] - Step: 3000/9020  |  Loss: 0.2988  |  Score: 87.38 [%]  |  Seq Length: 256.0
[2024-09-19 18:30:14,649][root][INFO] - Step: 3100/9020  |  Loss: 0.2819  |  Score: 88.06 [%]  |  Seq Length: 256.0
[2024-09-19 18:30:59,053][root][INFO] - Step: 3200/9020  |  Loss: 0.2824  |  Score: 88.44 [%]  |  Seq Length: 256.0
[2024-09-19 18:31:43,502][root][INFO] - Step: 3300/9020  |  Loss: 0.2810  |  Score: 88.05 [%]  |  Seq Length: 256.0
[2024-09-19 18:32:27,899][root][INFO] - Step: 3400/9020  |  Loss: 0.2806  |  Score: 88.02 [%]  |  Seq Length: 256.0
[2024-09-19 18:33:12,301][root][INFO] - Step: 3500/9020  |  Loss: 0.2852  |  Score: 88.05 [%]  |  Seq Length: 256.0
[2024-09-19 18:33:56,715][root][INFO] - Step: 3600/9020  |  Loss: 0.2890  |  Score: 87.86 [%]  |  Seq Length: 256.0
[2024-09-19 18:34:00,282][root][INFO] - Step: 3608/9020  |  Loss: 0.2820  |  Score: 87.30 [%]  |  Seq Length: 256.0
[2024-09-19 18:34:29,654][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-19 18:34:29,654][root][INFO] - Score: 87.75 [%]  |  Evaluation Time: 29.37 [s]
[2024-09-19 18:36:06,620][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-19 18:36:06,620][root][INFO] - Score: 87.96 [%]  |  Evaluation Time: 96.96 [s]
[2024-09-19 18:36:06,621][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-19 18:36:06,622][root][INFO] - 
[3/ 5 Epoch]
[2024-09-19 18:36:47,965][root][INFO] - Step: 3700/9020  |  Loss: 0.2383  |  Score: 90.27 [%]  |  Seq Length: 256.0
[2024-09-19 18:37:32,381][root][INFO] - Step: 3800/9020  |  Loss: 0.2556  |  Score: 89.77 [%]  |  Seq Length: 256.0
[2024-09-19 18:38:16,814][root][INFO] - Step: 3900/9020  |  Loss: 0.2484  |  Score: 89.78 [%]  |  Seq Length: 256.0
[2024-09-19 18:39:01,155][root][INFO] - Step: 4000/9020  |  Loss: 0.2453  |  Score: 89.91 [%]  |  Seq Length: 256.0
[2024-09-19 18:39:45,566][root][INFO] - Step: 4100/9020  |  Loss: 0.2414  |  Score: 89.98 [%]  |  Seq Length: 256.0
[2024-09-19 18:40:29,999][root][INFO] - Step: 4200/9020  |  Loss: 0.2581  |  Score: 89.09 [%]  |  Seq Length: 256.0
[2024-09-19 18:41:14,484][root][INFO] - Step: 4300/9020  |  Loss: 0.2658  |  Score: 88.69 [%]  |  Seq Length: 256.0
[2024-09-19 18:41:58,862][root][INFO] - Step: 4400/9020  |  Loss: 0.2525  |  Score: 89.72 [%]  |  Seq Length: 256.0
[2024-09-19 18:42:43,279][root][INFO] - Step: 4500/9020  |  Loss: 0.2513  |  Score: 89.45 [%]  |  Seq Length: 256.0
[2024-09-19 18:43:27,672][root][INFO] - Step: 4600/9020  |  Loss: 0.2405  |  Score: 90.38 [%]  |  Seq Length: 256.0
[2024-09-19 18:44:12,093][root][INFO] - Step: 4700/9020  |  Loss: 0.2610  |  Score: 89.25 [%]  |  Seq Length: 256.0
[2024-09-19 18:44:56,462][root][INFO] - Step: 4800/9020  |  Loss: 0.2639  |  Score: 88.92 [%]  |  Seq Length: 256.0
[2024-09-19 18:45:40,870][root][INFO] - Step: 4900/9020  |  Loss: 0.2430  |  Score: 90.23 [%]  |  Seq Length: 256.0
[2024-09-19 18:46:25,296][root][INFO] - Step: 5000/9020  |  Loss: 0.2660  |  Score: 89.02 [%]  |  Seq Length: 256.0
[2024-09-19 18:47:09,699][root][INFO] - Step: 5100/9020  |  Loss: 0.2567  |  Score: 89.62 [%]  |  Seq Length: 256.0
[2024-09-19 18:47:54,049][root][INFO] - Step: 5200/9020  |  Loss: 0.2448  |  Score: 89.89 [%]  |  Seq Length: 256.0
[2024-09-19 18:48:38,425][root][INFO] - Step: 5300/9020  |  Loss: 0.2557  |  Score: 89.62 [%]  |  Seq Length: 256.0
[2024-09-19 18:49:22,849][root][INFO] - Step: 5400/9020  |  Loss: 0.2515  |  Score: 89.89 [%]  |  Seq Length: 256.0
[2024-09-19 18:49:28,186][root][INFO] - Step: 5412/9020  |  Loss: 0.2716  |  Score: 89.24 [%]  |  Seq Length: 256.0
[2024-09-19 18:49:57,533][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-19 18:49:57,533][root][INFO] - Score: 88.02 [%]  |  Evaluation Time: 29.34 [s]
[2024-09-19 18:51:34,533][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-19 18:51:34,534][root][INFO] - Score: 88.27 [%]  |  Evaluation Time: 97.00 [s]
[2024-09-19 18:51:34,535][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-19 18:51:34,536][root][INFO] - 
[4/ 5 Epoch]
[2024-09-19 18:52:13,942][root][INFO] - Step: 5500/9020  |  Loss: 0.2220  |  Score: 90.80 [%]  |  Seq Length: 256.0
[2024-09-19 18:52:58,261][root][INFO] - Step: 5600/9020  |  Loss: 0.2243  |  Score: 91.20 [%]  |  Seq Length: 256.0
[2024-09-19 18:53:42,570][root][INFO] - Step: 5700/9020  |  Loss: 0.2322  |  Score: 90.62 [%]  |  Seq Length: 256.0
[2024-09-19 18:54:26,854][root][INFO] - Step: 5800/9020  |  Loss: 0.2241  |  Score: 91.02 [%]  |  Seq Length: 256.0
[2024-09-19 18:55:11,138][root][INFO] - Step: 5900/9020  |  Loss: 0.2426  |  Score: 90.30 [%]  |  Seq Length: 256.0
[2024-09-19 18:55:55,449][root][INFO] - Step: 6000/9020  |  Loss: 0.2463  |  Score: 90.12 [%]  |  Seq Length: 256.0
[2024-09-19 18:56:39,730][root][INFO] - Step: 6100/9020  |  Loss: 0.2459  |  Score: 90.09 [%]  |  Seq Length: 256.0
[2024-09-19 18:57:24,077][root][INFO] - Step: 6200/9020  |  Loss: 0.2211  |  Score: 91.22 [%]  |  Seq Length: 256.0
[2024-09-19 18:58:08,394][root][INFO] - Step: 6300/9020  |  Loss: 0.2213  |  Score: 91.17 [%]  |  Seq Length: 256.0
[2024-09-19 18:58:52,672][root][INFO] - Step: 6400/9020  |  Loss: 0.2221  |  Score: 91.03 [%]  |  Seq Length: 256.0
[2024-09-19 18:59:37,042][root][INFO] - Step: 6500/9020  |  Loss: 0.2277  |  Score: 90.47 [%]  |  Seq Length: 256.0
[2024-09-19 19:00:21,318][root][INFO] - Step: 6600/9020  |  Loss: 0.2253  |  Score: 90.80 [%]  |  Seq Length: 256.0
[2024-09-19 19:01:05,598][root][INFO] - Step: 6700/9020  |  Loss: 0.2218  |  Score: 91.55 [%]  |  Seq Length: 256.0
[2024-09-19 19:01:49,882][root][INFO] - Step: 6800/9020  |  Loss: 0.2214  |  Score: 90.97 [%]  |  Seq Length: 256.0
[2024-09-19 19:02:34,176][root][INFO] - Step: 6900/9020  |  Loss: 0.2371  |  Score: 89.97 [%]  |  Seq Length: 256.0
[2024-09-19 19:03:18,459][root][INFO] - Step: 7000/9020  |  Loss: 0.2255  |  Score: 91.06 [%]  |  Seq Length: 256.0
[2024-09-19 19:04:02,736][root][INFO] - Step: 7100/9020  |  Loss: 0.2239  |  Score: 90.77 [%]  |  Seq Length: 256.0
[2024-09-19 19:04:47,070][root][INFO] - Step: 7200/9020  |  Loss: 0.2303  |  Score: 90.83 [%]  |  Seq Length: 256.0
[2024-09-19 19:04:54,183][root][INFO] - Step: 7216/9020  |  Loss: 0.2006  |  Score: 92.79 [%]  |  Seq Length: 256.0
[2024-09-19 19:05:23,687][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-19 19:05:23,687][root][INFO] - Score: 88.34 [%]  |  Evaluation Time: 29.50 [s]
[2024-09-19 19:07:00,525][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-19 19:07:00,526][root][INFO] - Score: 88.64 [%]  |  Evaluation Time: 96.84 [s]
[2024-09-19 19:07:00,527][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-19 19:07:00,528][root][INFO] - 
[5/ 5 Epoch]
[2024-09-19 19:07:38,164][root][INFO] - Step: 7300/9020  |  Loss: 0.2168  |  Score: 91.31 [%]  |  Seq Length: 256.0
[2024-09-19 19:08:22,482][root][INFO] - Step: 7400/9020  |  Loss: 0.2168  |  Score: 91.56 [%]  |  Seq Length: 256.0
[2024-09-19 19:09:06,785][root][INFO] - Step: 7500/9020  |  Loss: 0.2106  |  Score: 91.56 [%]  |  Seq Length: 256.0
[2024-09-19 19:09:51,076][root][INFO] - Step: 7600/9020  |  Loss: 0.2079  |  Score: 91.78 [%]  |  Seq Length: 256.0
[2024-09-19 19:10:35,361][root][INFO] - Step: 7700/9020  |  Loss: 0.2137  |  Score: 91.67 [%]  |  Seq Length: 256.0
[2024-09-19 19:11:19,622][root][INFO] - Step: 7800/9020  |  Loss: 0.2009  |  Score: 91.69 [%]  |  Seq Length: 256.0
[2024-09-19 19:12:03,855][root][INFO] - Step: 7900/9020  |  Loss: 0.2078  |  Score: 91.66 [%]  |  Seq Length: 256.0
[2024-09-19 19:12:48,267][root][INFO] - Step: 8000/9020  |  Loss: 0.2155  |  Score: 91.44 [%]  |  Seq Length: 256.0
[2024-09-19 19:13:32,563][root][INFO] - Step: 8100/9020  |  Loss: 0.2078  |  Score: 91.53 [%]  |  Seq Length: 256.0
[2024-09-19 19:14:16,890][root][INFO] - Step: 8200/9020  |  Loss: 0.2173  |  Score: 91.30 [%]  |  Seq Length: 256.0
[2024-09-19 19:15:01,189][root][INFO] - Step: 8300/9020  |  Loss: 0.2224  |  Score: 91.30 [%]  |  Seq Length: 256.0
[2024-09-19 19:15:45,535][root][INFO] - Step: 8400/9020  |  Loss: 0.2090  |  Score: 91.69 [%]  |  Seq Length: 256.0
[2024-09-19 19:16:29,824][root][INFO] - Step: 8500/9020  |  Loss: 0.2022  |  Score: 91.64 [%]  |  Seq Length: 256.0
[2024-09-19 19:17:14,135][root][INFO] - Step: 8600/9020  |  Loss: 0.1967  |  Score: 92.23 [%]  |  Seq Length: 256.0
[2024-09-19 19:17:58,427][root][INFO] - Step: 8700/9020  |  Loss: 0.2198  |  Score: 91.12 [%]  |  Seq Length: 256.0
[2024-09-19 19:18:42,733][root][INFO] - Step: 8800/9020  |  Loss: 0.2203  |  Score: 91.25 [%]  |  Seq Length: 256.0
[2024-09-19 19:19:27,024][root][INFO] - Step: 8900/9020  |  Loss: 0.2260  |  Score: 90.84 [%]  |  Seq Length: 256.0
[2024-09-19 19:20:11,352][root][INFO] - Step: 9000/9020  |  Loss: 0.2231  |  Score: 90.73 [%]  |  Seq Length: 256.0
[2024-09-19 19:20:20,260][root][INFO] - Step: 9020/9020  |  Loss: 0.2354  |  Score: 90.31 [%]  |  Seq Length: 256.0
[2024-09-19 19:20:49,621][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-19 19:20:49,621][root][INFO] - Score: 88.38 [%]  |  Evaluation Time: 29.36 [s]
[2024-09-19 19:22:26,339][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-19 19:22:26,340][root][INFO] - Score: 88.59 [%]  |  Evaluation Time: 96.72 [s]
[2024-09-19 19:22:26,341][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-19 19:22:26,341][root][INFO] - - Epoch: 4
[2024-09-19 19:22:26,341][root][INFO] - - DEV score: 88.34 [%]
[2024-09-19 19:22:26,341][root][INFO] - - TEST score: 88.64 [%]
[2024-09-19 19:22:26,342][root][INFO] - Fine-tuning is done!
[2024-09-20 01:25:54,947][root][INFO] - 

[2024-09-20 01:25:54,947][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-20 01:25:54,948][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.02lr_42rs
[2024-09-20 01:25:54,948][root][INFO] - 

[2024-09-20 01:25:54,948][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 4, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-20 01:28:23,409][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-20 01:28:23,410][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-20 01:28:23,411][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-20 01:28:23,411][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-20 01:28:23,412][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-20 01:28:23,412][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-20 01:28:23,412][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-20 01:28:23,413][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-20 01:28:23,413][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-20 01:28:23,414][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-20 01:28:23,414][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-20 01:28:23,415][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-20 01:28:23,415][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-20 01:28:23,416][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-20 01:28:23,416][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-20 01:28:23,417][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-20 01:28:23,417][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-20 01:28:23,418][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-20 01:28:23,418][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-20 01:28:23,419][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-20 01:28:23,419][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-20 01:28:23,420][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-20 01:28:23,420][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-20 01:28:23,421][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-20 01:28:23,422][root][INFO] - Trainable params: 1769472 || all params: 126935808 || trainable: 1.39 %
[2024-09-20 01:28:23,722][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-20 01:28:27,889][root][INFO] - 

[2024-09-20 01:28:27,889][root][INFO] - ========== Fine-tuning on KorNLI ==========
[2024-09-20 01:28:27,889][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-20 01:28:27,897][root][INFO] - vocab size              : 51200
[2024-09-20 01:28:27,897][root][INFO] - device                  : gpu
[2024-09-20 01:28:27,897][root][INFO] - random seed             : 42
[2024-09-20 01:28:27,898][root][INFO] - train data size         : 211376
[2024-09-20 01:28:27,898][root][INFO] - max epochs              : 3
[2024-09-20 01:28:27,898][root][INFO] - total steps             : 39633
[2024-09-20 01:28:27,898][root][INFO] - warmup steps            : 3963
[2024-09-20 01:28:27,898][root][INFO] - batch size              : 64
[2024-09-20 01:28:27,898][root][INFO] - accumulation steps      : 4
[2024-09-20 01:28:27,898][root][INFO] - optimizer               : adamwscale
[2024-09-20 01:28:27,898][root][INFO] - lr_scheduler            : cosine
[2024-09-20 01:28:27,898][root][INFO] - learning rate           : 0.02
[2024-09-20 01:28:27,898][root][INFO] - max length              : 256

[2024-09-20 01:28:27,898][root][INFO] - LoRA Configuration
[2024-09-20 01:28:27,898][root][INFO] - ㄴ r                    : 32
[2024-09-20 01:28:27,899][root][INFO] - ㄴ alpha                : 128
[2024-09-20 01:28:27,899][root][INFO] - ㄴ dropout              : 0.03

[2024-09-20 01:28:27,899][root][INFO] - 

[2024-09-20 01:28:27,899][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.02lr_42rs
[2024-09-20 01:28:27,899][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.02lr_42rs/ckpt
[2024-09-20 01:28:27,899][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.02lr_42rs/tb
[2024-09-20 01:28:27,899][root][INFO] - * tb interval           : 400

[2024-09-20 01:28:27,899][root][INFO] - 

[2024-09-20 01:28:27,899][root][INFO] - Start the Training !
[2024-09-20 01:28:27,902][root][INFO] - 
[1/ 3 Epoch]
[2024-09-20 01:31:14,279][root][INFO] - Step: 400/39633  |  Loss: 0.9445  |  Score: 54.19 [%]  |  Seq Length: 256.0
[2024-09-20 01:33:58,140][root][INFO] - Step: 800/39633  |  Loss: 0.8245  |  Score: 63.18 [%]  |  Seq Length: 256.0
[2024-09-20 01:36:41,854][root][INFO] - Step: 1200/39633  |  Loss: 0.7888  |  Score: 65.18 [%]  |  Seq Length: 256.0
[2024-09-20 01:39:25,903][root][INFO] - Step: 1600/39633  |  Loss: 0.7789  |  Score: 65.76 [%]  |  Seq Length: 256.0
[2024-09-20 01:42:09,566][root][INFO] - Step: 2000/39633  |  Loss: 0.7577  |  Score: 67.11 [%]  |  Seq Length: 256.0
[2024-09-20 01:44:53,118][root][INFO] - Step: 2400/39633  |  Loss: 0.7485  |  Score: 67.39 [%]  |  Seq Length: 256.0
[2024-09-20 01:47:36,840][root][INFO] - Step: 2800/39633  |  Loss: 0.7397  |  Score: 67.96 [%]  |  Seq Length: 256.0
[2024-09-20 01:50:20,785][root][INFO] - Step: 3200/39633  |  Loss: 0.7405  |  Score: 67.86 [%]  |  Seq Length: 256.0
[2024-09-20 01:53:04,713][root][INFO] - Step: 3600/39633  |  Loss: 0.7295  |  Score: 68.67 [%]  |  Seq Length: 256.0
[2024-09-20 01:55:48,432][root][INFO] - Step: 4000/39633  |  Loss: 0.7299  |  Score: 68.77 [%]  |  Seq Length: 256.0
[2024-09-20 01:58:32,183][root][INFO] - Step: 4400/39633  |  Loss: 0.7389  |  Score: 68.34 [%]  |  Seq Length: 256.0
[2024-09-20 02:01:16,132][root][INFO] - Step: 4800/39633  |  Loss: 0.7374  |  Score: 67.93 [%]  |  Seq Length: 256.0
[2024-09-20 02:03:59,964][root][INFO] - Step: 5200/39633  |  Loss: 0.7384  |  Score: 68.12 [%]  |  Seq Length: 256.0
[2024-09-20 02:06:43,858][root][INFO] - Step: 5600/39633  |  Loss: 0.7272  |  Score: 68.67 [%]  |  Seq Length: 256.0
[2024-09-20 02:09:27,614][root][INFO] - Step: 6000/39633  |  Loss: 0.7390  |  Score: 68.09 [%]  |  Seq Length: 256.0
[2024-09-20 02:12:11,452][root][INFO] - Step: 6400/39633  |  Loss: 0.7419  |  Score: 67.71 [%]  |  Seq Length: 256.0
[2024-09-20 02:14:55,357][root][INFO] - Step: 6800/39633  |  Loss: 0.7344  |  Score: 68.39 [%]  |  Seq Length: 256.0
[2024-09-20 02:17:39,209][root][INFO] - Step: 7200/39633  |  Loss: 0.7531  |  Score: 67.57 [%]  |  Seq Length: 256.0
[2024-09-20 02:20:23,038][root][INFO] - Step: 7600/39633  |  Loss: 0.7465  |  Score: 67.50 [%]  |  Seq Length: 256.0
[2024-09-20 02:23:07,207][root][INFO] - Step: 8000/39633  |  Loss: 0.7555  |  Score: 67.38 [%]  |  Seq Length: 256.0
[2024-09-20 02:25:51,285][root][INFO] - Step: 8400/39633  |  Loss: 0.7646  |  Score: 66.47 [%]  |  Seq Length: 256.0
[2024-09-20 02:28:35,528][root][INFO] - Step: 8800/39633  |  Loss: 0.7673  |  Score: 66.70 [%]  |  Seq Length: 256.0
[2024-09-20 02:31:19,631][root][INFO] - Step: 9200/39633  |  Loss: 0.7664  |  Score: 66.42 [%]  |  Seq Length: 256.0
[2024-09-20 02:34:03,735][root][INFO] - Step: 9600/39633  |  Loss: 0.7689  |  Score: 66.31 [%]  |  Seq Length: 256.0
[2024-09-20 02:36:47,730][root][INFO] - Step: 10000/39633  |  Loss: 0.7790  |  Score: 65.63 [%]  |  Seq Length: 256.0
[2024-09-20 02:39:31,908][root][INFO] - Step: 10400/39633  |  Loss: 0.7844  |  Score: 65.24 [%]  |  Seq Length: 256.0
[2024-09-20 02:42:16,058][root][INFO] - Step: 10800/39633  |  Loss: 0.7918  |  Score: 65.00 [%]  |  Seq Length: 256.0
[2024-09-20 02:45:00,261][root][INFO] - Step: 11200/39633  |  Loss: 0.7932  |  Score: 65.04 [%]  |  Seq Length: 256.0
[2024-09-20 02:47:44,212][root][INFO] - Step: 11600/39633  |  Loss: 0.7959  |  Score: 64.83 [%]  |  Seq Length: 256.0
[2024-09-20 02:50:28,310][root][INFO] - Step: 12000/39633  |  Loss: 0.7904  |  Score: 64.96 [%]  |  Seq Length: 256.0
[2024-09-20 02:53:12,588][root][INFO] - Step: 12400/39633  |  Loss: 0.8014  |  Score: 64.56 [%]  |  Seq Length: 256.0
[2024-09-20 02:55:56,702][root][INFO] - Step: 12800/39633  |  Loss: 0.8137  |  Score: 63.52 [%]  |  Seq Length: 256.0
[2024-09-20 02:58:40,616][root][INFO] - Step: 13200/39633  |  Loss: 0.8165  |  Score: 63.31 [%]  |  Seq Length: 256.0
[2024-09-20 02:58:45,179][root][INFO] - Step: 13211/39633  |  Loss: 0.8099  |  Score: 65.34 [%]  |  Seq Length: 256.0
[2024-09-20 02:58:50,720][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-20 02:58:50,720][root][INFO] - Score: 61.74 [%]  |  Evaluation Time: 5.54 [s]
[2024-09-20 02:59:00,887][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-20 02:59:00,888][root][INFO] - Score: 61.32 [%]  |  Evaluation Time: 10.16 [s]
[2024-09-20 02:59:00,889][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-20 02:59:00,890][root][INFO] - 
[2/ 3 Epoch]
[2024-09-20 03:01:40,644][root][INFO] - Step: 13600/39633  |  Loss: 0.8155  |  Score: 63.47 [%]  |  Seq Length: 256.0
[2024-09-20 03:04:24,588][root][INFO] - Step: 14000/39633  |  Loss: 0.8085  |  Score: 63.60 [%]  |  Seq Length: 256.0
[2024-09-20 03:07:08,415][root][INFO] - Step: 14400/39633  |  Loss: 0.8183  |  Score: 63.45 [%]  |  Seq Length: 256.0
[2024-09-20 03:09:52,215][root][INFO] - Step: 14800/39633  |  Loss: 0.8178  |  Score: 62.99 [%]  |  Seq Length: 256.0
[2024-09-20 03:12:35,754][root][INFO] - Step: 15200/39633  |  Loss: 0.8342  |  Score: 62.51 [%]  |  Seq Length: 256.0
[2024-09-20 03:15:19,421][root][INFO] - Step: 15600/39633  |  Loss: 0.8303  |  Score: 62.50 [%]  |  Seq Length: 256.0
[2024-09-20 03:18:03,172][root][INFO] - Step: 16000/39633  |  Loss: 0.8445  |  Score: 61.70 [%]  |  Seq Length: 256.0
[2024-09-20 03:20:46,966][root][INFO] - Step: 16400/39633  |  Loss: 0.8313  |  Score: 62.51 [%]  |  Seq Length: 256.0
[2024-09-20 03:23:30,507][root][INFO] - Step: 16800/39633  |  Loss: 0.8408  |  Score: 61.86 [%]  |  Seq Length: 256.0
[2024-09-20 03:26:14,468][root][INFO] - Step: 17200/39633  |  Loss: 0.8449  |  Score: 61.33 [%]  |  Seq Length: 256.0
[2024-09-20 03:28:58,479][root][INFO] - Step: 17600/39633  |  Loss: 0.8308  |  Score: 62.35 [%]  |  Seq Length: 256.0
[2024-09-20 03:31:42,476][root][INFO] - Step: 18000/39633  |  Loss: 0.8474  |  Score: 61.52 [%]  |  Seq Length: 256.0
[2024-09-20 03:34:26,332][root][INFO] - Step: 18400/39633  |  Loss: 0.8371  |  Score: 62.16 [%]  |  Seq Length: 256.0
[2024-09-20 03:37:10,292][root][INFO] - Step: 18800/39633  |  Loss: 0.8366  |  Score: 62.09 [%]  |  Seq Length: 256.0
[2024-09-20 03:39:54,077][root][INFO] - Step: 19200/39633  |  Loss: 0.8295  |  Score: 62.39 [%]  |  Seq Length: 256.0
[2024-09-20 03:42:37,812][root][INFO] - Step: 19600/39633  |  Loss: 0.8294  |  Score: 62.52 [%]  |  Seq Length: 256.0
[2024-09-20 03:45:21,521][root][INFO] - Step: 20000/39633  |  Loss: 0.8281  |  Score: 62.39 [%]  |  Seq Length: 256.0
[2024-09-20 03:48:05,337][root][INFO] - Step: 20400/39633  |  Loss: 0.8191  |  Score: 63.12 [%]  |  Seq Length: 256.0
[2024-09-20 03:50:49,129][root][INFO] - Step: 20800/39633  |  Loss: 0.8195  |  Score: 62.95 [%]  |  Seq Length: 256.0
[2024-09-20 03:53:32,702][root][INFO] - Step: 21200/39633  |  Loss: 0.8213  |  Score: 63.07 [%]  |  Seq Length: 256.0
[2024-09-20 03:56:16,596][root][INFO] - Step: 21600/39633  |  Loss: 0.8178  |  Score: 63.11 [%]  |  Seq Length: 256.0
[2024-09-20 03:59:00,331][root][INFO] - Step: 22000/39633  |  Loss: 0.8217  |  Score: 62.69 [%]  |  Seq Length: 256.0
[2024-09-20 04:01:44,068][root][INFO] - Step: 22400/39633  |  Loss: 0.8135  |  Score: 63.58 [%]  |  Seq Length: 256.0
[2024-09-20 04:04:27,891][root][INFO] - Step: 22800/39633  |  Loss: 0.8153  |  Score: 63.07 [%]  |  Seq Length: 256.0
[2024-09-20 04:07:11,481][root][INFO] - Step: 23200/39633  |  Loss: 0.8113  |  Score: 63.56 [%]  |  Seq Length: 256.0
[2024-09-20 04:09:55,223][root][INFO] - Step: 23600/39633  |  Loss: 0.8045  |  Score: 63.57 [%]  |  Seq Length: 256.0
[2024-09-20 04:12:38,898][root][INFO] - Step: 24000/39633  |  Loss: 0.8006  |  Score: 64.18 [%]  |  Seq Length: 256.0
[2024-09-20 04:15:22,987][root][INFO] - Step: 24400/39633  |  Loss: 0.7956  |  Score: 64.19 [%]  |  Seq Length: 256.0
[2024-09-20 04:18:06,982][root][INFO] - Step: 24800/39633  |  Loss: 0.7941  |  Score: 64.60 [%]  |  Seq Length: 256.0
[2024-09-20 04:20:50,921][root][INFO] - Step: 25200/39633  |  Loss: 0.7876  |  Score: 64.68 [%]  |  Seq Length: 256.0
[2024-09-20 04:23:34,885][root][INFO] - Step: 25600/39633  |  Loss: 0.7734  |  Score: 65.62 [%]  |  Seq Length: 256.0
[2024-09-20 04:26:19,037][root][INFO] - Step: 26000/39633  |  Loss: 0.7786  |  Score: 65.64 [%]  |  Seq Length: 256.0
[2024-09-20 04:29:03,242][root][INFO] - Step: 26400/39633  |  Loss: 0.7714  |  Score: 65.85 [%]  |  Seq Length: 256.0
[2024-09-20 04:29:12,385][root][INFO] - Step: 26422/39633  |  Loss: 0.7579  |  Score: 66.83 [%]  |  Seq Length: 256.0
[2024-09-20 04:29:17,760][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-20 04:29:17,760][root][INFO] - Score: 65.06 [%]  |  Evaluation Time: 5.37 [s]
[2024-09-20 04:29:27,836][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-20 04:29:27,837][root][INFO] - Score: 63.76 [%]  |  Evaluation Time: 10.07 [s]
[2024-09-20 04:29:27,838][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-20 04:29:27,839][root][INFO] - 
[3/ 3 Epoch]
[2024-09-20 04:32:03,689][root][INFO] - Step: 26800/39633  |  Loss: 0.7658  |  Score: 66.25 [%]  |  Seq Length: 256.0
[2024-09-20 04:34:47,891][root][INFO] - Step: 27200/39633  |  Loss: 0.7530  |  Score: 66.96 [%]  |  Seq Length: 256.0
[2024-09-20 04:37:31,737][root][INFO] - Step: 27600/39633  |  Loss: 0.7500  |  Score: 67.30 [%]  |  Seq Length: 256.0
[2024-09-20 04:40:16,103][root][INFO] - Step: 28000/39633  |  Loss: 0.7506  |  Score: 67.03 [%]  |  Seq Length: 256.0
[2024-09-20 04:43:00,239][root][INFO] - Step: 28400/39633  |  Loss: 0.7439  |  Score: 67.43 [%]  |  Seq Length: 256.0
[2024-09-20 04:45:44,383][root][INFO] - Step: 28800/39633  |  Loss: 0.7307  |  Score: 67.89 [%]  |  Seq Length: 256.0
[2024-09-20 04:48:28,269][root][INFO] - Step: 29200/39633  |  Loss: 0.7249  |  Score: 68.50 [%]  |  Seq Length: 256.0
[2024-09-20 04:51:12,377][root][INFO] - Step: 29600/39633  |  Loss: 0.7257  |  Score: 68.26 [%]  |  Seq Length: 256.0
[2024-09-20 04:53:56,506][root][INFO] - Step: 30000/39633  |  Loss: 0.7290  |  Score: 68.13 [%]  |  Seq Length: 256.0
[2024-09-20 04:56:40,604][root][INFO] - Step: 30400/39633  |  Loss: 0.7153  |  Score: 69.06 [%]  |  Seq Length: 256.0
[2024-09-20 04:59:24,910][root][INFO] - Step: 30800/39633  |  Loss: 0.7140  |  Score: 69.21 [%]  |  Seq Length: 256.0
[2024-09-20 05:02:09,091][root][INFO] - Step: 31200/39633  |  Loss: 0.7143  |  Score: 68.90 [%]  |  Seq Length: 256.0
[2024-09-20 05:04:53,220][root][INFO] - Step: 31600/39633  |  Loss: 0.7040  |  Score: 69.72 [%]  |  Seq Length: 256.0
[2024-09-20 05:07:37,393][root][INFO] - Step: 32000/39633  |  Loss: 0.7084  |  Score: 69.48 [%]  |  Seq Length: 256.0
[2024-09-20 05:10:21,574][root][INFO] - Step: 32400/39633  |  Loss: 0.7027  |  Score: 69.75 [%]  |  Seq Length: 256.0
[2024-09-20 05:13:05,948][root][INFO] - Step: 32800/39633  |  Loss: 0.7008  |  Score: 69.90 [%]  |  Seq Length: 256.0
[2024-09-20 05:15:50,039][root][INFO] - Step: 33200/39633  |  Loss: 0.6951  |  Score: 69.88 [%]  |  Seq Length: 256.0
[2024-09-20 05:18:34,248][root][INFO] - Step: 33600/39633  |  Loss: 0.6963  |  Score: 70.26 [%]  |  Seq Length: 256.0
[2024-09-20 05:21:18,251][root][INFO] - Step: 34000/39633  |  Loss: 0.6998  |  Score: 69.78 [%]  |  Seq Length: 256.0
[2024-09-20 05:24:02,378][root][INFO] - Step: 34400/39633  |  Loss: 0.6871  |  Score: 70.22 [%]  |  Seq Length: 256.0
[2024-09-20 05:26:46,191][root][INFO] - Step: 34800/39633  |  Loss: 0.6886  |  Score: 70.43 [%]  |  Seq Length: 256.0
[2024-09-20 05:29:30,216][root][INFO] - Step: 35200/39633  |  Loss: 0.6850  |  Score: 71.00 [%]  |  Seq Length: 256.0
[2024-09-20 05:32:14,182][root][INFO] - Step: 35600/39633  |  Loss: 0.6889  |  Score: 70.65 [%]  |  Seq Length: 256.0
[2024-09-20 05:34:58,183][root][INFO] - Step: 36000/39633  |  Loss: 0.6790  |  Score: 71.00 [%]  |  Seq Length: 256.0
[2024-09-20 05:37:42,241][root][INFO] - Step: 36400/39633  |  Loss: 0.6825  |  Score: 70.62 [%]  |  Seq Length: 256.0
[2024-09-20 05:40:26,060][root][INFO] - Step: 36800/39633  |  Loss: 0.6816  |  Score: 70.83 [%]  |  Seq Length: 256.0
[2024-09-20 05:43:09,989][root][INFO] - Step: 37200/39633  |  Loss: 0.6783  |  Score: 71.13 [%]  |  Seq Length: 256.0
[2024-09-20 05:45:53,901][root][INFO] - Step: 37600/39633  |  Loss: 0.6798  |  Score: 71.05 [%]  |  Seq Length: 256.0
[2024-09-20 05:48:38,084][root][INFO] - Step: 38000/39633  |  Loss: 0.6756  |  Score: 71.05 [%]  |  Seq Length: 256.0
[2024-09-20 05:51:22,217][root][INFO] - Step: 38400/39633  |  Loss: 0.6849  |  Score: 70.38 [%]  |  Seq Length: 256.0
[2024-09-20 05:54:06,235][root][INFO] - Step: 38800/39633  |  Loss: 0.6809  |  Score: 70.70 [%]  |  Seq Length: 256.0
[2024-09-20 05:56:50,294][root][INFO] - Step: 39200/39633  |  Loss: 0.6797  |  Score: 70.58 [%]  |  Seq Length: 256.0
[2024-09-20 05:59:34,205][root][INFO] - Step: 39600/39633  |  Loss: 0.6929  |  Score: 70.42 [%]  |  Seq Length: 256.0
[2024-09-20 05:59:47,822][root][INFO] - Step: 39633/39633  |  Loss: 0.6657  |  Score: 71.78 [%]  |  Seq Length: 256.0
[2024-09-20 05:59:53,397][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-20 05:59:53,397][root][INFO] - Score: 66.11 [%]  |  Evaluation Time: 5.57 [s]
[2024-09-20 06:00:03,535][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-20 06:00:03,535][root][INFO] - Score: 67.15 [%]  |  Evaluation Time: 10.14 [s]
[2024-09-20 06:00:03,536][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-20 06:00:03,536][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-20 06:00:03,536][root][INFO] - - Epoch: 3
[2024-09-20 06:00:03,536][root][INFO] - - DEV score: 66.11 [%]
[2024-09-20 06:00:03,536][root][INFO] - - TEST score: 67.15 [%]
[2024-09-20 06:00:03,537][root][INFO] - Fine-tuning is done!
[2024-09-20 15:35:14,446][root][INFO] - 

[2024-09-20 15:35:14,446][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-20 15:35:14,446][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs
[2024-09-20 15:35:14,446][root][INFO] - 

[2024-09-20 15:35:14,446][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 4, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-20 15:37:39,735][root][INFO] - 

[2024-09-20 15:37:39,736][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-20 15:37:39,736][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs
[2024-09-20 15:37:39,736][root][INFO] - 

[2024-09-20 15:37:39,736][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 4, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-20 15:37:49,450][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-20 15:37:49,450][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-20 15:37:49,451][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-20 15:37:49,451][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-20 15:37:49,452][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-20 15:37:49,452][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-20 15:37:49,453][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-20 15:37:49,453][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-20 15:37:49,453][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-20 15:37:49,454][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-20 15:37:49,454][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-20 15:37:49,455][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-20 15:37:49,455][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-20 15:37:49,455][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-20 15:37:49,456][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-20 15:37:49,456][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-20 15:37:49,457][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-20 15:37:49,457][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-20 15:37:49,458][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-20 15:37:49,458][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-20 15:37:49,458][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-20 15:37:49,459][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-20 15:37:49,459][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-20 15:37:49,460][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-20 15:37:49,461][root][INFO] - Trainable params: 1769472 || all params: 126935808 || trainable: 1.39 %
[2024-09-20 15:37:49,835][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-20 15:37:56,447][root][INFO] - 

[2024-09-20 15:37:56,447][root][INFO] - ========== Fine-tuning on KorNLI ==========
[2024-09-20 15:37:56,448][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-20 15:37:56,457][root][INFO] - vocab size              : 51200
[2024-09-20 15:37:56,458][root][INFO] - device                  : gpu
[2024-09-20 15:37:56,458][root][INFO] - random seed             : 42
[2024-09-20 15:37:56,458][root][INFO] - train data size         : 211376
[2024-09-20 15:37:56,458][root][INFO] - max epochs              : 3
[2024-09-20 15:37:56,458][root][INFO] - total steps             : 39633
[2024-09-20 15:37:56,458][root][INFO] - warmup steps            : 3963
[2024-09-20 15:37:56,458][root][INFO] - batch size              : 64
[2024-09-20 15:37:56,458][root][INFO] - accumulation steps      : 4
[2024-09-20 15:37:56,458][root][INFO] - optimizer               : adamwscale
[2024-09-20 15:37:56,458][root][INFO] - lr_scheduler            : cosine
[2024-09-20 15:37:56,459][root][INFO] - learning rate           : 0.01
[2024-09-20 15:37:56,459][root][INFO] - max length              : 256

[2024-09-20 15:37:56,459][root][INFO] - LoRA Configuration
[2024-09-20 15:37:56,459][root][INFO] - ㄴ r                    : 32
[2024-09-20 15:37:56,459][root][INFO] - ㄴ alpha                : 128
[2024-09-20 15:37:56,459][root][INFO] - ㄴ dropout              : 0.03

[2024-09-20 15:37:56,459][root][INFO] - 

[2024-09-20 15:37:56,459][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs
[2024-09-20 15:37:56,459][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs/ckpt
[2024-09-20 15:37:56,459][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs/tb
[2024-09-20 15:37:56,459][root][INFO] - * tb interval           : 400

[2024-09-20 15:37:56,460][root][INFO] - 

[2024-09-20 15:37:56,460][root][INFO] - Start the Training !
[2024-09-20 15:37:56,463][root][INFO] - 
[1/ 3 Epoch]
[2024-09-20 15:38:24,440][root][INFO] - 

[2024-09-20 15:38:24,441][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-20 15:38:24,441][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_4s_0.0001lr_42rs
[2024-09-20 15:38:24,441][root][INFO] - 

[2024-09-20 15:38:24,441][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.0001, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 4, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_4s_0.0001lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_4s_0.0001lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_4s_0.0001lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-20 15:38:52,329][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-20 15:38:58,425][root][INFO] - 

[2024-09-20 15:38:58,425][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-20 15:38:58,426][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-20 15:38:58,434][root][INFO] - vocab size              : 51200
[2024-09-20 15:38:58,434][root][INFO] - device                  : gpu
[2024-09-20 15:38:58,434][root][INFO] - random seed             : 42
[2024-09-20 15:38:58,434][root][INFO] - train data size         : 28864
[2024-09-20 15:38:58,434][root][INFO] - max epochs              : 5
[2024-09-20 15:38:58,434][root][INFO] - total steps             : 9020
[2024-09-20 15:38:58,434][root][INFO] - warmup steps            : 902
[2024-09-20 15:38:58,435][root][INFO] - batch size              : 64
[2024-09-20 15:38:58,435][root][INFO] - accumulation steps      : 4
[2024-09-20 15:38:58,435][root][INFO] - optimizer               : adamwscale
[2024-09-20 15:38:58,435][root][INFO] - lr_scheduler            : cosine
[2024-09-20 15:38:58,435][root][INFO] - learning rate           : 0.0001
[2024-09-20 15:38:58,435][root][INFO] - max length              : 256

[2024-09-20 15:38:58,435][root][INFO] - 

[2024-09-20 15:38:58,435][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_4s_0.0001lr_42rs
[2024-09-20 15:38:58,435][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_4s_0.0001lr_42rs/ckpt
[2024-09-20 15:38:58,435][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_4s_0.0001lr_42rs/tb
[2024-09-20 15:38:58,435][root][INFO] - * tb interval           : 100

[2024-09-20 15:38:58,435][root][INFO] - 

[2024-09-20 15:38:58,436][root][INFO] - Start the Training !
[2024-09-20 15:38:58,438][root][INFO] - 
[1/ 5 Epoch]
[2024-09-20 15:39:53,907][root][INFO] - 

[2024-09-20 15:39:53,907][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-20 15:39:53,907][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_8s_0.0001lr_42rs
[2024-09-20 15:39:53,907][root][INFO] - 

[2024-09-20 15:39:53,908][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.0001, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 8, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_8s_0.0001lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_8s_0.0001lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_8s_0.0001lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-20 15:40:14,434][root][INFO] - 

[2024-09-20 15:40:14,434][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-20 15:40:14,434][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.0001lr_42rs
[2024-09-20 15:40:14,434][root][INFO] - 

[2024-09-20 15:40:14,435][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.0001, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 4, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.0001lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.0001lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.0001lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-20 15:40:16,689][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-20 15:40:16,690][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-20 15:40:16,690][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-20 15:40:16,691][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-20 15:40:16,691][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-20 15:40:16,691][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-20 15:40:16,692][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-20 15:40:16,692][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-20 15:40:16,693][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-20 15:40:16,693][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-20 15:40:16,694][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-20 15:40:16,694][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-20 15:40:16,695][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-20 15:40:16,695][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-20 15:40:16,696][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-20 15:40:16,696][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-20 15:40:16,697][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-20 15:40:16,698][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-20 15:40:16,698][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-20 15:40:16,698][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-20 15:40:16,699][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-20 15:40:16,700][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-20 15:40:16,700][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-20 15:40:16,701][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-20 15:40:16,702][root][INFO] - Trainable params: 1769472 || all params: 126935808 || trainable: 1.39 %
[2024-09-20 15:40:16,708][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-20 15:40:16,816][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-20 15:40:16,818][root][INFO] - Trainable params: 8985600 || all params: 134151936 || trainable: 6.70 %
[2024-09-20 15:40:17,139][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-20 15:40:24,662][root][INFO] - 

[2024-09-20 15:40:24,662][root][INFO] - ========== Fine-tuning on KorNLI ==========
[2024-09-20 15:40:24,663][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-20 15:40:24,673][root][INFO] - vocab size              : 51200
[2024-09-20 15:40:24,673][root][INFO] - device                  : gpu
[2024-09-20 15:40:24,673][root][INFO] - random seed             : 42
[2024-09-20 15:40:24,673][root][INFO] - train data size         : 211376
[2024-09-20 15:40:24,673][root][INFO] - max epochs              : 3
[2024-09-20 15:40:24,673][root][INFO] - total steps             : 39633
[2024-09-20 15:40:24,673][root][INFO] - warmup steps            : 3963
[2024-09-20 15:40:24,673][root][INFO] - batch size              : 64
[2024-09-20 15:40:24,673][root][INFO] - accumulation steps      : 4
[2024-09-20 15:40:24,673][root][INFO] - optimizer               : adamwscale
[2024-09-20 15:40:24,674][root][INFO] - lr_scheduler            : cosine
[2024-09-20 15:40:24,674][root][INFO] - learning rate           : 0.01
[2024-09-20 15:40:24,674][root][INFO] - max length              : 256

[2024-09-20 15:40:24,674][root][INFO] - LoRA Configuration
[2024-09-20 15:40:24,674][root][INFO] - ㄴ r                    : 32
[2024-09-20 15:40:24,674][root][INFO] - ㄴ alpha                : 128
[2024-09-20 15:40:24,674][root][INFO] - ㄴ dropout              : 0.03

[2024-09-20 15:40:24,674][root][INFO] - KOMBO Configuration
[2024-09-20 15:40:24,674][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-20 15:40:24,674][root][INFO] - ㄴ reducer              : linear
[2024-09-20 15:40:24,674][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-20 15:40:24,675][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-20 15:40:24,675][root][INFO] - ㄴ do_combination       : True
[2024-09-20 15:40:24,675][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-20 15:40:24,675][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-20 15:40:24,675][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-20 15:40:24,675][root][INFO] -   ㄴ add_lora           : False
[2024-09-20 15:40:24,675][root][INFO] - 

[2024-09-20 15:40:24,675][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs
[2024-09-20 15:40:24,675][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs/ckpt
[2024-09-20 15:40:24,675][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs/tb
[2024-09-20 15:40:24,676][root][INFO] - * tb interval           : 400

[2024-09-20 15:40:24,676][root][INFO] - 

[2024-09-20 15:40:24,676][root][INFO] - Start the Training !
[2024-09-20 15:40:24,679][root][INFO] - 
[1/ 3 Epoch]
[2024-09-20 15:43:37,830][root][INFO] - 

[2024-09-20 15:43:37,830][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-20 15:43:37,830][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs
[2024-09-20 15:43:37,830][root][INFO] - 

[2024-09-20 15:43:37,830][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 2, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-20 15:45:41,195][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-20 15:45:41,196][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-20 15:45:41,197][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-20 15:45:41,197][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-20 15:45:41,198][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-20 15:45:41,199][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-20 15:45:41,199][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-20 15:45:41,200][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-20 15:45:41,201][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-20 15:45:41,201][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-20 15:45:41,202][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-20 15:45:41,203][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-20 15:45:41,203][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-20 15:45:41,204][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-20 15:45:41,205][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-20 15:45:41,205][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-20 15:45:41,206][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-20 15:45:41,207][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-20 15:45:41,207][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-20 15:45:41,208][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-20 15:45:41,209][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-20 15:45:41,210][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-20 15:45:41,210][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-20 15:45:41,211][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-20 15:45:41,213][root][INFO] - Trainable params: 1769472 || all params: 126935808 || trainable: 1.39 %
[2024-09-20 15:45:41,219][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-20 15:45:41,326][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-20 15:45:41,328][root][INFO] - Trainable params: 8985600 || all params: 134151936 || trainable: 6.70 %
[2024-09-20 15:45:41,848][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-20 15:45:49,393][root][INFO] - 

[2024-09-20 15:45:49,393][root][INFO] - ========== Fine-tuning on KorNLI ==========
[2024-09-20 15:45:49,393][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-20 15:45:49,401][root][INFO] - vocab size              : 51200
[2024-09-20 15:45:49,401][root][INFO] - device                  : gpu
[2024-09-20 15:45:49,401][root][INFO] - random seed             : 42
[2024-09-20 15:45:49,402][root][INFO] - train data size         : 422752
[2024-09-20 15:45:49,402][root][INFO] - max epochs              : 3
[2024-09-20 15:45:49,402][root][INFO] - total steps             : 39633
[2024-09-20 15:45:49,402][root][INFO] - warmup steps            : 3963
[2024-09-20 15:45:49,402][root][INFO] - batch size              : 64
[2024-09-20 15:45:49,402][root][INFO] - accumulation steps      : 2
[2024-09-20 15:45:49,402][root][INFO] - optimizer               : adamwscale
[2024-09-20 15:45:49,402][root][INFO] - lr_scheduler            : cosine
[2024-09-20 15:45:49,402][root][INFO] - learning rate           : 0.01
[2024-09-20 15:45:49,402][root][INFO] - max length              : 256

[2024-09-20 15:45:49,402][root][INFO] - LoRA Configuration
[2024-09-20 15:45:49,403][root][INFO] - ㄴ r                    : 32
[2024-09-20 15:45:49,403][root][INFO] - ㄴ alpha                : 128
[2024-09-20 15:45:49,403][root][INFO] - ㄴ dropout              : 0.03

[2024-09-20 15:45:49,403][root][INFO] - KOMBO Configuration
[2024-09-20 15:45:49,403][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-20 15:45:49,403][root][INFO] - ㄴ reducer              : linear
[2024-09-20 15:45:49,403][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-20 15:45:49,403][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-20 15:45:49,403][root][INFO] - ㄴ do_combination       : True
[2024-09-20 15:45:49,403][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-20 15:45:49,404][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-20 15:45:49,404][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-20 15:45:49,404][root][INFO] -   ㄴ add_lora           : False
[2024-09-20 15:45:49,404][root][INFO] - 

[2024-09-20 15:45:49,404][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs
[2024-09-20 15:45:49,404][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/ckpt
[2024-09-20 15:45:49,404][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/tb
[2024-09-20 15:45:49,404][root][INFO] - * tb interval           : 400

[2024-09-20 15:45:49,404][root][INFO] - 

[2024-09-20 15:45:49,404][root][INFO] - Start the Training !
[2024-09-20 15:45:49,407][root][INFO] - 
[1/ 3 Epoch]
[2024-09-20 15:49:40,071][root][INFO] - Step: 400/39633  |  Loss: 0.9909  |  Score: 49.91 [%]  |  Seq Length: 256.0
[2024-09-20 15:53:29,251][root][INFO] - Step: 800/39633  |  Loss: 0.8547  |  Score: 61.30 [%]  |  Seq Length: 256.0
[2024-09-20 15:57:19,249][root][INFO] - Step: 1200/39633  |  Loss: 0.8124  |  Score: 63.97 [%]  |  Seq Length: 256.0
[2024-09-20 16:01:09,510][root][INFO] - Step: 1600/39633  |  Loss: 0.7795  |  Score: 65.90 [%]  |  Seq Length: 256.0
[2024-09-20 16:04:59,270][root][INFO] - Step: 2000/39633  |  Loss: 0.7639  |  Score: 66.91 [%]  |  Seq Length: 256.0
[2024-09-20 16:08:47,954][root][INFO] - Step: 2400/39633  |  Loss: 0.7437  |  Score: 67.61 [%]  |  Seq Length: 256.0
[2024-09-20 16:12:36,422][root][INFO] - Step: 2800/39633  |  Loss: 0.7395  |  Score: 68.15 [%]  |  Seq Length: 256.0
[2024-09-20 16:16:24,676][root][INFO] - Step: 3200/39633  |  Loss: 0.7348  |  Score: 68.29 [%]  |  Seq Length: 256.0
[2024-09-20 16:20:12,495][root][INFO] - Step: 3600/39633  |  Loss: 0.7153  |  Score: 69.62 [%]  |  Seq Length: 256.0
[2024-09-20 16:24:00,940][root][INFO] - Step: 4000/39633  |  Loss: 0.7087  |  Score: 69.56 [%]  |  Seq Length: 256.0
[2024-09-20 16:27:49,823][root][INFO] - Step: 4400/39633  |  Loss: 0.7117  |  Score: 69.73 [%]  |  Seq Length: 256.0
[2024-09-20 16:31:37,976][root][INFO] - Step: 4800/39633  |  Loss: 0.6993  |  Score: 70.09 [%]  |  Seq Length: 256.0
[2024-09-20 16:35:26,485][root][INFO] - Step: 5200/39633  |  Loss: 0.6967  |  Score: 70.45 [%]  |  Seq Length: 256.0
[2024-09-20 16:39:14,610][root][INFO] - Step: 5600/39633  |  Loss: 0.6924  |  Score: 70.92 [%]  |  Seq Length: 256.0
[2024-09-20 16:43:03,247][root][INFO] - Step: 6000/39633  |  Loss: 0.6778  |  Score: 71.41 [%]  |  Seq Length: 256.0
[2024-09-20 16:46:51,632][root][INFO] - Step: 6400/39633  |  Loss: 0.6731  |  Score: 71.46 [%]  |  Seq Length: 256.0
[2024-09-20 16:50:39,643][root][INFO] - Step: 6800/39633  |  Loss: 0.6684  |  Score: 71.92 [%]  |  Seq Length: 256.0
[2024-09-20 16:54:28,377][root][INFO] - Step: 7200/39633  |  Loss: 0.6644  |  Score: 72.19 [%]  |  Seq Length: 256.0
[2024-09-20 16:58:16,820][root][INFO] - Step: 7600/39633  |  Loss: 0.6694  |  Score: 71.67 [%]  |  Seq Length: 256.0
[2024-09-20 17:02:06,516][root][INFO] - Step: 8000/39633  |  Loss: 0.6708  |  Score: 71.71 [%]  |  Seq Length: 256.0
[2024-09-20 17:05:54,688][root][INFO] - Step: 8400/39633  |  Loss: 0.6598  |  Score: 72.10 [%]  |  Seq Length: 256.0
[2024-09-20 17:09:43,312][root][INFO] - Step: 8800/39633  |  Loss: 0.6755  |  Score: 71.41 [%]  |  Seq Length: 256.0
[2024-09-20 17:13:32,075][root][INFO] - Step: 9200/39633  |  Loss: 0.6558  |  Score: 72.20 [%]  |  Seq Length: 256.0
[2024-09-20 17:17:20,879][root][INFO] - Step: 9600/39633  |  Loss: 0.6523  |  Score: 72.46 [%]  |  Seq Length: 256.0
[2024-09-20 17:21:09,380][root][INFO] - Step: 10000/39633  |  Loss: 0.6514  |  Score: 72.86 [%]  |  Seq Length: 256.0
[2024-09-20 17:24:59,237][root][INFO] - Step: 10400/39633  |  Loss: 0.6411  |  Score: 73.09 [%]  |  Seq Length: 256.0
[2024-09-20 17:28:48,412][root][INFO] - Step: 10800/39633  |  Loss: 0.6417  |  Score: 73.30 [%]  |  Seq Length: 256.0
[2024-09-20 17:32:37,432][root][INFO] - Step: 11200/39633  |  Loss: 0.6495  |  Score: 72.86 [%]  |  Seq Length: 256.0
[2024-09-20 17:36:26,635][root][INFO] - Step: 11600/39633  |  Loss: 0.6456  |  Score: 73.27 [%]  |  Seq Length: 256.0
[2024-09-20 17:40:14,903][root][INFO] - Step: 12000/39633  |  Loss: 0.6459  |  Score: 73.17 [%]  |  Seq Length: 256.0
[2024-09-20 17:44:03,215][root][INFO] - Step: 12400/39633  |  Loss: 0.6400  |  Score: 73.46 [%]  |  Seq Length: 256.0
[2024-09-20 17:47:51,976][root][INFO] - Step: 12800/39633  |  Loss: 0.6414  |  Score: 73.21 [%]  |  Seq Length: 256.0
[2024-09-20 17:51:05,652][root][INFO] - 

[2024-09-20 17:51:05,652][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-20 17:51:05,652][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs
[2024-09-20 17:51:05,652][root][INFO] - 

[2024-09-20 17:51:05,652][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 4, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_4s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-20 17:51:31,707][root][INFO] - 

[2024-09-20 17:51:31,708][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-20 17:51:31,708][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs
[2024-09-20 17:51:31,708][root][INFO] - 

[2024-09-20 17:51:31,708][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 2, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-20 17:51:40,600][root][INFO] - Step: 13200/39633  |  Loss: 0.6371  |  Score: 73.43 [%]  |  Seq Length: 256.0
[2024-09-20 17:51:47,067][root][INFO] - Step: 13211/39633  |  Loss: 0.6631  |  Score: 71.16 [%]  |  Seq Length: 256.0
[2024-09-20 17:51:55,986][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-20 17:51:55,986][root][INFO] - Score: 69.95 [%]  |  Evaluation Time: 8.91 [s]
[2024-09-20 17:52:12,427][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-20 17:52:12,427][root][INFO] - Score: 70.62 [%]  |  Evaluation Time: 16.44 [s]
[2024-09-20 17:52:12,428][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-20 17:52:12,429][root][INFO] - 
[2/ 3 Epoch]
[2024-09-20 17:53:36,161][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-20 17:53:36,162][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-20 17:53:36,162][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-20 17:53:36,163][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-20 17:53:36,164][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-20 17:53:36,164][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-20 17:53:36,165][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-20 17:53:36,165][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-20 17:53:36,166][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-20 17:53:36,166][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-20 17:53:36,167][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-20 17:53:36,167][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-20 17:53:36,168][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-20 17:53:36,169][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-20 17:53:36,169][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-20 17:53:36,170][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-20 17:53:36,170][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-20 17:53:36,171][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-20 17:53:36,171][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-20 17:53:36,172][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-20 17:53:36,173][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-20 17:53:36,173][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-20 17:53:36,174][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-20 17:53:36,174][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-20 17:53:36,176][root][INFO] - Trainable params: 1769472 || all params: 126935808 || trainable: 1.39 %
[2024-09-20 17:53:36,606][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-20 17:53:40,698][root][INFO] - 

[2024-09-20 17:53:40,699][root][INFO] - ========== Fine-tuning on KorNLI ==========
[2024-09-20 17:53:40,699][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-20 17:53:40,706][root][INFO] - vocab size              : 51200
[2024-09-20 17:53:40,707][root][INFO] - device                  : gpu
[2024-09-20 17:53:40,707][root][INFO] - random seed             : 42
[2024-09-20 17:53:40,707][root][INFO] - train data size         : 422752
[2024-09-20 17:53:40,707][root][INFO] - max epochs              : 3
[2024-09-20 17:53:40,707][root][INFO] - total steps             : 39633
[2024-09-20 17:53:40,707][root][INFO] - warmup steps            : 3963
[2024-09-20 17:53:40,707][root][INFO] - batch size              : 64
[2024-09-20 17:53:40,707][root][INFO] - accumulation steps      : 2
[2024-09-20 17:53:40,707][root][INFO] - optimizer               : adamwscale
[2024-09-20 17:53:40,707][root][INFO] - lr_scheduler            : cosine
[2024-09-20 17:53:40,707][root][INFO] - learning rate           : 0.01
[2024-09-20 17:53:40,708][root][INFO] - max length              : 256

[2024-09-20 17:53:40,708][root][INFO] - LoRA Configuration
[2024-09-20 17:53:40,708][root][INFO] - ㄴ r                    : 32
[2024-09-20 17:53:40,708][root][INFO] - ㄴ alpha                : 128
[2024-09-20 17:53:40,708][root][INFO] - ㄴ dropout              : 0.03

[2024-09-20 17:53:40,708][root][INFO] - 

[2024-09-20 17:53:40,708][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs
[2024-09-20 17:53:40,708][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/ckpt
[2024-09-20 17:53:40,708][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/tb
[2024-09-20 17:53:40,708][root][INFO] - * tb interval           : 400

[2024-09-20 17:53:40,708][root][INFO] - 

[2024-09-20 17:53:40,708][root][INFO] - Start the Training !
[2024-09-20 17:53:40,711][root][INFO] - 
[1/ 3 Epoch]
[2024-09-20 17:55:55,805][root][INFO] - Step: 13600/39633  |  Loss: 0.6066  |  Score: 75.40 [%]  |  Seq Length: 256.0
[2024-09-20 17:56:18,215][root][INFO] - Step: 400/39633  |  Loss: 0.9893  |  Score: 49.87 [%]  |  Seq Length: 256.0
[2024-09-20 17:58:52,926][root][INFO] - Step: 800/39633  |  Loss: 0.8463  |  Score: 61.90 [%]  |  Seq Length: 256.0
[2024-09-20 17:59:44,350][root][INFO] - Step: 14000/39633  |  Loss: 0.6092  |  Score: 74.68 [%]  |  Seq Length: 256.0
[2024-09-20 18:01:26,955][root][INFO] - Step: 1200/39633  |  Loss: 0.8028  |  Score: 64.42 [%]  |  Seq Length: 256.0
[2024-09-20 18:03:33,118][root][INFO] - Step: 14400/39633  |  Loss: 0.6230  |  Score: 74.20 [%]  |  Seq Length: 256.0
[2024-09-20 18:04:00,937][root][INFO] - Step: 1600/39633  |  Loss: 0.7852  |  Score: 65.62 [%]  |  Seq Length: 256.0
[2024-09-20 18:06:34,791][root][INFO] - Step: 2000/39633  |  Loss: 0.7646  |  Score: 66.96 [%]  |  Seq Length: 256.0
[2024-09-20 18:07:21,528][root][INFO] - Step: 14800/39633  |  Loss: 0.6150  |  Score: 74.68 [%]  |  Seq Length: 256.0
[2024-09-20 18:09:08,802][root][INFO] - Step: 2400/39633  |  Loss: 0.7484  |  Score: 67.52 [%]  |  Seq Length: 256.0
[2024-09-20 18:11:10,043][root][INFO] - Step: 15200/39633  |  Loss: 0.6124  |  Score: 74.47 [%]  |  Seq Length: 256.0
[2024-09-20 18:11:42,728][root][INFO] - Step: 2800/39633  |  Loss: 0.7329  |  Score: 68.04 [%]  |  Seq Length: 256.0
[2024-09-20 18:14:16,836][root][INFO] - Step: 3200/39633  |  Loss: 0.7344  |  Score: 68.72 [%]  |  Seq Length: 256.0
[2024-09-20 18:14:59,285][root][INFO] - Step: 15600/39633  |  Loss: 0.6103  |  Score: 74.82 [%]  |  Seq Length: 256.0
[2024-09-20 18:16:50,833][root][INFO] - Step: 3600/39633  |  Loss: 0.7124  |  Score: 69.69 [%]  |  Seq Length: 256.0
[2024-09-20 18:18:47,328][root][INFO] - Step: 16000/39633  |  Loss: 0.6001  |  Score: 75.41 [%]  |  Seq Length: 256.0
[2024-09-20 18:19:24,791][root][INFO] - Step: 4000/39633  |  Loss: 0.7018  |  Score: 70.12 [%]  |  Seq Length: 256.0
[2024-09-20 18:21:58,835][root][INFO] - Step: 4400/39633  |  Loss: 0.7123  |  Score: 69.73 [%]  |  Seq Length: 256.0
[2024-09-20 18:22:35,302][root][INFO] - Step: 16400/39633  |  Loss: 0.6000  |  Score: 75.28 [%]  |  Seq Length: 256.0
[2024-09-20 18:24:32,770][root][INFO] - Step: 4800/39633  |  Loss: 0.6975  |  Score: 70.57 [%]  |  Seq Length: 256.0
[2024-09-20 18:26:23,765][root][INFO] - Step: 16800/39633  |  Loss: 0.6086  |  Score: 74.89 [%]  |  Seq Length: 256.0
[2024-09-20 18:27:06,700][root][INFO] - Step: 5200/39633  |  Loss: 0.6966  |  Score: 70.54 [%]  |  Seq Length: 256.0
[2024-09-20 18:29:40,803][root][INFO] - Step: 5600/39633  |  Loss: 0.6751  |  Score: 71.36 [%]  |  Seq Length: 256.0
[2024-09-20 18:30:12,015][root][INFO] - Step: 17200/39633  |  Loss: 0.5982  |  Score: 75.58 [%]  |  Seq Length: 256.0
[2024-09-20 18:32:14,938][root][INFO] - Step: 6000/39633  |  Loss: 0.6830  |  Score: 71.39 [%]  |  Seq Length: 256.0
[2024-09-20 18:34:00,326][root][INFO] - Step: 17600/39633  |  Loss: 0.6026  |  Score: 75.12 [%]  |  Seq Length: 256.0
[2024-09-20 18:34:49,056][root][INFO] - Step: 6400/39633  |  Loss: 0.6785  |  Score: 71.46 [%]  |  Seq Length: 256.0
[2024-09-20 18:37:23,281][root][INFO] - Step: 6800/39633  |  Loss: 0.6698  |  Score: 71.76 [%]  |  Seq Length: 256.0
[2024-09-20 18:37:49,015][root][INFO] - Step: 18000/39633  |  Loss: 0.6000  |  Score: 75.41 [%]  |  Seq Length: 256.0
[2024-09-20 18:39:57,430][root][INFO] - Step: 7200/39633  |  Loss: 0.6798  |  Score: 71.37 [%]  |  Seq Length: 256.0
[2024-09-20 18:41:38,457][root][INFO] - Step: 18400/39633  |  Loss: 0.5971  |  Score: 75.79 [%]  |  Seq Length: 256.0
[2024-09-20 18:42:31,467][root][INFO] - Step: 7600/39633  |  Loss: 0.6704  |  Score: 71.79 [%]  |  Seq Length: 256.0
[2024-09-20 18:45:05,259][root][INFO] - Step: 8000/39633  |  Loss: 0.6697  |  Score: 71.84 [%]  |  Seq Length: 256.0
[2024-09-20 18:45:26,574][root][INFO] - Step: 18800/39633  |  Loss: 0.5907  |  Score: 75.90 [%]  |  Seq Length: 256.0
[2024-09-20 18:47:39,064][root][INFO] - Step: 8400/39633  |  Loss: 0.6789  |  Score: 71.35 [%]  |  Seq Length: 256.0
[2024-09-20 18:49:14,478][root][INFO] - Step: 19200/39633  |  Loss: 0.5921  |  Score: 75.71 [%]  |  Seq Length: 256.0
[2024-09-20 18:50:12,831][root][INFO] - Step: 8800/39633  |  Loss: 0.6630  |  Score: 72.40 [%]  |  Seq Length: 256.0
[2024-09-20 18:52:46,465][root][INFO] - Step: 9200/39633  |  Loss: 0.6588  |  Score: 72.41 [%]  |  Seq Length: 256.0
[2024-09-20 18:53:02,775][root][INFO] - Step: 19600/39633  |  Loss: 0.5955  |  Score: 75.58 [%]  |  Seq Length: 256.0
[2024-09-20 18:55:20,138][root][INFO] - Step: 9600/39633  |  Loss: 0.6590  |  Score: 72.07 [%]  |  Seq Length: 256.0
[2024-09-20 18:56:50,556][root][INFO] - Step: 20000/39633  |  Loss: 0.5992  |  Score: 75.13 [%]  |  Seq Length: 256.0
[2024-09-20 18:57:53,836][root][INFO] - Step: 10000/39633  |  Loss: 0.6551  |  Score: 72.48 [%]  |  Seq Length: 256.0
[2024-09-20 19:00:27,513][root][INFO] - Step: 10400/39633  |  Loss: 0.6550  |  Score: 72.65 [%]  |  Seq Length: 256.0
[2024-09-20 19:00:38,755][root][INFO] - Step: 20400/39633  |  Loss: 0.5935  |  Score: 75.68 [%]  |  Seq Length: 256.0
[2024-09-20 19:03:01,190][root][INFO] - Step: 10800/39633  |  Loss: 0.6490  |  Score: 72.77 [%]  |  Seq Length: 256.0
[2024-09-20 19:04:26,454][root][INFO] - Step: 20800/39633  |  Loss: 0.5872  |  Score: 75.71 [%]  |  Seq Length: 256.0
[2024-09-20 19:05:34,940][root][INFO] - Step: 11200/39633  |  Loss: 0.6465  |  Score: 73.01 [%]  |  Seq Length: 256.0
[2024-09-20 19:08:08,704][root][INFO] - Step: 11600/39633  |  Loss: 0.6447  |  Score: 73.30 [%]  |  Seq Length: 256.0
[2024-09-20 19:08:13,728][root][INFO] - Step: 21200/39633  |  Loss: 0.5952  |  Score: 75.51 [%]  |  Seq Length: 256.0
[2024-09-20 19:10:42,627][root][INFO] - Step: 12000/39633  |  Loss: 0.6428  |  Score: 73.49 [%]  |  Seq Length: 256.0
[2024-09-20 19:12:01,600][root][INFO] - Step: 21600/39633  |  Loss: 0.5911  |  Score: 76.21 [%]  |  Seq Length: 256.0
[2024-09-20 19:13:16,454][root][INFO] - Step: 12400/39633  |  Loss: 0.6404  |  Score: 73.26 [%]  |  Seq Length: 256.0
[2024-09-20 19:15:49,353][root][INFO] - Step: 22000/39633  |  Loss: 0.5819  |  Score: 76.26 [%]  |  Seq Length: 256.0
[2024-09-20 19:15:50,274][root][INFO] - Step: 12800/39633  |  Loss: 0.6384  |  Score: 73.63 [%]  |  Seq Length: 256.0
[2024-09-20 19:18:23,976][root][INFO] - Step: 13200/39633  |  Loss: 0.6387  |  Score: 73.64 [%]  |  Seq Length: 256.0
[2024-09-20 19:18:28,282][root][INFO] - Step: 13211/39633  |  Loss: 0.6513  |  Score: 73.82 [%]  |  Seq Length: 256.0
[2024-09-20 19:18:33,332][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-20 19:18:33,332][root][INFO] - Score: 72.16 [%]  |  Evaluation Time: 5.05 [s]
[2024-09-20 19:18:42,792][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-20 19:18:42,792][root][INFO] - Score: 71.43 [%]  |  Evaluation Time: 9.46 [s]
[2024-09-20 19:18:42,793][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-20 19:18:42,794][root][INFO] - 
[2/ 3 Epoch]
[2024-09-20 19:19:36,424][root][INFO] - Step: 22400/39633  |  Loss: 0.5789  |  Score: 76.21 [%]  |  Seq Length: 256.0
[2024-09-20 19:21:12,880][root][INFO] - Step: 13600/39633  |  Loss: 0.6213  |  Score: 74.24 [%]  |  Seq Length: 256.0
[2024-09-20 19:23:24,424][root][INFO] - Step: 22800/39633  |  Loss: 0.5763  |  Score: 76.36 [%]  |  Seq Length: 256.0
[2024-09-20 19:23:46,644][root][INFO] - Step: 14000/39633  |  Loss: 0.6103  |  Score: 74.63 [%]  |  Seq Length: 256.0
[2024-09-20 19:26:20,533][root][INFO] - Step: 14400/39633  |  Loss: 0.6158  |  Score: 74.68 [%]  |  Seq Length: 256.0
[2024-09-20 19:27:12,283][root][INFO] - Step: 23200/39633  |  Loss: 0.5813  |  Score: 76.12 [%]  |  Seq Length: 256.0
[2024-09-20 19:28:54,398][root][INFO] - Step: 14800/39633  |  Loss: 0.6157  |  Score: 74.59 [%]  |  Seq Length: 256.0
[2024-09-20 19:30:59,863][root][INFO] - Step: 23600/39633  |  Loss: 0.5775  |  Score: 76.40 [%]  |  Seq Length: 256.0
[2024-09-20 19:31:28,371][root][INFO] - Step: 15200/39633  |  Loss: 0.6177  |  Score: 74.53 [%]  |  Seq Length: 256.0
[2024-09-20 19:34:02,395][root][INFO] - Step: 15600/39633  |  Loss: 0.6142  |  Score: 74.70 [%]  |  Seq Length: 256.0
[2024-09-20 19:34:47,946][root][INFO] - Step: 24000/39633  |  Loss: 0.5748  |  Score: 76.12 [%]  |  Seq Length: 256.0
[2024-09-20 19:36:36,334][root][INFO] - Step: 16000/39633  |  Loss: 0.6189  |  Score: 74.38 [%]  |  Seq Length: 256.0
[2024-09-20 19:38:35,194][root][INFO] - Step: 24400/39633  |  Loss: 0.5749  |  Score: 76.92 [%]  |  Seq Length: 256.0
[2024-09-20 19:39:10,306][root][INFO] - Step: 16400/39633  |  Loss: 0.6148  |  Score: 74.61 [%]  |  Seq Length: 256.0
[2024-09-20 19:41:44,313][root][INFO] - Step: 16800/39633  |  Loss: 0.6119  |  Score: 74.83 [%]  |  Seq Length: 256.0
[2024-09-20 19:42:23,862][root][INFO] - Step: 24800/39633  |  Loss: 0.5753  |  Score: 76.61 [%]  |  Seq Length: 256.0
[2024-09-20 19:44:18,320][root][INFO] - Step: 17200/39633  |  Loss: 0.6110  |  Score: 74.90 [%]  |  Seq Length: 256.0
[2024-09-20 19:46:12,182][root][INFO] - Step: 25200/39633  |  Loss: 0.5718  |  Score: 76.71 [%]  |  Seq Length: 256.0
[2024-09-20 19:46:52,364][root][INFO] - Step: 17600/39633  |  Loss: 0.6017  |  Score: 75.15 [%]  |  Seq Length: 256.0
[2024-09-20 19:49:26,464][root][INFO] - Step: 18000/39633  |  Loss: 0.6116  |  Score: 74.92 [%]  |  Seq Length: 256.0
[2024-09-20 19:50:00,343][root][INFO] - Step: 25600/39633  |  Loss: 0.5791  |  Score: 76.44 [%]  |  Seq Length: 256.0
[2024-09-20 19:52:00,446][root][INFO] - Step: 18400/39633  |  Loss: 0.6007  |  Score: 75.35 [%]  |  Seq Length: 256.0
[2024-09-20 19:53:48,547][root][INFO] - Step: 26000/39633  |  Loss: 0.5706  |  Score: 76.99 [%]  |  Seq Length: 256.0
[2024-09-20 19:54:34,311][root][INFO] - Step: 18800/39633  |  Loss: 0.6029  |  Score: 75.00 [%]  |  Seq Length: 256.0
[2024-09-20 19:57:08,320][root][INFO] - Step: 19200/39633  |  Loss: 0.6003  |  Score: 75.38 [%]  |  Seq Length: 256.0
[2024-09-20 19:57:36,380][root][INFO] - Step: 26400/39633  |  Loss: 0.5669  |  Score: 77.08 [%]  |  Seq Length: 256.0
[2024-09-20 19:57:49,007][root][INFO] - Step: 26422/39633  |  Loss: 0.5529  |  Score: 78.48 [%]  |  Seq Length: 256.0
[2024-09-20 19:57:57,658][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-20 19:57:57,658][root][INFO] - Score: 73.03 [%]  |  Evaluation Time: 8.65 [s]
[2024-09-20 19:58:14,298][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-20 19:58:14,298][root][INFO] - Score: 73.59 [%]  |  Evaluation Time: 16.64 [s]
[2024-09-20 19:58:14,301][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-20 19:58:14,304][root][INFO] - 
[3/ 3 Epoch]
[2024-09-20 19:59:42,347][root][INFO] - Step: 19600/39633  |  Loss: 0.6009  |  Score: 75.20 [%]  |  Seq Length: 256.0
[2024-09-20 20:01:49,928][root][INFO] - Step: 26800/39633  |  Loss: 0.5312  |  Score: 78.50 [%]  |  Seq Length: 256.0
[2024-09-20 20:02:16,379][root][INFO] - Step: 20000/39633  |  Loss: 0.6025  |  Score: 74.77 [%]  |  Seq Length: 256.0
[2024-09-20 20:04:50,414][root][INFO] - Step: 20400/39633  |  Loss: 0.5896  |  Score: 75.63 [%]  |  Seq Length: 256.0
[2024-09-20 20:05:38,048][root][INFO] - Step: 27200/39633  |  Loss: 0.5358  |  Score: 78.44 [%]  |  Seq Length: 256.0
[2024-09-20 20:07:24,469][root][INFO] - Step: 20800/39633  |  Loss: 0.5990  |  Score: 75.50 [%]  |  Seq Length: 256.0
[2024-09-20 20:09:25,636][root][INFO] - Step: 27600/39633  |  Loss: 0.5448  |  Score: 77.60 [%]  |  Seq Length: 256.0
[2024-09-20 20:09:58,491][root][INFO] - Step: 21200/39633  |  Loss: 0.5969  |  Score: 75.51 [%]  |  Seq Length: 256.0
[2024-09-20 20:12:32,598][root][INFO] - Step: 21600/39633  |  Loss: 0.5901  |  Score: 75.84 [%]  |  Seq Length: 256.0
[2024-09-20 20:13:14,012][root][INFO] - Step: 28000/39633  |  Loss: 0.5310  |  Score: 78.51 [%]  |  Seq Length: 256.0
[2024-09-20 20:15:06,637][root][INFO] - Step: 22000/39633  |  Loss: 0.5918  |  Score: 75.66 [%]  |  Seq Length: 256.0
[2024-09-20 20:17:02,364][root][INFO] - Step: 28400/39633  |  Loss: 0.5313  |  Score: 78.39 [%]  |  Seq Length: 256.0
[2024-09-20 20:17:40,766][root][INFO] - Step: 22400/39633  |  Loss: 0.5835  |  Score: 76.23 [%]  |  Seq Length: 256.0
[2024-09-20 20:20:14,711][root][INFO] - Step: 22800/39633  |  Loss: 0.5968  |  Score: 75.48 [%]  |  Seq Length: 256.0
[2024-09-20 20:20:50,987][root][INFO] - Step: 28800/39633  |  Loss: 0.5418  |  Score: 78.34 [%]  |  Seq Length: 256.0
[2024-09-20 20:22:49,135][root][INFO] - Step: 23200/39633  |  Loss: 0.5881  |  Score: 75.80 [%]  |  Seq Length: 256.0
[2024-09-20 20:24:39,252][root][INFO] - Step: 29200/39633  |  Loss: 0.5312  |  Score: 78.60 [%]  |  Seq Length: 256.0
[2024-09-20 20:25:23,270][root][INFO] - Step: 23600/39633  |  Loss: 0.5870  |  Score: 75.79 [%]  |  Seq Length: 256.0
[2024-09-20 20:27:57,284][root][INFO] - Step: 24000/39633  |  Loss: 0.5816  |  Score: 76.25 [%]  |  Seq Length: 256.0
[2024-09-20 20:28:27,365][root][INFO] - Step: 29600/39633  |  Loss: 0.5287  |  Score: 78.71 [%]  |  Seq Length: 256.0
[2024-09-20 20:30:31,304][root][INFO] - Step: 24400/39633  |  Loss: 0.5844  |  Score: 76.02 [%]  |  Seq Length: 256.0
[2024-09-20 20:32:15,748][root][INFO] - Step: 30000/39633  |  Loss: 0.5371  |  Score: 78.33 [%]  |  Seq Length: 256.0
[2024-09-20 20:33:05,393][root][INFO] - Step: 24800/39633  |  Loss: 0.5849  |  Score: 76.32 [%]  |  Seq Length: 256.0
[2024-09-20 20:35:39,500][root][INFO] - Step: 25200/39633  |  Loss: 0.5832  |  Score: 76.09 [%]  |  Seq Length: 256.0
[2024-09-20 20:36:04,135][root][INFO] - Step: 30400/39633  |  Loss: 0.5374  |  Score: 78.27 [%]  |  Seq Length: 256.0
[2024-09-20 20:38:13,561][root][INFO] - Step: 25600/39633  |  Loss: 0.5704  |  Score: 76.44 [%]  |  Seq Length: 256.0
[2024-09-20 20:39:51,464][root][INFO] - Step: 30800/39633  |  Loss: 0.5256  |  Score: 78.79 [%]  |  Seq Length: 256.0
[2024-09-20 20:40:47,648][root][INFO] - Step: 26000/39633  |  Loss: 0.5772  |  Score: 76.39 [%]  |  Seq Length: 256.0
[2024-09-20 20:43:21,710][root][INFO] - Step: 26400/39633  |  Loss: 0.5777  |  Score: 76.53 [%]  |  Seq Length: 256.0
[2024-09-20 20:43:30,296][root][INFO] - Step: 26422/39633  |  Loss: 0.5690  |  Score: 76.37 [%]  |  Seq Length: 256.0
[2024-09-20 20:43:35,463][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-20 20:43:35,464][root][INFO] - Score: 74.20 [%]  |  Evaluation Time: 5.16 [s]
[2024-09-20 20:43:40,215][root][INFO] - Step: 31200/39633  |  Loss: 0.5314  |  Score: 78.45 [%]  |  Seq Length: 256.0
[2024-09-20 20:43:45,023][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-20 20:43:45,024][root][INFO] - Score: 73.18 [%]  |  Evaluation Time: 9.56 [s]
[2024-09-20 20:43:45,025][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-20 20:43:45,026][root][INFO] - 
[3/ 3 Epoch]
[2024-09-20 20:46:11,027][root][INFO] - Step: 26800/39633  |  Loss: 0.5514  |  Score: 77.79 [%]  |  Seq Length: 256.0
[2024-09-20 20:47:27,905][root][INFO] - Step: 31600/39633  |  Loss: 0.5300  |  Score: 78.62 [%]  |  Seq Length: 256.0
[2024-09-20 20:48:45,054][root][INFO] - Step: 27200/39633  |  Loss: 0.5480  |  Score: 77.96 [%]  |  Seq Length: 256.0
[2024-09-20 20:51:16,706][root][INFO] - Step: 32000/39633  |  Loss: 0.5352  |  Score: 78.29 [%]  |  Seq Length: 256.0
[2024-09-20 20:51:19,068][root][INFO] - Step: 27600/39633  |  Loss: 0.5426  |  Score: 78.02 [%]  |  Seq Length: 256.0
[2024-09-20 20:53:53,075][root][INFO] - Step: 28000/39633  |  Loss: 0.5464  |  Score: 78.07 [%]  |  Seq Length: 256.0
[2024-09-20 20:55:04,761][root][INFO] - Step: 32400/39633  |  Loss: 0.5235  |  Score: 78.88 [%]  |  Seq Length: 256.0
[2024-09-20 20:56:27,172][root][INFO] - Step: 28400/39633  |  Loss: 0.5466  |  Score: 77.87 [%]  |  Seq Length: 256.0
[2024-09-20 20:58:49,673][root][INFO] - 

[2024-09-20 20:58:49,673][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-20 20:58:49,673][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.0001lr_42rs
[2024-09-20 20:58:49,673][root][INFO] - 

[2024-09-20 20:58:49,673][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.0001, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 2, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.0001lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.0001lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.0001lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-20 20:58:52,678][root][INFO] - Step: 32800/39633  |  Loss: 0.5311  |  Score: 78.55 [%]  |  Seq Length: 256.0
[2024-09-20 20:59:01,304][root][INFO] - Step: 28800/39633  |  Loss: 0.5455  |  Score: 77.91 [%]  |  Seq Length: 256.0
[2024-09-20 21:00:55,238][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-20 21:00:59,484][root][INFO] - 

[2024-09-20 21:00:59,485][root][INFO] - ========== Fine-tuning on KorNLI ==========
[2024-09-20 21:00:59,485][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-20 21:00:59,492][root][INFO] - vocab size              : 51200
[2024-09-20 21:00:59,493][root][INFO] - device                  : gpu
[2024-09-20 21:00:59,493][root][INFO] - random seed             : 42
[2024-09-20 21:00:59,493][root][INFO] - train data size         : 422752
[2024-09-20 21:00:59,493][root][INFO] - max epochs              : 3
[2024-09-20 21:00:59,493][root][INFO] - total steps             : 39633
[2024-09-20 21:00:59,493][root][INFO] - warmup steps            : 3963
[2024-09-20 21:00:59,493][root][INFO] - batch size              : 64
[2024-09-20 21:00:59,493][root][INFO] - accumulation steps      : 2
[2024-09-20 21:00:59,493][root][INFO] - optimizer               : adamwscale
[2024-09-20 21:00:59,493][root][INFO] - lr_scheduler            : cosine
[2024-09-20 21:00:59,493][root][INFO] - learning rate           : 0.0001
[2024-09-20 21:00:59,494][root][INFO] - max length              : 256

[2024-09-20 21:00:59,494][root][INFO] - 

[2024-09-20 21:00:59,494][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.0001lr_42rs
[2024-09-20 21:00:59,494][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.0001lr_42rs/ckpt
[2024-09-20 21:00:59,494][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.0001lr_42rs/tb
[2024-09-20 21:00:59,494][root][INFO] - * tb interval           : 400

[2024-09-20 21:00:59,494][root][INFO] - 

[2024-09-20 21:00:59,494][root][INFO] - Start the Training !
[2024-09-20 21:00:59,497][root][INFO] - 
[1/ 3 Epoch]
[2024-09-20 21:01:35,328][root][INFO] - Step: 29200/39633  |  Loss: 0.5389  |  Score: 77.97 [%]  |  Seq Length: 256.0
[2024-09-20 21:02:41,190][root][INFO] - Step: 33200/39633  |  Loss: 0.5273  |  Score: 78.64 [%]  |  Seq Length: 256.0
[2024-09-20 21:04:09,067][root][INFO] - Step: 400/39633  |  Loss: 1.0254  |  Score: 46.79 [%]  |  Seq Length: 256.0
[2024-09-20 21:04:09,537][root][INFO] - Step: 29600/39633  |  Loss: 0.5362  |  Score: 78.65 [%]  |  Seq Length: 256.0
[2024-09-20 21:06:29,137][root][INFO] - Step: 33600/39633  |  Loss: 0.5347  |  Score: 78.36 [%]  |  Seq Length: 256.0
[2024-09-20 21:06:43,619][root][INFO] - Step: 30000/39633  |  Loss: 0.5419  |  Score: 77.92 [%]  |  Seq Length: 256.0
[2024-09-20 21:07:16,118][root][INFO] - Step: 800/39633  |  Loss: 0.8817  |  Score: 59.55 [%]  |  Seq Length: 256.0
[2024-09-20 21:09:17,759][root][INFO] - Step: 30400/39633  |  Loss: 0.5404  |  Score: 78.11 [%]  |  Seq Length: 256.0
[2024-09-20 21:10:16,597][root][INFO] - Step: 34000/39633  |  Loss: 0.5305  |  Score: 78.64 [%]  |  Seq Length: 256.0
[2024-09-20 21:10:23,556][root][INFO] - Step: 1200/39633  |  Loss: 0.8309  |  Score: 62.81 [%]  |  Seq Length: 256.0
[2024-09-20 21:11:51,816][root][INFO] - Step: 30800/39633  |  Loss: 0.5364  |  Score: 78.45 [%]  |  Seq Length: 256.0
[2024-09-20 21:13:30,899][root][INFO] - Step: 1600/39633  |  Loss: 0.8015  |  Score: 64.50 [%]  |  Seq Length: 256.0
[2024-09-20 21:14:05,501][root][INFO] - Step: 34400/39633  |  Loss: 0.5187  |  Score: 79.17 [%]  |  Seq Length: 256.0
[2024-09-20 21:14:25,900][root][INFO] - Step: 31200/39633  |  Loss: 0.5401  |  Score: 78.30 [%]  |  Seq Length: 256.0
[2024-09-20 21:16:38,359][root][INFO] - Step: 2000/39633  |  Loss: 0.7808  |  Score: 65.38 [%]  |  Seq Length: 256.0
[2024-09-20 21:17:00,046][root][INFO] - Step: 31600/39633  |  Loss: 0.5339  |  Score: 78.43 [%]  |  Seq Length: 256.0
[2024-09-20 21:17:54,639][root][INFO] - Step: 34800/39633  |  Loss: 0.5263  |  Score: 78.60 [%]  |  Seq Length: 256.0
[2024-09-20 21:19:34,384][root][INFO] - Step: 32000/39633  |  Loss: 0.5408  |  Score: 78.29 [%]  |  Seq Length: 256.0
[2024-09-20 21:19:46,112][root][INFO] - Step: 2400/39633  |  Loss: 0.7632  |  Score: 67.01 [%]  |  Seq Length: 256.0
[2024-09-20 21:21:43,952][root][INFO] - Step: 35200/39633  |  Loss: 0.5259  |  Score: 78.88 [%]  |  Seq Length: 256.0
[2024-09-20 21:22:08,678][root][INFO] - Step: 32400/39633  |  Loss: 0.5327  |  Score: 78.94 [%]  |  Seq Length: 256.0
[2024-09-20 21:22:53,380][root][INFO] - Step: 2800/39633  |  Loss: 0.7484  |  Score: 67.58 [%]  |  Seq Length: 256.0
[2024-09-20 21:24:42,916][root][INFO] - Step: 32800/39633  |  Loss: 0.5344  |  Score: 78.62 [%]  |  Seq Length: 256.0
[2024-09-20 21:25:32,583][root][INFO] - Step: 35600/39633  |  Loss: 0.5203  |  Score: 79.31 [%]  |  Seq Length: 256.0
[2024-09-20 21:26:00,855][root][INFO] - Step: 3200/39633  |  Loss: 0.7421  |  Score: 68.04 [%]  |  Seq Length: 256.0
[2024-09-20 21:27:17,341][root][INFO] - Step: 33200/39633  |  Loss: 0.5365  |  Score: 78.54 [%]  |  Seq Length: 256.0
[2024-09-20 21:29:08,127][root][INFO] - Step: 3600/39633  |  Loss: 0.7264  |  Score: 68.68 [%]  |  Seq Length: 256.0
[2024-09-20 21:29:20,854][root][INFO] - Step: 36000/39633  |  Loss: 0.5275  |  Score: 78.88 [%]  |  Seq Length: 256.0
[2024-09-20 21:29:51,570][root][INFO] - Step: 33600/39633  |  Loss: 0.5407  |  Score: 78.12 [%]  |  Seq Length: 256.0
[2024-09-20 21:32:15,675][root][INFO] - Step: 4000/39633  |  Loss: 0.7182  |  Score: 69.22 [%]  |  Seq Length: 256.0
[2024-09-20 21:32:25,899][root][INFO] - Step: 34000/39633  |  Loss: 0.5390  |  Score: 78.02 [%]  |  Seq Length: 256.0
[2024-09-20 21:33:08,842][root][INFO] - Step: 36400/39633  |  Loss: 0.5252  |  Score: 78.70 [%]  |  Seq Length: 256.0
[2024-09-20 21:35:00,127][root][INFO] - Step: 34400/39633  |  Loss: 0.5321  |  Score: 78.20 [%]  |  Seq Length: 256.0
[2024-09-20 21:35:23,171][root][INFO] - Step: 4400/39633  |  Loss: 0.7036  |  Score: 70.04 [%]  |  Seq Length: 256.0
[2024-09-20 21:36:56,600][root][INFO] - Step: 36800/39633  |  Loss: 0.5178  |  Score: 79.21 [%]  |  Seq Length: 256.0
[2024-09-20 21:37:34,585][root][INFO] - Step: 34800/39633  |  Loss: 0.5347  |  Score: 78.30 [%]  |  Seq Length: 256.0
[2024-09-20 21:38:30,472][root][INFO] - Step: 4800/39633  |  Loss: 0.6948  |  Score: 70.38 [%]  |  Seq Length: 256.0
[2024-09-20 21:40:08,795][root][INFO] - Step: 35200/39633  |  Loss: 0.5311  |  Score: 78.70 [%]  |  Seq Length: 256.0
[2024-09-20 21:40:44,834][root][INFO] - Step: 37200/39633  |  Loss: 0.5329  |  Score: 78.47 [%]  |  Seq Length: 256.0
[2024-09-20 21:41:37,866][root][INFO] - Step: 5200/39633  |  Loss: 0.6931  |  Score: 70.65 [%]  |  Seq Length: 256.0
[2024-09-20 21:42:42,904][root][INFO] - Step: 35600/39633  |  Loss: 0.5375  |  Score: 78.41 [%]  |  Seq Length: 256.0
[2024-09-20 21:44:32,982][root][INFO] - Step: 37600/39633  |  Loss: 0.5183  |  Score: 79.17 [%]  |  Seq Length: 256.0
[2024-09-20 21:44:45,257][root][INFO] - Step: 5600/39633  |  Loss: 0.6819  |  Score: 71.02 [%]  |  Seq Length: 256.0
[2024-09-20 21:45:17,079][root][INFO] - Step: 36000/39633  |  Loss: 0.5285  |  Score: 78.92 [%]  |  Seq Length: 256.0
[2024-09-20 21:47:51,254][root][INFO] - Step: 36400/39633  |  Loss: 0.5344  |  Score: 78.37 [%]  |  Seq Length: 256.0
[2024-09-20 21:47:52,706][root][INFO] - Step: 6000/39633  |  Loss: 0.6800  |  Score: 71.43 [%]  |  Seq Length: 256.0
[2024-09-20 21:48:21,000][root][INFO] - Step: 38000/39633  |  Loss: 0.5162  |  Score: 79.21 [%]  |  Seq Length: 256.0
[2024-09-20 21:50:25,466][root][INFO] - Step: 36800/39633  |  Loss: 0.5363  |  Score: 78.31 [%]  |  Seq Length: 256.0
[2024-09-20 21:51:00,141][root][INFO] - Step: 6400/39633  |  Loss: 0.6720  |  Score: 71.66 [%]  |  Seq Length: 256.0
[2024-09-20 21:52:08,887][root][INFO] - Step: 38400/39633  |  Loss: 0.5233  |  Score: 79.06 [%]  |  Seq Length: 256.0
[2024-09-20 21:52:59,748][root][INFO] - Step: 37200/39633  |  Loss: 0.5268  |  Score: 78.69 [%]  |  Seq Length: 256.0
[2024-09-20 21:54:07,802][root][INFO] - Step: 6800/39633  |  Loss: 0.6622  |  Score: 72.31 [%]  |  Seq Length: 256.0
[2024-09-20 21:55:33,934][root][INFO] - Step: 37600/39633  |  Loss: 0.5327  |  Score: 78.55 [%]  |  Seq Length: 256.0
[2024-09-20 21:55:56,816][root][INFO] - Step: 38800/39633  |  Loss: 0.5252  |  Score: 78.57 [%]  |  Seq Length: 256.0
[2024-09-20 21:57:15,517][root][INFO] - Step: 7200/39633  |  Loss: 0.6558  |  Score: 72.39 [%]  |  Seq Length: 256.0
[2024-09-20 21:58:08,157][root][INFO] - Step: 38000/39633  |  Loss: 0.5273  |  Score: 78.97 [%]  |  Seq Length: 256.0
[2024-09-20 21:59:44,780][root][INFO] - Step: 39200/39633  |  Loss: 0.5192  |  Score: 79.21 [%]  |  Seq Length: 256.0
[2024-09-20 22:00:22,779][root][INFO] - Step: 7600/39633  |  Loss: 0.6549  |  Score: 72.56 [%]  |  Seq Length: 256.0
[2024-09-20 22:00:42,370][root][INFO] - Step: 38400/39633  |  Loss: 0.5347  |  Score: 78.48 [%]  |  Seq Length: 256.0
[2024-09-20 22:03:16,479][root][INFO] - Step: 38800/39633  |  Loss: 0.5369  |  Score: 78.34 [%]  |  Seq Length: 256.0
[2024-09-20 22:03:30,184][root][INFO] - Step: 8000/39633  |  Loss: 0.6496  |  Score: 72.86 [%]  |  Seq Length: 256.0
[2024-09-20 22:03:32,527][root][INFO] - Step: 39600/39633  |  Loss: 0.5245  |  Score: 78.85 [%]  |  Seq Length: 256.0
[2024-09-20 22:03:51,536][root][INFO] - Step: 39633/39633  |  Loss: 0.5090  |  Score: 79.75 [%]  |  Seq Length: 256.0
[2024-09-20 22:04:00,341][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-20 22:04:00,342][root][INFO] - Score: 74.36 [%]  |  Evaluation Time: 8.80 [s]
[2024-09-20 22:04:17,124][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-20 22:04:17,124][root][INFO] - Score: 74.48 [%]  |  Evaluation Time: 16.78 [s]
[2024-09-20 22:04:17,125][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-20 22:04:17,125][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-20 22:04:17,125][root][INFO] - - Epoch: 3
[2024-09-20 22:04:17,125][root][INFO] - - DEV score: 74.36 [%]
[2024-09-20 22:04:17,125][root][INFO] - - TEST score: 74.48 [%]
[2024-09-20 22:04:17,126][root][INFO] - Fine-tuning is done!
[2024-09-20 22:05:50,590][root][INFO] - Step: 39200/39633  |  Loss: 0.5324  |  Score: 78.36 [%]  |  Seq Length: 256.0
[2024-09-20 22:06:37,312][root][INFO] - Step: 8400/39633  |  Loss: 0.6530  |  Score: 72.23 [%]  |  Seq Length: 256.0
[2024-09-20 22:08:24,578][root][INFO] - Step: 39600/39633  |  Loss: 0.5415  |  Score: 78.20 [%]  |  Seq Length: 256.0
[2024-09-20 22:08:37,339][root][INFO] - Step: 39633/39633  |  Loss: 0.5060  |  Score: 78.84 [%]  |  Seq Length: 256.0
[2024-09-20 22:08:42,417][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-20 22:08:42,418][root][INFO] - Score: 74.92 [%]  |  Evaluation Time: 5.08 [s]
[2024-09-20 22:08:51,879][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-20 22:08:51,879][root][INFO] - Score: 74.61 [%]  |  Evaluation Time: 9.46 [s]
[2024-09-20 22:08:51,880][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-20 22:08:51,880][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-20 22:08:51,880][root][INFO] - - Epoch: 3
[2024-09-20 22:08:51,880][root][INFO] - - DEV score: 74.92 [%]
[2024-09-20 22:08:51,880][root][INFO] - - TEST score: 74.61 [%]
[2024-09-20 22:08:51,881][root][INFO] - Fine-tuning is done!
[2024-09-20 22:09:44,293][root][INFO] - Step: 8800/39633  |  Loss: 0.6439  |  Score: 72.85 [%]  |  Seq Length: 256.0
[2024-09-20 22:12:50,997][root][INFO] - Step: 9200/39633  |  Loss: 0.6276  |  Score: 74.29 [%]  |  Seq Length: 256.0
[2024-09-20 22:15:57,674][root][INFO] - Step: 9600/39633  |  Loss: 0.6383  |  Score: 73.54 [%]  |  Seq Length: 256.0
[2024-09-20 22:19:04,099][root][INFO] - Step: 10000/39633  |  Loss: 0.6298  |  Score: 73.77 [%]  |  Seq Length: 256.0
[2024-09-20 22:22:10,749][root][INFO] - Step: 10400/39633  |  Loss: 0.6264  |  Score: 74.21 [%]  |  Seq Length: 256.0
[2024-09-20 22:25:17,413][root][INFO] - Step: 10800/39633  |  Loss: 0.6371  |  Score: 73.59 [%]  |  Seq Length: 256.0
[2024-09-20 22:28:23,634][root][INFO] - Step: 11200/39633  |  Loss: 0.6175  |  Score: 74.52 [%]  |  Seq Length: 256.0
[2024-09-20 22:31:29,827][root][INFO] - Step: 11600/39633  |  Loss: 0.6224  |  Score: 74.34 [%]  |  Seq Length: 256.0
[2024-09-20 22:34:35,988][root][INFO] - Step: 12000/39633  |  Loss: 0.6156  |  Score: 74.31 [%]  |  Seq Length: 256.0
[2024-09-20 22:37:42,315][root][INFO] - Step: 12400/39633  |  Loss: 0.6086  |  Score: 75.16 [%]  |  Seq Length: 256.0
[2024-09-20 22:40:48,627][root][INFO] - Step: 12800/39633  |  Loss: 0.6161  |  Score: 74.39 [%]  |  Seq Length: 256.0
[2024-09-20 22:43:55,075][root][INFO] - Step: 13200/39633  |  Loss: 0.6089  |  Score: 75.09 [%]  |  Seq Length: 256.0
[2024-09-20 22:44:00,269][root][INFO] - Step: 13211/39633  |  Loss: 0.6397  |  Score: 73.63 [%]  |  Seq Length: 256.0
[2024-09-20 22:44:05,374][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-20 22:44:05,374][root][INFO] - Score: 72.57 [%]  |  Evaluation Time: 5.10 [s]
[2024-09-20 22:44:14,871][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-20 22:44:14,871][root][INFO] - Score: 71.77 [%]  |  Evaluation Time: 9.49 [s]
[2024-09-20 22:44:14,872][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-20 22:44:14,873][root][INFO] - 
[2/ 3 Epoch]
[2024-09-20 22:47:16,105][root][INFO] - Step: 13600/39633  |  Loss: 0.5919  |  Score: 75.74 [%]  |  Seq Length: 256.0
[2024-09-20 22:50:21,628][root][INFO] - Step: 14000/39633  |  Loss: 0.5833  |  Score: 76.02 [%]  |  Seq Length: 256.0
[2024-09-20 22:53:27,245][root][INFO] - Step: 14400/39633  |  Loss: 0.5920  |  Score: 75.75 [%]  |  Seq Length: 256.0
[2024-09-20 22:56:33,146][root][INFO] - Step: 14800/39633  |  Loss: 0.5752  |  Score: 76.59 [%]  |  Seq Length: 256.0
[2024-09-20 22:59:38,862][root][INFO] - Step: 15200/39633  |  Loss: 0.5825  |  Score: 76.12 [%]  |  Seq Length: 256.0
[2024-09-20 23:02:44,571][root][INFO] - Step: 15600/39633  |  Loss: 0.5719  |  Score: 76.79 [%]  |  Seq Length: 256.0
[2024-09-20 23:05:50,097][root][INFO] - Step: 16000/39633  |  Loss: 0.5781  |  Score: 76.29 [%]  |  Seq Length: 256.0
[2024-09-20 23:08:55,843][root][INFO] - Step: 16400/39633  |  Loss: 0.5750  |  Score: 76.73 [%]  |  Seq Length: 256.0
[2024-09-20 23:12:01,616][root][INFO] - Step: 16800/39633  |  Loss: 0.5738  |  Score: 76.59 [%]  |  Seq Length: 256.0
[2024-09-20 23:15:07,347][root][INFO] - Step: 17200/39633  |  Loss: 0.5810  |  Score: 76.26 [%]  |  Seq Length: 256.0
[2024-09-20 23:18:13,151][root][INFO] - Step: 17600/39633  |  Loss: 0.5810  |  Score: 76.51 [%]  |  Seq Length: 256.0
[2024-09-20 23:21:18,765][root][INFO] - Step: 18000/39633  |  Loss: 0.5754  |  Score: 76.52 [%]  |  Seq Length: 256.0
[2024-09-20 23:24:24,673][root][INFO] - Step: 18400/39633  |  Loss: 0.5771  |  Score: 76.23 [%]  |  Seq Length: 256.0
[2024-09-20 23:27:30,635][root][INFO] - Step: 18800/39633  |  Loss: 0.5774  |  Score: 76.39 [%]  |  Seq Length: 256.0
[2024-09-20 23:30:36,385][root][INFO] - Step: 19200/39633  |  Loss: 0.5781  |  Score: 76.51 [%]  |  Seq Length: 256.0
[2024-09-20 23:33:42,081][root][INFO] - Step: 19600/39633  |  Loss: 0.5686  |  Score: 76.63 [%]  |  Seq Length: 256.0
[2024-09-20 23:36:47,839][root][INFO] - Step: 20000/39633  |  Loss: 0.5734  |  Score: 76.53 [%]  |  Seq Length: 256.0
[2024-09-20 23:39:53,480][root][INFO] - Step: 20400/39633  |  Loss: 0.5695  |  Score: 76.89 [%]  |  Seq Length: 256.0
[2024-09-20 23:42:59,210][root][INFO] - Step: 20800/39633  |  Loss: 0.5716  |  Score: 76.83 [%]  |  Seq Length: 256.0
[2024-09-20 23:46:04,852][root][INFO] - Step: 21200/39633  |  Loss: 0.5664  |  Score: 76.95 [%]  |  Seq Length: 256.0
[2024-09-20 23:49:10,736][root][INFO] - Step: 21600/39633  |  Loss: 0.5699  |  Score: 76.80 [%]  |  Seq Length: 256.0
[2024-09-20 23:52:16,418][root][INFO] - Step: 22000/39633  |  Loss: 0.5664  |  Score: 76.91 [%]  |  Seq Length: 256.0
[2024-09-20 23:55:22,058][root][INFO] - Step: 22400/39633  |  Loss: 0.5703  |  Score: 76.86 [%]  |  Seq Length: 256.0
[2024-09-20 23:58:27,817][root][INFO] - Step: 22800/39633  |  Loss: 0.5587  |  Score: 77.27 [%]  |  Seq Length: 256.0
[2024-09-21 00:01:33,573][root][INFO] - Step: 23200/39633  |  Loss: 0.5596  |  Score: 77.56 [%]  |  Seq Length: 256.0
[2024-09-21 00:04:39,281][root][INFO] - Step: 23600/39633  |  Loss: 0.5585  |  Score: 77.61 [%]  |  Seq Length: 256.0
[2024-09-21 00:07:44,978][root][INFO] - Step: 24000/39633  |  Loss: 0.5569  |  Score: 77.36 [%]  |  Seq Length: 256.0
[2024-09-21 00:10:50,565][root][INFO] - Step: 24400/39633  |  Loss: 0.5620  |  Score: 76.93 [%]  |  Seq Length: 256.0
[2024-09-21 00:13:56,352][root][INFO] - Step: 24800/39633  |  Loss: 0.5602  |  Score: 77.11 [%]  |  Seq Length: 256.0
[2024-09-21 00:17:01,995][root][INFO] - Step: 25200/39633  |  Loss: 0.5572  |  Score: 77.53 [%]  |  Seq Length: 256.0
[2024-09-21 00:20:07,817][root][INFO] - Step: 25600/39633  |  Loss: 0.5610  |  Score: 77.19 [%]  |  Seq Length: 256.0
[2024-09-21 00:23:13,377][root][INFO] - Step: 26000/39633  |  Loss: 0.5568  |  Score: 77.30 [%]  |  Seq Length: 256.0
[2024-09-21 00:26:19,037][root][INFO] - Step: 26400/39633  |  Loss: 0.5554  |  Score: 77.37 [%]  |  Seq Length: 256.0
[2024-09-21 00:26:29,380][root][INFO] - Step: 26422/39633  |  Loss: 0.5432  |  Score: 79.21 [%]  |  Seq Length: 256.0
[2024-09-21 00:26:34,586][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-21 00:26:34,587][root][INFO] - Score: 73.47 [%]  |  Evaluation Time: 5.20 [s]
[2024-09-21 00:26:44,163][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-21 00:26:44,164][root][INFO] - Score: 74.09 [%]  |  Evaluation Time: 9.57 [s]
[2024-09-21 00:26:44,165][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-21 00:26:44,166][root][INFO] - 
[3/ 3 Epoch]
[2024-09-21 00:29:40,327][root][INFO] - Step: 26800/39633  |  Loss: 0.5436  |  Score: 78.17 [%]  |  Seq Length: 256.0
[2024-09-21 00:32:46,058][root][INFO] - Step: 27200/39633  |  Loss: 0.5376  |  Score: 78.34 [%]  |  Seq Length: 256.0
[2024-09-21 00:35:51,910][root][INFO] - Step: 27600/39633  |  Loss: 0.5362  |  Score: 78.37 [%]  |  Seq Length: 256.0
[2024-09-21 00:38:57,824][root][INFO] - Step: 28000/39633  |  Loss: 0.5330  |  Score: 78.58 [%]  |  Seq Length: 256.0
[2024-09-21 00:42:03,734][root][INFO] - Step: 28400/39633  |  Loss: 0.5365  |  Score: 78.32 [%]  |  Seq Length: 256.0
[2024-09-21 00:45:09,695][root][INFO] - Step: 28800/39633  |  Loss: 0.5380  |  Score: 78.22 [%]  |  Seq Length: 256.0
[2024-09-21 00:48:15,457][root][INFO] - Step: 29200/39633  |  Loss: 0.5279  |  Score: 78.88 [%]  |  Seq Length: 256.0
[2024-09-21 00:51:21,428][root][INFO] - Step: 29600/39633  |  Loss: 0.5275  |  Score: 79.02 [%]  |  Seq Length: 256.0
[2024-09-21 00:54:27,238][root][INFO] - Step: 30000/39633  |  Loss: 0.5345  |  Score: 78.46 [%]  |  Seq Length: 256.0
[2024-09-21 00:57:33,155][root][INFO] - Step: 30400/39633  |  Loss: 0.5314  |  Score: 78.46 [%]  |  Seq Length: 256.0
[2024-09-21 01:00:38,957][root][INFO] - Step: 30800/39633  |  Loss: 0.5326  |  Score: 78.66 [%]  |  Seq Length: 256.0
[2024-09-21 01:03:44,592][root][INFO] - Step: 31200/39633  |  Loss: 0.5307  |  Score: 78.80 [%]  |  Seq Length: 256.0
[2024-09-21 01:06:50,088][root][INFO] - Step: 31600/39633  |  Loss: 0.5257  |  Score: 78.65 [%]  |  Seq Length: 256.0
[2024-09-21 01:09:55,487][root][INFO] - Step: 32000/39633  |  Loss: 0.5272  |  Score: 78.82 [%]  |  Seq Length: 256.0
[2024-09-21 01:13:01,050][root][INFO] - Step: 32400/39633  |  Loss: 0.5167  |  Score: 79.18 [%]  |  Seq Length: 256.0
[2024-09-21 01:16:06,750][root][INFO] - Step: 32800/39633  |  Loss: 0.5351  |  Score: 78.47 [%]  |  Seq Length: 256.0
[2024-09-21 01:19:12,294][root][INFO] - Step: 33200/39633  |  Loss: 0.5361  |  Score: 78.30 [%]  |  Seq Length: 256.0
[2024-09-21 01:22:17,855][root][INFO] - Step: 33600/39633  |  Loss: 0.5244  |  Score: 78.89 [%]  |  Seq Length: 256.0
[2024-09-21 01:25:23,334][root][INFO] - Step: 34000/39633  |  Loss: 0.5307  |  Score: 78.61 [%]  |  Seq Length: 256.0
[2024-09-21 01:28:28,919][root][INFO] - Step: 34400/39633  |  Loss: 0.5310  |  Score: 78.75 [%]  |  Seq Length: 256.0
[2024-09-21 01:31:34,741][root][INFO] - Step: 34800/39633  |  Loss: 0.5175  |  Score: 79.19 [%]  |  Seq Length: 256.0
[2024-09-21 01:34:40,575][root][INFO] - Step: 35200/39633  |  Loss: 0.5242  |  Score: 78.58 [%]  |  Seq Length: 256.0
[2024-09-21 01:37:46,196][root][INFO] - Step: 35600/39633  |  Loss: 0.5232  |  Score: 79.07 [%]  |  Seq Length: 256.0
[2024-09-21 01:40:52,055][root][INFO] - Step: 36000/39633  |  Loss: 0.5257  |  Score: 78.83 [%]  |  Seq Length: 256.0
[2024-09-21 01:43:57,724][root][INFO] - Step: 36400/39633  |  Loss: 0.5241  |  Score: 78.84 [%]  |  Seq Length: 256.0
[2024-09-21 01:47:03,557][root][INFO] - Step: 36800/39633  |  Loss: 0.5260  |  Score: 78.75 [%]  |  Seq Length: 256.0
[2024-09-21 01:50:09,342][root][INFO] - Step: 37200/39633  |  Loss: 0.5267  |  Score: 78.69 [%]  |  Seq Length: 256.0
[2024-09-21 01:53:14,793][root][INFO] - Step: 37600/39633  |  Loss: 0.5351  |  Score: 78.38 [%]  |  Seq Length: 256.0
[2024-09-21 01:56:20,646][root][INFO] - Step: 38000/39633  |  Loss: 0.5279  |  Score: 78.93 [%]  |  Seq Length: 256.0
[2024-09-21 01:59:26,274][root][INFO] - Step: 38400/39633  |  Loss: 0.5301  |  Score: 78.73 [%]  |  Seq Length: 256.0
[2024-09-21 02:02:31,998][root][INFO] - Step: 38800/39633  |  Loss: 0.5254  |  Score: 78.96 [%]  |  Seq Length: 256.0
[2024-09-21 02:05:37,580][root][INFO] - Step: 39200/39633  |  Loss: 0.5299  |  Score: 78.53 [%]  |  Seq Length: 256.0
[2024-09-21 02:08:42,939][root][INFO] - Step: 39600/39633  |  Loss: 0.5249  |  Score: 78.71 [%]  |  Seq Length: 256.0
[2024-09-21 02:08:58,364][root][INFO] - Step: 39633/39633  |  Loss: 0.5303  |  Score: 78.98 [%]  |  Seq Length: 256.0
[2024-09-21 02:09:03,527][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-21 02:09:03,527][root][INFO] - Score: 74.62 [%]  |  Evaluation Time: 5.16 [s]
[2024-09-21 02:09:13,073][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-21 02:09:13,074][root][INFO] - Score: 73.49 [%]  |  Evaluation Time: 9.54 [s]
[2024-09-21 02:09:13,075][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-21 02:09:13,075][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-21 02:09:13,075][root][INFO] - - Epoch: 3
[2024-09-21 02:09:13,075][root][INFO] - - DEV score: 74.62 [%]
[2024-09-21 02:09:13,075][root][INFO] - - TEST score: 73.49 [%]
[2024-09-21 02:09:13,076][root][INFO] - Fine-tuning is done!
[2024-09-22 11:57:46,040][root][INFO] - 

[2024-09-22 11:57:46,040][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 11:57:46,041][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs
[2024-09-22 11:57:46,041][root][INFO] - 

[2024-09-22 11:57:46,041][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.0001, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 11:57:50,502][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 11:57:52,511][root][INFO] - 

[2024-09-22 11:57:52,511][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-22 11:57:52,512][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 11:57:52,521][root][INFO] - vocab size              : 51200
[2024-09-22 11:57:52,521][root][INFO] - device                  : gpu
[2024-09-22 11:57:52,521][root][INFO] - random seed             : 42
[2024-09-22 11:57:52,521][root][INFO] - train data size         : 4416
[2024-09-22 11:57:52,522][root][INFO] - max epochs              : 15
[2024-09-22 11:57:52,522][root][INFO] - total steps             : 1035
[2024-09-22 11:57:52,522][root][INFO] - warmup steps            : 104
[2024-09-22 11:57:52,522][root][INFO] - batch size              : 64
[2024-09-22 11:57:52,522][root][INFO] - accumulation steps      : 1
[2024-09-22 11:57:52,522][root][INFO] - optimizer               : adamwscale
[2024-09-22 11:57:52,522][root][INFO] - lr_scheduler            : cosine
[2024-09-22 11:57:52,522][root][INFO] - learning rate           : 0.0001
[2024-09-22 11:57:52,522][root][INFO] - max length              : 256

[2024-09-22 11:57:52,522][root][INFO] - 

[2024-09-22 11:57:52,522][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs
[2024-09-22 11:57:52,522][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs/ckpt
[2024-09-22 11:57:52,523][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs/tb
[2024-09-22 11:57:52,523][root][INFO] - * tb interval           : 15

[2024-09-22 11:57:52,523][root][INFO] - 

[2024-09-22 11:57:52,523][root][INFO] - Start the Training !
[2024-09-22 11:57:52,526][root][INFO] - 
[1/ 15 Epoch]
[2024-09-22 11:58:00,520][root][INFO] - Step: 15/1035  |  Loss: 3.8143  |  Score: 6.57 [%]  |  Seq Length: 256.0
[2024-09-22 11:58:07,115][root][INFO] - Step: 30/1035  |  Loss: 2.6538  |  Score: 12.41 [%]  |  Seq Length: 256.0
[2024-09-22 11:58:13,687][root][INFO] - Step: 45/1035  |  Loss: 2.2784  |  Score: 21.98 [%]  |  Seq Length: 256.0
[2024-09-22 11:58:20,265][root][INFO] - Step: 60/1035  |  Loss: 2.2505  |  Score: 24.52 [%]  |  Seq Length: 256.0
[2024-09-22 11:58:24,248][root][INFO] - Step: 69/1035  |  Loss: 2.0590  |  Score: 33.89 [%]  |  Seq Length: 256.0
[2024-09-22 11:58:27,383][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 11:58:27,383][root][INFO] - Score: 36.33 [%]  |  Evaluation Time: 3.13 [s]
[2024-09-22 11:58:28,505][root][INFO] - 

[2024-09-22 11:58:28,505][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 11:58:28,506][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs
[2024-09-22 11:58:28,506][root][INFO] - 

[2024-09-22 11:58:28,506][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 11:58:30,357][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 11:58:30,357][root][INFO] - Score: 38.49 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-22 11:58:30,358][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 11:58:30,359][root][INFO] - 
[2/ 15 Epoch]
[2024-09-22 11:58:33,092][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 11:58:33,093][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 11:58:33,094][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 11:58:33,094][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 11:58:33,095][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 11:58:33,095][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 11:58:33,096][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 11:58:33,096][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 11:58:33,097][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 11:58:33,098][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 11:58:33,098][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 11:58:33,099][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 11:58:33,099][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 11:58:33,100][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 11:58:33,100][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 11:58:33,101][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 11:58:33,102][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 11:58:33,102][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 11:58:33,103][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 11:58:33,103][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 11:58:33,104][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 11:58:33,104][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 11:58:33,105][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 11:58:33,106][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 11:58:33,108][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-22 11:58:33,273][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 11:58:33,415][root][INFO] - Step: 75/1035  |  Loss: 1.7878  |  Score: 43.37 [%]  |  Seq Length: 256.0
[2024-09-22 11:58:35,171][root][INFO] - 

[2024-09-22 11:58:35,171][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-22 11:58:35,171][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 11:58:35,179][root][INFO] - vocab size              : 51200
[2024-09-22 11:58:35,179][root][INFO] - device                  : gpu
[2024-09-22 11:58:35,179][root][INFO] - random seed             : 42
[2024-09-22 11:58:35,180][root][INFO] - train data size         : 4416
[2024-09-22 11:58:35,180][root][INFO] - max epochs              : 15
[2024-09-22 11:58:35,180][root][INFO] - total steps             : 1035
[2024-09-22 11:58:35,180][root][INFO] - warmup steps            : 104
[2024-09-22 11:58:35,180][root][INFO] - batch size              : 64
[2024-09-22 11:58:35,180][root][INFO] - accumulation steps      : 1
[2024-09-22 11:58:35,180][root][INFO] - optimizer               : adamwscale
[2024-09-22 11:58:35,180][root][INFO] - lr_scheduler            : cosine
[2024-09-22 11:58:35,180][root][INFO] - learning rate           : 0.02
[2024-09-22 11:58:35,180][root][INFO] - max length              : 256

[2024-09-22 11:58:35,180][root][INFO] - LoRA Configuration
[2024-09-22 11:58:35,181][root][INFO] - ㄴ r                    : 32
[2024-09-22 11:58:35,181][root][INFO] - ㄴ alpha                : 128
[2024-09-22 11:58:35,181][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 11:58:35,181][root][INFO] - 

[2024-09-22 11:58:35,181][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs
[2024-09-22 11:58:35,181][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs/ckpt
[2024-09-22 11:58:35,181][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs/tb
[2024-09-22 11:58:35,181][root][INFO] - * tb interval           : 15

[2024-09-22 11:58:35,181][root][INFO] - 

[2024-09-22 11:58:35,181][root][INFO] - Start the Training !
[2024-09-22 11:58:35,184][root][INFO] - 
[1/ 15 Epoch]
[2024-09-22 11:58:40,015][root][INFO] - Step: 90/1035  |  Loss: 1.6794  |  Score: 53.68 [%]  |  Seq Length: 256.0
[2024-09-22 11:58:42,060][root][INFO] - Step: 15/1035  |  Loss: 3.2085  |  Score: 4.52 [%]  |  Seq Length: 256.0
[2024-09-22 11:58:46,598][root][INFO] - Step: 105/1035  |  Loss: 1.5230  |  Score: 59.53 [%]  |  Seq Length: 256.0
[2024-09-22 11:58:47,529][root][INFO] - Step: 30/1035  |  Loss: 2.0614  |  Score: 35.10 [%]  |  Seq Length: 256.0
[2024-09-22 11:58:53,005][root][INFO] - Step: 45/1035  |  Loss: 1.6893  |  Score: 54.72 [%]  |  Seq Length: 256.0
[2024-09-22 11:58:53,209][root][INFO] - Step: 120/1035  |  Loss: 1.4308  |  Score: 59.96 [%]  |  Seq Length: 256.0
[2024-09-22 11:58:57,886][root][INFO] - 

[2024-09-22 11:58:57,886][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 11:58:57,886][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs
[2024-09-22 11:58:57,886][root][INFO] - 

[2024-09-22 11:58:57,887][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 11:58:58,482][root][INFO] - Step: 60/1035  |  Loss: 1.4378  |  Score: 60.12 [%]  |  Seq Length: 256.0
[2024-09-22 11:58:59,835][root][INFO] - Step: 135/1035  |  Loss: 1.4268  |  Score: 56.71 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:01,214][root][INFO] - Step: 138/1035  |  Loss: 1.4092  |  Score: 66.52 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:01,781][root][INFO] - Step: 69/1035  |  Loss: 1.3767  |  Score: 66.11 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:02,238][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 11:59:02,239][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 11:59:02,240][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 11:59:02,240][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 11:59:02,241][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 11:59:02,242][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 11:59:02,242][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 11:59:02,243][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 11:59:02,244][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 11:59:02,245][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 11:59:02,245][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 11:59:02,246][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 11:59:02,247][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 11:59:02,247][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 11:59:02,248][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 11:59:02,249][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 11:59:02,249][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 11:59:02,250][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 11:59:02,251][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 11:59:02,251][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 11:59:02,252][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 11:59:02,253][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 11:59:02,253][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 11:59:02,254][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 11:59:02,257][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-22 11:59:02,262][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-22 11:59:02,394][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-22 11:59:02,397][root][INFO] - Trainable params: 8985600 || all params: 134150400 || trainable: 6.70 %
[2024-09-22 11:59:02,575][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 11:59:04,284][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 11:59:04,284][root][INFO] - Score: 71.37 [%]  |  Evaluation Time: 3.07 [s]
[2024-09-22 11:59:04,826][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 11:59:04,826][root][INFO] - Score: 74.90 [%]  |  Evaluation Time: 3.04 [s]
[2024-09-22 11:59:05,700][root][INFO] - 

[2024-09-22 11:59:05,700][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-22 11:59:05,700][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 11:59:05,708][root][INFO] - vocab size              : 51200
[2024-09-22 11:59:05,709][root][INFO] - device                  : gpu
[2024-09-22 11:59:05,709][root][INFO] - random seed             : 42
[2024-09-22 11:59:05,709][root][INFO] - train data size         : 4416
[2024-09-22 11:59:05,709][root][INFO] - max epochs              : 15
[2024-09-22 11:59:05,709][root][INFO] - total steps             : 1035
[2024-09-22 11:59:05,709][root][INFO] - warmup steps            : 104
[2024-09-22 11:59:05,709][root][INFO] - batch size              : 64
[2024-09-22 11:59:05,709][root][INFO] - accumulation steps      : 1
[2024-09-22 11:59:05,709][root][INFO] - optimizer               : adamwscale
[2024-09-22 11:59:05,709][root][INFO] - lr_scheduler            : cosine
[2024-09-22 11:59:05,709][root][INFO] - learning rate           : 0.02
[2024-09-22 11:59:05,710][root][INFO] - max length              : 256

[2024-09-22 11:59:05,710][root][INFO] - LoRA Configuration
[2024-09-22 11:59:05,710][root][INFO] - ㄴ r                    : 32
[2024-09-22 11:59:05,710][root][INFO] - ㄴ alpha                : 128
[2024-09-22 11:59:05,710][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 11:59:05,710][root][INFO] - KOMBO Configuration
[2024-09-22 11:59:05,710][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-22 11:59:05,710][root][INFO] - ㄴ reducer              : linear
[2024-09-22 11:59:05,710][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-22 11:59:05,710][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-22 11:59:05,710][root][INFO] - ㄴ do_combination       : True
[2024-09-22 11:59:05,711][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-22 11:59:05,711][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-22 11:59:05,711][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-22 11:59:05,711][root][INFO] -   ㄴ add_lora           : False
[2024-09-22 11:59:05,711][root][INFO] - 

[2024-09-22 11:59:05,711][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs
[2024-09-22 11:59:05,711][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs/ckpt
[2024-09-22 11:59:05,711][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.02lr_42rs/tb
[2024-09-22 11:59:05,711][root][INFO] - * tb interval           : 15

[2024-09-22 11:59:05,711][root][INFO] - 

[2024-09-22 11:59:05,712][root][INFO] - Start the Training !
[2024-09-22 11:59:05,715][root][INFO] - 
[1/ 15 Epoch]
[2024-09-22 11:59:07,268][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 11:59:07,268][root][INFO] - Score: 64.82 [%]  |  Evaluation Time: 2.98 [s]
[2024-09-22 11:59:07,269][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 11:59:07,270][root][INFO] - 
[3/ 15 Epoch]
[2024-09-22 11:59:07,767][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 11:59:07,768][root][INFO] - Score: 68.29 [%]  |  Evaluation Time: 2.94 [s]
[2024-09-22 11:59:07,769][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 11:59:07,771][root][INFO] - 
[2/ 15 Epoch]
[2024-09-22 11:59:10,258][root][INFO] - Step: 75/1035  |  Loss: 1.1836  |  Score: 67.92 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:12,987][root][INFO] - Step: 150/1035  |  Loss: 1.1005  |  Score: 68.35 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:14,200][root][INFO] - Step: 15/1035  |  Loss: 3.0988  |  Score: 8.60 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:15,738][root][INFO] - Step: 90/1035  |  Loss: 1.2766  |  Score: 65.58 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:19,656][root][INFO] - Step: 165/1035  |  Loss: 1.2221  |  Score: 68.53 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:21,219][root][INFO] - Step: 105/1035  |  Loss: 1.2676  |  Score: 64.33 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:21,921][root][INFO] - Step: 30/1035  |  Loss: 2.2847  |  Score: 38.90 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:26,292][root][INFO] - Step: 180/1035  |  Loss: 1.2678  |  Score: 65.17 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:26,698][root][INFO] - Step: 120/1035  |  Loss: 1.3036  |  Score: 68.61 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:29,623][root][INFO] - Step: 45/1035  |  Loss: 1.5757  |  Score: 58.83 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:32,180][root][INFO] - Step: 135/1035  |  Loss: 1.2159  |  Score: 69.42 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:32,922][root][INFO] - Step: 195/1035  |  Loss: 1.0749  |  Score: 72.28 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:33,299][root][INFO] - Step: 138/1035  |  Loss: 1.2745  |  Score: 74.38 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:36,359][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 11:59:36,359][root][INFO] - Score: 75.60 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-22 11:59:37,450][root][INFO] - Step: 60/1035  |  Loss: 1.4859  |  Score: 59.03 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:38,265][root][INFO] - Step: 207/1035  |  Loss: 1.1674  |  Score: 67.53 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:39,280][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 11:59:39,280][root][INFO] - Score: 67.99 [%]  |  Evaluation Time: 2.92 [s]
[2024-09-22 11:59:39,281][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 11:59:39,282][root][INFO] - 
[3/ 15 Epoch]
[2024-09-22 11:59:41,421][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 11:59:41,421][root][INFO] - Score: 74.51 [%]  |  Evaluation Time: 3.15 [s]
[2024-09-22 11:59:42,102][root][INFO] - Step: 69/1035  |  Loss: 1.4921  |  Score: 63.05 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:44,047][root][INFO] - Step: 150/1035  |  Loss: 1.0714  |  Score: 70.87 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:44,443][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 11:59:44,443][root][INFO] - Score: 67.82 [%]  |  Evaluation Time: 3.02 [s]
[2024-09-22 11:59:44,444][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 11:59:44,445][root][INFO] - 
[4/ 15 Epoch]
[2024-09-22 11:59:46,136][root][INFO] - Step: 210/1035  |  Loss: 1.0103  |  Score: 77.99 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:47,001][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 11:59:47,001][root][INFO] - Score: 73.81 [%]  |  Evaluation Time: 4.90 [s]
[2024-09-22 11:59:49,538][root][INFO] - Step: 165/1035  |  Loss: 0.9192  |  Score: 73.32 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:51,781][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 11:59:51,781][root][INFO] - Score: 66.85 [%]  |  Evaluation Time: 4.78 [s]
[2024-09-22 11:59:51,783][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 11:59:51,784][root][INFO] - 
[2/ 15 Epoch]
[2024-09-22 11:59:52,773][root][INFO] - Step: 225/1035  |  Loss: 1.0267  |  Score: 73.04 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:55,039][root][INFO] - Step: 180/1035  |  Loss: 0.9068  |  Score: 74.56 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:55,211][root][INFO] - Step: 75/1035  |  Loss: 1.3830  |  Score: 63.54 [%]  |  Seq Length: 256.0
[2024-09-22 11:59:59,438][root][INFO] - Step: 240/1035  |  Loss: 1.0343  |  Score: 70.06 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:00,534][root][INFO] - Step: 195/1035  |  Loss: 0.9798  |  Score: 74.77 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:02,934][root][INFO] - Step: 90/1035  |  Loss: 1.1899  |  Score: 69.41 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:04,974][root][INFO] - Step: 207/1035  |  Loss: 0.9934  |  Score: 73.50 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:06,067][root][INFO] - Step: 255/1035  |  Loss: 0.9259  |  Score: 73.09 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:08,031][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 12:00:08,031][root][INFO] - Score: 77.83 [%]  |  Evaluation Time: 3.05 [s]
[2024-09-22 12:00:10,630][root][INFO] - Step: 105/1035  |  Loss: 1.2420  |  Score: 67.37 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:11,004][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 12:00:11,004][root][INFO] - Score: 68.59 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-22 12:00:11,005][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 12:00:11,007][root][INFO] - 
[4/ 15 Epoch]
[2024-09-22 12:00:12,420][root][INFO] - Step: 210/1035  |  Loss: 0.9664  |  Score: 79.70 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:12,698][root][INFO] - Step: 270/1035  |  Loss: 0.9114  |  Score: 75.12 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:15,417][root][INFO] - Step: 276/1035  |  Loss: 0.9190  |  Score: 79.46 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:17,923][root][INFO] - Step: 225/1035  |  Loss: 0.9081  |  Score: 78.87 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:18,406][root][INFO] - Step: 120/1035  |  Loss: 1.3664  |  Score: 66.22 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:18,514][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 12:00:18,515][root][INFO] - Score: 75.25 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-22 12:00:21,511][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 12:00:21,511][root][INFO] - Score: 69.27 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-22 12:00:21,513][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-22 12:00:21,513][root][INFO] - 
[5/ 15 Epoch]
[2024-09-22 12:00:23,428][root][INFO] - Step: 240/1035  |  Loss: 0.7167  |  Score: 79.44 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:25,841][root][INFO] - Step: 285/1035  |  Loss: 0.8415  |  Score: 80.05 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:26,297][root][INFO] - Step: 135/1035  |  Loss: 1.4570  |  Score: 62.44 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:27,915][root][INFO] - Step: 138/1035  |  Loss: 1.2473  |  Score: 69.75 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:28,932][root][INFO] - Step: 255/1035  |  Loss: 0.7462  |  Score: 80.62 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:32,482][root][INFO] - Step: 300/1035  |  Loss: 0.8839  |  Score: 75.19 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:32,933][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 12:00:32,933][root][INFO] - Score: 75.19 [%]  |  Evaluation Time: 5.02 [s]
[2024-09-22 12:00:34,439][root][INFO] - Step: 270/1035  |  Loss: 0.8303  |  Score: 80.09 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:36,714][root][INFO] - Step: 276/1035  |  Loss: 1.0444  |  Score: 73.26 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:37,583][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 12:00:37,583][root][INFO] - Score: 68.96 [%]  |  Evaluation Time: 4.65 [s]
[2024-09-22 12:00:37,584][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 12:00:37,585][root][INFO] - 
[3/ 15 Epoch]
[2024-09-22 12:00:39,114][root][INFO] - Step: 315/1035  |  Loss: 0.8509  |  Score: 76.55 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:39,755][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 12:00:39,755][root][INFO] - Score: 76.08 [%]  |  Evaluation Time: 3.04 [s]
[2024-09-22 12:00:42,687][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 12:00:42,687][root][INFO] - Score: 67.32 [%]  |  Evaluation Time: 2.93 [s]
[2024-09-22 12:00:42,689][root][INFO] - 
[5/ 15 Epoch]
[2024-09-22 12:00:44,082][root][INFO] - Step: 150/1035  |  Loss: 0.9850  |  Score: 73.53 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:45,755][root][INFO] - Step: 330/1035  |  Loss: 0.8143  |  Score: 78.70 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:46,279][root][INFO] - Step: 285/1035  |  Loss: 0.8080  |  Score: 83.18 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:51,778][root][INFO] - Step: 300/1035  |  Loss: 0.6927  |  Score: 82.93 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:51,807][root][INFO] - Step: 165/1035  |  Loss: 1.0567  |  Score: 75.65 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:52,521][root][INFO] - Step: 345/1035  |  Loss: 0.8637  |  Score: 74.66 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:55,635][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 12:00:55,635][root][INFO] - Score: 76.12 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-22 12:00:57,283][root][INFO] - Step: 315/1035  |  Loss: 0.5970  |  Score: 83.64 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:58,701][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 12:00:58,702][root][INFO] - Score: 68.25 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-22 12:00:58,704][root][INFO] - 
[6/ 15 Epoch]
[2024-09-22 12:00:59,551][root][INFO] - Step: 346/1035  |  Loss: 0.7462  |  Score: 73.86 [%]  |  Seq Length: 256.0
[2024-09-22 12:00:59,589][root][INFO] - Step: 180/1035  |  Loss: 1.0289  |  Score: 70.80 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:02,832][root][INFO] - Step: 330/1035  |  Loss: 0.6533  |  Score: 82.61 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:05,748][root][INFO] - Step: 360/1035  |  Loss: 0.7617  |  Score: 80.02 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:07,258][root][INFO] - Step: 195/1035  |  Loss: 0.9486  |  Score: 71.78 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:08,409][root][INFO] - Step: 345/1035  |  Loss: 0.6662  |  Score: 81.67 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:11,505][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 12:01:11,505][root][INFO] - Score: 77.41 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-22 12:01:12,382][root][INFO] - Step: 375/1035  |  Loss: 0.7211  |  Score: 79.47 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:13,492][root][INFO] - Step: 207/1035  |  Loss: 0.9271  |  Score: 76.23 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:14,467][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 12:01:14,467][root][INFO] - Score: 71.41 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-22 12:01:14,469][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-22 12:01:14,470][root][INFO] - 
[6/ 15 Epoch]
[2024-09-22 12:01:15,180][root][INFO] - Step: 346/1035  |  Loss: 0.5794  |  Score: 85.84 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:18,443][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 12:01:18,444][root][INFO] - Score: 75.56 [%]  |  Evaluation Time: 4.95 [s]
[2024-09-22 12:01:19,019][root][INFO] - Step: 390/1035  |  Loss: 0.7668  |  Score: 78.96 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:20,321][root][INFO] - Step: 360/1035  |  Loss: 0.5790  |  Score: 86.03 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:23,146][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 12:01:23,146][root][INFO] - Score: 64.79 [%]  |  Evaluation Time: 4.70 [s]
[2024-09-22 12:01:23,150][root][INFO] - 
[4/ 15 Epoch]
[2024-09-22 12:01:25,100][root][INFO] - Step: 210/1035  |  Loss: 1.5042  |  Score: 71.68 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:25,658][root][INFO] - Step: 405/1035  |  Loss: 0.7667  |  Score: 79.12 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:25,833][root][INFO] - Step: 375/1035  |  Loss: 0.6390  |  Score: 86.58 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:29,687][root][INFO] - Step: 414/1035  |  Loss: 0.7389  |  Score: 77.81 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:31,337][root][INFO] - Step: 390/1035  |  Loss: 0.5513  |  Score: 84.65 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:32,802][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-22 12:01:32,802][root][INFO] - Score: 76.38 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-22 12:01:32,869][root][INFO] - Step: 225/1035  |  Loss: 0.9006  |  Score: 77.52 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:35,837][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-22 12:01:35,837][root][INFO] - Score: 69.59 [%]  |  Evaluation Time: 3.03 [s]
[2024-09-22 12:01:35,838][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-22 12:01:35,839][root][INFO] - 
[7/ 15 Epoch]
[2024-09-22 12:01:36,853][root][INFO] - Step: 405/1035  |  Loss: 0.5375  |  Score: 85.45 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:38,818][root][INFO] - Step: 420/1035  |  Loss: 0.7207  |  Score: 80.19 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:40,251][root][INFO] - Step: 414/1035  |  Loss: 0.5649  |  Score: 86.26 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:40,614][root][INFO] - Step: 240/1035  |  Loss: 0.9769  |  Score: 76.65 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:43,310][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-22 12:01:43,310][root][INFO] - Score: 77.15 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-22 12:01:45,449][root][INFO] - Step: 435/1035  |  Loss: 0.7045  |  Score: 80.49 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:46,305][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-22 12:01:46,305][root][INFO] - Score: 72.08 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-22 12:01:46,306][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-22 12:01:46,307][root][INFO] - 
[7/ 15 Epoch]
[2024-09-22 12:01:48,325][root][INFO] - Step: 255/1035  |  Loss: 0.8494  |  Score: 78.27 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:48,818][root][INFO] - Step: 420/1035  |  Loss: 0.5044  |  Score: 86.75 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:52,072][root][INFO] - Step: 450/1035  |  Loss: 0.6882  |  Score: 80.92 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:54,329][root][INFO] - Step: 435/1035  |  Loss: 0.4187  |  Score: 89.69 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:55,991][root][INFO] - Step: 270/1035  |  Loss: 0.8454  |  Score: 79.67 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:58,720][root][INFO] - Step: 465/1035  |  Loss: 0.6271  |  Score: 82.42 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:59,146][root][INFO] - Step: 276/1035  |  Loss: 0.8400  |  Score: 78.02 [%]  |  Seq Length: 256.0
[2024-09-22 12:01:59,861][root][INFO] - Step: 450/1035  |  Loss: 0.4200  |  Score: 88.86 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:04,109][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 12:02:04,109][root][INFO] - Score: 77.50 [%]  |  Evaluation Time: 4.96 [s]
[2024-09-22 12:02:05,372][root][INFO] - Step: 480/1035  |  Loss: 0.6760  |  Score: 80.69 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:05,377][root][INFO] - Step: 465/1035  |  Loss: 0.4482  |  Score: 88.22 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:06,755][root][INFO] - Step: 483/1035  |  Loss: 0.6893  |  Score: 82.95 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:08,859][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 12:02:08,859][root][INFO] - Score: 71.07 [%]  |  Evaluation Time: 4.75 [s]
[2024-09-22 12:02:08,860][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-22 12:02:08,862][root][INFO] - 
[5/ 15 Epoch]
[2024-09-22 12:02:09,857][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-22 12:02:09,857][root][INFO] - Score: 76.28 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-22 12:02:10,883][root][INFO] - Step: 480/1035  |  Loss: 0.5186  |  Score: 86.37 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:12,052][root][INFO] - Step: 483/1035  |  Loss: 0.4487  |  Score: 87.20 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:12,959][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-22 12:02:12,959][root][INFO] - Score: 70.63 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-22 12:02:12,960][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-22 12:02:12,961][root][INFO] - 
[8/ 15 Epoch]
[2024-09-22 12:02:13,842][root][INFO] - Step: 285/1035  |  Loss: 0.6245  |  Score: 85.09 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:15,107][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-22 12:02:15,108][root][INFO] - Score: 77.43 [%]  |  Evaluation Time: 3.05 [s]
[2024-09-22 12:02:18,061][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-22 12:02:18,061][root][INFO] - Score: 70.79 [%]  |  Evaluation Time: 2.95 [s]
[2024-09-22 12:02:18,063][root][INFO] - 
[8/ 15 Epoch]
[2024-09-22 12:02:18,592][root][INFO] - Step: 495/1035  |  Loss: 0.6492  |  Score: 83.33 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:21,724][root][INFO] - Step: 300/1035  |  Loss: 0.6615  |  Score: 83.40 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:22,796][root][INFO] - Step: 495/1035  |  Loss: 0.3584  |  Score: 89.50 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:25,242][root][INFO] - Step: 510/1035  |  Loss: 0.6083  |  Score: 83.50 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:28,311][root][INFO] - Step: 510/1035  |  Loss: 0.3816  |  Score: 89.88 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:29,468][root][INFO] - Step: 315/1035  |  Loss: 0.7818  |  Score: 80.43 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:31,881][root][INFO] - Step: 525/1035  |  Loss: 0.6877  |  Score: 82.08 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:33,823][root][INFO] - Step: 525/1035  |  Loss: 0.4137  |  Score: 88.79 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:37,167][root][INFO] - Step: 330/1035  |  Loss: 0.6478  |  Score: 81.73 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:38,522][root][INFO] - Step: 540/1035  |  Loss: 0.5530  |  Score: 83.80 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:39,341][root][INFO] - Step: 540/1035  |  Loss: 0.3856  |  Score: 90.04 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:43,802][root][INFO] - Step: 552/1035  |  Loss: 0.3568  |  Score: 89.48 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:43,888][root][INFO] - Step: 552/1035  |  Loss: 0.5821  |  Score: 84.73 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:44,984][root][INFO] - Step: 345/1035  |  Loss: 0.6837  |  Score: 83.14 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:46,951][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-22 12:02:46,951][root][INFO] - Score: 76.93 [%]  |  Evaluation Time: 3.15 [s]
[2024-09-22 12:02:47,000][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-22 12:02:47,000][root][INFO] - Score: 76.74 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-22 12:02:49,905][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 12:02:49,905][root][INFO] - Score: 78.41 [%]  |  Evaluation Time: 4.92 [s]
[2024-09-22 12:02:49,940][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-22 12:02:49,941][root][INFO] - Score: 70.39 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-22 12:02:49,943][root][INFO] - 
[9/ 15 Epoch]
[2024-09-22 12:02:50,055][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-22 12:02:50,056][root][INFO] - Score: 70.58 [%]  |  Evaluation Time: 3.05 [s]
[2024-09-22 12:02:50,057][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-22 12:02:50,058][root][INFO] - 
[9/ 15 Epoch]
[2024-09-22 12:02:51,442][root][INFO] - Step: 555/1035  |  Loss: 0.3453  |  Score: 91.02 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:51,770][root][INFO] - Step: 555/1035  |  Loss: 0.6641  |  Score: 84.31 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:54,629][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 12:02:54,629][root][INFO] - Score: 71.75 [%]  |  Evaluation Time: 4.72 [s]
[2024-09-22 12:02:54,631][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-22 12:02:54,632][root][INFO] - 
[6/ 15 Epoch]
[2024-09-22 12:02:55,550][root][INFO] - Step: 346/1035  |  Loss: 0.6052  |  Score: 82.28 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:56,970][root][INFO] - Step: 570/1035  |  Loss: 0.3059  |  Score: 91.17 [%]  |  Seq Length: 256.0
[2024-09-22 12:02:58,429][root][INFO] - Step: 570/1035  |  Loss: 0.5409  |  Score: 85.73 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:02,493][root][INFO] - Step: 585/1035  |  Loss: 0.3197  |  Score: 91.29 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:02,900][root][INFO] - Step: 360/1035  |  Loss: 0.4917  |  Score: 86.02 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:05,071][root][INFO] - Step: 585/1035  |  Loss: 0.5563  |  Score: 84.05 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:08,012][root][INFO] - Step: 600/1035  |  Loss: 0.3100  |  Score: 91.24 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:10,682][root][INFO] - Step: 375/1035  |  Loss: 0.5801  |  Score: 85.01 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:11,703][root][INFO] - Step: 600/1035  |  Loss: 0.6130  |  Score: 82.50 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:13,535][root][INFO] - Step: 615/1035  |  Loss: 0.3032  |  Score: 91.24 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:15,800][root][INFO] - Step: 621/1035  |  Loss: 0.3650  |  Score: 89.63 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:18,370][root][INFO] - Step: 615/1035  |  Loss: 0.6072  |  Score: 82.49 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:18,404][root][INFO] - Step: 390/1035  |  Loss: 0.5132  |  Score: 86.01 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:18,901][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-22 12:03:18,901][root][INFO] - Score: 76.39 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-22 12:03:21,080][root][INFO] - Step: 621/1035  |  Loss: 0.6412  |  Score: 82.42 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:21,851][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-22 12:03:21,851][root][INFO] - Score: 70.30 [%]  |  Evaluation Time: 2.95 [s]
[2024-09-22 12:03:21,853][root][INFO] - 
[10/ 15 Epoch]
[2024-09-22 12:03:24,252][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-22 12:03:24,252][root][INFO] - Score: 77.24 [%]  |  Evaluation Time: 3.17 [s]
[2024-09-22 12:03:25,509][root][INFO] - Step: 630/1035  |  Loss: 0.2710  |  Score: 93.32 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:26,144][root][INFO] - Step: 405/1035  |  Loss: 0.5340  |  Score: 85.88 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:27,347][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-22 12:03:27,348][root][INFO] - Score: 70.02 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-22 12:03:27,350][root][INFO] - 
[10/ 15 Epoch]
[2024-09-22 12:03:30,813][root][INFO] - Step: 414/1035  |  Loss: 0.6192  |  Score: 85.43 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:31,028][root][INFO] - Step: 645/1035  |  Loss: 0.2770  |  Score: 93.11 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:31,767][root][INFO] - Step: 630/1035  |  Loss: 0.5463  |  Score: 84.95 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:35,863][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-22 12:03:35,863][root][INFO] - Score: 77.34 [%]  |  Evaluation Time: 5.05 [s]
[2024-09-22 12:03:36,560][root][INFO] - Step: 660/1035  |  Loss: 0.2689  |  Score: 91.97 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:38,493][root][INFO] - Step: 645/1035  |  Loss: 0.5209  |  Score: 84.41 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:40,458][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-22 12:03:40,458][root][INFO] - Score: 71.78 [%]  |  Evaluation Time: 4.59 [s]
[2024-09-22 12:03:40,460][root][INFO] - 
[7/ 15 Epoch]
[2024-09-22 12:03:42,082][root][INFO] - Step: 675/1035  |  Loss: 0.2797  |  Score: 91.83 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:43,911][root][INFO] - Step: 420/1035  |  Loss: 0.5195  |  Score: 89.09 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:45,132][root][INFO] - Step: 660/1035  |  Loss: 0.5318  |  Score: 84.75 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:47,650][root][INFO] - Step: 690/1035  |  Loss: 0.2749  |  Score: 92.26 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:50,726][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-22 12:03:50,726][root][INFO] - Score: 77.28 [%]  |  Evaluation Time: 3.07 [s]
[2024-09-22 12:03:51,655][root][INFO] - Step: 435/1035  |  Loss: 0.4062  |  Score: 89.13 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:51,775][root][INFO] - Step: 675/1035  |  Loss: 0.5015  |  Score: 87.32 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:53,680][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-22 12:03:53,680][root][INFO] - Score: 70.83 [%]  |  Evaluation Time: 2.95 [s]
[2024-09-22 12:03:53,682][root][INFO] - 
[11/ 15 Epoch]
[2024-09-22 12:03:54,349][root][INFO] - Step: 691/1035  |  Loss: 0.2234  |  Score: 94.03 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:58,463][root][INFO] - Step: 690/1035  |  Loss: 0.5613  |  Score: 83.91 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:59,405][root][INFO] - Step: 450/1035  |  Loss: 0.4256  |  Score: 89.22 [%]  |  Seq Length: 256.0
[2024-09-22 12:03:59,497][root][INFO] - Step: 705/1035  |  Loss: 0.2406  |  Score: 93.55 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:01,564][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-22 12:04:01,564][root][INFO] - Score: 76.16 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-22 12:04:04,578][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-22 12:04:04,579][root][INFO] - Score: 70.79 [%]  |  Evaluation Time: 3.01 [s]
[2024-09-22 12:04:04,581][root][INFO] - 
[11/ 15 Epoch]
[2024-09-22 12:04:05,021][root][INFO] - Step: 720/1035  |  Loss: 0.2420  |  Score: 92.89 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:05,367][root][INFO] - Step: 691/1035  |  Loss: 0.7158  |  Score: 79.19 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:07,165][root][INFO] - Step: 465/1035  |  Loss: 0.4367  |  Score: 86.05 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:10,556][root][INFO] - Step: 735/1035  |  Loss: 0.2353  |  Score: 93.53 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:11,706][root][INFO] - Step: 705/1035  |  Loss: 0.5126  |  Score: 86.03 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:14,805][root][INFO] - Step: 480/1035  |  Loss: 0.4596  |  Score: 86.36 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:16,088][root][INFO] - Step: 750/1035  |  Loss: 0.2430  |  Score: 93.42 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:16,420][root][INFO] - Step: 483/1035  |  Loss: 0.4443  |  Score: 88.90 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:18,437][root][INFO] - Step: 720/1035  |  Loss: 0.5080  |  Score: 85.23 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:19,449][root][INFO] - Step: 759/1035  |  Loss: 0.2500  |  Score: 93.67 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:21,402][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-22 12:04:21,403][root][INFO] - Score: 79.17 [%]  |  Evaluation Time: 4.98 [s]
[2024-09-22 12:04:22,535][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-22 12:04:22,535][root][INFO] - Score: 78.17 [%]  |  Evaluation Time: 3.08 [s]
[2024-09-22 12:04:25,076][root][INFO] - Step: 735/1035  |  Loss: 0.5225  |  Score: 85.36 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:25,572][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-22 12:04:25,572][root][INFO] - Score: 70.19 [%]  |  Evaluation Time: 3.03 [s]
[2024-09-22 12:04:25,574][root][INFO] - 
[12/ 15 Epoch]
[2024-09-22 12:04:26,161][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-22 12:04:26,161][root][INFO] - Score: 70.27 [%]  |  Evaluation Time: 4.76 [s]
[2024-09-22 12:04:26,163][root][INFO] - 
[8/ 15 Epoch]
[2024-09-22 12:04:28,162][root][INFO] - Step: 765/1035  |  Loss: 0.2042  |  Score: 93.55 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:31,735][root][INFO] - Step: 750/1035  |  Loss: 0.4950  |  Score: 85.57 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:32,799][root][INFO] - Step: 495/1035  |  Loss: 0.3609  |  Score: 89.80 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:33,686][root][INFO] - Step: 780/1035  |  Loss: 0.2144  |  Score: 93.92 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:35,794][root][INFO] - Step: 759/1035  |  Loss: 0.4440  |  Score: 87.10 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:38,929][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-22 12:04:38,929][root][INFO] - Score: 76.23 [%]  |  Evaluation Time: 3.13 [s]
[2024-09-22 12:04:39,211][root][INFO] - Step: 795/1035  |  Loss: 0.2127  |  Score: 94.16 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:40,533][root][INFO] - Step: 510/1035  |  Loss: 0.3864  |  Score: 88.59 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:41,934][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-22 12:04:41,934][root][INFO] - Score: 70.93 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-22 12:04:41,936][root][INFO] - 
[12/ 15 Epoch]
[2024-09-22 12:04:44,753][root][INFO] - Step: 810/1035  |  Loss: 0.2118  |  Score: 93.98 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:44,928][root][INFO] - Step: 765/1035  |  Loss: 0.4444  |  Score: 87.66 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:48,229][root][INFO] - Step: 525/1035  |  Loss: 0.3917  |  Score: 89.04 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:50,298][root][INFO] - Step: 825/1035  |  Loss: 0.2304  |  Score: 93.48 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:51,462][root][INFO] - Step: 828/1035  |  Loss: 0.1625  |  Score: 95.29 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:51,589][root][INFO] - Step: 780/1035  |  Loss: 0.5246  |  Score: 85.74 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:54,541][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-22 12:04:54,541][root][INFO] - Score: 77.60 [%]  |  Evaluation Time: 3.08 [s]
[2024-09-22 12:04:55,965][root][INFO] - Step: 540/1035  |  Loss: 0.4193  |  Score: 90.05 [%]  |  Seq Length: 256.0
[2024-09-22 12:04:57,537][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-22 12:04:57,537][root][INFO] - Score: 70.55 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-22 12:04:57,539][root][INFO] - 
[13/ 15 Epoch]
[2024-09-22 12:04:58,262][root][INFO] - Step: 795/1035  |  Loss: 0.5291  |  Score: 86.89 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:02,223][root][INFO] - Step: 552/1035  |  Loss: 0.4098  |  Score: 89.83 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:02,289][root][INFO] - Step: 840/1035  |  Loss: 0.1900  |  Score: 94.74 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:04,901][root][INFO] - Step: 810/1035  |  Loss: 0.5230  |  Score: 84.09 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:07,263][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-22 12:05:07,263][root][INFO] - Score: 77.20 [%]  |  Evaluation Time: 5.04 [s]
[2024-09-22 12:05:07,815][root][INFO] - Step: 855/1035  |  Loss: 0.1868  |  Score: 94.73 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:11,552][root][INFO] - Step: 825/1035  |  Loss: 0.4801  |  Score: 86.70 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:12,026][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-22 12:05:12,027][root][INFO] - Score: 69.94 [%]  |  Evaluation Time: 4.76 [s]
[2024-09-22 12:05:12,029][root][INFO] - 
[9/ 15 Epoch]
[2024-09-22 12:05:12,942][root][INFO] - Step: 828/1035  |  Loss: 0.5014  |  Score: 87.20 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:13,380][root][INFO] - Step: 870/1035  |  Loss: 0.1799  |  Score: 94.67 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:13,924][root][INFO] - Step: 555/1035  |  Loss: 0.3242  |  Score: 91.28 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:16,107][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-22 12:05:16,108][root][INFO] - Score: 76.35 [%]  |  Evaluation Time: 3.16 [s]
[2024-09-22 12:05:18,968][root][INFO] - Step: 885/1035  |  Loss: 0.1888  |  Score: 94.52 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:19,138][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-22 12:05:19,138][root][INFO] - Score: 72.65 [%]  |  Evaluation Time: 3.03 [s]
[2024-09-22 12:05:19,139][root][INFO] - 
Save new Best Score (Epoch: 12)
[2024-09-22 12:05:19,140][root][INFO] - 
[13/ 15 Epoch]
[2024-09-22 12:05:21,622][root][INFO] - Step: 570/1035  |  Loss: 0.3073  |  Score: 90.82 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:23,452][root][INFO] - Step: 897/1035  |  Loss: 0.1910  |  Score: 94.20 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:24,813][root][INFO] - Step: 840/1035  |  Loss: 0.4407  |  Score: 87.55 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:26,491][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-22 12:05:26,491][root][INFO] - Score: 78.06 [%]  |  Evaluation Time: 3.04 [s]
[2024-09-22 12:05:29,421][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-22 12:05:29,421][root][INFO] - Score: 70.68 [%]  |  Evaluation Time: 2.93 [s]
[2024-09-22 12:05:29,423][root][INFO] - 
[14/ 15 Epoch]
[2024-09-22 12:05:29,473][root][INFO] - Step: 585/1035  |  Loss: 0.2809  |  Score: 92.11 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:30,860][root][INFO] - Step: 900/1035  |  Loss: 0.2097  |  Score: 92.28 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:31,473][root][INFO] - Step: 855/1035  |  Loss: 0.4874  |  Score: 86.51 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:36,381][root][INFO] - Step: 915/1035  |  Loss: 0.1995  |  Score: 93.99 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:37,285][root][INFO] - Step: 600/1035  |  Loss: 0.3272  |  Score: 89.96 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:38,113][root][INFO] - Step: 870/1035  |  Loss: 0.4658  |  Score: 86.42 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:41,900][root][INFO] - Step: 930/1035  |  Loss: 0.1800  |  Score: 94.80 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:44,763][root][INFO] - Step: 885/1035  |  Loss: 0.4758  |  Score: 87.55 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:45,013][root][INFO] - Step: 615/1035  |  Loss: 0.2994  |  Score: 91.75 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:47,434][root][INFO] - Step: 945/1035  |  Loss: 0.1770  |  Score: 94.94 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:48,143][root][INFO] - Step: 621/1035  |  Loss: 0.3467  |  Score: 91.94 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:50,125][root][INFO] - Step: 897/1035  |  Loss: 0.5108  |  Score: 84.81 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:52,977][root][INFO] - Step: 960/1035  |  Loss: 0.1681  |  Score: 95.06 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:53,088][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-22 12:05:53,088][root][INFO] - Score: 78.48 [%]  |  Evaluation Time: 4.94 [s]
[2024-09-22 12:05:53,261][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-22 12:05:53,261][root][INFO] - Score: 77.15 [%]  |  Evaluation Time: 3.13 [s]
[2024-09-22 12:05:55,243][root][INFO] - Step: 966/1035  |  Loss: 0.1857  |  Score: 94.93 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:56,258][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-22 12:05:56,258][root][INFO] - Score: 71.48 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-22 12:05:56,260][root][INFO] - 
[14/ 15 Epoch]
[2024-09-22 12:05:57,836][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-22 12:05:57,837][root][INFO] - Score: 69.86 [%]  |  Evaluation Time: 4.75 [s]
[2024-09-22 12:05:57,839][root][INFO] - 
[10/ 15 Epoch]
[2024-09-22 12:05:58,024][root][INFO] - Step: 900/1035  |  Loss: 0.5248  |  Score: 86.56 [%]  |  Seq Length: 256.0
[2024-09-22 12:05:58,294][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-22 12:05:58,294][root][INFO] - Score: 77.09 [%]  |  Evaluation Time: 3.05 [s]
[2024-09-22 12:06:01,301][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-22 12:06:01,301][root][INFO] - Score: 71.07 [%]  |  Evaluation Time: 3.01 [s]
[2024-09-22 12:06:01,304][root][INFO] - 
[15/ 15 Epoch]
[2024-09-22 12:06:02,894][root][INFO] - Step: 630/1035  |  Loss: 0.2500  |  Score: 92.62 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:04,698][root][INFO] - Step: 915/1035  |  Loss: 0.4802  |  Score: 86.96 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:04,943][root][INFO] - Step: 975/1035  |  Loss: 0.1916  |  Score: 94.68 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:10,464][root][INFO] - Step: 990/1035  |  Loss: 0.1817  |  Score: 95.28 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:10,756][root][INFO] - Step: 645/1035  |  Loss: 0.2697  |  Score: 93.09 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:11,367][root][INFO] - Step: 930/1035  |  Loss: 0.4581  |  Score: 85.86 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:15,983][root][INFO] - Step: 1005/1035  |  Loss: 0.1835  |  Score: 94.60 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:18,024][root][INFO] - Step: 945/1035  |  Loss: 0.4580  |  Score: 87.11 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:18,627][root][INFO] - Step: 660/1035  |  Loss: 0.2729  |  Score: 92.22 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:21,499][root][INFO] - Step: 1020/1035  |  Loss: 0.1829  |  Score: 94.33 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:24,697][root][INFO] - Step: 960/1035  |  Loss: 0.4721  |  Score: 86.85 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:26,473][root][INFO] - Step: 675/1035  |  Loss: 0.2459  |  Score: 92.51 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:27,062][root][INFO] - Step: 1035/1035  |  Loss: 0.1874  |  Score: 93.84 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:27,400][root][INFO] - Step: 966/1035  |  Loss: 0.4748  |  Score: 86.52 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:30,180][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-22 12:06:30,180][root][INFO] - Score: 77.85 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-22 12:06:30,533][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-22 12:06:30,533][root][INFO] - Score: 77.11 [%]  |  Evaluation Time: 3.13 [s]
[2024-09-22 12:06:33,113][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-22 12:06:33,113][root][INFO] - Score: 71.29 [%]  |  Evaluation Time: 2.93 [s]
[2024-09-22 12:06:33,114][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 12:06:33,115][root][INFO] - - Epoch: 6
[2024-09-22 12:06:33,115][root][INFO] - - DEV score: 77.15 [%]
[2024-09-22 12:06:33,115][root][INFO] - - TEST score: 72.08 [%]
[2024-09-22 12:06:33,116][root][INFO] - Fine-tuning is done!
[2024-09-22 12:06:33,538][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-22 12:06:33,538][root][INFO] - Score: 71.34 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-22 12:06:33,542][root][INFO] - 
[15/ 15 Epoch]
[2024-09-22 12:06:34,284][root][INFO] - Step: 690/1035  |  Loss: 0.2652  |  Score: 93.12 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:37,929][root][INFO] - Step: 975/1035  |  Loss: 0.3817  |  Score: 90.33 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:39,263][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-22 12:06:39,263][root][INFO] - Score: 77.96 [%]  |  Evaluation Time: 4.98 [s]
[2024-09-22 12:06:43,801][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-22 12:06:43,801][root][INFO] - Score: 69.58 [%]  |  Evaluation Time: 4.54 [s]
[2024-09-22 12:06:43,804][root][INFO] - 
[11/ 15 Epoch]
[2024-09-22 12:06:44,589][root][INFO] - Step: 990/1035  |  Loss: 0.4833  |  Score: 86.94 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:44,689][root][INFO] - Step: 691/1035  |  Loss: 0.2448  |  Score: 94.56 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:51,245][root][INFO] - Step: 1005/1035  |  Loss: 0.4339  |  Score: 87.52 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:51,855][root][INFO] - Step: 705/1035  |  Loss: 0.2304  |  Score: 93.79 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:57,900][root][INFO] - Step: 1020/1035  |  Loss: 0.4956  |  Score: 86.21 [%]  |  Seq Length: 256.0
[2024-09-22 12:06:59,555][root][INFO] - Step: 720/1035  |  Loss: 0.2501  |  Score: 92.98 [%]  |  Seq Length: 256.0
[2024-09-22 12:07:04,601][root][INFO] - Step: 1035/1035  |  Loss: 0.4675  |  Score: 86.12 [%]  |  Seq Length: 256.0
[2024-09-22 12:07:07,287][root][INFO] - Step: 735/1035  |  Loss: 0.2484  |  Score: 93.34 [%]  |  Seq Length: 256.0
[2024-09-22 12:07:07,720][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-22 12:07:07,720][root][INFO] - Score: 76.71 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-22 12:07:10,760][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-22 12:07:10,760][root][INFO] - Score: 71.66 [%]  |  Evaluation Time: 3.04 [s]
[2024-09-22 12:07:10,761][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 12:07:10,762][root][INFO] - - Epoch: 12
[2024-09-22 12:07:10,762][root][INFO] - - DEV score: 76.35 [%]
[2024-09-22 12:07:10,762][root][INFO] - - TEST score: 72.65 [%]
[2024-09-22 12:07:10,763][root][INFO] - Fine-tuning is done!
[2024-09-22 12:07:14,956][root][INFO] - Step: 750/1035  |  Loss: 0.2348  |  Score: 93.82 [%]  |  Seq Length: 256.0
[2024-09-22 12:07:19,633][root][INFO] - Step: 759/1035  |  Loss: 0.2423  |  Score: 94.03 [%]  |  Seq Length: 256.0
[2024-09-22 12:07:24,519][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-22 12:07:24,519][root][INFO] - Score: 78.06 [%]  |  Evaluation Time: 4.88 [s]
[2024-09-22 12:07:29,175][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-22 12:07:29,175][root][INFO] - Score: 71.06 [%]  |  Evaluation Time: 4.65 [s]
[2024-09-22 12:07:29,177][root][INFO] - 
[12/ 15 Epoch]
[2024-09-22 12:07:32,673][root][INFO] - Step: 765/1035  |  Loss: 0.2229  |  Score: 94.65 [%]  |  Seq Length: 256.0
[2024-09-22 12:07:40,407][root][INFO] - Step: 780/1035  |  Loss: 0.2147  |  Score: 93.82 [%]  |  Seq Length: 256.0
[2024-09-22 12:07:48,148][root][INFO] - Step: 795/1035  |  Loss: 0.1919  |  Score: 94.78 [%]  |  Seq Length: 256.0
[2024-09-22 12:07:55,764][root][INFO] - Step: 810/1035  |  Loss: 0.1901  |  Score: 93.81 [%]  |  Seq Length: 256.0
[2024-09-22 12:08:03,397][root][INFO] - Step: 825/1035  |  Loss: 0.1926  |  Score: 94.45 [%]  |  Seq Length: 256.0
[2024-09-22 12:08:04,997][root][INFO] - Step: 828/1035  |  Loss: 0.2197  |  Score: 94.66 [%]  |  Seq Length: 256.0
[2024-09-22 12:08:09,878][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-22 12:08:09,879][root][INFO] - Score: 78.99 [%]  |  Evaluation Time: 4.88 [s]
[2024-09-22 12:08:14,493][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-22 12:08:14,493][root][INFO] - Score: 70.67 [%]  |  Evaluation Time: 4.61 [s]
[2024-09-22 12:08:14,496][root][INFO] - 
[13/ 15 Epoch]
[2024-09-22 12:08:20,955][root][INFO] - Step: 840/1035  |  Loss: 0.1851  |  Score: 95.15 [%]  |  Seq Length: 256.0
[2024-09-22 12:08:28,681][root][INFO] - Step: 855/1035  |  Loss: 0.1860  |  Score: 94.60 [%]  |  Seq Length: 256.0
[2024-09-22 12:08:36,342][root][INFO] - Step: 870/1035  |  Loss: 0.1954  |  Score: 94.64 [%]  |  Seq Length: 256.0
[2024-09-22 12:08:44,037][root][INFO] - Step: 885/1035  |  Loss: 0.1810  |  Score: 94.78 [%]  |  Seq Length: 256.0
[2024-09-22 12:08:50,228][root][INFO] - Step: 897/1035  |  Loss: 0.1887  |  Score: 94.72 [%]  |  Seq Length: 256.0
[2024-09-22 12:08:55,122][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-22 12:08:55,122][root][INFO] - Score: 78.88 [%]  |  Evaluation Time: 4.89 [s]
[2024-09-22 12:08:59,707][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-22 12:08:59,707][root][INFO] - Score: 70.55 [%]  |  Evaluation Time: 4.58 [s]
[2024-09-22 12:08:59,710][root][INFO] - 
[14/ 15 Epoch]
[2024-09-22 12:09:01,653][root][INFO] - Step: 900/1035  |  Loss: 0.1624  |  Score: 95.40 [%]  |  Seq Length: 256.0
[2024-09-22 12:09:09,343][root][INFO] - Step: 915/1035  |  Loss: 0.1665  |  Score: 94.89 [%]  |  Seq Length: 256.0
[2024-09-22 12:09:17,023][root][INFO] - Step: 930/1035  |  Loss: 0.1847  |  Score: 95.17 [%]  |  Seq Length: 256.0
[2024-09-22 12:09:24,689][root][INFO] - Step: 945/1035  |  Loss: 0.1707  |  Score: 94.69 [%]  |  Seq Length: 256.0
[2024-09-22 12:09:32,401][root][INFO] - Step: 960/1035  |  Loss: 0.1808  |  Score: 95.44 [%]  |  Seq Length: 256.0
[2024-09-22 12:09:35,521][root][INFO] - Step: 966/1035  |  Loss: 0.1863  |  Score: 94.11 [%]  |  Seq Length: 256.0
[2024-09-22 12:09:40,343][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-22 12:09:40,343][root][INFO] - Score: 78.47 [%]  |  Evaluation Time: 4.82 [s]
[2024-09-22 12:09:45,013][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-22 12:09:45,013][root][INFO] - Score: 71.47 [%]  |  Evaluation Time: 4.67 [s]
[2024-09-22 12:09:45,016][root][INFO] - 
[15/ 15 Epoch]
[2024-09-22 12:09:50,003][root][INFO] - Step: 975/1035  |  Loss: 0.1725  |  Score: 94.58 [%]  |  Seq Length: 256.0
[2024-09-22 12:09:57,725][root][INFO] - Step: 990/1035  |  Loss: 0.1651  |  Score: 95.29 [%]  |  Seq Length: 256.0
[2024-09-22 12:10:05,401][root][INFO] - Step: 1005/1035  |  Loss: 0.1560  |  Score: 95.00 [%]  |  Seq Length: 256.0
[2024-09-22 12:10:13,052][root][INFO] - Step: 1020/1035  |  Loss: 0.1843  |  Score: 95.02 [%]  |  Seq Length: 256.0
[2024-09-22 12:10:20,771][root][INFO] - Step: 1035/1035  |  Loss: 0.1750  |  Score: 95.00 [%]  |  Seq Length: 256.0
[2024-09-22 12:10:25,684][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-22 12:10:25,686][root][INFO] - Score: 79.54 [%]  |  Evaluation Time: 4.91 [s]
[2024-09-22 12:10:30,360][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-22 12:10:30,360][root][INFO] - Score: 71.36 [%]  |  Evaluation Time: 4.67 [s]
[2024-09-22 12:10:30,361][root][INFO] - 
Save new Best Score (Epoch: 15)
[2024-09-22 12:10:30,361][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 12:10:30,361][root][INFO] - - Epoch: 15
[2024-09-22 12:10:30,361][root][INFO] - - DEV score: 79.54 [%]
[2024-09-22 12:10:30,361][root][INFO] - - TEST score: 71.36 [%]
[2024-09-22 12:10:30,362][root][INFO] - Fine-tuning is done!
[2024-09-22 12:15:10,317][root][INFO] - 

[2024-09-22 12:15:10,317][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 12:15:10,317][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.0001lr_42rs
[2024-09-22 12:15:10,317][root][INFO] - 

[2024-09-22 12:15:10,317][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'PAWS_X'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.0001, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 75, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.0001lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.0001lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.0001lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 12:15:19,017][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 12:15:19,550][root][INFO] - 

[2024-09-22 12:15:19,550][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 12:15:19,550][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs
[2024-09-22 12:15:19,550][root][INFO] - 

[2024-09-22 12:15:19,550][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'PAWS_X'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 75, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 12:15:20,838][root][INFO] - 

[2024-09-22 12:15:20,839][root][INFO] - ========== Fine-tuning on PAWS_X ==========
[2024-09-22 12:15:20,839][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 12:15:20,855][root][INFO] - vocab size              : 51200
[2024-09-22 12:15:20,855][root][INFO] - device                  : gpu
[2024-09-22 12:15:20,855][root][INFO] - random seed             : 42
[2024-09-22 12:15:20,855][root][INFO] - train data size         : 24256
[2024-09-22 12:15:20,856][root][INFO] - max epochs              : 5
[2024-09-22 12:15:20,856][root][INFO] - total steps             : 1895
[2024-09-22 12:15:20,856][root][INFO] - warmup steps            : 190
[2024-09-22 12:15:20,856][root][INFO] - batch size              : 64
[2024-09-22 12:15:20,856][root][INFO] - accumulation steps      : 1
[2024-09-22 12:15:20,856][root][INFO] - optimizer               : adamwscale
[2024-09-22 12:15:20,856][root][INFO] - lr_scheduler            : cosine
[2024-09-22 12:15:20,856][root][INFO] - learning rate           : 0.0001
[2024-09-22 12:15:20,857][root][INFO] - max length              : 256

[2024-09-22 12:15:20,857][root][INFO] - 

[2024-09-22 12:15:20,857][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.0001lr_42rs
[2024-09-22 12:15:20,857][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.0001lr_42rs/ckpt
[2024-09-22 12:15:20,857][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.0001lr_42rs/tb
[2024-09-22 12:15:20,857][root][INFO] - * tb interval           : 75

[2024-09-22 12:15:20,857][root][INFO] - 

[2024-09-22 12:15:20,857][root][INFO] - Start the Training !
[2024-09-22 12:15:20,861][root][INFO] - 
[1/ 5 Epoch]
[2024-09-22 12:15:27,906][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:27,907][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:27,907][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:27,908][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:27,908][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:27,909][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:27,909][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:27,910][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:27,911][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:27,911][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:27,912][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:27,912][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:27,913][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:27,913][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:27,914][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:27,914][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:27,915][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:27,915][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:27,915][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:27,916][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:27,919][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:27,919][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:27,920][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:27,920][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:27,923][root][INFO] - Trainable params: 1769472 || all params: 126935040 || trainable: 1.39 %
[2024-09-22 12:15:28,106][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 12:15:29,813][root][INFO] - 

[2024-09-22 12:15:29,813][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 12:15:29,813][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs
[2024-09-22 12:15:29,813][root][INFO] - 

[2024-09-22 12:15:29,813][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'PAWS_X'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 75, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 12:15:30,074][root][INFO] - 

[2024-09-22 12:15:30,075][root][INFO] - ========== Fine-tuning on PAWS_X ==========
[2024-09-22 12:15:30,075][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 12:15:30,084][root][INFO] - vocab size              : 51200
[2024-09-22 12:15:30,084][root][INFO] - device                  : gpu
[2024-09-22 12:15:30,084][root][INFO] - random seed             : 42
[2024-09-22 12:15:30,085][root][INFO] - train data size         : 24256
[2024-09-22 12:15:30,085][root][INFO] - max epochs              : 5
[2024-09-22 12:15:30,085][root][INFO] - total steps             : 1895
[2024-09-22 12:15:30,085][root][INFO] - warmup steps            : 190
[2024-09-22 12:15:30,085][root][INFO] - batch size              : 64
[2024-09-22 12:15:30,085][root][INFO] - accumulation steps      : 1
[2024-09-22 12:15:30,085][root][INFO] - optimizer               : adamwscale
[2024-09-22 12:15:30,085][root][INFO] - lr_scheduler            : cosine
[2024-09-22 12:15:30,085][root][INFO] - learning rate           : 0.02
[2024-09-22 12:15:30,085][root][INFO] - max length              : 256

[2024-09-22 12:15:30,085][root][INFO] - LoRA Configuration
[2024-09-22 12:15:30,086][root][INFO] - ㄴ r                    : 32
[2024-09-22 12:15:30,086][root][INFO] - ㄴ alpha                : 128
[2024-09-22 12:15:30,086][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 12:15:30,086][root][INFO] - 

[2024-09-22 12:15:30,086][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs
[2024-09-22 12:15:30,086][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs/ckpt
[2024-09-22 12:15:30,086][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs/tb
[2024-09-22 12:15:30,086][root][INFO] - * tb interval           : 75

[2024-09-22 12:15:30,086][root][INFO] - 

[2024-09-22 12:15:30,086][root][INFO] - Start the Training !
[2024-09-22 12:15:30,090][root][INFO] - 
[1/ 5 Epoch]
[2024-09-22 12:15:38,098][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:38,099][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:38,099][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:38,099][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:38,100][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:38,100][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:38,101][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:38,101][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:38,102][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:38,102][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:38,102][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:38,103][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:38,103][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:38,104][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:38,104][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:38,105][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:38,105][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:38,105][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:38,106][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:38,106][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:38,108][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:38,109][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:38,109][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 12:15:38,109][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 12:15:38,111][root][INFO] - Trainable params: 1769472 || all params: 126935040 || trainable: 1.39 %
[2024-09-22 12:15:38,115][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-22 12:15:38,219][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-22 12:15:38,221][root][INFO] - Trainable params: 8985600 || all params: 134151168 || trainable: 6.70 %
[2024-09-22 12:15:38,400][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 12:15:41,529][root][INFO] - 

[2024-09-22 12:15:41,529][root][INFO] - ========== Fine-tuning on PAWS_X ==========
[2024-09-22 12:15:41,530][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 12:15:41,537][root][INFO] - vocab size              : 51200
[2024-09-22 12:15:41,538][root][INFO] - device                  : gpu
[2024-09-22 12:15:41,538][root][INFO] - random seed             : 42
[2024-09-22 12:15:41,538][root][INFO] - train data size         : 24256
[2024-09-22 12:15:41,538][root][INFO] - max epochs              : 5
[2024-09-22 12:15:41,538][root][INFO] - total steps             : 1895
[2024-09-22 12:15:41,538][root][INFO] - warmup steps            : 190
[2024-09-22 12:15:41,538][root][INFO] - batch size              : 64
[2024-09-22 12:15:41,538][root][INFO] - accumulation steps      : 1
[2024-09-22 12:15:41,538][root][INFO] - optimizer               : adamwscale
[2024-09-22 12:15:41,538][root][INFO] - lr_scheduler            : cosine
[2024-09-22 12:15:41,539][root][INFO] - learning rate           : 0.02
[2024-09-22 12:15:41,539][root][INFO] - max length              : 256

[2024-09-22 12:15:41,539][root][INFO] - LoRA Configuration
[2024-09-22 12:15:41,539][root][INFO] - ㄴ r                    : 32
[2024-09-22 12:15:41,539][root][INFO] - ㄴ alpha                : 128
[2024-09-22 12:15:41,539][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 12:15:41,539][root][INFO] - KOMBO Configuration
[2024-09-22 12:15:41,539][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-22 12:15:41,539][root][INFO] - ㄴ reducer              : linear
[2024-09-22 12:15:41,539][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-22 12:15:41,539][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-22 12:15:41,539][root][INFO] - ㄴ do_combination       : True
[2024-09-22 12:15:41,540][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-22 12:15:41,540][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-22 12:15:41,540][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-22 12:15:41,540][root][INFO] -   ㄴ add_lora           : False
[2024-09-22 12:15:41,540][root][INFO] - 

[2024-09-22 12:15:41,540][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs
[2024-09-22 12:15:41,540][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs/ckpt
[2024-09-22 12:15:41,540][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs/tb
[2024-09-22 12:15:41,540][root][INFO] - * tb interval           : 75

[2024-09-22 12:15:41,540][root][INFO] - 

[2024-09-22 12:15:41,540][root][INFO] - Start the Training !
[2024-09-22 12:15:41,544][root][INFO] - 
[1/ 5 Epoch]
[2024-09-22 12:15:55,399][root][INFO] - Step: 75/1895  |  Loss: 0.7329  |  Score: 51.83 [%]  |  Seq Length: 256.0
[2024-09-22 12:15:59,204][root][INFO] - Step: 75/1895  |  Loss: 0.7296  |  Score: 52.40 [%]  |  Seq Length: 256.0
[2024-09-22 12:16:25,259][root][INFO] - Step: 75/1895  |  Loss: 0.7094  |  Score: 52.27 [%]  |  Seq Length: 256.0
[2024-09-22 12:16:26,658][root][INFO] - Step: 150/1895  |  Loss: 0.7112  |  Score: 51.56 [%]  |  Seq Length: 256.0
[2024-09-22 12:16:28,430][root][INFO] - Step: 150/1895  |  Loss: 0.7017  |  Score: 52.44 [%]  |  Seq Length: 256.0
[2024-09-22 12:16:54,191][root][INFO] - Step: 225/1895  |  Loss: 0.6971  |  Score: 53.79 [%]  |  Seq Length: 256.0
[2024-09-22 12:17:01,588][root][INFO] - Step: 225/1895  |  Loss: 0.6946  |  Score: 53.75 [%]  |  Seq Length: 256.0
[2024-09-22 12:17:08,749][root][INFO] - Step: 150/1895  |  Loss: 0.6945  |  Score: 54.29 [%]  |  Seq Length: 256.0
[2024-09-22 12:17:21,704][root][INFO] - Step: 300/1895  |  Loss: 0.6802  |  Score: 57.77 [%]  |  Seq Length: 256.0
[2024-09-22 12:17:34,816][root][INFO] - Step: 300/1895  |  Loss: 0.6940  |  Score: 54.37 [%]  |  Seq Length: 256.0
[2024-09-22 12:17:49,246][root][INFO] - Step: 375/1895  |  Loss: 0.6685  |  Score: 58.73 [%]  |  Seq Length: 256.0
[2024-09-22 12:17:50,522][root][INFO] - Step: 379/1895  |  Loss: 0.6578  |  Score: 62.37 [%]  |  Seq Length: 256.0
[2024-09-22 12:17:52,159][root][INFO] - Step: 225/1895  |  Loss: 0.7064  |  Score: 51.94 [%]  |  Seq Length: 256.0
[2024-09-22 12:17:53,122][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 12:17:53,122][root][INFO] - Score: 59.90 [%]  |  Evaluation Time: 2.60 [s]
[2024-09-22 12:17:55,687][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 12:17:55,688][root][INFO] - Score: 59.32 [%]  |  Evaluation Time: 2.56 [s]
[2024-09-22 12:17:55,689][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 12:17:55,690][root][INFO] - 
[2/ 5 Epoch]
[2024-09-22 12:18:07,996][root][INFO] - Step: 375/1895  |  Loss: 0.6867  |  Score: 55.04 [%]  |  Seq Length: 256.0
[2024-09-22 12:18:09,521][root][INFO] - Step: 379/1895  |  Loss: 0.6657  |  Score: 58.46 [%]  |  Seq Length: 256.0
[2024-09-22 12:18:12,170][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 12:18:12,170][root][INFO] - Score: 51.95 [%]  |  Evaluation Time: 2.65 [s]
[2024-09-22 12:18:14,733][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 12:18:14,733][root][INFO] - Score: 56.37 [%]  |  Evaluation Time: 2.56 [s]
[2024-09-22 12:18:14,735][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 12:18:14,736][root][INFO] - 
[2/ 5 Epoch]
[2024-09-22 12:18:22,100][root][INFO] - Step: 450/1895  |  Loss: 0.6443  |  Score: 62.81 [%]  |  Seq Length: 256.0
[2024-09-22 12:18:35,269][root][INFO] - Step: 300/1895  |  Loss: 0.6909  |  Score: 55.42 [%]  |  Seq Length: 256.0
[2024-09-22 12:18:46,684][root][INFO] - Step: 450/1895  |  Loss: 0.6799  |  Score: 57.17 [%]  |  Seq Length: 256.0
[2024-09-22 12:18:49,734][root][INFO] - Step: 525/1895  |  Loss: 0.6469  |  Score: 62.40 [%]  |  Seq Length: 256.0
[2024-09-22 12:19:17,311][root][INFO] - Step: 600/1895  |  Loss: 0.6065  |  Score: 66.60 [%]  |  Seq Length: 256.0
[2024-09-22 12:19:18,350][root][INFO] - Step: 375/1895  |  Loss: 0.6450  |  Score: 62.19 [%]  |  Seq Length: 256.0
[2024-09-22 12:19:19,852][root][INFO] - Step: 525/1895  |  Loss: 0.6789  |  Score: 57.71 [%]  |  Seq Length: 256.0
[2024-09-22 12:19:20,363][root][INFO] - Step: 379/1895  |  Loss: 0.6376  |  Score: 69.27 [%]  |  Seq Length: 256.0
[2024-09-22 12:19:25,170][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 12:19:25,171][root][INFO] - Score: 65.30 [%]  |  Evaluation Time: 4.80 [s]
[2024-09-22 12:19:29,711][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 12:19:29,711][root][INFO] - Score: 60.72 [%]  |  Evaluation Time: 4.54 [s]
[2024-09-22 12:19:29,712][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 12:19:29,714][root][INFO] - 
[2/ 5 Epoch]
[2024-09-22 12:19:44,942][root][INFO] - Step: 675/1895  |  Loss: 0.5816  |  Score: 69.96 [%]  |  Seq Length: 256.0
[2024-09-22 12:19:53,192][root][INFO] - Step: 600/1895  |  Loss: 0.6622  |  Score: 60.65 [%]  |  Seq Length: 256.0
[2024-09-22 12:20:11,016][root][INFO] - Step: 450/1895  |  Loss: 0.6110  |  Score: 66.20 [%]  |  Seq Length: 256.0
[2024-09-22 12:20:12,644][root][INFO] - Step: 750/1895  |  Loss: 0.5807  |  Score: 69.58 [%]  |  Seq Length: 256.0
[2024-09-22 12:20:15,434][root][INFO] - Step: 758/1895  |  Loss: 0.5694  |  Score: 73.05 [%]  |  Seq Length: 256.0
[2024-09-22 12:20:18,028][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 12:20:18,028][root][INFO] - Score: 67.35 [%]  |  Evaluation Time: 2.59 [s]
[2024-09-22 12:20:20,527][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 12:20:20,528][root][INFO] - Score: 63.36 [%]  |  Evaluation Time: 2.50 [s]
[2024-09-22 12:20:20,529][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 12:20:20,530][root][INFO] - 
[3/ 5 Epoch]
[2024-09-22 12:20:26,442][root][INFO] - Step: 675/1895  |  Loss: 0.6510  |  Score: 62.60 [%]  |  Seq Length: 256.0
[2024-09-22 12:20:45,475][root][INFO] - Step: 825/1895  |  Loss: 0.5226  |  Score: 74.04 [%]  |  Seq Length: 256.0
[2024-09-22 12:20:53,913][root][INFO] - Step: 525/1895  |  Loss: 0.5871  |  Score: 68.46 [%]  |  Seq Length: 256.0
[2024-09-22 12:20:59,813][root][INFO] - Step: 750/1895  |  Loss: 0.6530  |  Score: 62.96 [%]  |  Seq Length: 256.0
[2024-09-22 12:21:03,163][root][INFO] - Step: 758/1895  |  Loss: 0.6171  |  Score: 66.08 [%]  |  Seq Length: 256.0
[2024-09-22 12:21:05,791][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 12:21:05,791][root][INFO] - Score: 60.29 [%]  |  Evaluation Time: 2.62 [s]
[2024-09-22 12:21:08,367][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 12:21:08,367][root][INFO] - Score: 58.53 [%]  |  Evaluation Time: 2.57 [s]
[2024-09-22 12:21:08,369][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 12:21:08,370][root][INFO] - 
[3/ 5 Epoch]
[2024-09-22 12:21:13,110][root][INFO] - Step: 900/1895  |  Loss: 0.5195  |  Score: 74.15 [%]  |  Seq Length: 256.0
[2024-09-22 12:21:36,774][root][INFO] - Step: 600/1895  |  Loss: 0.5947  |  Score: 68.67 [%]  |  Seq Length: 256.0
[2024-09-22 12:21:38,471][root][INFO] - Step: 825/1895  |  Loss: 0.6006  |  Score: 67.84 [%]  |  Seq Length: 256.0
[2024-09-22 12:21:40,852][root][INFO] - Step: 975/1895  |  Loss: 0.5128  |  Score: 74.92 [%]  |  Seq Length: 256.0
[2024-09-22 12:22:08,575][root][INFO] - Step: 1050/1895  |  Loss: 0.5176  |  Score: 74.40 [%]  |  Seq Length: 256.0
[2024-09-22 12:22:11,878][root][INFO] - Step: 900/1895  |  Loss: 0.6085  |  Score: 67.31 [%]  |  Seq Length: 256.0
[2024-09-22 12:22:20,091][root][INFO] - Step: 675/1895  |  Loss: 0.5619  |  Score: 70.62 [%]  |  Seq Length: 256.0
[2024-09-22 12:22:36,252][root][INFO] - Step: 1125/1895  |  Loss: 0.5111  |  Score: 74.94 [%]  |  Seq Length: 256.0
[2024-09-22 12:22:40,489][root][INFO] - Step: 1137/1895  |  Loss: 0.4775  |  Score: 78.08 [%]  |  Seq Length: 256.0
[2024-09-22 12:22:43,070][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 12:22:43,071][root][INFO] - Score: 66.63 [%]  |  Evaluation Time: 2.58 [s]
[2024-09-22 12:22:45,111][root][INFO] - Step: 975/1895  |  Loss: 0.6027  |  Score: 67.33 [%]  |  Seq Length: 256.0
[2024-09-22 12:22:45,644][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 12:22:45,644][root][INFO] - Score: 66.76 [%]  |  Evaluation Time: 2.57 [s]
[2024-09-22 12:22:45,645][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 12:22:45,646][root][INFO] - 
[4/ 5 Epoch]
[2024-09-22 12:23:03,245][root][INFO] - Step: 750/1895  |  Loss: 0.5456  |  Score: 72.94 [%]  |  Seq Length: 256.0
[2024-09-22 12:23:07,483][root][INFO] - Step: 758/1895  |  Loss: 0.5557  |  Score: 73.37 [%]  |  Seq Length: 256.0
[2024-09-22 12:23:09,185][root][INFO] - Step: 1200/1895  |  Loss: 0.4586  |  Score: 78.17 [%]  |  Seq Length: 256.0
[2024-09-22 12:23:12,150][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 12:23:12,151][root][INFO] - Score: 64.78 [%]  |  Evaluation Time: 4.67 [s]
[2024-09-22 12:23:16,774][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 12:23:16,774][root][INFO] - Score: 65.50 [%]  |  Evaluation Time: 4.62 [s]
[2024-09-22 12:23:16,775][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 12:23:16,776][root][INFO] - 
[3/ 5 Epoch]
[2024-09-22 12:23:18,457][root][INFO] - Step: 1050/1895  |  Loss: 0.5992  |  Score: 68.00 [%]  |  Seq Length: 256.0
[2024-09-22 12:23:36,964][root][INFO] - Step: 1275/1895  |  Loss: 0.4513  |  Score: 77.81 [%]  |  Seq Length: 256.0
[2024-09-22 12:23:51,716][root][INFO] - Step: 1125/1895  |  Loss: 0.5870  |  Score: 69.35 [%]  |  Seq Length: 256.0
[2024-09-22 12:23:55,597][root][INFO] - Step: 825/1895  |  Loss: 0.5056  |  Score: 74.60 [%]  |  Seq Length: 256.0
[2024-09-22 12:23:56,816][root][INFO] - Step: 1137/1895  |  Loss: 0.5957  |  Score: 68.88 [%]  |  Seq Length: 256.0
[2024-09-22 12:23:59,464][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 12:23:59,464][root][INFO] - Score: 62.08 [%]  |  Evaluation Time: 2.65 [s]
[2024-09-22 12:24:02,053][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 12:24:02,053][root][INFO] - Score: 59.65 [%]  |  Evaluation Time: 2.59 [s]
[2024-09-22 12:24:02,054][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 12:24:02,055][root][INFO] - 
[4/ 5 Epoch]
[2024-09-22 12:24:04,672][root][INFO] - Step: 1350/1895  |  Loss: 0.4372  |  Score: 79.38 [%]  |  Seq Length: 256.0
[2024-09-22 12:24:30,596][root][INFO] - Step: 1200/1895  |  Loss: 0.5630  |  Score: 71.38 [%]  |  Seq Length: 256.0
[2024-09-22 12:24:32,382][root][INFO] - Step: 1425/1895  |  Loss: 0.4492  |  Score: 78.65 [%]  |  Seq Length: 256.0
[2024-09-22 12:24:38,920][root][INFO] - Step: 900/1895  |  Loss: 0.4922  |  Score: 75.77 [%]  |  Seq Length: 256.0
[2024-09-22 12:25:00,038][root][INFO] - Step: 1500/1895  |  Loss: 0.4171  |  Score: 81.35 [%]  |  Seq Length: 256.0
[2024-09-22 12:25:04,006][root][INFO] - Step: 1275/1895  |  Loss: 0.5598  |  Score: 71.08 [%]  |  Seq Length: 256.0
[2024-09-22 12:25:05,731][root][INFO] - Step: 1516/1895  |  Loss: 0.4459  |  Score: 78.29 [%]  |  Seq Length: 256.0
[2024-09-22 12:25:08,316][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 12:25:08,317][root][INFO] - Score: 69.50 [%]  |  Evaluation Time: 2.58 [s]
[2024-09-22 12:25:10,831][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 12:25:10,832][root][INFO] - Score: 67.30 [%]  |  Evaluation Time: 2.51 [s]
[2024-09-22 12:25:10,833][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-22 12:25:10,835][root][INFO] - 
[5/ 5 Epoch]
[2024-09-22 12:25:22,103][root][INFO] - Step: 975/1895  |  Loss: 0.4968  |  Score: 75.88 [%]  |  Seq Length: 256.0
[2024-09-22 12:25:32,904][root][INFO] - Step: 1575/1895  |  Loss: 0.3899  |  Score: 82.42 [%]  |  Seq Length: 256.0
[2024-09-22 12:25:37,357][root][INFO] - Step: 1350/1895  |  Loss: 0.5694  |  Score: 70.29 [%]  |  Seq Length: 256.0
[2024-09-22 12:26:00,543][root][INFO] - Step: 1650/1895  |  Loss: 0.3908  |  Score: 82.69 [%]  |  Seq Length: 256.0
[2024-09-22 12:26:05,028][root][INFO] - Step: 1050/1895  |  Loss: 0.4923  |  Score: 76.52 [%]  |  Seq Length: 256.0
[2024-09-22 12:26:10,681][root][INFO] - Step: 1425/1895  |  Loss: 0.5552  |  Score: 71.33 [%]  |  Seq Length: 256.0
[2024-09-22 12:26:28,171][root][INFO] - Step: 1725/1895  |  Loss: 0.3902  |  Score: 82.15 [%]  |  Seq Length: 256.0
[2024-09-22 12:26:44,134][root][INFO] - Step: 1500/1895  |  Loss: 0.5464  |  Score: 72.31 [%]  |  Seq Length: 256.0
[2024-09-22 12:26:48,287][root][INFO] - Step: 1125/1895  |  Loss: 0.4978  |  Score: 75.71 [%]  |  Seq Length: 256.0
[2024-09-22 12:26:51,014][root][INFO] - Step: 1516/1895  |  Loss: 0.5708  |  Score: 70.21 [%]  |  Seq Length: 256.0
[2024-09-22 12:26:53,679][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 12:26:53,679][root][INFO] - Score: 62.63 [%]  |  Evaluation Time: 2.66 [s]
[2024-09-22 12:26:54,917][root][INFO] - Step: 1137/1895  |  Loss: 0.4697  |  Score: 77.39 [%]  |  Seq Length: 256.0
[2024-09-22 12:26:55,804][root][INFO] - Step: 1800/1895  |  Loss: 0.3670  |  Score: 82.67 [%]  |  Seq Length: 256.0
[2024-09-22 12:26:56,260][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 12:26:56,260][root][INFO] - Score: 60.36 [%]  |  Evaluation Time: 2.58 [s]
[2024-09-22 12:26:56,261][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-22 12:26:56,262][root][INFO] - 
[5/ 5 Epoch]
[2024-09-22 12:26:59,511][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 12:26:59,512][root][INFO] - Score: 71.29 [%]  |  Evaluation Time: 4.59 [s]
[2024-09-22 12:27:04,201][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 12:27:04,201][root][INFO] - Score: 67.09 [%]  |  Evaluation Time: 4.69 [s]
[2024-09-22 12:27:04,202][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 12:27:04,204][root][INFO] - 
[4/ 5 Epoch]
[2024-09-22 12:27:23,032][root][INFO] - Step: 1575/1895  |  Loss: 0.5446  |  Score: 72.83 [%]  |  Seq Length: 256.0
[2024-09-22 12:27:23,561][root][INFO] - Step: 1875/1895  |  Loss: 0.3891  |  Score: 82.04 [%]  |  Seq Length: 256.0
[2024-09-22 12:27:30,724][root][INFO] - Step: 1895/1895  |  Loss: 0.3981  |  Score: 82.29 [%]  |  Seq Length: 256.0
[2024-09-22 12:27:33,288][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 12:27:33,289][root][INFO] - Score: 71.78 [%]  |  Evaluation Time: 2.56 [s]
[2024-09-22 12:27:35,813][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 12:27:35,813][root][INFO] - Score: 68.12 [%]  |  Evaluation Time: 2.52 [s]
[2024-09-22 12:27:35,814][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-22 12:27:35,814][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 12:27:35,814][root][INFO] - - Epoch: 5
[2024-09-22 12:27:35,814][root][INFO] - - DEV score: 71.78 [%]
[2024-09-22 12:27:35,814][root][INFO] - - TEST score: 68.12 [%]
[2024-09-22 12:27:35,815][root][INFO] - Fine-tuning is done!
[2024-09-22 12:27:40,805][root][INFO] - Step: 1200/1895  |  Loss: 0.4468  |  Score: 78.92 [%]  |  Seq Length: 256.0
[2024-09-22 12:27:56,377][root][INFO] - Step: 1650/1895  |  Loss: 0.5318  |  Score: 72.81 [%]  |  Seq Length: 256.0
[2024-09-22 12:28:23,578][root][INFO] - Step: 1275/1895  |  Loss: 0.4260  |  Score: 80.27 [%]  |  Seq Length: 256.0
[2024-09-22 12:28:29,702][root][INFO] - Step: 1725/1895  |  Loss: 0.5309  |  Score: 73.65 [%]  |  Seq Length: 256.0
[2024-09-22 12:29:03,064][root][INFO] - Step: 1800/1895  |  Loss: 0.5459  |  Score: 72.48 [%]  |  Seq Length: 256.0
[2024-09-22 12:29:06,364][root][INFO] - Step: 1350/1895  |  Loss: 0.4133  |  Score: 81.31 [%]  |  Seq Length: 256.0
[2024-09-22 12:29:36,399][root][INFO] - Step: 1875/1895  |  Loss: 0.5431  |  Score: 72.08 [%]  |  Seq Length: 256.0
[2024-09-22 12:29:45,079][root][INFO] - Step: 1895/1895  |  Loss: 0.5334  |  Score: 72.42 [%]  |  Seq Length: 256.0
[2024-09-22 12:29:47,700][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 12:29:47,700][root][INFO] - Score: 63.61 [%]  |  Evaluation Time: 2.62 [s]
[2024-09-22 12:29:49,166][root][INFO] - Step: 1425/1895  |  Loss: 0.4220  |  Score: 80.02 [%]  |  Seq Length: 256.0
[2024-09-22 12:29:50,262][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 12:29:50,262][root][INFO] - Score: 60.07 [%]  |  Evaluation Time: 2.56 [s]
[2024-09-22 12:29:50,264][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-22 12:29:50,264][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 12:29:50,264][root][INFO] - - Epoch: 5
[2024-09-22 12:29:50,264][root][INFO] - - DEV score: 63.61 [%]
[2024-09-22 12:29:50,264][root][INFO] - - TEST score: 60.07 [%]
[2024-09-22 12:29:50,265][root][INFO] - Fine-tuning is done!
[2024-09-22 12:30:31,896][root][INFO] - Step: 1500/1895  |  Loss: 0.4113  |  Score: 81.31 [%]  |  Seq Length: 256.0
[2024-09-22 12:30:40,696][root][INFO] - Step: 1516/1895  |  Loss: 0.3768  |  Score: 82.45 [%]  |  Seq Length: 256.0
[2024-09-22 12:30:45,266][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 12:30:45,266][root][INFO] - Score: 70.57 [%]  |  Evaluation Time: 4.57 [s]
[2024-09-22 12:30:49,847][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 12:30:49,847][root][INFO] - Score: 68.59 [%]  |  Evaluation Time: 4.58 [s]
[2024-09-22 12:30:49,848][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-22 12:30:49,850][root][INFO] - 
[5/ 5 Epoch]
[2024-09-22 12:31:23,839][root][INFO] - Step: 1575/1895  |  Loss: 0.3701  |  Score: 82.94 [%]  |  Seq Length: 256.0
[2024-09-22 12:32:06,386][root][INFO] - Step: 1650/1895  |  Loss: 0.3648  |  Score: 83.60 [%]  |  Seq Length: 256.0
[2024-09-22 12:32:49,074][root][INFO] - Step: 1725/1895  |  Loss: 0.3788  |  Score: 82.15 [%]  |  Seq Length: 256.0
[2024-09-22 12:33:31,623][root][INFO] - Step: 1800/1895  |  Loss: 0.3741  |  Score: 83.12 [%]  |  Seq Length: 256.0
[2024-09-22 12:34:14,266][root][INFO] - Step: 1875/1895  |  Loss: 0.3542  |  Score: 84.50 [%]  |  Seq Length: 256.0
[2024-09-22 12:34:25,234][root][INFO] - Step: 1895/1895  |  Loss: 0.3794  |  Score: 83.23 [%]  |  Seq Length: 256.0
[2024-09-22 12:34:29,840][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 12:34:29,840][root][INFO] - Score: 73.05 [%]  |  Evaluation Time: 4.60 [s]
[2024-09-22 12:34:34,387][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 12:34:34,387][root][INFO] - Score: 68.02 [%]  |  Evaluation Time: 4.54 [s]
[2024-09-22 12:34:34,388][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-22 12:34:34,388][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 12:34:34,388][root][INFO] - - Epoch: 5
[2024-09-22 12:34:34,388][root][INFO] - - DEV score: 73.05 [%]
[2024-09-22 12:34:34,388][root][INFO] - - TEST score: 68.02 [%]
[2024-09-22 12:34:34,389][root][INFO] - Fine-tuning is done!
[2024-09-22 12:41:43,075][root][INFO] - 

[2024-09-22 12:41:43,075][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 12:41:43,075][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs
[2024-09-22 12:41:43,075][root][INFO] - 

[2024-09-22 12:41:43,075][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 12:44:21,168][root][INFO] - 

[2024-09-22 12:44:21,168][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 12:44:21,169][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs
[2024-09-22 12:44:21,169][root][INFO] - 

[2024-09-22 12:44:21,169][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 12:44:40,902][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 12:44:40,902][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 12:44:40,903][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 12:44:40,903][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 12:44:40,904][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 12:44:40,904][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 12:44:40,905][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 12:44:40,905][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 12:44:40,905][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 12:44:40,906][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 12:44:40,906][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 12:44:40,907][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 12:44:40,907][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 12:44:40,908][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 12:44:40,908][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 12:44:40,908][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 12:44:40,909][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 12:44:40,909][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 12:44:40,910][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 12:44:40,910][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 12:44:40,911][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 12:44:40,911][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 12:44:40,912][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 12:44:40,912][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 12:44:40,914][root][INFO] - Trainable params: 1769472 || all params: 126935040 || trainable: 1.39 %
[2024-09-22 12:44:40,918][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-22 12:44:41,021][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-22 12:44:41,023][root][INFO] - Trainable params: 9034752 || all params: 134200320 || trainable: 6.73 %
[2024-09-22 12:44:41,239][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 12:44:44,340][root][INFO] - 

[2024-09-22 12:44:44,340][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-22 12:44:44,340][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 12:44:44,347][root][INFO] - vocab size              : 51200
[2024-09-22 12:44:44,347][root][INFO] - device                  : gpu
[2024-09-22 12:44:44,347][root][INFO] - random seed             : 42
[2024-09-22 12:44:44,347][root][INFO] - train data size         : 115456
[2024-09-22 12:44:44,348][root][INFO] - max epochs              : 5
[2024-09-22 12:44:44,348][root][INFO] - total steps             : 9020
[2024-09-22 12:44:44,348][root][INFO] - warmup steps            : 902
[2024-09-22 12:44:44,348][root][INFO] - batch size              : 64
[2024-09-22 12:44:44,348][root][INFO] - accumulation steps      : 1
[2024-09-22 12:44:44,348][root][INFO] - optimizer               : adamwscale
[2024-09-22 12:44:44,348][root][INFO] - lr_scheduler            : cosine
[2024-09-22 12:44:44,348][root][INFO] - learning rate           : 0.01
[2024-09-22 12:44:44,348][root][INFO] - max length              : 256

[2024-09-22 12:44:44,348][root][INFO] - LoRA Configuration
[2024-09-22 12:44:44,348][root][INFO] - ㄴ r                    : 32
[2024-09-22 12:44:44,348][root][INFO] - ㄴ alpha                : 128
[2024-09-22 12:44:44,349][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 12:44:44,349][root][INFO] - KOMBO Configuration
[2024-09-22 12:44:44,349][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-22 12:44:44,349][root][INFO] - ㄴ reducer              : linear
[2024-09-22 12:44:44,349][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-22 12:44:44,349][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-22 12:44:44,349][root][INFO] - ㄴ do_combination       : True
[2024-09-22 12:44:44,349][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-22 12:44:44,349][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-22 12:44:44,350][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-22 12:44:44,350][root][INFO] -   ㄴ add_lora           : True
[2024-09-22 12:44:44,350][root][INFO] -     ㄴ LoRA in KOMBO Configuration
[2024-09-22 12:44:44,350][root][INFO] -     ㄴ r                : 32
[2024-09-22 12:44:44,350][root][INFO] -     ㄴ alpha            : 128
[2024-09-22 12:44:44,350][root][INFO] -     ㄴ dropout          : 0.03

[2024-09-22 12:44:44,350][root][INFO] - 

[2024-09-22 12:44:44,350][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs
[2024-09-22 12:44:44,350][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-22 12:44:44,350][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/tb
[2024-09-22 12:44:44,351][root][INFO] - * tb interval           : 100

[2024-09-22 12:44:44,351][root][INFO] - 

[2024-09-22 12:44:44,351][root][INFO] - Start the Training !
[2024-09-22 12:44:44,354][root][INFO] - 
[1/ 5 Epoch]
[2024-09-22 12:45:24,794][root][INFO] - 

[2024-09-22 12:45:24,794][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 12:45:24,795][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs
[2024-09-22 12:45:24,795][root][INFO] - 

[2024-09-22 12:45:24,795][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 12:45:43,943][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 12:45:43,944][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 12:45:43,944][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 12:45:43,944][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 12:45:43,945][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 12:45:43,945][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 12:45:43,946][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 12:45:43,946][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 12:45:43,946][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 12:45:43,947][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 12:45:43,947][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 12:45:43,948][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 12:45:43,948][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 12:45:43,949][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 12:45:43,949][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 12:45:43,949][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 12:45:43,950][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 12:45:43,950][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 12:45:43,951][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 12:45:43,951][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 12:45:43,951][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 12:45:43,952][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 12:45:43,952][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 12:45:43,953][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 12:45:43,954][root][INFO] - Trainable params: 1769472 || all params: 126935040 || trainable: 1.39 %
[2024-09-22 12:45:43,958][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-22 12:45:44,062][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-22 12:45:44,064][root][INFO] - Trainable params: 9034752 || all params: 134200320 || trainable: 6.73 %
[2024-09-22 12:45:44,261][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 12:45:47,279][root][INFO] - 

[2024-09-22 12:45:47,280][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-22 12:45:47,280][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 12:45:47,287][root][INFO] - vocab size              : 51200
[2024-09-22 12:45:47,288][root][INFO] - device                  : gpu
[2024-09-22 12:45:47,288][root][INFO] - random seed             : 42
[2024-09-22 12:45:47,288][root][INFO] - train data size         : 115456
[2024-09-22 12:45:47,288][root][INFO] - max epochs              : 5
[2024-09-22 12:45:47,288][root][INFO] - total steps             : 9020
[2024-09-22 12:45:47,288][root][INFO] - warmup steps            : 902
[2024-09-22 12:45:47,288][root][INFO] - batch size              : 64
[2024-09-22 12:45:47,288][root][INFO] - accumulation steps      : 1
[2024-09-22 12:45:47,288][root][INFO] - optimizer               : adamwscale
[2024-09-22 12:45:47,288][root][INFO] - lr_scheduler            : cosine
[2024-09-22 12:45:47,289][root][INFO] - learning rate           : 0.01
[2024-09-22 12:45:47,289][root][INFO] - max length              : 256

[2024-09-22 12:45:47,289][root][INFO] - LoRA Configuration
[2024-09-22 12:45:47,289][root][INFO] - ㄴ r                    : 32
[2024-09-22 12:45:47,289][root][INFO] - ㄴ alpha                : 128
[2024-09-22 12:45:47,289][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 12:45:47,289][root][INFO] - KOMBO Configuration
[2024-09-22 12:45:47,289][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-22 12:45:47,289][root][INFO] - ㄴ reducer              : linear
[2024-09-22 12:45:47,290][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-22 12:45:47,290][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-22 12:45:47,290][root][INFO] - ㄴ do_combination       : True
[2024-09-22 12:45:47,290][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-22 12:45:47,290][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-22 12:45:47,290][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-22 12:45:47,290][root][INFO] -   ㄴ add_lora           : True
[2024-09-22 12:45:47,290][root][INFO] -     ㄴ LoRA in KOMBO Configuration
[2024-09-22 12:45:47,290][root][INFO] -     ㄴ r                : 32
[2024-09-22 12:45:47,291][root][INFO] -     ㄴ alpha            : 128
[2024-09-22 12:45:47,291][root][INFO] -     ㄴ dropout          : 0.03

[2024-09-22 12:45:47,291][root][INFO] - 

[2024-09-22 12:45:47,291][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs
[2024-09-22 12:45:47,291][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-22 12:45:47,291][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/tb
[2024-09-22 12:45:47,291][root][INFO] - * tb interval           : 100

[2024-09-22 12:45:47,291][root][INFO] - 

[2024-09-22 12:45:47,291][root][INFO] - Start the Training !
[2024-09-22 12:45:47,294][root][INFO] - 
[1/ 5 Epoch]
[2024-09-22 12:45:48,612][root][INFO] - 

[2024-09-22 12:45:48,612][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 12:45:48,613][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.01lr_42rs
[2024-09-22 12:45:48,613][root][INFO] - 

[2024-09-22 12:45:48,613][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 12:46:37,481][root][INFO] - Step: 100/9020  |  Loss: 0.5869  |  Score: 68.53 [%]  |  Seq Length: 256.0
[2024-09-22 12:46:44,953][root][INFO] - 

[2024-09-22 12:46:44,953][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 12:46:44,953][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs
[2024-09-22 12:46:44,953][root][INFO] - 

[2024-09-22 12:46:44,953][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'NSMC'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 100, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 12:47:04,634][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 12:47:04,635][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 12:47:04,636][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 12:47:04,636][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 12:47:04,637][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 12:47:04,637][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 12:47:04,638][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 12:47:04,638][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 12:47:04,639][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 12:47:04,639][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 12:47:04,640][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 12:47:04,640][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 12:47:04,641][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 12:47:04,641][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 12:47:04,642][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 12:47:04,642][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 12:47:04,643][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 12:47:04,643][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 12:47:04,644][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 12:47:04,644][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 12:47:04,645][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 12:47:04,645][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 12:47:04,646][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 12:47:04,646][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 12:47:04,648][root][INFO] - Trainable params: 1769472 || all params: 126935040 || trainable: 1.39 %
[2024-09-22 12:47:04,653][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-22 12:47:04,662][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-22 12:47:04,664][root][INFO] - Trainable params: 2445312 || all params: 127610880 || trainable: 1.92 %
[2024-09-22 12:47:04,851][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 12:47:06,757][root][INFO] - 

[2024-09-22 12:47:06,757][root][INFO] - ========== Fine-tuning on NSMC ==========
[2024-09-22 12:47:06,757][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 12:47:06,765][root][INFO] - vocab size              : 51200
[2024-09-22 12:47:06,765][root][INFO] - device                  : gpu
[2024-09-22 12:47:06,765][root][INFO] - random seed             : 42
[2024-09-22 12:47:06,765][root][INFO] - train data size         : 115456
[2024-09-22 12:47:06,765][root][INFO] - max epochs              : 5
[2024-09-22 12:47:06,765][root][INFO] - total steps             : 9020
[2024-09-22 12:47:06,766][root][INFO] - warmup steps            : 902
[2024-09-22 12:47:06,766][root][INFO] - batch size              : 64
[2024-09-22 12:47:06,766][root][INFO] - accumulation steps      : 1
[2024-09-22 12:47:06,766][root][INFO] - optimizer               : adamwscale
[2024-09-22 12:47:06,766][root][INFO] - lr_scheduler            : cosine
[2024-09-22 12:47:06,766][root][INFO] - learning rate           : 0.01
[2024-09-22 12:47:06,766][root][INFO] - max length              : 256

[2024-09-22 12:47:06,766][root][INFO] - LoRA Configuration
[2024-09-22 12:47:06,766][root][INFO] - ㄴ r                    : 32
[2024-09-22 12:47:06,766][root][INFO] - ㄴ alpha                : 128
[2024-09-22 12:47:06,766][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 12:47:06,767][root][INFO] - KOMBO Configuration
[2024-09-22 12:47:06,767][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-22 12:47:06,767][root][INFO] - ㄴ reducer              : linear
[2024-09-22 12:47:06,767][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-22 12:47:06,767][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-22 12:47:06,767][root][INFO] - ㄴ do_combination       : False
[2024-09-22 12:47:06,767][root][INFO] - 

[2024-09-22 12:47:06,767][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs
[2024-09-22 12:47:06,767][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-22 12:47:06,767][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/NSMC/256t_64b_1s_0.01lr_42rs/tb
[2024-09-22 12:47:06,767][root][INFO] - * tb interval           : 100

[2024-09-22 12:47:06,768][root][INFO] - 

[2024-09-22 12:47:06,768][root][INFO] - Start the Training !
[2024-09-22 12:47:06,771][root][INFO] - 
[1/ 5 Epoch]
[2024-09-22 12:47:26,725][root][INFO] - Step: 200/9020  |  Loss: 0.4385  |  Score: 80.33 [%]  |  Seq Length: 256.0
[2024-09-22 12:47:53,464][root][INFO] - Step: 100/9020  |  Loss: 0.5863  |  Score: 68.59 [%]  |  Seq Length: 256.0
[2024-09-22 12:48:16,233][root][INFO] - Step: 300/9020  |  Loss: 0.4220  |  Score: 80.72 [%]  |  Seq Length: 256.0
[2024-09-22 12:48:38,786][root][INFO] - Step: 200/9020  |  Loss: 0.4514  |  Score: 78.97 [%]  |  Seq Length: 256.0
[2024-09-22 12:49:05,661][root][INFO] - Step: 400/9020  |  Loss: 0.4040  |  Score: 81.73 [%]  |  Seq Length: 256.0
[2024-09-22 12:49:24,123][root][INFO] - Step: 300/9020  |  Loss: 0.4210  |  Score: 81.06 [%]  |  Seq Length: 256.0
[2024-09-22 12:49:55,054][root][INFO] - Step: 500/9020  |  Loss: 0.3787  |  Score: 83.58 [%]  |  Seq Length: 256.0
[2024-09-22 12:50:09,356][root][INFO] - Step: 400/9020  |  Loss: 0.4012  |  Score: 82.44 [%]  |  Seq Length: 256.0
[2024-09-22 12:50:44,365][root][INFO] - Step: 600/9020  |  Loss: 0.3875  |  Score: 82.86 [%]  |  Seq Length: 256.0
[2024-09-22 12:50:54,762][root][INFO] - Step: 500/9020  |  Loss: 0.3856  |  Score: 82.66 [%]  |  Seq Length: 256.0
[2024-09-22 12:51:34,176][root][INFO] - Step: 700/9020  |  Loss: 0.3675  |  Score: 83.25 [%]  |  Seq Length: 256.0
[2024-09-22 12:51:40,198][root][INFO] - Step: 600/9020  |  Loss: 0.3665  |  Score: 84.19 [%]  |  Seq Length: 256.0
[2024-09-22 12:52:23,589][root][INFO] - Step: 800/9020  |  Loss: 0.3626  |  Score: 84.25 [%]  |  Seq Length: 256.0
[2024-09-22 12:52:25,540][root][INFO] - Step: 700/9020  |  Loss: 0.3775  |  Score: 83.38 [%]  |  Seq Length: 256.0
[2024-09-22 12:53:10,792][root][INFO] - Step: 800/9020  |  Loss: 0.3794  |  Score: 82.75 [%]  |  Seq Length: 256.0
[2024-09-22 12:53:13,070][root][INFO] - Step: 900/9020  |  Loss: 0.3537  |  Score: 84.62 [%]  |  Seq Length: 256.0
[2024-09-22 12:53:56,122][root][INFO] - Step: 900/9020  |  Loss: 0.3782  |  Score: 83.14 [%]  |  Seq Length: 256.0
[2024-09-22 12:54:02,480][root][INFO] - Step: 1000/9020  |  Loss: 0.3565  |  Score: 84.39 [%]  |  Seq Length: 256.0
[2024-09-22 12:54:41,425][root][INFO] - Step: 1000/9020  |  Loss: 0.3679  |  Score: 83.78 [%]  |  Seq Length: 256.0
[2024-09-22 12:54:51,951][root][INFO] - Step: 1100/9020  |  Loss: 0.3341  |  Score: 85.56 [%]  |  Seq Length: 256.0
[2024-09-22 12:55:26,674][root][INFO] - Step: 1100/9020  |  Loss: 0.3668  |  Score: 83.56 [%]  |  Seq Length: 256.0
[2024-09-22 12:55:41,389][root][INFO] - Step: 1200/9020  |  Loss: 0.3398  |  Score: 85.30 [%]  |  Seq Length: 256.0
[2024-09-22 12:56:11,615][root][INFO] - Step: 1200/9020  |  Loss: 0.3720  |  Score: 83.41 [%]  |  Seq Length: 256.0
[2024-09-22 12:56:30,891][root][INFO] - Step: 1300/9020  |  Loss: 0.3400  |  Score: 84.94 [%]  |  Seq Length: 256.0
[2024-09-22 12:56:56,882][root][INFO] - Step: 1300/9020  |  Loss: 0.3563  |  Score: 84.12 [%]  |  Seq Length: 256.0
[2024-09-22 12:57:20,385][root][INFO] - Step: 1400/9020  |  Loss: 0.3295  |  Score: 86.09 [%]  |  Seq Length: 256.0
[2024-09-22 12:57:42,236][root][INFO] - Step: 1400/9020  |  Loss: 0.3543  |  Score: 84.05 [%]  |  Seq Length: 256.0
[2024-09-22 12:58:09,808][root][INFO] - Step: 1500/9020  |  Loss: 0.3284  |  Score: 85.84 [%]  |  Seq Length: 256.0
[2024-09-22 12:58:27,760][root][INFO] - Step: 1500/9020  |  Loss: 0.3590  |  Score: 83.81 [%]  |  Seq Length: 256.0
[2024-09-22 12:58:59,149][root][INFO] - Step: 1600/9020  |  Loss: 0.3350  |  Score: 85.50 [%]  |  Seq Length: 256.0
[2024-09-22 12:59:12,960][root][INFO] - Step: 1600/9020  |  Loss: 0.3590  |  Score: 84.17 [%]  |  Seq Length: 256.0
[2024-09-22 12:59:48,654][root][INFO] - Step: 1700/9020  |  Loss: 0.3249  |  Score: 86.23 [%]  |  Seq Length: 256.0
[2024-09-22 12:59:57,613][root][INFO] - Step: 1700/9020  |  Loss: 0.3499  |  Score: 84.12 [%]  |  Seq Length: 256.0
[2024-09-22 13:00:37,987][root][INFO] - Step: 1800/9020  |  Loss: 0.3309  |  Score: 85.73 [%]  |  Seq Length: 256.0
[2024-09-22 13:00:39,990][root][INFO] - Step: 1804/9020  |  Loss: 0.3400  |  Score: 86.39 [%]  |  Seq Length: 256.0
[2024-09-22 13:00:43,167][root][INFO] - Step: 1800/9020  |  Loss: 0.3500  |  Score: 84.58 [%]  |  Seq Length: 256.0
[2024-09-22 13:00:44,998][root][INFO] - Step: 1804/9020  |  Loss: 0.4322  |  Score: 79.81 [%]  |  Seq Length: 256.0
[2024-09-22 13:01:24,633][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 13:01:24,633][root][INFO] - Score: 86.92 [%]  |  Evaluation Time: 44.64 [s]
[2024-09-22 13:01:26,808][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 13:01:26,808][root][INFO] - Score: 85.74 [%]  |  Evaluation Time: 41.81 [s]
[2024-09-22 13:03:44,533][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 13:03:44,534][root][INFO] - Score: 85.62 [%]  |  Evaluation Time: 137.72 [s]
[2024-09-22 13:03:44,535][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 13:03:44,536][root][INFO] - 
[2/ 5 Epoch]
[2024-09-22 13:03:51,947][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 13:03:51,947][root][INFO] - Score: 86.67 [%]  |  Evaluation Time: 147.31 [s]
[2024-09-22 13:03:51,949][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 13:03:51,950][root][INFO] - 
[2/ 5 Epoch]
[2024-09-22 13:04:28,371][root][INFO] - Step: 1900/9020  |  Loss: 0.3478  |  Score: 85.03 [%]  |  Seq Length: 256.0
[2024-09-22 13:04:39,854][root][INFO] - Step: 1900/9020  |  Loss: 0.2927  |  Score: 87.71 [%]  |  Seq Length: 256.0
[2024-09-22 13:05:13,664][root][INFO] - Step: 2000/9020  |  Loss: 0.3172  |  Score: 86.00 [%]  |  Seq Length: 256.0
[2024-09-22 13:05:29,289][root][INFO] - Step: 2000/9020  |  Loss: 0.2986  |  Score: 87.72 [%]  |  Seq Length: 256.0
[2024-09-22 13:05:58,957][root][INFO] - Step: 2100/9020  |  Loss: 0.3365  |  Score: 85.69 [%]  |  Seq Length: 256.0
[2024-09-22 13:06:18,618][root][INFO] - Step: 2100/9020  |  Loss: 0.2886  |  Score: 87.45 [%]  |  Seq Length: 256.0
[2024-09-22 13:06:44,240][root][INFO] - Step: 2200/9020  |  Loss: 0.3151  |  Score: 86.22 [%]  |  Seq Length: 256.0
[2024-09-22 13:07:08,436][root][INFO] - Step: 2200/9020  |  Loss: 0.2998  |  Score: 87.25 [%]  |  Seq Length: 256.0
[2024-09-22 13:07:29,622][root][INFO] - Step: 2300/9020  |  Loss: 0.3296  |  Score: 85.72 [%]  |  Seq Length: 256.0
[2024-09-22 13:07:57,942][root][INFO] - Step: 2300/9020  |  Loss: 0.3073  |  Score: 86.44 [%]  |  Seq Length: 256.0
[2024-09-22 13:08:15,070][root][INFO] - Step: 2400/9020  |  Loss: 0.3272  |  Score: 85.59 [%]  |  Seq Length: 256.0
[2024-09-22 13:08:47,607][root][INFO] - Step: 2400/9020  |  Loss: 0.2877  |  Score: 88.25 [%]  |  Seq Length: 256.0
[2024-09-22 13:09:00,630][root][INFO] - Step: 2500/9020  |  Loss: 0.3115  |  Score: 86.64 [%]  |  Seq Length: 256.0
[2024-09-22 13:09:37,072][root][INFO] - Step: 2500/9020  |  Loss: 0.3055  |  Score: 86.78 [%]  |  Seq Length: 256.0
[2024-09-22 13:09:45,940][root][INFO] - Step: 2600/9020  |  Loss: 0.3191  |  Score: 86.36 [%]  |  Seq Length: 256.0
[2024-09-22 13:10:26,711][root][INFO] - Step: 2600/9020  |  Loss: 0.2918  |  Score: 87.61 [%]  |  Seq Length: 256.0
[2024-09-22 13:10:31,262][root][INFO] - Step: 2700/9020  |  Loss: 0.3323  |  Score: 85.45 [%]  |  Seq Length: 256.0
[2024-09-22 13:11:16,141][root][INFO] - Step: 2700/9020  |  Loss: 0.2904  |  Score: 87.78 [%]  |  Seq Length: 256.0
[2024-09-22 13:11:16,578][root][INFO] - Step: 2800/9020  |  Loss: 0.3306  |  Score: 85.84 [%]  |  Seq Length: 256.0
[2024-09-22 13:12:01,870][root][INFO] - Step: 2900/9020  |  Loss: 0.3293  |  Score: 85.31 [%]  |  Seq Length: 256.0
[2024-09-22 13:12:05,895][root][INFO] - Step: 2800/9020  |  Loss: 0.2961  |  Score: 87.38 [%]  |  Seq Length: 256.0
[2024-09-22 13:12:47,181][root][INFO] - Step: 3000/9020  |  Loss: 0.3083  |  Score: 86.52 [%]  |  Seq Length: 256.0
[2024-09-22 13:12:55,708][root][INFO] - Step: 2900/9020  |  Loss: 0.3003  |  Score: 87.64 [%]  |  Seq Length: 256.0
[2024-09-22 13:13:32,511][root][INFO] - Step: 3100/9020  |  Loss: 0.3120  |  Score: 86.25 [%]  |  Seq Length: 256.0
[2024-09-22 13:13:45,196][root][INFO] - Step: 3000/9020  |  Loss: 0.2993  |  Score: 88.05 [%]  |  Seq Length: 256.0
[2024-09-22 13:14:17,795][root][INFO] - Step: 3200/9020  |  Loss: 0.3066  |  Score: 86.89 [%]  |  Seq Length: 256.0
[2024-09-22 13:14:34,851][root][INFO] - Step: 3100/9020  |  Loss: 0.2858  |  Score: 88.02 [%]  |  Seq Length: 256.0
[2024-09-22 13:15:03,468][root][INFO] - Step: 3300/9020  |  Loss: 0.3077  |  Score: 87.02 [%]  |  Seq Length: 256.0
[2024-09-22 13:15:24,720][root][INFO] - Step: 3200/9020  |  Loss: 0.2889  |  Score: 87.78 [%]  |  Seq Length: 256.0
[2024-09-22 13:15:49,417][root][INFO] - Step: 3400/9020  |  Loss: 0.3039  |  Score: 86.62 [%]  |  Seq Length: 256.0
[2024-09-22 13:16:14,107][root][INFO] - Step: 3300/9020  |  Loss: 0.2902  |  Score: 87.77 [%]  |  Seq Length: 256.0
[2024-09-22 13:16:35,001][root][INFO] - Step: 3500/9020  |  Loss: 0.3005  |  Score: 87.20 [%]  |  Seq Length: 256.0
[2024-09-22 13:17:03,564][root][INFO] - Step: 3400/9020  |  Loss: 0.2923  |  Score: 87.25 [%]  |  Seq Length: 256.0
[2024-09-22 13:17:20,288][root][INFO] - Step: 3600/9020  |  Loss: 0.3166  |  Score: 86.73 [%]  |  Seq Length: 256.0
[2024-09-22 13:17:23,925][root][INFO] - Step: 3608/9020  |  Loss: 0.3246  |  Score: 86.08 [%]  |  Seq Length: 256.0
[2024-09-22 13:17:52,997][root][INFO] - Step: 3500/9020  |  Loss: 0.2986  |  Score: 87.19 [%]  |  Seq Length: 256.0
[2024-09-22 13:18:05,310][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 13:18:05,310][root][INFO] - Score: 86.84 [%]  |  Evaluation Time: 41.38 [s]
[2024-09-22 13:18:42,519][root][INFO] - Step: 3600/9020  |  Loss: 0.2918  |  Score: 87.38 [%]  |  Seq Length: 256.0
[2024-09-22 13:18:46,509][root][INFO] - Step: 3608/9020  |  Loss: 0.2855  |  Score: 87.69 [%]  |  Seq Length: 256.0
[2024-09-22 13:19:31,229][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 13:19:31,229][root][INFO] - Score: 87.85 [%]  |  Evaluation Time: 44.72 [s]
[2024-09-22 13:20:22,064][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 13:20:22,064][root][INFO] - Score: 86.89 [%]  |  Evaluation Time: 136.75 [s]
[2024-09-22 13:20:22,065][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 13:20:22,067][root][INFO] - 
[3/ 5 Epoch]
[2024-09-22 13:21:04,306][root][INFO] - Step: 3700/9020  |  Loss: 0.2785  |  Score: 87.84 [%]  |  Seq Length: 256.0
[2024-09-22 13:21:49,883][root][INFO] - Step: 3800/9020  |  Loss: 0.2791  |  Score: 87.88 [%]  |  Seq Length: 256.0
[2024-09-22 13:21:58,417][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 13:21:58,418][root][INFO] - Score: 87.62 [%]  |  Evaluation Time: 147.19 [s]
[2024-09-22 13:21:58,419][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 13:21:58,420][root][INFO] - 
[3/ 5 Epoch]
[2024-09-22 13:22:35,178][root][INFO] - Step: 3900/9020  |  Loss: 0.2799  |  Score: 87.83 [%]  |  Seq Length: 256.0
[2024-09-22 13:22:44,166][root][INFO] - Step: 3700/9020  |  Loss: 0.2520  |  Score: 89.78 [%]  |  Seq Length: 256.0
[2024-09-22 13:23:20,502][root][INFO] - Step: 4000/9020  |  Loss: 0.2819  |  Score: 88.31 [%]  |  Seq Length: 256.0
[2024-09-22 13:23:33,635][root][INFO] - Step: 3800/9020  |  Loss: 0.2581  |  Score: 89.16 [%]  |  Seq Length: 256.0
[2024-09-22 13:24:05,800][root][INFO] - Step: 4100/9020  |  Loss: 0.2764  |  Score: 88.61 [%]  |  Seq Length: 256.0
[2024-09-22 13:24:23,048][root][INFO] - Step: 3900/9020  |  Loss: 0.2509  |  Score: 89.72 [%]  |  Seq Length: 256.0
[2024-09-22 13:24:51,102][root][INFO] - Step: 4200/9020  |  Loss: 0.2784  |  Score: 88.66 [%]  |  Seq Length: 256.0
[2024-09-22 13:25:12,628][root][INFO] - Step: 4000/9020  |  Loss: 0.2446  |  Score: 90.05 [%]  |  Seq Length: 256.0
[2024-09-22 13:25:36,391][root][INFO] - Step: 4300/9020  |  Loss: 0.2780  |  Score: 88.19 [%]  |  Seq Length: 256.0
[2024-09-22 13:26:02,493][root][INFO] - Step: 4100/9020  |  Loss: 0.2537  |  Score: 89.59 [%]  |  Seq Length: 256.0
[2024-09-22 13:26:21,691][root][INFO] - Step: 4400/9020  |  Loss: 0.2738  |  Score: 88.34 [%]  |  Seq Length: 256.0
[2024-09-22 13:26:52,314][root][INFO] - Step: 4200/9020  |  Loss: 0.2611  |  Score: 89.05 [%]  |  Seq Length: 256.0
[2024-09-22 13:27:07,016][root][INFO] - Step: 4500/9020  |  Loss: 0.2828  |  Score: 87.66 [%]  |  Seq Length: 256.0
[2024-09-22 13:27:42,097][root][INFO] - Step: 4300/9020  |  Loss: 0.2554  |  Score: 89.30 [%]  |  Seq Length: 256.0
[2024-09-22 13:27:52,432][root][INFO] - Step: 4600/9020  |  Loss: 0.2800  |  Score: 88.42 [%]  |  Seq Length: 256.0
[2024-09-22 13:28:31,585][root][INFO] - Step: 4400/9020  |  Loss: 0.2523  |  Score: 89.66 [%]  |  Seq Length: 256.0
[2024-09-22 13:28:37,938][root][INFO] - Step: 4700/9020  |  Loss: 0.2774  |  Score: 88.31 [%]  |  Seq Length: 256.0
[2024-09-22 13:29:21,007][root][INFO] - Step: 4500/9020  |  Loss: 0.2550  |  Score: 89.42 [%]  |  Seq Length: 256.0
[2024-09-22 13:29:23,283][root][INFO] - Step: 4800/9020  |  Loss: 0.2834  |  Score: 87.89 [%]  |  Seq Length: 256.0
[2024-09-22 13:30:08,666][root][INFO] - Step: 4900/9020  |  Loss: 0.2689  |  Score: 89.03 [%]  |  Seq Length: 256.0
[2024-09-22 13:30:10,413][root][INFO] - Step: 4600/9020  |  Loss: 0.2593  |  Score: 89.14 [%]  |  Seq Length: 256.0
[2024-09-22 13:30:53,942][root][INFO] - Step: 5000/9020  |  Loss: 0.2737  |  Score: 88.47 [%]  |  Seq Length: 256.0
[2024-09-22 13:30:59,809][root][INFO] - Step: 4700/9020  |  Loss: 0.2552  |  Score: 89.41 [%]  |  Seq Length: 256.0
[2024-09-22 13:31:39,476][root][INFO] - Step: 5100/9020  |  Loss: 0.2662  |  Score: 89.08 [%]  |  Seq Length: 256.0
[2024-09-22 13:31:49,509][root][INFO] - Step: 4800/9020  |  Loss: 0.2508  |  Score: 89.67 [%]  |  Seq Length: 256.0
[2024-09-22 13:32:25,029][root][INFO] - Step: 5200/9020  |  Loss: 0.2652  |  Score: 88.66 [%]  |  Seq Length: 256.0
[2024-09-22 13:32:38,982][root][INFO] - Step: 4900/9020  |  Loss: 0.2466  |  Score: 90.30 [%]  |  Seq Length: 256.0
[2024-09-22 13:33:10,315][root][INFO] - Step: 5300/9020  |  Loss: 0.2702  |  Score: 88.70 [%]  |  Seq Length: 256.0
[2024-09-22 13:33:28,535][root][INFO] - Step: 5000/9020  |  Loss: 0.2523  |  Score: 89.39 [%]  |  Seq Length: 256.0
[2024-09-22 13:33:55,621][root][INFO] - Step: 5400/9020  |  Loss: 0.2712  |  Score: 88.50 [%]  |  Seq Length: 256.0
[2024-09-22 13:34:01,091][root][INFO] - Step: 5412/9020  |  Loss: 0.2654  |  Score: 88.43 [%]  |  Seq Length: 256.0
[2024-09-22 13:34:18,070][root][INFO] - Step: 5100/9020  |  Loss: 0.2613  |  Score: 89.23 [%]  |  Seq Length: 256.0
[2024-09-22 13:34:42,538][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 13:34:42,538][root][INFO] - Score: 88.12 [%]  |  Evaluation Time: 41.44 [s]
[2024-09-22 13:35:07,589][root][INFO] - Step: 5200/9020  |  Loss: 0.2572  |  Score: 89.73 [%]  |  Seq Length: 256.0
[2024-09-22 13:35:57,045][root][INFO] - Step: 5300/9020  |  Loss: 0.2566  |  Score: 89.42 [%]  |  Seq Length: 256.0
[2024-09-22 13:36:46,730][root][INFO] - Step: 5400/9020  |  Loss: 0.2494  |  Score: 89.97 [%]  |  Seq Length: 256.0
[2024-09-22 13:36:52,698][root][INFO] - Step: 5412/9020  |  Loss: 0.2576  |  Score: 88.87 [%]  |  Seq Length: 256.0
[2024-09-22 13:36:59,392][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 13:36:59,392][root][INFO] - Score: 88.02 [%]  |  Evaluation Time: 136.85 [s]
[2024-09-22 13:36:59,393][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 13:36:59,394][root][INFO] - 
[4/ 5 Epoch]
[2024-09-22 13:37:37,378][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 13:37:37,379][root][INFO] - Score: 88.43 [%]  |  Evaluation Time: 44.68 [s]
[2024-09-22 13:37:39,615][root][INFO] - Step: 5500/9020  |  Loss: 0.2248  |  Score: 90.84 [%]  |  Seq Length: 256.0
[2024-09-22 13:38:24,888][root][INFO] - Step: 5600/9020  |  Loss: 0.2425  |  Score: 90.20 [%]  |  Seq Length: 256.0
[2024-09-22 13:39:10,253][root][INFO] - Step: 5700/9020  |  Loss: 0.2500  |  Score: 89.75 [%]  |  Seq Length: 256.0
[2024-09-22 13:39:54,571][root][INFO] - Step: 5800/9020  |  Loss: 0.2392  |  Score: 90.27 [%]  |  Seq Length: 256.0
[2024-09-22 13:40:04,522][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 13:40:04,523][root][INFO] - Score: 88.22 [%]  |  Evaluation Time: 147.14 [s]
[2024-09-22 13:40:04,523][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 13:40:04,525][root][INFO] - 
[4/ 5 Epoch]
[2024-09-22 13:40:39,263][root][INFO] - Step: 5900/9020  |  Loss: 0.2468  |  Score: 89.67 [%]  |  Seq Length: 256.0
[2024-09-22 13:40:48,723][root][INFO] - Step: 5500/9020  |  Loss: 0.2180  |  Score: 91.30 [%]  |  Seq Length: 256.0
[2024-09-22 13:41:24,535][root][INFO] - Step: 6000/9020  |  Loss: 0.2401  |  Score: 89.94 [%]  |  Seq Length: 256.0
[2024-09-22 13:41:38,371][root][INFO] - Step: 5600/9020  |  Loss: 0.2113  |  Score: 91.66 [%]  |  Seq Length: 256.0
[2024-09-22 13:42:09,829][root][INFO] - Step: 6100/9020  |  Loss: 0.2256  |  Score: 90.64 [%]  |  Seq Length: 256.0
[2024-09-22 13:42:28,321][root][INFO] - Step: 5700/9020  |  Loss: 0.2166  |  Score: 91.52 [%]  |  Seq Length: 256.0
[2024-09-22 13:42:55,139][root][INFO] - Step: 6200/9020  |  Loss: 0.2303  |  Score: 90.92 [%]  |  Seq Length: 256.0
[2024-09-22 13:43:18,146][root][INFO] - Step: 5800/9020  |  Loss: 0.2212  |  Score: 90.66 [%]  |  Seq Length: 256.0
[2024-09-22 13:43:40,434][root][INFO] - Step: 6300/9020  |  Loss: 0.2428  |  Score: 90.05 [%]  |  Seq Length: 256.0
[2024-09-22 13:44:07,564][root][INFO] - Step: 5900/9020  |  Loss: 0.2280  |  Score: 90.95 [%]  |  Seq Length: 256.0
[2024-09-22 13:44:25,771][root][INFO] - Step: 6400/9020  |  Loss: 0.2321  |  Score: 90.39 [%]  |  Seq Length: 256.0
[2024-09-22 13:44:57,008][root][INFO] - Step: 6000/9020  |  Loss: 0.2247  |  Score: 91.02 [%]  |  Seq Length: 256.0
[2024-09-22 13:45:11,137][root][INFO] - Step: 6500/9020  |  Loss: 0.2402  |  Score: 90.75 [%]  |  Seq Length: 256.0
[2024-09-22 13:45:46,443][root][INFO] - Step: 6100/9020  |  Loss: 0.2294  |  Score: 90.70 [%]  |  Seq Length: 256.0
[2024-09-22 13:45:56,388][root][INFO] - Step: 6600/9020  |  Loss: 0.2384  |  Score: 90.00 [%]  |  Seq Length: 256.0
[2024-09-22 13:46:35,882][root][INFO] - Step: 6200/9020  |  Loss: 0.2167  |  Score: 91.56 [%]  |  Seq Length: 256.0
[2024-09-22 13:46:41,714][root][INFO] - Step: 6700/9020  |  Loss: 0.2381  |  Score: 90.66 [%]  |  Seq Length: 256.0
[2024-09-22 13:47:25,325][root][INFO] - Step: 6300/9020  |  Loss: 0.2148  |  Score: 91.19 [%]  |  Seq Length: 256.0
[2024-09-22 13:47:27,074][root][INFO] - Step: 6800/9020  |  Loss: 0.2302  |  Score: 90.06 [%]  |  Seq Length: 256.0
[2024-09-22 13:48:12,306][root][INFO] - Step: 6900/9020  |  Loss: 0.2250  |  Score: 90.73 [%]  |  Seq Length: 256.0
[2024-09-22 13:48:14,831][root][INFO] - Step: 6400/9020  |  Loss: 0.2174  |  Score: 91.39 [%]  |  Seq Length: 256.0
[2024-09-22 13:48:57,603][root][INFO] - Step: 7000/9020  |  Loss: 0.2471  |  Score: 89.62 [%]  |  Seq Length: 256.0
[2024-09-22 13:49:04,250][root][INFO] - Step: 6500/9020  |  Loss: 0.1997  |  Score: 91.88 [%]  |  Seq Length: 256.0
[2024-09-22 13:49:43,000][root][INFO] - Step: 7100/9020  |  Loss: 0.2352  |  Score: 90.48 [%]  |  Seq Length: 256.0
[2024-09-22 13:49:53,690][root][INFO] - Step: 6600/9020  |  Loss: 0.2103  |  Score: 91.48 [%]  |  Seq Length: 256.0
[2024-09-22 13:50:28,427][root][INFO] - Step: 7200/9020  |  Loss: 0.2255  |  Score: 90.62 [%]  |  Seq Length: 256.0
[2024-09-22 13:50:35,715][root][INFO] - Step: 7216/9020  |  Loss: 0.2105  |  Score: 91.74 [%]  |  Seq Length: 256.0
[2024-09-22 13:50:43,598][root][INFO] - Step: 6700/9020  |  Loss: 0.2171  |  Score: 91.59 [%]  |  Seq Length: 256.0
[2024-09-22 13:51:17,383][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 13:51:17,383][root][INFO] - Score: 88.51 [%]  |  Evaluation Time: 41.67 [s]
[2024-09-22 13:51:33,141][root][INFO] - Step: 6800/9020  |  Loss: 0.2130  |  Score: 91.20 [%]  |  Seq Length: 256.0
[2024-09-22 13:52:22,794][root][INFO] - Step: 6900/9020  |  Loss: 0.2245  |  Score: 91.08 [%]  |  Seq Length: 256.0
[2024-09-22 13:53:12,241][root][INFO] - Step: 7000/9020  |  Loss: 0.2105  |  Score: 91.50 [%]  |  Seq Length: 256.0
[2024-09-22 13:53:35,048][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 13:53:35,048][root][INFO] - Score: 88.44 [%]  |  Evaluation Time: 137.66 [s]
[2024-09-22 13:53:35,049][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-22 13:53:35,051][root][INFO] - 
[5/ 5 Epoch]
[2024-09-22 13:54:01,877][root][INFO] - Step: 7100/9020  |  Loss: 0.2178  |  Score: 91.16 [%]  |  Seq Length: 256.0
[2024-09-22 13:54:13,502][root][INFO] - Step: 7300/9020  |  Loss: 0.2092  |  Score: 91.63 [%]  |  Seq Length: 256.0
[2024-09-22 13:54:51,333][root][INFO] - Step: 7200/9020  |  Loss: 0.2182  |  Score: 90.84 [%]  |  Seq Length: 256.0
[2024-09-22 13:54:58,795][root][INFO] - Step: 7400/9020  |  Loss: 0.2071  |  Score: 91.97 [%]  |  Seq Length: 256.0
[2024-09-22 13:54:59,247][root][INFO] - Step: 7216/9020  |  Loss: 0.2157  |  Score: 91.62 [%]  |  Seq Length: 256.0
[2024-09-22 13:55:43,959][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 13:55:43,959][root][INFO] - Score: 88.65 [%]  |  Evaluation Time: 44.71 [s]
[2024-09-22 13:55:44,058][root][INFO] - Step: 7500/9020  |  Loss: 0.2053  |  Score: 91.55 [%]  |  Seq Length: 256.0
[2024-09-22 13:56:29,871][root][INFO] - Step: 7600/9020  |  Loss: 0.2131  |  Score: 91.14 [%]  |  Seq Length: 256.0
[2024-09-22 13:57:15,218][root][INFO] - Step: 7700/9020  |  Loss: 0.2093  |  Score: 91.30 [%]  |  Seq Length: 256.0
[2024-09-22 13:58:00,661][root][INFO] - Step: 7800/9020  |  Loss: 0.2150  |  Score: 91.16 [%]  |  Seq Length: 256.0
[2024-09-22 13:58:11,328][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 13:58:11,328][root][INFO] - Score: 88.34 [%]  |  Evaluation Time: 147.37 [s]
[2024-09-22 13:58:11,329][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-22 13:58:11,330][root][INFO] - 
[5/ 5 Epoch]
[2024-09-22 13:58:45,989][root][INFO] - Step: 7900/9020  |  Loss: 0.2066  |  Score: 91.59 [%]  |  Seq Length: 256.0
[2024-09-22 13:58:53,297][root][INFO] - Step: 7300/9020  |  Loss: 0.1935  |  Score: 92.22 [%]  |  Seq Length: 256.0
[2024-09-22 13:59:31,317][root][INFO] - Step: 8000/9020  |  Loss: 0.2132  |  Score: 91.39 [%]  |  Seq Length: 256.0
[2024-09-22 13:59:42,669][root][INFO] - Step: 7400/9020  |  Loss: 0.1877  |  Score: 92.64 [%]  |  Seq Length: 256.0
[2024-09-22 14:00:16,803][root][INFO] - Step: 8100/9020  |  Loss: 0.2071  |  Score: 91.52 [%]  |  Seq Length: 256.0
[2024-09-22 14:00:32,012][root][INFO] - Step: 7500/9020  |  Loss: 0.1997  |  Score: 91.78 [%]  |  Seq Length: 256.0
[2024-09-22 14:01:02,104][root][INFO] - Step: 8200/9020  |  Loss: 0.2113  |  Score: 91.78 [%]  |  Seq Length: 256.0
[2024-09-22 14:01:21,718][root][INFO] - Step: 7600/9020  |  Loss: 0.2011  |  Score: 91.86 [%]  |  Seq Length: 256.0
[2024-09-22 14:01:47,383][root][INFO] - Step: 8300/9020  |  Loss: 0.2097  |  Score: 91.50 [%]  |  Seq Length: 256.0
[2024-09-22 14:02:11,240][root][INFO] - Step: 7700/9020  |  Loss: 0.1926  |  Score: 92.56 [%]  |  Seq Length: 256.0
[2024-09-22 14:02:32,659][root][INFO] - Step: 8400/9020  |  Loss: 0.2081  |  Score: 91.73 [%]  |  Seq Length: 256.0
[2024-09-22 14:03:00,596][root][INFO] - Step: 7800/9020  |  Loss: 0.1967  |  Score: 91.95 [%]  |  Seq Length: 256.0
[2024-09-22 14:03:18,100][root][INFO] - Step: 8500/9020  |  Loss: 0.2127  |  Score: 91.08 [%]  |  Seq Length: 256.0
[2024-09-22 14:03:50,101][root][INFO] - Step: 7900/9020  |  Loss: 0.1865  |  Score: 92.55 [%]  |  Seq Length: 256.0
[2024-09-22 14:04:03,485][root][INFO] - Step: 8600/9020  |  Loss: 0.2073  |  Score: 91.17 [%]  |  Seq Length: 256.0
[2024-09-22 14:04:39,629][root][INFO] - Step: 8000/9020  |  Loss: 0.1967  |  Score: 92.03 [%]  |  Seq Length: 256.0
[2024-09-22 14:04:49,190][root][INFO] - Step: 8700/9020  |  Loss: 0.2099  |  Score: 91.56 [%]  |  Seq Length: 256.0
[2024-09-22 14:05:29,256][root][INFO] - Step: 8100/9020  |  Loss: 0.2031  |  Score: 92.19 [%]  |  Seq Length: 256.0
[2024-09-22 14:05:34,700][root][INFO] - Step: 8800/9020  |  Loss: 0.2189  |  Score: 91.30 [%]  |  Seq Length: 256.0
[2024-09-22 14:06:18,684][root][INFO] - Step: 8200/9020  |  Loss: 0.1881  |  Score: 92.39 [%]  |  Seq Length: 256.0
[2024-09-22 14:06:19,985][root][INFO] - Step: 8900/9020  |  Loss: 0.1939  |  Score: 92.41 [%]  |  Seq Length: 256.0
[2024-09-22 14:07:05,363][root][INFO] - Step: 9000/9020  |  Loss: 0.2095  |  Score: 91.39 [%]  |  Seq Length: 256.0
[2024-09-22 14:07:08,137][root][INFO] - Step: 8300/9020  |  Loss: 0.1923  |  Score: 92.67 [%]  |  Seq Length: 256.0
[2024-09-22 14:07:14,492][root][INFO] - Step: 9020/9020  |  Loss: 0.2046  |  Score: 91.98 [%]  |  Seq Length: 256.0
[2024-09-22 14:07:55,922][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 14:07:55,923][root][INFO] - Score: 88.31 [%]  |  Evaluation Time: 41.43 [s]
[2024-09-22 14:07:57,856][root][INFO] - Step: 8400/9020  |  Loss: 0.1971  |  Score: 92.19 [%]  |  Seq Length: 256.0
[2024-09-22 14:08:45,936][root][INFO] - Step: 8500/9020  |  Loss: 0.1899  |  Score: 92.83 [%]  |  Seq Length: 256.0
[2024-09-22 14:09:34,016][root][INFO] - Step: 8600/9020  |  Loss: 0.1870  |  Score: 92.52 [%]  |  Seq Length: 256.0
[2024-09-22 14:10:13,633][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 14:10:13,633][root][INFO] - Score: 88.49 [%]  |  Evaluation Time: 137.71 [s]
[2024-09-22 14:10:13,634][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 14:10:13,635][root][INFO] - - Epoch: 4
[2024-09-22 14:10:13,635][root][INFO] - - DEV score: 88.51 [%]
[2024-09-22 14:10:13,635][root][INFO] - - TEST score: 88.44 [%]
[2024-09-22 14:10:13,635][root][INFO] - Fine-tuning is done!
[2024-09-22 14:10:23,540][root][INFO] - Step: 8700/9020  |  Loss: 0.1963  |  Score: 92.05 [%]  |  Seq Length: 256.0
[2024-09-22 14:11:12,913][root][INFO] - Step: 8800/9020  |  Loss: 0.1876  |  Score: 92.64 [%]  |  Seq Length: 256.0
[2024-09-22 14:12:02,239][root][INFO] - Step: 8900/9020  |  Loss: 0.1932  |  Score: 92.27 [%]  |  Seq Length: 256.0
[2024-09-22 14:12:50,158][root][INFO] - Step: 9000/9020  |  Loss: 0.1940  |  Score: 91.98 [%]  |  Seq Length: 256.0
[2024-09-22 14:12:59,796][root][INFO] - Step: 9020/9020  |  Loss: 0.1756  |  Score: 93.01 [%]  |  Seq Length: 256.0
[2024-09-22 14:13:44,298][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 14:13:44,298][root][INFO] - Score: 88.73 [%]  |  Evaluation Time: 44.50 [s]
[2024-09-22 14:16:11,825][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 14:16:11,825][root][INFO] - Score: 88.51 [%]  |  Evaluation Time: 147.52 [s]
[2024-09-22 14:16:11,826][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-22 14:16:11,826][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 14:16:11,827][root][INFO] - - Epoch: 5
[2024-09-22 14:16:11,827][root][INFO] - - DEV score: 88.73 [%]
[2024-09-22 14:16:11,827][root][INFO] - - TEST score: 88.51 [%]
[2024-09-22 14:16:11,828][root][INFO] - Fine-tuning is done!
[2024-09-22 14:40:24,084][root][INFO] - 

[2024-09-22 14:40:24,085][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 14:40:24,085][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-22 14:40:24,085][root][INFO] - 

[2024-09-22 14:40:24,085][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 14:40:29,351][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:29,352][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:29,352][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:29,353][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:29,354][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:29,354][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:29,355][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:29,355][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:29,356][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:29,356][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:29,357][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:29,357][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:29,358][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:29,358][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:29,359][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:29,359][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:29,360][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:29,360][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:29,361][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:29,361][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:29,362][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:29,362][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:29,363][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:29,363][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:29,365][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-22 14:40:29,369][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-22 14:40:29,480][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-22 14:40:29,482][root][INFO] - Trainable params: 9034752 || all params: 134199552 || trainable: 6.73 %
[2024-09-22 14:40:29,672][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 14:40:32,894][root][INFO] - 

[2024-09-22 14:40:32,894][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-22 14:40:32,894][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 14:40:32,903][root][INFO] - vocab size              : 51200
[2024-09-22 14:40:32,903][root][INFO] - device                  : gpu
[2024-09-22 14:40:32,903][root][INFO] - random seed             : 42
[2024-09-22 14:40:32,904][root][INFO] - train data size         : 4416
[2024-09-22 14:40:32,904][root][INFO] - max epochs              : 15
[2024-09-22 14:40:32,904][root][INFO] - total steps             : 1035
[2024-09-22 14:40:32,904][root][INFO] - warmup steps            : 104
[2024-09-22 14:40:32,904][root][INFO] - batch size              : 64
[2024-09-22 14:40:32,904][root][INFO] - accumulation steps      : 1
[2024-09-22 14:40:32,904][root][INFO] - optimizer               : adamwscale
[2024-09-22 14:40:32,904][root][INFO] - lr_scheduler            : cosine
[2024-09-22 14:40:32,904][root][INFO] - learning rate           : 0.01
[2024-09-22 14:40:32,904][root][INFO] - max length              : 256

[2024-09-22 14:40:32,904][root][INFO] - LoRA Configuration
[2024-09-22 14:40:32,905][root][INFO] - ㄴ r                    : 32
[2024-09-22 14:40:32,905][root][INFO] - ㄴ alpha                : 128
[2024-09-22 14:40:32,905][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 14:40:32,905][root][INFO] - KOMBO Configuration
[2024-09-22 14:40:32,905][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-22 14:40:32,905][root][INFO] - ㄴ reducer              : linear
[2024-09-22 14:40:32,905][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-22 14:40:32,905][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-22 14:40:32,905][root][INFO] - ㄴ do_combination       : True
[2024-09-22 14:40:32,905][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-22 14:40:32,906][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-22 14:40:32,906][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-22 14:40:32,906][root][INFO] -   ㄴ add_lora           : True
[2024-09-22 14:40:32,906][root][INFO] -     ㄴ LoRA in KOMBO Configuration
[2024-09-22 14:40:32,906][root][INFO] -     ㄴ r                : 32
[2024-09-22 14:40:32,906][root][INFO] -     ㄴ alpha            : 128
[2024-09-22 14:40:32,906][root][INFO] -     ㄴ dropout          : 0.03

[2024-09-22 14:40:32,906][root][INFO] - 

[2024-09-22 14:40:32,906][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-22 14:40:32,906][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-22 14:40:32,907][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb
[2024-09-22 14:40:32,907][root][INFO] - * tb interval           : 15

[2024-09-22 14:40:32,907][root][INFO] - 

[2024-09-22 14:40:32,907][root][INFO] - Start the Training !
[2024-09-22 14:40:32,910][root][INFO] - 
[1/ 15 Epoch]
[2024-09-22 14:40:37,022][root][INFO] - 

[2024-09-22 14:40:37,022][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 14:40:37,022][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-22 14:40:37,022][root][INFO] - 

[2024-09-22 14:40:37,022][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 14:40:41,302][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:41,302][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:41,303][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:41,303][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:41,304][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:41,304][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:41,305][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:41,305][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:41,306][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:41,306][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:41,307][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:41,307][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:41,308][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:41,308][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:41,309][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:41,309][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:41,310][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:41,310][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:41,311][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:41,311][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:41,312][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:41,312][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:41,313][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 14:40:41,313][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 14:40:41,315][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-22 14:40:41,319][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-22 14:40:41,321][root][INFO] - Step: 15/1035  |  Loss: 3.1755  |  Score: 6.57 [%]  |  Seq Length: 256.0
[2024-09-22 14:40:41,328][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-22 14:40:41,330][root][INFO] - Trainable params: 2445312 || all params: 127610112 || trainable: 1.92 %
[2024-09-22 14:40:41,508][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 14:40:43,367][root][INFO] - 

[2024-09-22 14:40:43,367][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-22 14:40:43,367][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 14:40:43,377][root][INFO] - vocab size              : 51200
[2024-09-22 14:40:43,377][root][INFO] - device                  : gpu
[2024-09-22 14:40:43,377][root][INFO] - random seed             : 42
[2024-09-22 14:40:43,377][root][INFO] - train data size         : 4416
[2024-09-22 14:40:43,377][root][INFO] - max epochs              : 15
[2024-09-22 14:40:43,377][root][INFO] - total steps             : 1035
[2024-09-22 14:40:43,377][root][INFO] - warmup steps            : 104
[2024-09-22 14:40:43,377][root][INFO] - batch size              : 64
[2024-09-22 14:40:43,377][root][INFO] - accumulation steps      : 1
[2024-09-22 14:40:43,377][root][INFO] - optimizer               : adamwscale
[2024-09-22 14:40:43,378][root][INFO] - lr_scheduler            : cosine
[2024-09-22 14:40:43,378][root][INFO] - learning rate           : 0.01
[2024-09-22 14:40:43,378][root][INFO] - max length              : 256

[2024-09-22 14:40:43,378][root][INFO] - LoRA Configuration
[2024-09-22 14:40:43,378][root][INFO] - ㄴ r                    : 32
[2024-09-22 14:40:43,378][root][INFO] - ㄴ alpha                : 128
[2024-09-22 14:40:43,378][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 14:40:43,378][root][INFO] - KOMBO Configuration
[2024-09-22 14:40:43,378][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-22 14:40:43,378][root][INFO] - ㄴ reducer              : linear
[2024-09-22 14:40:43,378][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-22 14:40:43,379][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-22 14:40:43,379][root][INFO] - ㄴ do_combination       : False
[2024-09-22 14:40:43,379][root][INFO] - 

[2024-09-22 14:40:43,379][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-22 14:40:43,379][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-22 14:40:43,379][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb
[2024-09-22 14:40:43,379][root][INFO] - * tb interval           : 15

[2024-09-22 14:40:43,379][root][INFO] - 

[2024-09-22 14:40:43,379][root][INFO] - Start the Training !
[2024-09-22 14:40:43,382][root][INFO] - 
[1/ 15 Epoch]
[2024-09-22 14:40:49,081][root][INFO] - Step: 30/1035  |  Loss: 2.2292  |  Score: 15.33 [%]  |  Seq Length: 256.0
[2024-09-22 14:40:51,886][root][INFO] - Step: 15/1035  |  Loss: 3.3616  |  Score: 1.68 [%]  |  Seq Length: 256.0
[2024-09-22 14:40:56,752][root][INFO] - Step: 45/1035  |  Loss: 1.9333  |  Score: 44.29 [%]  |  Seq Length: 256.0
[2024-09-22 14:40:58,842][root][INFO] - Step: 30/1035  |  Loss: 2.3374  |  Score: 17.76 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:04,431][root][INFO] - Step: 60/1035  |  Loss: 1.5788  |  Score: 60.56 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:05,792][root][INFO] - Step: 45/1035  |  Loss: 2.0065  |  Score: 42.24 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:09,056][root][INFO] - Step: 69/1035  |  Loss: 1.4620  |  Score: 59.51 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:12,745][root][INFO] - Step: 60/1035  |  Loss: 1.7463  |  Score: 54.26 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:14,042][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 14:41:14,042][root][INFO] - Score: 69.61 [%]  |  Evaluation Time: 4.98 [s]
[2024-09-22 14:41:16,936][root][INFO] - Step: 69/1035  |  Loss: 1.6465  |  Score: 50.62 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:18,749][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 14:41:18,750][root][INFO] - Score: 64.70 [%]  |  Evaluation Time: 4.70 [s]
[2024-09-22 14:41:18,751][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 14:41:18,752][root][INFO] - 
[2/ 15 Epoch]
[2024-09-22 14:41:21,504][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 14:41:21,504][root][INFO] - Score: 69.14 [%]  |  Evaluation Time: 4.57 [s]
[2024-09-22 14:41:22,277][root][INFO] - Step: 75/1035  |  Loss: 1.4586  |  Score: 63.10 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:25,815][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 14:41:25,816][root][INFO] - Score: 62.88 [%]  |  Evaluation Time: 4.31 [s]
[2024-09-22 14:41:25,817][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 14:41:25,818][root][INFO] - 
[2/ 15 Epoch]
[2024-09-22 14:41:28,990][root][INFO] - Step: 75/1035  |  Loss: 1.4359  |  Score: 60.42 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:29,930][root][INFO] - Step: 90/1035  |  Loss: 1.3902  |  Score: 60.89 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:35,951][root][INFO] - Step: 90/1035  |  Loss: 1.3881  |  Score: 63.46 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:37,637][root][INFO] - Step: 105/1035  |  Loss: 1.3371  |  Score: 66.18 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:42,902][root][INFO] - Step: 105/1035  |  Loss: 1.4297  |  Score: 60.37 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:45,405][root][INFO] - Step: 120/1035  |  Loss: 1.3008  |  Score: 64.73 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:49,875][root][INFO] - Step: 120/1035  |  Loss: 1.5446  |  Score: 62.32 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:53,073][root][INFO] - Step: 135/1035  |  Loss: 1.2237  |  Score: 65.09 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:54,671][root][INFO] - Step: 138/1035  |  Loss: 1.0851  |  Score: 66.37 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:56,835][root][INFO] - Step: 135/1035  |  Loss: 1.3655  |  Score: 66.50 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:58,282][root][INFO] - Step: 138/1035  |  Loss: 1.1967  |  Score: 64.19 [%]  |  Seq Length: 256.0
[2024-09-22 14:41:59,643][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 14:41:59,643][root][INFO] - Score: 76.44 [%]  |  Evaluation Time: 4.97 [s]
[2024-09-22 14:42:02,863][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 14:42:02,863][root][INFO] - Score: 74.39 [%]  |  Evaluation Time: 4.58 [s]
[2024-09-22 14:42:04,311][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 14:42:04,311][root][INFO] - Score: 68.69 [%]  |  Evaluation Time: 4.67 [s]
[2024-09-22 14:42:04,313][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 14:42:04,314][root][INFO] - 
[3/ 15 Epoch]
[2024-09-22 14:42:07,217][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 14:42:07,217][root][INFO] - Score: 66.36 [%]  |  Evaluation Time: 4.35 [s]
[2024-09-22 14:42:07,219][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 14:42:07,220][root][INFO] - 
[3/ 15 Epoch]
[2024-09-22 14:42:10,884][root][INFO] - Step: 150/1035  |  Loss: 1.0193  |  Score: 70.70 [%]  |  Seq Length: 256.0
[2024-09-22 14:42:13,148][root][INFO] - Step: 150/1035  |  Loss: 1.1084  |  Score: 67.75 [%]  |  Seq Length: 256.0
[2024-09-22 14:42:18,618][root][INFO] - Step: 165/1035  |  Loss: 1.0329  |  Score: 73.95 [%]  |  Seq Length: 256.0
[2024-09-22 14:42:20,158][root][INFO] - Step: 165/1035  |  Loss: 1.1663  |  Score: 67.43 [%]  |  Seq Length: 256.0
[2024-09-22 14:42:26,272][root][INFO] - Step: 180/1035  |  Loss: 1.0868  |  Score: 69.52 [%]  |  Seq Length: 256.0
[2024-09-22 14:42:27,225][root][INFO] - Step: 180/1035  |  Loss: 1.0554  |  Score: 72.25 [%]  |  Seq Length: 256.0
[2024-09-22 14:42:34,008][root][INFO] - Step: 195/1035  |  Loss: 1.0960  |  Score: 69.89 [%]  |  Seq Length: 256.0
[2024-09-22 14:42:34,218][root][INFO] - Step: 195/1035  |  Loss: 1.0936  |  Score: 71.21 [%]  |  Seq Length: 256.0
[2024-09-22 14:42:39,892][root][INFO] - Step: 207/1035  |  Loss: 1.1163  |  Score: 70.33 [%]  |  Seq Length: 256.0
[2024-09-22 14:42:40,223][root][INFO] - Step: 207/1035  |  Loss: 1.1138  |  Score: 69.19 [%]  |  Seq Length: 256.0
[2024-09-22 14:42:44,506][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 14:42:44,506][root][INFO] - Score: 77.16 [%]  |  Evaluation Time: 4.61 [s]
[2024-09-22 14:42:45,208][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 14:42:45,208][root][INFO] - Score: 77.39 [%]  |  Evaluation Time: 4.98 [s]
[2024-09-22 14:42:48,807][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 14:42:48,807][root][INFO] - Score: 69.85 [%]  |  Evaluation Time: 4.30 [s]
[2024-09-22 14:42:48,808][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 14:42:48,810][root][INFO] - 
[4/ 15 Epoch]
[2024-09-22 14:42:49,878][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 14:42:49,879][root][INFO] - Score: 68.75 [%]  |  Evaluation Time: 4.67 [s]
[2024-09-22 14:42:49,880][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 14:42:49,882][root][INFO] - 
[4/ 15 Epoch]
[2024-09-22 14:42:50,607][root][INFO] - Step: 210/1035  |  Loss: 0.6890  |  Score: 81.80 [%]  |  Seq Length: 256.0
[2024-09-22 14:42:51,826][root][INFO] - Step: 210/1035  |  Loss: 1.1022  |  Score: 77.70 [%]  |  Seq Length: 256.0
[2024-09-22 14:42:57,494][root][INFO] - Step: 225/1035  |  Loss: 0.8860  |  Score: 74.24 [%]  |  Seq Length: 256.0
[2024-09-22 14:42:59,644][root][INFO] - Step: 225/1035  |  Loss: 0.9247  |  Score: 76.09 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:04,482][root][INFO] - Step: 240/1035  |  Loss: 0.9064  |  Score: 74.64 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:07,505][root][INFO] - Step: 240/1035  |  Loss: 1.0435  |  Score: 74.08 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:11,455][root][INFO] - Step: 255/1035  |  Loss: 0.9375  |  Score: 74.47 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:15,294][root][INFO] - Step: 255/1035  |  Loss: 0.9443  |  Score: 72.96 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:18,413][root][INFO] - Step: 270/1035  |  Loss: 0.9591  |  Score: 76.70 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:21,258][root][INFO] - Step: 276/1035  |  Loss: 0.8056  |  Score: 77.31 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:23,011][root][INFO] - Step: 270/1035  |  Loss: 0.8937  |  Score: 76.51 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:25,846][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 14:43:25,846][root][INFO] - Score: 77.20 [%]  |  Evaluation Time: 4.58 [s]
[2024-09-22 14:43:26,158][root][INFO] - Step: 276/1035  |  Loss: 0.8483  |  Score: 77.13 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:30,144][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 14:43:30,144][root][INFO] - Score: 70.85 [%]  |  Evaluation Time: 4.30 [s]
[2024-09-22 14:43:30,145][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-22 14:43:30,147][root][INFO] - 
[5/ 15 Epoch]
[2024-09-22 14:43:31,134][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 14:43:31,134][root][INFO] - Score: 76.88 [%]  |  Evaluation Time: 4.97 [s]
[2024-09-22 14:43:34,722][root][INFO] - Step: 285/1035  |  Loss: 0.8870  |  Score: 81.01 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:35,946][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 14:43:35,946][root][INFO] - Score: 70.36 [%]  |  Evaluation Time: 4.81 [s]
[2024-09-22 14:43:35,947][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-22 14:43:35,949][root][INFO] - 
[5/ 15 Epoch]
[2024-09-22 14:43:40,913][root][INFO] - Step: 285/1035  |  Loss: 0.8454  |  Score: 79.29 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:41,782][root][INFO] - Step: 300/1035  |  Loss: 0.7352  |  Score: 81.76 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:48,775][root][INFO] - Step: 315/1035  |  Loss: 0.7920  |  Score: 80.64 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:48,794][root][INFO] - Step: 300/1035  |  Loss: 0.7618  |  Score: 81.51 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:55,748][root][INFO] - Step: 330/1035  |  Loss: 0.8909  |  Score: 77.15 [%]  |  Seq Length: 256.0
[2024-09-22 14:43:56,573][root][INFO] - Step: 315/1035  |  Loss: 0.8042  |  Score: 76.65 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:02,759][root][INFO] - Step: 345/1035  |  Loss: 0.8306  |  Score: 75.86 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:04,308][root][INFO] - Step: 330/1035  |  Loss: 0.8230  |  Score: 77.59 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:07,304][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 14:44:07,304][root][INFO] - Score: 75.96 [%]  |  Evaluation Time: 4.54 [s]
[2024-09-22 14:44:11,630][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 14:44:11,630][root][INFO] - Score: 70.43 [%]  |  Evaluation Time: 4.32 [s]
[2024-09-22 14:44:11,632][root][INFO] - 
[6/ 15 Epoch]
[2024-09-22 14:44:12,112][root][INFO] - Step: 345/1035  |  Loss: 0.8123  |  Score: 76.86 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:12,475][root][INFO] - Step: 346/1035  |  Loss: 0.8210  |  Score: 79.65 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:17,213][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 14:44:17,213][root][INFO] - Score: 77.42 [%]  |  Evaluation Time: 5.10 [s]
[2024-09-22 14:44:18,994][root][INFO] - Step: 360/1035  |  Loss: 0.6674  |  Score: 82.55 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:21,814][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 14:44:21,814][root][INFO] - Score: 70.11 [%]  |  Evaluation Time: 4.60 [s]
[2024-09-22 14:44:21,815][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-22 14:44:21,817][root][INFO] - 
[6/ 15 Epoch]
[2024-09-22 14:44:22,711][root][INFO] - Step: 346/1035  |  Loss: 0.6872  |  Score: 83.17 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:25,970][root][INFO] - Step: 375/1035  |  Loss: 0.6461  |  Score: 80.95 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:29,946][root][INFO] - Step: 360/1035  |  Loss: 0.7082  |  Score: 80.57 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:32,957][root][INFO] - Step: 390/1035  |  Loss: 0.6440  |  Score: 83.21 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:37,672][root][INFO] - Step: 375/1035  |  Loss: 0.6758  |  Score: 80.06 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:39,961][root][INFO] - Step: 405/1035  |  Loss: 0.7017  |  Score: 78.79 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:44,248][root][INFO] - Step: 414/1035  |  Loss: 0.6846  |  Score: 82.24 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:45,368][root][INFO] - Step: 390/1035  |  Loss: 0.7430  |  Score: 79.01 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:48,850][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-22 14:44:48,850][root][INFO] - Score: 76.21 [%]  |  Evaluation Time: 4.60 [s]
[2024-09-22 14:44:53,064][root][INFO] - Step: 405/1035  |  Loss: 0.7902  |  Score: 80.39 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:53,144][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-22 14:44:53,145][root][INFO] - Score: 69.14 [%]  |  Evaluation Time: 4.29 [s]
[2024-09-22 14:44:53,147][root][INFO] - 
[7/ 15 Epoch]
[2024-09-22 14:44:56,353][root][INFO] - Step: 420/1035  |  Loss: 0.5867  |  Score: 83.84 [%]  |  Seq Length: 256.0
[2024-09-22 14:44:57,873][root][INFO] - Step: 414/1035  |  Loss: 0.7998  |  Score: 80.93 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:02,870][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-22 14:45:02,870][root][INFO] - Score: 78.78 [%]  |  Evaluation Time: 4.99 [s]
[2024-09-22 14:45:03,410][root][INFO] - Step: 435/1035  |  Loss: 0.5462  |  Score: 85.26 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:07,534][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-22 14:45:07,534][root][INFO] - Score: 70.78 [%]  |  Evaluation Time: 4.66 [s]
[2024-09-22 14:45:07,536][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-22 14:45:07,537][root][INFO] - 
[7/ 15 Epoch]
[2024-09-22 14:45:10,401][root][INFO] - Step: 450/1035  |  Loss: 0.5845  |  Score: 84.25 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:11,046][root][INFO] - Step: 420/1035  |  Loss: 0.6725  |  Score: 82.98 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:17,352][root][INFO] - Step: 465/1035  |  Loss: 0.6200  |  Score: 82.97 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:18,792][root][INFO] - Step: 435/1035  |  Loss: 0.6210  |  Score: 83.57 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:24,301][root][INFO] - Step: 480/1035  |  Loss: 0.5693  |  Score: 83.56 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:25,777][root][INFO] - Step: 483/1035  |  Loss: 0.4703  |  Score: 87.98 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:26,510][root][INFO] - Step: 450/1035  |  Loss: 0.6591  |  Score: 81.53 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:30,307][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-22 14:45:30,307][root][INFO] - Score: 76.38 [%]  |  Evaluation Time: 4.53 [s]
[2024-09-22 14:45:34,243][root][INFO] - Step: 465/1035  |  Loss: 0.6958  |  Score: 80.06 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:34,635][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-22 14:45:34,635][root][INFO] - Score: 69.15 [%]  |  Evaluation Time: 4.32 [s]
[2024-09-22 14:45:34,638][root][INFO] - 
[8/ 15 Epoch]
[2024-09-22 14:45:40,586][root][INFO] - Step: 495/1035  |  Loss: 0.4987  |  Score: 85.38 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:41,901][root][INFO] - Step: 480/1035  |  Loss: 0.6175  |  Score: 83.61 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:43,508][root][INFO] - Step: 483/1035  |  Loss: 0.4885  |  Score: 87.55 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:47,678][root][INFO] - Step: 510/1035  |  Loss: 0.5902  |  Score: 85.03 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:48,551][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-22 14:45:48,551][root][INFO] - Score: 77.21 [%]  |  Evaluation Time: 5.04 [s]
[2024-09-22 14:45:53,228][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-22 14:45:53,229][root][INFO] - Score: 69.85 [%]  |  Evaluation Time: 4.67 [s]
[2024-09-22 14:45:53,231][root][INFO] - 
[8/ 15 Epoch]
[2024-09-22 14:45:54,695][root][INFO] - Step: 525/1035  |  Loss: 0.5029  |  Score: 87.17 [%]  |  Seq Length: 256.0
[2024-09-22 14:45:59,804][root][INFO] - Step: 495/1035  |  Loss: 0.5479  |  Score: 86.06 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:01,671][root][INFO] - Step: 540/1035  |  Loss: 0.4947  |  Score: 86.79 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:07,320][root][INFO] - Step: 552/1035  |  Loss: 0.5306  |  Score: 84.17 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:07,521][root][INFO] - Step: 510/1035  |  Loss: 0.5316  |  Score: 84.91 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:11,847][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-22 14:46:11,847][root][INFO] - Score: 77.59 [%]  |  Evaluation Time: 4.52 [s]
[2024-09-22 14:46:15,283][root][INFO] - Step: 525/1035  |  Loss: 0.5587  |  Score: 85.03 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:16,203][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-22 14:46:16,203][root][INFO] - Score: 70.11 [%]  |  Evaluation Time: 4.35 [s]
[2024-09-22 14:46:16,206][root][INFO] - 
[9/ 15 Epoch]
[2024-09-22 14:46:17,948][root][INFO] - Step: 555/1035  |  Loss: 0.3929  |  Score: 88.06 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:23,046][root][INFO] - Step: 540/1035  |  Loss: 0.5785  |  Score: 85.12 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:24,932][root][INFO] - Step: 570/1035  |  Loss: 0.5206  |  Score: 86.96 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:29,282][root][INFO] - Step: 552/1035  |  Loss: 0.5210  |  Score: 83.40 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:31,912][root][INFO] - Step: 585/1035  |  Loss: 0.4483  |  Score: 87.39 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:34,278][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-22 14:46:34,278][root][INFO] - Score: 78.04 [%]  |  Evaluation Time: 4.99 [s]
[2024-09-22 14:46:38,901][root][INFO] - Step: 600/1035  |  Loss: 0.4252  |  Score: 88.71 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:39,028][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-22 14:46:39,029][root][INFO] - Score: 70.54 [%]  |  Evaluation Time: 4.75 [s]
[2024-09-22 14:46:39,031][root][INFO] - 
[9/ 15 Epoch]
[2024-09-22 14:46:40,914][root][INFO] - Step: 555/1035  |  Loss: 0.4475  |  Score: 89.08 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:45,906][root][INFO] - Step: 615/1035  |  Loss: 0.4243  |  Score: 87.57 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:48,642][root][INFO] - Step: 570/1035  |  Loss: 0.4427  |  Score: 87.30 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:48,774][root][INFO] - Step: 621/1035  |  Loss: 0.5340  |  Score: 83.42 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:53,325][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-22 14:46:53,325][root][INFO] - Score: 75.61 [%]  |  Evaluation Time: 4.55 [s]
[2024-09-22 14:46:56,357][root][INFO] - Step: 585/1035  |  Loss: 0.5534  |  Score: 86.54 [%]  |  Seq Length: 256.0
[2024-09-22 14:46:57,604][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-22 14:46:57,604][root][INFO] - Score: 70.64 [%]  |  Evaluation Time: 4.28 [s]
[2024-09-22 14:46:57,607][root][INFO] - 
[10/ 15 Epoch]
[2024-09-22 14:47:02,178][root][INFO] - Step: 630/1035  |  Loss: 0.4078  |  Score: 88.96 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:04,076][root][INFO] - Step: 600/1035  |  Loss: 0.5639  |  Score: 84.84 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:09,175][root][INFO] - Step: 645/1035  |  Loss: 0.3911  |  Score: 89.41 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:11,810][root][INFO] - Step: 615/1035  |  Loss: 0.4776  |  Score: 85.89 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:15,033][root][INFO] - Step: 621/1035  |  Loss: 0.4834  |  Score: 85.83 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:16,195][root][INFO] - Step: 660/1035  |  Loss: 0.3678  |  Score: 89.94 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:20,027][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-22 14:47:20,027][root][INFO] - Score: 77.21 [%]  |  Evaluation Time: 4.99 [s]
[2024-09-22 14:47:23,229][root][INFO] - Step: 675/1035  |  Loss: 0.4434  |  Score: 88.34 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:24,723][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-22 14:47:24,723][root][INFO] - Score: 70.99 [%]  |  Evaluation Time: 4.69 [s]
[2024-09-22 14:47:24,726][root][INFO] - 
[10/ 15 Epoch]
[2024-09-22 14:47:29,719][root][INFO] - Step: 630/1035  |  Loss: 0.4556  |  Score: 85.32 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:30,286][root][INFO] - Step: 690/1035  |  Loss: 0.3997  |  Score: 88.92 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:34,807][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-22 14:47:34,807][root][INFO] - Score: 76.82 [%]  |  Evaluation Time: 4.52 [s]
[2024-09-22 14:47:37,501][root][INFO] - Step: 645/1035  |  Loss: 0.4086  |  Score: 89.64 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:39,102][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-22 14:47:39,103][root][INFO] - Score: 70.31 [%]  |  Evaluation Time: 4.29 [s]
[2024-09-22 14:47:39,105][root][INFO] - 
[11/ 15 Epoch]
[2024-09-22 14:47:39,932][root][INFO] - Step: 691/1035  |  Loss: 0.3019  |  Score: 93.34 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:45,242][root][INFO] - Step: 660/1035  |  Loss: 0.4189  |  Score: 87.49 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:46,523][root][INFO] - Step: 705/1035  |  Loss: 0.3664  |  Score: 90.58 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:53,065][root][INFO] - Step: 675/1035  |  Loss: 0.4473  |  Score: 87.90 [%]  |  Seq Length: 256.0
[2024-09-22 14:47:53,539][root][INFO] - Step: 720/1035  |  Loss: 0.4145  |  Score: 90.35 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:00,596][root][INFO] - Step: 735/1035  |  Loss: 0.3326  |  Score: 90.42 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:00,840][root][INFO] - Step: 690/1035  |  Loss: 0.4637  |  Score: 86.98 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:05,811][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-22 14:48:05,811][root][INFO] - Score: 77.35 [%]  |  Evaluation Time: 4.97 [s]
[2024-09-22 14:48:07,619][root][INFO] - Step: 750/1035  |  Loss: 0.3554  |  Score: 89.62 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:10,544][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-22 14:48:10,544][root][INFO] - Score: 72.13 [%]  |  Evaluation Time: 4.73 [s]
[2024-09-22 14:48:10,546][root][INFO] - 
[11/ 15 Epoch]
[2024-09-22 14:48:11,506][root][INFO] - Step: 691/1035  |  Loss: 0.5337  |  Score: 86.28 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:11,910][root][INFO] - Step: 759/1035  |  Loss: 0.3664  |  Score: 89.73 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:16,472][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-22 14:48:16,473][root][INFO] - Score: 77.74 [%]  |  Evaluation Time: 4.56 [s]
[2024-09-22 14:48:18,748][root][INFO] - Step: 705/1035  |  Loss: 0.3915  |  Score: 89.11 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:20,802][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-22 14:48:20,803][root][INFO] - Score: 70.69 [%]  |  Evaluation Time: 4.33 [s]
[2024-09-22 14:48:20,804][root][INFO] - 
Save new Best Score (Epoch: 11)
[2024-09-22 14:48:20,805][root][INFO] - 
[12/ 15 Epoch]
[2024-09-22 14:48:23,964][root][INFO] - Step: 765/1035  |  Loss: 0.3250  |  Score: 90.56 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:26,465][root][INFO] - Step: 720/1035  |  Loss: 0.3999  |  Score: 88.90 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:30,991][root][INFO] - Step: 780/1035  |  Loss: 0.3438  |  Score: 90.52 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:34,307][root][INFO] - Step: 735/1035  |  Loss: 0.4172  |  Score: 87.29 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:38,025][root][INFO] - Step: 795/1035  |  Loss: 0.3284  |  Score: 90.90 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:42,039][root][INFO] - Step: 750/1035  |  Loss: 0.4258  |  Score: 89.42 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:45,076][root][INFO] - Step: 810/1035  |  Loss: 0.3432  |  Score: 91.07 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:46,759][root][INFO] - Step: 759/1035  |  Loss: 0.4569  |  Score: 87.97 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:51,831][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-22 14:48:51,831][root][INFO] - Score: 77.40 [%]  |  Evaluation Time: 5.07 [s]
[2024-09-22 14:48:52,141][root][INFO] - Step: 825/1035  |  Loss: 0.3527  |  Score: 89.96 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:53,642][root][INFO] - Step: 828/1035  |  Loss: 0.3349  |  Score: 91.83 [%]  |  Seq Length: 256.0
[2024-09-22 14:48:56,698][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-22 14:48:56,698][root][INFO] - Score: 69.76 [%]  |  Evaluation Time: 4.87 [s]
[2024-09-22 14:48:56,701][root][INFO] - 
[12/ 15 Epoch]
[2024-09-22 14:48:58,415][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-22 14:48:58,415][root][INFO] - Score: 77.17 [%]  |  Evaluation Time: 4.77 [s]
[2024-09-22 14:49:00,252][root][INFO] - Step: 765/1035  |  Loss: 0.3614  |  Score: 87.29 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:02,743][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-22 14:49:02,744][root][INFO] - Score: 70.26 [%]  |  Evaluation Time: 4.32 [s]
[2024-09-22 14:49:02,747][root][INFO] - 
[13/ 15 Epoch]
[2024-09-22 14:49:08,038][root][INFO] - Step: 780/1035  |  Loss: 0.3956  |  Score: 89.17 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:08,730][root][INFO] - Step: 840/1035  |  Loss: 0.3277  |  Score: 90.57 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:15,710][root][INFO] - Step: 855/1035  |  Loss: 0.3138  |  Score: 91.32 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:15,764][root][INFO] - Step: 795/1035  |  Loss: 0.3972  |  Score: 88.92 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:22,721][root][INFO] - Step: 870/1035  |  Loss: 0.3283  |  Score: 91.26 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:23,481][root][INFO] - Step: 810/1035  |  Loss: 0.3434  |  Score: 91.29 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:29,696][root][INFO] - Step: 885/1035  |  Loss: 0.3400  |  Score: 90.52 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:31,165][root][INFO] - Step: 825/1035  |  Loss: 0.3996  |  Score: 88.90 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:32,786][root][INFO] - Step: 828/1035  |  Loss: 0.3424  |  Score: 91.10 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:35,363][root][INFO] - Step: 897/1035  |  Loss: 0.2887  |  Score: 90.16 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:37,762][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-22 14:49:37,762][root][INFO] - Score: 78.39 [%]  |  Evaluation Time: 4.97 [s]
[2024-09-22 14:49:39,938][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-22 14:49:39,938][root][INFO] - Score: 77.27 [%]  |  Evaluation Time: 4.57 [s]
[2024-09-22 14:49:42,480][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-22 14:49:42,480][root][INFO] - Score: 70.51 [%]  |  Evaluation Time: 4.72 [s]
[2024-09-22 14:49:42,483][root][INFO] - 
[13/ 15 Epoch]
[2024-09-22 14:49:44,287][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-22 14:49:44,287][root][INFO] - Score: 69.67 [%]  |  Evaluation Time: 4.35 [s]
[2024-09-22 14:49:44,290][root][INFO] - 
[14/ 15 Epoch]
[2024-09-22 14:49:46,052][root][INFO] - Step: 900/1035  |  Loss: 0.2292  |  Score: 94.13 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:49,134][root][INFO] - Step: 840/1035  |  Loss: 0.3860  |  Score: 89.38 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:53,053][root][INFO] - Step: 915/1035  |  Loss: 0.3199  |  Score: 91.15 [%]  |  Seq Length: 256.0
[2024-09-22 14:49:56,807][root][INFO] - Step: 855/1035  |  Loss: 0.3876  |  Score: 90.05 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:00,124][root][INFO] - Step: 930/1035  |  Loss: 0.3082  |  Score: 91.54 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:04,531][root][INFO] - Step: 870/1035  |  Loss: 0.3850  |  Score: 88.01 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:07,146][root][INFO] - Step: 945/1035  |  Loss: 0.3072  |  Score: 91.79 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:12,329][root][INFO] - Step: 885/1035  |  Loss: 0.3411  |  Score: 89.87 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:14,162][root][INFO] - Step: 960/1035  |  Loss: 0.3090  |  Score: 91.20 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:17,020][root][INFO] - Step: 966/1035  |  Loss: 0.2850  |  Score: 92.58 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:18,656][root][INFO] - Step: 897/1035  |  Loss: 0.3517  |  Score: 89.95 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:21,644][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-22 14:50:21,644][root][INFO] - Score: 76.64 [%]  |  Evaluation Time: 4.62 [s]
[2024-09-22 14:50:23,617][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-22 14:50:23,617][root][INFO] - Score: 77.13 [%]  |  Evaluation Time: 4.96 [s]
[2024-09-22 14:50:25,979][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-22 14:50:25,979][root][INFO] - Score: 70.93 [%]  |  Evaluation Time: 4.33 [s]
[2024-09-22 14:50:25,982][root][INFO] - 
[15/ 15 Epoch]
[2024-09-22 14:50:28,407][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-22 14:50:28,407][root][INFO] - Score: 70.25 [%]  |  Evaluation Time: 4.79 [s]
[2024-09-22 14:50:28,410][root][INFO] - 
[14/ 15 Epoch]
[2024-09-22 14:50:30,382][root][INFO] - Step: 900/1035  |  Loss: 0.3753  |  Score: 89.61 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:30,532][root][INFO] - Step: 975/1035  |  Loss: 0.3150  |  Score: 91.16 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:37,666][root][INFO] - Step: 990/1035  |  Loss: 0.3177  |  Score: 91.06 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:38,196][root][INFO] - Step: 915/1035  |  Loss: 0.3530  |  Score: 89.12 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:44,657][root][INFO] - Step: 1005/1035  |  Loss: 0.3040  |  Score: 91.52 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:45,942][root][INFO] - Step: 930/1035  |  Loss: 0.3562  |  Score: 90.03 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:51,645][root][INFO] - Step: 1020/1035  |  Loss: 0.2872  |  Score: 92.25 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:53,714][root][INFO] - Step: 945/1035  |  Loss: 0.3456  |  Score: 90.43 [%]  |  Seq Length: 256.0
[2024-09-22 14:50:58,642][root][INFO] - Step: 1035/1035  |  Loss: 0.2910  |  Score: 91.42 [%]  |  Seq Length: 256.0
[2024-09-22 14:51:01,362][root][INFO] - Step: 960/1035  |  Loss: 0.3494  |  Score: 89.30 [%]  |  Seq Length: 256.0
[2024-09-22 14:51:03,200][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-22 14:51:03,200][root][INFO] - Score: 76.10 [%]  |  Evaluation Time: 4.55 [s]
[2024-09-22 14:51:04,528][root][INFO] - Step: 966/1035  |  Loss: 0.3569  |  Score: 89.88 [%]  |  Seq Length: 256.0
[2024-09-22 14:51:07,469][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-22 14:51:07,469][root][INFO] - Score: 70.42 [%]  |  Evaluation Time: 4.27 [s]
[2024-09-22 14:51:07,471][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 14:51:07,471][root][INFO] - - Epoch: 11
[2024-09-22 14:51:07,471][root][INFO] - - DEV score: 77.74 [%]
[2024-09-22 14:51:07,471][root][INFO] - - TEST score: 70.69 [%]
[2024-09-22 14:51:07,472][root][INFO] - Fine-tuning is done!
[2024-09-22 14:51:09,783][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-22 14:51:09,783][root][INFO] - Score: 77.45 [%]  |  Evaluation Time: 5.25 [s]
[2024-09-22 14:51:14,500][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-22 14:51:14,500][root][INFO] - Score: 70.36 [%]  |  Evaluation Time: 4.71 [s]
[2024-09-22 14:51:14,503][root][INFO] - 
[15/ 15 Epoch]
[2024-09-22 14:51:19,449][root][INFO] - Step: 975/1035  |  Loss: 0.3409  |  Score: 90.86 [%]  |  Seq Length: 256.0
[2024-09-22 14:51:27,139][root][INFO] - Step: 990/1035  |  Loss: 0.3503  |  Score: 90.01 [%]  |  Seq Length: 256.0
[2024-09-22 14:51:34,855][root][INFO] - Step: 1005/1035  |  Loss: 0.3195  |  Score: 91.16 [%]  |  Seq Length: 256.0
[2024-09-22 14:51:42,580][root][INFO] - Step: 1020/1035  |  Loss: 0.3550  |  Score: 88.45 [%]  |  Seq Length: 256.0
[2024-09-22 14:51:50,359][root][INFO] - Step: 1035/1035  |  Loss: 0.3544  |  Score: 90.79 [%]  |  Seq Length: 256.0
[2024-09-22 14:51:55,399][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-22 14:51:55,399][root][INFO] - Score: 77.21 [%]  |  Evaluation Time: 5.04 [s]
[2024-09-22 14:52:00,148][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-22 14:52:00,148][root][INFO] - Score: 71.31 [%]  |  Evaluation Time: 4.75 [s]
[2024-09-22 14:52:00,149][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 14:52:00,149][root][INFO] - - Epoch: 6
[2024-09-22 14:52:00,150][root][INFO] - - DEV score: 78.78 [%]
[2024-09-22 14:52:00,150][root][INFO] - - TEST score: 70.78 [%]
[2024-09-22 14:52:00,150][root][INFO] - Fine-tuning is done!
[2024-09-22 14:55:28,421][root][INFO] - 

[2024-09-22 14:55:28,421][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 14:55:28,422][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs
[2024-09-22 14:55:28,422][root][INFO] - 

[2024-09-22 14:55:28,422][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'PAWS_X'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 75, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 14:55:36,628][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 14:55:36,628][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 14:55:36,629][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 14:55:36,630][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 14:55:36,630][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 14:55:36,630][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 14:55:36,631][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 14:55:36,631][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 14:55:36,632][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 14:55:36,632][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 14:55:36,633][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 14:55:36,633][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 14:55:36,634][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 14:55:36,634][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 14:55:36,635][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 14:55:36,635][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 14:55:36,636][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 14:55:36,636][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 14:55:36,636][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 14:55:36,637][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 14:55:36,639][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 14:55:36,639][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 14:55:36,640][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 14:55:36,640][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 14:55:36,642][root][INFO] - Trainable params: 1769472 || all params: 126935040 || trainable: 1.39 %
[2024-09-22 14:55:36,646][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-22 14:55:36,656][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-22 14:55:36,658][root][INFO] - Trainable params: 2445312 || all params: 127610880 || trainable: 1.92 %
[2024-09-22 14:55:36,841][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 14:55:38,738][root][INFO] - 

[2024-09-22 14:55:38,738][root][INFO] - ========== Fine-tuning on PAWS_X ==========
[2024-09-22 14:55:38,738][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 14:55:38,746][root][INFO] - vocab size              : 51200
[2024-09-22 14:55:38,746][root][INFO] - device                  : gpu
[2024-09-22 14:55:38,746][root][INFO] - random seed             : 42
[2024-09-22 14:55:38,746][root][INFO] - train data size         : 24256
[2024-09-22 14:55:38,746][root][INFO] - max epochs              : 5
[2024-09-22 14:55:38,746][root][INFO] - total steps             : 1895
[2024-09-22 14:55:38,747][root][INFO] - warmup steps            : 190
[2024-09-22 14:55:38,747][root][INFO] - batch size              : 64
[2024-09-22 14:55:38,747][root][INFO] - accumulation steps      : 1
[2024-09-22 14:55:38,747][root][INFO] - optimizer               : adamwscale
[2024-09-22 14:55:38,747][root][INFO] - lr_scheduler            : cosine
[2024-09-22 14:55:38,747][root][INFO] - learning rate           : 0.01
[2024-09-22 14:55:38,747][root][INFO] - max length              : 256

[2024-09-22 14:55:38,747][root][INFO] - LoRA Configuration
[2024-09-22 14:55:38,747][root][INFO] - ㄴ r                    : 32
[2024-09-22 14:55:38,747][root][INFO] - ㄴ alpha                : 128
[2024-09-22 14:55:38,747][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 14:55:38,747][root][INFO] - KOMBO Configuration
[2024-09-22 14:55:38,748][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-22 14:55:38,748][root][INFO] - ㄴ reducer              : linear
[2024-09-22 14:55:38,748][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-22 14:55:38,748][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-22 14:55:38,748][root][INFO] - ㄴ do_combination       : False
[2024-09-22 14:55:38,748][root][INFO] - 

[2024-09-22 14:55:38,748][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs
[2024-09-22 14:55:38,748][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-22 14:55:38,748][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs/tb
[2024-09-22 14:55:38,748][root][INFO] - * tb interval           : 75

[2024-09-22 14:55:38,748][root][INFO] - 

[2024-09-22 14:55:38,748][root][INFO] - Start the Training !
[2024-09-22 14:55:38,751][root][INFO] - 
[1/ 5 Epoch]
[2024-09-22 14:55:47,357][root][INFO] - 

[2024-09-22 14:55:47,357][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 14:55:47,357][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs
[2024-09-22 14:55:47,358][root][INFO] - 

[2024-09-22 14:55:47,358][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'PAWS_X'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 75, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 14:56:10,549][root][INFO] - 

[2024-09-22 14:56:10,549][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 14:56:10,549][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs
[2024-09-22 14:56:10,549][root][INFO] - 

[2024-09-22 14:56:10,549][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'PAWS_X'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 75, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 14:56:17,727][root][INFO] - Step: 75/1895  |  Loss: 0.7248  |  Score: 51.08 [%]  |  Seq Length: 256.0
[2024-09-22 14:56:18,701][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 14:56:18,702][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 14:56:18,702][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 14:56:18,703][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 14:56:18,703][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 14:56:18,704][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 14:56:18,705][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 14:56:18,705][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 14:56:18,706][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 14:56:18,706][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 14:56:18,707][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 14:56:18,707][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 14:56:18,708][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 14:56:18,708][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 14:56:18,709][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 14:56:18,710][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 14:56:18,710][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 14:56:18,711][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 14:56:18,711][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 14:56:18,712][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 14:56:18,715][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 14:56:18,716][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 14:56:18,716][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 14:56:18,717][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 14:56:18,719][root][INFO] - Trainable params: 1769472 || all params: 126935040 || trainable: 1.39 %
[2024-09-22 14:56:18,723][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-22 14:56:18,828][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-22 14:56:18,831][root][INFO] - Trainable params: 9034752 || all params: 134200320 || trainable: 6.73 %
[2024-09-22 14:56:19,025][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 14:56:22,211][root][INFO] - 

[2024-09-22 14:56:22,211][root][INFO] - ========== Fine-tuning on PAWS_X ==========
[2024-09-22 14:56:22,211][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 14:56:22,222][root][INFO] - vocab size              : 51200
[2024-09-22 14:56:22,222][root][INFO] - device                  : gpu
[2024-09-22 14:56:22,222][root][INFO] - random seed             : 42
[2024-09-22 14:56:22,222][root][INFO] - train data size         : 24256
[2024-09-22 14:56:22,222][root][INFO] - max epochs              : 5
[2024-09-22 14:56:22,223][root][INFO] - total steps             : 1895
[2024-09-22 14:56:22,223][root][INFO] - warmup steps            : 190
[2024-09-22 14:56:22,223][root][INFO] - batch size              : 64
[2024-09-22 14:56:22,223][root][INFO] - accumulation steps      : 1
[2024-09-22 14:56:22,223][root][INFO] - optimizer               : adamwscale
[2024-09-22 14:56:22,223][root][INFO] - lr_scheduler            : cosine
[2024-09-22 14:56:22,223][root][INFO] - learning rate           : 0.01
[2024-09-22 14:56:22,223][root][INFO] - max length              : 256

[2024-09-22 14:56:22,223][root][INFO] - LoRA Configuration
[2024-09-22 14:56:22,223][root][INFO] - ㄴ r                    : 32
[2024-09-22 14:56:22,223][root][INFO] - ㄴ alpha                : 128
[2024-09-22 14:56:22,223][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 14:56:22,224][root][INFO] - KOMBO Configuration
[2024-09-22 14:56:22,224][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-22 14:56:22,224][root][INFO] - ㄴ reducer              : linear
[2024-09-22 14:56:22,224][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-22 14:56:22,224][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-22 14:56:22,224][root][INFO] - ㄴ do_combination       : True
[2024-09-22 14:56:22,224][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-22 14:56:22,224][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-22 14:56:22,224][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-22 14:56:22,224][root][INFO] -   ㄴ add_lora           : True
[2024-09-22 14:56:22,225][root][INFO] -     ㄴ LoRA in KOMBO Configuration
[2024-09-22 14:56:22,225][root][INFO] -     ㄴ r                : 32
[2024-09-22 14:56:22,225][root][INFO] -     ㄴ alpha            : 128
[2024-09-22 14:56:22,225][root][INFO] -     ㄴ dropout          : 0.03

[2024-09-22 14:56:22,225][root][INFO] - 

[2024-09-22 14:56:22,225][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs
[2024-09-22 14:56:22,225][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-22 14:56:22,225][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.01lr_42rs/tb
[2024-09-22 14:56:22,225][root][INFO] - * tb interval           : 75

[2024-09-22 14:56:22,225][root][INFO] - 

[2024-09-22 14:56:22,225][root][INFO] - Start the Training !
[2024-09-22 14:56:22,228][root][INFO] - 
[1/ 5 Epoch]
[2024-09-22 14:56:55,458][root][INFO] - Step: 150/1895  |  Loss: 0.7018  |  Score: 52.15 [%]  |  Seq Length: 256.0
[2024-09-22 14:57:06,039][root][INFO] - Step: 75/1895  |  Loss: 0.7196  |  Score: 52.60 [%]  |  Seq Length: 256.0
[2024-09-22 14:57:33,137][root][INFO] - Step: 225/1895  |  Loss: 0.7236  |  Score: 51.83 [%]  |  Seq Length: 256.0
[2024-09-22 14:57:49,127][root][INFO] - Step: 150/1895  |  Loss: 0.7044  |  Score: 52.21 [%]  |  Seq Length: 256.0
[2024-09-22 14:58:10,831][root][INFO] - Step: 300/1895  |  Loss: 0.6976  |  Score: 52.79 [%]  |  Seq Length: 256.0
[2024-09-22 14:58:32,139][root][INFO] - Step: 225/1895  |  Loss: 0.6947  |  Score: 54.21 [%]  |  Seq Length: 256.0
[2024-09-22 14:58:48,540][root][INFO] - Step: 375/1895  |  Loss: 0.7057  |  Score: 51.77 [%]  |  Seq Length: 256.0
[2024-09-22 14:58:50,285][root][INFO] - Step: 379/1895  |  Loss: 0.6775  |  Score: 59.90 [%]  |  Seq Length: 256.0
[2024-09-22 14:58:54,538][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 14:58:54,538][root][INFO] - Score: 52.28 [%]  |  Evaluation Time: 4.25 [s]
[2024-09-22 14:58:58,695][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 14:58:58,695][root][INFO] - Score: 52.93 [%]  |  Evaluation Time: 4.15 [s]
[2024-09-22 14:58:58,697][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 14:58:58,698][root][INFO] - 
[2/ 5 Epoch]
[2024-09-22 14:59:15,144][root][INFO] - Step: 300/1895  |  Loss: 0.6790  |  Score: 58.06 [%]  |  Seq Length: 256.0
[2024-09-22 14:59:34,750][root][INFO] - Step: 450/1895  |  Loss: 0.6974  |  Score: 52.20 [%]  |  Seq Length: 256.0
[2024-09-22 14:59:58,124][root][INFO] - Step: 375/1895  |  Loss: 0.6519  |  Score: 63.96 [%]  |  Seq Length: 256.0
[2024-09-22 15:00:00,073][root][INFO] - Step: 379/1895  |  Loss: 0.5906  |  Score: 73.70 [%]  |  Seq Length: 256.0
[2024-09-22 15:00:04,705][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 15:00:04,705][root][INFO] - Score: 59.41 [%]  |  Evaluation Time: 4.63 [s]
[2024-09-22 15:00:09,250][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 15:00:09,250][root][INFO] - Score: 59.91 [%]  |  Evaluation Time: 4.54 [s]
[2024-09-22 15:00:09,251][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 15:00:09,252][root][INFO] - 
[2/ 5 Epoch]
[2024-09-22 15:00:12,299][root][INFO] - Step: 525/1895  |  Loss: 0.6975  |  Score: 52.88 [%]  |  Seq Length: 256.0
[2024-09-22 15:00:49,904][root][INFO] - Step: 600/1895  |  Loss: 0.7008  |  Score: 50.54 [%]  |  Seq Length: 256.0
[2024-09-22 15:00:50,480][root][INFO] - Step: 450/1895  |  Loss: 0.6007  |  Score: 67.67 [%]  |  Seq Length: 256.0
[2024-09-22 15:01:27,543][root][INFO] - Step: 675/1895  |  Loss: 0.6944  |  Score: 53.94 [%]  |  Seq Length: 256.0
[2024-09-22 15:01:33,718][root][INFO] - Step: 525/1895  |  Loss: 0.5923  |  Score: 69.00 [%]  |  Seq Length: 256.0
[2024-09-22 15:02:05,199][root][INFO] - Step: 750/1895  |  Loss: 0.6957  |  Score: 52.12 [%]  |  Seq Length: 256.0
[2024-09-22 15:02:08,989][root][INFO] - Step: 758/1895  |  Loss: 0.7067  |  Score: 48.44 [%]  |  Seq Length: 256.0
[2024-09-22 15:02:13,202][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 15:02:13,202][root][INFO] - Score: 55.37 [%]  |  Evaluation Time: 4.21 [s]
[2024-09-22 15:02:16,825][root][INFO] - Step: 600/1895  |  Loss: 0.5603  |  Score: 71.02 [%]  |  Seq Length: 256.0
[2024-09-22 15:02:17,391][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 15:02:17,391][root][INFO] - Score: 53.31 [%]  |  Evaluation Time: 4.19 [s]
[2024-09-22 15:02:17,392][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 15:02:17,394][root][INFO] - 
[3/ 5 Epoch]
[2024-09-22 15:02:51,482][root][INFO] - Step: 825/1895  |  Loss: 0.6962  |  Score: 52.99 [%]  |  Seq Length: 256.0
[2024-09-22 15:02:59,967][root][INFO] - Step: 675/1895  |  Loss: 0.5570  |  Score: 71.44 [%]  |  Seq Length: 256.0
[2024-09-22 15:03:29,139][root][INFO] - Step: 900/1895  |  Loss: 0.6918  |  Score: 53.85 [%]  |  Seq Length: 256.0
[2024-09-22 15:03:43,255][root][INFO] - Step: 750/1895  |  Loss: 0.5660  |  Score: 70.75 [%]  |  Seq Length: 256.0
[2024-09-22 15:03:47,529][root][INFO] - Step: 758/1895  |  Loss: 0.5607  |  Score: 72.98 [%]  |  Seq Length: 256.0
[2024-09-22 15:03:52,198][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 15:03:52,198][root][INFO] - Score: 63.90 [%]  |  Evaluation Time: 4.67 [s]
[2024-09-22 15:03:56,806][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 15:03:56,806][root][INFO] - Score: 63.22 [%]  |  Evaluation Time: 4.61 [s]
[2024-09-22 15:03:56,808][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 15:03:56,811][root][INFO] - 
[3/ 5 Epoch]
[2024-09-22 15:04:06,690][root][INFO] - Step: 975/1895  |  Loss: 0.7008  |  Score: 51.44 [%]  |  Seq Length: 256.0
[2024-09-22 15:04:36,097][root][INFO] - Step: 825/1895  |  Loss: 0.5127  |  Score: 74.39 [%]  |  Seq Length: 256.0
[2024-09-22 15:04:44,272][root][INFO] - Step: 1050/1895  |  Loss: 0.6933  |  Score: 53.54 [%]  |  Seq Length: 256.0
[2024-09-22 15:05:19,353][root][INFO] - Step: 900/1895  |  Loss: 0.5065  |  Score: 74.98 [%]  |  Seq Length: 256.0
[2024-09-22 15:05:21,832][root][INFO] - Step: 1125/1895  |  Loss: 0.6921  |  Score: 54.04 [%]  |  Seq Length: 256.0
[2024-09-22 15:05:27,564][root][INFO] - Step: 1137/1895  |  Loss: 0.6891  |  Score: 55.03 [%]  |  Seq Length: 256.0
[2024-09-22 15:05:31,859][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 15:05:31,860][root][INFO] - Score: 54.36 [%]  |  Evaluation Time: 4.29 [s]
[2024-09-22 15:05:36,017][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 15:05:36,017][root][INFO] - Score: 52.88 [%]  |  Evaluation Time: 4.15 [s]
[2024-09-22 15:05:36,020][root][INFO] - 
[4/ 5 Epoch]
[2024-09-22 15:06:02,551][root][INFO] - Step: 975/1895  |  Loss: 0.5018  |  Score: 75.62 [%]  |  Seq Length: 256.0
[2024-09-22 15:06:08,026][root][INFO] - Step: 1200/1895  |  Loss: 0.6919  |  Score: 53.60 [%]  |  Seq Length: 256.0
[2024-09-22 15:06:45,542][root][INFO] - Step: 1050/1895  |  Loss: 0.4944  |  Score: 76.00 [%]  |  Seq Length: 256.0
[2024-09-22 15:06:45,610][root][INFO] - Step: 1275/1895  |  Loss: 0.6877  |  Score: 55.35 [%]  |  Seq Length: 256.0
[2024-09-22 15:07:23,270][root][INFO] - Step: 1350/1895  |  Loss: 0.6894  |  Score: 54.33 [%]  |  Seq Length: 256.0
[2024-09-22 15:07:28,583][root][INFO] - Step: 1125/1895  |  Loss: 0.5106  |  Score: 74.83 [%]  |  Seq Length: 256.0
[2024-09-22 15:07:35,113][root][INFO] - Step: 1137/1895  |  Loss: 0.5070  |  Score: 75.95 [%]  |  Seq Length: 256.0
[2024-09-22 15:07:39,778][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 15:07:39,779][root][INFO] - Score: 65.23 [%]  |  Evaluation Time: 4.66 [s]
[2024-09-22 15:07:44,359][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 15:07:44,359][root][INFO] - Score: 65.60 [%]  |  Evaluation Time: 4.58 [s]
[2024-09-22 15:07:44,360][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 15:07:44,362][root][INFO] - 
[4/ 5 Epoch]
[2024-09-22 15:08:00,917][root][INFO] - Step: 1425/1895  |  Loss: 0.6886  |  Score: 54.19 [%]  |  Seq Length: 256.0
[2024-09-22 15:08:21,001][root][INFO] - Step: 1200/1895  |  Loss: 0.4637  |  Score: 77.41 [%]  |  Seq Length: 256.0
[2024-09-22 15:08:38,648][root][INFO] - Step: 1500/1895  |  Loss: 0.6874  |  Score: 54.92 [%]  |  Seq Length: 256.0
[2024-09-22 15:08:46,379][root][INFO] - Step: 1516/1895  |  Loss: 0.6744  |  Score: 59.67 [%]  |  Seq Length: 256.0
[2024-09-22 15:08:50,620][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 15:08:50,621][root][INFO] - Score: 54.46 [%]  |  Evaluation Time: 4.24 [s]
[2024-09-22 15:08:54,867][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 15:08:54,867][root][INFO] - Score: 53.00 [%]  |  Evaluation Time: 4.24 [s]
[2024-09-22 15:08:54,870][root][INFO] - 
[5/ 5 Epoch]
[2024-09-22 15:09:04,195][root][INFO] - Step: 1275/1895  |  Loss: 0.4496  |  Score: 79.02 [%]  |  Seq Length: 256.0
[2024-09-22 15:09:24,879][root][INFO] - Step: 1575/1895  |  Loss: 0.6777  |  Score: 56.67 [%]  |  Seq Length: 256.0
[2024-09-22 15:09:47,040][root][INFO] - Step: 1350/1895  |  Loss: 0.4550  |  Score: 78.27 [%]  |  Seq Length: 256.0
[2024-09-22 15:10:02,458][root][INFO] - Step: 1650/1895  |  Loss: 0.6784  |  Score: 56.73 [%]  |  Seq Length: 256.0
[2024-09-22 15:10:30,166][root][INFO] - Step: 1425/1895  |  Loss: 0.4382  |  Score: 79.27 [%]  |  Seq Length: 256.0
[2024-09-22 15:10:40,047][root][INFO] - Step: 1725/1895  |  Loss: 0.6722  |  Score: 58.52 [%]  |  Seq Length: 256.0
[2024-09-22 15:11:13,405][root][INFO] - Step: 1500/1895  |  Loss: 0.4497  |  Score: 78.92 [%]  |  Seq Length: 256.0
[2024-09-22 15:11:17,565][root][INFO] - Step: 1800/1895  |  Loss: 0.6734  |  Score: 57.96 [%]  |  Seq Length: 256.0
[2024-09-22 15:11:22,369][root][INFO] - Step: 1516/1895  |  Loss: 0.4357  |  Score: 79.17 [%]  |  Seq Length: 256.0
[2024-09-22 15:11:27,013][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 15:11:27,013][root][INFO] - Score: 69.21 [%]  |  Evaluation Time: 4.64 [s]
[2024-09-22 15:11:31,540][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 15:11:31,540][root][INFO] - Score: 66.81 [%]  |  Evaluation Time: 4.52 [s]
[2024-09-22 15:11:31,541][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-22 15:11:31,543][root][INFO] - 
[5/ 5 Epoch]
[2024-09-22 15:11:55,223][root][INFO] - Step: 1875/1895  |  Loss: 0.6690  |  Score: 58.56 [%]  |  Seq Length: 256.0
[2024-09-22 15:12:04,985][root][INFO] - Step: 1895/1895  |  Loss: 0.6758  |  Score: 56.69 [%]  |  Seq Length: 256.0
[2024-09-22 15:12:05,605][root][INFO] - Step: 1575/1895  |  Loss: 0.4151  |  Score: 80.64 [%]  |  Seq Length: 256.0
[2024-09-22 15:12:09,208][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 15:12:09,208][root][INFO] - Score: 50.94 [%]  |  Evaluation Time: 4.22 [s]
[2024-09-22 15:12:13,390][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 15:12:13,391][root][INFO] - Score: 51.56 [%]  |  Evaluation Time: 4.18 [s]
[2024-09-22 15:12:13,392][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 15:12:13,392][root][INFO] - - Epoch: 2
[2024-09-22 15:12:13,392][root][INFO] - - DEV score: 55.37 [%]
[2024-09-22 15:12:13,392][root][INFO] - - TEST score: 53.31 [%]
[2024-09-22 15:12:13,393][root][INFO] - Fine-tuning is done!
[2024-09-22 15:12:48,599][root][INFO] - Step: 1650/1895  |  Loss: 0.4203  |  Score: 80.50 [%]  |  Seq Length: 256.0
[2024-09-22 15:13:31,685][root][INFO] - Step: 1725/1895  |  Loss: 0.4160  |  Score: 80.98 [%]  |  Seq Length: 256.0
[2024-09-22 15:14:14,399][root][INFO] - Step: 1800/1895  |  Loss: 0.4229  |  Score: 80.71 [%]  |  Seq Length: 256.0
[2024-09-22 15:14:57,163][root][INFO] - Step: 1875/1895  |  Loss: 0.4272  |  Score: 80.50 [%]  |  Seq Length: 256.0
[2024-09-22 15:15:08,456][root][INFO] - Step: 1895/1895  |  Loss: 0.4179  |  Score: 80.60 [%]  |  Seq Length: 256.0
[2024-09-22 15:15:13,110][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 15:15:13,110][root][INFO] - Score: 72.27 [%]  |  Evaluation Time: 4.65 [s]
[2024-09-22 15:15:17,704][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 15:15:17,704][root][INFO] - Score: 66.68 [%]  |  Evaluation Time: 4.59 [s]
[2024-09-22 15:15:17,706][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-22 15:15:17,706][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 15:15:17,706][root][INFO] - - Epoch: 5
[2024-09-22 15:15:17,706][root][INFO] - - DEV score: 72.27 [%]
[2024-09-22 15:15:17,706][root][INFO] - - TEST score: 66.68 [%]
[2024-09-22 15:15:17,707][root][INFO] - Fine-tuning is done!
[2024-09-22 15:49:12,051][root][INFO] - 

[2024-09-22 15:49:12,051][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 15:49:12,051][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs
[2024-09-22 15:49:12,052][root][INFO] - 

[2024-09-22 15:49:12,052][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'PAWS_X'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.02, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 75, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 15:49:21,115][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 15:49:21,116][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 15:49:21,117][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 15:49:21,117][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 15:49:21,117][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 15:49:21,118][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 15:49:21,118][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 15:49:21,119][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 15:49:21,119][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 15:49:21,120][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 15:49:21,120][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 15:49:21,120][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 15:49:21,121][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 15:49:21,121][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 15:49:21,122][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 15:49:21,122][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 15:49:21,123][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 15:49:21,123][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 15:49:21,123][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 15:49:21,124][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 15:49:21,127][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 15:49:21,127][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 15:49:21,128][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 15:49:21,128][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 15:49:21,130][root][INFO] - Trainable params: 1769472 || all params: 126935040 || trainable: 1.39 %
[2024-09-22 15:49:21,134][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-22 15:49:21,147][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-22 15:49:21,149][root][INFO] - Trainable params: 2445312 || all params: 127610880 || trainable: 1.92 %
[2024-09-22 15:49:21,340][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 15:49:23,413][root][INFO] - 

[2024-09-22 15:49:23,413][root][INFO] - ========== Fine-tuning on PAWS_X ==========
[2024-09-22 15:49:23,413][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 15:49:23,421][root][INFO] - vocab size              : 51200
[2024-09-22 15:49:23,421][root][INFO] - device                  : gpu
[2024-09-22 15:49:23,421][root][INFO] - random seed             : 42
[2024-09-22 15:49:23,421][root][INFO] - train data size         : 24256
[2024-09-22 15:49:23,421][root][INFO] - max epochs              : 5
[2024-09-22 15:49:23,421][root][INFO] - total steps             : 1895
[2024-09-22 15:49:23,421][root][INFO] - warmup steps            : 190
[2024-09-22 15:49:23,422][root][INFO] - batch size              : 64
[2024-09-22 15:49:23,422][root][INFO] - accumulation steps      : 1
[2024-09-22 15:49:23,422][root][INFO] - optimizer               : adamwscale
[2024-09-22 15:49:23,422][root][INFO] - lr_scheduler            : cosine
[2024-09-22 15:49:23,422][root][INFO] - learning rate           : 0.02
[2024-09-22 15:49:23,422][root][INFO] - max length              : 256

[2024-09-22 15:49:23,422][root][INFO] - LoRA Configuration
[2024-09-22 15:49:23,422][root][INFO] - ㄴ r                    : 32
[2024-09-22 15:49:23,422][root][INFO] - ㄴ alpha                : 128
[2024-09-22 15:49:23,422][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 15:49:23,422][root][INFO] - KOMBO Configuration
[2024-09-22 15:49:23,423][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-22 15:49:23,423][root][INFO] - ㄴ reducer              : linear
[2024-09-22 15:49:23,423][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-22 15:49:23,423][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-22 15:49:23,423][root][INFO] - ㄴ do_combination       : False
[2024-09-22 15:49:23,423][root][INFO] - 

[2024-09-22 15:49:23,423][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs
[2024-09-22 15:49:23,423][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs/ckpt
[2024-09-22 15:49:23,423][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.02lr_42rs/tb
[2024-09-22 15:49:23,423][root][INFO] - * tb interval           : 75

[2024-09-22 15:49:23,423][root][INFO] - 

[2024-09-22 15:49:23,424][root][INFO] - Start the Training !
[2024-09-22 15:49:23,426][root][INFO] - 
[1/ 5 Epoch]
[2024-09-22 15:50:02,368][root][INFO] - Step: 75/1895  |  Loss: 0.7267  |  Score: 50.85 [%]  |  Seq Length: 256.0
[2024-09-22 15:50:39,601][root][INFO] - Step: 150/1895  |  Loss: 0.7101  |  Score: 52.58 [%]  |  Seq Length: 256.0
[2024-09-22 15:51:17,054][root][INFO] - Step: 225/1895  |  Loss: 0.7036  |  Score: 52.19 [%]  |  Seq Length: 256.0
[2024-09-22 15:51:54,428][root][INFO] - Step: 300/1895  |  Loss: 0.7033  |  Score: 52.02 [%]  |  Seq Length: 256.0
[2024-09-22 15:52:31,670][root][INFO] - Step: 375/1895  |  Loss: 0.7063  |  Score: 51.60 [%]  |  Seq Length: 256.0
[2024-09-22 15:52:33,395][root][INFO] - Step: 379/1895  |  Loss: 0.7048  |  Score: 54.04 [%]  |  Seq Length: 256.0
[2024-09-22 15:52:37,560][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 15:52:37,561][root][INFO] - Score: 52.28 [%]  |  Evaluation Time: 4.16 [s]
[2024-09-22 15:52:41,607][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 15:52:41,607][root][INFO] - Score: 52.93 [%]  |  Evaluation Time: 4.04 [s]
[2024-09-22 15:52:41,609][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 15:52:41,612][root][INFO] - 
[2/ 5 Epoch]
[2024-09-22 15:53:17,353][root][INFO] - Step: 450/1895  |  Loss: 0.7026  |  Score: 52.55 [%]  |  Seq Length: 256.0
[2024-09-22 15:53:19,268][root][INFO] - 

[2024-09-22 15:53:19,268][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 15:53:19,268][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs
[2024-09-22 15:53:19,268][root][INFO] - 

[2024-09-22 15:53:19,268][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': True, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 2, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 15:53:54,955][root][INFO] - Step: 525/1895  |  Loss: 0.7020  |  Score: 52.12 [%]  |  Seq Length: 256.0
[2024-09-22 15:54:32,541][root][INFO] - Step: 600/1895  |  Loss: 0.6997  |  Score: 52.29 [%]  |  Seq Length: 256.0
[2024-09-22 15:55:09,910][root][INFO] - Step: 675/1895  |  Loss: 0.6946  |  Score: 54.00 [%]  |  Seq Length: 256.0
[2024-09-22 15:55:23,421][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 15:55:23,421][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 15:55:23,422][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 15:55:23,423][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 15:55:23,423][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 15:55:23,424][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 15:55:23,425][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 15:55:23,425][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 15:55:23,426][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 15:55:23,426][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 15:55:23,427][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 15:55:23,427][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 15:55:23,428][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 15:55:23,428][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 15:55:23,428][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 15:55:23,429][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 15:55:23,429][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 15:55:23,430][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 15:55:23,430][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 15:55:23,430][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 15:55:23,431][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 15:55:23,431][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 15:55:23,432][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 15:55:23,433][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 15:55:23,435][root][INFO] - Trainable params: 1769472 || all params: 126935808 || trainable: 1.39 %
[2024-09-22 15:55:23,440][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-22 15:55:23,547][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-22 15:55:23,549][root][INFO] - Trainable params: 9034752 || all params: 134201088 || trainable: 6.73 %
[2024-09-22 15:55:23,782][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 15:55:26,869][root][INFO] - 

[2024-09-22 15:55:26,869][root][INFO] - ========== Fine-tuning on KorNLI ==========
[2024-09-22 15:55:26,869][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 15:55:26,877][root][INFO] - vocab size              : 51200
[2024-09-22 15:55:26,877][root][INFO] - device                  : gpu
[2024-09-22 15:55:26,877][root][INFO] - random seed             : 42
[2024-09-22 15:55:26,877][root][INFO] - train data size         : 422752
[2024-09-22 15:55:26,877][root][INFO] - max epochs              : 3
[2024-09-22 15:55:26,877][root][INFO] - total steps             : 39633
[2024-09-22 15:55:26,878][root][INFO] - warmup steps            : 3963
[2024-09-22 15:55:26,878][root][INFO] - batch size              : 64
[2024-09-22 15:55:26,878][root][INFO] - accumulation steps      : 2
[2024-09-22 15:55:26,878][root][INFO] - optimizer               : adamwscale
[2024-09-22 15:55:26,878][root][INFO] - lr_scheduler            : cosine
[2024-09-22 15:55:26,878][root][INFO] - learning rate           : 0.01
[2024-09-22 15:55:26,878][root][INFO] - max length              : 256

[2024-09-22 15:55:26,878][root][INFO] - LoRA Configuration
[2024-09-22 15:55:26,878][root][INFO] - ㄴ r                    : 32
[2024-09-22 15:55:26,878][root][INFO] - ㄴ alpha                : 128
[2024-09-22 15:55:26,878][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 15:55:26,878][root][INFO] - KOMBO Configuration
[2024-09-22 15:55:26,879][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-22 15:55:26,879][root][INFO] - ㄴ reducer              : linear
[2024-09-22 15:55:26,879][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-22 15:55:26,879][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-22 15:55:26,879][root][INFO] - ㄴ do_combination       : True
[2024-09-22 15:55:26,879][root][INFO] -   ㄴ num_attn_heads     : 12
[2024-09-22 15:55:26,879][root][INFO] -   ㄴ intermediate_size  : 3072
[2024-09-22 15:55:26,879][root][INFO] -   ㄴ num_trans_layers   : 3
[2024-09-22 15:55:26,879][root][INFO] -   ㄴ add_lora           : True
[2024-09-22 15:55:26,880][root][INFO] -     ㄴ LoRA in KOMBO Configuration
[2024-09-22 15:55:26,880][root][INFO] -     ㄴ r                : 32
[2024-09-22 15:55:26,880][root][INFO] -     ㄴ alpha            : 128
[2024-09-22 15:55:26,880][root][INFO] -     ㄴ dropout          : 0.03

[2024-09-22 15:55:26,880][root][INFO] - 

[2024-09-22 15:55:26,880][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs
[2024-09-22 15:55:26,880][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/ckpt
[2024-09-22 15:55:26,880][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/tb
[2024-09-22 15:55:26,880][root][INFO] - * tb interval           : 400

[2024-09-22 15:55:26,880][root][INFO] - 

[2024-09-22 15:55:26,880][root][INFO] - Start the Training !
[2024-09-22 15:55:26,883][root][INFO] - 
[1/ 3 Epoch]
[2024-09-22 15:55:47,163][root][INFO] - Step: 750/1895  |  Loss: 0.7059  |  Score: 51.60 [%]  |  Seq Length: 256.0
[2024-09-22 15:55:50,879][root][INFO] - Step: 758/1895  |  Loss: 0.6990  |  Score: 48.24 [%]  |  Seq Length: 256.0
[2024-09-22 15:55:55,100][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 15:55:55,100][root][INFO] - Score: 51.73 [%]  |  Evaluation Time: 4.22 [s]
[2024-09-22 15:55:59,283][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 15:55:59,284][root][INFO] - Score: 52.06 [%]  |  Evaluation Time: 4.18 [s]
[2024-09-22 15:55:59,286][root][INFO] - 
[3/ 5 Epoch]
[2024-09-22 15:56:32,601][root][INFO] - Step: 825/1895  |  Loss: 0.6975  |  Score: 52.43 [%]  |  Seq Length: 256.0
[2024-09-22 15:57:08,860][root][INFO] - Step: 900/1895  |  Loss: 0.6956  |  Score: 53.21 [%]  |  Seq Length: 256.0
[2024-09-22 15:57:45,092][root][INFO] - Step: 975/1895  |  Loss: 0.7024  |  Score: 52.38 [%]  |  Seq Length: 256.0
[2024-09-22 15:58:21,566][root][INFO] - Step: 1050/1895  |  Loss: 0.6942  |  Score: 52.90 [%]  |  Seq Length: 256.0
[2024-09-22 15:58:58,929][root][INFO] - Step: 1125/1895  |  Loss: 0.6908  |  Score: 54.83 [%]  |  Seq Length: 256.0
[2024-09-22 15:59:04,631][root][INFO] - Step: 1137/1895  |  Loss: 0.6788  |  Score: 56.47 [%]  |  Seq Length: 256.0
[2024-09-22 15:59:08,832][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 15:59:08,832][root][INFO] - Score: 51.20 [%]  |  Evaluation Time: 4.20 [s]
[2024-09-22 15:59:12,981][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 15:59:12,982][root][INFO] - Score: 52.31 [%]  |  Evaluation Time: 4.15 [s]
[2024-09-22 15:59:12,984][root][INFO] - 
[4/ 5 Epoch]
[2024-09-22 15:59:13,540][root][INFO] - Step: 400/39633  |  Loss: 1.0030  |  Score: 48.87 [%]  |  Seq Length: 256.0
[2024-09-22 15:59:44,787][root][INFO] - Step: 1200/1895  |  Loss: 0.6889  |  Score: 55.08 [%]  |  Seq Length: 256.0
[2024-09-22 16:00:22,158][root][INFO] - Step: 1275/1895  |  Loss: 0.6826  |  Score: 56.90 [%]  |  Seq Length: 256.0
[2024-09-22 16:00:59,531][root][INFO] - Step: 1350/1895  |  Loss: 0.6751  |  Score: 57.63 [%]  |  Seq Length: 256.0
[2024-09-22 16:01:37,157][root][INFO] - Step: 1425/1895  |  Loss: 0.6726  |  Score: 57.63 [%]  |  Seq Length: 256.0
[2024-09-22 16:02:14,692][root][INFO] - Step: 1500/1895  |  Loss: 0.6687  |  Score: 59.04 [%]  |  Seq Length: 256.0
[2024-09-22 16:02:22,381][root][INFO] - Step: 1516/1895  |  Loss: 0.6571  |  Score: 59.64 [%]  |  Seq Length: 256.0
[2024-09-22 16:02:26,577][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 16:02:26,577][root][INFO] - Score: 52.02 [%]  |  Evaluation Time: 4.19 [s]
[2024-09-22 16:02:30,730][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 16:02:30,731][root][INFO] - Score: 52.81 [%]  |  Evaluation Time: 4.15 [s]
[2024-09-22 16:02:30,733][root][INFO] - 
[5/ 5 Epoch]
[2024-09-22 16:02:59,629][root][INFO] - Step: 800/39633  |  Loss: 0.8511  |  Score: 61.86 [%]  |  Seq Length: 256.0
[2024-09-22 16:03:00,604][root][INFO] - Step: 1575/1895  |  Loss: 0.6042  |  Score: 67.35 [%]  |  Seq Length: 256.0
[2024-09-22 16:03:38,077][root][INFO] - Step: 1650/1895  |  Loss: 0.6055  |  Score: 66.58 [%]  |  Seq Length: 256.0
[2024-09-22 16:04:15,733][root][INFO] - Step: 1725/1895  |  Loss: 0.5910  |  Score: 68.12 [%]  |  Seq Length: 256.0
[2024-09-22 16:04:53,177][root][INFO] - Step: 1800/1895  |  Loss: 0.5917  |  Score: 67.65 [%]  |  Seq Length: 256.0
[2024-09-22 16:05:30,564][root][INFO] - Step: 1875/1895  |  Loss: 0.5822  |  Score: 68.71 [%]  |  Seq Length: 256.0
[2024-09-22 16:05:40,259][root][INFO] - Step: 1895/1895  |  Loss: 0.5942  |  Score: 67.24 [%]  |  Seq Length: 256.0
[2024-09-22 16:05:44,472][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 16:05:44,472][root][INFO] - Score: 51.14 [%]  |  Evaluation Time: 4.21 [s]
[2024-09-22 16:05:48,617][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 16:05:48,617][root][INFO] - Score: 50.19 [%]  |  Evaluation Time: 4.14 [s]
[2024-09-22 16:05:48,618][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 16:05:48,618][root][INFO] - - Epoch: 1
[2024-09-22 16:05:48,618][root][INFO] - - DEV score: 52.28 [%]
[2024-09-22 16:05:48,619][root][INFO] - - TEST score: 52.93 [%]
[2024-09-22 16:05:48,620][root][INFO] - Fine-tuning is done!
[2024-09-22 16:06:44,530][root][INFO] - Step: 1200/39633  |  Loss: 0.8159  |  Score: 63.74 [%]  |  Seq Length: 256.0
[2024-09-22 16:09:11,550][root][INFO] - 

[2024-09-22 16:09:11,550][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 16:09:11,551][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.005lr_42rs
[2024-09-22 16:09:11,551][root][INFO] - 

[2024-09-22 16:09:11,551][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 2, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'PAWS_X'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.005, 'batch_size': 64, 'total_steps': -1, 'epochs': 5, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 75, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.005lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.005lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.005lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 16:09:20,008][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 16:09:20,009][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 16:09:20,010][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 16:09:20,010][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 16:09:20,011][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 16:09:20,011][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 16:09:20,012][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 16:09:20,013][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 16:09:20,013][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 16:09:20,013][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 16:09:20,014][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 16:09:20,014][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 16:09:20,015][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 16:09:20,015][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 16:09:20,016][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 16:09:20,016][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 16:09:20,017][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 16:09:20,017][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 16:09:20,018][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 16:09:20,018][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 16:09:20,025][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 16:09:20,026][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 16:09:20,026][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 16:09:20,027][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 16:09:20,030][root][INFO] - Trainable params: 1769472 || all params: 126935040 || trainable: 1.39 %
[2024-09-22 16:09:20,038][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-22 16:09:20,052][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-22 16:09:20,054][root][INFO] - Trainable params: 2445312 || all params: 127610880 || trainable: 1.92 %
[2024-09-22 16:09:20,235][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 16:09:22,163][root][INFO] - 

[2024-09-22 16:09:22,163][root][INFO] - ========== Fine-tuning on PAWS_X ==========
[2024-09-22 16:09:22,163][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 16:09:22,171][root][INFO] - vocab size              : 51200
[2024-09-22 16:09:22,171][root][INFO] - device                  : gpu
[2024-09-22 16:09:22,171][root][INFO] - random seed             : 42
[2024-09-22 16:09:22,171][root][INFO] - train data size         : 24256
[2024-09-22 16:09:22,171][root][INFO] - max epochs              : 5
[2024-09-22 16:09:22,171][root][INFO] - total steps             : 1895
[2024-09-22 16:09:22,172][root][INFO] - warmup steps            : 190
[2024-09-22 16:09:22,172][root][INFO] - batch size              : 64
[2024-09-22 16:09:22,172][root][INFO] - accumulation steps      : 1
[2024-09-22 16:09:22,172][root][INFO] - optimizer               : adamwscale
[2024-09-22 16:09:22,172][root][INFO] - lr_scheduler            : cosine
[2024-09-22 16:09:22,172][root][INFO] - learning rate           : 0.005
[2024-09-22 16:09:22,172][root][INFO] - max length              : 256

[2024-09-22 16:09:22,172][root][INFO] - LoRA Configuration
[2024-09-22 16:09:22,172][root][INFO] - ㄴ r                    : 32
[2024-09-22 16:09:22,172][root][INFO] - ㄴ alpha                : 128
[2024-09-22 16:09:22,172][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 16:09:22,173][root][INFO] - KOMBO Configuration
[2024-09-22 16:09:22,173][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-22 16:09:22,173][root][INFO] - ㄴ reducer              : linear
[2024-09-22 16:09:22,173][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-22 16:09:22,173][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-22 16:09:22,173][root][INFO] - ㄴ do_combination       : False
[2024-09-22 16:09:22,173][root][INFO] - 

[2024-09-22 16:09:22,173][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.005lr_42rs
[2024-09-22 16:09:22,173][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.005lr_42rs/ckpt
[2024-09-22 16:09:22,173][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/PAWS_X/256t_64b_1s_0.005lr_42rs/tb
[2024-09-22 16:09:22,173][root][INFO] - * tb interval           : 75

[2024-09-22 16:09:22,173][root][INFO] - 

[2024-09-22 16:09:22,174][root][INFO] - Start the Training !
[2024-09-22 16:09:22,177][root][INFO] - 
[1/ 5 Epoch]
[2024-09-22 16:10:01,041][root][INFO] - Step: 75/1895  |  Loss: 0.7394  |  Score: 51.12 [%]  |  Seq Length: 256.0
[2024-09-22 16:10:31,280][root][INFO] - Step: 1600/39633  |  Loss: 0.7839  |  Score: 65.71 [%]  |  Seq Length: 256.0
[2024-09-22 16:10:38,713][root][INFO] - Step: 150/1895  |  Loss: 0.6997  |  Score: 53.44 [%]  |  Seq Length: 256.0
[2024-09-22 16:11:16,385][root][INFO] - Step: 225/1895  |  Loss: 0.6975  |  Score: 53.23 [%]  |  Seq Length: 256.0
[2024-09-22 16:11:53,996][root][INFO] - Step: 300/1895  |  Loss: 0.6984  |  Score: 53.15 [%]  |  Seq Length: 256.0
[2024-09-22 16:12:31,695][root][INFO] - Step: 375/1895  |  Loss: 0.6990  |  Score: 53.33 [%]  |  Seq Length: 256.0
[2024-09-22 16:12:33,464][root][INFO] - Step: 379/1895  |  Loss: 0.6853  |  Score: 55.60 [%]  |  Seq Length: 256.0
[2024-09-22 16:12:37,695][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 16:12:37,696][root][INFO] - Score: 52.18 [%]  |  Evaluation Time: 4.23 [s]
[2024-09-22 16:12:41,925][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 16:12:41,925][root][INFO] - Score: 52.80 [%]  |  Evaluation Time: 4.23 [s]
[2024-09-22 16:12:41,926][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 16:12:41,928][root][INFO] - 
[2/ 5 Epoch]
[2024-09-22 16:13:18,089][root][INFO] - Step: 450/1895  |  Loss: 0.7077  |  Score: 51.36 [%]  |  Seq Length: 256.0
[2024-09-22 16:13:55,912][root][INFO] - Step: 525/1895  |  Loss: 0.6992  |  Score: 52.62 [%]  |  Seq Length: 256.0
[2024-09-22 16:14:19,110][root][INFO] - Step: 2000/39633  |  Loss: 0.7745  |  Score: 66.22 [%]  |  Seq Length: 256.0
[2024-09-22 16:14:33,483][root][INFO] - Step: 600/1895  |  Loss: 0.7072  |  Score: 50.94 [%]  |  Seq Length: 256.0
[2024-09-22 16:15:11,142][root][INFO] - Step: 675/1895  |  Loss: 0.6929  |  Score: 53.62 [%]  |  Seq Length: 256.0
[2024-09-22 16:15:48,994][root][INFO] - Step: 750/1895  |  Loss: 0.6965  |  Score: 52.31 [%]  |  Seq Length: 256.0
[2024-09-22 16:15:52,745][root][INFO] - Step: 758/1895  |  Loss: 0.6984  |  Score: 51.11 [%]  |  Seq Length: 256.0
[2024-09-22 16:15:57,130][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 16:15:57,130][root][INFO] - Score: 45.93 [%]  |  Evaluation Time: 4.38 [s]
[2024-09-22 16:16:01,362][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 16:16:01,362][root][INFO] - Score: 47.02 [%]  |  Evaluation Time: 4.23 [s]
[2024-09-22 16:16:01,365][root][INFO] - 
[3/ 5 Epoch]
[2024-09-22 16:16:35,336][root][INFO] - Step: 825/1895  |  Loss: 0.6946  |  Score: 52.75 [%]  |  Seq Length: 256.0
[2024-09-22 16:17:13,124][root][INFO] - Step: 900/1895  |  Loss: 0.6907  |  Score: 53.77 [%]  |  Seq Length: 256.0
[2024-09-22 16:17:50,858][root][INFO] - Step: 975/1895  |  Loss: 0.6992  |  Score: 51.38 [%]  |  Seq Length: 256.0
[2024-09-22 16:18:07,340][root][INFO] - Step: 2400/39633  |  Loss: 0.7525  |  Score: 67.54 [%]  |  Seq Length: 256.0
[2024-09-22 16:18:28,515][root][INFO] - Step: 1050/1895  |  Loss: 0.6930  |  Score: 52.94 [%]  |  Seq Length: 256.0
[2024-09-22 16:19:06,225][root][INFO] - Step: 1125/1895  |  Loss: 0.6910  |  Score: 54.23 [%]  |  Seq Length: 256.0
[2024-09-22 16:19:11,941][root][INFO] - Step: 1137/1895  |  Loss: 0.6867  |  Score: 56.38 [%]  |  Seq Length: 256.0
[2024-09-22 16:19:16,190][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 16:19:16,190][root][INFO] - Score: 54.26 [%]  |  Evaluation Time: 4.25 [s]
[2024-09-22 16:19:20,431][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 16:19:20,431][root][INFO] - Score: 52.86 [%]  |  Evaluation Time: 4.24 [s]
[2024-09-22 16:19:20,433][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 16:19:20,434][root][INFO] - 
[4/ 5 Epoch]
[2024-09-22 16:19:52,369][root][INFO] - Step: 1200/1895  |  Loss: 0.6904  |  Score: 53.60 [%]  |  Seq Length: 256.0
[2024-09-22 16:20:29,955][root][INFO] - Step: 1275/1895  |  Loss: 0.6857  |  Score: 55.94 [%]  |  Seq Length: 256.0
[2024-09-22 16:20:46,576][root][INFO] - 

[2024-09-22 16:20:46,576][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 16:20:46,576][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.01lr_42rs
[2024-09-22 16:20:46,576][root][INFO] - 

[2024-09-22 16:20:46,577][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 16:21:07,782][root][INFO] - Step: 1350/1895  |  Loss: 0.6828  |  Score: 56.21 [%]  |  Seq Length: 256.0
[2024-09-22 16:21:15,059][root][INFO] - 

[2024-09-22 16:21:15,059][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 16:21:15,059][root][INFO] - Save the parser information to logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs
[2024-09-22 16:21:15,059][root][INFO] - 

[2024-09-22 16:21:15,059][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': True, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'vocab_size': 200, 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': True, 'lora': {'r': 16, 'alpha': 64, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 3, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorNLI'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 3, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 2, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 400, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs', 'tb_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/tb', 'save_dir': 'logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 16:21:45,620][root][INFO] - Step: 1425/1895  |  Loss: 0.6855  |  Score: 54.92 [%]  |  Seq Length: 256.0
[2024-09-22 16:21:54,805][root][INFO] - Step: 2800/39633  |  Loss: 0.7393  |  Score: 68.11 [%]  |  Seq Length: 256.0
[2024-09-22 16:22:23,352][root][INFO] - Step: 1500/1895  |  Loss: 0.6869  |  Score: 54.77 [%]  |  Seq Length: 256.0
[2024-09-22 16:22:31,115][root][INFO] - Step: 1516/1895  |  Loss: 0.6707  |  Score: 59.18 [%]  |  Seq Length: 256.0
[2024-09-22 16:22:35,368][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 16:22:35,368][root][INFO] - Score: 54.26 [%]  |  Evaluation Time: 4.25 [s]
[2024-09-22 16:22:39,600][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 16:22:39,600][root][INFO] - Score: 53.21 [%]  |  Evaluation Time: 4.23 [s]
[2024-09-22 16:22:39,602][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-22 16:22:39,605][root][INFO] - 
[5/ 5 Epoch]
[2024-09-22 16:23:09,817][root][INFO] - Step: 1575/1895  |  Loss: 0.6809  |  Score: 56.09 [%]  |  Seq Length: 256.0
[2024-09-22 16:23:22,071][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 16:23:22,071][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 16:23:22,072][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 16:23:22,073][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 16:23:22,073][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 16:23:22,074][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 16:23:22,074][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 16:23:22,075][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 16:23:22,075][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 16:23:22,076][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 16:23:22,077][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 16:23:22,077][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 16:23:22,078][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 16:23:22,078][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 16:23:22,079][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 16:23:22,079][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 16:23:22,080][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 16:23:22,081][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 16:23:22,081][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 16:23:22,082][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 16:23:22,083][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 16:23:22,083][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 16:23:22,084][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 16:23:22,084][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 16:23:22,086][root][INFO] - Trainable params: 1769472 || all params: 126935808 || trainable: 1.39 %
[2024-09-22 16:23:22,092][root][INFO] - Change the max_length to 2046 for the kombo_tokenizer's truncation.
[2024-09-22 16:23:22,102][root][INFO] - Replaced transformer.wte with KOMBO_LoRA_Layer
[2024-09-22 16:23:22,104][root][INFO] - Trainable params: 2445312 || all params: 127611648 || trainable: 1.92 %
[2024-09-22 16:23:22,333][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 16:23:24,560][root][INFO] - 

[2024-09-22 16:23:24,560][root][INFO] - ========== Fine-tuning on KorNLI ==========
[2024-09-22 16:23:24,560][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 16:23:24,568][root][INFO] - vocab size              : 51200
[2024-09-22 16:23:24,568][root][INFO] - device                  : gpu
[2024-09-22 16:23:24,568][root][INFO] - random seed             : 42
[2024-09-22 16:23:24,569][root][INFO] - train data size         : 422752
[2024-09-22 16:23:24,569][root][INFO] - max epochs              : 3
[2024-09-22 16:23:24,569][root][INFO] - total steps             : 39633
[2024-09-22 16:23:24,569][root][INFO] - warmup steps            : 3963
[2024-09-22 16:23:24,569][root][INFO] - batch size              : 64
[2024-09-22 16:23:24,569][root][INFO] - accumulation steps      : 2
[2024-09-22 16:23:24,569][root][INFO] - optimizer               : adamwscale
[2024-09-22 16:23:24,569][root][INFO] - lr_scheduler            : cosine
[2024-09-22 16:23:24,569][root][INFO] - learning rate           : 0.01
[2024-09-22 16:23:24,569][root][INFO] - max length              : 256

[2024-09-22 16:23:24,569][root][INFO] - LoRA Configuration
[2024-09-22 16:23:24,569][root][INFO] - ㄴ r                    : 32
[2024-09-22 16:23:24,570][root][INFO] - ㄴ alpha                : 128
[2024-09-22 16:23:24,570][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 16:23:24,570][root][INFO] - KOMBO Configuration
[2024-09-22 16:23:24,570][root][INFO] - ㄴ tok_type             : jamo_var
[2024-09-22 16:23:24,570][root][INFO] - ㄴ reducer              : linear
[2024-09-22 16:23:24,570][root][INFO] - ㄴ hidden_dim           : 768
[2024-09-22 16:23:24,570][root][INFO] - ㄴ kombo_max_length     : 2046
[2024-09-22 16:23:24,570][root][INFO] - ㄴ do_combination       : False
[2024-09-22 16:23:24,570][root][INFO] - 

[2024-09-22 16:23:24,570][root][INFO] - * log dir               : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs
[2024-09-22 16:23:24,571][root][INFO] - * save dir              : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/ckpt
[2024-09-22 16:23:24,571][root][INFO] - * tb dir                : logs/skt/kogpt2-base-v2/nlu_tasks/KorNLI/256t_64b_2s_0.01lr_42rs/tb
[2024-09-22 16:23:24,571][root][INFO] - * tb interval           : 400

[2024-09-22 16:23:24,571][root][INFO] - 

[2024-09-22 16:23:24,571][root][INFO] - Start the Training !
[2024-09-22 16:23:24,574][root][INFO] - 
[1/ 3 Epoch]
[2024-09-22 16:23:47,661][root][INFO] - Step: 1650/1895  |  Loss: 0.6816  |  Score: 55.88 [%]  |  Seq Length: 256.0
[2024-09-22 16:24:25,289][root][INFO] - Step: 1725/1895  |  Loss: 0.6766  |  Score: 57.04 [%]  |  Seq Length: 256.0
[2024-09-22 16:25:03,060][root][INFO] - Step: 1800/1895  |  Loss: 0.6759  |  Score: 57.46 [%]  |  Seq Length: 256.0
[2024-09-22 16:25:40,505][root][INFO] - Step: 1875/1895  |  Loss: 0.6760  |  Score: 57.42 [%]  |  Seq Length: 256.0
[2024-09-22 16:25:42,030][root][INFO] - Step: 3200/39633  |  Loss: 0.7251  |  Score: 68.80 [%]  |  Seq Length: 256.0
[2024-09-22 16:25:50,172][root][INFO] - Step: 1895/1895  |  Loss: 0.6776  |  Score: 58.18 [%]  |  Seq Length: 256.0
[2024-09-22 16:25:54,401][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 16:25:54,401][root][INFO] - Score: 49.54 [%]  |  Evaluation Time: 4.23 [s]
[2024-09-22 16:25:58,571][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 16:25:58,572][root][INFO] - Score: 52.46 [%]  |  Evaluation Time: 4.17 [s]
[2024-09-22 16:25:58,573][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 16:25:58,573][root][INFO] - - Epoch: 4
[2024-09-22 16:25:58,573][root][INFO] - - DEV score: 54.26 [%]
[2024-09-22 16:25:58,573][root][INFO] - - TEST score: 53.21 [%]
[2024-09-22 16:25:58,574][root][INFO] - Fine-tuning is done!
[2024-09-22 16:26:47,505][root][INFO] - Step: 400/39633  |  Loss: 0.9985  |  Score: 49.27 [%]  |  Seq Length: 256.0
[2024-09-22 16:29:29,251][root][INFO] - Step: 3600/39633  |  Loss: 0.7296  |  Score: 68.59 [%]  |  Seq Length: 256.0
[2024-09-22 16:30:09,835][root][INFO] - Step: 800/39633  |  Loss: 0.8587  |  Score: 61.11 [%]  |  Seq Length: 256.0
[2024-09-22 16:33:16,648][root][INFO] - Step: 4000/39633  |  Loss: 0.7111  |  Score: 69.71 [%]  |  Seq Length: 256.0
[2024-09-22 16:33:31,373][root][INFO] - Step: 1200/39633  |  Loss: 0.8189  |  Score: 63.55 [%]  |  Seq Length: 256.0
[2024-09-22 16:36:53,413][root][INFO] - Step: 1600/39633  |  Loss: 0.7960  |  Score: 64.94 [%]  |  Seq Length: 256.0
[2024-09-22 16:37:02,859][root][INFO] - Step: 4400/39633  |  Loss: 0.7146  |  Score: 69.38 [%]  |  Seq Length: 256.0
[2024-09-22 16:40:15,369][root][INFO] - Step: 2000/39633  |  Loss: 0.7852  |  Score: 65.34 [%]  |  Seq Length: 256.0
[2024-09-22 16:40:49,534][root][INFO] - Step: 4800/39633  |  Loss: 0.6987  |  Score: 70.43 [%]  |  Seq Length: 256.0
[2024-09-22 16:43:37,544][root][INFO] - Step: 2400/39633  |  Loss: 0.7787  |  Score: 65.93 [%]  |  Seq Length: 256.0
[2024-09-22 16:44:36,488][root][INFO] - Step: 5200/39633  |  Loss: 0.6812  |  Score: 71.12 [%]  |  Seq Length: 256.0
[2024-09-22 16:46:59,081][root][INFO] - Step: 2800/39633  |  Loss: 0.7669  |  Score: 66.65 [%]  |  Seq Length: 256.0
[2024-09-22 16:48:22,971][root][INFO] - Step: 5600/39633  |  Loss: 0.6865  |  Score: 71.09 [%]  |  Seq Length: 256.0
[2024-09-22 16:50:20,474][root][INFO] - Step: 3200/39633  |  Loss: 0.7580  |  Score: 66.97 [%]  |  Seq Length: 256.0
[2024-09-22 16:52:10,164][root][INFO] - Step: 6000/39633  |  Loss: 0.6826  |  Score: 71.32 [%]  |  Seq Length: 256.0
[2024-09-22 16:53:42,351][root][INFO] - Step: 3600/39633  |  Loss: 0.7509  |  Score: 67.32 [%]  |  Seq Length: 256.0
[2024-09-22 16:55:57,191][root][INFO] - Step: 6400/39633  |  Loss: 0.6811  |  Score: 71.14 [%]  |  Seq Length: 256.0
[2024-09-22 16:57:04,269][root][INFO] - Step: 4000/39633  |  Loss: 0.7392  |  Score: 68.18 [%]  |  Seq Length: 256.0
[2024-09-22 16:59:44,177][root][INFO] - Step: 6800/39633  |  Loss: 0.6651  |  Score: 72.02 [%]  |  Seq Length: 256.0
[2024-09-22 17:00:26,291][root][INFO] - Step: 4400/39633  |  Loss: 0.7363  |  Score: 68.02 [%]  |  Seq Length: 256.0
[2024-09-22 17:03:31,146][root][INFO] - Step: 7200/39633  |  Loss: 0.6755  |  Score: 71.57 [%]  |  Seq Length: 256.0
[2024-09-22 17:03:47,817][root][INFO] - Step: 4800/39633  |  Loss: 0.7232  |  Score: 68.71 [%]  |  Seq Length: 256.0
[2024-09-22 17:07:09,819][root][INFO] - Step: 5200/39633  |  Loss: 0.7186  |  Score: 69.36 [%]  |  Seq Length: 256.0
[2024-09-22 17:07:18,968][root][INFO] - Step: 7600/39633  |  Loss: 0.6771  |  Score: 71.21 [%]  |  Seq Length: 256.0
[2024-09-22 17:10:31,992][root][INFO] - Step: 5600/39633  |  Loss: 0.7180  |  Score: 69.37 [%]  |  Seq Length: 256.0
[2024-09-22 17:11:06,103][root][INFO] - Step: 8000/39633  |  Loss: 0.6637  |  Score: 72.08 [%]  |  Seq Length: 256.0
[2024-09-22 17:13:54,048][root][INFO] - Step: 6000/39633  |  Loss: 0.6999  |  Score: 70.03 [%]  |  Seq Length: 256.0
[2024-09-22 17:14:53,447][root][INFO] - Step: 8400/39633  |  Loss: 0.6637  |  Score: 72.38 [%]  |  Seq Length: 256.0
[2024-09-22 17:17:15,947][root][INFO] - Step: 6400/39633  |  Loss: 0.7065  |  Score: 69.84 [%]  |  Seq Length: 256.0
[2024-09-22 17:18:40,787][root][INFO] - Step: 8800/39633  |  Loss: 0.6548  |  Score: 72.64 [%]  |  Seq Length: 256.0
[2024-09-22 17:20:37,802][root][INFO] - Step: 6800/39633  |  Loss: 0.6980  |  Score: 70.92 [%]  |  Seq Length: 256.0
[2024-09-22 17:22:27,986][root][INFO] - Step: 9200/39633  |  Loss: 0.6577  |  Score: 72.42 [%]  |  Seq Length: 256.0
[2024-09-22 17:24:00,035][root][INFO] - Step: 7200/39633  |  Loss: 0.6962  |  Score: 70.72 [%]  |  Seq Length: 256.0
[2024-09-22 17:26:14,972][root][INFO] - Step: 9600/39633  |  Loss: 0.6595  |  Score: 72.35 [%]  |  Seq Length: 256.0
[2024-09-22 17:27:22,392][root][INFO] - Step: 7600/39633  |  Loss: 0.6929  |  Score: 70.61 [%]  |  Seq Length: 256.0
[2024-09-22 17:30:01,826][root][INFO] - Step: 10000/39633  |  Loss: 0.6553  |  Score: 72.73 [%]  |  Seq Length: 256.0
[2024-09-22 17:30:43,878][root][INFO] - Step: 8000/39633  |  Loss: 0.6809  |  Score: 70.89 [%]  |  Seq Length: 256.0
[2024-09-22 17:33:48,904][root][INFO] - Step: 10400/39633  |  Loss: 0.6575  |  Score: 72.55 [%]  |  Seq Length: 256.0
[2024-09-22 17:34:06,261][root][INFO] - Step: 8400/39633  |  Loss: 0.6812  |  Score: 70.92 [%]  |  Seq Length: 256.0
[2024-09-22 17:37:28,172][root][INFO] - Step: 8800/39633  |  Loss: 0.6827  |  Score: 71.18 [%]  |  Seq Length: 256.0
[2024-09-22 17:37:36,397][root][INFO] - Step: 10800/39633  |  Loss: 0.6450  |  Score: 73.21 [%]  |  Seq Length: 256.0
[2024-09-22 17:40:50,497][root][INFO] - Step: 9200/39633  |  Loss: 0.6753  |  Score: 71.30 [%]  |  Seq Length: 256.0
[2024-09-22 17:41:23,957][root][INFO] - Step: 11200/39633  |  Loss: 0.6566  |  Score: 72.38 [%]  |  Seq Length: 256.0
[2024-09-22 17:44:12,638][root][INFO] - Step: 9600/39633  |  Loss: 0.6735  |  Score: 71.40 [%]  |  Seq Length: 256.0
[2024-09-22 17:45:11,428][root][INFO] - Step: 11600/39633  |  Loss: 0.6418  |  Score: 73.14 [%]  |  Seq Length: 256.0
[2024-09-22 17:47:34,520][root][INFO] - Step: 10000/39633  |  Loss: 0.6700  |  Score: 72.05 [%]  |  Seq Length: 256.0
[2024-09-22 17:48:59,462][root][INFO] - Step: 12000/39633  |  Loss: 0.6417  |  Score: 73.12 [%]  |  Seq Length: 256.0
[2024-09-22 17:50:56,931][root][INFO] - Step: 10400/39633  |  Loss: 0.6704  |  Score: 71.99 [%]  |  Seq Length: 256.0
[2024-09-22 17:52:46,848][root][INFO] - Step: 12400/39633  |  Loss: 0.6384  |  Score: 73.40 [%]  |  Seq Length: 256.0
[2024-09-22 17:54:18,531][root][INFO] - Step: 10800/39633  |  Loss: 0.6630  |  Score: 72.18 [%]  |  Seq Length: 256.0
[2024-09-22 17:56:33,385][root][INFO] - Step: 12800/39633  |  Loss: 0.6356  |  Score: 73.65 [%]  |  Seq Length: 256.0
[2024-09-22 17:57:40,736][root][INFO] - Step: 11200/39633  |  Loss: 0.6535  |  Score: 72.66 [%]  |  Seq Length: 256.0
[2024-09-22 18:00:19,700][root][INFO] - Step: 13200/39633  |  Loss: 0.6312  |  Score: 73.93 [%]  |  Seq Length: 256.0
[2024-09-22 18:00:25,958][root][INFO] - Step: 13211/39633  |  Loss: 0.6232  |  Score: 74.86 [%]  |  Seq Length: 256.0
[2024-09-22 18:00:34,437][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 18:00:34,437][root][INFO] - Score: 71.03 [%]  |  Evaluation Time: 8.48 [s]
[2024-09-22 18:00:50,557][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 18:00:50,557][root][INFO] - Score: 71.30 [%]  |  Evaluation Time: 16.12 [s]
[2024-09-22 18:00:50,558][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 18:00:50,560][root][INFO] - 
[2/ 3 Epoch]
[2024-09-22 18:01:02,785][root][INFO] - Step: 11600/39633  |  Loss: 0.6545  |  Score: 72.62 [%]  |  Seq Length: 256.0
[2024-09-22 18:04:24,943][root][INFO] - Step: 12000/39633  |  Loss: 0.6522  |  Score: 72.85 [%]  |  Seq Length: 256.0
[2024-09-22 18:04:31,371][root][INFO] - Step: 13600/39633  |  Loss: 0.6204  |  Score: 74.39 [%]  |  Seq Length: 256.0
[2024-09-22 18:07:47,671][root][INFO] - Step: 12400/39633  |  Loss: 0.6580  |  Score: 72.39 [%]  |  Seq Length: 256.0
[2024-09-22 18:08:18,955][root][INFO] - Step: 14000/39633  |  Loss: 0.6192  |  Score: 74.40 [%]  |  Seq Length: 256.0
[2024-09-22 18:11:09,647][root][INFO] - Step: 12800/39633  |  Loss: 0.6514  |  Score: 72.55 [%]  |  Seq Length: 256.0
[2024-09-22 18:12:05,520][root][INFO] - Step: 14400/39633  |  Loss: 0.6164  |  Score: 74.43 [%]  |  Seq Length: 256.0
[2024-09-22 18:14:32,119][root][INFO] - Step: 13200/39633  |  Loss: 0.6463  |  Score: 73.15 [%]  |  Seq Length: 256.0
[2024-09-22 18:14:37,629][root][INFO] - Step: 13211/39633  |  Loss: 0.6218  |  Score: 74.67 [%]  |  Seq Length: 256.0
[2024-09-22 18:14:45,548][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 18:14:45,548][root][INFO] - Score: 69.90 [%]  |  Evaluation Time: 7.92 [s]
[2024-09-22 18:15:00,291][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 18:15:00,291][root][INFO] - Score: 69.82 [%]  |  Evaluation Time: 14.74 [s]
[2024-09-22 18:15:00,292][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 18:15:00,293][root][INFO] - 
[2/ 3 Epoch]
[2024-09-22 18:15:52,449][root][INFO] - Step: 14800/39633  |  Loss: 0.6169  |  Score: 74.51 [%]  |  Seq Length: 256.0
[2024-09-22 18:18:17,943][root][INFO] - Step: 13600/39633  |  Loss: 0.6317  |  Score: 73.77 [%]  |  Seq Length: 256.0
[2024-09-22 18:19:39,479][root][INFO] - Step: 15200/39633  |  Loss: 0.6112  |  Score: 74.66 [%]  |  Seq Length: 256.0
[2024-09-22 18:21:41,045][root][INFO] - Step: 14000/39633  |  Loss: 0.6289  |  Score: 74.07 [%]  |  Seq Length: 256.0
[2024-09-22 18:23:27,066][root][INFO] - Step: 15600/39633  |  Loss: 0.5999  |  Score: 75.54 [%]  |  Seq Length: 256.0
[2024-09-22 18:25:03,943][root][INFO] - Step: 14400/39633  |  Loss: 0.6323  |  Score: 73.41 [%]  |  Seq Length: 256.0
[2024-09-22 18:27:14,298][root][INFO] - Step: 16000/39633  |  Loss: 0.6118  |  Score: 74.64 [%]  |  Seq Length: 256.0
[2024-09-22 18:28:24,676][root][INFO] - Step: 14800/39633  |  Loss: 0.6209  |  Score: 74.44 [%]  |  Seq Length: 256.0
[2024-09-22 18:30:58,735][root][INFO] - Step: 16400/39633  |  Loss: 0.6133  |  Score: 74.77 [%]  |  Seq Length: 256.0
[2024-09-22 18:31:45,695][root][INFO] - Step: 15200/39633  |  Loss: 0.6257  |  Score: 73.75 [%]  |  Seq Length: 256.0
[2024-09-22 18:34:45,853][root][INFO] - Step: 16800/39633  |  Loss: 0.6096  |  Score: 74.85 [%]  |  Seq Length: 256.0
[2024-09-22 18:35:05,883][root][INFO] - Step: 15600/39633  |  Loss: 0.6267  |  Score: 74.05 [%]  |  Seq Length: 256.0
[2024-09-22 18:38:27,853][root][INFO] - Step: 16000/39633  |  Loss: 0.6267  |  Score: 74.09 [%]  |  Seq Length: 256.0
[2024-09-22 18:38:31,484][root][INFO] - Step: 17200/39633  |  Loss: 0.5998  |  Score: 75.07 [%]  |  Seq Length: 256.0
[2024-09-22 18:41:49,657][root][INFO] - Step: 16400/39633  |  Loss: 0.6192  |  Score: 74.20 [%]  |  Seq Length: 256.0
[2024-09-22 18:42:16,302][root][INFO] - Step: 17600/39633  |  Loss: 0.6056  |  Score: 75.11 [%]  |  Seq Length: 256.0
[2024-09-22 18:45:11,055][root][INFO] - Step: 16800/39633  |  Loss: 0.6149  |  Score: 74.52 [%]  |  Seq Length: 256.0
[2024-09-22 18:46:03,419][root][INFO] - Step: 18000/39633  |  Loss: 0.5999  |  Score: 75.48 [%]  |  Seq Length: 256.0
[2024-09-22 18:48:29,451][root][INFO] - Step: 17200/39633  |  Loss: 0.6236  |  Score: 74.21 [%]  |  Seq Length: 256.0
[2024-09-22 18:49:50,781][root][INFO] - Step: 18400/39633  |  Loss: 0.6014  |  Score: 75.26 [%]  |  Seq Length: 256.0
[2024-09-22 18:51:49,947][root][INFO] - Step: 17600/39633  |  Loss: 0.6152  |  Score: 74.71 [%]  |  Seq Length: 256.0
[2024-09-22 18:53:37,864][root][INFO] - Step: 18800/39633  |  Loss: 0.6036  |  Score: 75.10 [%]  |  Seq Length: 256.0
[2024-09-22 18:55:11,546][root][INFO] - Step: 18000/39633  |  Loss: 0.6089  |  Score: 74.93 [%]  |  Seq Length: 256.0
[2024-09-22 18:57:22,996][root][INFO] - Step: 19200/39633  |  Loss: 0.6054  |  Score: 74.82 [%]  |  Seq Length: 256.0
[2024-09-22 18:58:32,300][root][INFO] - Step: 18400/39633  |  Loss: 0.6107  |  Score: 74.57 [%]  |  Seq Length: 256.0
[2024-09-22 19:01:09,741][root][INFO] - Step: 19600/39633  |  Loss: 0.5957  |  Score: 75.64 [%]  |  Seq Length: 256.0
[2024-09-22 19:01:54,046][root][INFO] - Step: 18800/39633  |  Loss: 0.6154  |  Score: 74.75 [%]  |  Seq Length: 256.0
[2024-09-22 19:04:55,370][root][INFO] - Step: 20000/39633  |  Loss: 0.6022  |  Score: 75.20 [%]  |  Seq Length: 256.0
[2024-09-22 19:05:16,160][root][INFO] - Step: 19200/39633  |  Loss: 0.6138  |  Score: 74.58 [%]  |  Seq Length: 256.0
[2024-09-22 19:08:38,258][root][INFO] - Step: 19600/39633  |  Loss: 0.6124  |  Score: 74.60 [%]  |  Seq Length: 256.0
[2024-09-22 19:08:41,897][root][INFO] - Step: 20400/39633  |  Loss: 0.5957  |  Score: 75.46 [%]  |  Seq Length: 256.0
[2024-09-22 19:12:00,144][root][INFO] - Step: 20000/39633  |  Loss: 0.6081  |  Score: 75.08 [%]  |  Seq Length: 256.0
[2024-09-22 19:12:28,725][root][INFO] - Step: 20800/39633  |  Loss: 0.5994  |  Score: 75.52 [%]  |  Seq Length: 256.0
[2024-09-22 19:15:21,300][root][INFO] - Step: 20400/39633  |  Loss: 0.6060  |  Score: 74.85 [%]  |  Seq Length: 256.0
[2024-09-22 19:16:15,850][root][INFO] - Step: 21200/39633  |  Loss: 0.5915  |  Score: 75.74 [%]  |  Seq Length: 256.0
[2024-09-22 19:18:42,499][root][INFO] - Step: 20800/39633  |  Loss: 0.5926  |  Score: 75.73 [%]  |  Seq Length: 256.0
[2024-09-22 19:20:01,821][root][INFO] - Step: 21600/39633  |  Loss: 0.5859  |  Score: 76.11 [%]  |  Seq Length: 256.0
[2024-09-22 19:22:05,001][root][INFO] - Step: 21200/39633  |  Loss: 0.5983  |  Score: 75.54 [%]  |  Seq Length: 256.0
[2024-09-22 19:23:49,067][root][INFO] - Step: 22000/39633  |  Loss: 0.5892  |  Score: 75.95 [%]  |  Seq Length: 256.0
[2024-09-22 19:25:27,420][root][INFO] - Step: 21600/39633  |  Loss: 0.5995  |  Score: 75.31 [%]  |  Seq Length: 256.0
[2024-09-22 19:27:35,349][root][INFO] - Step: 22400/39633  |  Loss: 0.5869  |  Score: 76.07 [%]  |  Seq Length: 256.0
[2024-09-22 19:28:48,633][root][INFO] - Step: 22000/39633  |  Loss: 0.5994  |  Score: 75.29 [%]  |  Seq Length: 256.0
[2024-09-22 19:31:20,461][root][INFO] - Step: 22800/39633  |  Loss: 0.5868  |  Score: 75.76 [%]  |  Seq Length: 256.0
[2024-09-22 19:32:10,682][root][INFO] - Step: 22400/39633  |  Loss: 0.5928  |  Score: 75.51 [%]  |  Seq Length: 256.0
[2024-09-22 19:35:07,455][root][INFO] - Step: 23200/39633  |  Loss: 0.5882  |  Score: 75.78 [%]  |  Seq Length: 256.0
[2024-09-22 19:35:32,615][root][INFO] - Step: 22800/39633  |  Loss: 0.5936  |  Score: 75.64 [%]  |  Seq Length: 256.0
[2024-09-22 19:38:54,950][root][INFO] - Step: 23200/39633  |  Loss: 0.6023  |  Score: 75.14 [%]  |  Seq Length: 256.0
[2024-09-22 19:38:55,500][root][INFO] - Step: 23600/39633  |  Loss: 0.5751  |  Score: 76.63 [%]  |  Seq Length: 256.0
[2024-09-22 19:42:16,061][root][INFO] - Step: 23600/39633  |  Loss: 0.5814  |  Score: 76.21 [%]  |  Seq Length: 256.0
[2024-09-22 19:42:40,634][root][INFO] - Step: 24000/39633  |  Loss: 0.5742  |  Score: 76.80 [%]  |  Seq Length: 256.0
[2024-09-22 19:45:38,204][root][INFO] - Step: 24000/39633  |  Loss: 0.5923  |  Score: 75.77 [%]  |  Seq Length: 256.0
[2024-09-22 19:46:28,766][root][INFO] - Step: 24400/39633  |  Loss: 0.5830  |  Score: 76.21 [%]  |  Seq Length: 256.0
[2024-09-22 19:48:57,120][root][INFO] - Step: 24400/39633  |  Loss: 0.5863  |  Score: 75.73 [%]  |  Seq Length: 256.0
[2024-09-22 19:50:13,389][root][INFO] - Step: 24800/39633  |  Loss: 0.5794  |  Score: 76.42 [%]  |  Seq Length: 256.0
[2024-09-22 19:52:19,728][root][INFO] - Step: 24800/39633  |  Loss: 0.5842  |  Score: 76.16 [%]  |  Seq Length: 256.0
[2024-09-22 19:54:01,025][root][INFO] - Step: 25200/39633  |  Loss: 0.5759  |  Score: 76.57 [%]  |  Seq Length: 256.0
[2024-09-22 19:55:37,525][root][INFO] - Step: 25200/39633  |  Loss: 0.5854  |  Score: 75.94 [%]  |  Seq Length: 256.0
[2024-09-22 19:57:49,174][root][INFO] - Step: 25600/39633  |  Loss: 0.5793  |  Score: 76.24 [%]  |  Seq Length: 256.0
[2024-09-22 19:58:54,528][root][INFO] - Step: 25600/39633  |  Loss: 0.5835  |  Score: 76.09 [%]  |  Seq Length: 256.0
[2024-09-22 20:01:32,566][root][INFO] - Step: 26000/39633  |  Loss: 0.5719  |  Score: 76.54 [%]  |  Seq Length: 256.0
[2024-09-22 20:02:17,725][root][INFO] - Step: 26000/39633  |  Loss: 0.5761  |  Score: 76.29 [%]  |  Seq Length: 256.0
[2024-09-22 20:05:20,251][root][INFO] - Step: 26400/39633  |  Loss: 0.5798  |  Score: 76.29 [%]  |  Seq Length: 256.0
[2024-09-22 20:05:32,622][root][INFO] - Step: 26422/39633  |  Loss: 0.5619  |  Score: 76.61 [%]  |  Seq Length: 256.0
[2024-09-22 20:05:40,294][root][INFO] - Step: 26400/39633  |  Loss: 0.5710  |  Score: 76.62 [%]  |  Seq Length: 256.0
[2024-09-22 20:05:41,218][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 20:05:41,218][root][INFO] - Score: 73.59 [%]  |  Evaluation Time: 8.59 [s]
[2024-09-22 20:05:51,573][root][INFO] - Step: 26422/39633  |  Loss: 0.5871  |  Score: 76.68 [%]  |  Seq Length: 256.0
[2024-09-22 20:05:57,326][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 20:05:57,327][root][INFO] - Score: 74.06 [%]  |  Evaluation Time: 16.11 [s]
[2024-09-22 20:05:57,327][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 20:05:57,329][root][INFO] - 
[3/ 3 Epoch]
[2024-09-22 20:05:59,412][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 20:05:59,412][root][INFO] - Score: 74.52 [%]  |  Evaluation Time: 7.84 [s]
[2024-09-22 20:06:14,011][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 20:06:14,011][root][INFO] - Score: 73.52 [%]  |  Evaluation Time: 14.60 [s]
[2024-09-22 20:06:14,012][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 20:06:14,014][root][INFO] - 
[3/ 3 Epoch]
[2024-09-22 20:09:24,561][root][INFO] - Step: 26800/39633  |  Loss: 0.5480  |  Score: 77.80 [%]  |  Seq Length: 256.0
[2024-09-22 20:09:28,893][root][INFO] - Step: 26800/39633  |  Loss: 0.5460  |  Score: 77.62 [%]  |  Seq Length: 256.0
[2024-09-22 20:12:45,986][root][INFO] - Step: 27200/39633  |  Loss: 0.5499  |  Score: 77.70 [%]  |  Seq Length: 256.0
[2024-09-22 20:13:17,551][root][INFO] - Step: 27200/39633  |  Loss: 0.5413  |  Score: 77.80 [%]  |  Seq Length: 256.0
[2024-09-22 20:16:08,504][root][INFO] - Step: 27600/39633  |  Loss: 0.5551  |  Score: 77.66 [%]  |  Seq Length: 256.0
[2024-09-22 20:17:01,251][root][INFO] - Step: 27600/39633  |  Loss: 0.5451  |  Score: 78.18 [%]  |  Seq Length: 256.0
[2024-09-22 20:19:29,478][root][INFO] - Step: 28000/39633  |  Loss: 0.5502  |  Score: 77.56 [%]  |  Seq Length: 256.0
[2024-09-22 20:20:48,234][root][INFO] - Step: 28000/39633  |  Loss: 0.5452  |  Score: 77.93 [%]  |  Seq Length: 256.0
[2024-09-22 20:22:48,793][root][INFO] - Step: 28400/39633  |  Loss: 0.5426  |  Score: 78.06 [%]  |  Seq Length: 256.0
[2024-09-22 20:24:37,990][root][INFO] - Step: 28400/39633  |  Loss: 0.5450  |  Score: 77.64 [%]  |  Seq Length: 256.0
[2024-09-22 20:26:09,235][root][INFO] - Step: 28800/39633  |  Loss: 0.5443  |  Score: 77.91 [%]  |  Seq Length: 256.0
[2024-09-22 20:28:27,061][root][INFO] - Step: 28800/39633  |  Loss: 0.5431  |  Score: 77.57 [%]  |  Seq Length: 256.0
[2024-09-22 20:29:29,489][root][INFO] - Step: 29200/39633  |  Loss: 0.5514  |  Score: 77.56 [%]  |  Seq Length: 256.0
[2024-09-22 20:32:13,341][root][INFO] - Step: 29200/39633  |  Loss: 0.5378  |  Score: 78.36 [%]  |  Seq Length: 256.0
[2024-09-22 20:32:52,132][root][INFO] - Step: 29600/39633  |  Loss: 0.5542  |  Score: 77.63 [%]  |  Seq Length: 256.0
[2024-09-22 20:36:01,205][root][INFO] - Step: 29600/39633  |  Loss: 0.5407  |  Score: 78.03 [%]  |  Seq Length: 256.0
[2024-09-22 20:36:13,546][root][INFO] - Step: 30000/39633  |  Loss: 0.5475  |  Score: 77.62 [%]  |  Seq Length: 256.0
[2024-09-22 20:39:35,661][root][INFO] - Step: 30400/39633  |  Loss: 0.5522  |  Score: 77.31 [%]  |  Seq Length: 256.0
[2024-09-22 20:39:49,221][root][INFO] - Step: 30000/39633  |  Loss: 0.5431  |  Score: 78.19 [%]  |  Seq Length: 256.0
[2024-09-22 20:42:57,575][root][INFO] - Step: 30800/39633  |  Loss: 0.5369  |  Score: 78.21 [%]  |  Seq Length: 256.0
[2024-09-22 20:43:37,545][root][INFO] - Step: 30400/39633  |  Loss: 0.5438  |  Score: 78.28 [%]  |  Seq Length: 256.0
[2024-09-22 20:46:18,630][root][INFO] - Step: 31200/39633  |  Loss: 0.5396  |  Score: 78.06 [%]  |  Seq Length: 256.0
[2024-09-22 20:47:24,136][root][INFO] - Step: 30800/39633  |  Loss: 0.5360  |  Score: 78.19 [%]  |  Seq Length: 256.0
[2024-09-22 20:49:41,038][root][INFO] - Step: 31600/39633  |  Loss: 0.5409  |  Score: 77.92 [%]  |  Seq Length: 256.0
[2024-09-22 20:51:12,589][root][INFO] - Step: 31200/39633  |  Loss: 0.5341  |  Score: 78.59 [%]  |  Seq Length: 256.0
[2024-09-22 20:53:00,270][root][INFO] - Step: 32000/39633  |  Loss: 0.5484  |  Score: 77.89 [%]  |  Seq Length: 256.0
[2024-09-22 20:55:00,666][root][INFO] - Step: 31600/39633  |  Loss: 0.5412  |  Score: 78.06 [%]  |  Seq Length: 256.0
[2024-09-22 20:56:22,117][root][INFO] - Step: 32400/39633  |  Loss: 0.5449  |  Score: 77.77 [%]  |  Seq Length: 256.0
[2024-09-22 20:58:44,175][root][INFO] - Step: 32000/39633  |  Loss: 0.5336  |  Score: 78.70 [%]  |  Seq Length: 256.0
[2024-09-22 20:59:44,906][root][INFO] - Step: 32800/39633  |  Loss: 0.5362  |  Score: 78.29 [%]  |  Seq Length: 256.0
[2024-09-22 21:02:33,386][root][INFO] - Step: 32400/39633  |  Loss: 0.5323  |  Score: 78.34 [%]  |  Seq Length: 256.0
[2024-09-22 21:03:07,056][root][INFO] - Step: 33200/39633  |  Loss: 0.5416  |  Score: 78.08 [%]  |  Seq Length: 256.0
[2024-09-22 21:06:22,028][root][INFO] - Step: 32800/39633  |  Loss: 0.5348  |  Score: 78.63 [%]  |  Seq Length: 256.0
[2024-09-22 21:06:27,101][root][INFO] - Step: 33600/39633  |  Loss: 0.5345  |  Score: 78.29 [%]  |  Seq Length: 256.0
[2024-09-22 21:09:50,445][root][INFO] - Step: 34000/39633  |  Loss: 0.5436  |  Score: 78.12 [%]  |  Seq Length: 256.0
[2024-09-22 21:10:10,151][root][INFO] - Step: 33200/39633  |  Loss: 0.5372  |  Score: 78.32 [%]  |  Seq Length: 256.0
[2024-09-22 21:13:13,495][root][INFO] - Step: 34400/39633  |  Loss: 0.5396  |  Score: 78.12 [%]  |  Seq Length: 256.0
[2024-09-22 21:13:58,094][root][INFO] - Step: 33600/39633  |  Loss: 0.5315  |  Score: 78.27 [%]  |  Seq Length: 256.0
[2024-09-22 21:16:36,429][root][INFO] - Step: 34800/39633  |  Loss: 0.5441  |  Score: 77.69 [%]  |  Seq Length: 256.0
[2024-09-22 21:17:46,759][root][INFO] - Step: 34000/39633  |  Loss: 0.5338  |  Score: 78.21 [%]  |  Seq Length: 256.0
[2024-09-22 21:19:57,845][root][INFO] - Step: 35200/39633  |  Loss: 0.5331  |  Score: 78.52 [%]  |  Seq Length: 256.0
[2024-09-22 21:21:35,321][root][INFO] - Step: 34400/39633  |  Loss: 0.5326  |  Score: 78.53 [%]  |  Seq Length: 256.0
[2024-09-22 21:23:17,502][root][INFO] - Step: 35600/39633  |  Loss: 0.5291  |  Score: 78.66 [%]  |  Seq Length: 256.0
[2024-09-22 21:25:22,902][root][INFO] - Step: 34800/39633  |  Loss: 0.5220  |  Score: 78.82 [%]  |  Seq Length: 256.0
[2024-09-22 21:26:40,033][root][INFO] - Step: 36000/39633  |  Loss: 0.5382  |  Score: 78.16 [%]  |  Seq Length: 256.0
[2024-09-22 21:29:11,733][root][INFO] - Step: 35200/39633  |  Loss: 0.5315  |  Score: 78.71 [%]  |  Seq Length: 256.0
[2024-09-22 21:30:01,616][root][INFO] - Step: 36400/39633  |  Loss: 0.5320  |  Score: 78.41 [%]  |  Seq Length: 256.0
[2024-09-22 21:32:59,446][root][INFO] - Step: 35600/39633  |  Loss: 0.5372  |  Score: 78.34 [%]  |  Seq Length: 256.0
[2024-09-22 21:33:21,139][root][INFO] - Step: 36800/39633  |  Loss: 0.5315  |  Score: 78.53 [%]  |  Seq Length: 256.0
[2024-09-22 21:36:39,579][root][INFO] - Step: 37200/39633  |  Loss: 0.5365  |  Score: 78.12 [%]  |  Seq Length: 256.0
[2024-09-22 21:36:46,873][root][INFO] - Step: 36000/39633  |  Loss: 0.5272  |  Score: 78.90 [%]  |  Seq Length: 256.0
[2024-09-22 21:40:01,230][root][INFO] - Step: 37600/39633  |  Loss: 0.5383  |  Score: 78.09 [%]  |  Seq Length: 256.0
[2024-09-22 21:40:34,816][root][INFO] - Step: 36400/39633  |  Loss: 0.5293  |  Score: 78.70 [%]  |  Seq Length: 256.0
[2024-09-22 21:43:19,569][root][INFO] - Step: 38000/39633  |  Loss: 0.5331  |  Score: 78.41 [%]  |  Seq Length: 256.0
[2024-09-22 21:44:23,391][root][INFO] - Step: 36800/39633  |  Loss: 0.5298  |  Score: 78.58 [%]  |  Seq Length: 256.0
[2024-09-22 21:46:42,657][root][INFO] - Step: 38400/39633  |  Loss: 0.5284  |  Score: 78.71 [%]  |  Seq Length: 256.0
[2024-09-22 21:48:08,432][root][INFO] - Step: 37200/39633  |  Loss: 0.5323  |  Score: 78.52 [%]  |  Seq Length: 256.0
[2024-09-22 21:50:04,563][root][INFO] - Step: 38800/39633  |  Loss: 0.5421  |  Score: 77.96 [%]  |  Seq Length: 256.0
[2024-09-22 21:51:54,898][root][INFO] - Step: 37600/39633  |  Loss: 0.5239  |  Score: 79.04 [%]  |  Seq Length: 256.0
[2024-09-22 21:53:28,489][root][INFO] - Step: 39200/39633  |  Loss: 0.5327  |  Score: 78.41 [%]  |  Seq Length: 256.0
[2024-09-22 21:55:38,775][root][INFO] - Step: 38000/39633  |  Loss: 0.5271  |  Score: 78.71 [%]  |  Seq Length: 256.0
[2024-09-22 21:56:51,723][root][INFO] - Step: 39600/39633  |  Loss: 0.5312  |  Score: 78.37 [%]  |  Seq Length: 256.0
[2024-09-22 21:57:08,566][root][INFO] - Step: 39633/39633  |  Loss: 0.5499  |  Score: 77.98 [%]  |  Seq Length: 256.0
[2024-09-22 21:57:16,496][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 21:57:16,496][root][INFO] - Score: 74.51 [%]  |  Evaluation Time: 7.93 [s]
[2024-09-22 21:57:31,235][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 21:57:31,235][root][INFO] - Score: 74.40 [%]  |  Evaluation Time: 14.74 [s]
[2024-09-22 21:57:31,237][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 21:57:31,237][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 21:57:31,237][root][INFO] - - Epoch: 3
[2024-09-22 21:57:31,237][root][INFO] - - DEV score: 74.51 [%]
[2024-09-22 21:57:31,237][root][INFO] - - TEST score: 74.40 [%]
[2024-09-22 21:57:31,238][root][INFO] - Fine-tuning is done!
[2024-09-22 21:59:27,543][root][INFO] - Step: 38400/39633  |  Loss: 0.5265  |  Score: 78.70 [%]  |  Seq Length: 256.0
[2024-09-22 22:03:19,198][root][INFO] - Step: 38800/39633  |  Loss: 0.5283  |  Score: 78.48 [%]  |  Seq Length: 256.0
[2024-09-22 22:07:08,080][root][INFO] - Step: 39200/39633  |  Loss: 0.5303  |  Score: 78.62 [%]  |  Seq Length: 256.0
[2024-09-22 22:10:51,123][root][INFO] - Step: 39600/39633  |  Loss: 0.5264  |  Score: 78.84 [%]  |  Seq Length: 256.0
[2024-09-22 22:11:10,111][root][INFO] - Step: 39633/39633  |  Loss: 0.5382  |  Score: 78.05 [%]  |  Seq Length: 256.0
[2024-09-22 22:11:18,965][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 22:11:18,965][root][INFO] - Score: 74.61 [%]  |  Evaluation Time: 8.85 [s]
[2024-09-22 22:11:35,306][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 22:11:35,306][root][INFO] - Score: 75.03 [%]  |  Evaluation Time: 16.34 [s]
[2024-09-22 22:11:35,307][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 22:11:35,307][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 22:11:35,307][root][INFO] - - Epoch: 3
[2024-09-22 22:11:35,307][root][INFO] - - DEV score: 74.61 [%]
[2024-09-22 22:11:35,307][root][INFO] - - TEST score: 75.03 [%]
[2024-09-22 22:11:35,308][root][INFO] - Fine-tuning is done!
[2024-09-22 22:46:08,006][root][INFO] - 

[2024-09-22 22:46:08,006][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 22:46:08,007][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-22 22:46:08,007][root][INFO] - 

[2024-09-22 22:46:08,007][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 22:46:12,387][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 22:46:16,638][root][INFO] - 

[2024-09-22 22:46:16,638][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-22 22:46:16,638][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 22:46:16,646][root][INFO] - vocab size              : 51200
[2024-09-22 22:46:16,646][root][INFO] - device                  : gpu
[2024-09-22 22:46:16,646][root][INFO] - random seed             : 42
[2024-09-22 22:46:16,646][root][INFO] - train data size         : 4416
[2024-09-22 22:46:16,646][root][INFO] - max epochs              : 15
[2024-09-22 22:46:16,646][root][INFO] - total steps             : 1035
[2024-09-22 22:46:16,646][root][INFO] - warmup steps            : 104
[2024-09-22 22:46:16,647][root][INFO] - batch size              : 64
[2024-09-22 22:46:16,647][root][INFO] - accumulation steps      : 1
[2024-09-22 22:46:16,647][root][INFO] - optimizer               : adamwscale
[2024-09-22 22:46:16,647][root][INFO] - lr_scheduler            : cosine
[2024-09-22 22:46:16,647][root][INFO] - learning rate           : 0.01
[2024-09-22 22:46:16,647][root][INFO] - max length              : 256

[2024-09-22 22:46:16,647][root][INFO] - 

[2024-09-22 22:46:16,647][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-22 22:46:16,647][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-22 22:46:16,647][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb
[2024-09-22 22:46:16,647][root][INFO] - * tb interval   : 15

[2024-09-22 22:46:16,647][root][INFO] - 

[2024-09-22 22:46:16,648][root][INFO] - Start the Training !
[2024-09-22 22:46:16,650][root][INFO] - 
[1/ 15 Epoch]
[2024-09-22 22:46:35,893][root][INFO] - 

[2024-09-22 22:46:35,893][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-22 22:46:35,893][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-22 22:46:35,894][root][INFO] - 

[2024-09-22 22:46:35,894][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-22 22:46:40,420][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-22 22:46:40,421][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-22 22:46:40,422][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-22 22:46:40,422][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-22 22:46:40,422][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-22 22:46:40,423][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-22 22:46:40,423][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-22 22:46:40,424][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-22 22:46:40,424][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-22 22:46:40,425][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-22 22:46:40,425][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-22 22:46:40,426][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-22 22:46:40,426][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-22 22:46:40,426][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-22 22:46:40,427][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-22 22:46:40,427][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-22 22:46:40,428][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-22 22:46:40,428][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-22 22:46:40,429][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-22 22:46:40,429][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-22 22:46:40,429][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-22 22:46:40,430][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-22 22:46:40,430][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-22 22:46:40,431][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-22 22:46:40,432][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-22 22:46:40,871][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-22 22:46:44,794][root][INFO] - 

[2024-09-22 22:46:44,794][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-22 22:46:44,794][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-22 22:46:44,803][root][INFO] - vocab size              : 51200
[2024-09-22 22:46:44,804][root][INFO] - device                  : gpu
[2024-09-22 22:46:44,804][root][INFO] - random seed             : 42
[2024-09-22 22:46:44,804][root][INFO] - train data size         : 4416
[2024-09-22 22:46:44,804][root][INFO] - max epochs              : 15
[2024-09-22 22:46:44,804][root][INFO] - total steps             : 1035
[2024-09-22 22:46:44,804][root][INFO] - warmup steps            : 104
[2024-09-22 22:46:44,804][root][INFO] - batch size              : 64
[2024-09-22 22:46:44,804][root][INFO] - accumulation steps      : 1
[2024-09-22 22:46:44,804][root][INFO] - optimizer               : adamwscale
[2024-09-22 22:46:44,805][root][INFO] - lr_scheduler            : cosine
[2024-09-22 22:46:44,805][root][INFO] - learning rate           : 0.01
[2024-09-22 22:46:44,805][root][INFO] - max length              : 256

[2024-09-22 22:46:44,805][root][INFO] - LoRA Configuration
[2024-09-22 22:46:44,805][root][INFO] - ㄴ r                    : 32
[2024-09-22 22:46:44,805][root][INFO] - ㄴ alpha                : 128
[2024-09-22 22:46:44,805][root][INFO] - ㄴ dropout              : 0.03

[2024-09-22 22:46:44,805][root][INFO] - 

[2024-09-22 22:46:44,805][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-22 22:46:44,805][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-22 22:46:44,805][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb
[2024-09-22 22:46:44,806][root][INFO] - * tb interval   : 15

[2024-09-22 22:46:44,806][root][INFO] - 

[2024-09-22 22:46:44,806][root][INFO] - Start the Training !
[2024-09-22 22:46:44,809][root][INFO] - 
[1/ 15 Epoch]
[2024-09-22 22:46:53,267][root][INFO] - Step: 15/1035  |  Loss: 3.3881  |  Score: 0.92 [%]  |  Seq Length: 256.0
[2024-09-22 22:46:58,785][root][INFO] - Step: 30/1035  |  Loss: 2.3165  |  Score: 18.38 [%]  |  Seq Length: 256.0
[2024-09-22 22:47:04,282][root][INFO] - Step: 45/1035  |  Loss: 2.0702  |  Score: 33.89 [%]  |  Seq Length: 256.0
[2024-09-22 22:47:09,803][root][INFO] - Step: 60/1035  |  Loss: 1.6511  |  Score: 53.22 [%]  |  Seq Length: 256.0
[2024-09-22 22:47:13,137][root][INFO] - Step: 69/1035  |  Loss: 1.4205  |  Score: 64.34 [%]  |  Seq Length: 256.0
[2024-09-22 22:47:16,277][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-22 22:47:16,277][root][INFO] - Score: 73.02 [%]  |  Evaluation Time: 3.14 [s]
[2024-09-22 22:47:19,234][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-22 22:47:19,235][root][INFO] - Score: 65.20 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-22 22:47:19,236][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-22 22:47:19,237][root][INFO] - 
[2/ 15 Epoch]
[2024-09-22 22:47:21,908][root][INFO] - Step: 75/1035  |  Loss: 1.3487  |  Score: 64.08 [%]  |  Seq Length: 256.0
[2024-09-22 22:47:27,427][root][INFO] - Step: 90/1035  |  Loss: 1.4792  |  Score: 62.77 [%]  |  Seq Length: 256.0
[2024-09-22 22:47:32,957][root][INFO] - Step: 105/1035  |  Loss: 1.3648  |  Score: 60.90 [%]  |  Seq Length: 256.0
[2024-09-22 22:47:38,499][root][INFO] - Step: 120/1035  |  Loss: 1.2505  |  Score: 68.07 [%]  |  Seq Length: 256.0
[2024-09-22 22:47:44,026][root][INFO] - Step: 135/1035  |  Loss: 1.2024  |  Score: 68.13 [%]  |  Seq Length: 256.0
[2024-09-22 22:47:45,179][root][INFO] - Step: 138/1035  |  Loss: 1.1858  |  Score: 73.19 [%]  |  Seq Length: 256.0
[2024-09-22 22:47:48,272][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-22 22:47:48,272][root][INFO] - Score: 74.14 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-22 22:47:51,315][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-22 22:47:51,315][root][INFO] - Score: 67.78 [%]  |  Evaluation Time: 3.04 [s]
[2024-09-22 22:47:51,317][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-22 22:47:51,318][root][INFO] - 
[3/ 15 Epoch]
[2024-09-22 22:47:56,071][root][INFO] - Step: 150/1035  |  Loss: 1.2068  |  Score: 66.87 [%]  |  Seq Length: 256.0
[2024-09-22 22:48:01,632][root][INFO] - Step: 165/1035  |  Loss: 1.0650  |  Score: 69.80 [%]  |  Seq Length: 256.0
[2024-09-22 22:48:07,199][root][INFO] - Step: 180/1035  |  Loss: 0.9787  |  Score: 71.08 [%]  |  Seq Length: 256.0
[2024-09-22 22:48:12,758][root][INFO] - Step: 195/1035  |  Loss: 1.1842  |  Score: 72.03 [%]  |  Seq Length: 256.0
[2024-09-22 22:48:17,219][root][INFO] - Step: 207/1035  |  Loss: 1.0907  |  Score: 72.14 [%]  |  Seq Length: 256.0
[2024-09-22 22:48:20,392][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-22 22:48:20,392][root][INFO] - Score: 77.63 [%]  |  Evaluation Time: 3.17 [s]
[2024-09-22 22:48:23,329][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-22 22:48:23,329][root][INFO] - Score: 70.10 [%]  |  Evaluation Time: 2.93 [s]
[2024-09-22 22:48:23,330][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-22 22:48:23,331][root][INFO] - 
[4/ 15 Epoch]
[2024-09-22 22:48:24,889][root][INFO] - Step: 210/1035  |  Loss: 1.0733  |  Score: 74.18 [%]  |  Seq Length: 256.0
[2024-09-22 22:48:30,400][root][INFO] - Step: 225/1035  |  Loss: 0.9538  |  Score: 75.82 [%]  |  Seq Length: 256.0
[2024-09-22 22:48:35,911][root][INFO] - Step: 240/1035  |  Loss: 0.8554  |  Score: 75.50 [%]  |  Seq Length: 256.0
[2024-09-22 22:48:41,431][root][INFO] - Step: 255/1035  |  Loss: 0.9215  |  Score: 76.65 [%]  |  Seq Length: 256.0
[2024-09-22 22:48:46,952][root][INFO] - Step: 270/1035  |  Loss: 0.9457  |  Score: 75.43 [%]  |  Seq Length: 256.0
[2024-09-22 22:48:49,219][root][INFO] - Step: 276/1035  |  Loss: 1.0580  |  Score: 68.92 [%]  |  Seq Length: 256.0
[2024-09-22 22:48:52,380][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-22 22:48:52,381][root][INFO] - Score: 77.79 [%]  |  Evaluation Time: 3.16 [s]
[2024-09-22 22:48:55,643][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-22 22:48:55,643][root][INFO] - Score: 70.62 [%]  |  Evaluation Time: 3.26 [s]
[2024-09-22 22:48:55,644][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-22 22:48:55,645][root][INFO] - 
[5/ 15 Epoch]
[2024-09-22 22:48:59,309][root][INFO] - Step: 285/1035  |  Loss: 0.8031  |  Score: 79.93 [%]  |  Seq Length: 256.0
[2024-09-22 22:49:04,833][root][INFO] - Step: 300/1035  |  Loss: 0.8312  |  Score: 78.14 [%]  |  Seq Length: 256.0
[2024-09-22 22:49:10,357][root][INFO] - Step: 315/1035  |  Loss: 0.7614  |  Score: 77.96 [%]  |  Seq Length: 256.0
[2024-09-22 22:49:15,879][root][INFO] - Step: 330/1035  |  Loss: 0.7443  |  Score: 79.61 [%]  |  Seq Length: 256.0
[2024-09-22 22:49:21,446][root][INFO] - Step: 345/1035  |  Loss: 0.8749  |  Score: 76.48 [%]  |  Seq Length: 256.0
[2024-09-22 22:49:24,668][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-22 22:49:24,668][root][INFO] - Score: 74.46 [%]  |  Evaluation Time: 3.22 [s]
[2024-09-22 22:49:27,737][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-22 22:49:27,738][root][INFO] - Score: 70.54 [%]  |  Evaluation Time: 3.07 [s]
[2024-09-22 22:49:27,740][root][INFO] - 
[6/ 15 Epoch]
[2024-09-22 22:49:28,471][root][INFO] - Step: 346/1035  |  Loss: 0.7237  |  Score: 82.22 [%]  |  Seq Length: 256.0
[2024-09-22 22:49:33,675][root][INFO] - Step: 360/1035  |  Loss: 0.7485  |  Score: 79.44 [%]  |  Seq Length: 256.0
[2024-09-22 22:49:39,261][root][INFO] - Step: 375/1035  |  Loss: 0.7012  |  Score: 82.63 [%]  |  Seq Length: 256.0
[2024-09-22 22:49:44,836][root][INFO] - Step: 390/1035  |  Loss: 0.7539  |  Score: 79.16 [%]  |  Seq Length: 256.0
[2024-09-22 22:49:50,367][root][INFO] - Step: 405/1035  |  Loss: 0.6871  |  Score: 80.66 [%]  |  Seq Length: 256.0
[2024-09-22 22:49:53,727][root][INFO] - Step: 414/1035  |  Loss: 0.7319  |  Score: 80.29 [%]  |  Seq Length: 256.0
[2024-09-22 22:49:56,824][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-22 22:49:56,824][root][INFO] - Score: 77.97 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-22 22:49:59,878][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-22 22:49:59,878][root][INFO] - Score: 72.64 [%]  |  Evaluation Time: 3.05 [s]
[2024-09-22 22:49:59,880][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-22 22:49:59,881][root][INFO] - 
[7/ 15 Epoch]
[2024-09-22 22:50:02,387][root][INFO] - Step: 420/1035  |  Loss: 0.6564  |  Score: 81.01 [%]  |  Seq Length: 256.0
[2024-09-22 22:50:07,921][root][INFO] - Step: 435/1035  |  Loss: 0.5719  |  Score: 85.82 [%]  |  Seq Length: 256.0
[2024-09-22 22:50:13,450][root][INFO] - Step: 450/1035  |  Loss: 0.6278  |  Score: 82.72 [%]  |  Seq Length: 256.0
[2024-09-22 22:50:18,974][root][INFO] - Step: 465/1035  |  Loss: 0.6191  |  Score: 82.97 [%]  |  Seq Length: 256.0
[2024-09-22 22:50:24,497][root][INFO] - Step: 480/1035  |  Loss: 0.6866  |  Score: 81.67 [%]  |  Seq Length: 256.0
[2024-09-22 22:50:25,649][root][INFO] - Step: 483/1035  |  Loss: 0.6383  |  Score: 82.09 [%]  |  Seq Length: 256.0
[2024-09-22 22:50:28,866][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-22 22:50:28,867][root][INFO] - Score: 77.80 [%]  |  Evaluation Time: 3.21 [s]
[2024-09-22 22:50:32,030][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-22 22:50:32,030][root][INFO] - Score: 71.58 [%]  |  Evaluation Time: 3.16 [s]
[2024-09-22 22:50:32,032][root][INFO] - 
[8/ 15 Epoch]
[2024-09-22 22:50:36,742][root][INFO] - Step: 495/1035  |  Loss: 0.5490  |  Score: 84.10 [%]  |  Seq Length: 256.0
[2024-09-22 22:50:42,266][root][INFO] - Step: 510/1035  |  Loss: 0.5319  |  Score: 85.85 [%]  |  Seq Length: 256.0
[2024-09-22 22:50:47,789][root][INFO] - Step: 525/1035  |  Loss: 0.6062  |  Score: 84.35 [%]  |  Seq Length: 256.0
[2024-09-22 22:50:53,308][root][INFO] - Step: 540/1035  |  Loss: 0.5132  |  Score: 85.79 [%]  |  Seq Length: 256.0
[2024-09-22 22:50:57,769][root][INFO] - Step: 552/1035  |  Loss: 0.5103  |  Score: 84.42 [%]  |  Seq Length: 256.0
[2024-09-22 22:51:00,852][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-22 22:51:00,852][root][INFO] - Score: 78.21 [%]  |  Evaluation Time: 3.08 [s]
[2024-09-22 22:51:03,914][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-22 22:51:03,914][root][INFO] - Score: 72.03 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-22 22:51:03,917][root][INFO] - 
[9/ 15 Epoch]
[2024-09-22 22:51:05,407][root][INFO] - Step: 555/1035  |  Loss: 0.5939  |  Score: 84.14 [%]  |  Seq Length: 256.0
[2024-09-22 22:51:10,931][root][INFO] - Step: 570/1035  |  Loss: 0.5033  |  Score: 86.89 [%]  |  Seq Length: 256.0
[2024-09-22 22:51:16,455][root][INFO] - Step: 585/1035  |  Loss: 0.5322  |  Score: 86.52 [%]  |  Seq Length: 256.0
[2024-09-22 22:51:21,980][root][INFO] - Step: 600/1035  |  Loss: 0.5015  |  Score: 86.66 [%]  |  Seq Length: 256.0
[2024-09-22 22:51:27,501][root][INFO] - Step: 615/1035  |  Loss: 0.4757  |  Score: 86.40 [%]  |  Seq Length: 256.0
[2024-09-22 22:51:29,757][root][INFO] - Step: 621/1035  |  Loss: 0.4920  |  Score: 85.61 [%]  |  Seq Length: 256.0
[2024-09-22 22:51:32,852][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-22 22:51:32,852][root][INFO] - Score: 77.05 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-22 22:51:35,810][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-22 22:51:35,810][root][INFO] - Score: 71.47 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-22 22:51:35,812][root][INFO] - 
[10/ 15 Epoch]
[2024-09-22 22:51:39,534][root][INFO] - Step: 630/1035  |  Loss: 0.4708  |  Score: 88.01 [%]  |  Seq Length: 256.0
[2024-09-22 22:51:45,067][root][INFO] - Step: 645/1035  |  Loss: 0.4341  |  Score: 88.53 [%]  |  Seq Length: 256.0
[2024-09-22 22:51:50,590][root][INFO] - Step: 660/1035  |  Loss: 0.4126  |  Score: 87.92 [%]  |  Seq Length: 256.0
[2024-09-22 22:51:56,107][root][INFO] - Step: 675/1035  |  Loss: 0.4452  |  Score: 87.00 [%]  |  Seq Length: 256.0
[2024-09-22 22:52:01,671][root][INFO] - Step: 690/1035  |  Loss: 0.4415  |  Score: 87.96 [%]  |  Seq Length: 256.0
[2024-09-22 22:52:04,769][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-22 22:52:04,770][root][INFO] - Score: 77.82 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-22 22:52:07,730][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-22 22:52:07,731][root][INFO] - Score: 72.47 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-22 22:52:07,733][root][INFO] - 
[11/ 15 Epoch]
[2024-09-22 22:52:08,538][root][INFO] - Step: 691/1035  |  Loss: 0.4966  |  Score: 86.36 [%]  |  Seq Length: 256.0
[2024-09-22 22:52:13,689][root][INFO] - Step: 705/1035  |  Loss: 0.4137  |  Score: 88.48 [%]  |  Seq Length: 256.0
[2024-09-22 22:52:19,210][root][INFO] - Step: 720/1035  |  Loss: 0.4251  |  Score: 87.06 [%]  |  Seq Length: 256.0
[2024-09-22 22:52:24,734][root][INFO] - Step: 735/1035  |  Loss: 0.4029  |  Score: 88.93 [%]  |  Seq Length: 256.0
[2024-09-22 22:52:30,274][root][INFO] - Step: 750/1035  |  Loss: 0.4198  |  Score: 88.41 [%]  |  Seq Length: 256.0
[2024-09-22 22:52:33,653][root][INFO] - Step: 759/1035  |  Loss: 0.4147  |  Score: 89.79 [%]  |  Seq Length: 256.0
[2024-09-22 22:52:36,751][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-22 22:52:36,752][root][INFO] - Score: 78.02 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-22 22:52:39,809][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-22 22:52:39,810][root][INFO] - Score: 71.83 [%]  |  Evaluation Time: 3.05 [s]
[2024-09-22 22:52:39,813][root][INFO] - 
[12/ 15 Epoch]
[2024-09-22 22:52:42,397][root][INFO] - Step: 765/1035  |  Loss: 0.3492  |  Score: 88.73 [%]  |  Seq Length: 256.0
[2024-09-22 22:52:47,917][root][INFO] - Step: 780/1035  |  Loss: 0.3795  |  Score: 89.31 [%]  |  Seq Length: 256.0
[2024-09-22 22:52:53,451][root][INFO] - Step: 795/1035  |  Loss: 0.3844  |  Score: 89.73 [%]  |  Seq Length: 256.0
[2024-09-22 22:52:58,968][root][INFO] - Step: 810/1035  |  Loss: 0.3584  |  Score: 90.26 [%]  |  Seq Length: 256.0
[2024-09-22 22:53:04,489][root][INFO] - Step: 825/1035  |  Loss: 0.4050  |  Score: 88.11 [%]  |  Seq Length: 256.0
[2024-09-22 22:53:05,656][root][INFO] - Step: 828/1035  |  Loss: 0.3388  |  Score: 90.68 [%]  |  Seq Length: 256.0
[2024-09-22 22:53:08,768][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-22 22:53:08,769][root][INFO] - Score: 78.31 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-22 22:53:11,794][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-22 22:53:11,795][root][INFO] - Score: 72.03 [%]  |  Evaluation Time: 3.02 [s]
[2024-09-22 22:53:11,797][root][INFO] - 
[13/ 15 Epoch]
[2024-09-22 22:53:16,525][root][INFO] - Step: 840/1035  |  Loss: 0.3353  |  Score: 90.41 [%]  |  Seq Length: 256.0
[2024-09-22 22:53:22,047][root][INFO] - Step: 855/1035  |  Loss: 0.3523  |  Score: 90.01 [%]  |  Seq Length: 256.0
[2024-09-22 22:53:27,567][root][INFO] - Step: 870/1035  |  Loss: 0.3577  |  Score: 90.13 [%]  |  Seq Length: 256.0
[2024-09-22 22:53:33,083][root][INFO] - Step: 885/1035  |  Loss: 0.3347  |  Score: 90.60 [%]  |  Seq Length: 256.0
[2024-09-22 22:53:37,544][root][INFO] - Step: 897/1035  |  Loss: 0.3900  |  Score: 88.94 [%]  |  Seq Length: 256.0
[2024-09-22 22:53:40,612][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-22 22:53:40,612][root][INFO] - Score: 77.66 [%]  |  Evaluation Time: 3.07 [s]
[2024-09-22 22:53:43,674][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-22 22:53:43,675][root][INFO] - Score: 71.02 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-22 22:53:43,677][root][INFO] - 
[14/ 15 Epoch]
[2024-09-22 22:53:45,121][root][INFO] - Step: 900/1035  |  Loss: 0.3828  |  Score: 87.38 [%]  |  Seq Length: 256.0
[2024-09-22 22:53:50,648][root][INFO] - Step: 915/1035  |  Loss: 0.3964  |  Score: 89.03 [%]  |  Seq Length: 256.0
[2024-09-22 22:53:56,180][root][INFO] - Step: 930/1035  |  Loss: 0.3293  |  Score: 90.71 [%]  |  Seq Length: 256.0
[2024-09-22 22:54:01,704][root][INFO] - Step: 945/1035  |  Loss: 0.3427  |  Score: 90.51 [%]  |  Seq Length: 256.0
[2024-09-22 22:54:07,228][root][INFO] - Step: 960/1035  |  Loss: 0.3117  |  Score: 90.83 [%]  |  Seq Length: 256.0
[2024-09-22 22:54:09,492][root][INFO] - Step: 966/1035  |  Loss: 0.3724  |  Score: 89.52 [%]  |  Seq Length: 256.0
[2024-09-22 22:54:12,681][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-22 22:54:12,682][root][INFO] - Score: 77.26 [%]  |  Evaluation Time: 3.19 [s]
[2024-09-22 22:54:15,747][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-22 22:54:15,748][root][INFO] - Score: 71.62 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-22 22:54:15,750][root][INFO] - 
[15/ 15 Epoch]
[2024-09-22 22:54:19,376][root][INFO] - Step: 975/1035  |  Loss: 0.3609  |  Score: 89.42 [%]  |  Seq Length: 256.0
[2024-09-22 22:54:24,900][root][INFO] - Step: 990/1035  |  Loss: 0.3308  |  Score: 91.49 [%]  |  Seq Length: 256.0
[2024-09-22 22:54:30,420][root][INFO] - Step: 1005/1035  |  Loss: 0.3568  |  Score: 89.84 [%]  |  Seq Length: 256.0
[2024-09-22 22:54:35,955][root][INFO] - Step: 1020/1035  |  Loss: 0.3325  |  Score: 89.93 [%]  |  Seq Length: 256.0
[2024-09-22 22:54:41,525][root][INFO] - Step: 1035/1035  |  Loss: 0.3641  |  Score: 88.96 [%]  |  Seq Length: 256.0
[2024-09-22 22:54:44,639][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-22 22:54:44,639][root][INFO] - Score: 78.10 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-22 22:54:47,769][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-22 22:54:47,769][root][INFO] - Score: 71.31 [%]  |  Evaluation Time: 3.13 [s]
[2024-09-22 22:54:47,770][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-22 22:54:47,770][root][INFO] - - Epoch: 6
[2024-09-22 22:54:47,770][root][INFO] - - DEV score: 77.97 [%]
[2024-09-22 22:54:47,771][root][INFO] - - TEST score: 72.64 [%]
[2024-09-22 22:54:47,772][root][INFO] - Fine-tuning is done!
[2024-09-25 20:10:10,748][root][INFO] - 

[2024-09-25 20:10:10,748][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-25 20:10:10,748][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs
[2024-09-25 20:10:10,748][root][INFO] - 

[2024-09-25 20:10:10,748][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.0001, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-25 20:10:15,405][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-25 20:10:17,234][root][INFO] - 

[2024-09-25 20:10:17,234][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-25 20:10:17,234][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-25 20:10:17,243][root][INFO] - vocab size              : 51200
[2024-09-25 20:10:17,243][root][INFO] - device                  : gpu
[2024-09-25 20:10:17,244][root][INFO] - random seed             : 42
[2024-09-25 20:10:17,244][root][INFO] - train data size         : 4416
[2024-09-25 20:10:17,244][root][INFO] - max epochs              : 15
[2024-09-25 20:10:17,244][root][INFO] - total steps             : 1035
[2024-09-25 20:10:17,244][root][INFO] - warmup steps            : 104
[2024-09-25 20:10:17,244][root][INFO] - batch size              : 64
[2024-09-25 20:10:17,244][root][INFO] - accumulation steps      : 1
[2024-09-25 20:10:17,244][root][INFO] - optimizer               : adamwscale
[2024-09-25 20:10:17,244][root][INFO] - lr_scheduler            : cosine
[2024-09-25 20:10:17,244][root][INFO] - learning rate           : 0.0001
[2024-09-25 20:10:17,244][root][INFO] - max length              : 256

[2024-09-25 20:10:17,245][root][INFO] - 

[2024-09-25 20:10:17,245][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs
[2024-09-25 20:10:17,245][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs/ckpt
[2024-09-25 20:10:17,245][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.0001lr_42rs/tb
[2024-09-25 20:10:17,245][root][INFO] - * tb interval   : 15

[2024-09-25 20:10:17,245][root][INFO] - 

[2024-09-25 20:10:17,245][root][INFO] - Start the Training !
[2024-09-25 20:10:17,247][root][INFO] - 
[1/ 15 Epoch]
[2024-09-25 20:10:25,205][root][INFO] - Step: 15/1035  |  Loss: 3.8143  |  Score: 6.57 [%]  |  Seq Length: 256.0
[2024-09-25 20:10:31,750][root][INFO] - Step: 30/1035  |  Loss: 2.6538  |  Score: 12.41 [%]  |  Seq Length: 256.0
[2024-09-25 20:10:38,323][root][INFO] - Step: 45/1035  |  Loss: 2.2784  |  Score: 21.98 [%]  |  Seq Length: 256.0
[2024-09-25 20:10:44,905][root][INFO] - Step: 60/1035  |  Loss: 2.2505  |  Score: 24.52 [%]  |  Seq Length: 256.0
[2024-09-25 20:10:48,877][root][INFO] - Step: 69/1035  |  Loss: 2.0590  |  Score: 33.89 [%]  |  Seq Length: 256.0
[2024-09-25 20:10:51,937][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-25 20:10:51,937][root][INFO] - Score: 36.33 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-25 20:10:54,878][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-25 20:10:54,878][root][INFO] - Score: 38.49 [%]  |  Evaluation Time: 2.94 [s]
[2024-09-25 20:10:54,880][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-25 20:10:54,881][root][INFO] - 
[2/ 15 Epoch]
[2024-09-25 20:10:57,900][root][INFO] - Step: 75/1035  |  Loss: 1.7878  |  Score: 43.37 [%]  |  Seq Length: 256.0
[2024-09-25 20:11:04,653][root][INFO] - Step: 90/1035  |  Loss: 1.6794  |  Score: 53.68 [%]  |  Seq Length: 256.0
[2024-09-25 20:11:11,396][root][INFO] - Step: 105/1035  |  Loss: 1.5230  |  Score: 59.53 [%]  |  Seq Length: 256.0
[2024-09-25 20:11:18,037][root][INFO] - Step: 120/1035  |  Loss: 1.4308  |  Score: 59.96 [%]  |  Seq Length: 256.0
[2024-09-25 20:11:24,683][root][INFO] - Step: 135/1035  |  Loss: 1.4268  |  Score: 56.71 [%]  |  Seq Length: 256.0
[2024-09-25 20:11:26,079][root][INFO] - Step: 138/1035  |  Loss: 1.4092  |  Score: 66.52 [%]  |  Seq Length: 256.0
[2024-09-25 20:11:29,211][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-25 20:11:29,211][root][INFO] - Score: 71.37 [%]  |  Evaluation Time: 3.13 [s]
[2024-09-25 20:11:32,186][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-25 20:11:32,187][root][INFO] - Score: 64.82 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-25 20:11:32,188][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-25 20:11:32,189][root][INFO] - 
[3/ 15 Epoch]
[2024-09-25 20:11:37,851][root][INFO] - Step: 150/1035  |  Loss: 1.1005  |  Score: 68.35 [%]  |  Seq Length: 256.0
[2024-09-25 20:11:44,491][root][INFO] - Step: 165/1035  |  Loss: 1.2221  |  Score: 68.53 [%]  |  Seq Length: 256.0
[2024-09-25 20:11:51,129][root][INFO] - Step: 180/1035  |  Loss: 1.2678  |  Score: 65.17 [%]  |  Seq Length: 256.0
[2024-09-25 20:11:57,772][root][INFO] - Step: 195/1035  |  Loss: 1.0749  |  Score: 72.28 [%]  |  Seq Length: 256.0
[2024-09-25 20:12:03,130][root][INFO] - Step: 207/1035  |  Loss: 1.1674  |  Score: 67.53 [%]  |  Seq Length: 256.0
[2024-09-25 20:12:06,293][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-25 20:12:06,293][root][INFO] - Score: 74.51 [%]  |  Evaluation Time: 3.16 [s]
[2024-09-25 20:12:09,274][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-25 20:12:09,274][root][INFO] - Score: 67.82 [%]  |  Evaluation Time: 2.98 [s]
[2024-09-25 20:12:09,275][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-25 20:12:09,276][root][INFO] - 
[4/ 15 Epoch]
[2024-09-25 20:12:10,953][root][INFO] - Step: 210/1035  |  Loss: 1.0103  |  Score: 77.99 [%]  |  Seq Length: 256.0
[2024-09-25 20:12:17,597][root][INFO] - Step: 225/1035  |  Loss: 1.0267  |  Score: 73.04 [%]  |  Seq Length: 256.0
[2024-09-25 20:12:24,237][root][INFO] - Step: 240/1035  |  Loss: 1.0343  |  Score: 70.06 [%]  |  Seq Length: 256.0
[2024-09-25 20:12:30,878][root][INFO] - Step: 255/1035  |  Loss: 0.9259  |  Score: 73.09 [%]  |  Seq Length: 256.0
[2024-09-25 20:12:37,510][root][INFO] - Step: 270/1035  |  Loss: 0.9114  |  Score: 75.12 [%]  |  Seq Length: 256.0
[2024-09-25 20:12:40,211][root][INFO] - Step: 276/1035  |  Loss: 0.9190  |  Score: 79.46 [%]  |  Seq Length: 256.0
[2024-09-25 20:12:43,420][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-25 20:12:43,421][root][INFO] - Score: 75.25 [%]  |  Evaluation Time: 3.21 [s]
[2024-09-25 20:12:46,432][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-25 20:12:46,432][root][INFO] - Score: 69.27 [%]  |  Evaluation Time: 3.01 [s]
[2024-09-25 20:12:46,433][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-25 20:12:46,434][root][INFO] - 
[5/ 15 Epoch]
[2024-09-25 20:12:50,726][root][INFO] - Step: 285/1035  |  Loss: 0.8415  |  Score: 80.05 [%]  |  Seq Length: 256.0
[2024-09-25 20:12:57,363][root][INFO] - Step: 300/1035  |  Loss: 0.8839  |  Score: 75.19 [%]  |  Seq Length: 256.0
[2024-09-25 20:13:04,021][root][INFO] - Step: 315/1035  |  Loss: 0.8509  |  Score: 76.55 [%]  |  Seq Length: 256.0
[2024-09-25 20:13:10,665][root][INFO] - Step: 330/1035  |  Loss: 0.8143  |  Score: 78.70 [%]  |  Seq Length: 256.0
[2024-09-25 20:13:17,350][root][INFO] - Step: 345/1035  |  Loss: 0.8637  |  Score: 74.66 [%]  |  Seq Length: 256.0
[2024-09-25 20:13:20,487][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-25 20:13:20,487][root][INFO] - Score: 76.12 [%]  |  Evaluation Time: 3.13 [s]
[2024-09-25 20:13:23,513][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-25 20:13:23,513][root][INFO] - Score: 68.25 [%]  |  Evaluation Time: 3.02 [s]
[2024-09-25 20:13:23,515][root][INFO] - 
[6/ 15 Epoch]
[2024-09-25 20:13:24,276][root][INFO] - Step: 346/1035  |  Loss: 0.7462  |  Score: 73.86 [%]  |  Seq Length: 256.0
[2024-09-25 20:13:30,473][root][INFO] - Step: 360/1035  |  Loss: 0.7617  |  Score: 80.02 [%]  |  Seq Length: 256.0
[2024-09-25 20:13:37,115][root][INFO] - Step: 375/1035  |  Loss: 0.7211  |  Score: 79.47 [%]  |  Seq Length: 256.0
[2024-09-25 20:13:43,753][root][INFO] - Step: 390/1035  |  Loss: 0.7668  |  Score: 78.96 [%]  |  Seq Length: 256.0
[2024-09-25 20:13:50,394][root][INFO] - Step: 405/1035  |  Loss: 0.7667  |  Score: 79.12 [%]  |  Seq Length: 256.0
[2024-09-25 20:13:54,425][root][INFO] - Step: 414/1035  |  Loss: 0.7389  |  Score: 77.81 [%]  |  Seq Length: 256.0
[2024-09-25 20:13:57,582][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-25 20:13:57,583][root][INFO] - Score: 76.38 [%]  |  Evaluation Time: 3.16 [s]
[2024-09-25 20:14:00,554][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-25 20:14:00,555][root][INFO] - Score: 69.59 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-25 20:14:00,556][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-25 20:14:00,557][root][INFO] - 
[7/ 15 Epoch]
[2024-09-25 20:14:03,610][root][INFO] - Step: 420/1035  |  Loss: 0.7207  |  Score: 80.19 [%]  |  Seq Length: 256.0
[2024-09-25 20:14:10,269][root][INFO] - Step: 435/1035  |  Loss: 0.7045  |  Score: 80.49 [%]  |  Seq Length: 256.0
[2024-09-25 20:14:16,958][root][INFO] - Step: 450/1035  |  Loss: 0.6882  |  Score: 80.92 [%]  |  Seq Length: 256.0
[2024-09-25 20:14:23,603][root][INFO] - Step: 465/1035  |  Loss: 0.6271  |  Score: 82.42 [%]  |  Seq Length: 256.0
[2024-09-25 20:14:30,248][root][INFO] - Step: 480/1035  |  Loss: 0.6760  |  Score: 80.69 [%]  |  Seq Length: 256.0
[2024-09-25 20:14:31,634][root][INFO] - Step: 483/1035  |  Loss: 0.6893  |  Score: 82.95 [%]  |  Seq Length: 256.0
[2024-09-25 20:14:34,744][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-25 20:14:34,744][root][INFO] - Score: 76.28 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-25 20:14:37,720][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-25 20:14:37,721][root][INFO] - Score: 70.63 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-25 20:14:37,722][root][INFO] - 
Save new Best Score (Epoch: 7)
[2024-09-25 20:14:37,724][root][INFO] - 
[8/ 15 Epoch]
[2024-09-25 20:14:43,347][root][INFO] - Step: 495/1035  |  Loss: 0.6492  |  Score: 83.33 [%]  |  Seq Length: 256.0
[2024-09-25 20:14:50,022][root][INFO] - Step: 510/1035  |  Loss: 0.6083  |  Score: 83.50 [%]  |  Seq Length: 256.0
[2024-09-25 20:14:56,660][root][INFO] - Step: 525/1035  |  Loss: 0.6877  |  Score: 82.08 [%]  |  Seq Length: 256.0
[2024-09-25 20:15:03,309][root][INFO] - Step: 540/1035  |  Loss: 0.5530  |  Score: 83.80 [%]  |  Seq Length: 256.0
[2024-09-25 20:15:08,669][root][INFO] - Step: 552/1035  |  Loss: 0.5821  |  Score: 84.73 [%]  |  Seq Length: 256.0
[2024-09-25 20:15:11,742][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-25 20:15:11,742][root][INFO] - Score: 76.74 [%]  |  Evaluation Time: 3.07 [s]
[2024-09-25 20:15:14,721][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-25 20:15:14,721][root][INFO] - Score: 70.58 [%]  |  Evaluation Time: 2.98 [s]
[2024-09-25 20:15:14,722][root][INFO] - 
Save new Best Score (Epoch: 8)
[2024-09-25 20:15:14,723][root][INFO] - 
[9/ 15 Epoch]
[2024-09-25 20:15:16,338][root][INFO] - Step: 555/1035  |  Loss: 0.6641  |  Score: 84.31 [%]  |  Seq Length: 256.0
[2024-09-25 20:15:22,979][root][INFO] - Step: 570/1035  |  Loss: 0.5409  |  Score: 85.73 [%]  |  Seq Length: 256.0
[2024-09-25 20:15:29,629][root][INFO] - Step: 585/1035  |  Loss: 0.5563  |  Score: 84.05 [%]  |  Seq Length: 256.0
[2024-09-25 20:15:36,271][root][INFO] - Step: 600/1035  |  Loss: 0.6130  |  Score: 82.50 [%]  |  Seq Length: 256.0
[2024-09-25 20:15:42,911][root][INFO] - Step: 615/1035  |  Loss: 0.6072  |  Score: 82.49 [%]  |  Seq Length: 256.0
[2024-09-25 20:15:45,607][root][INFO] - Step: 621/1035  |  Loss: 0.6412  |  Score: 82.42 [%]  |  Seq Length: 256.0
[2024-09-25 20:15:48,717][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-25 20:15:48,718][root][INFO] - Score: 77.24 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-25 20:15:51,731][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-25 20:15:51,731][root][INFO] - Score: 70.02 [%]  |  Evaluation Time: 3.01 [s]
[2024-09-25 20:15:51,734][root][INFO] - 
[10/ 15 Epoch]
[2024-09-25 20:15:56,102][root][INFO] - Step: 630/1035  |  Loss: 0.5463  |  Score: 84.95 [%]  |  Seq Length: 256.0
[2024-09-25 20:16:02,761][root][INFO] - Step: 645/1035  |  Loss: 0.5209  |  Score: 84.41 [%]  |  Seq Length: 256.0
[2024-09-25 20:16:09,402][root][INFO] - Step: 660/1035  |  Loss: 0.5318  |  Score: 84.75 [%]  |  Seq Length: 256.0
[2024-09-25 20:16:16,059][root][INFO] - Step: 675/1035  |  Loss: 0.5015  |  Score: 87.32 [%]  |  Seq Length: 256.0
[2024-09-25 20:16:22,734][root][INFO] - Step: 690/1035  |  Loss: 0.5613  |  Score: 83.91 [%]  |  Seq Length: 256.0
[2024-09-25 20:16:25,827][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-25 20:16:25,828][root][INFO] - Score: 76.16 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-25 20:16:28,805][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-25 20:16:28,805][root][INFO] - Score: 70.79 [%]  |  Evaluation Time: 2.98 [s]
[2024-09-25 20:16:28,808][root][INFO] - 
[11/ 15 Epoch]
[2024-09-25 20:16:29,534][root][INFO] - Step: 691/1035  |  Loss: 0.7158  |  Score: 79.19 [%]  |  Seq Length: 256.0
[2024-09-25 20:16:35,720][root][INFO] - Step: 705/1035  |  Loss: 0.5126  |  Score: 86.03 [%]  |  Seq Length: 256.0
[2024-09-25 20:16:42,371][root][INFO] - Step: 720/1035  |  Loss: 0.5080  |  Score: 85.23 [%]  |  Seq Length: 256.0
[2024-09-25 20:16:49,033][root][INFO] - Step: 735/1035  |  Loss: 0.5225  |  Score: 85.36 [%]  |  Seq Length: 256.0
[2024-09-25 20:16:55,673][root][INFO] - Step: 750/1035  |  Loss: 0.4950  |  Score: 85.57 [%]  |  Seq Length: 256.0
[2024-09-25 20:16:59,689][root][INFO] - Step: 759/1035  |  Loss: 0.4440  |  Score: 87.10 [%]  |  Seq Length: 256.0
[2024-09-25 20:17:02,804][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-25 20:17:02,805][root][INFO] - Score: 76.23 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-25 20:17:05,791][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-25 20:17:05,792][root][INFO] - Score: 70.93 [%]  |  Evaluation Time: 2.98 [s]
[2024-09-25 20:17:05,794][root][INFO] - 
[12/ 15 Epoch]
[2024-09-25 20:17:08,784][root][INFO] - Step: 765/1035  |  Loss: 0.4444  |  Score: 87.66 [%]  |  Seq Length: 256.0
[2024-09-25 20:17:15,426][root][INFO] - Step: 780/1035  |  Loss: 0.5246  |  Score: 85.74 [%]  |  Seq Length: 256.0
[2024-09-25 20:17:22,065][root][INFO] - Step: 795/1035  |  Loss: 0.5291  |  Score: 86.89 [%]  |  Seq Length: 256.0
[2024-09-25 20:17:28,716][root][INFO] - Step: 810/1035  |  Loss: 0.5230  |  Score: 84.09 [%]  |  Seq Length: 256.0
[2024-09-25 20:17:35,365][root][INFO] - Step: 825/1035  |  Loss: 0.4801  |  Score: 86.70 [%]  |  Seq Length: 256.0
[2024-09-25 20:17:36,742][root][INFO] - Step: 828/1035  |  Loss: 0.5014  |  Score: 87.20 [%]  |  Seq Length: 256.0
[2024-09-25 20:17:39,840][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-25 20:17:39,840][root][INFO] - Score: 76.35 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-25 20:17:42,809][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-25 20:17:42,810][root][INFO] - Score: 72.65 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-25 20:17:42,811][root][INFO] - 
Save new Best Score (Epoch: 12)
[2024-09-25 20:17:42,812][root][INFO] - 
[13/ 15 Epoch]
[2024-09-25 20:17:48,572][root][INFO] - Step: 840/1035  |  Loss: 0.4407  |  Score: 87.55 [%]  |  Seq Length: 256.0
[2024-09-25 20:17:55,379][root][INFO] - Step: 855/1035  |  Loss: 0.4874  |  Score: 86.51 [%]  |  Seq Length: 256.0
[2024-09-25 20:18:02,104][root][INFO] - Step: 870/1035  |  Loss: 0.4658  |  Score: 86.42 [%]  |  Seq Length: 256.0
[2024-09-25 20:18:08,751][root][INFO] - Step: 885/1035  |  Loss: 0.4758  |  Score: 87.55 [%]  |  Seq Length: 256.0
[2024-09-25 20:18:14,114][root][INFO] - Step: 897/1035  |  Loss: 0.5108  |  Score: 84.81 [%]  |  Seq Length: 256.0
[2024-09-25 20:18:17,219][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-25 20:18:17,219][root][INFO] - Score: 77.15 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-25 20:18:20,213][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-25 20:18:20,213][root][INFO] - Score: 71.48 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-25 20:18:20,215][root][INFO] - 
[14/ 15 Epoch]
[2024-09-25 20:18:21,863][root][INFO] - Step: 900/1035  |  Loss: 0.5248  |  Score: 86.56 [%]  |  Seq Length: 256.0
[2024-09-25 20:18:28,513][root][INFO] - Step: 915/1035  |  Loss: 0.4802  |  Score: 86.96 [%]  |  Seq Length: 256.0
[2024-09-25 20:18:35,168][root][INFO] - Step: 930/1035  |  Loss: 0.4581  |  Score: 85.86 [%]  |  Seq Length: 256.0
[2024-09-25 20:18:41,815][root][INFO] - Step: 945/1035  |  Loss: 0.4580  |  Score: 87.11 [%]  |  Seq Length: 256.0
[2024-09-25 20:18:48,447][root][INFO] - Step: 960/1035  |  Loss: 0.4721  |  Score: 86.85 [%]  |  Seq Length: 256.0
[2024-09-25 20:18:51,153][root][INFO] - Step: 966/1035  |  Loss: 0.4748  |  Score: 86.52 [%]  |  Seq Length: 256.0
[2024-09-25 20:18:54,275][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-25 20:18:54,276][root][INFO] - Score: 77.11 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-25 20:18:57,286][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-25 20:18:57,287][root][INFO] - Score: 71.34 [%]  |  Evaluation Time: 3.01 [s]
[2024-09-25 20:18:57,289][root][INFO] - 
[15/ 15 Epoch]
[2024-09-25 20:19:01,599][root][INFO] - Step: 975/1035  |  Loss: 0.3817  |  Score: 90.33 [%]  |  Seq Length: 256.0
[2024-09-25 20:19:08,267][root][INFO] - Step: 990/1035  |  Loss: 0.4833  |  Score: 86.94 [%]  |  Seq Length: 256.0
[2024-09-25 20:19:14,938][root][INFO] - Step: 1005/1035  |  Loss: 0.4339  |  Score: 87.52 [%]  |  Seq Length: 256.0
[2024-09-25 20:19:21,579][root][INFO] - Step: 1020/1035  |  Loss: 0.4956  |  Score: 86.21 [%]  |  Seq Length: 256.0
[2024-09-25 20:19:28,269][root][INFO] - Step: 1035/1035  |  Loss: 0.4675  |  Score: 86.12 [%]  |  Seq Length: 256.0
[2024-09-25 20:19:31,441][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-25 20:19:31,441][root][INFO] - Score: 76.71 [%]  |  Evaluation Time: 3.17 [s]
[2024-09-25 20:19:34,500][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-25 20:19:34,500][root][INFO] - Score: 71.66 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-25 20:19:34,502][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-25 20:19:34,502][root][INFO] - - Epoch: 12
[2024-09-25 20:19:34,502][root][INFO] - - DEV score: 76.35 [%]
[2024-09-25 20:19:34,502][root][INFO] - - TEST score: 72.65 [%]
[2024-09-25 20:19:34,503][root][INFO] - Fine-tuning is done!
[2024-09-25 20:21:09,274][root][INFO] - 

[2024-09-25 20:21:09,274][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-25 20:21:09,275][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-25 20:21:09,275][root][INFO] - 

[2024-09-25 20:21:09,275][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-25 20:21:13,904][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-25 20:21:13,904][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-25 20:21:13,905][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-25 20:21:13,905][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-25 20:21:13,906][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-25 20:21:13,906][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-25 20:21:13,907][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-25 20:21:13,907][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-25 20:21:13,908][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-25 20:21:13,908][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-25 20:21:13,909][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-25 20:21:13,909][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-25 20:21:13,910][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-25 20:21:13,910][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-25 20:21:13,911][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-25 20:21:13,911][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-25 20:21:13,912][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-25 20:21:13,913][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-25 20:21:13,913][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-25 20:21:13,914][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-25 20:21:13,914][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-25 20:21:13,915][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-25 20:21:13,916][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-25 20:21:13,916][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-25 20:21:13,918][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-25 20:21:14,095][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-25 20:21:16,011][root][INFO] - 

[2024-09-25 20:21:16,012][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-25 20:21:16,012][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-25 20:21:16,021][root][INFO] - vocab size              : 51200
[2024-09-25 20:21:16,021][root][INFO] - device                  : gpu
[2024-09-25 20:21:16,021][root][INFO] - random seed             : 42
[2024-09-25 20:21:16,021][root][INFO] - train data size         : 4416
[2024-09-25 20:21:16,021][root][INFO] - max epochs              : 15
[2024-09-25 20:21:16,021][root][INFO] - total steps             : 1035
[2024-09-25 20:21:16,021][root][INFO] - warmup steps            : 104
[2024-09-25 20:21:16,021][root][INFO] - batch size              : 64
[2024-09-25 20:21:16,022][root][INFO] - accumulation steps      : 1
[2024-09-25 20:21:16,022][root][INFO] - optimizer               : adamwscale
[2024-09-25 20:21:16,022][root][INFO] - lr_scheduler            : cosine
[2024-09-25 20:21:16,022][root][INFO] - learning rate           : 0.01
[2024-09-25 20:21:16,022][root][INFO] - max length              : 256

[2024-09-25 20:21:16,022][root][INFO] - LoRA Configuration
[2024-09-25 20:21:16,022][root][INFO] - ㄴ r                    : 32
[2024-09-25 20:21:16,022][root][INFO] - ㄴ alpha                : 128
[2024-09-25 20:21:16,022][root][INFO] - ㄴ dropout              : 0.03

[2024-09-25 20:21:16,022][root][INFO] - 

[2024-09-25 20:21:16,022][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-25 20:21:16,023][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-25 20:21:16,023][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb
[2024-09-25 20:21:16,023][root][INFO] - * tb interval   : 15

[2024-09-25 20:21:16,023][root][INFO] - 

[2024-09-25 20:21:16,023][root][INFO] - Start the Training !
[2024-09-25 20:21:16,026][root][INFO] - 
[1/ 15 Epoch]
[2024-09-25 20:21:22,973][root][INFO] - Step: 15/1035  |  Loss: 3.3881  |  Score: 0.92 [%]  |  Seq Length: 256.0
[2024-09-25 20:21:28,426][root][INFO] - Step: 30/1035  |  Loss: 2.3165  |  Score: 18.38 [%]  |  Seq Length: 256.0
[2024-09-25 20:21:33,920][root][INFO] - Step: 45/1035  |  Loss: 2.0702  |  Score: 33.89 [%]  |  Seq Length: 256.0
[2024-09-25 20:21:39,409][root][INFO] - Step: 60/1035  |  Loss: 1.6511  |  Score: 53.22 [%]  |  Seq Length: 256.0
[2024-09-25 20:21:42,720][root][INFO] - Step: 69/1035  |  Loss: 1.4205  |  Score: 64.34 [%]  |  Seq Length: 256.0
[2024-09-25 20:21:45,805][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-25 20:21:45,806][root][INFO] - Score: 73.02 [%]  |  Evaluation Time: 3.08 [s]
[2024-09-25 20:21:48,761][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-25 20:21:48,762][root][INFO] - Score: 65.20 [%]  |  Evaluation Time: 2.95 [s]
[2024-09-25 20:21:48,763][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-25 20:21:48,764][root][INFO] - 
[2/ 15 Epoch]
[2024-09-25 20:21:51,295][root][INFO] - Step: 75/1035  |  Loss: 1.3487  |  Score: 64.08 [%]  |  Seq Length: 256.0
[2024-09-25 20:21:56,781][root][INFO] - Step: 90/1035  |  Loss: 1.4792  |  Score: 62.77 [%]  |  Seq Length: 256.0
[2024-09-25 20:22:02,268][root][INFO] - Step: 105/1035  |  Loss: 1.3648  |  Score: 60.90 [%]  |  Seq Length: 256.0
[2024-09-25 20:22:07,758][root][INFO] - Step: 120/1035  |  Loss: 1.2505  |  Score: 68.07 [%]  |  Seq Length: 256.0
[2024-09-25 20:22:13,244][root][INFO] - Step: 135/1035  |  Loss: 1.2024  |  Score: 68.13 [%]  |  Seq Length: 256.0
[2024-09-25 20:22:14,411][root][INFO] - Step: 138/1035  |  Loss: 1.1858  |  Score: 73.19 [%]  |  Seq Length: 256.0
[2024-09-25 20:22:17,513][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-25 20:22:17,513][root][INFO] - Score: 74.14 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-25 20:22:20,495][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-25 20:22:20,495][root][INFO] - Score: 67.78 [%]  |  Evaluation Time: 2.98 [s]
[2024-09-25 20:22:20,496][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-25 20:22:20,498][root][INFO] - 
[3/ 15 Epoch]
[2024-09-25 20:22:25,286][root][INFO] - Step: 150/1035  |  Loss: 1.2068  |  Score: 66.87 [%]  |  Seq Length: 256.0
[2024-09-25 20:22:30,826][root][INFO] - Step: 165/1035  |  Loss: 1.0650  |  Score: 69.80 [%]  |  Seq Length: 256.0
[2024-09-25 20:22:36,323][root][INFO] - Step: 180/1035  |  Loss: 0.9787  |  Score: 71.08 [%]  |  Seq Length: 256.0
[2024-09-25 20:22:41,821][root][INFO] - Step: 195/1035  |  Loss: 1.1842  |  Score: 72.03 [%]  |  Seq Length: 256.0
[2024-09-25 20:22:46,291][root][INFO] - Step: 207/1035  |  Loss: 1.0907  |  Score: 72.14 [%]  |  Seq Length: 256.0
[2024-09-25 20:22:49,413][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-25 20:22:49,414][root][INFO] - Score: 77.63 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-25 20:22:52,420][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-25 20:22:52,420][root][INFO] - Score: 70.10 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-25 20:22:52,421][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-25 20:22:52,423][root][INFO] - 
[4/ 15 Epoch]
[2024-09-25 20:22:53,871][root][INFO] - Step: 210/1035  |  Loss: 1.0733  |  Score: 74.18 [%]  |  Seq Length: 256.0
[2024-09-25 20:22:59,393][root][INFO] - Step: 225/1035  |  Loss: 0.9538  |  Score: 75.82 [%]  |  Seq Length: 256.0
[2024-09-25 20:23:04,903][root][INFO] - Step: 240/1035  |  Loss: 0.8554  |  Score: 75.50 [%]  |  Seq Length: 256.0
[2024-09-25 20:23:10,406][root][INFO] - Step: 255/1035  |  Loss: 0.9215  |  Score: 76.65 [%]  |  Seq Length: 256.0
[2024-09-25 20:23:15,913][root][INFO] - Step: 270/1035  |  Loss: 0.9457  |  Score: 75.43 [%]  |  Seq Length: 256.0
[2024-09-25 20:23:18,174][root][INFO] - Step: 276/1035  |  Loss: 1.0580  |  Score: 68.92 [%]  |  Seq Length: 256.0
[2024-09-25 20:23:21,322][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-25 20:23:21,322][root][INFO] - Score: 77.79 [%]  |  Evaluation Time: 3.15 [s]
[2024-09-25 20:23:24,360][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-25 20:23:24,361][root][INFO] - Score: 70.62 [%]  |  Evaluation Time: 3.04 [s]
[2024-09-25 20:23:24,362][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-25 20:23:24,363][root][INFO] - 
[5/ 15 Epoch]
[2024-09-25 20:23:28,034][root][INFO] - Step: 285/1035  |  Loss: 0.8031  |  Score: 79.93 [%]  |  Seq Length: 256.0
[2024-09-25 20:23:33,551][root][INFO] - Step: 300/1035  |  Loss: 0.8312  |  Score: 78.14 [%]  |  Seq Length: 256.0
[2024-09-25 20:23:39,062][root][INFO] - Step: 315/1035  |  Loss: 0.7614  |  Score: 77.96 [%]  |  Seq Length: 256.0
[2024-09-25 20:23:44,616][root][INFO] - Step: 330/1035  |  Loss: 0.7443  |  Score: 79.61 [%]  |  Seq Length: 256.0
[2024-09-25 20:23:50,194][root][INFO] - Step: 345/1035  |  Loss: 0.8749  |  Score: 76.48 [%]  |  Seq Length: 256.0
[2024-09-25 20:23:53,325][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-25 20:23:53,326][root][INFO] - Score: 74.46 [%]  |  Evaluation Time: 3.13 [s]
[2024-09-25 20:23:56,339][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-25 20:23:56,339][root][INFO] - Score: 70.54 [%]  |  Evaluation Time: 3.01 [s]
[2024-09-25 20:23:56,341][root][INFO] - 
[6/ 15 Epoch]
[2024-09-25 20:23:57,089][root][INFO] - Step: 346/1035  |  Loss: 0.7237  |  Score: 82.22 [%]  |  Seq Length: 256.0
[2024-09-25 20:24:02,235][root][INFO] - Step: 360/1035  |  Loss: 0.7485  |  Score: 79.44 [%]  |  Seq Length: 256.0
[2024-09-25 20:24:07,752][root][INFO] - Step: 375/1035  |  Loss: 0.7012  |  Score: 82.63 [%]  |  Seq Length: 256.0
[2024-09-25 20:24:13,275][root][INFO] - Step: 390/1035  |  Loss: 0.7539  |  Score: 79.16 [%]  |  Seq Length: 256.0
[2024-09-25 20:24:18,792][root][INFO] - Step: 405/1035  |  Loss: 0.6871  |  Score: 80.66 [%]  |  Seq Length: 256.0
[2024-09-25 20:24:22,172][root][INFO] - Step: 414/1035  |  Loss: 0.7319  |  Score: 80.29 [%]  |  Seq Length: 256.0
[2024-09-25 20:24:25,293][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-25 20:24:25,293][root][INFO] - Score: 77.97 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-25 20:24:28,323][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-25 20:24:28,323][root][INFO] - Score: 72.64 [%]  |  Evaluation Time: 3.03 [s]
[2024-09-25 20:24:28,324][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-25 20:24:28,325][root][INFO] - 
[7/ 15 Epoch]
[2024-09-25 20:24:30,898][root][INFO] - Step: 420/1035  |  Loss: 0.6564  |  Score: 81.01 [%]  |  Seq Length: 256.0
[2024-09-25 20:24:36,471][root][INFO] - Step: 435/1035  |  Loss: 0.5719  |  Score: 85.82 [%]  |  Seq Length: 256.0
[2024-09-25 20:24:42,037][root][INFO] - Step: 450/1035  |  Loss: 0.6278  |  Score: 82.72 [%]  |  Seq Length: 256.0
[2024-09-25 20:24:47,582][root][INFO] - Step: 465/1035  |  Loss: 0.6191  |  Score: 82.97 [%]  |  Seq Length: 256.0
[2024-09-25 20:24:53,107][root][INFO] - Step: 480/1035  |  Loss: 0.6866  |  Score: 81.67 [%]  |  Seq Length: 256.0
[2024-09-25 20:24:54,268][root][INFO] - Step: 483/1035  |  Loss: 0.6383  |  Score: 82.09 [%]  |  Seq Length: 256.0
[2024-09-25 20:24:57,379][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-25 20:24:57,379][root][INFO] - Score: 77.80 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-25 20:25:00,387][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-25 20:25:00,387][root][INFO] - Score: 71.58 [%]  |  Evaluation Time: 3.01 [s]
[2024-09-25 20:25:00,390][root][INFO] - 
[8/ 15 Epoch]
[2024-09-25 20:25:05,163][root][INFO] - Step: 495/1035  |  Loss: 0.5490  |  Score: 84.10 [%]  |  Seq Length: 256.0
[2024-09-25 20:25:10,691][root][INFO] - Step: 510/1035  |  Loss: 0.5319  |  Score: 85.85 [%]  |  Seq Length: 256.0
[2024-09-25 20:25:16,213][root][INFO] - Step: 525/1035  |  Loss: 0.6062  |  Score: 84.35 [%]  |  Seq Length: 256.0
[2024-09-25 20:25:21,732][root][INFO] - Step: 540/1035  |  Loss: 0.5132  |  Score: 85.79 [%]  |  Seq Length: 256.0
[2024-09-25 20:25:26,203][root][INFO] - Step: 552/1035  |  Loss: 0.5103  |  Score: 84.42 [%]  |  Seq Length: 256.0
[2024-09-25 20:25:29,282][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-25 20:25:29,282][root][INFO] - Score: 78.21 [%]  |  Evaluation Time: 3.08 [s]
[2024-09-25 20:25:32,289][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-25 20:25:32,289][root][INFO] - Score: 72.03 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-25 20:25:32,292][root][INFO] - 
[9/ 15 Epoch]
[2024-09-25 20:25:33,765][root][INFO] - Step: 555/1035  |  Loss: 0.5939  |  Score: 84.14 [%]  |  Seq Length: 256.0
[2024-09-25 20:25:39,290][root][INFO] - Step: 570/1035  |  Loss: 0.5033  |  Score: 86.89 [%]  |  Seq Length: 256.0
[2024-09-25 20:25:44,812][root][INFO] - Step: 585/1035  |  Loss: 0.5322  |  Score: 86.52 [%]  |  Seq Length: 256.0
[2024-09-25 20:25:50,331][root][INFO] - Step: 600/1035  |  Loss: 0.5015  |  Score: 86.66 [%]  |  Seq Length: 256.0
[2024-09-25 20:25:55,849][root][INFO] - Step: 615/1035  |  Loss: 0.4757  |  Score: 86.40 [%]  |  Seq Length: 256.0
[2024-09-25 20:25:58,103][root][INFO] - Step: 621/1035  |  Loss: 0.4920  |  Score: 85.61 [%]  |  Seq Length: 256.0
[2024-09-25 20:26:01,217][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-25 20:26:01,217][root][INFO] - Score: 77.05 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-25 20:26:04,243][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-25 20:26:04,243][root][INFO] - Score: 71.47 [%]  |  Evaluation Time: 3.02 [s]
[2024-09-25 20:26:04,246][root][INFO] - 
[10/ 15 Epoch]
[2024-09-25 20:26:07,903][root][INFO] - Step: 630/1035  |  Loss: 0.4708  |  Score: 88.01 [%]  |  Seq Length: 256.0
[2024-09-25 20:26:13,431][root][INFO] - Step: 645/1035  |  Loss: 0.4341  |  Score: 88.53 [%]  |  Seq Length: 256.0
[2024-09-25 20:26:18,954][root][INFO] - Step: 660/1035  |  Loss: 0.4126  |  Score: 87.92 [%]  |  Seq Length: 256.0
[2024-09-25 20:26:24,475][root][INFO] - Step: 675/1035  |  Loss: 0.4452  |  Score: 87.00 [%]  |  Seq Length: 256.0
[2024-09-25 20:26:30,043][root][INFO] - Step: 690/1035  |  Loss: 0.4415  |  Score: 87.96 [%]  |  Seq Length: 256.0
[2024-09-25 20:26:33,138][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-25 20:26:33,138][root][INFO] - Score: 77.82 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-25 20:26:36,151][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-25 20:26:36,151][root][INFO] - Score: 72.47 [%]  |  Evaluation Time: 3.01 [s]
[2024-09-25 20:26:36,154][root][INFO] - 
[11/ 15 Epoch]
[2024-09-25 20:26:36,877][root][INFO] - Step: 691/1035  |  Loss: 0.4966  |  Score: 86.36 [%]  |  Seq Length: 256.0
[2024-09-25 20:26:42,036][root][INFO] - Step: 705/1035  |  Loss: 0.4137  |  Score: 88.48 [%]  |  Seq Length: 256.0
[2024-09-25 20:26:47,574][root][INFO] - Step: 720/1035  |  Loss: 0.4251  |  Score: 87.06 [%]  |  Seq Length: 256.0
[2024-09-25 20:26:53,099][root][INFO] - Step: 735/1035  |  Loss: 0.4029  |  Score: 88.93 [%]  |  Seq Length: 256.0
[2024-09-25 20:26:58,633][root][INFO] - Step: 750/1035  |  Loss: 0.4198  |  Score: 88.41 [%]  |  Seq Length: 256.0
[2024-09-25 20:27:02,002][root][INFO] - Step: 759/1035  |  Loss: 0.4147  |  Score: 89.79 [%]  |  Seq Length: 256.0
[2024-09-25 20:27:05,128][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-25 20:27:05,128][root][INFO] - Score: 78.02 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-25 20:27:08,126][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-25 20:27:08,126][root][INFO] - Score: 71.83 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-25 20:27:08,129][root][INFO] - 
[12/ 15 Epoch]
[2024-09-25 20:27:10,738][root][INFO] - Step: 765/1035  |  Loss: 0.3492  |  Score: 88.73 [%]  |  Seq Length: 256.0
[2024-09-25 20:27:16,302][root][INFO] - Step: 780/1035  |  Loss: 0.3795  |  Score: 89.31 [%]  |  Seq Length: 256.0
[2024-09-25 20:27:21,827][root][INFO] - Step: 795/1035  |  Loss: 0.3844  |  Score: 89.73 [%]  |  Seq Length: 256.0
[2024-09-25 20:27:27,356][root][INFO] - Step: 810/1035  |  Loss: 0.3584  |  Score: 90.26 [%]  |  Seq Length: 256.0
[2024-09-25 20:27:32,880][root][INFO] - Step: 825/1035  |  Loss: 0.4050  |  Score: 88.11 [%]  |  Seq Length: 256.0
[2024-09-25 20:27:34,013][root][INFO] - Step: 828/1035  |  Loss: 0.3388  |  Score: 90.68 [%]  |  Seq Length: 256.0
[2024-09-25 20:27:37,103][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-25 20:27:37,103][root][INFO] - Score: 78.31 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-25 20:27:40,077][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-25 20:27:40,077][root][INFO] - Score: 72.03 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-25 20:27:40,079][root][INFO] - 
[13/ 15 Epoch]
[2024-09-25 20:27:44,862][root][INFO] - Step: 840/1035  |  Loss: 0.3353  |  Score: 90.41 [%]  |  Seq Length: 256.0
[2024-09-25 20:27:50,386][root][INFO] - Step: 855/1035  |  Loss: 0.3523  |  Score: 90.01 [%]  |  Seq Length: 256.0
[2024-09-25 20:27:55,908][root][INFO] - Step: 870/1035  |  Loss: 0.3577  |  Score: 90.13 [%]  |  Seq Length: 256.0
[2024-09-25 20:28:01,426][root][INFO] - Step: 885/1035  |  Loss: 0.3347  |  Score: 90.60 [%]  |  Seq Length: 256.0
[2024-09-25 20:28:05,890][root][INFO] - Step: 897/1035  |  Loss: 0.3900  |  Score: 88.94 [%]  |  Seq Length: 256.0
[2024-09-25 20:28:09,033][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-25 20:28:09,033][root][INFO] - Score: 77.66 [%]  |  Evaluation Time: 3.14 [s]
[2024-09-25 20:28:12,051][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-25 20:28:12,052][root][INFO] - Score: 71.02 [%]  |  Evaluation Time: 3.02 [s]
[2024-09-25 20:28:12,054][root][INFO] - 
[14/ 15 Epoch]
[2024-09-25 20:28:13,510][root][INFO] - Step: 900/1035  |  Loss: 0.3828  |  Score: 87.38 [%]  |  Seq Length: 256.0
[2024-09-25 20:28:19,032][root][INFO] - Step: 915/1035  |  Loss: 0.3964  |  Score: 89.03 [%]  |  Seq Length: 256.0
[2024-09-25 20:28:24,558][root][INFO] - Step: 930/1035  |  Loss: 0.3293  |  Score: 90.71 [%]  |  Seq Length: 256.0
[2024-09-25 20:28:30,078][root][INFO] - Step: 945/1035  |  Loss: 0.3427  |  Score: 90.51 [%]  |  Seq Length: 256.0
[2024-09-25 20:28:35,598][root][INFO] - Step: 960/1035  |  Loss: 0.3117  |  Score: 90.83 [%]  |  Seq Length: 256.0
[2024-09-25 20:28:37,862][root][INFO] - Step: 966/1035  |  Loss: 0.3724  |  Score: 89.52 [%]  |  Seq Length: 256.0
[2024-09-25 20:28:40,983][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-25 20:28:40,983][root][INFO] - Score: 77.26 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-25 20:28:43,990][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-25 20:28:43,990][root][INFO] - Score: 71.62 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-25 20:28:43,992][root][INFO] - 
[15/ 15 Epoch]
[2024-09-25 20:28:47,668][root][INFO] - Step: 975/1035  |  Loss: 0.3609  |  Score: 89.42 [%]  |  Seq Length: 256.0
[2024-09-25 20:28:53,197][root][INFO] - Step: 990/1035  |  Loss: 0.3308  |  Score: 91.49 [%]  |  Seq Length: 256.0
[2024-09-25 20:28:58,720][root][INFO] - Step: 1005/1035  |  Loss: 0.3568  |  Score: 89.84 [%]  |  Seq Length: 256.0
[2024-09-25 20:29:04,248][root][INFO] - Step: 1020/1035  |  Loss: 0.3325  |  Score: 89.93 [%]  |  Seq Length: 256.0
[2024-09-25 20:29:09,807][root][INFO] - Step: 1035/1035  |  Loss: 0.3641  |  Score: 88.96 [%]  |  Seq Length: 256.0
[2024-09-25 20:29:12,926][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-25 20:29:12,927][root][INFO] - Score: 78.10 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-25 20:29:15,924][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-25 20:29:15,924][root][INFO] - Score: 71.31 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-25 20:29:15,925][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-25 20:29:15,925][root][INFO] - - Epoch: 6
[2024-09-25 20:29:15,925][root][INFO] - - DEV score: 77.97 [%]
[2024-09-25 20:29:15,925][root][INFO] - - TEST score: 72.64 [%]
[2024-09-25 20:29:15,926][root][INFO] - Fine-tuning is done!
[2024-09-25 20:31:14,766][root][INFO] - 

[2024-09-25 20:31:14,767][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-25 20:31:14,767][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-25 20:31:14,767][root][INFO] - 

[2024-09-25 20:31:14,767][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 1, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-25 20:32:02,531][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-25 20:32:02,532][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-25 20:32:02,532][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-25 20:32:02,533][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-25 20:32:02,533][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-25 20:32:02,534][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-25 20:32:02,534][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-25 20:32:02,534][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-25 20:32:02,535][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-25 20:32:02,535][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-25 20:32:02,536][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-25 20:32:02,536][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-25 20:32:02,537][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-25 20:32:02,537][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-25 20:32:02,538][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-25 20:32:02,538][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-25 20:32:02,539][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-25 20:32:02,539][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-25 20:32:02,540][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-25 20:32:02,540][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-25 20:32:02,541][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-25 20:32:02,541][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-25 20:32:02,542][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-25 20:32:02,542][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-25 20:32:02,544][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-25 20:32:02,736][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-25 20:32:04,585][root][INFO] - 

[2024-09-25 20:32:04,585][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-25 20:32:04,585][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-25 20:32:04,593][root][INFO] - vocab size              : 51200
[2024-09-25 20:32:04,593][root][INFO] - device                  : gpu
[2024-09-25 20:32:04,593][root][INFO] - random seed             : 42
[2024-09-25 20:32:04,593][root][INFO] - train data size         : 4416
[2024-09-25 20:32:04,593][root][INFO] - max epochs              : 15
[2024-09-25 20:32:04,593][root][INFO] - total steps             : 1035
[2024-09-25 20:32:04,593][root][INFO] - warmup steps            : 104
[2024-09-25 20:32:04,593][root][INFO] - batch size              : 64
[2024-09-25 20:32:04,594][root][INFO] - accumulation steps      : 1
[2024-09-25 20:32:04,594][root][INFO] - optimizer               : adamwscale
[2024-09-25 20:32:04,594][root][INFO] - lr_scheduler            : cosine
[2024-09-25 20:32:04,594][root][INFO] - learning rate           : 0.01
[2024-09-25 20:32:04,594][root][INFO] - max length              : 256

[2024-09-25 20:32:04,594][root][INFO] - LoRA Configuration
[2024-09-25 20:32:04,594][root][INFO] - ㄴ r                    : 32
[2024-09-25 20:32:04,594][root][INFO] - ㄴ alpha                : 128
[2024-09-25 20:32:04,594][root][INFO] - ㄴ dropout              : 0.03

[2024-09-25 20:32:04,594][root][INFO] - 

[2024-09-25 20:32:04,594][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs
[2024-09-25 20:32:04,594][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/ckpt
[2024-09-25 20:32:04,595][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_1s_0.01lr_42rs/tb
[2024-09-25 20:32:04,595][root][INFO] - * tb interval   : 15

[2024-09-25 20:32:04,595][root][INFO] - 

[2024-09-25 20:32:04,595][root][INFO] - Start the Training !
[2024-09-25 20:32:04,598][root][INFO] - 
[1/ 15 Epoch]
[2024-09-25 20:32:11,512][root][INFO] - Step: 15/1035  |  Loss: 3.3881  |  Score: 0.92 [%]  |  Seq Length: 256.0
[2024-09-25 20:32:17,023][root][INFO] - Step: 30/1035  |  Loss: 2.3165  |  Score: 18.38 [%]  |  Seq Length: 256.0
[2024-09-25 20:32:22,499][root][INFO] - Step: 45/1035  |  Loss: 2.0702  |  Score: 33.89 [%]  |  Seq Length: 256.0
[2024-09-25 20:32:27,979][root][INFO] - Step: 60/1035  |  Loss: 1.6511  |  Score: 53.22 [%]  |  Seq Length: 256.0
[2024-09-25 20:32:31,294][root][INFO] - Step: 69/1035  |  Loss: 1.4205  |  Score: 64.34 [%]  |  Seq Length: 256.0
[2024-09-25 20:32:34,392][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-25 20:32:34,392][root][INFO] - Score: 73.02 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-25 20:32:37,372][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-25 20:32:37,372][root][INFO] - Score: 65.20 [%]  |  Evaluation Time: 2.98 [s]
[2024-09-25 20:32:37,373][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-25 20:32:37,375][root][INFO] - 
[2/ 15 Epoch]
[2024-09-25 20:32:39,903][root][INFO] - Step: 75/1035  |  Loss: 1.3487  |  Score: 64.08 [%]  |  Seq Length: 256.0
[2024-09-25 20:32:45,400][root][INFO] - Step: 90/1035  |  Loss: 1.4792  |  Score: 62.77 [%]  |  Seq Length: 256.0
[2024-09-25 20:32:50,912][root][INFO] - Step: 105/1035  |  Loss: 1.3648  |  Score: 60.90 [%]  |  Seq Length: 256.0
[2024-09-25 20:32:56,424][root][INFO] - Step: 120/1035  |  Loss: 1.2505  |  Score: 68.07 [%]  |  Seq Length: 256.0
[2024-09-25 20:33:01,936][root][INFO] - Step: 135/1035  |  Loss: 1.2024  |  Score: 68.13 [%]  |  Seq Length: 256.0
[2024-09-25 20:33:03,078][root][INFO] - Step: 138/1035  |  Loss: 1.1858  |  Score: 73.19 [%]  |  Seq Length: 256.0
[2024-09-25 20:33:06,201][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-25 20:33:06,201][root][INFO] - Score: 74.14 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-25 20:33:09,209][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-25 20:33:09,209][root][INFO] - Score: 67.78 [%]  |  Evaluation Time: 3.01 [s]
[2024-09-25 20:33:09,210][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-25 20:33:09,212][root][INFO] - 
[3/ 15 Epoch]
[2024-09-25 20:33:13,984][root][INFO] - Step: 150/1035  |  Loss: 1.2068  |  Score: 66.87 [%]  |  Seq Length: 256.0
[2024-09-25 20:33:19,507][root][INFO] - Step: 165/1035  |  Loss: 1.0650  |  Score: 69.80 [%]  |  Seq Length: 256.0
[2024-09-25 20:33:25,033][root][INFO] - Step: 180/1035  |  Loss: 0.9787  |  Score: 71.08 [%]  |  Seq Length: 256.0
[2024-09-25 20:33:30,597][root][INFO] - Step: 195/1035  |  Loss: 1.1842  |  Score: 72.03 [%]  |  Seq Length: 256.0
[2024-09-25 20:33:35,107][root][INFO] - Step: 207/1035  |  Loss: 1.0907  |  Score: 72.14 [%]  |  Seq Length: 256.0
[2024-09-25 20:33:38,213][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-25 20:33:38,213][root][INFO] - Score: 77.63 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-25 20:33:41,173][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-25 20:33:41,174][root][INFO] - Score: 70.10 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-25 20:33:41,175][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-25 20:33:41,176][root][INFO] - 
[4/ 15 Epoch]
[2024-09-25 20:33:42,613][root][INFO] - Step: 210/1035  |  Loss: 1.0733  |  Score: 74.18 [%]  |  Seq Length: 256.0
[2024-09-25 20:33:48,129][root][INFO] - Step: 225/1035  |  Loss: 0.9538  |  Score: 75.82 [%]  |  Seq Length: 256.0
[2024-09-25 20:33:53,647][root][INFO] - Step: 240/1035  |  Loss: 0.8554  |  Score: 75.50 [%]  |  Seq Length: 256.0
[2024-09-25 20:33:59,162][root][INFO] - Step: 255/1035  |  Loss: 0.9215  |  Score: 76.65 [%]  |  Seq Length: 256.0
[2024-09-25 20:34:04,676][root][INFO] - Step: 270/1035  |  Loss: 0.9457  |  Score: 75.43 [%]  |  Seq Length: 256.0
[2024-09-25 20:34:06,934][root][INFO] - Step: 276/1035  |  Loss: 1.0580  |  Score: 68.92 [%]  |  Seq Length: 256.0
[2024-09-25 20:34:10,034][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-25 20:34:10,034][root][INFO] - Score: 77.79 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-25 20:34:13,011][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-25 20:34:13,011][root][INFO] - Score: 70.62 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-25 20:34:13,012][root][INFO] - 
Save new Best Score (Epoch: 4)
[2024-09-25 20:34:13,013][root][INFO] - 
[5/ 15 Epoch]
[2024-09-25 20:34:16,639][root][INFO] - Step: 285/1035  |  Loss: 0.8031  |  Score: 79.93 [%]  |  Seq Length: 256.0
[2024-09-25 20:34:22,154][root][INFO] - Step: 300/1035  |  Loss: 0.8312  |  Score: 78.14 [%]  |  Seq Length: 256.0
[2024-09-25 20:34:27,665][root][INFO] - Step: 315/1035  |  Loss: 0.7614  |  Score: 77.96 [%]  |  Seq Length: 256.0
[2024-09-25 20:34:33,177][root][INFO] - Step: 330/1035  |  Loss: 0.7443  |  Score: 79.61 [%]  |  Seq Length: 256.0
[2024-09-25 20:34:38,707][root][INFO] - Step: 345/1035  |  Loss: 0.8749  |  Score: 76.48 [%]  |  Seq Length: 256.0
[2024-09-25 20:34:41,820][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-25 20:34:41,821][root][INFO] - Score: 74.46 [%]  |  Evaluation Time: 3.11 [s]
[2024-09-25 20:34:44,797][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-25 20:34:44,797][root][INFO] - Score: 70.54 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-25 20:34:44,799][root][INFO] - 
[6/ 15 Epoch]
[2024-09-25 20:34:45,554][root][INFO] - Step: 346/1035  |  Loss: 0.7237  |  Score: 82.22 [%]  |  Seq Length: 256.0
[2024-09-25 20:34:50,731][root][INFO] - Step: 360/1035  |  Loss: 0.7485  |  Score: 79.44 [%]  |  Seq Length: 256.0
[2024-09-25 20:34:56,257][root][INFO] - Step: 375/1035  |  Loss: 0.7012  |  Score: 82.63 [%]  |  Seq Length: 256.0
[2024-09-25 20:35:01,781][root][INFO] - Step: 390/1035  |  Loss: 0.7539  |  Score: 79.16 [%]  |  Seq Length: 256.0
[2024-09-25 20:35:07,307][root][INFO] - Step: 405/1035  |  Loss: 0.6871  |  Score: 80.66 [%]  |  Seq Length: 256.0
[2024-09-25 20:35:10,684][root][INFO] - Step: 414/1035  |  Loss: 0.7319  |  Score: 80.29 [%]  |  Seq Length: 256.0
[2024-09-25 20:35:13,792][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-25 20:35:13,792][root][INFO] - Score: 77.97 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-25 20:35:16,787][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-25 20:35:16,787][root][INFO] - Score: 72.64 [%]  |  Evaluation Time: 2.99 [s]
[2024-09-25 20:35:16,788][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-25 20:35:16,790][root][INFO] - 
[7/ 15 Epoch]
[2024-09-25 20:35:19,332][root][INFO] - Step: 420/1035  |  Loss: 0.6564  |  Score: 81.01 [%]  |  Seq Length: 256.0
[2024-09-25 20:35:24,849][root][INFO] - Step: 435/1035  |  Loss: 0.5719  |  Score: 85.82 [%]  |  Seq Length: 256.0
[2024-09-25 20:35:30,365][root][INFO] - Step: 450/1035  |  Loss: 0.6278  |  Score: 82.72 [%]  |  Seq Length: 256.0
[2024-09-25 20:35:35,879][root][INFO] - Step: 465/1035  |  Loss: 0.6191  |  Score: 82.97 [%]  |  Seq Length: 256.0
[2024-09-25 20:35:41,393][root][INFO] - Step: 480/1035  |  Loss: 0.6866  |  Score: 81.67 [%]  |  Seq Length: 256.0
[2024-09-25 20:35:42,556][root][INFO] - Step: 483/1035  |  Loss: 0.6383  |  Score: 82.09 [%]  |  Seq Length: 256.0
[2024-09-25 20:35:45,677][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-25 20:35:45,677][root][INFO] - Score: 77.80 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-25 20:35:48,626][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-25 20:35:48,627][root][INFO] - Score: 71.58 [%]  |  Evaluation Time: 2.95 [s]
[2024-09-25 20:35:48,629][root][INFO] - 
[8/ 15 Epoch]
[2024-09-25 20:35:53,367][root][INFO] - Step: 495/1035  |  Loss: 0.5490  |  Score: 84.10 [%]  |  Seq Length: 256.0
[2024-09-25 20:35:58,898][root][INFO] - Step: 510/1035  |  Loss: 0.5319  |  Score: 85.85 [%]  |  Seq Length: 256.0
[2024-09-25 20:36:04,413][root][INFO] - Step: 525/1035  |  Loss: 0.6062  |  Score: 84.35 [%]  |  Seq Length: 256.0
[2024-09-25 20:36:09,925][root][INFO] - Step: 540/1035  |  Loss: 0.5132  |  Score: 85.79 [%]  |  Seq Length: 256.0
[2024-09-25 20:36:14,379][root][INFO] - Step: 552/1035  |  Loss: 0.5103  |  Score: 84.42 [%]  |  Seq Length: 256.0
[2024-09-25 20:36:17,455][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-25 20:36:17,455][root][INFO] - Score: 78.21 [%]  |  Evaluation Time: 3.07 [s]
[2024-09-25 20:36:20,457][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-25 20:36:20,457][root][INFO] - Score: 72.03 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-25 20:36:20,459][root][INFO] - 
[9/ 15 Epoch]
[2024-09-25 20:36:21,881][root][INFO] - Step: 555/1035  |  Loss: 0.5939  |  Score: 84.14 [%]  |  Seq Length: 256.0
[2024-09-25 20:36:27,390][root][INFO] - Step: 570/1035  |  Loss: 0.5033  |  Score: 86.89 [%]  |  Seq Length: 256.0
[2024-09-25 20:36:32,910][root][INFO] - Step: 585/1035  |  Loss: 0.5322  |  Score: 86.52 [%]  |  Seq Length: 256.0
[2024-09-25 20:36:38,424][root][INFO] - Step: 600/1035  |  Loss: 0.5015  |  Score: 86.66 [%]  |  Seq Length: 256.0
[2024-09-25 20:36:43,937][root][INFO] - Step: 615/1035  |  Loss: 0.4757  |  Score: 86.40 [%]  |  Seq Length: 256.0
[2024-09-25 20:36:46,204][root][INFO] - Step: 621/1035  |  Loss: 0.4920  |  Score: 85.61 [%]  |  Seq Length: 256.0
[2024-09-25 20:36:49,296][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-25 20:36:49,297][root][INFO] - Score: 77.05 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-25 20:36:52,224][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-25 20:36:52,224][root][INFO] - Score: 71.47 [%]  |  Evaluation Time: 2.93 [s]
[2024-09-25 20:36:52,226][root][INFO] - 
[10/ 15 Epoch]
[2024-09-25 20:36:55,838][root][INFO] - Step: 630/1035  |  Loss: 0.4708  |  Score: 88.01 [%]  |  Seq Length: 256.0
[2024-09-25 20:37:01,354][root][INFO] - Step: 645/1035  |  Loss: 0.4341  |  Score: 88.53 [%]  |  Seq Length: 256.0
[2024-09-25 20:37:06,875][root][INFO] - Step: 660/1035  |  Loss: 0.4126  |  Score: 87.92 [%]  |  Seq Length: 256.0
[2024-09-25 20:37:12,389][root][INFO] - Step: 675/1035  |  Loss: 0.4452  |  Score: 87.00 [%]  |  Seq Length: 256.0
[2024-09-25 20:37:17,961][root][INFO] - Step: 690/1035  |  Loss: 0.4415  |  Score: 87.96 [%]  |  Seq Length: 256.0
[2024-09-25 20:37:21,022][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-25 20:37:21,022][root][INFO] - Score: 77.82 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-25 20:37:24,022][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-25 20:37:24,022][root][INFO] - Score: 72.47 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-25 20:37:24,024][root][INFO] - 
[11/ 15 Epoch]
[2024-09-25 20:37:24,740][root][INFO] - Step: 691/1035  |  Loss: 0.4966  |  Score: 86.36 [%]  |  Seq Length: 256.0
[2024-09-25 20:37:29,906][root][INFO] - Step: 705/1035  |  Loss: 0.4137  |  Score: 88.48 [%]  |  Seq Length: 256.0
[2024-09-25 20:37:35,438][root][INFO] - Step: 720/1035  |  Loss: 0.4251  |  Score: 87.06 [%]  |  Seq Length: 256.0
[2024-09-25 20:37:40,966][root][INFO] - Step: 735/1035  |  Loss: 0.4029  |  Score: 88.93 [%]  |  Seq Length: 256.0
[2024-09-25 20:37:46,494][root][INFO] - Step: 750/1035  |  Loss: 0.4198  |  Score: 88.41 [%]  |  Seq Length: 256.0
[2024-09-25 20:37:49,854][root][INFO] - Step: 759/1035  |  Loss: 0.4147  |  Score: 89.79 [%]  |  Seq Length: 256.0
[2024-09-25 20:37:52,947][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-25 20:37:52,947][root][INFO] - Score: 78.02 [%]  |  Evaluation Time: 3.09 [s]
[2024-09-25 20:37:55,908][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-25 20:37:55,908][root][INFO] - Score: 71.83 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-25 20:37:55,910][root][INFO] - 
[12/ 15 Epoch]
[2024-09-25 20:37:58,433][root][INFO] - Step: 765/1035  |  Loss: 0.3492  |  Score: 88.73 [%]  |  Seq Length: 256.0
[2024-09-25 20:38:03,951][root][INFO] - Step: 780/1035  |  Loss: 0.3795  |  Score: 89.31 [%]  |  Seq Length: 256.0
[2024-09-25 20:38:09,467][root][INFO] - Step: 795/1035  |  Loss: 0.3844  |  Score: 89.73 [%]  |  Seq Length: 256.0
[2024-09-25 20:38:14,983][root][INFO] - Step: 810/1035  |  Loss: 0.3584  |  Score: 90.26 [%]  |  Seq Length: 256.0
[2024-09-25 20:38:20,499][root][INFO] - Step: 825/1035  |  Loss: 0.4050  |  Score: 88.11 [%]  |  Seq Length: 256.0
[2024-09-25 20:38:21,666][root][INFO] - Step: 828/1035  |  Loss: 0.3388  |  Score: 90.68 [%]  |  Seq Length: 256.0
[2024-09-25 20:38:24,770][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-25 20:38:24,770][root][INFO] - Score: 78.31 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-25 20:38:27,741][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-25 20:38:27,741][root][INFO] - Score: 72.03 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-25 20:38:27,743][root][INFO] - 
[13/ 15 Epoch]
[2024-09-25 20:38:32,519][root][INFO] - Step: 840/1035  |  Loss: 0.3353  |  Score: 90.41 [%]  |  Seq Length: 256.0
[2024-09-25 20:38:38,047][root][INFO] - Step: 855/1035  |  Loss: 0.3523  |  Score: 90.01 [%]  |  Seq Length: 256.0
[2024-09-25 20:38:43,581][root][INFO] - Step: 870/1035  |  Loss: 0.3577  |  Score: 90.13 [%]  |  Seq Length: 256.0
[2024-09-25 20:38:49,108][root][INFO] - Step: 885/1035  |  Loss: 0.3347  |  Score: 90.60 [%]  |  Seq Length: 256.0
[2024-09-25 20:38:53,581][root][INFO] - Step: 897/1035  |  Loss: 0.3900  |  Score: 88.94 [%]  |  Seq Length: 256.0
[2024-09-25 20:38:56,680][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-25 20:38:56,680][root][INFO] - Score: 77.66 [%]  |  Evaluation Time: 3.10 [s]
[2024-09-25 20:38:59,654][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-25 20:38:59,654][root][INFO] - Score: 71.02 [%]  |  Evaluation Time: 2.97 [s]
[2024-09-25 20:38:59,656][root][INFO] - 
[14/ 15 Epoch]
[2024-09-25 20:39:01,072][root][INFO] - Step: 900/1035  |  Loss: 0.3828  |  Score: 87.38 [%]  |  Seq Length: 256.0
[2024-09-25 20:39:06,587][root][INFO] - Step: 915/1035  |  Loss: 0.3964  |  Score: 89.03 [%]  |  Seq Length: 256.0
[2024-09-25 20:39:12,100][root][INFO] - Step: 930/1035  |  Loss: 0.3293  |  Score: 90.71 [%]  |  Seq Length: 256.0
[2024-09-25 20:39:17,622][root][INFO] - Step: 945/1035  |  Loss: 0.3427  |  Score: 90.51 [%]  |  Seq Length: 256.0
[2024-09-25 20:39:23,140][root][INFO] - Step: 960/1035  |  Loss: 0.3117  |  Score: 90.83 [%]  |  Seq Length: 256.0
[2024-09-25 20:39:25,404][root][INFO] - Step: 966/1035  |  Loss: 0.3724  |  Score: 89.52 [%]  |  Seq Length: 256.0
[2024-09-25 20:39:28,527][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-25 20:39:28,527][root][INFO] - Score: 77.26 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-25 20:39:31,493][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-25 20:39:31,493][root][INFO] - Score: 71.62 [%]  |  Evaluation Time: 2.96 [s]
[2024-09-25 20:39:31,495][root][INFO] - 
[15/ 15 Epoch]
[2024-09-25 20:39:35,097][root][INFO] - Step: 975/1035  |  Loss: 0.3609  |  Score: 89.42 [%]  |  Seq Length: 256.0
[2024-09-25 20:39:40,619][root][INFO] - Step: 990/1035  |  Loss: 0.3308  |  Score: 91.49 [%]  |  Seq Length: 256.0
[2024-09-25 20:39:46,135][root][INFO] - Step: 1005/1035  |  Loss: 0.3568  |  Score: 89.84 [%]  |  Seq Length: 256.0
[2024-09-25 20:39:51,655][root][INFO] - Step: 1020/1035  |  Loss: 0.3325  |  Score: 89.93 [%]  |  Seq Length: 256.0
[2024-09-25 20:39:57,190][root][INFO] - Step: 1035/1035  |  Loss: 0.3641  |  Score: 88.96 [%]  |  Seq Length: 256.0
[2024-09-25 20:40:00,245][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-25 20:40:00,245][root][INFO] - Score: 78.10 [%]  |  Evaluation Time: 3.05 [s]
[2024-09-25 20:40:03,245][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-25 20:40:03,245][root][INFO] - Score: 71.31 [%]  |  Evaluation Time: 3.00 [s]
[2024-09-25 20:40:03,246][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-25 20:40:03,246][root][INFO] - - Epoch: 6
[2024-09-25 20:40:03,246][root][INFO] - - DEV score: 77.97 [%]
[2024-09-25 20:40:03,246][root][INFO] - - TEST score: 72.64 [%]
[2024-09-25 20:40:03,247][root][INFO] - Fine-tuning is done!
[2024-09-26 09:36:33,195][root][INFO] - 

[2024-09-26 09:36:33,195][root][INFO] - This train_log.txt inform the Running Progress.

[2024-09-26 09:36:33,195][root][INFO] - Save the parser information to logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_2s_0.01lr_42rs
[2024-09-26 09:36:33,195][root][INFO] - 

[2024-09-26 09:36:33,196][root][INFO] - Arguments: {'port': 5678, 'host': 'localhost', 'device': 'gpu', 'mixed_precision': 'bf16', 'eval_only': False, 'predict_only': False, 'seed': 42, 'model': {'name': 'skt/kogpt2-base-v2', 'hf_model': True, 'n_positions': 2048, 'ckpt_dir': '', 'compile': True, 'set_lora': True, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}, 'set_kombo': False, 'kombo': {'tok_type': 'jamo_var', 'lang': 'ko', 'reducer': 'linear', 'hidden_dim': 768, 'kombo_max_length': 2048, 'do_combination': False, 'combination': {'combination_type': 'gru', 'intermediate_size': 3072, 'num_attention_heads': 12, 'num_trans_layers': 3}, 'add_lora': False, 'lora': {'r': 32, 'alpha': 128, 'dropout': 0.03}}}, 'data': {'language': 'ko', 'tok_type': 'morphemeSubword', 'vocab_size': '32k', 'raw_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated.txt', 'train_data_path': '/data3/user21/KOMBO/datasets/pretraining/concatenated_doc.txt', 'split_by_doc': True, 'is_toyset': False, 'max_length': 256, 'num_workers': 4, 'num_labels': 1, 'remain_lang': 'ko_en_punc', 'do_hangeulize': True, 'data_remove': True, 'task_name': 'KorSTS'}, 'optim': {'name': 'adamwscale', 'base_lr': 0.01, 'batch_size': 64, 'total_steps': -1, 'epochs': 15, 'warmup_steps': -1, 'warmup_ratio': 0.1, 'lr_scheduler': 'cosine', 'weight_decay': 0.0, 'grad_clip': 1.0, 'grad_acc': 2, 'final_cosine': 1e-05, 'dropout_prob': 0.1}, 'eval': {'eval_steps': 10000, 'steps': 500}, 'checkpoint': {'save_steps': 50000, 'max_number': 3}, 'logging': {'log_steps': 15, 'grad_l2': True, 'weights_l2': True, 'log_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_2s_0.01lr_42rs', 'tb_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_2s_0.01lr_42rs/tb', 'save_dir': 'logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_2s_0.01lr_42rs/ckpt'}, 'mode': 'nlu_ft'}

[2024-09-26 09:36:37,919][root][INFO] - Replaced transformer.h.0.attn.c_attn with LoRA_Layer
[2024-09-26 09:36:37,920][root][INFO] - Replaced transformer.h.0.attn.c_proj with LoRA_Layer
[2024-09-26 09:36:37,921][root][INFO] - Replaced transformer.h.1.attn.c_attn with LoRA_Layer
[2024-09-26 09:36:37,921][root][INFO] - Replaced transformer.h.1.attn.c_proj with LoRA_Layer
[2024-09-26 09:36:37,921][root][INFO] - Replaced transformer.h.2.attn.c_attn with LoRA_Layer
[2024-09-26 09:36:37,922][root][INFO] - Replaced transformer.h.2.attn.c_proj with LoRA_Layer
[2024-09-26 09:36:37,922][root][INFO] - Replaced transformer.h.3.attn.c_attn with LoRA_Layer
[2024-09-26 09:36:37,923][root][INFO] - Replaced transformer.h.3.attn.c_proj with LoRA_Layer
[2024-09-26 09:36:37,923][root][INFO] - Replaced transformer.h.4.attn.c_attn with LoRA_Layer
[2024-09-26 09:36:37,924][root][INFO] - Replaced transformer.h.4.attn.c_proj with LoRA_Layer
[2024-09-26 09:36:37,924][root][INFO] - Replaced transformer.h.5.attn.c_attn with LoRA_Layer
[2024-09-26 09:36:37,925][root][INFO] - Replaced transformer.h.5.attn.c_proj with LoRA_Layer
[2024-09-26 09:36:37,925][root][INFO] - Replaced transformer.h.6.attn.c_attn with LoRA_Layer
[2024-09-26 09:36:37,926][root][INFO] - Replaced transformer.h.6.attn.c_proj with LoRA_Layer
[2024-09-26 09:36:37,926][root][INFO] - Replaced transformer.h.7.attn.c_attn with LoRA_Layer
[2024-09-26 09:36:37,927][root][INFO] - Replaced transformer.h.7.attn.c_proj with LoRA_Layer
[2024-09-26 09:36:37,927][root][INFO] - Replaced transformer.h.8.attn.c_attn with LoRA_Layer
[2024-09-26 09:36:37,928][root][INFO] - Replaced transformer.h.8.attn.c_proj with LoRA_Layer
[2024-09-26 09:36:37,928][root][INFO] - Replaced transformer.h.9.attn.c_attn with LoRA_Layer
[2024-09-26 09:36:37,929][root][INFO] - Replaced transformer.h.9.attn.c_proj with LoRA_Layer
[2024-09-26 09:36:37,929][root][INFO] - Replaced transformer.h.10.attn.c_attn with LoRA_Layer
[2024-09-26 09:36:37,930][root][INFO] - Replaced transformer.h.10.attn.c_proj with LoRA_Layer
[2024-09-26 09:36:37,930][root][INFO] - Replaced transformer.h.11.attn.c_attn with LoRA_Layer
[2024-09-26 09:36:37,931][root][INFO] - Replaced transformer.h.11.attn.c_proj with LoRA_Layer
[2024-09-26 09:36:37,932][root][INFO] - Trainable params: 1769472 || all params: 126934272 || trainable: 1.39 %
[2024-09-26 09:36:38,306][accelerate.utils.other][WARNING] - Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-09-26 09:36:42,738][root][INFO] - 

[2024-09-26 09:36:42,738][root][INFO] - ========== Fine-tuning on KorSTS ==========
[2024-09-26 09:36:42,738][root][INFO] - model                   : skt/kogpt2-base-v2
[2024-09-26 09:36:42,749][root][INFO] - vocab size              : 51200
[2024-09-26 09:36:42,749][root][INFO] - device                  : gpu
[2024-09-26 09:36:42,749][root][INFO] - random seed             : 42
[2024-09-26 09:36:42,750][root][INFO] - train data size         : 2208
[2024-09-26 09:36:42,750][root][INFO] - max epochs              : 15
[2024-09-26 09:36:42,750][root][INFO] - total steps             : 1035
[2024-09-26 09:36:42,750][root][INFO] - warmup steps            : 104
[2024-09-26 09:36:42,750][root][INFO] - batch size              : 64
[2024-09-26 09:36:42,750][root][INFO] - accumulation steps      : 2
[2024-09-26 09:36:42,750][root][INFO] - optimizer               : adamwscale
[2024-09-26 09:36:42,750][root][INFO] - lr_scheduler            : cosine
[2024-09-26 09:36:42,750][root][INFO] - learning rate           : 0.01
[2024-09-26 09:36:42,750][root][INFO] - max length              : 256

[2024-09-26 09:36:42,750][root][INFO] - LoRA Configuration
[2024-09-26 09:36:42,751][root][INFO] - ㄴ r                    : 32
[2024-09-26 09:36:42,751][root][INFO] - ㄴ alpha                : 128
[2024-09-26 09:36:42,751][root][INFO] - ㄴ dropout              : 0.03

[2024-09-26 09:36:42,751][root][INFO] - 

[2024-09-26 09:36:42,751][root][INFO] - * log dir       : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_2s_0.01lr_42rs
[2024-09-26 09:36:42,751][root][INFO] - * save dir      : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_2s_0.01lr_42rs/ckpt
[2024-09-26 09:36:42,751][root][INFO] - * tb dir        : logs/skt_kogpt2-base-v2/nlu_tasks/KorSTS/256t_64b_2s_0.01lr_42rs/tb
[2024-09-26 09:36:42,751][root][INFO] - * tb interval   : 15

[2024-09-26 09:36:42,751][root][INFO] - 

[2024-09-26 09:36:42,751][root][INFO] - Start the Training !
[2024-09-26 09:36:42,755][root][INFO] - 
[1/ 15 Epoch]
[2024-09-26 09:36:51,632][root][INFO] - Step: 15/1035  |  Loss: 3.3363  |  Score: 5.61 [%]  |  Seq Length: 256.0
[2024-09-26 09:36:57,380][root][INFO] - Step: 30/1035  |  Loss: 2.2877  |  Score: 19.93 [%]  |  Seq Length: 256.0
[2024-09-26 09:37:03,123][root][INFO] - Step: 45/1035  |  Loss: 2.0050  |  Score: 38.49 [%]  |  Seq Length: 256.0
[2024-09-26 09:37:08,872][root][INFO] - Step: 60/1035  |  Loss: 1.6025  |  Score: 54.56 [%]  |  Seq Length: 256.0
[2024-09-26 09:37:12,328][root][INFO] - Step: 69/1035  |  Loss: 1.3922  |  Score: 64.35 [%]  |  Seq Length: 256.0
[2024-09-26 09:37:15,613][root][INFO] - ########################  DEV REPORT #EP1  ########################
[2024-09-26 09:37:15,613][root][INFO] - Score: 72.79 [%]  |  Evaluation Time: 3.28 [s]
[2024-09-26 09:37:18,674][root][INFO] - ########################  TEST REPORT #EP1  ########################
[2024-09-26 09:37:18,675][root][INFO] - Score: 64.63 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-26 09:37:18,676][root][INFO] - 
Save new Best Score (Epoch: 1)
[2024-09-26 09:37:18,677][root][INFO] - 
[2/ 15 Epoch]
[2024-09-26 09:37:21,256][root][INFO] - Step: 75/1035  |  Loss: 1.4606  |  Score: 60.51 [%]  |  Seq Length: 256.0
[2024-09-26 09:37:27,017][root][INFO] - Step: 90/1035  |  Loss: 1.3517  |  Score: 64.73 [%]  |  Seq Length: 256.0
[2024-09-26 09:37:32,783][root][INFO] - Step: 105/1035  |  Loss: 1.2640  |  Score: 62.39 [%]  |  Seq Length: 256.0
[2024-09-26 09:37:38,553][root][INFO] - Step: 120/1035  |  Loss: 1.2665  |  Score: 66.27 [%]  |  Seq Length: 256.0
[2024-09-26 09:37:44,324][root][INFO] - Step: 135/1035  |  Loss: 1.2764  |  Score: 65.04 [%]  |  Seq Length: 256.0
[2024-09-26 09:37:45,510][root][INFO] - Step: 138/1035  |  Loss: 1.2290  |  Score: 70.11 [%]  |  Seq Length: 256.0
[2024-09-26 09:37:48,706][root][INFO] - ########################  DEV REPORT #EP2  ########################
[2024-09-26 09:37:48,706][root][INFO] - Score: 75.20 [%]  |  Evaluation Time: 3.19 [s]
[2024-09-26 09:37:51,776][root][INFO] - ########################  TEST REPORT #EP2  ########################
[2024-09-26 09:37:51,776][root][INFO] - Score: 68.87 [%]  |  Evaluation Time: 3.07 [s]
[2024-09-26 09:37:51,777][root][INFO] - 
Save new Best Score (Epoch: 2)
[2024-09-26 09:37:51,779][root][INFO] - 
[3/ 15 Epoch]
[2024-09-26 09:37:56,765][root][INFO] - Step: 150/1035  |  Loss: 1.1366  |  Score: 67.11 [%]  |  Seq Length: 256.0
[2024-09-26 09:38:02,553][root][INFO] - Step: 165/1035  |  Loss: 0.9896  |  Score: 70.96 [%]  |  Seq Length: 256.0
[2024-09-26 09:38:08,342][root][INFO] - Step: 180/1035  |  Loss: 1.0075  |  Score: 72.55 [%]  |  Seq Length: 256.0
[2024-09-26 09:38:14,126][root][INFO] - Step: 195/1035  |  Loss: 1.2036  |  Score: 70.76 [%]  |  Seq Length: 256.0
[2024-09-26 09:38:18,780][root][INFO] - Step: 207/1035  |  Loss: 1.0615  |  Score: 69.35 [%]  |  Seq Length: 256.0
[2024-09-26 09:38:21,977][root][INFO] - ########################  DEV REPORT #EP3  ########################
[2024-09-26 09:38:21,977][root][INFO] - Score: 77.99 [%]  |  Evaluation Time: 3.19 [s]
[2024-09-26 09:38:25,099][root][INFO] - ########################  TEST REPORT #EP3  ########################
[2024-09-26 09:38:25,099][root][INFO] - Score: 68.67 [%]  |  Evaluation Time: 3.12 [s]
[2024-09-26 09:38:25,100][root][INFO] - 
Save new Best Score (Epoch: 3)
[2024-09-26 09:38:25,101][root][INFO] - 
[4/ 15 Epoch]
[2024-09-26 09:38:26,551][root][INFO] - Step: 210/1035  |  Loss: 1.0008  |  Score: 68.36 [%]  |  Seq Length: 256.0
[2024-09-26 09:38:32,329][root][INFO] - Step: 225/1035  |  Loss: 0.8821  |  Score: 75.41 [%]  |  Seq Length: 256.0
[2024-09-26 09:38:38,108][root][INFO] - Step: 240/1035  |  Loss: 0.8443  |  Score: 74.64 [%]  |  Seq Length: 256.0
[2024-09-26 09:38:43,872][root][INFO] - Step: 255/1035  |  Loss: 0.9798  |  Score: 72.92 [%]  |  Seq Length: 256.0
[2024-09-26 09:38:50,548][root][INFO] - Step: 270/1035  |  Loss: 0.9414  |  Score: 73.51 [%]  |  Seq Length: 256.0
[2024-09-26 09:38:54,498][root][INFO] - Step: 276/1035  |  Loss: 1.1301  |  Score: 63.54 [%]  |  Seq Length: 256.0
[2024-09-26 09:38:59,251][root][INFO] - ########################  DEV REPORT #EP4  ########################
[2024-09-26 09:38:59,252][root][INFO] - Score: 75.52 [%]  |  Evaluation Time: 4.75 [s]
[2024-09-26 09:39:03,963][root][INFO] - ########################  TEST REPORT #EP4  ########################
[2024-09-26 09:39:03,963][root][INFO] - Score: 69.76 [%]  |  Evaluation Time: 4.71 [s]
[2024-09-26 09:39:03,965][root][INFO] - 
[5/ 15 Epoch]
[2024-09-26 09:39:10,056][root][INFO] - Step: 285/1035  |  Loss: 0.8003  |  Score: 78.33 [%]  |  Seq Length: 256.0
[2024-09-26 09:39:19,630][root][INFO] - Step: 300/1035  |  Loss: 1.0116  |  Score: 75.71 [%]  |  Seq Length: 256.0
[2024-09-26 09:39:29,148][root][INFO] - Step: 315/1035  |  Loss: 0.9072  |  Score: 76.11 [%]  |  Seq Length: 256.0
[2024-09-26 09:39:38,847][root][INFO] - Step: 330/1035  |  Loss: 0.7546  |  Score: 79.15 [%]  |  Seq Length: 256.0
[2024-09-26 09:39:48,610][root][INFO] - Step: 345/1035  |  Loss: 0.9021  |  Score: 75.59 [%]  |  Seq Length: 256.0
[2024-09-26 09:39:53,472][root][INFO] - ########################  DEV REPORT #EP5  ########################
[2024-09-26 09:39:53,472][root][INFO] - Score: 77.47 [%]  |  Evaluation Time: 4.86 [s]
[2024-09-26 09:39:58,150][root][INFO] - ########################  TEST REPORT #EP5  ########################
[2024-09-26 09:39:58,150][root][INFO] - Score: 71.23 [%]  |  Evaluation Time: 4.68 [s]
[2024-09-26 09:39:58,151][root][INFO] - 
Save new Best Score (Epoch: 5)
[2024-09-26 09:39:58,152][root][INFO] - 
[6/ 15 Epoch]
[2024-09-26 09:39:59,161][root][INFO] - Step: 346/1035  |  Loss: 0.7336  |  Score: 75.37 [%]  |  Seq Length: 256.0
[2024-09-26 09:40:08,320][root][INFO] - Step: 360/1035  |  Loss: 0.7129  |  Score: 79.24 [%]  |  Seq Length: 256.0
[2024-09-26 09:40:17,921][root][INFO] - Step: 375/1035  |  Loss: 0.6870  |  Score: 81.73 [%]  |  Seq Length: 256.0
[2024-09-26 09:40:27,746][root][INFO] - Step: 390/1035  |  Loss: 0.7153  |  Score: 79.47 [%]  |  Seq Length: 256.0
[2024-09-26 09:40:37,583][root][INFO] - Step: 405/1035  |  Loss: 0.6654  |  Score: 79.18 [%]  |  Seq Length: 256.0
[2024-09-26 09:40:43,559][root][INFO] - Step: 414/1035  |  Loss: 0.6974  |  Score: 81.67 [%]  |  Seq Length: 256.0
[2024-09-26 09:40:48,488][root][INFO] - ########################  DEV REPORT #EP6  ########################
[2024-09-26 09:40:48,488][root][INFO] - Score: 77.29 [%]  |  Evaluation Time: 4.93 [s]
[2024-09-26 09:40:53,083][root][INFO] - ########################  TEST REPORT #EP6  ########################
[2024-09-26 09:40:53,083][root][INFO] - Score: 72.14 [%]  |  Evaluation Time: 4.59 [s]
[2024-09-26 09:40:53,084][root][INFO] - 
Save new Best Score (Epoch: 6)
[2024-09-26 09:40:53,085][root][INFO] - 
[7/ 15 Epoch]
[2024-09-26 09:40:57,483][root][INFO] - Step: 420/1035  |  Loss: 0.6532  |  Score: 79.19 [%]  |  Seq Length: 256.0
[2024-09-26 09:41:07,261][root][INFO] - Step: 435/1035  |  Loss: 0.6255  |  Score: 84.14 [%]  |  Seq Length: 256.0
[2024-09-26 09:41:16,880][root][INFO] - Step: 450/1035  |  Loss: 0.6226  |  Score: 81.20 [%]  |  Seq Length: 256.0
[2024-09-26 09:41:26,672][root][INFO] - Step: 465/1035  |  Loss: 0.6307  |  Score: 82.00 [%]  |  Seq Length: 256.0
[2024-09-26 09:41:36,351][root][INFO] - Step: 480/1035  |  Loss: 0.6531  |  Score: 79.63 [%]  |  Seq Length: 256.0
[2024-09-26 09:41:38,302][root][INFO] - Step: 483/1035  |  Loss: 0.6380  |  Score: 81.71 [%]  |  Seq Length: 256.0
[2024-09-26 09:41:42,337][root][INFO] - ########################  DEV REPORT #EP7  ########################
[2024-09-26 09:41:42,338][root][INFO] - Score: 76.37 [%]  |  Evaluation Time: 4.03 [s]
[2024-09-26 09:41:45,915][root][INFO] - ########################  TEST REPORT #EP7  ########################
[2024-09-26 09:41:45,915][root][INFO] - Score: 70.55 [%]  |  Evaluation Time: 3.58 [s]
[2024-09-26 09:41:45,917][root][INFO] - 
[8/ 15 Epoch]
[2024-09-26 09:41:51,628][root][INFO] - Step: 495/1035  |  Loss: 0.5421  |  Score: 83.01 [%]  |  Seq Length: 256.0
[2024-09-26 09:41:58,526][root][INFO] - Step: 510/1035  |  Loss: 0.5717  |  Score: 82.91 [%]  |  Seq Length: 256.0
[2024-09-26 09:42:05,415][root][INFO] - Step: 525/1035  |  Loss: 0.6044  |  Score: 82.17 [%]  |  Seq Length: 256.0
[2024-09-26 09:42:12,301][root][INFO] - Step: 540/1035  |  Loss: 0.5302  |  Score: 85.15 [%]  |  Seq Length: 256.0
[2024-09-26 09:42:17,827][root][INFO] - Step: 552/1035  |  Loss: 0.5487  |  Score: 83.34 [%]  |  Seq Length: 256.0
[2024-09-26 09:42:21,522][root][INFO] - ########################  DEV REPORT #EP8  ########################
[2024-09-26 09:42:21,522][root][INFO] - Score: 76.64 [%]  |  Evaluation Time: 3.69 [s]
[2024-09-26 09:42:25,100][root][INFO] - ########################  TEST REPORT #EP8  ########################
[2024-09-26 09:42:25,101][root][INFO] - Score: 71.82 [%]  |  Evaluation Time: 3.58 [s]
[2024-09-26 09:42:25,103][root][INFO] - 
[9/ 15 Epoch]
[2024-09-26 09:42:26,825][root][INFO] - Step: 555/1035  |  Loss: 0.4136  |  Score: 87.15 [%]  |  Seq Length: 256.0
[2024-09-26 09:42:33,639][root][INFO] - Step: 570/1035  |  Loss: 0.4625  |  Score: 86.05 [%]  |  Seq Length: 256.0
[2024-09-26 09:42:40,536][root][INFO] - Step: 585/1035  |  Loss: 0.4961  |  Score: 86.38 [%]  |  Seq Length: 256.0
[2024-09-26 09:42:47,433][root][INFO] - Step: 600/1035  |  Loss: 0.5264  |  Score: 85.60 [%]  |  Seq Length: 256.0
[2024-09-26 09:42:54,313][root][INFO] - Step: 615/1035  |  Loss: 0.5248  |  Score: 84.88 [%]  |  Seq Length: 256.0
[2024-09-26 09:42:57,097][root][INFO] - Step: 621/1035  |  Loss: 0.4986  |  Score: 84.84 [%]  |  Seq Length: 256.0
[2024-09-26 09:43:00,811][root][INFO] - ########################  DEV REPORT #EP9  ########################
[2024-09-26 09:43:00,811][root][INFO] - Score: 75.67 [%]  |  Evaluation Time: 3.71 [s]
[2024-09-26 09:43:04,405][root][INFO] - ########################  TEST REPORT #EP9  ########################
[2024-09-26 09:43:04,405][root][INFO] - Score: 70.38 [%]  |  Evaluation Time: 3.59 [s]
[2024-09-26 09:43:04,408][root][INFO] - 
[10/ 15 Epoch]
[2024-09-26 09:43:09,027][root][INFO] - Step: 630/1035  |  Loss: 0.4267  |  Score: 88.26 [%]  |  Seq Length: 256.0
[2024-09-26 09:43:15,855][root][INFO] - Step: 645/1035  |  Loss: 0.4484  |  Score: 87.76 [%]  |  Seq Length: 256.0
[2024-09-26 09:43:22,726][root][INFO] - Step: 660/1035  |  Loss: 0.4311  |  Score: 86.63 [%]  |  Seq Length: 256.0
[2024-09-26 09:43:29,067][root][INFO] - Step: 675/1035  |  Loss: 0.4780  |  Score: 84.76 [%]  |  Seq Length: 256.0
[2024-09-26 09:43:35,112][root][INFO] - Step: 690/1035  |  Loss: 0.4493  |  Score: 86.99 [%]  |  Seq Length: 256.0
[2024-09-26 09:43:38,335][root][INFO] - ########################  DEV REPORT #EP10  ########################
[2024-09-26 09:43:38,335][root][INFO] - Score: 75.83 [%]  |  Evaluation Time: 3.22 [s]
[2024-09-26 09:43:41,399][root][INFO] - ########################  TEST REPORT #EP10  ########################
[2024-09-26 09:43:41,399][root][INFO] - Score: 71.12 [%]  |  Evaluation Time: 3.06 [s]
[2024-09-26 09:43:41,401][root][INFO] - 
[11/ 15 Epoch]
[2024-09-26 09:43:42,257][root][INFO] - Step: 691/1035  |  Loss: 0.3451  |  Score: 90.18 [%]  |  Seq Length: 256.0
[2024-09-26 09:43:47,674][root][INFO] - Step: 705/1035  |  Loss: 0.3841  |  Score: 88.50 [%]  |  Seq Length: 256.0
[2024-09-26 09:43:53,477][root][INFO] - Step: 720/1035  |  Loss: 0.4025  |  Score: 87.18 [%]  |  Seq Length: 256.0
[2024-09-26 09:43:59,270][root][INFO] - Step: 735/1035  |  Loss: 0.4149  |  Score: 87.16 [%]  |  Seq Length: 256.0
[2024-09-26 09:44:05,099][root][INFO] - Step: 750/1035  |  Loss: 0.4184  |  Score: 88.07 [%]  |  Seq Length: 256.0
[2024-09-26 09:44:09,253][root][INFO] - Step: 759/1035  |  Loss: 0.3988  |  Score: 89.00 [%]  |  Seq Length: 256.0
[2024-09-26 09:44:13,051][root][INFO] - ########################  DEV REPORT #EP11  ########################
[2024-09-26 09:44:13,052][root][INFO] - Score: 76.93 [%]  |  Evaluation Time: 3.80 [s]
[2024-09-26 09:44:16,695][root][INFO] - ########################  TEST REPORT #EP11  ########################
[2024-09-26 09:44:16,695][root][INFO] - Score: 70.18 [%]  |  Evaluation Time: 3.64 [s]
[2024-09-26 09:44:16,698][root][INFO] - 
[12/ 15 Epoch]
[2024-09-26 09:44:19,780][root][INFO] - Step: 765/1035  |  Loss: 0.3956  |  Score: 87.52 [%]  |  Seq Length: 256.0
[2024-09-26 09:44:26,656][root][INFO] - Step: 780/1035  |  Loss: 0.3680  |  Score: 89.83 [%]  |  Seq Length: 256.0
[2024-09-26 09:44:33,443][root][INFO] - Step: 795/1035  |  Loss: 0.3481  |  Score: 89.84 [%]  |  Seq Length: 256.0
[2024-09-26 09:44:40,340][root][INFO] - Step: 810/1035  |  Loss: 0.3741  |  Score: 89.40 [%]  |  Seq Length: 256.0
[2024-09-26 09:44:47,233][root][INFO] - Step: 825/1035  |  Loss: 0.3849  |  Score: 88.21 [%]  |  Seq Length: 256.0
[2024-09-26 09:44:48,642][root][INFO] - Step: 828/1035  |  Loss: 0.3943  |  Score: 88.47 [%]  |  Seq Length: 256.0
[2024-09-26 09:44:52,336][root][INFO] - ########################  DEV REPORT #EP12  ########################
[2024-09-26 09:44:52,336][root][INFO] - Score: 77.07 [%]  |  Evaluation Time: 3.69 [s]
[2024-09-26 09:44:55,882][root][INFO] - ########################  TEST REPORT #EP12  ########################
[2024-09-26 09:44:55,882][root][INFO] - Score: 71.16 [%]  |  Evaluation Time: 3.54 [s]
[2024-09-26 09:44:55,884][root][INFO] - 
[13/ 15 Epoch]
[2024-09-26 09:45:01,840][root][INFO] - Step: 840/1035  |  Loss: 0.3461  |  Score: 89.28 [%]  |  Seq Length: 256.0
[2024-09-26 09:45:08,733][root][INFO] - Step: 855/1035  |  Loss: 0.3513  |  Score: 89.09 [%]  |  Seq Length: 256.0
[2024-09-26 09:45:15,526][root][INFO] - Step: 870/1035  |  Loss: 0.3614  |  Score: 88.82 [%]  |  Seq Length: 256.0
[2024-09-26 09:45:22,416][root][INFO] - Step: 885/1035  |  Loss: 0.3509  |  Score: 89.06 [%]  |  Seq Length: 256.0
[2024-09-26 09:45:27,936][root][INFO] - Step: 897/1035  |  Loss: 0.3868  |  Score: 88.56 [%]  |  Seq Length: 256.0
[2024-09-26 09:45:31,634][root][INFO] - ########################  DEV REPORT #EP13  ########################
[2024-09-26 09:45:31,634][root][INFO] - Score: 77.29 [%]  |  Evaluation Time: 3.70 [s]
[2024-09-26 09:45:35,191][root][INFO] - ########################  TEST REPORT #EP13  ########################
[2024-09-26 09:45:35,191][root][INFO] - Score: 70.25 [%]  |  Evaluation Time: 3.55 [s]
[2024-09-26 09:45:35,193][root][INFO] - 
[14/ 15 Epoch]
[2024-09-26 09:45:36,918][root][INFO] - Step: 900/1035  |  Loss: 0.3321  |  Score: 86.62 [%]  |  Seq Length: 256.0
[2024-09-26 09:45:43,806][root][INFO] - Step: 915/1035  |  Loss: 0.3885  |  Score: 88.86 [%]  |  Seq Length: 256.0
[2024-09-26 09:45:50,692][root][INFO] - Step: 930/1035  |  Loss: 0.3572  |  Score: 88.54 [%]  |  Seq Length: 256.0
[2024-09-26 09:45:57,514][root][INFO] - Step: 945/1035  |  Loss: 0.3320  |  Score: 90.08 [%]  |  Seq Length: 256.0
[2024-09-26 09:46:04,403][root][INFO] - Step: 960/1035  |  Loss: 0.3611  |  Score: 88.79 [%]  |  Seq Length: 256.0
[2024-09-26 09:46:07,180][root][INFO] - Step: 966/1035  |  Loss: 0.3521  |  Score: 89.59 [%]  |  Seq Length: 256.0
[2024-09-26 09:46:10,989][root][INFO] - ########################  DEV REPORT #EP14  ########################
[2024-09-26 09:46:10,990][root][INFO] - Score: 76.14 [%]  |  Evaluation Time: 3.81 [s]
[2024-09-26 09:46:14,612][root][INFO] - ########################  TEST REPORT #EP14  ########################
[2024-09-26 09:46:14,612][root][INFO] - Score: 71.23 [%]  |  Evaluation Time: 3.62 [s]
[2024-09-26 09:46:14,614][root][INFO] - 
[15/ 15 Epoch]
[2024-09-26 09:46:19,113][root][INFO] - Step: 975/1035  |  Loss: 0.3068  |  Score: 90.22 [%]  |  Seq Length: 256.0
[2024-09-26 09:46:26,009][root][INFO] - Step: 990/1035  |  Loss: 0.3133  |  Score: 91.24 [%]  |  Seq Length: 256.0
[2024-09-26 09:46:32,826][root][INFO] - Step: 1005/1035  |  Loss: 0.3653  |  Score: 89.05 [%]  |  Seq Length: 256.0
[2024-09-26 09:46:39,722][root][INFO] - Step: 1020/1035  |  Loss: 0.3365  |  Score: 89.84 [%]  |  Seq Length: 256.0
[2024-09-26 09:46:46,608][root][INFO] - Step: 1035/1035  |  Loss: 0.3417  |  Score: 88.94 [%]  |  Seq Length: 256.0
[2024-09-26 09:46:50,316][root][INFO] - ########################  DEV REPORT #EP15  ########################
[2024-09-26 09:46:50,316][root][INFO] - Score: 76.79 [%]  |  Evaluation Time: 3.70 [s]
[2024-09-26 09:46:53,919][root][INFO] - ########################  TEST REPORT #EP15  ########################
[2024-09-26 09:46:53,919][root][INFO] - Score: 70.00 [%]  |  Evaluation Time: 3.60 [s]
[2024-09-26 09:46:53,920][root][INFO] - ########################  BEST RESULT  ########################
[2024-09-26 09:46:53,920][root][INFO] - - Epoch: 6
[2024-09-26 09:46:53,920][root][INFO] - - DEV score: 77.29 [%]
[2024-09-26 09:46:53,920][root][INFO] - - TEST score: 72.14 [%]
[2024-09-26 09:46:53,921][root][INFO] - Fine-tuning is done!
